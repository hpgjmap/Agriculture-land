const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pe-wasm-Co3DzcyP.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/statsWorker-CPLaXa3N.js","assets/utils-oMAoPaTw.js","assets/quantizationUtils-Vz0wCIZG.js","assets/utils-bXKKd1wY.js","assets/ClassBreaksDefinition-BWMw3G2Q.js","assets/geometryEngineWorker-CA-tZxOm.js","assets/geometryEngineJSON-Bvf5zUh7.js","assets/geometryEngineBase-B0ZyeKAX.js","assets/json-Wa8cmqdu.js","assets/CSVSourceWorker-f7lYrPi2.js","assets/date-Ctp1FiBW.js","assets/executeQueryForSnapping-Cm00PMjI.js","assets/queryUtils-CGMqnhP6.js","assets/QueryEngine-B-9wbT9Z.js","assets/featureConversionUtils-BCPXUFIl.js","assets/WhereClauseCache-DPX74x27.js","assets/WhereClause-kcfYUqwl.js","assets/timeSupport-BGzyshWA.js","assets/SnappingCandidate-DGkpYqI6.js","assets/FixedIntervalBinParameters-BwkDbAd5.js","assets/FeatureStore-CDle4FOx.js","assets/BoundsStore-B9bneaX2.js","assets/PooledRBush-BU_Y6dUl.js","assets/optimizedFeatureQueryEngineAdapter-CNwVC5BY.js","assets/number-CW3bxZOa.js","assets/EdgeProcessingWorker-Dla8ImDd.js","assets/workerHelper-DLFEL7R8.js","assets/InterleavedLayout-CToNLyzN.js","assets/BufferView-h3FqWq1X.js","assets/types-D0PSWh4d.js","assets/edgeProcessing-BKjKwToh.js","assets/deduplicate-CFPnNOm_.js","assets/Indices-Clz-4DiB.js","assets/VertexAttribute-Cq4MnHjR.js","assets/glUtil-DlpDNEZW.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/Normals-BoAvDMd4.js","assets/ElevationSamplerWorker-3T2UH-zC.js","assets/MeshLocalVertexSpace-jR6XAYhR.js","assets/vertexSpaceConversion-B8l6IwCZ.js","assets/mat3f64-q3fE-ZOt.js","assets/mat4f64-Dk4dwAN8.js","assets/spatialReferenceEllipsoidUtils-DsYv-uuA.js","assets/computeTranslationToOriginAndRotation-B8_meLHv.js","assets/projectPointToVector-SPQQC-bo.js","assets/meshVertexSpaceUtils-DHEE_kjd.js","assets/vec3-uWvQ96Nq.js","assets/vec4-D2fyHQgE.js","assets/FeatureServiceSnappingSourceWorker-MYFCNgZe.js","assets/symbologySnappingCandidates-DiP21bJJ.js","assets/GeoJSONSourceWorker-DnhPQApc.js","assets/geojson-BrL6vwGQ.js","assets/sourceUtils-CxWbkjfF.js","assets/MemorySourceWorker-Hnk35b-Y.js","assets/objectIdUtils-4dd1rf9p.js","assets/PBFDecoderWorker-pb8qJGNm.js","assets/dehydratedFeatures-CbO0gHLM.js","assets/FeaturePipelineWorker-Dw1e1EZc.js","assets/AttributeStore-CWoN29Gu.js","assets/Utils-ZfFmEvSO.js","assets/BoundingBox-DwHqGUQL.js","assets/UpdateTracking2D-BTSmbesM.js","assets/CIMSymbolHelper-Dir206WJ.js","assets/BidiEngine-QXap_35O.js","assets/fontUtils-Xoh5OYnf.js","assets/GeometryUtils-DF1g7-R_.js","assets/rasterizingUtils-DQOt2TI_.js","assets/floatRGBA-B-7XJ6iE.js","assets/Rect-CUzevAry.js","assets/streamLayerUtils-CKwt2uXH.js","assets/MeshWriterRegistry-DPhle6jV.js","assets/TechniqueType-uMFRS8dR.js","assets/PieChartMeshWriter-y9hCqYCg.js","assets/TurboLine-CfQ1EvO3.js","assets/utils-C9KDFQxe.js","assets/earcut-D9gy186-.js","assets/grouping-VQ4wp0TR.js","assets/QueueProcessor-DSWTIJWW.js","assets/operatorGeodeticDensify-CoP8bF-8.js","assets/geodeticCurveType-CirnHLSB.js","assets/normalizeUtilsSync-Coldk4zR.js","assets/ogcFeatureUtils-blIrmAJi.js","assets/parquet-DSu_Sx1h.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-CAQIvd8w.js","assets/PointCloudWorker-CHmBH4SP.js","assets/quat-2FPxthiJ.js","assets/quatf64-aQ5IuZRd.js","assets/vec3f32-nZdmKIgz.js","assets/PointCloudUniqueValueRenderer-CJHTS06D.js","assets/I3SBinaryReader-DNuiIhCz.js","assets/orientedBoundingBox-B9KVBWjL.js","assets/plane-Bv_pZS-7.js","assets/RasterWorker-CQQcbau5.js","assets/dataUtils-COvoL-7I.js","assets/pixelRangeUtils-Bk2sXCMF.js","assets/RasterSymbolizer-DiSL1MuW.js","assets/rasterFunctionHelper-at2UMcJw.js","assets/rasterProjectionHelper-stUVd1tx.js","assets/PolynomialTransform-BvDQklNm.js","assets/SceneLayerSnappingSourceWorker-CKevdsg_.js","assets/lineSegment-D1YacSrt.js","assets/sphere-C70Cvfaz.js","assets/Octree-DuFeWqZ_.js","assets/SceneLayerWorker-oQ1siDte.js","assets/projectVectorToVector-BJXneMLt.js","assets/I3SUtil-CB7nbX5K.js","assets/edgeUtils-CxzI1Lyn.js","assets/NormalAttribute.glsl-CTSbR6fQ.js","assets/glsl-BH37Aalp.js","assets/ShaderOutput-DnYY5J1_.js","assets/BindType-BBwFZqyN.js","assets/WFSSourceWorker-p52qgiFT.js","assets/wfsUtils-C_tLefCO.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-Cg74MZ6h.js","assets/enums-BRzLM11V.js","assets/config-BOD8--da.js","assets/StyleDefinition-C-qbdkpu.js","assets/SourceLayerData-BDyrgkZA.js","assets/StyleRepository-B-th_1ap.js","assets/Feature3DPipelineWorker-nxMK_Pir.js","assets/projectVectorToPoint-BhNP7_bl.js","assets/Geometry-Vd1ehF6N.js","assets/renderState-Da8EQlbB.js","assets/basicInterfaces-CZwQPxTp.js","assets/boundedPlane-BX6aSpGG.js","assets/requestImageUtils-CMZMp5Xu.js","assets/TextureFormat-1mYWTFa-.js","assets/triangle-ButC5Pfe.js","assets/HUDMaterial.glsl-BHiTpFEM.js","assets/VertexArrayObject-Djnqje80.js","assets/dehydratedFeatureUtils-DDD1cG2o.js","assets/doublePrecisionUtils-B0owpBza.js","assets/hydratedFeatures-Ba_7NPdf.js","assets/ShaderBuilder-DbJ3UBZY.js","assets/IntersectorInterfaces-CmNINbyF.js","assets/RealisticTree.glsl-t99NMoNH.js","assets/LodResources-DhE3LVEf.js","assets/TextureCompressionWorker-CHsTOkdN.js","assets/ElevationLayer-BXyVyaGs.js","assets/ArcGISCachedService-BNeVgDOB.js","assets/TileInfoTilemapCache-BPTzfNeV.js","assets/TilemapCache-CpGJtIsW.js","assets/WorkerHandle-CDrOkEWR.js","assets/layersCreator-CQpJfFOa.js","assets/loadUtils-D5yoknf4.js","assets/fetchService-XeBVD-H5.js","assets/associatedFeatureServiceUtils-BTk7qAva.js","assets/lazyLayerLoader-DuUlRoOY.js","assets/portalLayers-C6so4ZSM.js","assets/arcgisLayers-o8j3RCAI.js","assets/arcadeUtils-nnNXR338.js","assets/arcade-BCBvbQ55.js","assets/unitConversion-BCYaEfdb.js","assets/ImmutableArray-BPVd6ESQ.js","assets/geometryServiceUtils-CnXnmmoJ.js","assets/project-7Y2pb-rZ.js","assets/webglDeps-DP6tZZvN.js","assets/FramebufferObject-CUAnJnuE.js","assets/ProgramTemplate-C6GXgUmM.js","assets/NestedMap-GuqgquCN.js","assets/mapViewDeps-BisJeTYT.js","assets/FeatureCommandQueue-OTGxU3Ty.js","assets/GraphShaderModule-CXT0RMR4.js","assets/WGLContainer-gOqbknBz.js","assets/Container-CqBa46FS.js","assets/EffectView-R_cbep4s.js","assets/SDFHelper-DkPWNAOh.js","assets/OverrideHelper-CIwXcBSI.js","assets/GridShader-b-uJotry.js","assets/testSVGPremultipliedAlpha-CA2WYbCv.js","assets/RenderingContext-BLwOQxzy.js","assets/CIMResourceManager-OUbxovYK.js","assets/utils-DBdBpbO5.js","assets/VertexStream-uCdk6SBa.js","assets/utils-ehcGqGxa.js","assets/GraphicsView2D-Bq0AzUFa.js","assets/GraphicContainer-D1JbFUih.js","assets/AGraphicContainer-B_R_HsNc.js","assets/TechniqueInstance-B_q5IbOL.js","assets/TileContainer-BtYWEPxj.js","assets/gridUtils-CE8JNUTz.js","assets/TileLayerView2D-B0iJyv6Y.js","assets/imageUtils-oYB56N-p.js","assets/BitmapTechnique-CAcfZIXe.js","assets/LayerView-MTnLsCOk.js","assets/HighlightGraphicContainer-DckNiamP.js","assets/RefreshableLayerView-TOz8r5aZ.js","assets/MapServiceLayerViewHelper-C4nAigY5.js","assets/floorFilterUtils-DZ5C6FQv.js","assets/drapedUtils-CTlUr7Ks.js","assets/sublayerUtils-BiYwkT1n.js","assets/popupUtils-BRAEl6Uu.js","assets/FeatureLayerView2D-brHcZ5AI.js","assets/timeSupport-C2w7VQnZ.js","assets/AttributeBinsFeatureSet-DhTNodbO.js","assets/AttributeBinsQuery-LRW-v05N.js","assets/featureReductionUtils-Caulfaw_.js","assets/constants-B4mRqufT.js","assets/BaseDynamicLayerView2D-D86hh3RR.js","assets/BitmapContainer-jakwejsn.js","assets/ExportStrategy-BtUlMjLC.js","assets/CatalogLayerView2D-Ccku9nNo.js","assets/CatalogDynamicGroupLayerView2D-D2oCaoCW.js","assets/CatalogFootprintLayerView2D-BIF7ZS00.js","assets/GeoRSSLayerView2D-jtYkqMb8.js","assets/GraphicsLayerView2D-DR_paYGR.js","assets/GroupLayerView2D-CBXlXICW.js","assets/ImageryLayerView2D-C-4WC9mt.js","assets/RasterVFDisplayObject-JnZLWp85.js","assets/ImageryTileLayerView2D-CzG3dTyl.js","assets/rasterFieldUtils-B8bfVcBM.js","assets/rasterUtils-CyUJyqbQ.js","assets/RawBlockCache-bfYrwAZz.js","assets/KMLLayerView2D-CInLNI0r.js","assets/kmlUtils-B4hoVyDx.js","assets/KnowledgeGraphLayerView2D-qmFSP97m.js","assets/MapImageLayerView2D-DYrH9NEF.js","assets/ExportImageParameters-BvubJM7G.js","assets/MapNotesLayerView2D-B8MoSxm4.js","assets/MediaLayerView2D-B43M7V53.js","assets/mediaLayerUtils-IRR2uI0U.js","assets/OverlayContainer-CgbK7oQ-.js","assets/OGCFeatureLayerView2D-Rnip2xVR.js","assets/RouteLayerView2D-DwKqrt_G.js","assets/Stop-RT0kUVXq.js","assets/networkEnums-CggudA5j.js","assets/StreamLayerView2D-D-yww_MT.js","assets/SubtypeGroupLayerView2D-CSIxhtdg.js","assets/VectorTileLayerView2D-D7vahApT.js","assets/VideoLayerView2D-CUhtdX6P.js","assets/TelemetryDisplay-Cp9I5hPt.js","assets/WMSLayerView2D-DqGlUAD5.js","assets/ExportWMSImageParameters-CdpKW27v.js","assets/WMTSLayerView2D-CdGGSbvS.js","assets/apng-DM2UfQ7c.js","assets/index-CmPXJs7R.js","assets/index-B0fAt0SM.js","assets/guid-BDWAkmkV.js","assets/useT9n-mcNy8rwW.js","assets/index-BhFhNIYS.js","assets/dom-BlsrSdnU.js","assets/observers-BDRBTsGW.js","assets/ref-zUoudccW.js","assets/static-C0-gPcS3.js","assets/form-B54awQzW.js","assets/interactive-CKVrd8yS.js","assets/label-CjkQ2sga.js","assets/component-DDseKhJl.js","assets/index-mCYGoQ2c.js","assets/index-9hW8Ud6V.js","assets/keyed-NhRWh-5X.js","assets/index-BVUVt3d7.js","assets/floating-ui-HPKqx4SB.js","assets/debounce-D0G5qrda.js","assets/openCloseComponent-DN-FYq9Q.js","assets/FloatingArrow-LeIY9OAw.js","assets/useFocusTrap-KptLGByt.js","assets/key-ak3_eHKH.js","assets/index-BPjQMfUj.js","assets/array-CItZ4bXf.js","assets/index-B_oefgqS.js","assets/index-C07d_ioL.js","assets/dynamicClasses-Dlk4kLaw.js","assets/index-CNy762lr.js","assets/resources6-C-XXGpuo.js","assets/index-BHpbmaKo.js","assets/utils-DXkCmc_9.js","assets/resources5-B_fF8ZZV.js","assets/index-kzOfcToX.js","assets/customElement-3JiGtP9N.js","assets/index-CAoP7lqy.js","assets/customElement-D6s94Nx_.js","assets/index-COtbL4Zf.js","assets/index-DW-iT0Or.js","assets/Legend-D9KzgpQS.js","assets/rendererConversion-B9AbZUaV.js","assets/index-5r6cdDcQ.js","assets/index-BcyHfZZl.js","assets/index-32bfBVfE.js","assets/index-B2sPZsbm.js","assets/layersLoader-Cj0zxjyL.js","assets/jsonContext-W6OVNIgN.js","assets/chartUtilsAm5-C2Mcp1lS.js","assets/Theme-B5if3Mzp.js","assets/Tooltip-BbCGMLWN.js","assets/DefaultTheme-CH3htqj0.js","assets/chartCommon-JC0g-oLb.js","assets/Button-rdOrpCvI.js","assets/ColorSet-Bkx1EcTe.js","assets/pieChart-B2qSgNYE.js","assets/Tick-DFmFqO4u.js","assets/xyChart-FeZuWO7X.js","assets/featureLayerUtils-WJXLv3j-.js","assets/originUtils-D69mHv66.js","assets/multiOriginJSONSupportUtils-C0wm8_Yw.js","assets/utils-DBxXeYSO.js","assets/saveUtils-D03CU1ZB.js","assets/FeatureLayerSource-B1OI02jh.js","assets/External-rUQLmLZa.js","assets/MeshTransform-BSniAdEs.js","assets/axisAngleDegrees-2TEf4C8H.js","assets/editingSupport-LSxn7lAP.js","assets/QueryTask-EpF4zunD.js","assets/executeForIds-C3rQIxVB.js","assets/arcade-Co0NP8Rl.js","assets/uniqueValues-KV5n-DWx.js","assets/index-or2Je7JW.js","assets/index-CPMOc5ra.js","assets/previewSymbol2D-MY-RQ0zx.js","assets/previewCIMSymbol-D1g2RaGE.js","assets/CIMSymbolRasterizer-C6Ayki-h.js","assets/index-DQnEbd7J.js","assets/index-BJarPfPF.js","assets/interact.min-iNRM8XgC.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();function o2e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var zF={exports:{}},Mw={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sX;function a2e(){if(sX)return Mw;sX=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function s(i,r,n){var o=null;if(n!==void 0&&(o=""+n),r.key!==void 0&&(o=""+r.key),"key"in r){n={};for(var a in r)a!=="key"&&(n[a]=r[a])}else n=r;return r=n.ref,{$$typeof:t,type:i,key:o,ref:r!==void 0?r:null,props:n}}return Mw.Fragment=e,Mw.jsx=s,Mw.jsxs=s,Mw}var iX;function l2e(){return iX||(iX=1,zF.exports=a2e()),zF.exports}var tt=l2e(),UF={exports:{}},Yt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rX;function u2e(){if(rX)return Yt;rX=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),n=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),h=Symbol.iterator;function m(Z){return Z===null||typeof Z!="object"?null:(Z=h&&Z[h]||Z["@@iterator"],typeof Z=="function"?Z:null)}var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function b(Z,te,ve){this.props=Z,this.context=te,this.refs=v,this.updater=ve||f}b.prototype.isReactComponent={},b.prototype.setState=function(Z,te){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,te,"setState")},b.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function w(){}w.prototype=b.prototype;function S(Z,te,ve){this.props=Z,this.context=te,this.refs=v,this.updater=ve||f}var T=S.prototype=new w;T.constructor=S,g(T,b.prototype),T.isPureReactComponent=!0;var P=Array.isArray,I={H:null,A:null,T:null,S:null,V:null},A=Object.prototype.hasOwnProperty;function D(Z,te,ve,ke,Fe,Pe){return ve=Pe.ref,{$$typeof:t,type:Z,key:te,ref:ve!==void 0?ve:null,props:Pe}}function k(Z,te){return D(Z.type,te,void 0,void 0,void 0,Z.props)}function R(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===t}function O(Z){var te={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(ve){return te[ve]})}var z=/\/+/g;function q(Z,te){return typeof Z=="object"&&Z!==null&&Z.key!=null?O(""+Z.key):te.toString(36)}function U(){}function V(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(U,U):(Z.status="pending",Z.then(function(te){Z.status==="pending"&&(Z.status="fulfilled",Z.value=te)},function(te){Z.status==="pending"&&(Z.status="rejected",Z.reason=te)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function B(Z,te,ve,ke,Fe){var Pe=typeof Z;(Pe==="undefined"||Pe==="boolean")&&(Z=null);var Ve=!1;if(Z===null)Ve=!0;else switch(Pe){case"bigint":case"string":case"number":Ve=!0;break;case"object":switch(Z.$$typeof){case t:case e:Ve=!0;break;case c:return Ve=Z._init,B(Ve(Z._payload),te,ve,ke,Fe)}}if(Ve)return Fe=Fe(Z),Ve=ke===""?"."+q(Z,0):ke,P(Fe)?(ve="",Ve!=null&&(ve=Ve.replace(z,"$&/")+"/"),B(Fe,te,ve,"",function(Rs){return Rs})):Fe!=null&&(R(Fe)&&(Fe=k(Fe,ve+(Fe.key==null||Z&&Z.key===Fe.key?"":(""+Fe.key).replace(z,"$&/")+"/")+Ve)),te.push(Fe)),1;Ve=0;var Ke=ke===""?".":ke+":";if(P(Z))for(var He=0;He<Z.length;He++)ke=Z[He],Pe=Ke+q(ke,He),Ve+=B(ke,te,ve,Pe,Fe);else if(He=m(Z),typeof He=="function")for(Z=He.call(Z),He=0;!(ke=Z.next()).done;)ke=ke.value,Pe=Ke+q(ke,He++),Ve+=B(ke,te,ve,Pe,Fe);else if(Pe==="object"){if(typeof Z.then=="function")return B(V(Z),te,ve,ke,Fe);throw te=String(Z),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Ve}function H(Z,te,ve){if(Z==null)return Z;var ke=[],Fe=0;return B(Z,ke,"","",function(Pe){return te.call(ve,Pe,Fe++)}),ke}function W(Z){if(Z._status===-1){var te=Z._result;te=te(),te.then(function(ve){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=ve)},function(ve){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=ve)}),Z._status===-1&&(Z._status=0,Z._result=te)}if(Z._status===1)return Z._result.default;throw Z._result}var ie=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)};function se(){}return Yt.Children={map:H,forEach:function(Z,te,ve){H(Z,function(){te.apply(this,arguments)},ve)},count:function(Z){var te=0;return H(Z,function(){te++}),te},toArray:function(Z){return H(Z,function(te){return te})||[]},only:function(Z){if(!R(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}},Yt.Component=b,Yt.Fragment=s,Yt.Profiler=r,Yt.PureComponent=S,Yt.StrictMode=i,Yt.Suspense=l,Yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Yt.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return I.H.useMemoCache(Z)}},Yt.cache=function(Z){return function(){return Z.apply(null,arguments)}},Yt.cloneElement=function(Z,te,ve){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var ke=g({},Z.props),Fe=Z.key,Pe=void 0;if(te!=null)for(Ve in te.ref!==void 0&&(Pe=void 0),te.key!==void 0&&(Fe=""+te.key),te)!A.call(te,Ve)||Ve==="key"||Ve==="__self"||Ve==="__source"||Ve==="ref"&&te.ref===void 0||(ke[Ve]=te[Ve]);var Ve=arguments.length-2;if(Ve===1)ke.children=ve;else if(1<Ve){for(var Ke=Array(Ve),He=0;He<Ve;He++)Ke[He]=arguments[He+2];ke.children=Ke}return D(Z.type,Fe,void 0,void 0,Pe,ke)},Yt.createContext=function(Z){return Z={$$typeof:o,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:n,_context:Z},Z},Yt.createElement=function(Z,te,ve){var ke,Fe={},Pe=null;if(te!=null)for(ke in te.key!==void 0&&(Pe=""+te.key),te)A.call(te,ke)&&ke!=="key"&&ke!=="__self"&&ke!=="__source"&&(Fe[ke]=te[ke]);var Ve=arguments.length-2;if(Ve===1)Fe.children=ve;else if(1<Ve){for(var Ke=Array(Ve),He=0;He<Ve;He++)Ke[He]=arguments[He+2];Fe.children=Ke}if(Z&&Z.defaultProps)for(ke in Ve=Z.defaultProps,Ve)Fe[ke]===void 0&&(Fe[ke]=Ve[ke]);return D(Z,Pe,void 0,void 0,null,Fe)},Yt.createRef=function(){return{current:null}},Yt.forwardRef=function(Z){return{$$typeof:a,render:Z}},Yt.isValidElement=R,Yt.lazy=function(Z){return{$$typeof:c,_payload:{_status:-1,_result:Z},_init:W}},Yt.memo=function(Z,te){return{$$typeof:u,type:Z,compare:te===void 0?null:te}},Yt.startTransition=function(Z){var te=I.T,ve={};I.T=ve;try{var ke=Z(),Fe=I.S;Fe!==null&&Fe(ve,ke),typeof ke=="object"&&ke!==null&&typeof ke.then=="function"&&ke.then(se,ie)}catch(Pe){ie(Pe)}finally{I.T=te}},Yt.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Yt.use=function(Z){return I.H.use(Z)},Yt.useActionState=function(Z,te,ve){return I.H.useActionState(Z,te,ve)},Yt.useCallback=function(Z,te){return I.H.useCallback(Z,te)},Yt.useContext=function(Z){return I.H.useContext(Z)},Yt.useDebugValue=function(){},Yt.useDeferredValue=function(Z,te){return I.H.useDeferredValue(Z,te)},Yt.useEffect=function(Z,te,ve){var ke=I.H;if(typeof ve=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ke.useEffect(Z,te)},Yt.useId=function(){return I.H.useId()},Yt.useImperativeHandle=function(Z,te,ve){return I.H.useImperativeHandle(Z,te,ve)},Yt.useInsertionEffect=function(Z,te){return I.H.useInsertionEffect(Z,te)},Yt.useLayoutEffect=function(Z,te){return I.H.useLayoutEffect(Z,te)},Yt.useMemo=function(Z,te){return I.H.useMemo(Z,te)},Yt.useOptimistic=function(Z,te){return I.H.useOptimistic(Z,te)},Yt.useReducer=function(Z,te,ve){return I.H.useReducer(Z,te,ve)},Yt.useRef=function(Z){return I.H.useRef(Z)},Yt.useState=function(Z){return I.H.useState(Z)},Yt.useSyncExternalStore=function(Z,te,ve){return I.H.useSyncExternalStore(Z,te,ve)},Yt.useTransition=function(){return I.H.useTransition()},Yt.version="19.1.0",Yt}var nX;function ZG(){return nX||(nX=1,UF.exports=u2e()),UF.exports}var mi=ZG();const c2e=o2e(mi);var BF={exports:{}},Aw={},jF={exports:{}},HF={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oX;function h2e(){return oX||(oX=1,function(t){function e(H,W){var ie=H.length;H.push(W);e:for(;0<ie;){var se=ie-1>>>1,Z=H[se];if(0<r(Z,W))H[se]=W,H[ie]=Z,ie=se;else break e}}function s(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var W=H[0],ie=H.pop();if(ie!==W){H[0]=ie;e:for(var se=0,Z=H.length,te=Z>>>1;se<te;){var ve=2*(se+1)-1,ke=H[ve],Fe=ve+1,Pe=H[Fe];if(0>r(ke,ie))Fe<Z&&0>r(Pe,ke)?(H[se]=Pe,H[Fe]=ie,se=Fe):(H[se]=ke,H[ve]=ie,se=ve);else if(Fe<Z&&0>r(Pe,ie))H[se]=Pe,H[Fe]=ie,se=Fe;else break e}}return W}function r(H,W){var ie=H.sortIndex-W.sortIndex;return ie!==0?ie:H.id-W.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var n=performance;t.unstable_now=function(){return n.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,m=3,f=!1,g=!1,v=!1,b=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function P(H){for(var W=s(u);W!==null;){if(W.callback===null)i(u);else if(W.startTime<=H)i(u),W.sortIndex=W.expirationTime,e(l,W);else break;W=s(u)}}function I(H){if(v=!1,P(H),!g)if(s(l)!==null)g=!0,A||(A=!0,q());else{var W=s(u);W!==null&&B(I,W.startTime-H)}}var A=!1,D=-1,k=5,R=-1;function O(){return b?!0:!(t.unstable_now()-R<k)}function z(){if(b=!1,A){var H=t.unstable_now();R=H;var W=!0;try{e:{g=!1,v&&(v=!1,S(D),D=-1),f=!0;var ie=m;try{t:{for(P(H),h=s(l);h!==null&&!(h.expirationTime>H&&O());){var se=h.callback;if(typeof se=="function"){h.callback=null,m=h.priorityLevel;var Z=se(h.expirationTime<=H);if(H=t.unstable_now(),typeof Z=="function"){h.callback=Z,P(H),W=!0;break t}h===s(l)&&i(l),P(H)}else i(l);h=s(l)}if(h!==null)W=!0;else{var te=s(u);te!==null&&B(I,te.startTime-H),W=!1}}break e}finally{h=null,m=ie,f=!1}W=void 0}}finally{W?q():A=!1}}}var q;if(typeof T=="function")q=function(){T(z)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,V=U.port2;U.port1.onmessage=z,q=function(){V.postMessage(null)}}else q=function(){w(z,0)};function B(H,W){D=w(function(){H(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(H){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var ie=m;m=W;try{return H()}finally{m=ie}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(H,W){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ie=m;m=H;try{return W()}finally{m=ie}},t.unstable_scheduleCallback=function(H,W,ie){var se=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?se+ie:se):ie=se,H){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=ie+Z,H={id:c++,callback:W,priorityLevel:H,startTime:ie,expirationTime:Z,sortIndex:-1},ie>se?(H.sortIndex=ie,e(u,H),s(l)===null&&H===s(u)&&(v?(S(D),D=-1):v=!0,B(I,ie-se))):(H.sortIndex=Z,e(l,H),g||f||(g=!0,A||(A=!0,q()))),H},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(H){var W=m;return function(){var ie=m;m=W;try{return H.apply(this,arguments)}finally{m=ie}}}}(HF)),HF}var aX;function m2e(){return aX||(aX=1,jF.exports=h2e()),jF.exports}var YF={exports:{}},vo={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lX;function d2e(){if(lX)return vo;lX=1;var t=ZG();function e(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)u+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(e(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},r=Symbol.for("react.portal");function n(l,u,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:h==null?null:""+h,children:l,containerInfo:u,implementation:c}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(l,u){if(l==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return vo.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,vo.createPortal=function(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return n(l,u,null,c)},vo.flushSync=function(l){var u=o.T,c=i.p;try{if(o.T=null,i.p=2,l)return l()}finally{o.T=u,i.p=c,i.d.f()}},vo.preconnect=function(l,u){typeof l=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,i.d.C(l,u))},vo.prefetchDNS=function(l){typeof l=="string"&&i.d.D(l)},vo.preinit=function(l,u){if(typeof l=="string"&&u&&typeof u.as=="string"){var c=u.as,h=a(c,u.crossOrigin),m=typeof u.integrity=="string"?u.integrity:void 0,f=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;c==="style"?i.d.S(l,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:h,integrity:m,fetchPriority:f}):c==="script"&&i.d.X(l,{crossOrigin:h,integrity:m,fetchPriority:f,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},vo.preinitModule=function(l,u){if(typeof l=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var c=a(u.as,u.crossOrigin);i.d.M(l,{crossOrigin:c,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&i.d.M(l)},vo.preload=function(l,u){if(typeof l=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var c=u.as,h=a(c,u.crossOrigin);i.d.L(l,c,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},vo.preloadModule=function(l,u){if(typeof l=="string")if(u){var c=a(u.as,u.crossOrigin);i.d.m(l,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:c,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else i.d.m(l)},vo.requestFormReset=function(l){i.d.r(l)},vo.unstable_batchedUpdates=function(l,u){return l(u)},vo.useFormState=function(l,u,c){return o.H.useFormState(l,u,c)},vo.useFormStatus=function(){return o.H.useHostTransitionStatus()},vo.version="19.1.0",vo}var uX;function p2e(){if(uX)return YF.exports;uX=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),YF.exports=d2e(),YF.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cX;function f2e(){if(cX)return Aw;cX=1;var t=m2e(),e=ZG(),s=p2e();function i(d){var y="https://react.dev/errors/"+d;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+d+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function n(d){var y=d,x=d;if(d.alternate)for(;y.return;)y=y.return;else{d=y;do y=d,(y.flags&4098)!==0&&(x=y.return),d=y.return;while(d)}return y.tag===3?x:null}function o(d){if(d.tag===13){var y=d.memoizedState;if(y===null&&(d=d.alternate,d!==null&&(y=d.memoizedState)),y!==null)return y.dehydrated}return null}function a(d){if(n(d)!==d)throw Error(i(188))}function l(d){var y=d.alternate;if(!y){if(y=n(d),y===null)throw Error(i(188));return y!==d?null:d}for(var x=d,C=y;;){var N=x.return;if(N===null)break;var $=N.alternate;if($===null){if(C=N.return,C!==null){x=C;continue}break}if(N.child===$.child){for($=N.child;$;){if($===x)return a(N),d;if($===C)return a(N),y;$=$.sibling}throw Error(i(188))}if(x.return!==C.return)x=N,C=$;else{for(var j=!1,J=N.child;J;){if(J===x){j=!0,x=N,C=$;break}if(J===C){j=!0,C=N,x=$;break}J=J.sibling}if(!j){for(J=$.child;J;){if(J===x){j=!0,x=$,C=N;break}if(J===C){j=!0,C=$,x=N;break}J=J.sibling}if(!j)throw Error(i(189))}}if(x.alternate!==C)throw Error(i(190))}if(x.tag!==3)throw Error(i(188));return x.stateNode.current===x?d:y}function u(d){var y=d.tag;if(y===5||y===26||y===27||y===6)return d;for(d=d.child;d!==null;){if(y=u(d),y!==null)return y;d=d.sibling}return null}var c=Object.assign,h=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),f=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),S=Symbol.for("react.consumer"),T=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function q(d){return d===null||typeof d!="object"?null:(d=z&&d[z]||d["@@iterator"],typeof d=="function"?d:null)}var U=Symbol.for("react.client.reference");function V(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===U?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case g:return"Fragment";case b:return"Profiler";case v:return"StrictMode";case I:return"Suspense";case A:return"SuspenseList";case R:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case f:return"Portal";case T:return(d.displayName||"Context")+".Provider";case S:return(d._context.displayName||"Context")+".Consumer";case P:var y=d.render;return d=d.displayName,d||(d=y.displayName||y.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case D:return y=d.displayName||null,y!==null?y:V(d.type)||"Memo";case k:y=d._payload,d=d._init;try{return V(d(y))}catch{}}return null}var B=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie={pending:!1,data:null,method:null,action:null},se=[],Z=-1;function te(d){return{current:d}}function ve(d){0>Z||(d.current=se[Z],se[Z]=null,Z--)}function ke(d,y){Z++,se[Z]=d.current,d.current=y}var Fe=te(null),Pe=te(null),Ve=te(null),Ke=te(null);function He(d,y){switch(ke(Ve,y),ke(Pe,d),ke(Fe,null),y.nodeType){case 9:case 11:d=(d=y.documentElement)&&(d=d.namespaceURI)?AY(d):0;break;default:if(d=y.tagName,y=y.namespaceURI)y=AY(y),d=NY(y,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}ve(Fe),ke(Fe,d)}function Rs(){ve(Fe),ve(Pe),ve(Ve)}function Cr(d){d.memoizedState!==null&&ke(Ke,d);var y=Fe.current,x=NY(y,d.type);y!==x&&(ke(Pe,d),ke(Fe,x))}function Js(d){Pe.current===d&&(ve(Fe),ve(Pe)),Ke.current===d&&(ve(Ke),Ew._currentValue=ie)}var as=Object.prototype.hasOwnProperty,er=t.unstable_scheduleCallback,fi=t.unstable_cancelCallback,Ks=t.unstable_shouldYield,dt=t.unstable_requestPaint,De=t.unstable_now,ks=t.unstable_getCurrentPriorityLevel,Pr=t.unstable_ImmediatePriority,Ui=t.unstable_UserBlockingPriority,tr=t.unstable_NormalPriority,Ho=t.unstable_LowPriority,Ai=t.unstable_IdlePriority,Wn=t.log,an=t.unstable_setDisableYieldValue,mr=null,Si=null;function Ei(d){if(typeof Wn=="function"&&an(d),Si&&typeof Si.setStrictMode=="function")try{Si.setStrictMode(mr,d)}catch{}}var Cs=Math.clz32?Math.clz32:Tr,ln=Math.log,Yo=Math.LN2;function Tr(d){return d>>>=0,d===0?32:31-(ln(d)/Yo|0)|0}var su=256,Vr=4194304;function Pn(d){var y=d&42;if(y!==0)return y;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function Xo(d,y,x){var C=d.pendingLanes;if(C===0)return 0;var N=0,$=d.suspendedLanes,j=d.pingedLanes;d=d.warmLanes;var J=C&134217727;return J!==0?(C=J&~$,C!==0?N=Pn(C):(j&=J,j!==0?N=Pn(j):x||(x=J&~d,x!==0&&(N=Pn(x))))):(J=C&~$,J!==0?N=Pn(J):j!==0?N=Pn(j):x||(x=C&~d,x!==0&&(N=Pn(x)))),N===0?0:y!==0&&y!==N&&(y&$)===0&&($=N&-N,x=y&-y,$>=x||$===32&&(x&4194048)!==0)?y:N}function yo(d,y){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&y)===0}function Hu(d,y){switch(d){case 1:case 2:case 4:case 8:case 64:return y+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jd(){var d=su;return su<<=1,(su&4194048)===0&&(su=256),d}function IP(){var d=Vr;return Vr<<=1,(Vr&62914560)===0&&(Vr=4194304),d}function Ax(d){for(var y=[],x=0;31>x;x++)y.push(d);return y}function Pg(d,y){d.pendingLanes|=y,y!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function LR(d,y,x,C,N,$){var j=d.pendingLanes;d.pendingLanes=x,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=x,d.entangledLanes&=x,d.errorRecoveryDisabledLanes&=x,d.shellSuspendCounter=0;var J=d.entanglements,oe=d.expirationTimes,_e=d.hiddenUpdates;for(x=j&~x;0<x;){var $e=31-Cs(x),Oe=1<<$e;J[$e]=0,oe[$e]=-1;var xe=_e[$e];if(xe!==null)for(_e[$e]=null,$e=0;$e<xe.length;$e++){var we=xe[$e];we!==null&&(we.lane&=-536870913)}x&=~Oe}C!==0&&MP(d,C,0),$!==0&&N===0&&d.tag!==0&&(d.suspendedLanes|=$&~(j&~y))}function MP(d,y,x){d.pendingLanes|=y,d.suspendedLanes&=~y;var C=31-Cs(y);d.entangledLanes|=y,d.entanglements[C]=d.entanglements[C]|1073741824|x&4194090}function AP(d,y){var x=d.entangledLanes|=y;for(d=d.entanglements;x;){var C=31-Cs(x),N=1<<C;N&y|d[C]&y&&(d[C]|=y),x&=~N}}function Nx(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function Dx(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function NP(){var d=W.p;return d!==0?d:(d=window.event,d===void 0?32:ZY(d.type))}function Se(d,y){var x=W.p;try{return W.p=d,y()}finally{W.p=x}}var ws=Math.random().toString(36).slice(2),sr="__reactFiber$"+ws,Ci="__reactProps$"+ws,Yu="__reactContainer$"+ws,ot="__reactEvents$"+ws,T0="__reactListeners$"+ws,qr="__reactHandles$"+ws,Hd="__reactResources$"+ws,Tg="__reactMarker$"+ws;function ll(d){delete d[sr],delete d[Ci],delete d[ot],delete d[T0],delete d[qr]}function am(d){var y=d[sr];if(y)return y;for(var x=d.parentNode;x;){if(y=x[Yu]||x[sr]){if(x=y.alternate,y.child!==null||x!==null&&x.child!==null)for(d=kY(d);d!==null;){if(x=d[sr])return x;d=kY(d)}return y}d=x,x=d.parentNode}return null}function lm(d){if(d=d[sr]||d[Yu]){var y=d.tag;if(y===5||y===6||y===13||y===26||y===27||y===3)return d}return null}function Tt(d){var y=d.tag;if(y===5||y===26||y===27||y===6)return d.stateNode;throw Error(i(33))}function Yd(d){var y=d[Hd];return y||(y=d[Hd]={hoistableStyles:new Map,hoistableScripts:new Map}),y}function Ir(d){d[Tg]=!0}var DP=new Set,$P={};function Xu(d,y){Xd(d,y),Xd(d+"Capture",y)}function Xd(d,y){for($P[d]=y,d=0;d<y.length;d++)DP.add(y[d])}var $x=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Mr={},RP={};function kP(d){return as.call(RP,d)?!0:as.call(Mr,d)?!1:$x.test(d)?RP[d]=!0:(Mr[d]=!0,!1)}function I0(d,y,x){if(kP(y))if(x===null)d.removeAttribute(y);else{switch(typeof x){case"undefined":case"function":case"symbol":d.removeAttribute(y);return;case"boolean":var C=y.toLowerCase().slice(0,5);if(C!=="data-"&&C!=="aria-"){d.removeAttribute(y);return}}d.setAttribute(y,""+x)}}function M0(d,y,x){if(x===null)d.removeAttribute(y);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(y);return}d.setAttribute(y,""+x)}}function Wu(d,y,x,C){if(C===null)d.removeAttribute(x);else{switch(typeof C){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(x);return}d.setAttributeNS(y,x,""+C)}}var Rx,FP;function un(d){if(Rx===void 0)try{throw Error()}catch(x){var y=x.stack.trim().match(/\n( *(at )?)/);Rx=y&&y[1]||"",FP=-1<x.stack.indexOf(`
    at`)?" (<anonymous>)":-1<x.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Rx+d+FP}var kx=!1;function Fx(d,y){if(!d||kx)return"";kx=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var C={DetermineComponentFrameRoot:function(){try{if(y){var Oe=function(){throw Error()};if(Object.defineProperty(Oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Oe,[])}catch(we){var xe=we}Reflect.construct(d,[],Oe)}else{try{Oe.call()}catch(we){xe=we}d.call(Oe.prototype)}}else{try{throw Error()}catch(we){xe=we}(Oe=d())&&typeof Oe.catch=="function"&&Oe.catch(function(){})}}catch(we){if(we&&xe&&typeof we.stack=="string")return[we.stack,xe.stack]}return[null,null]}};C.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(C.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(C.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var $=C.DetermineComponentFrameRoot(),j=$[0],J=$[1];if(j&&J){var oe=j.split(`
`),_e=J.split(`
`);for(N=C=0;C<oe.length&&!oe[C].includes("DetermineComponentFrameRoot");)C++;for(;N<_e.length&&!_e[N].includes("DetermineComponentFrameRoot");)N++;if(C===oe.length||N===_e.length)for(C=oe.length-1,N=_e.length-1;1<=C&&0<=N&&oe[C]!==_e[N];)N--;for(;1<=C&&0<=N;C--,N--)if(oe[C]!==_e[N]){if(C!==1||N!==1)do if(C--,N--,0>N||oe[C]!==_e[N]){var $e=`
`+oe[C].replace(" at new "," at ");return d.displayName&&$e.includes("<anonymous>")&&($e=$e.replace("<anonymous>",d.displayName)),$e}while(1<=C&&0<=N);break}}}finally{kx=!1,Error.prepareStackTrace=x}return(x=d?d.displayName||d.name:"")?un(x):""}function re(d){switch(d.tag){case 26:case 27:case 5:return un(d.type);case 16:return un("Lazy");case 13:return un("Suspense");case 19:return un("SuspenseList");case 0:case 15:return Fx(d.type,!1);case 11:return Fx(d.type.render,!1);case 1:return Fx(d.type,!0);case 31:return un("Activity");default:return""}}function Ie(d){try{var y="";do y+=re(d),d=d.return;while(d);return y}catch(x){return`
Error generating stack: `+x.message+`
`+x.stack}}function Le(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Ct(d){var y=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(y==="checkbox"||y==="radio")}function ei(d){var y=Ct(d)?"checked":"value",x=Object.getOwnPropertyDescriptor(d.constructor.prototype,y),C=""+d[y];if(!d.hasOwnProperty(y)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var N=x.get,$=x.set;return Object.defineProperty(d,y,{configurable:!0,get:function(){return N.call(this)},set:function(j){C=""+j,$.call(this,j)}}),Object.defineProperty(d,y,{enumerable:x.enumerable}),{getValue:function(){return C},setValue:function(j){C=""+j},stopTracking:function(){d._valueTracker=null,delete d[y]}}}}function gi(d){d._valueTracker||(d._valueTracker=ei(d))}function dr(d){if(!d)return!1;var y=d._valueTracker;if(!y)return!0;var x=y.getValue(),C="";return d&&(C=Ct(d)?d.checked?"true":"false":d.value),d=C,d!==x?(y.setValue(d),!0):!1}function cn(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var sxe=/[\n"\\]/g;function iu(d){return d.replace(sxe,function(y){return"\\"+y.charCodeAt(0).toString(16)+" "})}function VR(d,y,x,C,N,$,j,J){d.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?d.type=j:d.removeAttribute("type"),y!=null?j==="number"?(y===0&&d.value===""||d.value!=y)&&(d.value=""+Le(y)):d.value!==""+Le(y)&&(d.value=""+Le(y)):j!=="submit"&&j!=="reset"||d.removeAttribute("value"),y!=null?qR(d,j,Le(y)):x!=null?qR(d,j,Le(x)):C!=null&&d.removeAttribute("value"),N==null&&$!=null&&(d.defaultChecked=!!$),N!=null&&(d.checked=N&&typeof N!="function"&&typeof N!="symbol"),J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"?d.name=""+Le(J):d.removeAttribute("name")}function TB(d,y,x,C,N,$,j,J){if($!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"&&(d.type=$),y!=null||x!=null){if(!($!=="submit"&&$!=="reset"||y!=null))return;x=x!=null?""+Le(x):"",y=y!=null?""+Le(y):x,J||y===d.value||(d.value=y),d.defaultValue=y}C=C??N,C=typeof C!="function"&&typeof C!="symbol"&&!!C,d.checked=J?d.checked:!!C,d.defaultChecked=!!C,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(d.name=j)}function qR(d,y,x){y==="number"&&cn(d.ownerDocument)===d||d.defaultValue===""+x||(d.defaultValue=""+x)}function A0(d,y,x,C){if(d=d.options,y){y={};for(var N=0;N<x.length;N++)y["$"+x[N]]=!0;for(x=0;x<d.length;x++)N=y.hasOwnProperty("$"+d[x].value),d[x].selected!==N&&(d[x].selected=N),N&&C&&(d[x].defaultSelected=!0)}else{for(x=""+Le(x),y=null,N=0;N<d.length;N++){if(d[N].value===x){d[N].selected=!0,C&&(d[N].defaultSelected=!0);return}y!==null||d[N].disabled||(y=d[N])}y!==null&&(y.selected=!0)}}function IB(d,y,x){if(y!=null&&(y=""+Le(y),y!==d.value&&(d.value=y),x==null)){d.defaultValue!==y&&(d.defaultValue=y);return}d.defaultValue=x!=null?""+Le(x):""}function MB(d,y,x,C){if(y==null){if(C!=null){if(x!=null)throw Error(i(92));if(B(C)){if(1<C.length)throw Error(i(93));C=C[0]}x=C}x==null&&(x=""),y=x}x=Le(y),d.defaultValue=x,C=d.textContent,C===x&&C!==""&&C!==null&&(d.value=C)}function N0(d,y){if(y){var x=d.firstChild;if(x&&x===d.lastChild&&x.nodeType===3){x.nodeValue=y;return}}d.textContent=y}var ixe=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function AB(d,y,x){var C=y.indexOf("--")===0;x==null||typeof x=="boolean"||x===""?C?d.setProperty(y,""):y==="float"?d.cssFloat="":d[y]="":C?d.setProperty(y,x):typeof x!="number"||x===0||ixe.has(y)?y==="float"?d.cssFloat=x:d[y]=(""+x).trim():d[y]=x+"px"}function NB(d,y,x){if(y!=null&&typeof y!="object")throw Error(i(62));if(d=d.style,x!=null){for(var C in x)!x.hasOwnProperty(C)||y!=null&&y.hasOwnProperty(C)||(C.indexOf("--")===0?d.setProperty(C,""):C==="float"?d.cssFloat="":d[C]="");for(var N in y)C=y[N],y.hasOwnProperty(N)&&x[N]!==C&&AB(d,N,C)}else for(var $ in y)y.hasOwnProperty($)&&AB(d,$,y[$])}function GR(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rxe=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),nxe=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function OP(d){return nxe.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}var zR=null;function UR(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var D0=null,$0=null;function DB(d){var y=lm(d);if(y&&(d=y.stateNode)){var x=d[Ci]||null;e:switch(d=y.stateNode,y.type){case"input":if(VR(d,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name),y=x.name,x.type==="radio"&&y!=null){for(x=d;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll('input[name="'+iu(""+y)+'"][type="radio"]'),y=0;y<x.length;y++){var C=x[y];if(C!==d&&C.form===d.form){var N=C[Ci]||null;if(!N)throw Error(i(90));VR(C,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(y=0;y<x.length;y++)C=x[y],C.form===d.form&&dr(C)}break e;case"textarea":IB(d,x.value,x.defaultValue);break e;case"select":y=x.value,y!=null&&A0(d,!!x.multiple,y,!1)}}}var BR=!1;function $B(d,y,x){if(BR)return d(y,x);BR=!0;try{var C=d(y);return C}finally{if(BR=!1,(D0!==null||$0!==null)&&(wT(),D0&&(y=D0,d=$0,$0=D0=null,DB(y),d)))for(y=0;y<d.length;y++)DB(d[y])}}function Ox(d,y){var x=d.stateNode;if(x===null)return null;var C=x[Ci]||null;if(C===null)return null;x=C[y];e:switch(y){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(d=d.type,C=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!C;break e;default:d=!1}if(d)return null;if(x&&typeof x!="function")throw Error(i(231,y,typeof x));return x}var um=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jR=!1;if(um)try{var Lx={};Object.defineProperty(Lx,"passive",{get:function(){jR=!0}}),window.addEventListener("test",Lx,Lx),window.removeEventListener("test",Lx,Lx)}catch{jR=!1}var Wd=null,HR=null,LP=null;function RB(){if(LP)return LP;var d,y=HR,x=y.length,C,N="value"in Wd?Wd.value:Wd.textContent,$=N.length;for(d=0;d<x&&y[d]===N[d];d++);var j=x-d;for(C=1;C<=j&&y[x-C]===N[$-C];C++);return LP=N.slice(d,1<C?1-C:void 0)}function VP(d){var y=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&y===13&&(d=13)):d=y,d===10&&(d=13),32<=d||d===13?d:0}function qP(){return!0}function kB(){return!1}function Ca(d){function y(x,C,N,$,j){this._reactName=x,this._targetInst=N,this.type=C,this.nativeEvent=$,this.target=j,this.currentTarget=null;for(var J in d)d.hasOwnProperty(J)&&(x=d[J],this[J]=x?x($):$[J]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?qP:kB,this.isPropagationStopped=kB,this}return c(y.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=qP)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=qP)},persist:function(){},isPersistent:qP}),y}var Ig={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},GP=Ca(Ig),Vx=c({},Ig,{view:0,detail:0}),oxe=Ca(Vx),YR,XR,qx,zP=c({},Vx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ZR,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==qx&&(qx&&d.type==="mousemove"?(YR=d.screenX-qx.screenX,XR=d.screenY-qx.screenY):XR=YR=0,qx=d),YR)},movementY:function(d){return"movementY"in d?d.movementY:XR}}),FB=Ca(zP),axe=c({},zP,{dataTransfer:0}),lxe=Ca(axe),uxe=c({},Vx,{relatedTarget:0}),WR=Ca(uxe),cxe=c({},Ig,{animationName:0,elapsedTime:0,pseudoElement:0}),hxe=Ca(cxe),mxe=c({},Ig,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),dxe=Ca(mxe),pxe=c({},Ig,{data:0}),OB=Ca(pxe),fxe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gxe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yxe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _xe(d){var y=this.nativeEvent;return y.getModifierState?y.getModifierState(d):(d=yxe[d])?!!y[d]:!1}function ZR(){return _xe}var vxe=c({},Vx,{key:function(d){if(d.key){var y=fxe[d.key]||d.key;if(y!=="Unidentified")return y}return d.type==="keypress"?(d=VP(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?gxe[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ZR,charCode:function(d){return d.type==="keypress"?VP(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?VP(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),bxe=Ca(vxe),xxe=c({},zP,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),LB=Ca(xxe),wxe=c({},Vx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ZR}),Sxe=Ca(wxe),Exe=c({},Ig,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cxe=Ca(Exe),Pxe=c({},zP,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Txe=Ca(Pxe),Ixe=c({},Ig,{newState:0,oldState:0}),Mxe=Ca(Ixe),Axe=[9,13,27,32],QR=um&&"CompositionEvent"in window,Gx=null;um&&"documentMode"in document&&(Gx=document.documentMode);var Nxe=um&&"TextEvent"in window&&!Gx,VB=um&&(!QR||Gx&&8<Gx&&11>=Gx),qB=" ",GB=!1;function zB(d,y){switch(d){case"keyup":return Axe.indexOf(y.keyCode)!==-1;case"keydown":return y.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function UB(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var R0=!1;function Dxe(d,y){switch(d){case"compositionend":return UB(y);case"keypress":return y.which!==32?null:(GB=!0,qB);case"textInput":return d=y.data,d===qB&&GB?null:d;default:return null}}function $xe(d,y){if(R0)return d==="compositionend"||!QR&&zB(d,y)?(d=RB(),LP=HR=Wd=null,R0=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(y.ctrlKey||y.altKey||y.metaKey)||y.ctrlKey&&y.altKey){if(y.char&&1<y.char.length)return y.char;if(y.which)return String.fromCharCode(y.which)}return null;case"compositionend":return VB&&y.locale!=="ko"?null:y.data;default:return null}}var Rxe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BB(d){var y=d&&d.nodeName&&d.nodeName.toLowerCase();return y==="input"?!!Rxe[d.type]:y==="textarea"}function jB(d,y,x,C){D0?$0?$0.push(C):$0=[C]:D0=C,y=IT(y,"onChange"),0<y.length&&(x=new GP("onChange","change",null,x,C),d.push({event:x,listeners:y}))}var zx=null,Ux=null;function kxe(d){CY(d,0)}function UP(d){var y=Tt(d);if(dr(y))return d}function HB(d,y){if(d==="change")return y}var YB=!1;if(um){var JR;if(um){var KR="oninput"in document;if(!KR){var XB=document.createElement("div");XB.setAttribute("oninput","return;"),KR=typeof XB.oninput=="function"}JR=KR}else JR=!1;YB=JR&&(!document.documentMode||9<document.documentMode)}function WB(){zx&&(zx.detachEvent("onpropertychange",ZB),Ux=zx=null)}function ZB(d){if(d.propertyName==="value"&&UP(Ux)){var y=[];jB(y,Ux,d,UR(d)),$B(kxe,y)}}function Fxe(d,y,x){d==="focusin"?(WB(),zx=y,Ux=x,zx.attachEvent("onpropertychange",ZB)):d==="focusout"&&WB()}function Oxe(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return UP(Ux)}function Lxe(d,y){if(d==="click")return UP(y)}function Vxe(d,y){if(d==="input"||d==="change")return UP(y)}function qxe(d,y){return d===y&&(d!==0||1/d===1/y)||d!==d&&y!==y}var ul=typeof Object.is=="function"?Object.is:qxe;function Bx(d,y){if(ul(d,y))return!0;if(typeof d!="object"||d===null||typeof y!="object"||y===null)return!1;var x=Object.keys(d),C=Object.keys(y);if(x.length!==C.length)return!1;for(C=0;C<x.length;C++){var N=x[C];if(!as.call(y,N)||!ul(d[N],y[N]))return!1}return!0}function QB(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function JB(d,y){var x=QB(d);d=0;for(var C;x;){if(x.nodeType===3){if(C=d+x.textContent.length,d<=y&&C>=y)return{node:x,offset:y-d};d=C}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=QB(x)}}function KB(d,y){return d&&y?d===y?!0:d&&d.nodeType===3?!1:y&&y.nodeType===3?KB(d,y.parentNode):"contains"in d?d.contains(y):d.compareDocumentPosition?!!(d.compareDocumentPosition(y)&16):!1:!1}function ej(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var y=cn(d.document);y instanceof d.HTMLIFrameElement;){try{var x=typeof y.contentWindow.location.href=="string"}catch{x=!1}if(x)d=y.contentWindow;else break;y=cn(d.document)}return y}function ek(d){var y=d&&d.nodeName&&d.nodeName.toLowerCase();return y&&(y==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||y==="textarea"||d.contentEditable==="true")}var Gxe=um&&"documentMode"in document&&11>=document.documentMode,k0=null,tk=null,jx=null,sk=!1;function tj(d,y,x){var C=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;sk||k0==null||k0!==cn(C)||(C=k0,"selectionStart"in C&&ek(C)?C={start:C.selectionStart,end:C.selectionEnd}:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection(),C={anchorNode:C.anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset}),jx&&Bx(jx,C)||(jx=C,C=IT(tk,"onSelect"),0<C.length&&(y=new GP("onSelect","select",null,y,x),d.push({event:y,listeners:C}),y.target=k0)))}function Mg(d,y){var x={};return x[d.toLowerCase()]=y.toLowerCase(),x["Webkit"+d]="webkit"+y,x["Moz"+d]="moz"+y,x}var F0={animationend:Mg("Animation","AnimationEnd"),animationiteration:Mg("Animation","AnimationIteration"),animationstart:Mg("Animation","AnimationStart"),transitionrun:Mg("Transition","TransitionRun"),transitionstart:Mg("Transition","TransitionStart"),transitioncancel:Mg("Transition","TransitionCancel"),transitionend:Mg("Transition","TransitionEnd")},ik={},sj={};um&&(sj=document.createElement("div").style,"AnimationEvent"in window||(delete F0.animationend.animation,delete F0.animationiteration.animation,delete F0.animationstart.animation),"TransitionEvent"in window||delete F0.transitionend.transition);function Ag(d){if(ik[d])return ik[d];if(!F0[d])return d;var y=F0[d],x;for(x in y)if(y.hasOwnProperty(x)&&x in sj)return ik[d]=y[x];return d}var ij=Ag("animationend"),rj=Ag("animationiteration"),nj=Ag("animationstart"),zxe=Ag("transitionrun"),Uxe=Ag("transitionstart"),Bxe=Ag("transitioncancel"),oj=Ag("transitionend"),aj=new Map,rk="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rk.push("scrollEnd");function Zu(d,y){aj.set(d,y),Xu(y,[d])}var lj=new WeakMap;function ru(d,y){if(typeof d=="object"&&d!==null){var x=lj.get(d);return x!==void 0?x:(y={value:d,source:y,stack:Ie(y)},lj.set(d,y),y)}return{value:d,source:y,stack:Ie(y)}}var nu=[],O0=0,nk=0;function BP(){for(var d=O0,y=nk=O0=0;y<d;){var x=nu[y];nu[y++]=null;var C=nu[y];nu[y++]=null;var N=nu[y];nu[y++]=null;var $=nu[y];if(nu[y++]=null,C!==null&&N!==null){var j=C.pending;j===null?N.next=N:(N.next=j.next,j.next=N),C.pending=N}$!==0&&uj(x,N,$)}}function jP(d,y,x,C){nu[O0++]=d,nu[O0++]=y,nu[O0++]=x,nu[O0++]=C,nk|=C,d.lanes|=C,d=d.alternate,d!==null&&(d.lanes|=C)}function ok(d,y,x,C){return jP(d,y,x,C),HP(d)}function L0(d,y){return jP(d,null,null,y),HP(d)}function uj(d,y,x){d.lanes|=x;var C=d.alternate;C!==null&&(C.lanes|=x);for(var N=!1,$=d.return;$!==null;)$.childLanes|=x,C=$.alternate,C!==null&&(C.childLanes|=x),$.tag===22&&(d=$.stateNode,d===null||d._visibility&1||(N=!0)),d=$,$=$.return;return d.tag===3?($=d.stateNode,N&&y!==null&&(N=31-Cs(x),d=$.hiddenUpdates,C=d[N],C===null?d[N]=[y]:C.push(y),y.lane=x|536870912),$):null}function HP(d){if(50<gw)throw gw=0,mF=null,Error(i(185));for(var y=d.return;y!==null;)d=y,y=d.return;return d.tag===3?d.stateNode:null}var V0={};function jxe(d,y,x,C){this.tag=d,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cl(d,y,x,C){return new jxe(d,y,x,C)}function ak(d){return d=d.prototype,!(!d||!d.isReactComponent)}function cm(d,y){var x=d.alternate;return x===null?(x=cl(d.tag,y,d.key,d.mode),x.elementType=d.elementType,x.type=d.type,x.stateNode=d.stateNode,x.alternate=d,d.alternate=x):(x.pendingProps=y,x.type=d.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=d.flags&65011712,x.childLanes=d.childLanes,x.lanes=d.lanes,x.child=d.child,x.memoizedProps=d.memoizedProps,x.memoizedState=d.memoizedState,x.updateQueue=d.updateQueue,y=d.dependencies,x.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},x.sibling=d.sibling,x.index=d.index,x.ref=d.ref,x.refCleanup=d.refCleanup,x}function cj(d,y){d.flags&=65011714;var x=d.alternate;return x===null?(d.childLanes=0,d.lanes=y,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=x.childLanes,d.lanes=x.lanes,d.child=x.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=x.memoizedProps,d.memoizedState=x.memoizedState,d.updateQueue=x.updateQueue,d.type=x.type,y=x.dependencies,d.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),d}function YP(d,y,x,C,N,$){var j=0;if(C=d,typeof d=="function")ak(d)&&(j=1);else if(typeof d=="string")j=Ywe(d,x,Fe.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case R:return d=cl(31,x,y,N),d.elementType=R,d.lanes=$,d;case g:return Ng(x.children,N,$,y);case v:j=8,N|=24;break;case b:return d=cl(12,x,y,N|2),d.elementType=b,d.lanes=$,d;case I:return d=cl(13,x,y,N),d.elementType=I,d.lanes=$,d;case A:return d=cl(19,x,y,N),d.elementType=A,d.lanes=$,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case w:case T:j=10;break e;case S:j=9;break e;case P:j=11;break e;case D:j=14;break e;case k:j=16,C=null;break e}j=29,x=Error(i(130,d===null?"null":typeof d,"")),C=null}return y=cl(j,x,y,N),y.elementType=d,y.type=C,y.lanes=$,y}function Ng(d,y,x,C){return d=cl(7,d,C,y),d.lanes=x,d}function lk(d,y,x){return d=cl(6,d,null,y),d.lanes=x,d}function uk(d,y,x){return y=cl(4,d.children!==null?d.children:[],d.key,y),y.lanes=x,y.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},y}var q0=[],G0=0,XP=null,WP=0,ou=[],au=0,Dg=null,hm=1,mm="";function $g(d,y){q0[G0++]=WP,q0[G0++]=XP,XP=d,WP=y}function hj(d,y,x){ou[au++]=hm,ou[au++]=mm,ou[au++]=Dg,Dg=d;var C=hm;d=mm;var N=32-Cs(C)-1;C&=~(1<<N),x+=1;var $=32-Cs(y)+N;if(30<$){var j=N-N%5;$=(C&(1<<j)-1).toString(32),C>>=j,N-=j,hm=1<<32-Cs(y)+N|x<<N|C,mm=$+d}else hm=1<<$|x<<N|C,mm=d}function ck(d){d.return!==null&&($g(d,1),hj(d,1,0))}function hk(d){for(;d===XP;)XP=q0[--G0],q0[G0]=null,WP=q0[--G0],q0[G0]=null;for(;d===Dg;)Dg=ou[--au],ou[au]=null,mm=ou[--au],ou[au]=null,hm=ou[--au],ou[au]=null}var Wo=null,pr=null,Fs=!1,Rg=null,rh=!1,mk=Error(i(519));function kg(d){var y=Error(i(418,""));throw Xx(ru(y,d)),mk}function mj(d){var y=d.stateNode,x=d.type,C=d.memoizedProps;switch(y[sr]=d,y[Ci]=C,x){case"dialog":us("cancel",y),us("close",y);break;case"iframe":case"object":case"embed":us("load",y);break;case"video":case"audio":for(x=0;x<_w.length;x++)us(_w[x],y);break;case"source":us("error",y);break;case"img":case"image":case"link":us("error",y),us("load",y);break;case"details":us("toggle",y);break;case"input":us("invalid",y),TB(y,C.value,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name,!0),gi(y);break;case"select":us("invalid",y);break;case"textarea":us("invalid",y),MB(y,C.value,C.defaultValue,C.children),gi(y)}x=C.children,typeof x!="string"&&typeof x!="number"&&typeof x!="bigint"||y.textContent===""+x||C.suppressHydrationWarning===!0||MY(y.textContent,x)?(C.popover!=null&&(us("beforetoggle",y),us("toggle",y)),C.onScroll!=null&&us("scroll",y),C.onScrollEnd!=null&&us("scrollend",y),C.onClick!=null&&(y.onclick=MT),y=!0):y=!1,y||kg(d)}function dj(d){for(Wo=d.return;Wo;)switch(Wo.tag){case 5:case 13:rh=!1;return;case 27:case 3:rh=!0;return;default:Wo=Wo.return}}function Hx(d){if(d!==Wo)return!1;if(!Fs)return dj(d),Fs=!0,!1;var y=d.tag,x;if((x=y!==3&&y!==27)&&((x=y===5)&&(x=d.type,x=!(x!=="form"&&x!=="button")||IF(d.type,d.memoizedProps)),x=!x),x&&pr&&kg(d),dj(d),y===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(i(317));e:{for(d=d.nextSibling,y=0;d;){if(d.nodeType===8)if(x=d.data,x==="/$"){if(y===0){pr=Ju(d.nextSibling);break e}y--}else x!=="$"&&x!=="$!"&&x!=="$?"||y++;d=d.nextSibling}pr=null}}else y===27?(y=pr,hp(d.type)?(d=DF,DF=null,pr=d):pr=y):pr=Wo?Ju(d.stateNode.nextSibling):null;return!0}function Yx(){pr=Wo=null,Fs=!1}function pj(){var d=Rg;return d!==null&&(Ia===null?Ia=d:Ia.push.apply(Ia,d),Rg=null),d}function Xx(d){Rg===null?Rg=[d]:Rg.push(d)}var dk=te(null),Fg=null,dm=null;function Zd(d,y,x){ke(dk,y._currentValue),y._currentValue=x}function pm(d){d._currentValue=dk.current,ve(dk)}function pk(d,y,x){for(;d!==null;){var C=d.alternate;if((d.childLanes&y)!==y?(d.childLanes|=y,C!==null&&(C.childLanes|=y)):C!==null&&(C.childLanes&y)!==y&&(C.childLanes|=y),d===x)break;d=d.return}}function fk(d,y,x,C){var N=d.child;for(N!==null&&(N.return=d);N!==null;){var $=N.dependencies;if($!==null){var j=N.child;$=$.firstContext;e:for(;$!==null;){var J=$;$=N;for(var oe=0;oe<y.length;oe++)if(J.context===y[oe]){$.lanes|=x,J=$.alternate,J!==null&&(J.lanes|=x),pk($.return,x,d),C||(j=null);break e}$=J.next}}else if(N.tag===18){if(j=N.return,j===null)throw Error(i(341));j.lanes|=x,$=j.alternate,$!==null&&($.lanes|=x),pk(j,x,d),j=null}else j=N.child;if(j!==null)j.return=N;else for(j=N;j!==null;){if(j===d){j=null;break}if(N=j.sibling,N!==null){N.return=j.return,j=N;break}j=j.return}N=j}}function Wx(d,y,x,C){d=null;for(var N=y,$=!1;N!==null;){if(!$){if((N.flags&524288)!==0)$=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var j=N.alternate;if(j===null)throw Error(i(387));if(j=j.memoizedProps,j!==null){var J=N.type;ul(N.pendingProps.value,j.value)||(d!==null?d.push(J):d=[J])}}else if(N===Ke.current){if(j=N.alternate,j===null)throw Error(i(387));j.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(d!==null?d.push(Ew):d=[Ew])}N=N.return}d!==null&&fk(y,d,x,C),y.flags|=262144}function ZP(d){for(d=d.firstContext;d!==null;){if(!ul(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function Og(d){Fg=d,dm=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function _o(d){return fj(Fg,d)}function QP(d,y){return Fg===null&&Og(d),fj(d,y)}function fj(d,y){var x=y._currentValue;if(y={context:y,memoizedValue:x,next:null},dm===null){if(d===null)throw Error(i(308));dm=y,d.dependencies={lanes:0,firstContext:y},d.flags|=524288}else dm=dm.next=y;return x}var Hxe=typeof AbortController<"u"?AbortController:function(){var d=[],y=this.signal={aborted:!1,addEventListener:function(x,C){d.push(C)}};this.abort=function(){y.aborted=!0,d.forEach(function(x){return x()})}},Yxe=t.unstable_scheduleCallback,Xxe=t.unstable_NormalPriority,hn={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function gk(){return{controller:new Hxe,data:new Map,refCount:0}}function Zx(d){d.refCount--,d.refCount===0&&Yxe(Xxe,function(){d.controller.abort()})}var Qx=null,yk=0,z0=0,U0=null;function Wxe(d,y){if(Qx===null){var x=Qx=[];yk=0,z0=vF(),U0={status:"pending",value:void 0,then:function(C){x.push(C)}}}return yk++,y.then(gj,gj),y}function gj(){if(--yk===0&&Qx!==null){U0!==null&&(U0.status="fulfilled");var d=Qx;Qx=null,z0=0,U0=null;for(var y=0;y<d.length;y++)(0,d[y])()}}function Zxe(d,y){var x=[],C={status:"pending",value:null,reason:null,then:function(N){x.push(N)}};return d.then(function(){C.status="fulfilled",C.value=y;for(var N=0;N<x.length;N++)(0,x[N])(y)},function(N){for(C.status="rejected",C.reason=N,N=0;N<x.length;N++)(0,x[N])(void 0)}),C}var yj=H.S;H.S=function(d,y){typeof y=="object"&&y!==null&&typeof y.then=="function"&&Wxe(d,y),yj!==null&&yj(d,y)};var Lg=te(null);function _k(){var d=Lg.current;return d!==null?d:Pi.pooledCache}function JP(d,y){y===null?ke(Lg,Lg.current):ke(Lg,y.pool)}function _j(){var d=_k();return d===null?null:{parent:hn._currentValue,pool:d}}var Jx=Error(i(460)),vj=Error(i(474)),KP=Error(i(542)),vk={then:function(){}};function bj(d){return d=d.status,d==="fulfilled"||d==="rejected"}function eT(){}function xj(d,y,x){switch(x=d[x],x===void 0?d.push(y):x!==y&&(y.then(eT,eT),y=x),y.status){case"fulfilled":return y.value;case"rejected":throw d=y.reason,Sj(d),d;default:if(typeof y.status=="string")y.then(eT,eT);else{if(d=Pi,d!==null&&100<d.shellSuspendCounter)throw Error(i(482));d=y,d.status="pending",d.then(function(C){if(y.status==="pending"){var N=y;N.status="fulfilled",N.value=C}},function(C){if(y.status==="pending"){var N=y;N.status="rejected",N.reason=C}})}switch(y.status){case"fulfilled":return y.value;case"rejected":throw d=y.reason,Sj(d),d}throw Kx=y,Jx}}var Kx=null;function wj(){if(Kx===null)throw Error(i(459));var d=Kx;return Kx=null,d}function Sj(d){if(d===Jx||d===KP)throw Error(i(483))}var Qd=!1;function bk(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xk(d,y){d=d.updateQueue,y.updateQueue===d&&(y.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function Jd(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function Kd(d,y,x){var C=d.updateQueue;if(C===null)return null;if(C=C.shared,(ti&2)!==0){var N=C.pending;return N===null?y.next=y:(y.next=N.next,N.next=y),C.pending=y,y=HP(d),uj(d,null,x),y}return jP(d,C,y,x),HP(d)}function ew(d,y,x){if(y=y.updateQueue,y!==null&&(y=y.shared,(x&4194048)!==0)){var C=y.lanes;C&=d.pendingLanes,x|=C,y.lanes=x,AP(d,x)}}function wk(d,y){var x=d.updateQueue,C=d.alternate;if(C!==null&&(C=C.updateQueue,x===C)){var N=null,$=null;if(x=x.firstBaseUpdate,x!==null){do{var j={lane:x.lane,tag:x.tag,payload:x.payload,callback:null,next:null};$===null?N=$=j:$=$.next=j,x=x.next}while(x!==null);$===null?N=$=y:$=$.next=y}else N=$=y;x={baseState:C.baseState,firstBaseUpdate:N,lastBaseUpdate:$,shared:C.shared,callbacks:C.callbacks},d.updateQueue=x;return}d=x.lastBaseUpdate,d===null?x.firstBaseUpdate=y:d.next=y,x.lastBaseUpdate=y}var Sk=!1;function tw(){if(Sk){var d=U0;if(d!==null)throw d}}function sw(d,y,x,C){Sk=!1;var N=d.updateQueue;Qd=!1;var $=N.firstBaseUpdate,j=N.lastBaseUpdate,J=N.shared.pending;if(J!==null){N.shared.pending=null;var oe=J,_e=oe.next;oe.next=null,j===null?$=_e:j.next=_e,j=oe;var $e=d.alternate;$e!==null&&($e=$e.updateQueue,J=$e.lastBaseUpdate,J!==j&&(J===null?$e.firstBaseUpdate=_e:J.next=_e,$e.lastBaseUpdate=oe))}if($!==null){var Oe=N.baseState;j=0,$e=_e=oe=null,J=$;do{var xe=J.lane&-536870913,we=xe!==J.lane;if(we?(_s&xe)===xe:(C&xe)===xe){xe!==0&&xe===z0&&(Sk=!0),$e!==null&&($e=$e.next={lane:0,tag:J.tag,payload:J.payload,callback:null,next:null});e:{var Dt=d,It=J;xe=y;var ui=x;switch(It.tag){case 1:if(Dt=It.payload,typeof Dt=="function"){Oe=Dt.call(ui,Oe,xe);break e}Oe=Dt;break e;case 3:Dt.flags=Dt.flags&-65537|128;case 0:if(Dt=It.payload,xe=typeof Dt=="function"?Dt.call(ui,Oe,xe):Dt,xe==null)break e;Oe=c({},Oe,xe);break e;case 2:Qd=!0}}xe=J.callback,xe!==null&&(d.flags|=64,we&&(d.flags|=8192),we=N.callbacks,we===null?N.callbacks=[xe]:we.push(xe))}else we={lane:xe,tag:J.tag,payload:J.payload,callback:J.callback,next:null},$e===null?(_e=$e=we,oe=Oe):$e=$e.next=we,j|=xe;if(J=J.next,J===null){if(J=N.shared.pending,J===null)break;we=J,J=we.next,we.next=null,N.lastBaseUpdate=we,N.shared.pending=null}}while(!0);$e===null&&(oe=Oe),N.baseState=oe,N.firstBaseUpdate=_e,N.lastBaseUpdate=$e,$===null&&(N.shared.lanes=0),ap|=j,d.lanes=j,d.memoizedState=Oe}}function Ej(d,y){if(typeof d!="function")throw Error(i(191,d));d.call(y)}function Cj(d,y){var x=d.callbacks;if(x!==null)for(d.callbacks=null,d=0;d<x.length;d++)Ej(x[d],y)}var B0=te(null),tT=te(0);function Pj(d,y){d=xm,ke(tT,d),ke(B0,y),xm=d|y.baseLanes}function Ek(){ke(tT,xm),ke(B0,B0.current)}function Ck(){xm=tT.current,ve(B0),ve(tT)}var ep=0,es=null,ai=null,Gr=null,sT=!1,j0=!1,Vg=!1,iT=0,iw=0,H0=null,Qxe=0;function Ar(){throw Error(i(321))}function Pk(d,y){if(y===null)return!1;for(var x=0;x<y.length&&x<d.length;x++)if(!ul(d[x],y[x]))return!1;return!0}function Tk(d,y,x,C,N,$){return ep=$,es=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,H.H=d===null||d.memoizedState===null?uH:cH,Vg=!1,$=x(C,N),Vg=!1,j0&&($=Ij(y,x,C,N)),Tj(d),$}function Tj(d){H.H=uT;var y=ai!==null&&ai.next!==null;if(ep=0,Gr=ai=es=null,sT=!1,iw=0,H0=null,y)throw Error(i(300));d===null||Tn||(d=d.dependencies,d!==null&&ZP(d)&&(Tn=!0))}function Ij(d,y,x,C){es=d;var N=0;do{if(j0&&(H0=null),iw=0,j0=!1,25<=N)throw Error(i(301));if(N+=1,Gr=ai=null,d.updateQueue!=null){var $=d.updateQueue;$.lastEffect=null,$.events=null,$.stores=null,$.memoCache!=null&&($.memoCache.index=0)}H.H=rwe,$=y(x,C)}while(j0);return $}function Jxe(){var d=H.H,y=d.useState()[0];return y=typeof y.then=="function"?rw(y):y,d=d.useState()[0],(ai!==null?ai.memoizedState:null)!==d&&(es.flags|=1024),y}function Ik(){var d=iT!==0;return iT=0,d}function Mk(d,y,x){y.updateQueue=d.updateQueue,y.flags&=-2053,d.lanes&=~x}function Ak(d){if(sT){for(d=d.memoizedState;d!==null;){var y=d.queue;y!==null&&(y.pending=null),d=d.next}sT=!1}ep=0,Gr=ai=es=null,j0=!1,iw=iT=0,H0=null}function Pa(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gr===null?es.memoizedState=Gr=d:Gr=Gr.next=d,Gr}function zr(){if(ai===null){var d=es.alternate;d=d!==null?d.memoizedState:null}else d=ai.next;var y=Gr===null?es.memoizedState:Gr.next;if(y!==null)Gr=y,ai=d;else{if(d===null)throw es.alternate===null?Error(i(467)):Error(i(310));ai=d,d={memoizedState:ai.memoizedState,baseState:ai.baseState,baseQueue:ai.baseQueue,queue:ai.queue,next:null},Gr===null?es.memoizedState=Gr=d:Gr=Gr.next=d}return Gr}function Nk(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rw(d){var y=iw;return iw+=1,H0===null&&(H0=[]),d=xj(H0,d,y),y=es,(Gr===null?y.memoizedState:Gr.next)===null&&(y=y.alternate,H.H=y===null||y.memoizedState===null?uH:cH),d}function rT(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return rw(d);if(d.$$typeof===T)return _o(d)}throw Error(i(438,String(d)))}function Dk(d){var y=null,x=es.updateQueue;if(x!==null&&(y=x.memoCache),y==null){var C=es.alternate;C!==null&&(C=C.updateQueue,C!==null&&(C=C.memoCache,C!=null&&(y={data:C.data.map(function(N){return N.slice()}),index:0})))}if(y==null&&(y={data:[],index:0}),x===null&&(x=Nk(),es.updateQueue=x),x.memoCache=y,x=y.data[y.index],x===void 0)for(x=y.data[y.index]=Array(d),C=0;C<d;C++)x[C]=O;return y.index++,x}function fm(d,y){return typeof y=="function"?y(d):y}function nT(d){var y=zr();return $k(y,ai,d)}function $k(d,y,x){var C=d.queue;if(C===null)throw Error(i(311));C.lastRenderedReducer=x;var N=d.baseQueue,$=C.pending;if($!==null){if(N!==null){var j=N.next;N.next=$.next,$.next=j}y.baseQueue=N=$,C.pending=null}if($=d.baseState,N===null)d.memoizedState=$;else{y=N.next;var J=j=null,oe=null,_e=y,$e=!1;do{var Oe=_e.lane&-536870913;if(Oe!==_e.lane?(_s&Oe)===Oe:(ep&Oe)===Oe){var xe=_e.revertLane;if(xe===0)oe!==null&&(oe=oe.next={lane:0,revertLane:0,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null}),Oe===z0&&($e=!0);else if((ep&xe)===xe){_e=_e.next,xe===z0&&($e=!0);continue}else Oe={lane:0,revertLane:_e.revertLane,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null},oe===null?(J=oe=Oe,j=$):oe=oe.next=Oe,es.lanes|=xe,ap|=xe;Oe=_e.action,Vg&&x($,Oe),$=_e.hasEagerState?_e.eagerState:x($,Oe)}else xe={lane:Oe,revertLane:_e.revertLane,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null},oe===null?(J=oe=xe,j=$):oe=oe.next=xe,es.lanes|=Oe,ap|=Oe;_e=_e.next}while(_e!==null&&_e!==y);if(oe===null?j=$:oe.next=J,!ul($,d.memoizedState)&&(Tn=!0,$e&&(x=U0,x!==null)))throw x;d.memoizedState=$,d.baseState=j,d.baseQueue=oe,C.lastRenderedState=$}return N===null&&(C.lanes=0),[d.memoizedState,C.dispatch]}function Rk(d){var y=zr(),x=y.queue;if(x===null)throw Error(i(311));x.lastRenderedReducer=d;var C=x.dispatch,N=x.pending,$=y.memoizedState;if(N!==null){x.pending=null;var j=N=N.next;do $=d($,j.action),j=j.next;while(j!==N);ul($,y.memoizedState)||(Tn=!0),y.memoizedState=$,y.baseQueue===null&&(y.baseState=$),x.lastRenderedState=$}return[$,C]}function Mj(d,y,x){var C=es,N=zr(),$=Fs;if($){if(x===void 0)throw Error(i(407));x=x()}else x=y();var j=!ul((ai||N).memoizedState,x);j&&(N.memoizedState=x,Tn=!0),N=N.queue;var J=Dj.bind(null,C,N,d);if(nw(2048,8,J,[d]),N.getSnapshot!==y||j||Gr!==null&&Gr.memoizedState.tag&1){if(C.flags|=2048,Y0(9,oT(),Nj.bind(null,C,N,x,y),null),Pi===null)throw Error(i(349));$||(ep&124)!==0||Aj(C,y,x)}return x}function Aj(d,y,x){d.flags|=16384,d={getSnapshot:y,value:x},y=es.updateQueue,y===null?(y=Nk(),es.updateQueue=y,y.stores=[d]):(x=y.stores,x===null?y.stores=[d]:x.push(d))}function Nj(d,y,x,C){y.value=x,y.getSnapshot=C,$j(y)&&Rj(d)}function Dj(d,y,x){return x(function(){$j(y)&&Rj(d)})}function $j(d){var y=d.getSnapshot;d=d.value;try{var x=y();return!ul(d,x)}catch{return!0}}function Rj(d){var y=L0(d,2);y!==null&&fl(y,d,2)}function kk(d){var y=Pa();if(typeof d=="function"){var x=d;if(d=x(),Vg){Ei(!0);try{x()}finally{Ei(!1)}}}return y.memoizedState=y.baseState=d,y.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fm,lastRenderedState:d},y}function kj(d,y,x,C){return d.baseState=x,$k(d,ai,typeof C=="function"?C:fm)}function Kxe(d,y,x,C,N){if(lT(d))throw Error(i(485));if(d=y.action,d!==null){var $={payload:N,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){$.listeners.push(j)}};H.T!==null?x(!0):$.isTransition=!1,C($),x=y.pending,x===null?($.next=y.pending=$,Fj(y,$)):($.next=x.next,y.pending=x.next=$)}}function Fj(d,y){var x=y.action,C=y.payload,N=d.state;if(y.isTransition){var $=H.T,j={};H.T=j;try{var J=x(N,C),oe=H.S;oe!==null&&oe(j,J),Oj(d,y,J)}catch(_e){Fk(d,y,_e)}finally{H.T=$}}else try{$=x(N,C),Oj(d,y,$)}catch(_e){Fk(d,y,_e)}}function Oj(d,y,x){x!==null&&typeof x=="object"&&typeof x.then=="function"?x.then(function(C){Lj(d,y,C)},function(C){return Fk(d,y,C)}):Lj(d,y,x)}function Lj(d,y,x){y.status="fulfilled",y.value=x,Vj(y),d.state=x,y=d.pending,y!==null&&(x=y.next,x===y?d.pending=null:(x=x.next,y.next=x,Fj(d,x)))}function Fk(d,y,x){var C=d.pending;if(d.pending=null,C!==null){C=C.next;do y.status="rejected",y.reason=x,Vj(y),y=y.next;while(y!==C)}d.action=null}function Vj(d){d=d.listeners;for(var y=0;y<d.length;y++)(0,d[y])()}function qj(d,y){return y}function Gj(d,y){if(Fs){var x=Pi.formState;if(x!==null){e:{var C=es;if(Fs){if(pr){t:{for(var N=pr,$=rh;N.nodeType!==8;){if(!$){N=null;break t}if(N=Ju(N.nextSibling),N===null){N=null;break t}}$=N.data,N=$==="F!"||$==="F"?N:null}if(N){pr=Ju(N.nextSibling),C=N.data==="F!";break e}}kg(C)}C=!1}C&&(y=x[0])}}return x=Pa(),x.memoizedState=x.baseState=y,C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qj,lastRenderedState:y},x.queue=C,x=oH.bind(null,es,C),C.dispatch=x,C=kk(!1),$=Gk.bind(null,es,!1,C.queue),C=Pa(),N={state:y,dispatch:null,action:d,pending:null},C.queue=N,x=Kxe.bind(null,es,N,$,x),N.dispatch=x,C.memoizedState=d,[y,x,!1]}function zj(d){var y=zr();return Uj(y,ai,d)}function Uj(d,y,x){if(y=$k(d,y,qj)[0],d=nT(fm)[0],typeof y=="object"&&y!==null&&typeof y.then=="function")try{var C=rw(y)}catch(j){throw j===Jx?KP:j}else C=y;y=zr();var N=y.queue,$=N.dispatch;return x!==y.memoizedState&&(es.flags|=2048,Y0(9,oT(),ewe.bind(null,N,x),null)),[C,$,d]}function ewe(d,y){d.action=y}function Bj(d){var y=zr(),x=ai;if(x!==null)return Uj(y,x,d);zr(),y=y.memoizedState,x=zr();var C=x.queue.dispatch;return x.memoizedState=d,[y,C,!1]}function Y0(d,y,x,C){return d={tag:d,create:x,deps:C,inst:y,next:null},y=es.updateQueue,y===null&&(y=Nk(),es.updateQueue=y),x=y.lastEffect,x===null?y.lastEffect=d.next=d:(C=x.next,x.next=d,d.next=C,y.lastEffect=d),d}function oT(){return{destroy:void 0,resource:void 0}}function jj(){return zr().memoizedState}function aT(d,y,x,C){var N=Pa();C=C===void 0?null:C,es.flags|=d,N.memoizedState=Y0(1|y,oT(),x,C)}function nw(d,y,x,C){var N=zr();C=C===void 0?null:C;var $=N.memoizedState.inst;ai!==null&&C!==null&&Pk(C,ai.memoizedState.deps)?N.memoizedState=Y0(y,$,x,C):(es.flags|=d,N.memoizedState=Y0(1|y,$,x,C))}function Hj(d,y){aT(8390656,8,d,y)}function Yj(d,y){nw(2048,8,d,y)}function Xj(d,y){return nw(4,2,d,y)}function Wj(d,y){return nw(4,4,d,y)}function Zj(d,y){if(typeof y=="function"){d=d();var x=y(d);return function(){typeof x=="function"?x():y(null)}}if(y!=null)return d=d(),y.current=d,function(){y.current=null}}function Qj(d,y,x){x=x!=null?x.concat([d]):null,nw(4,4,Zj.bind(null,y,d),x)}function Ok(){}function Jj(d,y){var x=zr();y=y===void 0?null:y;var C=x.memoizedState;return y!==null&&Pk(y,C[1])?C[0]:(x.memoizedState=[d,y],d)}function Kj(d,y){var x=zr();y=y===void 0?null:y;var C=x.memoizedState;if(y!==null&&Pk(y,C[1]))return C[0];if(C=d(),Vg){Ei(!0);try{d()}finally{Ei(!1)}}return x.memoizedState=[C,y],C}function Lk(d,y,x){return x===void 0||(ep&1073741824)!==0?d.memoizedState=y:(d.memoizedState=x,d=sY(),es.lanes|=d,ap|=d,x)}function eH(d,y,x,C){return ul(x,y)?x:B0.current!==null?(d=Lk(d,x,C),ul(d,y)||(Tn=!0),d):(ep&42)===0?(Tn=!0,d.memoizedState=x):(d=sY(),es.lanes|=d,ap|=d,y)}function tH(d,y,x,C,N){var $=W.p;W.p=$!==0&&8>$?$:8;var j=H.T,J={};H.T=J,Gk(d,!1,y,x);try{var oe=N(),_e=H.S;if(_e!==null&&_e(J,oe),oe!==null&&typeof oe=="object"&&typeof oe.then=="function"){var $e=Zxe(oe,C);ow(d,y,$e,pl(d))}else ow(d,y,C,pl(d))}catch(Oe){ow(d,y,{then:function(){},status:"rejected",reason:Oe},pl())}finally{W.p=$,H.T=j}}function twe(){}function Vk(d,y,x,C){if(d.tag!==5)throw Error(i(476));var N=sH(d).queue;tH(d,N,y,ie,x===null?twe:function(){return iH(d),x(C)})}function sH(d){var y=d.memoizedState;if(y!==null)return y;y={memoizedState:ie,baseState:ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fm,lastRenderedState:ie},next:null};var x={};return y.next={memoizedState:x,baseState:x,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fm,lastRenderedState:x},next:null},d.memoizedState=y,d=d.alternate,d!==null&&(d.memoizedState=y),y}function iH(d){var y=sH(d).next.queue;ow(d,y,{},pl())}function qk(){return _o(Ew)}function rH(){return zr().memoizedState}function nH(){return zr().memoizedState}function swe(d){for(var y=d.return;y!==null;){switch(y.tag){case 24:case 3:var x=pl();d=Jd(x);var C=Kd(y,d,x);C!==null&&(fl(C,y,x),ew(C,y,x)),y={cache:gk()},d.payload=y;return}y=y.return}}function iwe(d,y,x){var C=pl();x={lane:C,revertLane:0,action:x,hasEagerState:!1,eagerState:null,next:null},lT(d)?aH(y,x):(x=ok(d,y,x,C),x!==null&&(fl(x,d,C),lH(x,y,C)))}function oH(d,y,x){var C=pl();ow(d,y,x,C)}function ow(d,y,x,C){var N={lane:C,revertLane:0,action:x,hasEagerState:!1,eagerState:null,next:null};if(lT(d))aH(y,N);else{var $=d.alternate;if(d.lanes===0&&($===null||$.lanes===0)&&($=y.lastRenderedReducer,$!==null))try{var j=y.lastRenderedState,J=$(j,x);if(N.hasEagerState=!0,N.eagerState=J,ul(J,j))return jP(d,y,N,0),Pi===null&&BP(),!1}catch{}finally{}if(x=ok(d,y,N,C),x!==null)return fl(x,d,C),lH(x,y,C),!0}return!1}function Gk(d,y,x,C){if(C={lane:2,revertLane:vF(),action:C,hasEagerState:!1,eagerState:null,next:null},lT(d)){if(y)throw Error(i(479))}else y=ok(d,x,C,2),y!==null&&fl(y,d,2)}function lT(d){var y=d.alternate;return d===es||y!==null&&y===es}function aH(d,y){j0=sT=!0;var x=d.pending;x===null?y.next=y:(y.next=x.next,x.next=y),d.pending=y}function lH(d,y,x){if((x&4194048)!==0){var C=y.lanes;C&=d.pendingLanes,x|=C,y.lanes=x,AP(d,x)}}var uT={readContext:_o,use:rT,useCallback:Ar,useContext:Ar,useEffect:Ar,useImperativeHandle:Ar,useLayoutEffect:Ar,useInsertionEffect:Ar,useMemo:Ar,useReducer:Ar,useRef:Ar,useState:Ar,useDebugValue:Ar,useDeferredValue:Ar,useTransition:Ar,useSyncExternalStore:Ar,useId:Ar,useHostTransitionStatus:Ar,useFormState:Ar,useActionState:Ar,useOptimistic:Ar,useMemoCache:Ar,useCacheRefresh:Ar},uH={readContext:_o,use:rT,useCallback:function(d,y){return Pa().memoizedState=[d,y===void 0?null:y],d},useContext:_o,useEffect:Hj,useImperativeHandle:function(d,y,x){x=x!=null?x.concat([d]):null,aT(4194308,4,Zj.bind(null,y,d),x)},useLayoutEffect:function(d,y){return aT(4194308,4,d,y)},useInsertionEffect:function(d,y){aT(4,2,d,y)},useMemo:function(d,y){var x=Pa();y=y===void 0?null:y;var C=d();if(Vg){Ei(!0);try{d()}finally{Ei(!1)}}return x.memoizedState=[C,y],C},useReducer:function(d,y,x){var C=Pa();if(x!==void 0){var N=x(y);if(Vg){Ei(!0);try{x(y)}finally{Ei(!1)}}}else N=y;return C.memoizedState=C.baseState=N,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:N},C.queue=d,d=d.dispatch=iwe.bind(null,es,d),[C.memoizedState,d]},useRef:function(d){var y=Pa();return d={current:d},y.memoizedState=d},useState:function(d){d=kk(d);var y=d.queue,x=oH.bind(null,es,y);return y.dispatch=x,[d.memoizedState,x]},useDebugValue:Ok,useDeferredValue:function(d,y){var x=Pa();return Lk(x,d,y)},useTransition:function(){var d=kk(!1);return d=tH.bind(null,es,d.queue,!0,!1),Pa().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,y,x){var C=es,N=Pa();if(Fs){if(x===void 0)throw Error(i(407));x=x()}else{if(x=y(),Pi===null)throw Error(i(349));(_s&124)!==0||Aj(C,y,x)}N.memoizedState=x;var $={value:x,getSnapshot:y};return N.queue=$,Hj(Dj.bind(null,C,$,d),[d]),C.flags|=2048,Y0(9,oT(),Nj.bind(null,C,$,x,y),null),x},useId:function(){var d=Pa(),y=Pi.identifierPrefix;if(Fs){var x=mm,C=hm;x=(C&~(1<<32-Cs(C)-1)).toString(32)+x,y="«"+y+"R"+x,x=iT++,0<x&&(y+="H"+x.toString(32)),y+="»"}else x=Qxe++,y="«"+y+"r"+x.toString(32)+"»";return d.memoizedState=y},useHostTransitionStatus:qk,useFormState:Gj,useActionState:Gj,useOptimistic:function(d){var y=Pa();y.memoizedState=y.baseState=d;var x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return y.queue=x,y=Gk.bind(null,es,!0,x),x.dispatch=y,[d,y]},useMemoCache:Dk,useCacheRefresh:function(){return Pa().memoizedState=swe.bind(null,es)}},cH={readContext:_o,use:rT,useCallback:Jj,useContext:_o,useEffect:Yj,useImperativeHandle:Qj,useInsertionEffect:Xj,useLayoutEffect:Wj,useMemo:Kj,useReducer:nT,useRef:jj,useState:function(){return nT(fm)},useDebugValue:Ok,useDeferredValue:function(d,y){var x=zr();return eH(x,ai.memoizedState,d,y)},useTransition:function(){var d=nT(fm)[0],y=zr().memoizedState;return[typeof d=="boolean"?d:rw(d),y]},useSyncExternalStore:Mj,useId:rH,useHostTransitionStatus:qk,useFormState:zj,useActionState:zj,useOptimistic:function(d,y){var x=zr();return kj(x,ai,d,y)},useMemoCache:Dk,useCacheRefresh:nH},rwe={readContext:_o,use:rT,useCallback:Jj,useContext:_o,useEffect:Yj,useImperativeHandle:Qj,useInsertionEffect:Xj,useLayoutEffect:Wj,useMemo:Kj,useReducer:Rk,useRef:jj,useState:function(){return Rk(fm)},useDebugValue:Ok,useDeferredValue:function(d,y){var x=zr();return ai===null?Lk(x,d,y):eH(x,ai.memoizedState,d,y)},useTransition:function(){var d=Rk(fm)[0],y=zr().memoizedState;return[typeof d=="boolean"?d:rw(d),y]},useSyncExternalStore:Mj,useId:rH,useHostTransitionStatus:qk,useFormState:Bj,useActionState:Bj,useOptimistic:function(d,y){var x=zr();return ai!==null?kj(x,ai,d,y):(x.baseState=d,[d,x.queue.dispatch])},useMemoCache:Dk,useCacheRefresh:nH},X0=null,aw=0;function cT(d){var y=aw;return aw+=1,X0===null&&(X0=[]),xj(X0,d,y)}function lw(d,y){y=y.props.ref,d.ref=y!==void 0?y:null}function hT(d,y){throw y.$$typeof===h?Error(i(525)):(d=Object.prototype.toString.call(y),Error(i(31,d==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":d)))}function hH(d){var y=d._init;return y(d._payload)}function mH(d){function y(pe,ce){if(d){var ye=pe.deletions;ye===null?(pe.deletions=[ce],pe.flags|=16):ye.push(ce)}}function x(pe,ce){if(!d)return null;for(;ce!==null;)y(pe,ce),ce=ce.sibling;return null}function C(pe){for(var ce=new Map;pe!==null;)pe.key!==null?ce.set(pe.key,pe):ce.set(pe.index,pe),pe=pe.sibling;return ce}function N(pe,ce){return pe=cm(pe,ce),pe.index=0,pe.sibling=null,pe}function $(pe,ce,ye){return pe.index=ye,d?(ye=pe.alternate,ye!==null?(ye=ye.index,ye<ce?(pe.flags|=67108866,ce):ye):(pe.flags|=67108866,ce)):(pe.flags|=1048576,ce)}function j(pe){return d&&pe.alternate===null&&(pe.flags|=67108866),pe}function J(pe,ce,ye,Re){return ce===null||ce.tag!==6?(ce=lk(ye,pe.mode,Re),ce.return=pe,ce):(ce=N(ce,ye),ce.return=pe,ce)}function oe(pe,ce,ye,Re){var ct=ye.type;return ct===g?$e(pe,ce,ye.props.children,Re,ye.key):ce!==null&&(ce.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===k&&hH(ct)===ce.type)?(ce=N(ce,ye.props),lw(ce,ye),ce.return=pe,ce):(ce=YP(ye.type,ye.key,ye.props,null,pe.mode,Re),lw(ce,ye),ce.return=pe,ce)}function _e(pe,ce,ye,Re){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==ye.containerInfo||ce.stateNode.implementation!==ye.implementation?(ce=uk(ye,pe.mode,Re),ce.return=pe,ce):(ce=N(ce,ye.children||[]),ce.return=pe,ce)}function $e(pe,ce,ye,Re,ct){return ce===null||ce.tag!==7?(ce=Ng(ye,pe.mode,Re,ct),ce.return=pe,ce):(ce=N(ce,ye),ce.return=pe,ce)}function Oe(pe,ce,ye){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=lk(""+ce,pe.mode,ye),ce.return=pe,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case m:return ye=YP(ce.type,ce.key,ce.props,null,pe.mode,ye),lw(ye,ce),ye.return=pe,ye;case f:return ce=uk(ce,pe.mode,ye),ce.return=pe,ce;case k:var Re=ce._init;return ce=Re(ce._payload),Oe(pe,ce,ye)}if(B(ce)||q(ce))return ce=Ng(ce,pe.mode,ye,null),ce.return=pe,ce;if(typeof ce.then=="function")return Oe(pe,cT(ce),ye);if(ce.$$typeof===T)return Oe(pe,QP(pe,ce),ye);hT(pe,ce)}return null}function xe(pe,ce,ye,Re){var ct=ce!==null?ce.key:null;if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ct!==null?null:J(pe,ce,""+ye,Re);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case m:return ye.key===ct?oe(pe,ce,ye,Re):null;case f:return ye.key===ct?_e(pe,ce,ye,Re):null;case k:return ct=ye._init,ye=ct(ye._payload),xe(pe,ce,ye,Re)}if(B(ye)||q(ye))return ct!==null?null:$e(pe,ce,ye,Re,null);if(typeof ye.then=="function")return xe(pe,ce,cT(ye),Re);if(ye.$$typeof===T)return xe(pe,ce,QP(pe,ye),Re);hT(pe,ye)}return null}function we(pe,ce,ye,Re,ct){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return pe=pe.get(ye)||null,J(ce,pe,""+Re,ct);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case m:return pe=pe.get(Re.key===null?ye:Re.key)||null,oe(ce,pe,Re,ct);case f:return pe=pe.get(Re.key===null?ye:Re.key)||null,_e(ce,pe,Re,ct);case k:var ns=Re._init;return Re=ns(Re._payload),we(pe,ce,ye,Re,ct)}if(B(Re)||q(Re))return pe=pe.get(ye)||null,$e(ce,pe,Re,ct,null);if(typeof Re.then=="function")return we(pe,ce,ye,cT(Re),ct);if(Re.$$typeof===T)return we(pe,ce,ye,QP(ce,Re),ct);hT(ce,Re)}return null}function Dt(pe,ce,ye,Re){for(var ct=null,ns=null,_t=ce,At=ce=0,Mn=null;_t!==null&&At<ye.length;At++){_t.index>At?(Mn=_t,_t=null):Mn=_t.sibling;var Ps=xe(pe,_t,ye[At],Re);if(Ps===null){_t===null&&(_t=Mn);break}d&&_t&&Ps.alternate===null&&y(pe,_t),ce=$(Ps,ce,At),ns===null?ct=Ps:ns.sibling=Ps,ns=Ps,_t=Mn}if(At===ye.length)return x(pe,_t),Fs&&$g(pe,At),ct;if(_t===null){for(;At<ye.length;At++)_t=Oe(pe,ye[At],Re),_t!==null&&(ce=$(_t,ce,At),ns===null?ct=_t:ns.sibling=_t,ns=_t);return Fs&&$g(pe,At),ct}for(_t=C(_t);At<ye.length;At++)Mn=we(_t,pe,At,ye[At],Re),Mn!==null&&(d&&Mn.alternate!==null&&_t.delete(Mn.key===null?At:Mn.key),ce=$(Mn,ce,At),ns===null?ct=Mn:ns.sibling=Mn,ns=Mn);return d&&_t.forEach(function(gp){return y(pe,gp)}),Fs&&$g(pe,At),ct}function It(pe,ce,ye,Re){if(ye==null)throw Error(i(151));for(var ct=null,ns=null,_t=ce,At=ce=0,Mn=null,Ps=ye.next();_t!==null&&!Ps.done;At++,Ps=ye.next()){_t.index>At?(Mn=_t,_t=null):Mn=_t.sibling;var gp=xe(pe,_t,Ps.value,Re);if(gp===null){_t===null&&(_t=Mn);break}d&&_t&&gp.alternate===null&&y(pe,_t),ce=$(gp,ce,At),ns===null?ct=gp:ns.sibling=gp,ns=gp,_t=Mn}if(Ps.done)return x(pe,_t),Fs&&$g(pe,At),ct;if(_t===null){for(;!Ps.done;At++,Ps=ye.next())Ps=Oe(pe,Ps.value,Re),Ps!==null&&(ce=$(Ps,ce,At),ns===null?ct=Ps:ns.sibling=Ps,ns=Ps);return Fs&&$g(pe,At),ct}for(_t=C(_t);!Ps.done;At++,Ps=ye.next())Ps=we(_t,pe,At,Ps.value,Re),Ps!==null&&(d&&Ps.alternate!==null&&_t.delete(Ps.key===null?At:Ps.key),ce=$(Ps,ce,At),ns===null?ct=Ps:ns.sibling=Ps,ns=Ps);return d&&_t.forEach(function(n2e){return y(pe,n2e)}),Fs&&$g(pe,At),ct}function ui(pe,ce,ye,Re){if(typeof ye=="object"&&ye!==null&&ye.type===g&&ye.key===null&&(ye=ye.props.children),typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case m:e:{for(var ct=ye.key;ce!==null;){if(ce.key===ct){if(ct=ye.type,ct===g){if(ce.tag===7){x(pe,ce.sibling),Re=N(ce,ye.props.children),Re.return=pe,pe=Re;break e}}else if(ce.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===k&&hH(ct)===ce.type){x(pe,ce.sibling),Re=N(ce,ye.props),lw(Re,ye),Re.return=pe,pe=Re;break e}x(pe,ce);break}else y(pe,ce);ce=ce.sibling}ye.type===g?(Re=Ng(ye.props.children,pe.mode,Re,ye.key),Re.return=pe,pe=Re):(Re=YP(ye.type,ye.key,ye.props,null,pe.mode,Re),lw(Re,ye),Re.return=pe,pe=Re)}return j(pe);case f:e:{for(ct=ye.key;ce!==null;){if(ce.key===ct)if(ce.tag===4&&ce.stateNode.containerInfo===ye.containerInfo&&ce.stateNode.implementation===ye.implementation){x(pe,ce.sibling),Re=N(ce,ye.children||[]),Re.return=pe,pe=Re;break e}else{x(pe,ce);break}else y(pe,ce);ce=ce.sibling}Re=uk(ye,pe.mode,Re),Re.return=pe,pe=Re}return j(pe);case k:return ct=ye._init,ye=ct(ye._payload),ui(pe,ce,ye,Re)}if(B(ye))return Dt(pe,ce,ye,Re);if(q(ye)){if(ct=q(ye),typeof ct!="function")throw Error(i(150));return ye=ct.call(ye),It(pe,ce,ye,Re)}if(typeof ye.then=="function")return ui(pe,ce,cT(ye),Re);if(ye.$$typeof===T)return ui(pe,ce,QP(pe,ye),Re);hT(pe,ye)}return typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint"?(ye=""+ye,ce!==null&&ce.tag===6?(x(pe,ce.sibling),Re=N(ce,ye),Re.return=pe,pe=Re):(x(pe,ce),Re=lk(ye,pe.mode,Re),Re.return=pe,pe=Re),j(pe)):x(pe,ce)}return function(pe,ce,ye,Re){try{aw=0;var ct=ui(pe,ce,ye,Re);return X0=null,ct}catch(_t){if(_t===Jx||_t===KP)throw _t;var ns=cl(29,_t,null,pe.mode);return ns.lanes=Re,ns.return=pe,ns}finally{}}}var W0=mH(!0),dH=mH(!1),lu=te(null),nh=null;function tp(d){var y=d.alternate;ke(mn,mn.current&1),ke(lu,d),nh===null&&(y===null||B0.current!==null||y.memoizedState!==null)&&(nh=d)}function pH(d){if(d.tag===22){if(ke(mn,mn.current),ke(lu,d),nh===null){var y=d.alternate;y!==null&&y.memoizedState!==null&&(nh=d)}}else sp()}function sp(){ke(mn,mn.current),ke(lu,lu.current)}function gm(d){ve(lu),nh===d&&(nh=null),ve(mn)}var mn=te(0);function mT(d){for(var y=d;y!==null;){if(y.tag===13){var x=y.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||x.data==="$?"||NF(x)))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if((y.flags&128)!==0)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===d)break;for(;y.sibling===null;){if(y.return===null||y.return===d)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}function zk(d,y,x,C){y=d.memoizedState,x=x(C,y),x=x==null?y:c({},y,x),d.memoizedState=x,d.lanes===0&&(d.updateQueue.baseState=x)}var Uk={enqueueSetState:function(d,y,x){d=d._reactInternals;var C=pl(),N=Jd(C);N.payload=y,x!=null&&(N.callback=x),y=Kd(d,N,C),y!==null&&(fl(y,d,C),ew(y,d,C))},enqueueReplaceState:function(d,y,x){d=d._reactInternals;var C=pl(),N=Jd(C);N.tag=1,N.payload=y,x!=null&&(N.callback=x),y=Kd(d,N,C),y!==null&&(fl(y,d,C),ew(y,d,C))},enqueueForceUpdate:function(d,y){d=d._reactInternals;var x=pl(),C=Jd(x);C.tag=2,y!=null&&(C.callback=y),y=Kd(d,C,x),y!==null&&(fl(y,d,x),ew(y,d,x))}};function fH(d,y,x,C,N,$,j){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(C,$,j):y.prototype&&y.prototype.isPureReactComponent?!Bx(x,C)||!Bx(N,$):!0}function gH(d,y,x,C){d=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(x,C),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(x,C),y.state!==d&&Uk.enqueueReplaceState(y,y.state,null)}function qg(d,y){var x=y;if("ref"in y){x={};for(var C in y)C!=="ref"&&(x[C]=y[C])}if(d=d.defaultProps){x===y&&(x=c({},x));for(var N in d)x[N]===void 0&&(x[N]=d[N])}return x}var dT=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)};function yH(d){dT(d)}function _H(d){console.error(d)}function vH(d){dT(d)}function pT(d,y){try{var x=d.onUncaughtError;x(y.value,{componentStack:y.stack})}catch(C){setTimeout(function(){throw C})}}function bH(d,y,x){try{var C=d.onCaughtError;C(x.value,{componentStack:x.stack,errorBoundary:y.tag===1?y.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Bk(d,y,x){return x=Jd(x),x.tag=3,x.payload={element:null},x.callback=function(){pT(d,y)},x}function xH(d){return d=Jd(d),d.tag=3,d}function wH(d,y,x,C){var N=x.type.getDerivedStateFromError;if(typeof N=="function"){var $=C.value;d.payload=function(){return N($)},d.callback=function(){bH(y,x,C)}}var j=x.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(d.callback=function(){bH(y,x,C),typeof N!="function"&&(lp===null?lp=new Set([this]):lp.add(this));var J=C.stack;this.componentDidCatch(C.value,{componentStack:J!==null?J:""})})}function nwe(d,y,x,C,N){if(x.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){if(y=x.alternate,y!==null&&Wx(y,x,N,!0),x=lu.current,x!==null){switch(x.tag){case 13:return nh===null?pF():x.alternate===null&&fr===0&&(fr=3),x.flags&=-257,x.flags|=65536,x.lanes=N,C===vk?x.flags|=16384:(y=x.updateQueue,y===null?x.updateQueue=new Set([C]):y.add(C),gF(d,C,N)),!1;case 22:return x.flags|=65536,C===vk?x.flags|=16384:(y=x.updateQueue,y===null?(y={transitions:null,markerInstances:null,retryQueue:new Set([C])},x.updateQueue=y):(x=y.retryQueue,x===null?y.retryQueue=new Set([C]):x.add(C)),gF(d,C,N)),!1}throw Error(i(435,x.tag))}return gF(d,C,N),pF(),!1}if(Fs)return y=lu.current,y!==null?((y.flags&65536)===0&&(y.flags|=256),y.flags|=65536,y.lanes=N,C!==mk&&(d=Error(i(422),{cause:C}),Xx(ru(d,x)))):(C!==mk&&(y=Error(i(423),{cause:C}),Xx(ru(y,x))),d=d.current.alternate,d.flags|=65536,N&=-N,d.lanes|=N,C=ru(C,x),N=Bk(d.stateNode,C,N),wk(d,N),fr!==4&&(fr=2)),!1;var $=Error(i(520),{cause:C});if($=ru($,x),fw===null?fw=[$]:fw.push($),fr!==4&&(fr=2),y===null)return!0;C=ru(C,x),x=y;do{switch(x.tag){case 3:return x.flags|=65536,d=N&-N,x.lanes|=d,d=Bk(x.stateNode,C,d),wk(x,d),!1;case 1:if(y=x.type,$=x.stateNode,(x.flags&128)===0&&(typeof y.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(lp===null||!lp.has($))))return x.flags|=65536,N&=-N,x.lanes|=N,N=xH(N),wH(N,d,x,C),wk(x,N),!1}x=x.return}while(x!==null);return!1}var SH=Error(i(461)),Tn=!1;function Zn(d,y,x,C){y.child=d===null?dH(y,null,x,C):W0(y,d.child,x,C)}function EH(d,y,x,C,N){x=x.render;var $=y.ref;if("ref"in C){var j={};for(var J in C)J!=="ref"&&(j[J]=C[J])}else j=C;return Og(y),C=Tk(d,y,x,j,$,N),J=Ik(),d!==null&&!Tn?(Mk(d,y,N),ym(d,y,N)):(Fs&&J&&ck(y),y.flags|=1,Zn(d,y,C,N),y.child)}function CH(d,y,x,C,N){if(d===null){var $=x.type;return typeof $=="function"&&!ak($)&&$.defaultProps===void 0&&x.compare===null?(y.tag=15,y.type=$,PH(d,y,$,C,N)):(d=YP(x.type,null,C,y,y.mode,N),d.ref=y.ref,d.return=y,y.child=d)}if($=d.child,!Jk(d,N)){var j=$.memoizedProps;if(x=x.compare,x=x!==null?x:Bx,x(j,C)&&d.ref===y.ref)return ym(d,y,N)}return y.flags|=1,d=cm($,C),d.ref=y.ref,d.return=y,y.child=d}function PH(d,y,x,C,N){if(d!==null){var $=d.memoizedProps;if(Bx($,C)&&d.ref===y.ref)if(Tn=!1,y.pendingProps=C=$,Jk(d,N))(d.flags&131072)!==0&&(Tn=!0);else return y.lanes=d.lanes,ym(d,y,N)}return jk(d,y,x,C,N)}function TH(d,y,x){var C=y.pendingProps,N=C.children,$=d!==null?d.memoizedState:null;if(C.mode==="hidden"){if((y.flags&128)!==0){if(C=$!==null?$.baseLanes|x:x,d!==null){for(N=y.child=d.child,$=0;N!==null;)$=$|N.lanes|N.childLanes,N=N.sibling;y.childLanes=$&~C}else y.childLanes=0,y.child=null;return IH(d,y,C,x)}if((x&536870912)!==0)y.memoizedState={baseLanes:0,cachePool:null},d!==null&&JP(y,$!==null?$.cachePool:null),$!==null?Pj(y,$):Ek(),pH(y);else return y.lanes=y.childLanes=536870912,IH(d,y,$!==null?$.baseLanes|x:x,x)}else $!==null?(JP(y,$.cachePool),Pj(y,$),sp(),y.memoizedState=null):(d!==null&&JP(y,null),Ek(),sp());return Zn(d,y,N,x),y.child}function IH(d,y,x,C){var N=_k();return N=N===null?null:{parent:hn._currentValue,pool:N},y.memoizedState={baseLanes:x,cachePool:N},d!==null&&JP(y,null),Ek(),pH(y),d!==null&&Wx(d,y,C,!0),null}function fT(d,y){var x=y.ref;if(x===null)d!==null&&d.ref!==null&&(y.flags|=4194816);else{if(typeof x!="function"&&typeof x!="object")throw Error(i(284));(d===null||d.ref!==x)&&(y.flags|=4194816)}}function jk(d,y,x,C,N){return Og(y),x=Tk(d,y,x,C,void 0,N),C=Ik(),d!==null&&!Tn?(Mk(d,y,N),ym(d,y,N)):(Fs&&C&&ck(y),y.flags|=1,Zn(d,y,x,N),y.child)}function MH(d,y,x,C,N,$){return Og(y),y.updateQueue=null,x=Ij(y,C,x,N),Tj(d),C=Ik(),d!==null&&!Tn?(Mk(d,y,$),ym(d,y,$)):(Fs&&C&&ck(y),y.flags|=1,Zn(d,y,x,$),y.child)}function AH(d,y,x,C,N){if(Og(y),y.stateNode===null){var $=V0,j=x.contextType;typeof j=="object"&&j!==null&&($=_o(j)),$=new x(C,$),y.memoizedState=$.state!==null&&$.state!==void 0?$.state:null,$.updater=Uk,y.stateNode=$,$._reactInternals=y,$=y.stateNode,$.props=C,$.state=y.memoizedState,$.refs={},bk(y),j=x.contextType,$.context=typeof j=="object"&&j!==null?_o(j):V0,$.state=y.memoizedState,j=x.getDerivedStateFromProps,typeof j=="function"&&(zk(y,x,j,C),$.state=y.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof $.getSnapshotBeforeUpdate=="function"||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(j=$.state,typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount(),j!==$.state&&Uk.enqueueReplaceState($,$.state,null),sw(y,C,$,N),tw(),$.state=y.memoizedState),typeof $.componentDidMount=="function"&&(y.flags|=4194308),C=!0}else if(d===null){$=y.stateNode;var J=y.memoizedProps,oe=qg(x,J);$.props=oe;var _e=$.context,$e=x.contextType;j=V0,typeof $e=="object"&&$e!==null&&(j=_o($e));var Oe=x.getDerivedStateFromProps;$e=typeof Oe=="function"||typeof $.getSnapshotBeforeUpdate=="function",J=y.pendingProps!==J,$e||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(J||_e!==j)&&gH(y,$,C,j),Qd=!1;var xe=y.memoizedState;$.state=xe,sw(y,C,$,N),tw(),_e=y.memoizedState,J||xe!==_e||Qd?(typeof Oe=="function"&&(zk(y,x,Oe,C),_e=y.memoizedState),(oe=Qd||fH(y,x,oe,C,xe,_e,j))?($e||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(y.flags|=4194308)):(typeof $.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=C,y.memoizedState=_e),$.props=C,$.state=_e,$.context=j,C=oe):(typeof $.componentDidMount=="function"&&(y.flags|=4194308),C=!1)}else{$=y.stateNode,xk(d,y),j=y.memoizedProps,$e=qg(x,j),$.props=$e,Oe=y.pendingProps,xe=$.context,_e=x.contextType,oe=V0,typeof _e=="object"&&_e!==null&&(oe=_o(_e)),J=x.getDerivedStateFromProps,(_e=typeof J=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(j!==Oe||xe!==oe)&&gH(y,$,C,oe),Qd=!1,xe=y.memoizedState,$.state=xe,sw(y,C,$,N),tw();var we=y.memoizedState;j!==Oe||xe!==we||Qd||d!==null&&d.dependencies!==null&&ZP(d.dependencies)?(typeof J=="function"&&(zk(y,x,J,C),we=y.memoizedState),($e=Qd||fH(y,x,$e,C,xe,we,oe)||d!==null&&d.dependencies!==null&&ZP(d.dependencies))?(_e||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(C,we,oe),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(C,we,oe)),typeof $.componentDidUpdate=="function"&&(y.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof $.componentDidUpdate!="function"||j===d.memoizedProps&&xe===d.memoizedState||(y.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||j===d.memoizedProps&&xe===d.memoizedState||(y.flags|=1024),y.memoizedProps=C,y.memoizedState=we),$.props=C,$.state=we,$.context=oe,C=$e):(typeof $.componentDidUpdate!="function"||j===d.memoizedProps&&xe===d.memoizedState||(y.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||j===d.memoizedProps&&xe===d.memoizedState||(y.flags|=1024),C=!1)}return $=C,fT(d,y),C=(y.flags&128)!==0,$||C?($=y.stateNode,x=C&&typeof x.getDerivedStateFromError!="function"?null:$.render(),y.flags|=1,d!==null&&C?(y.child=W0(y,d.child,null,N),y.child=W0(y,null,x,N)):Zn(d,y,x,N),y.memoizedState=$.state,d=y.child):d=ym(d,y,N),d}function NH(d,y,x,C){return Yx(),y.flags|=256,Zn(d,y,x,C),y.child}var Hk={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yk(d){return{baseLanes:d,cachePool:_j()}}function Xk(d,y,x){return d=d!==null?d.childLanes&~x:0,y&&(d|=uu),d}function DH(d,y,x){var C=y.pendingProps,N=!1,$=(y.flags&128)!==0,j;if((j=$)||(j=d!==null&&d.memoizedState===null?!1:(mn.current&2)!==0),j&&(N=!0,y.flags&=-129),j=(y.flags&32)!==0,y.flags&=-33,d===null){if(Fs){if(N?tp(y):sp(),Fs){var J=pr,oe;if(oe=J){e:{for(oe=J,J=rh;oe.nodeType!==8;){if(!J){J=null;break e}if(oe=Ju(oe.nextSibling),oe===null){J=null;break e}}J=oe}J!==null?(y.memoizedState={dehydrated:J,treeContext:Dg!==null?{id:hm,overflow:mm}:null,retryLane:536870912,hydrationErrors:null},oe=cl(18,null,null,0),oe.stateNode=J,oe.return=y,y.child=oe,Wo=y,pr=null,oe=!0):oe=!1}oe||kg(y)}if(J=y.memoizedState,J!==null&&(J=J.dehydrated,J!==null))return NF(J)?y.lanes=32:y.lanes=536870912,null;gm(y)}return J=C.children,C=C.fallback,N?(sp(),N=y.mode,J=gT({mode:"hidden",children:J},N),C=Ng(C,N,x,null),J.return=y,C.return=y,J.sibling=C,y.child=J,N=y.child,N.memoizedState=Yk(x),N.childLanes=Xk(d,j,x),y.memoizedState=Hk,C):(tp(y),Wk(y,J))}if(oe=d.memoizedState,oe!==null&&(J=oe.dehydrated,J!==null)){if($)y.flags&256?(tp(y),y.flags&=-257,y=Zk(d,y,x)):y.memoizedState!==null?(sp(),y.child=d.child,y.flags|=128,y=null):(sp(),N=C.fallback,J=y.mode,C=gT({mode:"visible",children:C.children},J),N=Ng(N,J,x,null),N.flags|=2,C.return=y,N.return=y,C.sibling=N,y.child=C,W0(y,d.child,null,x),C=y.child,C.memoizedState=Yk(x),C.childLanes=Xk(d,j,x),y.memoizedState=Hk,y=N);else if(tp(y),NF(J)){if(j=J.nextSibling&&J.nextSibling.dataset,j)var _e=j.dgst;j=_e,C=Error(i(419)),C.stack="",C.digest=j,Xx({value:C,source:null,stack:null}),y=Zk(d,y,x)}else if(Tn||Wx(d,y,x,!1),j=(x&d.childLanes)!==0,Tn||j){if(j=Pi,j!==null&&(C=x&-x,C=(C&42)!==0?1:Nx(C),C=(C&(j.suspendedLanes|x))!==0?0:C,C!==0&&C!==oe.retryLane))throw oe.retryLane=C,L0(d,C),fl(j,d,C),SH;J.data==="$?"||pF(),y=Zk(d,y,x)}else J.data==="$?"?(y.flags|=192,y.child=d.child,y=null):(d=oe.treeContext,pr=Ju(J.nextSibling),Wo=y,Fs=!0,Rg=null,rh=!1,d!==null&&(ou[au++]=hm,ou[au++]=mm,ou[au++]=Dg,hm=d.id,mm=d.overflow,Dg=y),y=Wk(y,C.children),y.flags|=4096);return y}return N?(sp(),N=C.fallback,J=y.mode,oe=d.child,_e=oe.sibling,C=cm(oe,{mode:"hidden",children:C.children}),C.subtreeFlags=oe.subtreeFlags&65011712,_e!==null?N=cm(_e,N):(N=Ng(N,J,x,null),N.flags|=2),N.return=y,C.return=y,C.sibling=N,y.child=C,C=N,N=y.child,J=d.child.memoizedState,J===null?J=Yk(x):(oe=J.cachePool,oe!==null?(_e=hn._currentValue,oe=oe.parent!==_e?{parent:_e,pool:_e}:oe):oe=_j(),J={baseLanes:J.baseLanes|x,cachePool:oe}),N.memoizedState=J,N.childLanes=Xk(d,j,x),y.memoizedState=Hk,C):(tp(y),x=d.child,d=x.sibling,x=cm(x,{mode:"visible",children:C.children}),x.return=y,x.sibling=null,d!==null&&(j=y.deletions,j===null?(y.deletions=[d],y.flags|=16):j.push(d)),y.child=x,y.memoizedState=null,x)}function Wk(d,y){return y=gT({mode:"visible",children:y},d.mode),y.return=d,d.child=y}function gT(d,y){return d=cl(22,d,null,y),d.lanes=0,d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},d}function Zk(d,y,x){return W0(y,d.child,null,x),d=Wk(y,y.pendingProps.children),d.flags|=2,y.memoizedState=null,d}function $H(d,y,x){d.lanes|=y;var C=d.alternate;C!==null&&(C.lanes|=y),pk(d.return,y,x)}function Qk(d,y,x,C,N){var $=d.memoizedState;$===null?d.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:C,tail:x,tailMode:N}:($.isBackwards=y,$.rendering=null,$.renderingStartTime=0,$.last=C,$.tail=x,$.tailMode=N)}function RH(d,y,x){var C=y.pendingProps,N=C.revealOrder,$=C.tail;if(Zn(d,y,C.children,x),C=mn.current,(C&2)!==0)C=C&1|2,y.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=y.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&$H(d,x,y);else if(d.tag===19)$H(d,x,y);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===y)break e;for(;d.sibling===null;){if(d.return===null||d.return===y)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}C&=1}switch(ke(mn,C),N){case"forwards":for(x=y.child,N=null;x!==null;)d=x.alternate,d!==null&&mT(d)===null&&(N=x),x=x.sibling;x=N,x===null?(N=y.child,y.child=null):(N=x.sibling,x.sibling=null),Qk(y,!1,N,x,$);break;case"backwards":for(x=null,N=y.child,y.child=null;N!==null;){if(d=N.alternate,d!==null&&mT(d)===null){y.child=N;break}d=N.sibling,N.sibling=x,x=N,N=d}Qk(y,!0,x,null,$);break;case"together":Qk(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function ym(d,y,x){if(d!==null&&(y.dependencies=d.dependencies),ap|=y.lanes,(x&y.childLanes)===0)if(d!==null){if(Wx(d,y,x,!1),(x&y.childLanes)===0)return null}else return null;if(d!==null&&y.child!==d.child)throw Error(i(153));if(y.child!==null){for(d=y.child,x=cm(d,d.pendingProps),y.child=x,x.return=y;d.sibling!==null;)d=d.sibling,x=x.sibling=cm(d,d.pendingProps),x.return=y;x.sibling=null}return y.child}function Jk(d,y){return(d.lanes&y)!==0?!0:(d=d.dependencies,!!(d!==null&&ZP(d)))}function owe(d,y,x){switch(y.tag){case 3:He(y,y.stateNode.containerInfo),Zd(y,hn,d.memoizedState.cache),Yx();break;case 27:case 5:Cr(y);break;case 4:He(y,y.stateNode.containerInfo);break;case 10:Zd(y,y.type,y.memoizedProps.value);break;case 13:var C=y.memoizedState;if(C!==null)return C.dehydrated!==null?(tp(y),y.flags|=128,null):(x&y.child.childLanes)!==0?DH(d,y,x):(tp(y),d=ym(d,y,x),d!==null?d.sibling:null);tp(y);break;case 19:var N=(d.flags&128)!==0;if(C=(x&y.childLanes)!==0,C||(Wx(d,y,x,!1),C=(x&y.childLanes)!==0),N){if(C)return RH(d,y,x);y.flags|=128}if(N=y.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),ke(mn,mn.current),C)break;return null;case 22:case 23:return y.lanes=0,TH(d,y,x);case 24:Zd(y,hn,d.memoizedState.cache)}return ym(d,y,x)}function kH(d,y,x){if(d!==null)if(d.memoizedProps!==y.pendingProps)Tn=!0;else{if(!Jk(d,x)&&(y.flags&128)===0)return Tn=!1,owe(d,y,x);Tn=(d.flags&131072)!==0}else Tn=!1,Fs&&(y.flags&1048576)!==0&&hj(y,WP,y.index);switch(y.lanes=0,y.tag){case 16:e:{d=y.pendingProps;var C=y.elementType,N=C._init;if(C=N(C._payload),y.type=C,typeof C=="function")ak(C)?(d=qg(C,d),y.tag=1,y=AH(null,y,C,d,x)):(y.tag=0,y=jk(null,y,C,d,x));else{if(C!=null){if(N=C.$$typeof,N===P){y.tag=11,y=EH(null,y,C,d,x);break e}else if(N===D){y.tag=14,y=CH(null,y,C,d,x);break e}}throw y=V(C)||C,Error(i(306,y,""))}}return y;case 0:return jk(d,y,y.type,y.pendingProps,x);case 1:return C=y.type,N=qg(C,y.pendingProps),AH(d,y,C,N,x);case 3:e:{if(He(y,y.stateNode.containerInfo),d===null)throw Error(i(387));C=y.pendingProps;var $=y.memoizedState;N=$.element,xk(d,y),sw(y,C,null,x);var j=y.memoizedState;if(C=j.cache,Zd(y,hn,C),C!==$.cache&&fk(y,[hn],x,!0),tw(),C=j.element,$.isDehydrated)if($={element:C,isDehydrated:!1,cache:j.cache},y.updateQueue.baseState=$,y.memoizedState=$,y.flags&256){y=NH(d,y,C,x);break e}else if(C!==N){N=ru(Error(i(424)),y),Xx(N),y=NH(d,y,C,x);break e}else{switch(d=y.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(pr=Ju(d.firstChild),Wo=y,Fs=!0,Rg=null,rh=!0,x=dH(y,null,C,x),y.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling}else{if(Yx(),C===N){y=ym(d,y,x);break e}Zn(d,y,C,x)}y=y.child}return y;case 26:return fT(d,y),d===null?(x=VY(y.type,null,y.pendingProps,null))?y.memoizedState=x:Fs||(x=y.type,d=y.pendingProps,C=AT(Ve.current).createElement(x),C[sr]=y,C[Ci]=d,Jn(C,x,d),Ir(C),y.stateNode=C):y.memoizedState=VY(y.type,d.memoizedProps,y.pendingProps,d.memoizedState),null;case 27:return Cr(y),d===null&&Fs&&(C=y.stateNode=FY(y.type,y.pendingProps,Ve.current),Wo=y,rh=!0,N=pr,hp(y.type)?(DF=N,pr=Ju(C.firstChild)):pr=N),Zn(d,y,y.pendingProps.children,x),fT(d,y),d===null&&(y.flags|=4194304),y.child;case 5:return d===null&&Fs&&((N=C=pr)&&(C=Rwe(C,y.type,y.pendingProps,rh),C!==null?(y.stateNode=C,Wo=y,pr=Ju(C.firstChild),rh=!1,N=!0):N=!1),N||kg(y)),Cr(y),N=y.type,$=y.pendingProps,j=d!==null?d.memoizedProps:null,C=$.children,IF(N,$)?C=null:j!==null&&IF(N,j)&&(y.flags|=32),y.memoizedState!==null&&(N=Tk(d,y,Jxe,null,null,x),Ew._currentValue=N),fT(d,y),Zn(d,y,C,x),y.child;case 6:return d===null&&Fs&&((d=x=pr)&&(x=kwe(x,y.pendingProps,rh),x!==null?(y.stateNode=x,Wo=y,pr=null,d=!0):d=!1),d||kg(y)),null;case 13:return DH(d,y,x);case 4:return He(y,y.stateNode.containerInfo),C=y.pendingProps,d===null?y.child=W0(y,null,C,x):Zn(d,y,C,x),y.child;case 11:return EH(d,y,y.type,y.pendingProps,x);case 7:return Zn(d,y,y.pendingProps,x),y.child;case 8:return Zn(d,y,y.pendingProps.children,x),y.child;case 12:return Zn(d,y,y.pendingProps.children,x),y.child;case 10:return C=y.pendingProps,Zd(y,y.type,C.value),Zn(d,y,C.children,x),y.child;case 9:return N=y.type._context,C=y.pendingProps.children,Og(y),N=_o(N),C=C(N),y.flags|=1,Zn(d,y,C,x),y.child;case 14:return CH(d,y,y.type,y.pendingProps,x);case 15:return PH(d,y,y.type,y.pendingProps,x);case 19:return RH(d,y,x);case 31:return C=y.pendingProps,x=y.mode,C={mode:C.mode,children:C.children},d===null?(x=gT(C,x),x.ref=y.ref,y.child=x,x.return=y,y=x):(x=cm(d.child,C),x.ref=y.ref,y.child=x,x.return=y,y=x),y;case 22:return TH(d,y,x);case 24:return Og(y),C=_o(hn),d===null?(N=_k(),N===null&&(N=Pi,$=gk(),N.pooledCache=$,$.refCount++,$!==null&&(N.pooledCacheLanes|=x),N=$),y.memoizedState={parent:C,cache:N},bk(y),Zd(y,hn,N)):((d.lanes&x)!==0&&(xk(d,y),sw(y,null,null,x),tw()),N=d.memoizedState,$=y.memoizedState,N.parent!==C?(N={parent:C,cache:C},y.memoizedState=N,y.lanes===0&&(y.memoizedState=y.updateQueue.baseState=N),Zd(y,hn,C)):(C=$.cache,Zd(y,hn,C),C!==N.cache&&fk(y,[hn],x,!0))),Zn(d,y,y.pendingProps.children,x),y.child;case 29:throw y.pendingProps}throw Error(i(156,y.tag))}function _m(d){d.flags|=4}function FH(d,y){if(y.type!=="stylesheet"||(y.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!BY(y)){if(y=lu.current,y!==null&&((_s&4194048)===_s?nh!==null:(_s&62914560)!==_s&&(_s&536870912)===0||y!==nh))throw Kx=vk,vj;d.flags|=8192}}function yT(d,y){y!==null&&(d.flags|=4),d.flags&16384&&(y=d.tag!==22?IP():536870912,d.lanes|=y,K0|=y)}function uw(d,y){if(!Fs)switch(d.tailMode){case"hidden":y=d.tail;for(var x=null;y!==null;)y.alternate!==null&&(x=y),y=y.sibling;x===null?d.tail=null:x.sibling=null;break;case"collapsed":x=d.tail;for(var C=null;x!==null;)x.alternate!==null&&(C=x),x=x.sibling;C===null?y||d.tail===null?d.tail=null:d.tail.sibling=null:C.sibling=null}}function ir(d){var y=d.alternate!==null&&d.alternate.child===d.child,x=0,C=0;if(y)for(var N=d.child;N!==null;)x|=N.lanes|N.childLanes,C|=N.subtreeFlags&65011712,C|=N.flags&65011712,N.return=d,N=N.sibling;else for(N=d.child;N!==null;)x|=N.lanes|N.childLanes,C|=N.subtreeFlags,C|=N.flags,N.return=d,N=N.sibling;return d.subtreeFlags|=C,d.childLanes=x,y}function awe(d,y,x){var C=y.pendingProps;switch(hk(y),y.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ir(y),null;case 1:return ir(y),null;case 3:return x=y.stateNode,C=null,d!==null&&(C=d.memoizedState.cache),y.memoizedState.cache!==C&&(y.flags|=2048),pm(hn),Rs(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(d===null||d.child===null)&&(Hx(y)?_m(y):d===null||d.memoizedState.isDehydrated&&(y.flags&256)===0||(y.flags|=1024,pj())),ir(y),null;case 26:return x=y.memoizedState,d===null?(_m(y),x!==null?(ir(y),FH(y,x)):(ir(y),y.flags&=-16777217)):x?x!==d.memoizedState?(_m(y),ir(y),FH(y,x)):(ir(y),y.flags&=-16777217):(d.memoizedProps!==C&&_m(y),ir(y),y.flags&=-16777217),null;case 27:Js(y),x=Ve.current;var N=y.type;if(d!==null&&y.stateNode!=null)d.memoizedProps!==C&&_m(y);else{if(!C){if(y.stateNode===null)throw Error(i(166));return ir(y),null}d=Fe.current,Hx(y)?mj(y):(d=FY(N,C,x),y.stateNode=d,_m(y))}return ir(y),null;case 5:if(Js(y),x=y.type,d!==null&&y.stateNode!=null)d.memoizedProps!==C&&_m(y);else{if(!C){if(y.stateNode===null)throw Error(i(166));return ir(y),null}if(d=Fe.current,Hx(y))mj(y);else{switch(N=AT(Ve.current),d){case 1:d=N.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:d=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":d=N.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":d=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":d=N.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof C.is=="string"?N.createElement("select",{is:C.is}):N.createElement("select"),C.multiple?d.multiple=!0:C.size&&(d.size=C.size);break;default:d=typeof C.is=="string"?N.createElement(x,{is:C.is}):N.createElement(x)}}d[sr]=y,d[Ci]=C;e:for(N=y.child;N!==null;){if(N.tag===5||N.tag===6)d.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===y)break e;for(;N.sibling===null;){if(N.return===null||N.return===y)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}y.stateNode=d;e:switch(Jn(d,x,C),x){case"button":case"input":case"select":case"textarea":d=!!C.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&_m(y)}}return ir(y),y.flags&=-16777217,null;case 6:if(d&&y.stateNode!=null)d.memoizedProps!==C&&_m(y);else{if(typeof C!="string"&&y.stateNode===null)throw Error(i(166));if(d=Ve.current,Hx(y)){if(d=y.stateNode,x=y.memoizedProps,C=null,N=Wo,N!==null)switch(N.tag){case 27:case 5:C=N.memoizedProps}d[sr]=y,d=!!(d.nodeValue===x||C!==null&&C.suppressHydrationWarning===!0||MY(d.nodeValue,x)),d||kg(y)}else d=AT(d).createTextNode(C),d[sr]=y,y.stateNode=d}return ir(y),null;case 13:if(C=y.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(N=Hx(y),C!==null&&C.dehydrated!==null){if(d===null){if(!N)throw Error(i(318));if(N=y.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(i(317));N[sr]=y}else Yx(),(y.flags&128)===0&&(y.memoizedState=null),y.flags|=4;ir(y),N=!1}else N=pj(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=N),N=!0;if(!N)return y.flags&256?(gm(y),y):(gm(y),null)}if(gm(y),(y.flags&128)!==0)return y.lanes=x,y;if(x=C!==null,d=d!==null&&d.memoizedState!==null,x){C=y.child,N=null,C.alternate!==null&&C.alternate.memoizedState!==null&&C.alternate.memoizedState.cachePool!==null&&(N=C.alternate.memoizedState.cachePool.pool);var $=null;C.memoizedState!==null&&C.memoizedState.cachePool!==null&&($=C.memoizedState.cachePool.pool),$!==N&&(C.flags|=2048)}return x!==d&&x&&(y.child.flags|=8192),yT(y,y.updateQueue),ir(y),null;case 4:return Rs(),d===null&&SF(y.stateNode.containerInfo),ir(y),null;case 10:return pm(y.type),ir(y),null;case 19:if(ve(mn),N=y.memoizedState,N===null)return ir(y),null;if(C=(y.flags&128)!==0,$=N.rendering,$===null)if(C)uw(N,!1);else{if(fr!==0||d!==null&&(d.flags&128)!==0)for(d=y.child;d!==null;){if($=mT(d),$!==null){for(y.flags|=128,uw(N,!1),d=$.updateQueue,y.updateQueue=d,yT(y,d),y.subtreeFlags=0,d=x,x=y.child;x!==null;)cj(x,d),x=x.sibling;return ke(mn,mn.current&1|2),y.child}d=d.sibling}N.tail!==null&&De()>bT&&(y.flags|=128,C=!0,uw(N,!1),y.lanes=4194304)}else{if(!C)if(d=mT($),d!==null){if(y.flags|=128,C=!0,d=d.updateQueue,y.updateQueue=d,yT(y,d),uw(N,!0),N.tail===null&&N.tailMode==="hidden"&&!$.alternate&&!Fs)return ir(y),null}else 2*De()-N.renderingStartTime>bT&&x!==536870912&&(y.flags|=128,C=!0,uw(N,!1),y.lanes=4194304);N.isBackwards?($.sibling=y.child,y.child=$):(d=N.last,d!==null?d.sibling=$:y.child=$,N.last=$)}return N.tail!==null?(y=N.tail,N.rendering=y,N.tail=y.sibling,N.renderingStartTime=De(),y.sibling=null,d=mn.current,ke(mn,C?d&1|2:d&1),y):(ir(y),null);case 22:case 23:return gm(y),Ck(),C=y.memoizedState!==null,d!==null?d.memoizedState!==null!==C&&(y.flags|=8192):C&&(y.flags|=8192),C?(x&536870912)!==0&&(y.flags&128)===0&&(ir(y),y.subtreeFlags&6&&(y.flags|=8192)):ir(y),x=y.updateQueue,x!==null&&yT(y,x.retryQueue),x=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),C=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(C=y.memoizedState.cachePool.pool),C!==x&&(y.flags|=2048),d!==null&&ve(Lg),null;case 24:return x=null,d!==null&&(x=d.memoizedState.cache),y.memoizedState.cache!==x&&(y.flags|=2048),pm(hn),ir(y),null;case 25:return null;case 30:return null}throw Error(i(156,y.tag))}function lwe(d,y){switch(hk(y),y.tag){case 1:return d=y.flags,d&65536?(y.flags=d&-65537|128,y):null;case 3:return pm(hn),Rs(),d=y.flags,(d&65536)!==0&&(d&128)===0?(y.flags=d&-65537|128,y):null;case 26:case 27:case 5:return Js(y),null;case 13:if(gm(y),d=y.memoizedState,d!==null&&d.dehydrated!==null){if(y.alternate===null)throw Error(i(340));Yx()}return d=y.flags,d&65536?(y.flags=d&-65537|128,y):null;case 19:return ve(mn),null;case 4:return Rs(),null;case 10:return pm(y.type),null;case 22:case 23:return gm(y),Ck(),d!==null&&ve(Lg),d=y.flags,d&65536?(y.flags=d&-65537|128,y):null;case 24:return pm(hn),null;case 25:return null;default:return null}}function OH(d,y){switch(hk(y),y.tag){case 3:pm(hn),Rs();break;case 26:case 27:case 5:Js(y);break;case 4:Rs();break;case 13:gm(y);break;case 19:ve(mn);break;case 10:pm(y.type);break;case 22:case 23:gm(y),Ck(),d!==null&&ve(Lg);break;case 24:pm(hn)}}function cw(d,y){try{var x=y.updateQueue,C=x!==null?x.lastEffect:null;if(C!==null){var N=C.next;x=N;do{if((x.tag&d)===d){C=void 0;var $=x.create,j=x.inst;C=$(),j.destroy=C}x=x.next}while(x!==N)}}catch(J){yi(y,y.return,J)}}function ip(d,y,x){try{var C=y.updateQueue,N=C!==null?C.lastEffect:null;if(N!==null){var $=N.next;C=$;do{if((C.tag&d)===d){var j=C.inst,J=j.destroy;if(J!==void 0){j.destroy=void 0,N=y;var oe=x,_e=J;try{_e()}catch($e){yi(N,oe,$e)}}}C=C.next}while(C!==$)}}catch($e){yi(y,y.return,$e)}}function LH(d){var y=d.updateQueue;if(y!==null){var x=d.stateNode;try{Cj(y,x)}catch(C){yi(d,d.return,C)}}}function VH(d,y,x){x.props=qg(d.type,d.memoizedProps),x.state=d.memoizedState;try{x.componentWillUnmount()}catch(C){yi(d,y,C)}}function hw(d,y){try{var x=d.ref;if(x!==null){switch(d.tag){case 26:case 27:case 5:var C=d.stateNode;break;case 30:C=d.stateNode;break;default:C=d.stateNode}typeof x=="function"?d.refCleanup=x(C):x.current=C}}catch(N){yi(d,y,N)}}function oh(d,y){var x=d.ref,C=d.refCleanup;if(x!==null)if(typeof C=="function")try{C()}catch(N){yi(d,y,N)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof x=="function")try{x(null)}catch(N){yi(d,y,N)}else x.current=null}function qH(d){var y=d.type,x=d.memoizedProps,C=d.stateNode;try{e:switch(y){case"button":case"input":case"select":case"textarea":x.autoFocus&&C.focus();break e;case"img":x.src?C.src=x.src:x.srcSet&&(C.srcset=x.srcSet)}}catch(N){yi(d,d.return,N)}}function Kk(d,y,x){try{var C=d.stateNode;Mwe(C,d.type,x,y),C[Ci]=y}catch(N){yi(d,d.return,N)}}function GH(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&hp(d.type)||d.tag===4}function eF(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||GH(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&hp(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function tF(d,y,x){var C=d.tag;if(C===5||C===6)d=d.stateNode,y?(x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x).insertBefore(d,y):(y=x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x,y.appendChild(d),x=x._reactRootContainer,x!=null||y.onclick!==null||(y.onclick=MT));else if(C!==4&&(C===27&&hp(d.type)&&(x=d.stateNode,y=null),d=d.child,d!==null))for(tF(d,y,x),d=d.sibling;d!==null;)tF(d,y,x),d=d.sibling}function _T(d,y,x){var C=d.tag;if(C===5||C===6)d=d.stateNode,y?x.insertBefore(d,y):x.appendChild(d);else if(C!==4&&(C===27&&hp(d.type)&&(x=d.stateNode),d=d.child,d!==null))for(_T(d,y,x),d=d.sibling;d!==null;)_T(d,y,x),d=d.sibling}function zH(d){var y=d.stateNode,x=d.memoizedProps;try{for(var C=d.type,N=y.attributes;N.length;)y.removeAttributeNode(N[0]);Jn(y,C,x),y[sr]=d,y[Ci]=x}catch($){yi(d,d.return,$)}}var vm=!1,Nr=!1,sF=!1,UH=typeof WeakSet=="function"?WeakSet:Set,In=null;function uwe(d,y){if(d=d.containerInfo,PF=FT,d=ej(d),ek(d)){if("selectionStart"in d)var x={start:d.selectionStart,end:d.selectionEnd};else e:{x=(x=d.ownerDocument)&&x.defaultView||window;var C=x.getSelection&&x.getSelection();if(C&&C.rangeCount!==0){x=C.anchorNode;var N=C.anchorOffset,$=C.focusNode;C=C.focusOffset;try{x.nodeType,$.nodeType}catch{x=null;break e}var j=0,J=-1,oe=-1,_e=0,$e=0,Oe=d,xe=null;t:for(;;){for(var we;Oe!==x||N!==0&&Oe.nodeType!==3||(J=j+N),Oe!==$||C!==0&&Oe.nodeType!==3||(oe=j+C),Oe.nodeType===3&&(j+=Oe.nodeValue.length),(we=Oe.firstChild)!==null;)xe=Oe,Oe=we;for(;;){if(Oe===d)break t;if(xe===x&&++_e===N&&(J=j),xe===$&&++$e===C&&(oe=j),(we=Oe.nextSibling)!==null)break;Oe=xe,xe=Oe.parentNode}Oe=we}x=J===-1||oe===-1?null:{start:J,end:oe}}else x=null}x=x||{start:0,end:0}}else x=null;for(TF={focusedElem:d,selectionRange:x},FT=!1,In=y;In!==null;)if(y=In,d=y.child,(y.subtreeFlags&1024)!==0&&d!==null)d.return=y,In=d;else for(;In!==null;){switch(y=In,$=y.alternate,d=y.flags,y.tag){case 0:break;case 11:case 15:break;case 1:if((d&1024)!==0&&$!==null){d=void 0,x=y,N=$.memoizedProps,$=$.memoizedState,C=x.stateNode;try{var Dt=qg(x.type,N,x.elementType===x.type);d=C.getSnapshotBeforeUpdate(Dt,$),C.__reactInternalSnapshotBeforeUpdate=d}catch(It){yi(x,x.return,It)}}break;case 3:if((d&1024)!==0){if(d=y.stateNode.containerInfo,x=d.nodeType,x===9)AF(d);else if(x===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":AF(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(i(163))}if(d=y.sibling,d!==null){d.return=y.return,In=d;break}In=y.return}}function BH(d,y,x){var C=x.flags;switch(x.tag){case 0:case 11:case 15:rp(d,x),C&4&&cw(5,x);break;case 1:if(rp(d,x),C&4)if(d=x.stateNode,y===null)try{d.componentDidMount()}catch(j){yi(x,x.return,j)}else{var N=qg(x.type,y.memoizedProps);y=y.memoizedState;try{d.componentDidUpdate(N,y,d.__reactInternalSnapshotBeforeUpdate)}catch(j){yi(x,x.return,j)}}C&64&&LH(x),C&512&&hw(x,x.return);break;case 3:if(rp(d,x),C&64&&(d=x.updateQueue,d!==null)){if(y=null,x.child!==null)switch(x.child.tag){case 27:case 5:y=x.child.stateNode;break;case 1:y=x.child.stateNode}try{Cj(d,y)}catch(j){yi(x,x.return,j)}}break;case 27:y===null&&C&4&&zH(x);case 26:case 5:rp(d,x),y===null&&C&4&&qH(x),C&512&&hw(x,x.return);break;case 12:rp(d,x);break;case 13:rp(d,x),C&4&&YH(d,x),C&64&&(d=x.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(x=_we.bind(null,x),Fwe(d,x))));break;case 22:if(C=x.memoizedState!==null||vm,!C){y=y!==null&&y.memoizedState!==null||Nr,N=vm;var $=Nr;vm=C,(Nr=y)&&!$?np(d,x,(x.subtreeFlags&8772)!==0):rp(d,x),vm=N,Nr=$}break;case 30:break;default:rp(d,x)}}function jH(d){var y=d.alternate;y!==null&&(d.alternate=null,jH(y)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(y=d.stateNode,y!==null&&ll(y)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Bi=null,Ta=!1;function bm(d,y,x){for(x=x.child;x!==null;)HH(d,y,x),x=x.sibling}function HH(d,y,x){if(Si&&typeof Si.onCommitFiberUnmount=="function")try{Si.onCommitFiberUnmount(mr,x)}catch{}switch(x.tag){case 26:Nr||oh(x,y),bm(d,y,x),x.memoizedState?x.memoizedState.count--:x.stateNode&&(x=x.stateNode,x.parentNode.removeChild(x));break;case 27:Nr||oh(x,y);var C=Bi,N=Ta;hp(x.type)&&(Bi=x.stateNode,Ta=!1),bm(d,y,x),bw(x.stateNode),Bi=C,Ta=N;break;case 5:Nr||oh(x,y);case 6:if(C=Bi,N=Ta,Bi=null,bm(d,y,x),Bi=C,Ta=N,Bi!==null)if(Ta)try{(Bi.nodeType===9?Bi.body:Bi.nodeName==="HTML"?Bi.ownerDocument.body:Bi).removeChild(x.stateNode)}catch($){yi(x,y,$)}else try{Bi.removeChild(x.stateNode)}catch($){yi(x,y,$)}break;case 18:Bi!==null&&(Ta?(d=Bi,RY(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,x.stateNode),Iw(d)):RY(Bi,x.stateNode));break;case 4:C=Bi,N=Ta,Bi=x.stateNode.containerInfo,Ta=!0,bm(d,y,x),Bi=C,Ta=N;break;case 0:case 11:case 14:case 15:Nr||ip(2,x,y),Nr||ip(4,x,y),bm(d,y,x);break;case 1:Nr||(oh(x,y),C=x.stateNode,typeof C.componentWillUnmount=="function"&&VH(x,y,C)),bm(d,y,x);break;case 21:bm(d,y,x);break;case 22:Nr=(C=Nr)||x.memoizedState!==null,bm(d,y,x),Nr=C;break;default:bm(d,y,x)}}function YH(d,y){if(y.memoizedState===null&&(d=y.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{Iw(d)}catch(x){yi(y,y.return,x)}}function cwe(d){switch(d.tag){case 13:case 19:var y=d.stateNode;return y===null&&(y=d.stateNode=new UH),y;case 22:return d=d.stateNode,y=d._retryCache,y===null&&(y=d._retryCache=new UH),y;default:throw Error(i(435,d.tag))}}function iF(d,y){var x=cwe(d);y.forEach(function(C){var N=vwe.bind(null,d,C);x.has(C)||(x.add(C),C.then(N,N))})}function hl(d,y){var x=y.deletions;if(x!==null)for(var C=0;C<x.length;C++){var N=x[C],$=d,j=y,J=j;e:for(;J!==null;){switch(J.tag){case 27:if(hp(J.type)){Bi=J.stateNode,Ta=!1;break e}break;case 5:Bi=J.stateNode,Ta=!1;break e;case 3:case 4:Bi=J.stateNode.containerInfo,Ta=!0;break e}J=J.return}if(Bi===null)throw Error(i(160));HH($,j,N),Bi=null,Ta=!1,$=N.alternate,$!==null&&($.return=null),N.return=null}if(y.subtreeFlags&13878)for(y=y.child;y!==null;)XH(y,d),y=y.sibling}var Qu=null;function XH(d,y){var x=d.alternate,C=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:hl(y,d),ml(d),C&4&&(ip(3,d,d.return),cw(3,d),ip(5,d,d.return));break;case 1:hl(y,d),ml(d),C&512&&(Nr||x===null||oh(x,x.return)),C&64&&vm&&(d=d.updateQueue,d!==null&&(C=d.callbacks,C!==null&&(x=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=x===null?C:x.concat(C))));break;case 26:var N=Qu;if(hl(y,d),ml(d),C&512&&(Nr||x===null||oh(x,x.return)),C&4){var $=x!==null?x.memoizedState:null;if(C=d.memoizedState,x===null)if(C===null)if(d.stateNode===null){e:{C=d.type,x=d.memoizedProps,N=N.ownerDocument||N;t:switch(C){case"title":$=N.getElementsByTagName("title")[0],(!$||$[Tg]||$[sr]||$.namespaceURI==="http://www.w3.org/2000/svg"||$.hasAttribute("itemprop"))&&($=N.createElement(C),N.head.insertBefore($,N.querySelector("head > title"))),Jn($,C,x),$[sr]=d,Ir($),C=$;break e;case"link":var j=zY("link","href",N).get(C+(x.href||""));if(j){for(var J=0;J<j.length;J++)if($=j[J],$.getAttribute("href")===(x.href==null||x.href===""?null:x.href)&&$.getAttribute("rel")===(x.rel==null?null:x.rel)&&$.getAttribute("title")===(x.title==null?null:x.title)&&$.getAttribute("crossorigin")===(x.crossOrigin==null?null:x.crossOrigin)){j.splice(J,1);break t}}$=N.createElement(C),Jn($,C,x),N.head.appendChild($);break;case"meta":if(j=zY("meta","content",N).get(C+(x.content||""))){for(J=0;J<j.length;J++)if($=j[J],$.getAttribute("content")===(x.content==null?null:""+x.content)&&$.getAttribute("name")===(x.name==null?null:x.name)&&$.getAttribute("property")===(x.property==null?null:x.property)&&$.getAttribute("http-equiv")===(x.httpEquiv==null?null:x.httpEquiv)&&$.getAttribute("charset")===(x.charSet==null?null:x.charSet)){j.splice(J,1);break t}}$=N.createElement(C),Jn($,C,x),N.head.appendChild($);break;default:throw Error(i(468,C))}$[sr]=d,Ir($),C=$}d.stateNode=C}else UY(N,d.type,d.stateNode);else d.stateNode=GY(N,C,d.memoizedProps);else $!==C?($===null?x.stateNode!==null&&(x=x.stateNode,x.parentNode.removeChild(x)):$.count--,C===null?UY(N,d.type,d.stateNode):GY(N,C,d.memoizedProps)):C===null&&d.stateNode!==null&&Kk(d,d.memoizedProps,x.memoizedProps)}break;case 27:hl(y,d),ml(d),C&512&&(Nr||x===null||oh(x,x.return)),x!==null&&C&4&&Kk(d,d.memoizedProps,x.memoizedProps);break;case 5:if(hl(y,d),ml(d),C&512&&(Nr||x===null||oh(x,x.return)),d.flags&32){N=d.stateNode;try{N0(N,"")}catch(we){yi(d,d.return,we)}}C&4&&d.stateNode!=null&&(N=d.memoizedProps,Kk(d,N,x!==null?x.memoizedProps:N)),C&1024&&(sF=!0);break;case 6:if(hl(y,d),ml(d),C&4){if(d.stateNode===null)throw Error(i(162));C=d.memoizedProps,x=d.stateNode;try{x.nodeValue=C}catch(we){yi(d,d.return,we)}}break;case 3:if($T=null,N=Qu,Qu=NT(y.containerInfo),hl(y,d),Qu=N,ml(d),C&4&&x!==null&&x.memoizedState.isDehydrated)try{Iw(y.containerInfo)}catch(we){yi(d,d.return,we)}sF&&(sF=!1,WH(d));break;case 4:C=Qu,Qu=NT(d.stateNode.containerInfo),hl(y,d),ml(d),Qu=C;break;case 12:hl(y,d),ml(d);break;case 13:hl(y,d),ml(d),d.child.flags&8192&&d.memoizedState!==null!=(x!==null&&x.memoizedState!==null)&&(uF=De()),C&4&&(C=d.updateQueue,C!==null&&(d.updateQueue=null,iF(d,C)));break;case 22:N=d.memoizedState!==null;var oe=x!==null&&x.memoizedState!==null,_e=vm,$e=Nr;if(vm=_e||N,Nr=$e||oe,hl(y,d),Nr=$e,vm=_e,ml(d),C&8192)e:for(y=d.stateNode,y._visibility=N?y._visibility&-2:y._visibility|1,N&&(x===null||oe||vm||Nr||Gg(d)),x=null,y=d;;){if(y.tag===5||y.tag===26){if(x===null){oe=x=y;try{if($=oe.stateNode,N)j=$.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{J=oe.stateNode;var Oe=oe.memoizedProps.style,xe=Oe!=null&&Oe.hasOwnProperty("display")?Oe.display:null;J.style.display=xe==null||typeof xe=="boolean"?"":(""+xe).trim()}}catch(we){yi(oe,oe.return,we)}}}else if(y.tag===6){if(x===null){oe=y;try{oe.stateNode.nodeValue=N?"":oe.memoizedProps}catch(we){yi(oe,oe.return,we)}}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===d)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===d)break e;for(;y.sibling===null;){if(y.return===null||y.return===d)break e;x===y&&(x=null),y=y.return}x===y&&(x=null),y.sibling.return=y.return,y=y.sibling}C&4&&(C=d.updateQueue,C!==null&&(x=C.retryQueue,x!==null&&(C.retryQueue=null,iF(d,x))));break;case 19:hl(y,d),ml(d),C&4&&(C=d.updateQueue,C!==null&&(d.updateQueue=null,iF(d,C)));break;case 30:break;case 21:break;default:hl(y,d),ml(d)}}function ml(d){var y=d.flags;if(y&2){try{for(var x,C=d.return;C!==null;){if(GH(C)){x=C;break}C=C.return}if(x==null)throw Error(i(160));switch(x.tag){case 27:var N=x.stateNode,$=eF(d);_T(d,$,N);break;case 5:var j=x.stateNode;x.flags&32&&(N0(j,""),x.flags&=-33);var J=eF(d);_T(d,J,j);break;case 3:case 4:var oe=x.stateNode.containerInfo,_e=eF(d);tF(d,_e,oe);break;default:throw Error(i(161))}}catch($e){yi(d,d.return,$e)}d.flags&=-3}y&4096&&(d.flags&=-4097)}function WH(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var y=d;WH(y),y.tag===5&&y.flags&1024&&y.stateNode.reset(),d=d.sibling}}function rp(d,y){if(y.subtreeFlags&8772)for(y=y.child;y!==null;)BH(d,y.alternate,y),y=y.sibling}function Gg(d){for(d=d.child;d!==null;){var y=d;switch(y.tag){case 0:case 11:case 14:case 15:ip(4,y,y.return),Gg(y);break;case 1:oh(y,y.return);var x=y.stateNode;typeof x.componentWillUnmount=="function"&&VH(y,y.return,x),Gg(y);break;case 27:bw(y.stateNode);case 26:case 5:oh(y,y.return),Gg(y);break;case 22:y.memoizedState===null&&Gg(y);break;case 30:Gg(y);break;default:Gg(y)}d=d.sibling}}function np(d,y,x){for(x=x&&(y.subtreeFlags&8772)!==0,y=y.child;y!==null;){var C=y.alternate,N=d,$=y,j=$.flags;switch($.tag){case 0:case 11:case 15:np(N,$,x),cw(4,$);break;case 1:if(np(N,$,x),C=$,N=C.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(_e){yi(C,C.return,_e)}if(C=$,N=C.updateQueue,N!==null){var J=C.stateNode;try{var oe=N.shared.hiddenCallbacks;if(oe!==null)for(N.shared.hiddenCallbacks=null,N=0;N<oe.length;N++)Ej(oe[N],J)}catch(_e){yi(C,C.return,_e)}}x&&j&64&&LH($),hw($,$.return);break;case 27:zH($);case 26:case 5:np(N,$,x),x&&C===null&&j&4&&qH($),hw($,$.return);break;case 12:np(N,$,x);break;case 13:np(N,$,x),x&&j&4&&YH(N,$);break;case 22:$.memoizedState===null&&np(N,$,x),hw($,$.return);break;case 30:break;default:np(N,$,x)}y=y.sibling}}function rF(d,y){var x=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),d=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(d=y.memoizedState.cachePool.pool),d!==x&&(d!=null&&d.refCount++,x!=null&&Zx(x))}function nF(d,y){d=null,y.alternate!==null&&(d=y.alternate.memoizedState.cache),y=y.memoizedState.cache,y!==d&&(y.refCount++,d!=null&&Zx(d))}function ah(d,y,x,C){if(y.subtreeFlags&10256)for(y=y.child;y!==null;)ZH(d,y,x,C),y=y.sibling}function ZH(d,y,x,C){var N=y.flags;switch(y.tag){case 0:case 11:case 15:ah(d,y,x,C),N&2048&&cw(9,y);break;case 1:ah(d,y,x,C);break;case 3:ah(d,y,x,C),N&2048&&(d=null,y.alternate!==null&&(d=y.alternate.memoizedState.cache),y=y.memoizedState.cache,y!==d&&(y.refCount++,d!=null&&Zx(d)));break;case 12:if(N&2048){ah(d,y,x,C),d=y.stateNode;try{var $=y.memoizedProps,j=$.id,J=$.onPostCommit;typeof J=="function"&&J(j,y.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(oe){yi(y,y.return,oe)}}else ah(d,y,x,C);break;case 13:ah(d,y,x,C);break;case 23:break;case 22:$=y.stateNode,j=y.alternate,y.memoizedState!==null?$._visibility&2?ah(d,y,x,C):mw(d,y):$._visibility&2?ah(d,y,x,C):($._visibility|=2,Z0(d,y,x,C,(y.subtreeFlags&10256)!==0)),N&2048&&rF(j,y);break;case 24:ah(d,y,x,C),N&2048&&nF(y.alternate,y);break;default:ah(d,y,x,C)}}function Z0(d,y,x,C,N){for(N=N&&(y.subtreeFlags&10256)!==0,y=y.child;y!==null;){var $=d,j=y,J=x,oe=C,_e=j.flags;switch(j.tag){case 0:case 11:case 15:Z0($,j,J,oe,N),cw(8,j);break;case 23:break;case 22:var $e=j.stateNode;j.memoizedState!==null?$e._visibility&2?Z0($,j,J,oe,N):mw($,j):($e._visibility|=2,Z0($,j,J,oe,N)),N&&_e&2048&&rF(j.alternate,j);break;case 24:Z0($,j,J,oe,N),N&&_e&2048&&nF(j.alternate,j);break;default:Z0($,j,J,oe,N)}y=y.sibling}}function mw(d,y){if(y.subtreeFlags&10256)for(y=y.child;y!==null;){var x=d,C=y,N=C.flags;switch(C.tag){case 22:mw(x,C),N&2048&&rF(C.alternate,C);break;case 24:mw(x,C),N&2048&&nF(C.alternate,C);break;default:mw(x,C)}y=y.sibling}}var dw=8192;function Q0(d){if(d.subtreeFlags&dw)for(d=d.child;d!==null;)QH(d),d=d.sibling}function QH(d){switch(d.tag){case 26:Q0(d),d.flags&dw&&d.memoizedState!==null&&Wwe(Qu,d.memoizedState,d.memoizedProps);break;case 5:Q0(d);break;case 3:case 4:var y=Qu;Qu=NT(d.stateNode.containerInfo),Q0(d),Qu=y;break;case 22:d.memoizedState===null&&(y=d.alternate,y!==null&&y.memoizedState!==null?(y=dw,dw=16777216,Q0(d),dw=y):Q0(d));break;default:Q0(d)}}function JH(d){var y=d.alternate;if(y!==null&&(d=y.child,d!==null)){y.child=null;do y=d.sibling,d.sibling=null,d=y;while(d!==null)}}function pw(d){var y=d.deletions;if((d.flags&16)!==0){if(y!==null)for(var x=0;x<y.length;x++){var C=y[x];In=C,eY(C,d)}JH(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)KH(d),d=d.sibling}function KH(d){switch(d.tag){case 0:case 11:case 15:pw(d),d.flags&2048&&ip(9,d,d.return);break;case 3:pw(d);break;case 12:pw(d);break;case 22:var y=d.stateNode;d.memoizedState!==null&&y._visibility&2&&(d.return===null||d.return.tag!==13)?(y._visibility&=-3,vT(d)):pw(d);break;default:pw(d)}}function vT(d){var y=d.deletions;if((d.flags&16)!==0){if(y!==null)for(var x=0;x<y.length;x++){var C=y[x];In=C,eY(C,d)}JH(d)}for(d=d.child;d!==null;){switch(y=d,y.tag){case 0:case 11:case 15:ip(8,y,y.return),vT(y);break;case 22:x=y.stateNode,x._visibility&2&&(x._visibility&=-3,vT(y));break;default:vT(y)}d=d.sibling}}function eY(d,y){for(;In!==null;){var x=In;switch(x.tag){case 0:case 11:case 15:ip(8,x,y);break;case 23:case 22:if(x.memoizedState!==null&&x.memoizedState.cachePool!==null){var C=x.memoizedState.cachePool.pool;C!=null&&C.refCount++}break;case 24:Zx(x.memoizedState.cache)}if(C=x.child,C!==null)C.return=x,In=C;else e:for(x=d;In!==null;){C=In;var N=C.sibling,$=C.return;if(jH(C),C===x){In=null;break e}if(N!==null){N.return=$,In=N;break e}In=$}}}var hwe={getCacheForType:function(d){var y=_o(hn),x=y.data.get(d);return x===void 0&&(x=d(),y.data.set(d,x)),x}},mwe=typeof WeakMap=="function"?WeakMap:Map,ti=0,Pi=null,ls=null,_s=0,si=0,dl=null,op=!1,J0=!1,oF=!1,xm=0,fr=0,ap=0,zg=0,aF=0,uu=0,K0=0,fw=null,Ia=null,lF=!1,uF=0,bT=1/0,xT=null,lp=null,Qn=0,up=null,e1=null,t1=0,cF=0,hF=null,tY=null,gw=0,mF=null;function pl(){if((ti&2)!==0&&_s!==0)return _s&-_s;if(H.T!==null){var d=z0;return d!==0?d:vF()}return NP()}function sY(){uu===0&&(uu=(_s&536870912)===0||Fs?jd():536870912);var d=lu.current;return d!==null&&(d.flags|=32),uu}function fl(d,y,x){(d===Pi&&(si===2||si===9)||d.cancelPendingCommit!==null)&&(s1(d,0),cp(d,_s,uu,!1)),Pg(d,x),((ti&2)===0||d!==Pi)&&(d===Pi&&((ti&2)===0&&(zg|=x),fr===4&&cp(d,_s,uu,!1)),lh(d))}function iY(d,y,x){if((ti&6)!==0)throw Error(i(327));var C=!x&&(y&124)===0&&(y&d.expiredLanes)===0||yo(d,y),N=C?fwe(d,y):fF(d,y,!0),$=C;do{if(N===0){J0&&!C&&cp(d,y,0,!1);break}else{if(x=d.current.alternate,$&&!dwe(x)){N=fF(d,y,!1),$=!1;continue}if(N===2){if($=y,d.errorRecoveryDisabledLanes&$)var j=0;else j=d.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){y=j;e:{var J=d;N=fw;var oe=J.current.memoizedState.isDehydrated;if(oe&&(s1(J,j).flags|=256),j=fF(J,j,!1),j!==2){if(oF&&!oe){J.errorRecoveryDisabledLanes|=$,zg|=$,N=4;break e}$=Ia,Ia=N,$!==null&&(Ia===null?Ia=$:Ia.push.apply(Ia,$))}N=j}if($=!1,N!==2)continue}}if(N===1){s1(d,0),cp(d,y,0,!0);break}e:{switch(C=d,$=N,$){case 0:case 1:throw Error(i(345));case 4:if((y&4194048)!==y)break;case 6:cp(C,y,uu,!op);break e;case 2:Ia=null;break;case 3:case 5:break;default:throw Error(i(329))}if((y&62914560)===y&&(N=uF+300-De(),10<N)){if(cp(C,y,uu,!op),Xo(C,0,!0)!==0)break e;C.timeoutHandle=DY(rY.bind(null,C,x,Ia,xT,lF,y,uu,zg,K0,op,$,2,-0,0),N);break e}rY(C,x,Ia,xT,lF,y,uu,zg,K0,op,$,0,-0,0)}}break}while(!0);lh(d)}function rY(d,y,x,C,N,$,j,J,oe,_e,$e,Oe,xe,we){if(d.timeoutHandle=-1,Oe=y.subtreeFlags,(Oe&8192||(Oe&16785408)===16785408)&&(Sw={stylesheets:null,count:0,unsuspend:Xwe},QH(y),Oe=Zwe(),Oe!==null)){d.cancelPendingCommit=Oe(hY.bind(null,d,y,$,x,C,N,j,J,oe,$e,1,xe,we)),cp(d,$,j,!_e);return}hY(d,y,$,x,C,N,j,J,oe)}function dwe(d){for(var y=d;;){var x=y.tag;if((x===0||x===11||x===15)&&y.flags&16384&&(x=y.updateQueue,x!==null&&(x=x.stores,x!==null)))for(var C=0;C<x.length;C++){var N=x[C],$=N.getSnapshot;N=N.value;try{if(!ul($(),N))return!1}catch{return!1}}if(x=y.child,y.subtreeFlags&16384&&x!==null)x.return=y,y=x;else{if(y===d)break;for(;y.sibling===null;){if(y.return===null||y.return===d)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function cp(d,y,x,C){y&=~aF,y&=~zg,d.suspendedLanes|=y,d.pingedLanes&=~y,C&&(d.warmLanes|=y),C=d.expirationTimes;for(var N=y;0<N;){var $=31-Cs(N),j=1<<$;C[$]=-1,N&=~j}x!==0&&MP(d,x,y)}function wT(){return(ti&6)===0?(yw(0),!1):!0}function dF(){if(ls!==null){if(si===0)var d=ls.return;else d=ls,dm=Fg=null,Ak(d),X0=null,aw=0,d=ls;for(;d!==null;)OH(d.alternate,d),d=d.return;ls=null}}function s1(d,y){var x=d.timeoutHandle;x!==-1&&(d.timeoutHandle=-1,Nwe(x)),x=d.cancelPendingCommit,x!==null&&(d.cancelPendingCommit=null,x()),dF(),Pi=d,ls=x=cm(d.current,null),_s=y,si=0,dl=null,op=!1,J0=yo(d,y),oF=!1,K0=uu=aF=zg=ap=fr=0,Ia=fw=null,lF=!1,(y&8)!==0&&(y|=y&32);var C=d.entangledLanes;if(C!==0)for(d=d.entanglements,C&=y;0<C;){var N=31-Cs(C),$=1<<N;y|=d[N],C&=~$}return xm=y,BP(),x}function nY(d,y){es=null,H.H=uT,y===Jx||y===KP?(y=wj(),si=3):y===vj?(y=wj(),si=4):si=y===SH?8:y!==null&&typeof y=="object"&&typeof y.then=="function"?6:1,dl=y,ls===null&&(fr=1,pT(d,ru(y,d.current)))}function oY(){var d=H.H;return H.H=uT,d===null?uT:d}function aY(){var d=H.A;return H.A=hwe,d}function pF(){fr=4,op||(_s&4194048)!==_s&&lu.current!==null||(J0=!0),(ap&134217727)===0&&(zg&134217727)===0||Pi===null||cp(Pi,_s,uu,!1)}function fF(d,y,x){var C=ti;ti|=2;var N=oY(),$=aY();(Pi!==d||_s!==y)&&(xT=null,s1(d,y)),y=!1;var j=fr;e:do try{if(si!==0&&ls!==null){var J=ls,oe=dl;switch(si){case 8:dF(),j=6;break e;case 3:case 2:case 9:case 6:lu.current===null&&(y=!0);var _e=si;if(si=0,dl=null,i1(d,J,oe,_e),x&&J0){j=0;break e}break;default:_e=si,si=0,dl=null,i1(d,J,oe,_e)}}pwe(),j=fr;break}catch($e){nY(d,$e)}while(!0);return y&&d.shellSuspendCounter++,dm=Fg=null,ti=C,H.H=N,H.A=$,ls===null&&(Pi=null,_s=0,BP()),j}function pwe(){for(;ls!==null;)lY(ls)}function fwe(d,y){var x=ti;ti|=2;var C=oY(),N=aY();Pi!==d||_s!==y?(xT=null,bT=De()+500,s1(d,y)):J0=yo(d,y);e:do try{if(si!==0&&ls!==null){y=ls;var $=dl;t:switch(si){case 1:si=0,dl=null,i1(d,y,$,1);break;case 2:case 9:if(bj($)){si=0,dl=null,uY(y);break}y=function(){si!==2&&si!==9||Pi!==d||(si=7),lh(d)},$.then(y,y);break e;case 3:si=7;break e;case 4:si=5;break e;case 7:bj($)?(si=0,dl=null,uY(y)):(si=0,dl=null,i1(d,y,$,7));break;case 5:var j=null;switch(ls.tag){case 26:j=ls.memoizedState;case 5:case 27:var J=ls;if(!j||BY(j)){si=0,dl=null;var oe=J.sibling;if(oe!==null)ls=oe;else{var _e=J.return;_e!==null?(ls=_e,ST(_e)):ls=null}break t}}si=0,dl=null,i1(d,y,$,5);break;case 6:si=0,dl=null,i1(d,y,$,6);break;case 8:dF(),fr=6;break e;default:throw Error(i(462))}}gwe();break}catch($e){nY(d,$e)}while(!0);return dm=Fg=null,H.H=C,H.A=N,ti=x,ls!==null?0:(Pi=null,_s=0,BP(),fr)}function gwe(){for(;ls!==null&&!Ks();)lY(ls)}function lY(d){var y=kH(d.alternate,d,xm);d.memoizedProps=d.pendingProps,y===null?ST(d):ls=y}function uY(d){var y=d,x=y.alternate;switch(y.tag){case 15:case 0:y=MH(x,y,y.pendingProps,y.type,void 0,_s);break;case 11:y=MH(x,y,y.pendingProps,y.type.render,y.ref,_s);break;case 5:Ak(y);default:OH(x,y),y=ls=cj(y,xm),y=kH(x,y,xm)}d.memoizedProps=d.pendingProps,y===null?ST(d):ls=y}function i1(d,y,x,C){dm=Fg=null,Ak(y),X0=null,aw=0;var N=y.return;try{if(nwe(d,N,y,x,_s)){fr=1,pT(d,ru(x,d.current)),ls=null;return}}catch($){if(N!==null)throw ls=N,$;fr=1,pT(d,ru(x,d.current)),ls=null;return}y.flags&32768?(Fs||C===1?d=!0:J0||(_s&536870912)!==0?d=!1:(op=d=!0,(C===2||C===9||C===3||C===6)&&(C=lu.current,C!==null&&C.tag===13&&(C.flags|=16384))),cY(y,d)):ST(y)}function ST(d){var y=d;do{if((y.flags&32768)!==0){cY(y,op);return}d=y.return;var x=awe(y.alternate,y,xm);if(x!==null){ls=x;return}if(y=y.sibling,y!==null){ls=y;return}ls=y=d}while(y!==null);fr===0&&(fr=5)}function cY(d,y){do{var x=lwe(d.alternate,d);if(x!==null){x.flags&=32767,ls=x;return}if(x=d.return,x!==null&&(x.flags|=32768,x.subtreeFlags=0,x.deletions=null),!y&&(d=d.sibling,d!==null)){ls=d;return}ls=d=x}while(d!==null);fr=6,ls=null}function hY(d,y,x,C,N,$,j,J,oe){d.cancelPendingCommit=null;do ET();while(Qn!==0);if((ti&6)!==0)throw Error(i(327));if(y!==null){if(y===d.current)throw Error(i(177));if($=y.lanes|y.childLanes,$|=nk,LR(d,x,$,j,J,oe),d===Pi&&(ls=Pi=null,_s=0),e1=y,up=d,t1=x,cF=$,hF=N,tY=C,(y.subtreeFlags&10256)!==0||(y.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,bwe(tr,function(){return gY(),null})):(d.callbackNode=null,d.callbackPriority=0),C=(y.flags&13878)!==0,(y.subtreeFlags&13878)!==0||C){C=H.T,H.T=null,N=W.p,W.p=2,j=ti,ti|=4;try{uwe(d,y,x)}finally{ti=j,W.p=N,H.T=C}}Qn=1,mY(),dY(),pY()}}function mY(){if(Qn===1){Qn=0;var d=up,y=e1,x=(y.flags&13878)!==0;if((y.subtreeFlags&13878)!==0||x){x=H.T,H.T=null;var C=W.p;W.p=2;var N=ti;ti|=4;try{XH(y,d);var $=TF,j=ej(d.containerInfo),J=$.focusedElem,oe=$.selectionRange;if(j!==J&&J&&J.ownerDocument&&KB(J.ownerDocument.documentElement,J)){if(oe!==null&&ek(J)){var _e=oe.start,$e=oe.end;if($e===void 0&&($e=_e),"selectionStart"in J)J.selectionStart=_e,J.selectionEnd=Math.min($e,J.value.length);else{var Oe=J.ownerDocument||document,xe=Oe&&Oe.defaultView||window;if(xe.getSelection){var we=xe.getSelection(),Dt=J.textContent.length,It=Math.min(oe.start,Dt),ui=oe.end===void 0?It:Math.min(oe.end,Dt);!we.extend&&It>ui&&(j=ui,ui=It,It=j);var pe=JB(J,It),ce=JB(J,ui);if(pe&&ce&&(we.rangeCount!==1||we.anchorNode!==pe.node||we.anchorOffset!==pe.offset||we.focusNode!==ce.node||we.focusOffset!==ce.offset)){var ye=Oe.createRange();ye.setStart(pe.node,pe.offset),we.removeAllRanges(),It>ui?(we.addRange(ye),we.extend(ce.node,ce.offset)):(ye.setEnd(ce.node,ce.offset),we.addRange(ye))}}}}for(Oe=[],we=J;we=we.parentNode;)we.nodeType===1&&Oe.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof J.focus=="function"&&J.focus(),J=0;J<Oe.length;J++){var Re=Oe[J];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}FT=!!PF,TF=PF=null}finally{ti=N,W.p=C,H.T=x}}d.current=y,Qn=2}}function dY(){if(Qn===2){Qn=0;var d=up,y=e1,x=(y.flags&8772)!==0;if((y.subtreeFlags&8772)!==0||x){x=H.T,H.T=null;var C=W.p;W.p=2;var N=ti;ti|=4;try{BH(d,y.alternate,y)}finally{ti=N,W.p=C,H.T=x}}Qn=3}}function pY(){if(Qn===4||Qn===3){Qn=0,dt();var d=up,y=e1,x=t1,C=tY;(y.subtreeFlags&10256)!==0||(y.flags&10256)!==0?Qn=5:(Qn=0,e1=up=null,fY(d,d.pendingLanes));var N=d.pendingLanes;if(N===0&&(lp=null),Dx(x),y=y.stateNode,Si&&typeof Si.onCommitFiberRoot=="function")try{Si.onCommitFiberRoot(mr,y,void 0,(y.current.flags&128)===128)}catch{}if(C!==null){y=H.T,N=W.p,W.p=2,H.T=null;try{for(var $=d.onRecoverableError,j=0;j<C.length;j++){var J=C[j];$(J.value,{componentStack:J.stack})}}finally{H.T=y,W.p=N}}(t1&3)!==0&&ET(),lh(d),N=d.pendingLanes,(x&4194090)!==0&&(N&42)!==0?d===mF?gw++:(gw=0,mF=d):gw=0,yw(0)}}function fY(d,y){(d.pooledCacheLanes&=y)===0&&(y=d.pooledCache,y!=null&&(d.pooledCache=null,Zx(y)))}function ET(d){return mY(),dY(),pY(),gY()}function gY(){if(Qn!==5)return!1;var d=up,y=cF;cF=0;var x=Dx(t1),C=H.T,N=W.p;try{W.p=32>x?32:x,H.T=null,x=hF,hF=null;var $=up,j=t1;if(Qn=0,e1=up=null,t1=0,(ti&6)!==0)throw Error(i(331));var J=ti;if(ti|=4,KH($.current),ZH($,$.current,j,x),ti=J,yw(0,!1),Si&&typeof Si.onPostCommitFiberRoot=="function")try{Si.onPostCommitFiberRoot(mr,$)}catch{}return!0}finally{W.p=N,H.T=C,fY(d,y)}}function yY(d,y,x){y=ru(x,y),y=Bk(d.stateNode,y,2),d=Kd(d,y,2),d!==null&&(Pg(d,2),lh(d))}function yi(d,y,x){if(d.tag===3)yY(d,d,x);else for(;y!==null;){if(y.tag===3){yY(y,d,x);break}else if(y.tag===1){var C=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(lp===null||!lp.has(C))){d=ru(x,d),x=xH(2),C=Kd(y,x,2),C!==null&&(wH(x,C,y,d),Pg(C,2),lh(C));break}}y=y.return}}function gF(d,y,x){var C=d.pingCache;if(C===null){C=d.pingCache=new mwe;var N=new Set;C.set(y,N)}else N=C.get(y),N===void 0&&(N=new Set,C.set(y,N));N.has(x)||(oF=!0,N.add(x),d=ywe.bind(null,d,y,x),y.then(d,d))}function ywe(d,y,x){var C=d.pingCache;C!==null&&C.delete(y),d.pingedLanes|=d.suspendedLanes&x,d.warmLanes&=~x,Pi===d&&(_s&x)===x&&(fr===4||fr===3&&(_s&62914560)===_s&&300>De()-uF?(ti&2)===0&&s1(d,0):aF|=x,K0===_s&&(K0=0)),lh(d)}function _Y(d,y){y===0&&(y=IP()),d=L0(d,y),d!==null&&(Pg(d,y),lh(d))}function _we(d){var y=d.memoizedState,x=0;y!==null&&(x=y.retryLane),_Y(d,x)}function vwe(d,y){var x=0;switch(d.tag){case 13:var C=d.stateNode,N=d.memoizedState;N!==null&&(x=N.retryLane);break;case 19:C=d.stateNode;break;case 22:C=d.stateNode._retryCache;break;default:throw Error(i(314))}C!==null&&C.delete(y),_Y(d,x)}function bwe(d,y){return er(d,y)}var CT=null,r1=null,yF=!1,PT=!1,_F=!1,Ug=0;function lh(d){d!==r1&&d.next===null&&(r1===null?CT=r1=d:r1=r1.next=d),PT=!0,yF||(yF=!0,wwe())}function yw(d,y){if(!_F&&PT){_F=!0;do for(var x=!1,C=CT;C!==null;){if(d!==0){var N=C.pendingLanes;if(N===0)var $=0;else{var j=C.suspendedLanes,J=C.pingedLanes;$=(1<<31-Cs(42|d)+1)-1,$&=N&~(j&~J),$=$&201326741?$&201326741|1:$?$|2:0}$!==0&&(x=!0,wY(C,$))}else $=_s,$=Xo(C,C===Pi?$:0,C.cancelPendingCommit!==null||C.timeoutHandle!==-1),($&3)===0||yo(C,$)||(x=!0,wY(C,$));C=C.next}while(x);_F=!1}}function xwe(){vY()}function vY(){PT=yF=!1;var d=0;Ug!==0&&(Awe()&&(d=Ug),Ug=0);for(var y=De(),x=null,C=CT;C!==null;){var N=C.next,$=bY(C,y);$===0?(C.next=null,x===null?CT=N:x.next=N,N===null&&(r1=x)):(x=C,(d!==0||($&3)!==0)&&(PT=!0)),C=N}yw(d)}function bY(d,y){for(var x=d.suspendedLanes,C=d.pingedLanes,N=d.expirationTimes,$=d.pendingLanes&-62914561;0<$;){var j=31-Cs($),J=1<<j,oe=N[j];oe===-1?((J&x)===0||(J&C)!==0)&&(N[j]=Hu(J,y)):oe<=y&&(d.expiredLanes|=J),$&=~J}if(y=Pi,x=_s,x=Xo(d,d===y?x:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),C=d.callbackNode,x===0||d===y&&(si===2||si===9)||d.cancelPendingCommit!==null)return C!==null&&C!==null&&fi(C),d.callbackNode=null,d.callbackPriority=0;if((x&3)===0||yo(d,x)){if(y=x&-x,y===d.callbackPriority)return y;switch(C!==null&&fi(C),Dx(x)){case 2:case 8:x=Ui;break;case 32:x=tr;break;case 268435456:x=Ai;break;default:x=tr}return C=xY.bind(null,d),x=er(x,C),d.callbackPriority=y,d.callbackNode=x,y}return C!==null&&C!==null&&fi(C),d.callbackPriority=2,d.callbackNode=null,2}function xY(d,y){if(Qn!==0&&Qn!==5)return d.callbackNode=null,d.callbackPriority=0,null;var x=d.callbackNode;if(ET()&&d.callbackNode!==x)return null;var C=_s;return C=Xo(d,d===Pi?C:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),C===0?null:(iY(d,C,y),bY(d,De()),d.callbackNode!=null&&d.callbackNode===x?xY.bind(null,d):null)}function wY(d,y){if(ET())return null;iY(d,y,!0)}function wwe(){Dwe(function(){(ti&6)!==0?er(Pr,xwe):vY()})}function vF(){return Ug===0&&(Ug=jd()),Ug}function SY(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:OP(""+d)}function EY(d,y){var x=y.ownerDocument.createElement("input");return x.name=y.name,x.value=y.value,d.id&&x.setAttribute("form",d.id),y.parentNode.insertBefore(x,y),d=new FormData(d),x.parentNode.removeChild(x),d}function Swe(d,y,x,C,N){if(y==="submit"&&x&&x.stateNode===N){var $=SY((N[Ci]||null).action),j=C.submitter;j&&(y=(y=j[Ci]||null)?SY(y.formAction):j.getAttribute("formAction"),y!==null&&($=y,j=null));var J=new GP("action","action",null,C,N);d.push({event:J,listeners:[{instance:null,listener:function(){if(C.defaultPrevented){if(Ug!==0){var oe=j?EY(N,j):new FormData(N);Vk(x,{pending:!0,data:oe,method:N.method,action:$},null,oe)}}else typeof $=="function"&&(J.preventDefault(),oe=j?EY(N,j):new FormData(N),Vk(x,{pending:!0,data:oe,method:N.method,action:$},$,oe))},currentTarget:N}]})}}for(var bF=0;bF<rk.length;bF++){var xF=rk[bF],Ewe=xF.toLowerCase(),Cwe=xF[0].toUpperCase()+xF.slice(1);Zu(Ewe,"on"+Cwe)}Zu(ij,"onAnimationEnd"),Zu(rj,"onAnimationIteration"),Zu(nj,"onAnimationStart"),Zu("dblclick","onDoubleClick"),Zu("focusin","onFocus"),Zu("focusout","onBlur"),Zu(zxe,"onTransitionRun"),Zu(Uxe,"onTransitionStart"),Zu(Bxe,"onTransitionCancel"),Zu(oj,"onTransitionEnd"),Xd("onMouseEnter",["mouseout","mouseover"]),Xd("onMouseLeave",["mouseout","mouseover"]),Xd("onPointerEnter",["pointerout","pointerover"]),Xd("onPointerLeave",["pointerout","pointerover"]),Xu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xu("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _w="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pwe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(_w));function CY(d,y){y=(y&4)!==0;for(var x=0;x<d.length;x++){var C=d[x],N=C.event;C=C.listeners;e:{var $=void 0;if(y)for(var j=C.length-1;0<=j;j--){var J=C[j],oe=J.instance,_e=J.currentTarget;if(J=J.listener,oe!==$&&N.isPropagationStopped())break e;$=J,N.currentTarget=_e;try{$(N)}catch($e){dT($e)}N.currentTarget=null,$=oe}else for(j=0;j<C.length;j++){if(J=C[j],oe=J.instance,_e=J.currentTarget,J=J.listener,oe!==$&&N.isPropagationStopped())break e;$=J,N.currentTarget=_e;try{$(N)}catch($e){dT($e)}N.currentTarget=null,$=oe}}}}function us(d,y){var x=y[ot];x===void 0&&(x=y[ot]=new Set);var C=d+"__bubble";x.has(C)||(PY(y,d,2,!1),x.add(C))}function wF(d,y,x){var C=0;y&&(C|=4),PY(x,d,C,y)}var TT="_reactListening"+Math.random().toString(36).slice(2);function SF(d){if(!d[TT]){d[TT]=!0,DP.forEach(function(x){x!=="selectionchange"&&(Pwe.has(x)||wF(x,!1,d),wF(x,!0,d))});var y=d.nodeType===9?d:d.ownerDocument;y===null||y[TT]||(y[TT]=!0,wF("selectionchange",!1,y))}}function PY(d,y,x,C){switch(ZY(y)){case 2:var N=Kwe;break;case 8:N=e2e;break;default:N=OF}x=N.bind(null,y,x,d),N=void 0,!jR||y!=="touchstart"&&y!=="touchmove"&&y!=="wheel"||(N=!0),C?N!==void 0?d.addEventListener(y,x,{capture:!0,passive:N}):d.addEventListener(y,x,!0):N!==void 0?d.addEventListener(y,x,{passive:N}):d.addEventListener(y,x,!1)}function EF(d,y,x,C,N){var $=C;if((y&1)===0&&(y&2)===0&&C!==null)e:for(;;){if(C===null)return;var j=C.tag;if(j===3||j===4){var J=C.stateNode.containerInfo;if(J===N)break;if(j===4)for(j=C.return;j!==null;){var oe=j.tag;if((oe===3||oe===4)&&j.stateNode.containerInfo===N)return;j=j.return}for(;J!==null;){if(j=am(J),j===null)return;if(oe=j.tag,oe===5||oe===6||oe===26||oe===27){C=$=j;continue e}J=J.parentNode}}C=C.return}$B(function(){var _e=$,$e=UR(x),Oe=[];e:{var xe=aj.get(d);if(xe!==void 0){var we=GP,Dt=d;switch(d){case"keypress":if(VP(x)===0)break e;case"keydown":case"keyup":we=bxe;break;case"focusin":Dt="focus",we=WR;break;case"focusout":Dt="blur",we=WR;break;case"beforeblur":case"afterblur":we=WR;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=FB;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=lxe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=Sxe;break;case ij:case rj:case nj:we=hxe;break;case oj:we=Cxe;break;case"scroll":case"scrollend":we=oxe;break;case"wheel":we=Txe;break;case"copy":case"cut":case"paste":we=dxe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=LB;break;case"toggle":case"beforetoggle":we=Mxe}var It=(y&4)!==0,ui=!It&&(d==="scroll"||d==="scrollend"),pe=It?xe!==null?xe+"Capture":null:xe;It=[];for(var ce=_e,ye;ce!==null;){var Re=ce;if(ye=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||ye===null||pe===null||(Re=Ox(ce,pe),Re!=null&&It.push(vw(ce,Re,ye))),ui)break;ce=ce.return}0<It.length&&(xe=new we(xe,Dt,null,x,$e),Oe.push({event:xe,listeners:It}))}}if((y&7)===0){e:{if(xe=d==="mouseover"||d==="pointerover",we=d==="mouseout"||d==="pointerout",xe&&x!==zR&&(Dt=x.relatedTarget||x.fromElement)&&(am(Dt)||Dt[Yu]))break e;if((we||xe)&&(xe=$e.window===$e?$e:(xe=$e.ownerDocument)?xe.defaultView||xe.parentWindow:window,we?(Dt=x.relatedTarget||x.toElement,we=_e,Dt=Dt?am(Dt):null,Dt!==null&&(ui=n(Dt),It=Dt.tag,Dt!==ui||It!==5&&It!==27&&It!==6)&&(Dt=null)):(we=null,Dt=_e),we!==Dt)){if(It=FB,Re="onMouseLeave",pe="onMouseEnter",ce="mouse",(d==="pointerout"||d==="pointerover")&&(It=LB,Re="onPointerLeave",pe="onPointerEnter",ce="pointer"),ui=we==null?xe:Tt(we),ye=Dt==null?xe:Tt(Dt),xe=new It(Re,ce+"leave",we,x,$e),xe.target=ui,xe.relatedTarget=ye,Re=null,am($e)===_e&&(It=new It(pe,ce+"enter",Dt,x,$e),It.target=ye,It.relatedTarget=ui,Re=It),ui=Re,we&&Dt)t:{for(It=we,pe=Dt,ce=0,ye=It;ye;ye=n1(ye))ce++;for(ye=0,Re=pe;Re;Re=n1(Re))ye++;for(;0<ce-ye;)It=n1(It),ce--;for(;0<ye-ce;)pe=n1(pe),ye--;for(;ce--;){if(It===pe||pe!==null&&It===pe.alternate)break t;It=n1(It),pe=n1(pe)}It=null}else It=null;we!==null&&TY(Oe,xe,we,It,!1),Dt!==null&&ui!==null&&TY(Oe,ui,Dt,It,!0)}}e:{if(xe=_e?Tt(_e):window,we=xe.nodeName&&xe.nodeName.toLowerCase(),we==="select"||we==="input"&&xe.type==="file")var ct=HB;else if(BB(xe))if(YB)ct=Vxe;else{ct=Oxe;var ns=Fxe}else we=xe.nodeName,!we||we.toLowerCase()!=="input"||xe.type!=="checkbox"&&xe.type!=="radio"?_e&&GR(_e.elementType)&&(ct=HB):ct=Lxe;if(ct&&(ct=ct(d,_e))){jB(Oe,ct,x,$e);break e}ns&&ns(d,xe,_e),d==="focusout"&&_e&&xe.type==="number"&&_e.memoizedProps.value!=null&&qR(xe,"number",xe.value)}switch(ns=_e?Tt(_e):window,d){case"focusin":(BB(ns)||ns.contentEditable==="true")&&(k0=ns,tk=_e,jx=null);break;case"focusout":jx=tk=k0=null;break;case"mousedown":sk=!0;break;case"contextmenu":case"mouseup":case"dragend":sk=!1,tj(Oe,x,$e);break;case"selectionchange":if(Gxe)break;case"keydown":case"keyup":tj(Oe,x,$e)}var _t;if(QR)e:{switch(d){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else R0?zB(d,x)&&(At="onCompositionEnd"):d==="keydown"&&x.keyCode===229&&(At="onCompositionStart");At&&(VB&&x.locale!=="ko"&&(R0||At!=="onCompositionStart"?At==="onCompositionEnd"&&R0&&(_t=RB()):(Wd=$e,HR="value"in Wd?Wd.value:Wd.textContent,R0=!0)),ns=IT(_e,At),0<ns.length&&(At=new OB(At,d,null,x,$e),Oe.push({event:At,listeners:ns}),_t?At.data=_t:(_t=UB(x),_t!==null&&(At.data=_t)))),(_t=Nxe?Dxe(d,x):$xe(d,x))&&(At=IT(_e,"onBeforeInput"),0<At.length&&(ns=new OB("onBeforeInput","beforeinput",null,x,$e),Oe.push({event:ns,listeners:At}),ns.data=_t)),Swe(Oe,d,_e,x,$e)}CY(Oe,y)})}function vw(d,y,x){return{instance:d,listener:y,currentTarget:x}}function IT(d,y){for(var x=y+"Capture",C=[];d!==null;){var N=d,$=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||$===null||(N=Ox(d,x),N!=null&&C.unshift(vw(d,N,$)),N=Ox(d,y),N!=null&&C.push(vw(d,N,$))),d.tag===3)return C;d=d.return}return[]}function n1(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function TY(d,y,x,C,N){for(var $=y._reactName,j=[];x!==null&&x!==C;){var J=x,oe=J.alternate,_e=J.stateNode;if(J=J.tag,oe!==null&&oe===C)break;J!==5&&J!==26&&J!==27||_e===null||(oe=_e,N?(_e=Ox(x,$),_e!=null&&j.unshift(vw(x,_e,oe))):N||(_e=Ox(x,$),_e!=null&&j.push(vw(x,_e,oe)))),x=x.return}j.length!==0&&d.push({event:y,listeners:j})}var Twe=/\r\n?/g,Iwe=/\u0000|\uFFFD/g;function IY(d){return(typeof d=="string"?d:""+d).replace(Twe,`
`).replace(Iwe,"")}function MY(d,y){return y=IY(y),IY(d)===y}function MT(){}function li(d,y,x,C,N,$){switch(x){case"children":typeof C=="string"?y==="body"||y==="textarea"&&C===""||N0(d,C):(typeof C=="number"||typeof C=="bigint")&&y!=="body"&&N0(d,""+C);break;case"className":M0(d,"class",C);break;case"tabIndex":M0(d,"tabindex",C);break;case"dir":case"role":case"viewBox":case"width":case"height":M0(d,x,C);break;case"style":NB(d,C,$);break;case"data":if(y!=="object"){M0(d,"data",C);break}case"src":case"href":if(C===""&&(y!=="a"||x!=="href")){d.removeAttribute(x);break}if(C==null||typeof C=="function"||typeof C=="symbol"||typeof C=="boolean"){d.removeAttribute(x);break}C=OP(""+C),d.setAttribute(x,C);break;case"action":case"formAction":if(typeof C=="function"){d.setAttribute(x,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof $=="function"&&(x==="formAction"?(y!=="input"&&li(d,y,"name",N.name,N,null),li(d,y,"formEncType",N.formEncType,N,null),li(d,y,"formMethod",N.formMethod,N,null),li(d,y,"formTarget",N.formTarget,N,null)):(li(d,y,"encType",N.encType,N,null),li(d,y,"method",N.method,N,null),li(d,y,"target",N.target,N,null)));if(C==null||typeof C=="symbol"||typeof C=="boolean"){d.removeAttribute(x);break}C=OP(""+C),d.setAttribute(x,C);break;case"onClick":C!=null&&(d.onclick=MT);break;case"onScroll":C!=null&&us("scroll",d);break;case"onScrollEnd":C!=null&&us("scrollend",d);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(i(61));if(x=C.__html,x!=null){if(N.children!=null)throw Error(i(60));d.innerHTML=x}}break;case"multiple":d.multiple=C&&typeof C!="function"&&typeof C!="symbol";break;case"muted":d.muted=C&&typeof C!="function"&&typeof C!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(C==null||typeof C=="function"||typeof C=="boolean"||typeof C=="symbol"){d.removeAttribute("xlink:href");break}x=OP(""+C),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",x);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":C!=null&&typeof C!="function"&&typeof C!="symbol"?d.setAttribute(x,""+C):d.removeAttribute(x);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":C&&typeof C!="function"&&typeof C!="symbol"?d.setAttribute(x,""):d.removeAttribute(x);break;case"capture":case"download":C===!0?d.setAttribute(x,""):C!==!1&&C!=null&&typeof C!="function"&&typeof C!="symbol"?d.setAttribute(x,C):d.removeAttribute(x);break;case"cols":case"rows":case"size":case"span":C!=null&&typeof C!="function"&&typeof C!="symbol"&&!isNaN(C)&&1<=C?d.setAttribute(x,C):d.removeAttribute(x);break;case"rowSpan":case"start":C==null||typeof C=="function"||typeof C=="symbol"||isNaN(C)?d.removeAttribute(x):d.setAttribute(x,C);break;case"popover":us("beforetoggle",d),us("toggle",d),I0(d,"popover",C);break;case"xlinkActuate":Wu(d,"http://www.w3.org/1999/xlink","xlink:actuate",C);break;case"xlinkArcrole":Wu(d,"http://www.w3.org/1999/xlink","xlink:arcrole",C);break;case"xlinkRole":Wu(d,"http://www.w3.org/1999/xlink","xlink:role",C);break;case"xlinkShow":Wu(d,"http://www.w3.org/1999/xlink","xlink:show",C);break;case"xlinkTitle":Wu(d,"http://www.w3.org/1999/xlink","xlink:title",C);break;case"xlinkType":Wu(d,"http://www.w3.org/1999/xlink","xlink:type",C);break;case"xmlBase":Wu(d,"http://www.w3.org/XML/1998/namespace","xml:base",C);break;case"xmlLang":Wu(d,"http://www.w3.org/XML/1998/namespace","xml:lang",C);break;case"xmlSpace":Wu(d,"http://www.w3.org/XML/1998/namespace","xml:space",C);break;case"is":I0(d,"is",C);break;case"innerText":case"textContent":break;default:(!(2<x.length)||x[0]!=="o"&&x[0]!=="O"||x[1]!=="n"&&x[1]!=="N")&&(x=rxe.get(x)||x,I0(d,x,C))}}function CF(d,y,x,C,N,$){switch(x){case"style":NB(d,C,$);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(i(61));if(x=C.__html,x!=null){if(N.children!=null)throw Error(i(60));d.innerHTML=x}}break;case"children":typeof C=="string"?N0(d,C):(typeof C=="number"||typeof C=="bigint")&&N0(d,""+C);break;case"onScroll":C!=null&&us("scroll",d);break;case"onScrollEnd":C!=null&&us("scrollend",d);break;case"onClick":C!=null&&(d.onclick=MT);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$P.hasOwnProperty(x))e:{if(x[0]==="o"&&x[1]==="n"&&(N=x.endsWith("Capture"),y=x.slice(2,N?x.length-7:void 0),$=d[Ci]||null,$=$!=null?$[x]:null,typeof $=="function"&&d.removeEventListener(y,$,N),typeof C=="function")){typeof $!="function"&&$!==null&&(x in d?d[x]=null:d.hasAttribute(x)&&d.removeAttribute(x)),d.addEventListener(y,C,N);break e}x in d?d[x]=C:C===!0?d.setAttribute(x,""):I0(d,x,C)}}}function Jn(d,y,x){switch(y){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":us("error",d),us("load",d);var C=!1,N=!1,$;for($ in x)if(x.hasOwnProperty($)){var j=x[$];if(j!=null)switch($){case"src":C=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,y));default:li(d,y,$,j,x,null)}}N&&li(d,y,"srcSet",x.srcSet,x,null),C&&li(d,y,"src",x.src,x,null);return;case"input":us("invalid",d);var J=$=j=N=null,oe=null,_e=null;for(C in x)if(x.hasOwnProperty(C)){var $e=x[C];if($e!=null)switch(C){case"name":N=$e;break;case"type":j=$e;break;case"checked":oe=$e;break;case"defaultChecked":_e=$e;break;case"value":$=$e;break;case"defaultValue":J=$e;break;case"children":case"dangerouslySetInnerHTML":if($e!=null)throw Error(i(137,y));break;default:li(d,y,C,$e,x,null)}}TB(d,$,J,oe,_e,j,N,!1),gi(d);return;case"select":us("invalid",d),C=j=$=null;for(N in x)if(x.hasOwnProperty(N)&&(J=x[N],J!=null))switch(N){case"value":$=J;break;case"defaultValue":j=J;break;case"multiple":C=J;default:li(d,y,N,J,x,null)}y=$,x=j,d.multiple=!!C,y!=null?A0(d,!!C,y,!1):x!=null&&A0(d,!!C,x,!0);return;case"textarea":us("invalid",d),$=N=C=null;for(j in x)if(x.hasOwnProperty(j)&&(J=x[j],J!=null))switch(j){case"value":C=J;break;case"defaultValue":N=J;break;case"children":$=J;break;case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(91));break;default:li(d,y,j,J,x,null)}MB(d,C,N,$),gi(d);return;case"option":for(oe in x)if(x.hasOwnProperty(oe)&&(C=x[oe],C!=null))switch(oe){case"selected":d.selected=C&&typeof C!="function"&&typeof C!="symbol";break;default:li(d,y,oe,C,x,null)}return;case"dialog":us("beforetoggle",d),us("toggle",d),us("cancel",d),us("close",d);break;case"iframe":case"object":us("load",d);break;case"video":case"audio":for(C=0;C<_w.length;C++)us(_w[C],d);break;case"image":us("error",d),us("load",d);break;case"details":us("toggle",d);break;case"embed":case"source":case"link":us("error",d),us("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_e in x)if(x.hasOwnProperty(_e)&&(C=x[_e],C!=null))switch(_e){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,y));default:li(d,y,_e,C,x,null)}return;default:if(GR(y)){for($e in x)x.hasOwnProperty($e)&&(C=x[$e],C!==void 0&&CF(d,y,$e,C,x,void 0));return}}for(J in x)x.hasOwnProperty(J)&&(C=x[J],C!=null&&li(d,y,J,C,x,null))}function Mwe(d,y,x,C){switch(y){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,$=null,j=null,J=null,oe=null,_e=null,$e=null;for(we in x){var Oe=x[we];if(x.hasOwnProperty(we)&&Oe!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":oe=Oe;default:C.hasOwnProperty(we)||li(d,y,we,null,C,Oe)}}for(var xe in C){var we=C[xe];if(Oe=x[xe],C.hasOwnProperty(xe)&&(we!=null||Oe!=null))switch(xe){case"type":$=we;break;case"name":N=we;break;case"checked":_e=we;break;case"defaultChecked":$e=we;break;case"value":j=we;break;case"defaultValue":J=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,y));break;default:we!==Oe&&li(d,y,xe,we,C,Oe)}}VR(d,j,J,oe,_e,$e,$,N);return;case"select":we=j=J=xe=null;for($ in x)if(oe=x[$],x.hasOwnProperty($)&&oe!=null)switch($){case"value":break;case"multiple":we=oe;default:C.hasOwnProperty($)||li(d,y,$,null,C,oe)}for(N in C)if($=C[N],oe=x[N],C.hasOwnProperty(N)&&($!=null||oe!=null))switch(N){case"value":xe=$;break;case"defaultValue":J=$;break;case"multiple":j=$;default:$!==oe&&li(d,y,N,$,C,oe)}y=J,x=j,C=we,xe!=null?A0(d,!!x,xe,!1):!!C!=!!x&&(y!=null?A0(d,!!x,y,!0):A0(d,!!x,x?[]:"",!1));return;case"textarea":we=xe=null;for(J in x)if(N=x[J],x.hasOwnProperty(J)&&N!=null&&!C.hasOwnProperty(J))switch(J){case"value":break;case"children":break;default:li(d,y,J,null,C,N)}for(j in C)if(N=C[j],$=x[j],C.hasOwnProperty(j)&&(N!=null||$!=null))switch(j){case"value":xe=N;break;case"defaultValue":we=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:N!==$&&li(d,y,j,N,C,$)}IB(d,xe,we);return;case"option":for(var Dt in x)if(xe=x[Dt],x.hasOwnProperty(Dt)&&xe!=null&&!C.hasOwnProperty(Dt))switch(Dt){case"selected":d.selected=!1;break;default:li(d,y,Dt,null,C,xe)}for(oe in C)if(xe=C[oe],we=x[oe],C.hasOwnProperty(oe)&&xe!==we&&(xe!=null||we!=null))switch(oe){case"selected":d.selected=xe&&typeof xe!="function"&&typeof xe!="symbol";break;default:li(d,y,oe,xe,C,we)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var It in x)xe=x[It],x.hasOwnProperty(It)&&xe!=null&&!C.hasOwnProperty(It)&&li(d,y,It,null,C,xe);for(_e in C)if(xe=C[_e],we=x[_e],C.hasOwnProperty(_e)&&xe!==we&&(xe!=null||we!=null))switch(_e){case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(i(137,y));break;default:li(d,y,_e,xe,C,we)}return;default:if(GR(y)){for(var ui in x)xe=x[ui],x.hasOwnProperty(ui)&&xe!==void 0&&!C.hasOwnProperty(ui)&&CF(d,y,ui,void 0,C,xe);for($e in C)xe=C[$e],we=x[$e],!C.hasOwnProperty($e)||xe===we||xe===void 0&&we===void 0||CF(d,y,$e,xe,C,we);return}}for(var pe in x)xe=x[pe],x.hasOwnProperty(pe)&&xe!=null&&!C.hasOwnProperty(pe)&&li(d,y,pe,null,C,xe);for(Oe in C)xe=C[Oe],we=x[Oe],!C.hasOwnProperty(Oe)||xe===we||xe==null&&we==null||li(d,y,Oe,xe,C,we)}var PF=null,TF=null;function AT(d){return d.nodeType===9?d:d.ownerDocument}function AY(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function NY(d,y){if(d===0)switch(y){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&y==="foreignObject"?0:d}function IF(d,y){return d==="textarea"||d==="noscript"||typeof y.children=="string"||typeof y.children=="number"||typeof y.children=="bigint"||typeof y.dangerouslySetInnerHTML=="object"&&y.dangerouslySetInnerHTML!==null&&y.dangerouslySetInnerHTML.__html!=null}var MF=null;function Awe(){var d=window.event;return d&&d.type==="popstate"?d===MF?!1:(MF=d,!0):(MF=null,!1)}var DY=typeof setTimeout=="function"?setTimeout:void 0,Nwe=typeof clearTimeout=="function"?clearTimeout:void 0,$Y=typeof Promise=="function"?Promise:void 0,Dwe=typeof queueMicrotask=="function"?queueMicrotask:typeof $Y<"u"?function(d){return $Y.resolve(null).then(d).catch($we)}:DY;function $we(d){setTimeout(function(){throw d})}function hp(d){return d==="head"}function RY(d,y){var x=y,C=0,N=0;do{var $=x.nextSibling;if(d.removeChild(x),$&&$.nodeType===8)if(x=$.data,x==="/$"){if(0<C&&8>C){x=C;var j=d.ownerDocument;if(x&1&&bw(j.documentElement),x&2&&bw(j.body),x&4)for(x=j.head,bw(x),j=x.firstChild;j;){var J=j.nextSibling,oe=j.nodeName;j[Tg]||oe==="SCRIPT"||oe==="STYLE"||oe==="LINK"&&j.rel.toLowerCase()==="stylesheet"||x.removeChild(j),j=J}}if(N===0){d.removeChild($),Iw(y);return}N--}else x==="$"||x==="$?"||x==="$!"?N++:C=x.charCodeAt(0)-48;else C=0;x=$}while(x);Iw(y)}function AF(d){var y=d.firstChild;for(y&&y.nodeType===10&&(y=y.nextSibling);y;){var x=y;switch(y=y.nextSibling,x.nodeName){case"HTML":case"HEAD":case"BODY":AF(x),ll(x);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(x.rel.toLowerCase()==="stylesheet")continue}d.removeChild(x)}}function Rwe(d,y,x,C){for(;d.nodeType===1;){var N=x;if(d.nodeName.toLowerCase()!==y.toLowerCase()){if(!C&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(C){if(!d[Tg])switch(y){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if($=d.getAttribute("rel"),$==="stylesheet"&&d.hasAttribute("data-precedence"))break;if($!==N.rel||d.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||d.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||d.getAttribute("title")!==(N.title==null?null:N.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if($=d.getAttribute("src"),($!==(N.src==null?null:N.src)||d.getAttribute("type")!==(N.type==null?null:N.type)||d.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&$&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(y==="input"&&d.type==="hidden"){var $=N.name==null?null:""+N.name;if(N.type==="hidden"&&d.getAttribute("name")===$)return d}else return d;if(d=Ju(d.nextSibling),d===null)break}return null}function kwe(d,y,x){if(y==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!x||(d=Ju(d.nextSibling),d===null))return null;return d}function NF(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState==="complete"}function Fwe(d,y){var x=d.ownerDocument;if(d.data!=="$?"||x.readyState==="complete")y();else{var C=function(){y(),x.removeEventListener("DOMContentLoaded",C)};x.addEventListener("DOMContentLoaded",C),d._reactRetry=C}}function Ju(d){for(;d!=null;d=d.nextSibling){var y=d.nodeType;if(y===1||y===3)break;if(y===8){if(y=d.data,y==="$"||y==="$!"||y==="$?"||y==="F!"||y==="F")break;if(y==="/$")return null}}return d}var DF=null;function kY(d){d=d.previousSibling;for(var y=0;d;){if(d.nodeType===8){var x=d.data;if(x==="$"||x==="$!"||x==="$?"){if(y===0)return d;y--}else x==="/$"&&y++}d=d.previousSibling}return null}function FY(d,y,x){switch(y=AT(x),d){case"html":if(d=y.documentElement,!d)throw Error(i(452));return d;case"head":if(d=y.head,!d)throw Error(i(453));return d;case"body":if(d=y.body,!d)throw Error(i(454));return d;default:throw Error(i(451))}}function bw(d){for(var y=d.attributes;y.length;)d.removeAttributeNode(y[0]);ll(d)}var cu=new Map,OY=new Set;function NT(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var wm=W.d;W.d={f:Owe,r:Lwe,D:Vwe,C:qwe,L:Gwe,m:zwe,X:Bwe,S:Uwe,M:jwe};function Owe(){var d=wm.f(),y=wT();return d||y}function Lwe(d){var y=lm(d);y!==null&&y.tag===5&&y.type==="form"?iH(y):wm.r(d)}var o1=typeof document>"u"?null:document;function LY(d,y,x){var C=o1;if(C&&typeof y=="string"&&y){var N=iu(y);N='link[rel="'+d+'"][href="'+N+'"]',typeof x=="string"&&(N+='[crossorigin="'+x+'"]'),OY.has(N)||(OY.add(N),d={rel:d,crossOrigin:x,href:y},C.querySelector(N)===null&&(y=C.createElement("link"),Jn(y,"link",d),Ir(y),C.head.appendChild(y)))}}function Vwe(d){wm.D(d),LY("dns-prefetch",d,null)}function qwe(d,y){wm.C(d,y),LY("preconnect",d,y)}function Gwe(d,y,x){wm.L(d,y,x);var C=o1;if(C&&d&&y){var N='link[rel="preload"][as="'+iu(y)+'"]';y==="image"&&x&&x.imageSrcSet?(N+='[imagesrcset="'+iu(x.imageSrcSet)+'"]',typeof x.imageSizes=="string"&&(N+='[imagesizes="'+iu(x.imageSizes)+'"]')):N+='[href="'+iu(d)+'"]';var $=N;switch(y){case"style":$=a1(d);break;case"script":$=l1(d)}cu.has($)||(d=c({rel:"preload",href:y==="image"&&x&&x.imageSrcSet?void 0:d,as:y},x),cu.set($,d),C.querySelector(N)!==null||y==="style"&&C.querySelector(xw($))||y==="script"&&C.querySelector(ww($))||(y=C.createElement("link"),Jn(y,"link",d),Ir(y),C.head.appendChild(y)))}}function zwe(d,y){wm.m(d,y);var x=o1;if(x&&d){var C=y&&typeof y.as=="string"?y.as:"script",N='link[rel="modulepreload"][as="'+iu(C)+'"][href="'+iu(d)+'"]',$=N;switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":$=l1(d)}if(!cu.has($)&&(d=c({rel:"modulepreload",href:d},y),cu.set($,d),x.querySelector(N)===null)){switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(x.querySelector(ww($)))return}C=x.createElement("link"),Jn(C,"link",d),Ir(C),x.head.appendChild(C)}}}function Uwe(d,y,x){wm.S(d,y,x);var C=o1;if(C&&d){var N=Yd(C).hoistableStyles,$=a1(d);y=y||"default";var j=N.get($);if(!j){var J={loading:0,preload:null};if(j=C.querySelector(xw($)))J.loading=5;else{d=c({rel:"stylesheet",href:d,"data-precedence":y},x),(x=cu.get($))&&$F(d,x);var oe=j=C.createElement("link");Ir(oe),Jn(oe,"link",d),oe._p=new Promise(function(_e,$e){oe.onload=_e,oe.onerror=$e}),oe.addEventListener("load",function(){J.loading|=1}),oe.addEventListener("error",function(){J.loading|=2}),J.loading|=4,DT(j,y,C)}j={type:"stylesheet",instance:j,count:1,state:J},N.set($,j)}}}function Bwe(d,y){wm.X(d,y);var x=o1;if(x&&d){var C=Yd(x).hoistableScripts,N=l1(d),$=C.get(N);$||($=x.querySelector(ww(N)),$||(d=c({src:d,async:!0},y),(y=cu.get(N))&&RF(d,y),$=x.createElement("script"),Ir($),Jn($,"link",d),x.head.appendChild($)),$={type:"script",instance:$,count:1,state:null},C.set(N,$))}}function jwe(d,y){wm.M(d,y);var x=o1;if(x&&d){var C=Yd(x).hoistableScripts,N=l1(d),$=C.get(N);$||($=x.querySelector(ww(N)),$||(d=c({src:d,async:!0,type:"module"},y),(y=cu.get(N))&&RF(d,y),$=x.createElement("script"),Ir($),Jn($,"link",d),x.head.appendChild($)),$={type:"script",instance:$,count:1,state:null},C.set(N,$))}}function VY(d,y,x,C){var N=(N=Ve.current)?NT(N):null;if(!N)throw Error(i(446));switch(d){case"meta":case"title":return null;case"style":return typeof x.precedence=="string"&&typeof x.href=="string"?(y=a1(x.href),x=Yd(N).hoistableStyles,C=x.get(y),C||(C={type:"style",instance:null,count:0,state:null},x.set(y,C)),C):{type:"void",instance:null,count:0,state:null};case"link":if(x.rel==="stylesheet"&&typeof x.href=="string"&&typeof x.precedence=="string"){d=a1(x.href);var $=Yd(N).hoistableStyles,j=$.get(d);if(j||(N=N.ownerDocument||N,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},$.set(d,j),($=N.querySelector(xw(d)))&&!$._p&&(j.instance=$,j.state.loading=5),cu.has(d)||(x={rel:"preload",as:"style",href:x.href,crossOrigin:x.crossOrigin,integrity:x.integrity,media:x.media,hrefLang:x.hrefLang,referrerPolicy:x.referrerPolicy},cu.set(d,x),$||Hwe(N,d,x,j.state))),y&&C===null)throw Error(i(528,""));return j}if(y&&C!==null)throw Error(i(529,""));return null;case"script":return y=x.async,x=x.src,typeof x=="string"&&y&&typeof y!="function"&&typeof y!="symbol"?(y=l1(x),x=Yd(N).hoistableScripts,C=x.get(y),C||(C={type:"script",instance:null,count:0,state:null},x.set(y,C)),C):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,d))}}function a1(d){return'href="'+iu(d)+'"'}function xw(d){return'link[rel="stylesheet"]['+d+"]"}function qY(d){return c({},d,{"data-precedence":d.precedence,precedence:null})}function Hwe(d,y,x,C){d.querySelector('link[rel="preload"][as="style"]['+y+"]")?C.loading=1:(y=d.createElement("link"),C.preload=y,y.addEventListener("load",function(){return C.loading|=1}),y.addEventListener("error",function(){return C.loading|=2}),Jn(y,"link",x),Ir(y),d.head.appendChild(y))}function l1(d){return'[src="'+iu(d)+'"]'}function ww(d){return"script[async]"+d}function GY(d,y,x){if(y.count++,y.instance===null)switch(y.type){case"style":var C=d.querySelector('style[data-href~="'+iu(x.href)+'"]');if(C)return y.instance=C,Ir(C),C;var N=c({},x,{"data-href":x.href,"data-precedence":x.precedence,href:null,precedence:null});return C=(d.ownerDocument||d).createElement("style"),Ir(C),Jn(C,"style",N),DT(C,x.precedence,d),y.instance=C;case"stylesheet":N=a1(x.href);var $=d.querySelector(xw(N));if($)return y.state.loading|=4,y.instance=$,Ir($),$;C=qY(x),(N=cu.get(N))&&$F(C,N),$=(d.ownerDocument||d).createElement("link"),Ir($);var j=$;return j._p=new Promise(function(J,oe){j.onload=J,j.onerror=oe}),Jn($,"link",C),y.state.loading|=4,DT($,x.precedence,d),y.instance=$;case"script":return $=l1(x.src),(N=d.querySelector(ww($)))?(y.instance=N,Ir(N),N):(C=x,(N=cu.get($))&&(C=c({},x),RF(C,N)),d=d.ownerDocument||d,N=d.createElement("script"),Ir(N),Jn(N,"link",C),d.head.appendChild(N),y.instance=N);case"void":return null;default:throw Error(i(443,y.type))}else y.type==="stylesheet"&&(y.state.loading&4)===0&&(C=y.instance,y.state.loading|=4,DT(C,x.precedence,d));return y.instance}function DT(d,y,x){for(var C=x.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=C.length?C[C.length-1]:null,$=N,j=0;j<C.length;j++){var J=C[j];if(J.dataset.precedence===y)$=J;else if($!==N)break}$?$.parentNode.insertBefore(d,$.nextSibling):(y=x.nodeType===9?x.head:x,y.insertBefore(d,y.firstChild))}function $F(d,y){d.crossOrigin==null&&(d.crossOrigin=y.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=y.referrerPolicy),d.title==null&&(d.title=y.title)}function RF(d,y){d.crossOrigin==null&&(d.crossOrigin=y.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=y.referrerPolicy),d.integrity==null&&(d.integrity=y.integrity)}var $T=null;function zY(d,y,x){if($T===null){var C=new Map,N=$T=new Map;N.set(x,C)}else N=$T,C=N.get(x),C||(C=new Map,N.set(x,C));if(C.has(d))return C;for(C.set(d,null),x=x.getElementsByTagName(d),N=0;N<x.length;N++){var $=x[N];if(!($[Tg]||$[sr]||d==="link"&&$.getAttribute("rel")==="stylesheet")&&$.namespaceURI!=="http://www.w3.org/2000/svg"){var j=$.getAttribute(y)||"";j=d+j;var J=C.get(j);J?J.push($):C.set(j,[$])}}return C}function UY(d,y,x){d=d.ownerDocument||d,d.head.insertBefore(x,y==="title"?d.querySelector("head > title"):null)}function Ywe(d,y,x){if(x===1||y.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof y.precedence!="string"||typeof y.href!="string"||y.href==="")break;return!0;case"link":if(typeof y.rel!="string"||typeof y.href!="string"||y.href===""||y.onLoad||y.onError)break;switch(y.rel){case"stylesheet":return d=y.disabled,typeof y.precedence=="string"&&d==null;default:return!0}case"script":if(y.async&&typeof y.async!="function"&&typeof y.async!="symbol"&&!y.onLoad&&!y.onError&&y.src&&typeof y.src=="string")return!0}return!1}function BY(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}var Sw=null;function Xwe(){}function Wwe(d,y,x){if(Sw===null)throw Error(i(475));var C=Sw;if(y.type==="stylesheet"&&(typeof x.media!="string"||matchMedia(x.media).matches!==!1)&&(y.state.loading&4)===0){if(y.instance===null){var N=a1(x.href),$=d.querySelector(xw(N));if($){d=$._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(C.count++,C=RT.bind(C),d.then(C,C)),y.state.loading|=4,y.instance=$,Ir($);return}$=d.ownerDocument||d,x=qY(x),(N=cu.get(N))&&$F(x,N),$=$.createElement("link"),Ir($);var j=$;j._p=new Promise(function(J,oe){j.onload=J,j.onerror=oe}),Jn($,"link",x),y.instance=$}C.stylesheets===null&&(C.stylesheets=new Map),C.stylesheets.set(y,d),(d=y.state.preload)&&(y.state.loading&3)===0&&(C.count++,y=RT.bind(C),d.addEventListener("load",y),d.addEventListener("error",y))}}function Zwe(){if(Sw===null)throw Error(i(475));var d=Sw;return d.stylesheets&&d.count===0&&kF(d,d.stylesheets),0<d.count?function(y){var x=setTimeout(function(){if(d.stylesheets&&kF(d,d.stylesheets),d.unsuspend){var C=d.unsuspend;d.unsuspend=null,C()}},6e4);return d.unsuspend=y,function(){d.unsuspend=null,clearTimeout(x)}}:null}function RT(){if(this.count--,this.count===0){if(this.stylesheets)kF(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var kT=null;function kF(d,y){d.stylesheets=null,d.unsuspend!==null&&(d.count++,kT=new Map,y.forEach(Qwe,d),kT=null,RT.call(d))}function Qwe(d,y){if(!(y.state.loading&4)){var x=kT.get(d);if(x)var C=x.get(null);else{x=new Map,kT.set(d,x);for(var N=d.querySelectorAll("link[data-precedence],style[data-precedence]"),$=0;$<N.length;$++){var j=N[$];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(x.set(j.dataset.precedence,j),C=j)}C&&x.set(null,C)}N=y.instance,j=N.getAttribute("data-precedence"),$=x.get(j)||C,$===C&&x.set(null,N),x.set(j,N),this.count++,C=RT.bind(this),N.addEventListener("load",C),N.addEventListener("error",C),$?$.parentNode.insertBefore(N,$.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(N,d.firstChild)),y.state.loading|=4}}var Ew={$$typeof:T,Provider:null,Consumer:null,_currentValue:ie,_currentValue2:ie,_threadCount:0};function Jwe(d,y,x,C,N,$,j,J){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ax(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ax(0),this.hiddenUpdates=Ax(null),this.identifierPrefix=C,this.onUncaughtError=N,this.onCaughtError=$,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=J,this.incompleteTransitions=new Map}function jY(d,y,x,C,N,$,j,J,oe,_e,$e,Oe){return d=new Jwe(d,y,x,j,J,oe,_e,Oe),y=1,$===!0&&(y|=24),$=cl(3,null,null,y),d.current=$,$.stateNode=d,y=gk(),y.refCount++,d.pooledCache=y,y.refCount++,$.memoizedState={element:C,isDehydrated:x,cache:y},bk($),d}function HY(d){return d?(d=V0,d):V0}function YY(d,y,x,C,N,$){N=HY(N),C.context===null?C.context=N:C.pendingContext=N,C=Jd(y),C.payload={element:x},$=$===void 0?null:$,$!==null&&(C.callback=$),x=Kd(d,C,y),x!==null&&(fl(x,d,y),ew(x,d,y))}function XY(d,y){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var x=d.retryLane;d.retryLane=x!==0&&x<y?x:y}}function FF(d,y){XY(d,y),(d=d.alternate)&&XY(d,y)}function WY(d){if(d.tag===13){var y=L0(d,67108864);y!==null&&fl(y,d,67108864),FF(d,67108864)}}var FT=!0;function Kwe(d,y,x,C){var N=H.T;H.T=null;var $=W.p;try{W.p=2,OF(d,y,x,C)}finally{W.p=$,H.T=N}}function e2e(d,y,x,C){var N=H.T;H.T=null;var $=W.p;try{W.p=8,OF(d,y,x,C)}finally{W.p=$,H.T=N}}function OF(d,y,x,C){if(FT){var N=LF(C);if(N===null)EF(d,y,C,OT,x),QY(d,C);else if(s2e(N,d,y,x,C))C.stopPropagation();else if(QY(d,C),y&4&&-1<t2e.indexOf(d)){for(;N!==null;){var $=lm(N);if($!==null)switch($.tag){case 3:if($=$.stateNode,$.current.memoizedState.isDehydrated){var j=Pn($.pendingLanes);if(j!==0){var J=$;for(J.pendingLanes|=2,J.entangledLanes|=2;j;){var oe=1<<31-Cs(j);J.entanglements[1]|=oe,j&=~oe}lh($),(ti&6)===0&&(bT=De()+500,yw(0))}}break;case 13:J=L0($,2),J!==null&&fl(J,$,2),wT(),FF($,2)}if($=LF(C),$===null&&EF(d,y,C,OT,x),$===N)break;N=$}N!==null&&C.stopPropagation()}else EF(d,y,C,null,x)}}function LF(d){return d=UR(d),VF(d)}var OT=null;function VF(d){if(OT=null,d=am(d),d!==null){var y=n(d);if(y===null)d=null;else{var x=y.tag;if(x===13){if(d=o(y),d!==null)return d;d=null}else if(x===3){if(y.stateNode.current.memoizedState.isDehydrated)return y.tag===3?y.stateNode.containerInfo:null;d=null}else y!==d&&(d=null)}}return OT=d,null}function ZY(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ks()){case Pr:return 2;case Ui:return 8;case tr:case Ho:return 32;case Ai:return 268435456;default:return 32}default:return 32}}var qF=!1,mp=null,dp=null,pp=null,Cw=new Map,Pw=new Map,fp=[],t2e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function QY(d,y){switch(d){case"focusin":case"focusout":mp=null;break;case"dragenter":case"dragleave":dp=null;break;case"mouseover":case"mouseout":pp=null;break;case"pointerover":case"pointerout":Cw.delete(y.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pw.delete(y.pointerId)}}function Tw(d,y,x,C,N,$){return d===null||d.nativeEvent!==$?(d={blockedOn:y,domEventName:x,eventSystemFlags:C,nativeEvent:$,targetContainers:[N]},y!==null&&(y=lm(y),y!==null&&WY(y)),d):(d.eventSystemFlags|=C,y=d.targetContainers,N!==null&&y.indexOf(N)===-1&&y.push(N),d)}function s2e(d,y,x,C,N){switch(y){case"focusin":return mp=Tw(mp,d,y,x,C,N),!0;case"dragenter":return dp=Tw(dp,d,y,x,C,N),!0;case"mouseover":return pp=Tw(pp,d,y,x,C,N),!0;case"pointerover":var $=N.pointerId;return Cw.set($,Tw(Cw.get($)||null,d,y,x,C,N)),!0;case"gotpointercapture":return $=N.pointerId,Pw.set($,Tw(Pw.get($)||null,d,y,x,C,N)),!0}return!1}function JY(d){var y=am(d.target);if(y!==null){var x=n(y);if(x!==null){if(y=x.tag,y===13){if(y=o(x),y!==null){d.blockedOn=y,Se(d.priority,function(){if(x.tag===13){var C=pl();C=Nx(C);var N=L0(x,C);N!==null&&fl(N,x,C),FF(x,C)}});return}}else if(y===3&&x.stateNode.current.memoizedState.isDehydrated){d.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}d.blockedOn=null}function LT(d){if(d.blockedOn!==null)return!1;for(var y=d.targetContainers;0<y.length;){var x=LF(d.nativeEvent);if(x===null){x=d.nativeEvent;var C=new x.constructor(x.type,x);zR=C,x.target.dispatchEvent(C),zR=null}else return y=lm(x),y!==null&&WY(y),d.blockedOn=x,!1;y.shift()}return!0}function KY(d,y,x){LT(d)&&x.delete(y)}function i2e(){qF=!1,mp!==null&&LT(mp)&&(mp=null),dp!==null&&LT(dp)&&(dp=null),pp!==null&&LT(pp)&&(pp=null),Cw.forEach(KY),Pw.forEach(KY)}function VT(d,y){d.blockedOn===y&&(d.blockedOn=null,qF||(qF=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,i2e)))}var qT=null;function eX(d){qT!==d&&(qT=d,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){qT===d&&(qT=null);for(var y=0;y<d.length;y+=3){var x=d[y],C=d[y+1],N=d[y+2];if(typeof C!="function"){if(VF(C||x)===null)continue;break}var $=lm(x);$!==null&&(d.splice(y,3),y-=3,Vk($,{pending:!0,data:N,method:x.method,action:C},C,N))}}))}function Iw(d){function y(oe){return VT(oe,d)}mp!==null&&VT(mp,d),dp!==null&&VT(dp,d),pp!==null&&VT(pp,d),Cw.forEach(y),Pw.forEach(y);for(var x=0;x<fp.length;x++){var C=fp[x];C.blockedOn===d&&(C.blockedOn=null)}for(;0<fp.length&&(x=fp[0],x.blockedOn===null);)JY(x),x.blockedOn===null&&fp.shift();if(x=(d.ownerDocument||d).$$reactFormReplay,x!=null)for(C=0;C<x.length;C+=3){var N=x[C],$=x[C+1],j=N[Ci]||null;if(typeof $=="function")j||eX(x);else if(j){var J=null;if($&&$.hasAttribute("formAction")){if(N=$,j=$[Ci]||null)J=j.formAction;else if(VF(N)!==null)continue}else J=j.action;typeof J=="function"?x[C+1]=J:(x.splice(C,3),C-=3),eX(x)}}}function GF(d){this._internalRoot=d}GT.prototype.render=GF.prototype.render=function(d){var y=this._internalRoot;if(y===null)throw Error(i(409));var x=y.current,C=pl();YY(x,C,d,y,null,null)},GT.prototype.unmount=GF.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var y=d.containerInfo;YY(d.current,2,null,d,null,null),wT(),y[Yu]=null}};function GT(d){this._internalRoot=d}GT.prototype.unstable_scheduleHydration=function(d){if(d){var y=NP();d={blockedOn:null,target:d,priority:y};for(var x=0;x<fp.length&&y!==0&&y<fp[x].priority;x++);fp.splice(x,0,d),x===0&&JY(d)}};var tX=e.version;if(tX!=="19.1.0")throw Error(i(527,tX,"19.1.0"));W.findDOMNode=function(d){var y=d._reactInternals;if(y===void 0)throw typeof d.render=="function"?Error(i(188)):(d=Object.keys(d).join(","),Error(i(268,d)));return d=l(y),d=d!==null?u(d):null,d=d===null?null:d.stateNode,d};var r2e={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zT=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zT.isDisabled&&zT.supportsFiber)try{mr=zT.inject(r2e),Si=zT}catch{}}return Aw.createRoot=function(d,y){if(!r(d))throw Error(i(299));var x=!1,C="",N=yH,$=_H,j=vH,J=null;return y!=null&&(y.unstable_strictMode===!0&&(x=!0),y.identifierPrefix!==void 0&&(C=y.identifierPrefix),y.onUncaughtError!==void 0&&(N=y.onUncaughtError),y.onCaughtError!==void 0&&($=y.onCaughtError),y.onRecoverableError!==void 0&&(j=y.onRecoverableError),y.unstable_transitionCallbacks!==void 0&&(J=y.unstable_transitionCallbacks)),y=jY(d,1,!1,null,null,x,C,N,$,j,J,null),d[Yu]=y.current,SF(d),new GF(y)},Aw.hydrateRoot=function(d,y,x){if(!r(d))throw Error(i(299));var C=!1,N="",$=yH,j=_H,J=vH,oe=null,_e=null;return x!=null&&(x.unstable_strictMode===!0&&(C=!0),x.identifierPrefix!==void 0&&(N=x.identifierPrefix),x.onUncaughtError!==void 0&&($=x.onUncaughtError),x.onCaughtError!==void 0&&(j=x.onCaughtError),x.onRecoverableError!==void 0&&(J=x.onRecoverableError),x.unstable_transitionCallbacks!==void 0&&(oe=x.unstable_transitionCallbacks),x.formState!==void 0&&(_e=x.formState)),y=jY(d,1,!0,y,x??null,C,N,$,j,J,oe,_e),y.context=HY(null),x=y.current,C=pl(),C=Nx(C),N=Jd(C),N.callback=null,Kd(x,N,C),x=C,y.current.lanes=x,Pg(y,x),lh(y),d[Yu]=y.current,SF(d),new GT(y)},Aw.version="19.1.0",Aw}var hX;function g2e(){if(hX)return BF.exports;hX=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),BF.exports=f2e(),BF.exports}var SD=g2e();/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const y2e=new Set(["children","localName","ref","style","className"]),mX=new WeakMap,dX=(t,e,s,i,r)=>{const n=r==null?void 0:r[e];n===void 0?(t[e]=s,s==null&&e in HTMLElement.prototype&&t.removeAttribute(e)):s!==i&&((o,a,l)=>{let u=mX.get(o);u===void 0&&mX.set(o,u=new Map);let c=u.get(a);l!==void 0?c===void 0?(u.set(a,c={handleEvent:l}),o.addEventListener(a,c)):c.handleEvent=l:c!==void 0&&(u.delete(a),o.removeEventListener(a,c))})(t,n,s)},_2e=({react:t,tagName:e,elementClass:s,events:i,displayName:r})=>{const n=new Set(Object.keys(i??{})),o=t.forwardRef((a,l)=>{const u=t.useRef(new Map),c=t.useRef(null),h={},m={};for(const[f,g]of Object.entries(a))y2e.has(f)?h[f==="className"?"class":f]=g:n.has(f)||f in s.prototype?m[f]=g:h[f]=g;return t.useLayoutEffect(()=>{if(c.current===null)return;const f=new Map;for(const g in m)dX(c.current,g,a[g],u.current.get(g),i),u.current.delete(g),f.set(g,a[g]);for(const[g,v]of u.current)dX(c.current,g,void 0,v,i);u.current=f}),t.useLayoutEffect(()=>{var f;(f=c.current)==null||f.removeAttribute("defer-hydration")},[]),h.suppressHydrationWarning=!0,t.createElement(e,{...h,ref:t.useCallback(f=>{c.current=f,typeof l=="function"?l(f):l!==null&&(l.current=f)},[l])})});return o.displayName=r??s.name,o};var v2e=":",R_=class{resolve(t){}reject(t){}constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}};function b2e(t,e){let s=t;for(;s;){if(s===e)return!0;if(!s.parentNode)return!1;s.parentNode instanceof ShadowRoot?s=s.parentNode.host:s=s.parentNode}return!1}function x2e(t,e,s){const{subscribe:i}=w2e(e);return i(r=>{r.some(o=>b2e(t,o.target))&&s()})}var XF={};function w2e(t){const e=t.join(","),s=XF[e];if(s!==void 0)return s;const i=new Set,r=new MutationObserver(o=>i.forEach(a=>a(o)));globalThis.document&&r.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const n={subscribe(o){return i.add(o),()=>{i.delete(o),i.size===0&&(r.disconnect(),XF[e]=void 0)}}};return XF[e]=n,n}function S2e(t,e){var i,r;let s=t;for(;s;){const n=(i=s.closest)==null?void 0:i.call(s,e);if(n)return n;const o=(r=s.getRootNode)==null?void 0:r.call(s);if(o===globalThis.document)return null;s=o.host}return null}function E2e(t,e,s){const i=S2e(t,`[${e}]`);return(i==null?void 0:i.getAttribute(e))??s}function Xi(t,e,...s){try{return t==null?void 0:t.call(e,...s)}catch(i){console.error(i,t)}}async function $L(t,e,...s){try{const i=t==null?void 0:t.call(e,...s);return i instanceof Promise?await i:i}catch(i){console.error(i,t)}}var C2e=["ar","bg","bs","ca","cs","da","de","el","en","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nl","nb","no","pl","pt-BR","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"],P2e=new Set(C2e),fN="en",T2e={pt:"pt-PT",nb:"no",zh:"zh-CN"};async function I2e(t,e,s=""){const i=`${e}/${s}`,r=`${i}${t}.json`;return WF[r]??(WF[r]=Xne(t,i)),await WF[r]}var WF={};async function Xne(t,e){const s=`${e}${t}.json`;try{const i=await fetch(s);if(i.ok)return await i.json()}catch(i){return console.error(i),{}}return t===fN?{}:await Xne(fN,e)}function Wne(t){var s;const e=E2e(t,"lang",((s=globalThis.navigator)==null?void 0:s.language)||fN);return{lang:e,t9nLocale:Zne(e)}}function Zne(t){const[e,s]=t.split("-"),i=e.toLowerCase();let r=i;return s&&(r=`${i}-${s.toUpperCase()}`),r=T2e[r]??r,P2e.has(r)?r:s?Zne(i):fN}function M2e(t,e,s,i){let r;const n=()=>void A2e(t,e(),i).then(o=>{((r==null?void 0:r.lang)!==o.lang||r.t9nLocale!==o.t9nLocale||r.t9nStrings!==o.t9nStrings)&&s(o),r=o}).catch(console.error);return queueMicrotask(n),x2e(t,["lang"],n)}async function A2e(t,e,s=t.tagName.toLowerCase().split("-").slice(1).join("-")){const{lang:i,t9nLocale:r}=Wne(t),n=`${e}/${s}/t9n`,a=s===null?{}:await I2e(r,n,"messages.");return{lang:i,t9nLocale:r,t9nStrings:a}}var Qne=t=>t.replace(N2e,(e,s)=>`${s===0?"":"-"}${e.toLowerCase()}`),N2e=/[A-Z]+(?![a-z])|[A-Z]/gu;function D2e(t,e){const s=e/$2e;let i=0;const r=setInterval(()=>{i+=s,i>=e&&(clearInterval(r),t())},s);return r}var $2e=4;function R2e(t){return t!==void 0}function Jne(t){var s,i;let e=t;for(;e=e.parentNode??e.host;)if((s=e==null?void 0:e.constructor)!=null&&s.lumina){const r=e;return(i=r.manager)!=null&&i.loadedCalled||r._offspring.push(t),r._postLoad.promise}return!1}var PM=Object.defineProperty;function k2e(t){const e=t.split(v2e);return e.length===1?[e[0],Qne(e[0])]:e}var F2e=globalThis.HTMLElement??k2e,db;db=class extends F2e{constructor(){super(),this._store={},this._pendingAttributes=[],this._postLoad=new R_,this._postLoaded=new R_,this._offspring=[],this._saveInstanceProperties();const e=this.constructor;e._LitConstructor?this._initializeComponent({a:e._LitConstructor}):e._loadPromise.then(this._initializeComponent.bind(this)).catch(s=>{this._postLoaded.reject(s),setTimeout(()=>{throw s})})}static _initializePrototype(){var e,s,i;(e=this._properties)==null||e.forEach(this._bindProp,this),(s=this._asyncMethods)==null||s.forEach(this._bindAsync,this),(i=this._syncMethods)==null||i.forEach(this._bindSync,this)}static _bindProp(e){PM(this.prototype,e,{configurable:!0,enumerable:!0,get(){return this._store[e]},set(s){this._store[e]=s}})}static _bindAsync(e){PM(this.prototype,e,{async value(...s){return this._litElement||await this._postLoaded.promise,await this._litElement[e](...s)},configurable:!0})}static _bindSync(e){PM(this.prototype,e,{value(...s){return this._litElement[e](...s)},configurable:!0})}get manager(){var e;return(e=this._litElement)==null?void 0:e.manager}_saveInstanceProperties(){var i;const e=this.constructor,s=this;(i=e._properties)==null||i.forEach(r=>{Object.hasOwn(this,r)&&(this._store[r]=s[r],delete s[r])})}attributeChangedCallback(e,s,i){var r;(r=this._litElement)==null||r.attributeChangedCallback(e,s,i),this._litElement||this._pendingAttributes.push(e)}connectedCallback(){var e,s;this._litElement?(s=(e=this._litElement).connectedCallback)==null||s.call(e):queueMicrotask(()=>{this._ancestorLoad=Jne(this)})}disconnectedCallback(){var e,s;(s=(e=this._litElement)==null?void 0:e.disconnectedCallback)==null||s.call(e)}async componentOnReady(){return await this._postLoaded.promise,this}_initializeComponent(e){var h;const s=this.constructor,i=s._name,r=this._store,n=Object.values(e).find(m=>m.tagName===i),o=`${i}--lazy`;let a=n;for(;a&&!Object.hasOwn(a,"lumina");)a=Object.getPrototypeOf(a);L2e(a),!s._LitConstructor&&(s._LitConstructor=n,customElements.define(o,n)),n.lazy=this;const u=document.createElement(o);n.lazy=void 0,this._litElement=u,this._store=u,this._pendingAttributes.forEach(m=>{const f=this.getAttribute(m);u.attributeChangedCallback(m,null,f)}),Object.entries(r).forEach(O2e,u);const c=this.isConnected;(c||this._ancestorLoad)&&((h=u.connectedCallback)==null||h.call(u),c||u.disconnectedCallback())}addController(){}requestUpdate(){var e;(e=this._litElement)==null||e.requestUpdate()}},db.lumina=!0;function O2e([t,e]){this[t]=e}function L2e(t){const e=t.prototype,s=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(r,n){s.setAttribute.call(this.el,r,n)},e.removeAttribute=function(r){s.removeAttribute.call(this.el,r)},PM(e,"isConnected",{get(){return Reflect.get(s,"isConnected",this.el)}}))}var pX={};function V2e(t,e){var s;if(e){const i=t.constructor.elementProperties;t.manager.internals.members=Object.fromEntries(Array.from(i,([r,n])=>n.noAccessor?void 0:[r,[(n.readOnly?2048:0)|(n.state?32:16)]]).filter(R2e))}else{const i=t.constructor,r=((s=i.__registerControllers)==null?void 0:s.call(i,t))??void 0;if(i.__registerControllers=void 0,typeof r!="object")throw new Error("Failed to retrieve component meta");t.manager.internals.members=Object.fromEntries(Object.entries(r).filter(([n,[o]])=>(o&63)!==0))}}function q2e(t,e=8){return t==null||typeof t=="object"||typeof t=="function"?t:(e&4)!==0?t==="false"?!1:t===""||!!t:(e&2)!==0?Number.parseFloat(t):(e&1)!==0?String(t):t}var G2e=(t,e)=>{var s,i;return(i=(s=t.manager.internals.members)==null?void 0:s[e])==null?void 0:i[0]},QG=Symbol.for("controller"),z2e=t=>typeof t=="object"&&t!==null&&(QG in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),p2;function Cv(t){p2!==t&&(p2=t,queueMicrotask(()=>{p2===t&&(p2=void 0)}))}function ED(t){return p2}var ny=[];function Kne(t){if(t===void 0){ny=[];return}const e=ny.indexOf(t);ny=e===-1?[...ny,t]:ny.slice(0,e+1),queueMicrotask(()=>{ny=[]})}function eoe(){return ny}var Pv;function U2e(t){Pv!==t&&(Pv=t,queueMicrotask(()=>{Pv===t&&(Pv=void 0)}))}function B2e(){const t=Pv;return Pv=void 0,t}var j2e=async(t,e)=>{const s=JG(t);if(s===void 0)return t;if(await s.ready,typeof e=="function"){const i=s.watchExports(r=>e(r,i))}return s.exports},H2e=async t=>{const e=JG(t);return await e.ready,e},JG=t=>{const s=ED().manager.internals.resolveExports(t);if(s!==void 0)return s;if(z2e(t))return t;const i=B2e();if(i!==void 0)return i},RL={readOnly:!1},gN=new WeakMap,toe;toe=QG;var KG=class{constructor(t){this._callbacks={hostConnected:[],hostDisconnected:[],hostLoad:[],hostLoaded:[],hostUpdate:[],hostUpdated:[],hostDestroy:[],hostLifecycle:[]},this._ready=new R_,this._lifecycleCleanups=[],this.connectedCalled=!1,this._loadCalled=!1,this.loadedCalled=!1,this[toe]=!0,this.ready=this._ready.promise,this._exports=gX(this),this._exportWatchers=new Set;const e=t??ED();this.component=e,this.component.addController(this),this.component.manager===void 0||(Kne(this),queueMicrotask(()=>this.catchUpLifecycle()))}catchUpLifecycle(){const{manager:t}=this.component;t.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),t._loadCalled&&this.triggerLoad().then(()=>{t.loadedCalled&&this.triggerLoaded()}).catch(console.error)}get exports(){return this._exports}set exports(t){const e=this._exports;e!==t&&(this._exports=t,this._exportWatchers.forEach(Xi),this.connectedCalled&&this.assignedProperty!==!1&&this.component.requestUpdate(this.assignedProperty,e)),this._ready.resolve(t)}setProvisionalExports(t,e=!0){this._exports=e?gX(t):t,this._exportWatchers.forEach(Xi)}watchExports(t){const e=()=>t(this._exports);return this._exportWatchers.add(e),()=>void this._exportWatchers.delete(e)}get use(){return Cv(this.component),j2e}get useRef(){return Cv(this.component),H2e}get useRefSync(){return Cv(this.component),JG}controllerRemoved(){this.component.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(t){this._callbacks.hostConnected.push(t)}onDisconnected(t){this._callbacks.hostDisconnected.push(t)}onLoad(t){this._callbacks.hostLoad.push(t)}onLoaded(t){this._callbacks.hostLoaded.push(t)}onUpdate(t){this._callbacks.hostUpdate.push(t)}onUpdated(t){this._callbacks.hostUpdated.push(t)}onDestroy(t){this._callbacks.hostDestroy.push(t)}onLifecycle(t){this._callbacks.hostLifecycle.push(t),this.connectedCalled&&this.component.el.isConnected&&this._callLifecycle(t)}triggerConnected(){const t=this;t.hostConnected&&Xi(t.hostConnected,t),this._callbacks.hostConnected.forEach(Xi),this.triggerLifecycle(),this.connectedCalled=!0}triggerDisconnected(){const t=this;t.hostDisconnected&&Xi(t.hostDisconnected,t),this._callbacks.hostDisconnected.forEach(Xi),this._lifecycleCleanups.forEach(Xi),this._lifecycleCleanups=[]}async triggerLoad(){if(this._loadCalled)return;this._loadCalled=!0;const t=this;t.hostLoad&&await $L(t.hostLoad,t),this._callbacks.hostLoad.length>0&&await Promise.allSettled(this._callbacks.hostLoad.map($L)),this._ready.resolve(this._exports)}triggerLoaded(){if(this.loadedCalled)return;const t=this;t.hostLoaded&&Xi(t.hostLoaded,t),this._callbacks.hostLoaded.forEach(Xi),this.loadedCalled=!0}triggerUpdate(t){const e=this;e.hostUpdate&&Xi(e.hostUpdate,e,t),this._callbacks.hostUpdate.forEach(fX,t)}triggerUpdated(t){const e=this;e.hostUpdated&&Xi(e.hostUpdated,e,t),this._callbacks.hostUpdated.forEach(fX,t)}triggerDestroy(){const t=this;t.hostDestroy&&Xi(t.hostDestroy,t),this._callbacks.hostDestroy.forEach(Xi)}triggerLifecycle(){const t=this;t.hostLifecycle&&this._callLifecycle(()=>t.hostLifecycle()),this._callbacks.hostLifecycle.forEach(this._callLifecycle,this)}_callLifecycle(t){Cv(this.component);const e=Xi(t);(Array.isArray(e)?e:[e]).forEach(i=>{typeof i=="function"?this._lifecycleCleanups.push(i):typeof i=="object"&&typeof i.remove=="function"&&this._lifecycleCleanups.push(i.remove)})}};function fX(t){Xi(t,void 0,this)}var Y2e=KG;function gX(t){if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e=new Proxy(t,{get(s,i,r){if(!(X2e.has(i)&&i in s&&s[i]===e)&&(i in s||i in Promise.prototype||typeof i=="symbol"))return typeof s=="function"?s[i]:Reflect.get(s,i,r)},set:(s,i,r,n)=>Reflect.set(s,i,r,n)});return e}var X2e=new Set(["exports","_exports"]);function W2e(t,e,s){const i=Object.keys(t),r=i.length;pd===void 0&&queueMicrotask(ez),pd??(pd=new Map);let n=pd.get(t);return n===void 0&&(n={callbacks:[],keyCount:r},pd.set(t,n)),n.keyCount!==r&&(n.callbacks.forEach(o=>o(i)),n.callbacks=[],n.keyCount=r),n.callbacks.push(o=>{const a=u=>Xi(e,null,u),l=o[r];l===void 0?a(void 0):t[l]===s?a(l):a(void 0)}),s}var pd=void 0;function ez(){Array.from((pd==null?void 0:pd.entries())??[]).forEach(([t,{callbacks:e}])=>{const s=Object.keys(t);e.forEach(i=>i(s))}),pd=void 0}function tz(t,e,s){var i;const r=e,n=t.manager.internals;(i=n.allWatchers)[r]??(i[r]=[]);const o=n.allWatchers[r],a=s,l=(u,c,h)=>Xi(a,null,u,c,h);return o.push(l),()=>{const u=o.indexOf(l);u!==-1&&o.splice(u,1)}}var Z2e=class{constructor(t){this.enabledWatchers={},this.allWatchers={},this.enableReadonly=()=>{if(this.enableReadonly=void 0,!this.component.manager.isLit)return;const e=this.component.manager.internals;Object.entries(e.members).forEach(([s,[i]])=>{var r;i&2048&&((r=e.setters)[s]??(r[s]=[]),e.setters[s].push(e.readonlySetter))})},this.trackedValue=kL,this.keyTrackers=[],this.getters={},this.setters={},this.accessorGetter={},this.accessorSetter={},this._exports=new WeakMap,this.readonlySetter=(e,s,i)=>{if(RL.readOnly)return e;throw new Error(`Cannot assign to read-only property "${i}" of ${this.component.el.tagName.toLowerCase()}. Trying to assign "${String(e)}"`)},this.component=t}firePropTrackers(t,e){const s=this.keyTrackers;this.trackedValue=kL,this.keyTrackers=[],s.forEach(i=>i(t,e))}getSetProxy(t){const e=this.component,s=e.constructor.prototype;if(this._getSetProxy(s,t,"class"),e.manager.isLit)return;const i=e.el.constructor.prototype;s!==i&&this._getSetProxy(i,t,"html")}_getSetProxy(t,e,s){const i=this.component,r=G2e(i,e);let n;do n=Object.getOwnPropertyDescriptor(t,e);while(!n&&(t=Object.getPrototypeOf(t)));if(!n)return;const o=n.get,a=n.set,l=UT in o,u=UT in a;if(l&&u)return;const c=!l,h=!u,m=c?function(){let v=o.call(this);const b=gN.get(this);if(b===void 0)return v;const w=b.manager.internals;v=w.accessorGetter[e](v,e);const S=w.getters[e]??yX;for(let T=0;T<S.length;T++)v=S[T](v,e);return v}:o,f=h?function(v){var P;const b=o.call(this),w=gN.get(this);if(w===void 0){a.call(this,v);return}let S=w.manager.isLit?v??void 0:q2e(v,r);const T=w.manager.internals;if(S===b)a.call(this,S);else{const I=T.setters[e]??yX;for(let A=0;A<I.length&&(S=I[A](S,b,e),S!==b);A++);S=T.accessorSetter[e](S,b,e),a.call(this,S),S!==b&&((P=T.enabledWatchers[e])==null||P.forEach(A=>A(S,b,e)))}T.keyTrackers.length>0&&(T==null||T.firePropTrackers(e,v))}:a;c&&(m[UT]=!0),h&&(f[UT]=!0),Object.defineProperty(t,e,{...n,get:m,set:f})}markExports(t,e){(typeof e=="object"&&e!==null||typeof e=="function")&&this._exports.set(e,t)}resolveExports(t){if(typeof t=="object"&&t!==null||typeof t=="function")return this._exports.get(t)}},yX=[],UT=Symbol(),kL=Symbol();function Q2e(t,e,s){const i=t.manager.internals;return i.trackedValue!==kL&&i.trackedValue!==s&&i.firePropTrackers(void 0,void 0),i.keyTrackers.length===0&&queueMicrotask(()=>i.firePropTrackers(void 0,void 0)),i.trackedValue=s,i.keyTrackers.push((r,n)=>Xi(e,void 0,s===n?r:void 0)),s}function soe(t=[ED(),...eoe()],e,s){const i=Array.isArray(t)?t:[t];let r=i.length+1;const n=a=>{r-=1,a!==void 0&&(r=Math.min(r,0)),r===0&&e(a)};i.forEach(a=>W2e(a,l=>n(l===void 0?void 0:{key:l,host:a,isReactive:!1}),s));const o=i.find(a=>"manager"in a&&typeof a.manager=="object"&&a.manager.component===a);return o&&Q2e(o,a=>n(a===void 0?void 0:{key:a,host:o,isReactive:!0}),s),s}function J2e(t){RL.readOnly=!0;try{return t()}finally{RL.readOnly=!1}}var K2e=t=>(...e)=>{const s=eoe(),i=new t(...e),r=i.exports;Kne(s.at(-1));const n=i.component.manager.internals;n.markExports(i,r),i.watchExports(a=>n.markExports(i,a)),U2e(i);const o=[i.component,...s].reverse();return soe(o,a=>a===void 0?void 0:eSe(i,a,r),r)};function eSe(t,{host:e,key:s,isReactive:i},r){const n=e,o=n[s]!==t.exports,a=n[s]!==r,l=r!==t.exports;if(o&&!a&&l&&(n[s]=t.exports),e===t.component){if(i){const c=t.component.manager.internals;a&&c.markExports(t,n[s]),tz(t.component,s,h=>{h!==t.exports&&c.markExports(t,h)})}t.assignedProperty=i?void 0:s}t.watchExports(()=>{var m;if(n[s]===t.exports)return;const c=t.component.manager;((m=c.internals.setters[s])==null?void 0:m.includes(c.internals.readonlySetter))?J2e(()=>{n[s]=t.exports}):n[s]=t.exports})}var tSe=(t,e)=>new sSe(t,e),sSe=class extends Y2e{constructor(t,e){const s="addController"in t,i=new Set;function r(l){var u;i.add(l),!(QG in l)&&t.renderRoot&&t.el.isConnected&&((u=l.hostConnected)==null||u.call(l))}function n(l){var u;i.delete(l),(u=l.controllerRemoved)==null||u.call(l)}const o=t;if(o.addController=r,o.removeController=n,!s){const l=e??t.constructor.__forceUpdate;o.requestUpdate=()=>l(t)}super(t),this.internals=new Z2e(this.component),this.destroyed=!1,this._updatePromise=new R_,this._originalLifecycles={},this.isLit=s,this.component.manager=this,V2e(t,s),this._controllers=i,this.exports=void 0,this.hasDestroy=ZF in this.component&&typeof this.component.destroy=="function",this._bindLifecycleMethods();const a=this.internals;Object.keys(a.members).forEach(l=>{a.accessorGetter[l]=_X,a.accessorSetter[l]=_X,a.getSetProxy(l)}),s?this.internals.enabledWatchers=this.internals.allWatchers:Object.defineProperty(t,"updateComplete",{get:async()=>await this._updatePromise.promise}),queueMicrotask(a.enableReadonly),Cv(t),gN.set(t.el,t),gN.set(t,t)}_bindLifecycleMethods(){const t=this.component,e=this.isLit,s=t.el===t;this._originalLifecycles={_connectedCallback:e||s?void 0:t.connectedCallback,_disconnectedCallback:e||s?void 0:t.disconnectedCallback,_load:e?t.load:t.componentWillLoad,_loaded:e?t.loaded:t.componentDidLoad,_willUpdate:e?void 0:t.componentWillUpdate,_updated:e?void 0:t.componentDidUpdate,_destroy:t.destroy};const i=this._connectedCallback.bind(this),r=this._disconnectedCallback.bind(this),n=this._update.bind(this),o=this._updated.bind(this);e?t.constructor.prototype.addController.call(t,{hostConnected:i,hostDisconnected:r,hostUpdate:n,hostUpdated:o}):(t.connectedCallback=i,t.disconnectedCallback=r,t.componentWillLoad=this._load.bind(this),t.componentDidLoad=this._loaded.bind(this),t.componentWillUpdate=n,t.componentDidUpdate=o),this.hasDestroy&&(t.destroy=this.destroy.bind(this))}_connectedCallback(){var e,s;if(this.destroyed){const i=this.component.el.tagName.toLowerCase();throw this.component.el.remove(),new Error(`The ${i} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${ZF} prop.`)}this._autoDestroyTimeout!==void 0&&clearTimeout(this._autoDestroyTimeout);const t=this.internals;t.enabledWatchers=t.allWatchers,ez(),(e=t.enableReadonly)==null||e.call(t),this._controllers.forEach(rSe),(s=this._originalLifecycles._connectedCallback)==null||s.call(this.component)}_disconnectedCallback(){var t;this.destroyed||(this._controllers.forEach(nSe),(t=this._originalLifecycles._disconnectedCallback)==null||t.call(this.component),this.hasDestroy&&this._setAutoDestroyTimeout())}async _load(){var t;await Promise.allSettled(Array.from(this._controllers,oSe)),await((t=this._originalLifecycles._load)==null?void 0:t.call(this.component)),this.hasDestroy&&tz(this.component,ZF,()=>this._setAutoDestroyTimeout())}_loaded(){var t;this._controllers.forEach(aSe),(t=this._originalLifecycles._loaded)==null||t.call(this.component)}_update(){var e;const t=this.component;return this._controllers.forEach(lSe,t.$changes),(e=this._originalLifecycles._willUpdate)==null?void 0:e.call(this.component)}_updated(){var e;const t=this.component;if(this._controllers.forEach(uSe,t.$changes),(e=this._originalLifecycles._updated)==null||e.call(this.component),this.isLit)t.$changes=new Map;else{const s=this._updatePromise;this._updatePromise=new R_,s.resolve(!0)}}async destroy(){var t;if(!this.destroyed){if(this.component.el.isConnected){this.hasDestroy=!1;try{this.component.el.remove()}finally{this.hasDestroy=!0}}this._autoDestroyTimeout=void 0,this.destroyed=!0,this._controllers.forEach(cSe),this._controllers.clear(),await((t=this._originalLifecycles._destroy)==null?void 0:t.call(this.component))}}_setAutoDestroyTimeout(){if(this._autoDestroyTimeout!==void 0&&clearTimeout(this._autoDestroyTimeout),!this.component.el.isConnected&&!this.component.autoDestroyDisabled){const t=()=>void this.destroy().catch(console.error);this._autoDestroyTimeout=D2e(t,iSe)}}},ZF="autoDestroyDisabled",iSe=1e3,_X=t=>t;function rSe(t){"triggerConnected"in t?t.triggerConnected():Xi(t.hostConnected,t)}function nSe(t){"triggerDisconnected"in t?t.triggerDisconnected():Xi(t.hostDisconnected,t)}async function oSe(t){"triggerLoad"in t?await t.triggerLoad():await $L(t.hostLoad,t)}function aSe(t){"triggerLoaded"in t?t.triggerLoaded():Xi(t.hostLoaded,t)}function lSe(t){"triggerUpdate"in t?t.triggerUpdate(this):Xi(t.hostUpdate,t,this)}function uSe(t){"triggerUpdated"in t?t.triggerUpdated(this):Xi(t.hostUpdated,t,this)}function cSe(t){"triggerDestroy"in t?t.triggerDestroy():Xi(t.hostDestroy,t)}var hSe=t=>ioe(void 0,t),iut=t=>e=>ioe(e,t),mSe=class extends KG{constructor(t,e){super(t);const s=this.exports;try{Cv(this.component);const i=e(this.component,this),r=this.exports!==s;if(i instanceof Promise){r||this.setProvisionalExports(i);const n=i.then(o=>{this.exports=o,super.catchUpLifecycle()}).catch(o=>{this._ready.reject(o),console.error(o)});this.onLoad(async()=>await n)}else(!r||i!==void 0)&&(this.exports=i),queueMicrotask(()=>super.catchUpLifecycle())}catch(i){this._ready.reject(i),console.error(i)}}catchUpLifecycle(){}},ioe=K2e(mSe),rut=(t,e)=>new dSe(t,e),dSe=class extends KG{constructor(t,e){super(),this._attributes=t,this._callback=e,this._observer=new MutationObserver(s=>{s.forEach(i=>{t.includes(i.attributeName)&&e.call(this.component,this.component.el.getAttribute(i.attributeName),i.oldValue,i.attributeName)})})}hostConnected(){this._attributes.forEach(t=>{this.component.el.hasAttribute(t)&&this._callback.call(this.component,null,this.component.el.getAttribute(t),t)}),this._observer.observe(this.component.el,{attributes:!0,attributeOldValue:!0,attributeFilter:this._attributes})}hostDisconnected(){this._observer.disconnect()}},nut=t=>(e={})=>hSe((s,i)=>{const r=Wne(s.el),n={_lang:r.lang,_t9nLocale:r.t9nLocale,_loading:!0},o=s;i.onLifecycle(()=>M2e(s.el,()=>t("./assets"),({t9nLocale:l,t9nStrings:u,lang:c})=>{const h={...u,_lang:c,_t9nLocale:l,_loading:!1};i.exports=h;const m=u.componentLabel;typeof m=="string"&&"label"in s&&s.label==null&&(s.label??(s.label=m)),a(o.messageOverrides)},e.name));function a(l){const u=i.exports,c=u._original??u,h=roe(c,l);l&&(h._original=c),i.exports=h}return"messageOverrides"in o&&i.onLifecycle(()=>tz(o,"messageOverrides",a)),e.blocking?(i.setProvisionalExports(n,!1),i.ready):n});function roe(t,e){if(!e)return t;const s={...t};return Object.entries(e).forEach(([i,r])=>{typeof r=="object"?s[i]=roe(t[i],r):s[i]=r??t[i]}),s}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const TM=globalThis,sz=TM.ShadowRoot&&(TM.ShadyCSS===void 0||TM.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,iz=Symbol(),vX=new WeakMap;let noe=class{constructor(e,s,i){if(this._$cssResult$=!0,i!==iz)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=s}get styleSheet(){let e=this.o;const s=this.t;if(sz&&e===void 0){const i=s!==void 0&&s.length===1;i&&(e=vX.get(s)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&vX.set(s,e))}return e}toString(){return this.cssText}};const pSe=t=>new noe(typeof t=="string"?t:t+"",void 0,iz),aut=(t,...e)=>{const s=t.length===1?t[0]:e.reduce((i,r,n)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+t[n+1],t[0]);return new noe(s,t,iz)},fSe=(t,e)=>{if(sz)t.adoptedStyleSheets=e.map(s=>s instanceof CSSStyleSheet?s:s.styleSheet);else for(const s of e){const i=document.createElement("style"),r=TM.litNonce;r!==void 0&&i.setAttribute("nonce",r),i.textContent=s.cssText,t.appendChild(i)}},bX=sz?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let s="";for(const i of e.cssRules)s+=i.cssText;return pSe(s)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:gSe,defineProperty:ySe,getOwnPropertyDescriptor:_Se,getOwnPropertyNames:vSe,getOwnPropertySymbols:bSe,getPrototypeOf:xSe}=Object,Vf=globalThis,xX=Vf.trustedTypes,wSe=xX?xX.emptyScript:"",QF=Vf.reactiveElementPolyfillSupport,VS=(t,e)=>t,FL={toAttribute(t,e){switch(e){case Boolean:t=t?wSe:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let s=t;switch(e){case Boolean:s=t!==null;break;case Number:s=t===null?null:Number(t);break;case Object:case Array:try{s=JSON.parse(t)}catch{s=null}}return s}},ooe=(t,e)=>!gSe(t,e),wX={attribute:!0,type:String,converter:FL,reflect:!1,useDefault:!1,hasChanged:ooe};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Vf.litPropertyMetadata??(Vf.litPropertyMetadata=new WeakMap);let R1=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,s=wX){if(s.state&&(s.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(e,s),!s.noAccessor){const i=Symbol(),r=this.getPropertyDescriptor(e,i,s);r!==void 0&&ySe(this.prototype,e,r)}}static getPropertyDescriptor(e,s,i){const{get:r,set:n}=_Se(this.prototype,e)??{get(){return this[s]},set(o){this[s]=o}};return{get:r,set(o){const a=r==null?void 0:r.call(this);n==null||n.call(this,o),this.requestUpdate(e,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??wX}static _$Ei(){if(this.hasOwnProperty(VS("elementProperties")))return;const e=xSe(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(VS("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(VS("properties"))){const s=this.properties,i=[...vSe(s),...bSe(s)];for(const r of i)this.createProperty(r,s[r])}const e=this[Symbol.metadata];if(e!==null){const s=litPropertyMetadata.get(e);if(s!==void 0)for(const[i,r]of s)this.elementProperties.set(i,r)}this._$Eh=new Map;for(const[s,i]of this.elementProperties){const r=this._$Eu(s,i);r!==void 0&&this._$Eh.set(r,s)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const s=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const r of i)s.unshift(bX(r))}else e!==void 0&&s.push(bX(e));return s}static _$Eu(e,s){const i=s.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(s=>this.enableUpdating=s),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(s=>s(this))}addController(e){var s;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((s=e.hostConnected)==null||s.call(e))}removeController(e){var s;(s=this._$EO)==null||s.delete(e)}_$E_(){const e=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return fSe(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(s=>{var i;return(i=s.hostConnected)==null?void 0:i.call(s)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(s=>{var i;return(i=s.hostDisconnected)==null?void 0:i.call(s)})}attributeChangedCallback(e,s,i){this._$AK(e,i)}_$ET(e,s){var n;const i=this.constructor.elementProperties.get(e),r=this.constructor._$Eu(e,i);if(r!==void 0&&i.reflect===!0){const o=(((n=i.converter)==null?void 0:n.toAttribute)!==void 0?i.converter:FL).toAttribute(s,i.type);this._$Em=e,o==null?this.removeAttribute(r):this.setAttribute(r,o),this._$Em=null}}_$AK(e,s){var n,o;const i=this.constructor,r=i._$Eh.get(e);if(r!==void 0&&this._$Em!==r){const a=i.getPropertyOptions(r),l=typeof a.converter=="function"?{fromAttribute:a.converter}:((n=a.converter)==null?void 0:n.fromAttribute)!==void 0?a.converter:FL;this._$Em=r,this[r]=l.fromAttribute(s,a.type)??((o=this._$Ej)==null?void 0:o.get(r))??null,this._$Em=null}}requestUpdate(e,s,i){var r;if(e!==void 0){const n=this.constructor,o=this[e];if(i??(i=n.getPropertyOptions(e)),!((i.hasChanged??ooe)(o,s)||i.useDefault&&i.reflect&&o===((r=this._$Ej)==null?void 0:r.get(e))&&!this.hasAttribute(n._$Eu(e,i))))return;this.C(e,s,i)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,s,{useDefault:i,reflect:r,wrapped:n},o){i&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??s??this[e]),n!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||i||(s=void 0),this._$AL.set(e,s)),r===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(s){Promise.reject(s)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var i;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[n,o]of this._$Ep)this[n]=o;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[n,o]of r){const{wrapped:a}=o,l=this[n];a!==!0||this._$AL.has(n)||l===void 0||this.C(n,void 0,o,l)}}let e=!1;const s=this._$AL;try{e=this.shouldUpdate(s),e?(this.willUpdate(s),(i=this._$EO)==null||i.forEach(r=>{var n;return(n=r.hostUpdate)==null?void 0:n.call(r)}),this.update(s)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(s)}willUpdate(e){}_$AE(e){var s;(s=this._$EO)==null||s.forEach(i=>{var r;return(r=i.hostUpdated)==null?void 0:r.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(s=>this._$ET(s,this[s]))),this._$EM()}updated(e){}firstUpdated(e){}};R1.elementStyles=[],R1.shadowRootOptions={mode:"open"},R1[VS("elementProperties")]=new Map,R1[VS("finalized")]=new Map,QF==null||QF({ReactiveElement:R1}),(Vf.reactiveElementVersions??(Vf.reactiveElementVersions=[])).push("2.1.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const qS=globalThis,yN=qS.trustedTypes,SX=yN?yN.createPolicy("lit-html",{createHTML:t=>t}):void 0,aoe="$lit$",xf=`lit$${Math.random().toFixed(9).slice(2)}$`,loe="?"+xf,SSe=`<${loe}>`,k_=document,vE=()=>k_.createComment(""),bE=t=>t===null||typeof t!="object"&&typeof t!="function",rz=Array.isArray,ESe=t=>rz(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",JF=`[ 	
\f\r]`,Nw=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,EX=/-->/g,CX=/>/g,Bg=RegExp(`>|${JF}(?:([^\\s"'>=/]+)(${JF}*=${JF}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),PX=/'/g,TX=/"/g,uoe=/^(?:script|style|textarea|title)$/i,coe=t=>(e,...s)=>({_$litType$:t,strings:e,values:s}),uut=coe(1),cut=coe(2),Xf=Symbol.for("lit-noChange"),bn=Symbol.for("lit-nothing"),IX=new WeakMap,n_=k_.createTreeWalker(k_,129);function hoe(t,e){if(!rz(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return SX!==void 0?SX.createHTML(e):e}const CSe=(t,e)=>{const s=t.length-1,i=[];let r,n=e===2?"<svg>":e===3?"<math>":"",o=Nw;for(let a=0;a<s;a++){const l=t[a];let u,c,h=-1,m=0;for(;m<l.length&&(o.lastIndex=m,c=o.exec(l),c!==null);)m=o.lastIndex,o===Nw?c[1]==="!--"?o=EX:c[1]!==void 0?o=CX:c[2]!==void 0?(uoe.test(c[2])&&(r=RegExp("</"+c[2],"g")),o=Bg):c[3]!==void 0&&(o=Bg):o===Bg?c[0]===">"?(o=r??Nw,h=-1):c[1]===void 0?h=-2:(h=o.lastIndex-c[2].length,u=c[1],o=c[3]===void 0?Bg:c[3]==='"'?TX:PX):o===TX||o===PX?o=Bg:o===EX||o===CX?o=Nw:(o=Bg,r=void 0);const f=o===Bg&&t[a+1].startsWith("/>")?" ":"";n+=o===Nw?l+SSe:h>=0?(i.push(u),l.slice(0,h)+aoe+l.slice(h)+xf+f):l+xf+(h===-2?a:f)}return[hoe(t,n+(t[s]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),i]};let OL=class moe{constructor({strings:e,_$litType$:s},i){let r;this.parts=[];let n=0,o=0;const a=e.length-1,l=this.parts,[u,c]=CSe(e,s);if(this.el=moe.createElement(u,i),n_.currentNode=this.el.content,s===2||s===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(r=n_.nextNode())!==null&&l.length<a;){if(r.nodeType===1){if(r.hasAttributes())for(const h of r.getAttributeNames())if(h.endsWith(aoe)){const m=c[o++],f=r.getAttribute(h).split(xf),g=/([.?@])?(.*)/.exec(m);l.push({type:1,index:n,name:g[2],strings:f,ctor:g[1]==="."?TSe:g[1]==="?"?ISe:g[1]==="@"?MSe:PD}),r.removeAttribute(h)}else h.startsWith(xf)&&(l.push({type:6,index:n}),r.removeAttribute(h));if(uoe.test(r.tagName)){const h=r.textContent.split(xf),m=h.length-1;if(m>0){r.textContent=yN?yN.emptyScript:"";for(let f=0;f<m;f++)r.append(h[f],vE()),n_.nextNode(),l.push({type:2,index:++n});r.append(h[m],vE())}}}else if(r.nodeType===8)if(r.data===loe)l.push({type:2,index:n});else{let h=-1;for(;(h=r.data.indexOf(xf,h+1))!==-1;)l.push({type:7,index:n}),h+=xf.length-1}n++}}static createElement(e,s){const i=k_.createElement("template");return i.innerHTML=e,i}};function pb(t,e,s=t,i){var o,a;if(e===Xf)return e;let r=i!==void 0?(o=s._$Co)==null?void 0:o[i]:s._$Cl;const n=bE(e)?void 0:e._$litDirective$;return(r==null?void 0:r.constructor)!==n&&((a=r==null?void 0:r._$AO)==null||a.call(r,!1),n===void 0?r=void 0:(r=new n(t),r._$AT(t,s,i)),i!==void 0?(s._$Co??(s._$Co=[]))[i]=r:s._$Cl=r),r!==void 0&&(e=pb(t,r._$AS(t,e.values),r,i)),e}let PSe=class{constructor(e,s){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=s}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:s},parts:i}=this._$AD,r=((e==null?void 0:e.creationScope)??k_).importNode(s,!0);n_.currentNode=r;let n=n_.nextNode(),o=0,a=0,l=i[0];for(;l!==void 0;){if(o===l.index){let u;l.type===2?u=new CD(n,n.nextSibling,this,e):l.type===1?u=new l.ctor(n,l.name,l.strings,this,e):l.type===6&&(u=new ASe(n,this,e)),this._$AV.push(u),l=i[++a]}o!==(l==null?void 0:l.index)&&(n=n_.nextNode(),o++)}return n_.currentNode=k_,r}p(e){let s=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,s),s+=i.strings.length-2):i._$AI(e[s])),s++}},CD=class doe{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,s,i,r){this.type=2,this._$AH=bn,this._$AN=void 0,this._$AA=e,this._$AB=s,this._$AM=i,this.options=r,this._$Cv=(r==null?void 0:r.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const s=this._$AM;return s!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=s.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,s=this){e=pb(this,e,s),bE(e)?e===bn||e==null||e===""?(this._$AH!==bn&&this._$AR(),this._$AH=bn):e!==this._$AH&&e!==Xf&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):ESe(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==bn&&bE(this._$AH)?this._$AA.nextSibling.data=e:this.T(k_.createTextNode(e)),this._$AH=e}$(e){var n;const{values:s,_$litType$:i}=e,r=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=OL.createElement(hoe(i.h,i.h[0]),this.options)),i);if(((n=this._$AH)==null?void 0:n._$AD)===r)this._$AH.p(s);else{const o=new PSe(r,this),a=o.u(this.options);o.p(s),this.T(a),this._$AH=o}}_$AC(e){let s=IX.get(e.strings);return s===void 0&&IX.set(e.strings,s=new OL(e)),s}k(e){rz(this._$AH)||(this._$AH=[],this._$AR());const s=this._$AH;let i,r=0;for(const n of e)r===s.length?s.push(i=new doe(this.O(vE()),this.O(vE()),this,this.options)):i=s[r],i._$AI(n),r++;r<s.length&&(this._$AR(i&&i._$AB.nextSibling,r),s.length=r)}_$AR(e=this._$AA.nextSibling,s){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,s);e&&e!==this._$AB;){const r=e.nextSibling;e.remove(),e=r}}setConnected(e){var s;this._$AM===void 0&&(this._$Cv=e,(s=this._$AP)==null||s.call(this,e))}},PD=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,s,i,r,n){this.type=1,this._$AH=bn,this._$AN=void 0,this.element=e,this.name=s,this._$AM=r,this.options=n,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=bn}_$AI(e,s=this,i,r){const n=this.strings;let o=!1;if(n===void 0)e=pb(this,e,s,0),o=!bE(e)||e!==this._$AH&&e!==Xf,o&&(this._$AH=e);else{const a=e;let l,u;for(e=n[0],l=0;l<n.length-1;l++)u=pb(this,a[i+l],s,l),u===Xf&&(u=this._$AH[l]),o||(o=!bE(u)||u!==this._$AH[l]),u===bn?e=bn:e!==bn&&(e+=(u??"")+n[l+1]),this._$AH[l]=u}o&&!r&&this.j(e)}j(e){e===bn?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},TSe=class extends PD{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===bn?void 0:e}},ISe=class extends PD{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==bn)}},MSe=class extends PD{constructor(e,s,i,r,n){super(e,s,i,r,n),this.type=5}_$AI(e,s=this){if((e=pb(this,e,s,0)??bn)===Xf)return;const i=this._$AH,r=e===bn&&i!==bn||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,n=e!==bn&&(i===bn||r);r&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var s;typeof this._$AH=="function"?this._$AH.call(((s=this.options)==null?void 0:s.host)??this.element,e):this._$AH.handleEvent(e)}},ASe=class{constructor(e,s,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=s,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){pb(this,e)}};const yut={I:CD},KF=qS.litHtmlPolyfillSupport;KF==null||KF(OL,CD),(qS.litHtmlVersions??(qS.litHtmlVersions=[])).push("3.3.0");const NSe=(t,e,s)=>{const i=(s==null?void 0:s.renderBefore)??e;let r=i._$litPart$;if(r===void 0){const n=(s==null?void 0:s.renderBefore)??null;i._$litPart$=r=new CD(e.insertBefore(vE(),n),n,void 0,s??{})}return r._$AI(t),r};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const g_=globalThis;let zv=class extends R1{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var s;const e=super.createRenderRoot();return(s=this.renderOptions).renderBefore??(s.renderBefore=e.firstChild),e}update(e){const s=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=NSe(s,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return Xf}};var Lne;zv._$litElement$=!0,zv.finalized=!0,(Lne=g_.litElementHydrateSupport)==null||Lne.call(g_,{LitElement:zv});const e4=g_.litElementPolyfillSupport;e4==null||e4({LitElement:zv});(g_.litElementVersions??(g_.litElementVersions=[])).push("4.2.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const poe={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},foe=t=>(...e)=>({_$litDirective$:t,values:e});let goe=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,s,i){this._$Ct=e,this._$AM=s,this._$Ci=i}_$AS(e,s){return this.update(e,s)}update(e,s){return this.render(...s)}};/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const DSe=foe(class extends goe{constructor(t){var e;if(super(t),t.type!==poe.ATTRIBUTE||t.name!=="class"||((e=t.strings)==null?void 0:e.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){var i,r;if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(n=>n!=="")));for(const n in e)e[n]&&!((i=this.nt)!=null&&i.has(n))&&this.st.add(n);return this.render(e)}const s=t.element.classList;for(const n of this.st)n in e||(s.remove(n),this.st.delete(n));for(const n in e){const o=!!e[n];o===this.st.has(n)||(r=this.nt)!=null&&r.has(n)||(o?(s.add(n),this.st.add(n)):(s.remove(n),this.st.delete(n)))}return Xf}});/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const yoe="important",$Se=" !"+yoe,RSe=foe(class extends goe{constructor(t){var e;if(super(t),t.type!==poe.ATTRIBUTE||t.name!=="style"||((e=t.strings)==null?void 0:e.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce((e,s)=>{const i=t[s];return i==null?e:e+`${s=s.includes("-")?s:s.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${i};`},"")}update(t,[e]){const{style:s}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const i of this.ft)e[i]==null&&(this.ft.delete(i),i.includes("-")?s.removeProperty(i):s[i]=null);for(const i in e){const r=e[i];if(r!=null){this.ft.add(i);const n=typeof r=="string"&&r.endsWith($Se);i.includes("-")||n?s.setProperty(i,n?r.slice(0,-11):r,n?yoe:""):s[i]=r}}return Xf}});var _oe=(t="",e={},s=ED())=>{const i={emit:r=>{t===""&&ez();const n=new CustomEvent(t,{detail:r,cancelable:!0,bubbles:!0,composed:!0,...e});return s.el.dispatchEvent(n),n}};return t===""&&soe(void 0,r=>{t=r.key},i),i},but=_oe.bind(null,""),kSe=()=>{},$_,FSe=($_=class extends zv{constructor(){var s,i,r;super(),this.el=this.constructor.lazy??this,this.manager=tSe(this),this._postLoad=((s=this.constructor.lazy)==null?void 0:s._postLoad)??new R_,this._offspring=((i=this.constructor.lazy)==null?void 0:i._offspring)??[],this._postLoaded=((r=this.constructor.lazy)==null?void 0:r._postLoaded)??new R_,this._enableUpdating=this.enableUpdating,this.enableUpdating=kSe;const e=$_.prototype.shouldUpdate;this.shouldUpdate!==e&&(this._originalShouldUpdate=this.shouldUpdate,this.shouldUpdate=e)}static finalizeStyles(e){var r;const s=super.finalizeStyles(e),i=this.shadowRootOptions===pX;return((r=this.runtime)==null?void 0:r.commonStyles)===void 0||i?s:[this.runtime.commonStyles,...s]}static createProperty(e,s){const i=typeof s=="number"?s:Array.isArray(s)?s[0]:0,r=Array.isArray(s)?s[1]:void 0;super.createProperty(e,{attribute:i&1&&typeof e=="string"?Qne(e):!1,reflect:!!(i&2),type:i&4?Boolean:i&8?Number:void 0,state:!!(i&16),readOnly:!!(i&32),noAccessor:!!(i&64),...r})}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const e=!this.manager.connectedCalled;super.connectedCallback(),e&&queueMicrotask(()=>this._load().catch(s=>{this._postLoaded.reject(s),setTimeout(()=>{throw s})}))}createRenderRoot(){const e=this.el.shadowRoot,s=this.constructor,i=s.shadowRootOptions,n=e??(i===pX?this.el:this.el.attachShadow(i));if(Object.defineProperty(this,"shadowRoot",{value:n}),e)return zv.prototype.createRenderRoot.call(this),e;if(this.isConnected){const o=n.getRootNode();o.adoptedStyleSheets=[...o.adoptedStyleSheets,...s.elementStyles.map(a=>"styleSheet"in a?a.styleSheet:a)]}return n}async _load(){const e=this.el._ancestorLoad??Jne(this.el);e&&await e,await this.manager._load(),this._enableUpdating(!0),this.performUpdate(),this._postLoad.resolve(),await Promise.resolve();const s=this._offspring.filter(i=>{var r;return!((r=i.manager)!=null&&r.loadedCalled)});s.length&&await Promise.allSettled(s.map(async i=>await i.componentOnReady())),this._offspring.length=0,this.el.setAttribute(this.constructor.runtime.hydratedAttribute,""),this.manager._loaded(),this._postLoaded.resolve()}shouldUpdate(e){var s;return this.$changes=e,((s=this._originalShouldUpdate)==null?void 0:s.call(this,e))??!0}listen(e,s,i){const r=(s==null?void 0:s.bind(this))??s;this.manager.onLifecycle(()=>(this.el.addEventListener(e,r,i),()=>this.el.removeEventListener(e,r,i)))}listenOn(e,s,i,r){const n=(i==null?void 0:i.bind(this))??i;this.manager.onLifecycle(()=>(e.addEventListener(s,n,r),()=>e.removeEventListener(s,n,r)))}async componentOnReady(){return await this._postLoaded.promise,this}},$_.lumina=!0,$_);FSe.$createEvent=_oe;function OSe(t){let e;const s=r=>{var n;e=new URL(r,((n=globalThis.location)==null?void 0:n.href)||void 0).href},i={...t,getAssetPath(r){var o;const n=new URL(r,e);return n.origin!==((o=globalThis.location)==null?void 0:o.origin)?n.href:n.pathname},setAssetPath:s,customElement(r,n){n.runtime=i,n.tagName=r,customElements.get(r)||customElements.define(r,n)}};return s(t.defaultAssetPath),i}var xut=t=>typeof t=="object"&&t!=null?DSe(t):t,wut=t=>typeof t=="object"&&t!=null?RSe(t):t,Sut=bn;function Eut(t,e,s){s==null?t.removeAttribute(e):t.setAttribute(e,s)}var Cut={toAttribute:t=>t===!0?"":t===!1?null:t},LSe={},VSe=(t,e)=>s=>{const i=s.tagName;let r=LSe;const n={name:i,get prototype(){var a;if(r===void 0){if(r=(a=customElements.get(i))==null?void 0:a.prototype,!r)throw new Error(`Custom element "${i}" not found`);Object.defineProperty(n,"prototype",{value:r})}return r}},o=e({...s,react:t,elementClass:n});return r=void 0,o},Kl=(t,e)=>({tagName:t,events:e});const eu=VSe(c2e,_2e),t4=eu(Kl("calcite-action",{})),qSe=eu(Kl("calcite-avatar",{})),Lh=eu(Kl("calcite-button",{})),GSe=eu(Kl("calcite-icon",{})),MX=eu(Kl("calcite-input",{onCalciteInputChange:"calciteInputChange",onCalciteInputInput:"calciteInputInput"})),AX=eu(Kl("calcite-label",{})),zSe=eu(Kl("calcite-list",{onCalciteListChange:"calciteListChange",onCalciteListDragEnd:"calciteListDragEnd",onCalciteListDragStart:"calciteListDragStart",onCalciteListFilter:"calciteListFilter",onCalciteListOrderChange:"calciteListOrderChange"})),NX=eu(Kl("calcite-list-item",{onCalciteListItemClose:"calciteListItemClose",onCalciteListItemSelect:"calciteListItemSelect",onCalciteListItemSortHandleBeforeClose:"calciteListItemSortHandleBeforeClose",onCalciteListItemSortHandleBeforeOpen:"calciteListItemSortHandleBeforeOpen",onCalciteListItemSortHandleClose:"calciteListItemSortHandleClose",onCalciteListItemSortHandleOpen:"calciteListItemSortHandleOpen",onCalciteListItemToggle:"calciteListItemToggle"})),DX=eu(Kl("calcite-list-item-group",{})),$X=eu(Kl("calcite-notice",{onCalciteNoticeBeforeClose:"calciteNoticeBeforeClose",onCalciteNoticeBeforeOpen:"calciteNoticeBeforeOpen",onCalciteNoticeClose:"calciteNoticeClose",onCalciteNoticeOpen:"calciteNoticeOpen"})),RX=eu(Kl("calcite-panel",{onCalcitePanelClose:"calcitePanelClose",onCalcitePanelScroll:"calcitePanelScroll",onCalcitePanelToggle:"calcitePanelToggle"})),USe=eu(Kl("calcite-shell",{})),s4=eu(Kl("calcite-shell-panel",{}));function p(t,e,s,i){var r,n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(n<3?r(o):n>3?r(e,s,o):r(e,s))||o);return n>3&&o&&Object.defineProperty(e,s,o),o}function Put(t,e){return function(s,i){e(s,i,t)}}function Tut(t,e,s,i){function r(n){return n instanceof s?n:new s(function(o){o(n)})}return new(s||(s=Promise))(function(n,o){function a(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?n(c.value):r(c.value).then(a,l)}u((i=i.apply(t,[])).next())})}function mo(t,e,s){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var i,r;if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=e[Symbol.dispose]}if(typeof i!="function")throw new TypeError("Object not disposable.");r&&(i=function(){try{r.call(this)}catch(n){return Promise.reject(n)}}),t.stack.push({value:e,dispose:i,async:s})}return e}var BSe=typeof SuppressedError=="function"?SuppressedError:function(t,e,s){var i=new Error(s);return i.name="SuppressedError",i.error=t,i.suppressed=e,i};function Od(t){function e(n){t.error=t.hasError?new BSe(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var s,i=0;function r(){for(;s=t.stack.pop();)try{if(!s.async&&i===1)return i=0,t.stack.push(s),Promise.resolve().then(r);if(s.dispose){var n=s.dispose.call(s.value);if(s.async)return i|=2,Promise.resolve(n).then(r,function(o){return e(o),r()})}else i|=1}catch(o){e(o)}if(i===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return r()}let Pf;function ge(t){return typeof Pf[t]=="function"?Pf[t]=Pf[t](globalThis):Pf[t]}var Vne,qne,Gne,zne;Pf=(Vne=globalThis.dojoConfig)!=null&&Vne.has||(qne=globalThis.esriConfig)!=null&&qne.has?{...(Gne=globalThis.dojoConfig)==null?void 0:Gne.has,...(zne=globalThis.esriConfig)==null?void 0:zne.has}:{},ge.add=(t,e,s,i)=>{(i||Pf[t]===void 0)&&(Pf[t]=e),s&&ge(t)},ge.cache=Pf,ge.add("big-integer-warning-enabled",!0),ge.add("esri-deprecation-warnings",!0),ge.add("esri-tests-disable-screenshots",!1),ge.add("esri-tests-use-full-window",!1),ge.add("esri-tests-post-to-influx",!0),ge.add("esri-cim-animations-enable-status","enabled"),ge.add("esri-cim-animations-spotlight",!1),ge.add("esri-cim-animations-freeze-time",!1),ge.add("enable-feature:multiple-highlights",!0),(()=>{var e;ge.add("host-webworker",globalThis.WorkerGlobalScope!==void 0&&self instanceof globalThis.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(ge.add("host-browser",t),ge.add("host-node",typeof globalThis.process=="object"&&((e=globalThis.process.versions)==null?void 0:e.node)&&globalThis.process.versions.v8),ge.add("dom",t),ge("host-browser")){const s=navigator,i=s.userAgent,r=s.appVersion,n=parseFloat(r);if(ge.add("wp",parseFloat(i.split("Windows Phone")[1])||void 0),ge.add("msapp",parseFloat(i.split("MSAppHost/")[1])||void 0),ge.add("khtml",r.includes("Konqueror")?n:void 0),ge.add("edge",parseFloat(i.split("Edge/")[1])||void 0),ge.add("opr",parseFloat(i.split("OPR/")[1])||void 0),ge.add("webkit",!ge("wp")&&!ge("edge")&&parseFloat(i.split("WebKit/")[1])||void 0),ge.add("chrome",!ge("edge")&&!ge("opr")&&parseFloat(i.split("Chrome/")[1])||void 0),ge.add("android",!ge("wp")&&parseFloat(i.split("Android ")[1])||void 0),ge.add("safari",!r.includes("Safari")||ge("wp")||ge("chrome")||ge("android")||ge("edge")||ge("opr")?void 0:parseFloat(r.split("Version/")[1])),ge.add("mac",r.includes("Macintosh")),!ge("wp")&&/(iPhone|iPod|iPad)/.test(i)){const o=RegExp.$1.replace(/P/,"p"),a=/OS ([\d_]+)/.test(i)?RegExp.$1:"1",l=parseFloat(a.replace(/_/,".").replaceAll("_",""));ge.add(o,l),ge.add("ios",l)}ge("webkit")||(!i.includes("Gecko")||ge("wp")||ge("khtml")||ge("edge")||ge.add("mozilla",n),ge("mozilla")&&ge.add("ff",parseFloat(i.split("Firefox/")[1]||i.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),s=/iPhone/i.test(t);e&&ge.add("esri-mobile",e),s&&ge.add("esri-iPhone",s),ge.add("esri-geolocation",!!navigator.geolocation)}ge.add("esri-wasm","WebAssembly"in globalThis),ge.add("esri-performance-mode-frames-between-render",20),ge.add("esri-force-performance-mode",!1),ge.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in globalThis,e=globalThis.crossOriginIsolated===!1;return t&&!e}),ge.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),ge.add("esri-atomics","Atomics"in globalThis),ge.add("esri-workers","Worker"in globalThis),ge.add("web-feat:cache","caches"in globalThis),ge.add("esri-workers-arraybuffer-transfer",!ge("safari")||Number(ge("safari"))>=12),ge.add("workers-pool-size",8),ge.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),ge.add("featurelayer-simplify-payload-size-factors",[1,1,4]),ge.add("featurelayer-fast-triangulation-enabled",!0),ge.add("featurelayer-animation-enabled",!0),ge.add("featurelayer-snapshot-enabled",!0),ge.add("featurelayer-snapshot-point-min-threshold",8e4),ge.add("featurelayer-snapshot-point-max-threshold",4e5),ge.add("featurelayer-snapshot-point-coverage",.1),ge.add("featurelayer-query-max-depth",4),ge.add("featurelayer-query-pausing-enabled",!1),ge.add("featurelayer-advanced-symbols",!1),ge.add("featurelayer-pbf",!0),ge.add("featurelayer-pbf-statistics",!1),ge.add("feature-layers-workers",!0),ge.add("feature-polyline-generalization-factor",1),ge.add("mapview-transitions-duration",200),ge.add("mapview-essential-goto-duration",200),ge.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),ge.add("mapserver-pbf-version-support",10.81),ge.add("mapservice-popup-identify-max-tolerance",20),ge.add("request-queue-concurrency-hosted",16),ge.add("request-queue-concurrency-non-hosted",4),ge.add("curve-densification-coarse-segments",128),ge.add("curve-densification-max-segments",2e3),ge.add("curve-densification-min-segments",3),ge.add("curve-densification-pixels-per-segment",16),ge.add("view-readyState-waiting-delay",1e3),ge.add("gradient-depth-bias",.01),ge.add("gradient-depth-epsilon",1e-8),ge("host-webworker")||ge("host-browser")&&(ge.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),ge.add("esri-image-decode",()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then(()=>{ge.add("esri-image-decode",!0,!0,!0)}).catch(()=>{ge.add("esri-image-decode",!1,!0,!0)})}return!1}),ge.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();function Iut(t){}function jSe(t){return()=>t}function Mut(t){return t}let IM=class oy{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*oy._m}getInt(){return this._seed=(oy._a*this._seed+oy._c)%oy._m,this._seed}getFloat(){return this.getInt()/(oy._m-1)}getIntRange(e,s){return Math.round(this.getFloatRange(e,s))}getFloatRange(e,s){const i=s-e;return e+this.getInt()/oy._m*i}};IM._m=2147483647,IM._a=48271,IM._c=0;const HSe=1.5,Aut=1/HSe,Nut=.5;function nz(t,e){return e?t.filter((s,i,r)=>r.findIndex(e.bind(null,s))===i):Array.from(new Set(t))}function TD(t,e,s){if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;if(s){for(let i=0;i<t.length;i++)if(!s(t[i],e[i]))return!1}else for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function kX(t,e,s){let i,r;return s?(i=e.filter(n=>!t.some(o=>s(o,n))),r=t.filter(n=>!e.some(o=>s(o,n)))):(i=e.filter(n=>!t.includes(n)),r=t.filter(n=>!e.includes(n))),{added:i,removed:r}}function Dut(t){return t&&typeof t.length=="number"}let voe=class{constructor(){this.last=0}};const boe=new voe;function LL(t,e,s,i){i=i||boe;const r=Math.max(0,i.last-10);for(let o=r;o<s;++o)if(t[o]===e)return i.last=o,o;const n=Math.min(r,s);for(let o=0;o<n;++o)if(t[o]===e)return i.last=o,o;return-1}function YSe(t,e,s,i){const r=t.length,n=LL(t,e,r,i);if(n!==-1)return t[n]=t[r-1],t.pop(),e}const Ku=new Set;function XSe(t,e,s=t.length,i=e.length,r,n){if(i===0||s===0)return s;Ku.clear();for(let a=0;a<i;++a)Ku.add(e[a]);r=r||boe;const o=Math.max(0,r.last-10);for(let a=o;a<s;++a)if(Ku.has(t[a])&&(n==null||n.push(t[a]),Ku.delete(t[a]),t[a]=t[s-1],--s,--a,Ku.size===0||s===0))return Ku.clear(),s;for(let a=0;a<o;++a)if(Ku.has(t[a])&&(n==null||n.push(t[a]),Ku.delete(t[a]),t[a]=t[s-1],--s,--a,Ku.size===0||s===0))return Ku.clear(),s;return Ku.clear(),s}function Rut(t,e,s){const i=t.length;if(e>=i)return t.slice();const r=oz(s),n=new Set,o=[];for(;o.length<e;){const a=Math.floor(r()*i);n.has(a)||(n.add(a),o.push(t[a]))}return o}function oz(t){return t?(FX.seed=t,()=>FX.getFloat()):Math.random}const FX=new IM;function xoe(t,e){const s=oz(e);for(let i=t.length-1;i>0;i--){const r=Math.floor(s()*(i+1)),n=t[i];t[i]=t[r],t[r]=n}return t}function woe(t,e){const s=t.indexOf(e);return s!==-1?(t.splice(s,1),e):null}function Qa(t,e){return t!=null}const kut=[];function Fut(t){return t instanceof ArrayBuffer}function az(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int8Array"}function Soe(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8Array"}function Eoe(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8ClampedArray"}function lz(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int16Array"}function Coe(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint16Array"}function uz(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int32Array"}function Poe(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint32Array"}function ID(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float32Array"}function MD(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float64Array"}function Toe(t){return"buffer"in t}const Ioe=1024;function Out(t){return MD(t)||ID(t)||uz(t)||lz(t)||az(t)}function Lut(t){return MD(t)||ID(t)}function Vut(t){return MD(t)?179769e303:ID(t)?3402823e32:Poe(t)?4294967295:Coe(t)?65535:Soe(t)||Eoe(t)?255:uz(t)?2147483647:lz(t)?32767:az(t)?127:256}function WSe(t,e){let s;for(s in t)t.hasOwnProperty(s)&&t[s]===void 0&&delete t[s];return t}function he(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=Noe(t);if(e!=null)return e;if(_N(t))return t.clone();if(Moe(t))return t.map(he);if(Aoe(t))throw new Error("Trying to clone an unclonable Accessor instance");const s={};for(const i of Object.getOwnPropertyNames(t))s[i]=he(t[i]);return s}function VL(t){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const e=Noe(t);if(e!=null)return e;if(Moe(t)){let i=!0;const r=t.map(n=>{const o=VL(n);return n!=null&&o==null&&(i=!1),o});return i?r:null}if(_N(t))return t.clone();if(t instanceof File||t instanceof Blob)return t;if(Aoe(t))return null;const s=new(Object.getPrototypeOf(t)).constructor;for(const i of Object.getOwnPropertyNames(t)){const r=t[i],n=VL(r);if(r!=null&&n==null)return null;s[i]=n}return s}function _N(t){return typeof t.clone=="function"}function Moe(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function Aoe(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function OX(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function Noe(t){if(az(t)||Soe(t)||Eoe(t)||lz(t)||Coe(t)||uz(t)||Poe(t)||ID(t)||MD(t))return t.slice();if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[s,i]of t)e.set(s,he(i));return e}if(t instanceof Set){const e=new Set;for(const s of t)e.add(he(s));return e}return null}function cz(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof(t==null?void 0:t.getTime)=="function"&&typeof(e==null?void 0:e.getTime)=="function"&&t.getTime()===e.getTime()||!1}function Doe(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&TD(t,e):t instanceof Set?e instanceof Set&&QSe(t,e):t instanceof Map?e instanceof Map&&JSe(t,e):!!OX(t)&&OX(e)&&ZSe(t,e))}function ZSe(t,e){if(t===null||e===null)return!1;const s=Object.keys(t);if(e===null||Object.keys(e).length!==s.length)return!1;for(const i of s)if(t[i]!==e[i]||!Object.prototype.hasOwnProperty.call(e,i))return!1;return!0}function QSe(t,e){if(t.size!==e.size)return!1;for(const s of t)if(!e.has(s))return!1;return!0}function JSe(t,e){if(t.size!==e.size)return!1;for(const[s,i]of t){const r=e.get(s);if(r!==i||r===void 0&&!e.has(s))return!1}return!0}function hz(t,e,s=!1){return Roe(t,e,s)}function IC(t,e){if(e!=null)return e[t]||$oe(t.split("."),!1,e)}function Hn(t,e,s){const i=t.split("."),r=i.pop(),n=$oe(i,!0,s);n&&r&&(n[r]=e)}function LX(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const s=e;if(t.length!==s.length)return!0;for(let i=0;i<t.length;i++)if(LX(t[i],s[i]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const s in t)if(LX(t[s],e[s]))return!0;return!1}return t!==e}function $oe(t,e,s){let i=s;for(const r of t){if(i==null)return;if(!(r in i)){if(!e)return;i[r]={}}i=i[r]}return i}function Roe(t,e,s){return e?Object.keys(e).reduce((i,r)=>{let n=i[r],o=e[r];return n===o?i:n===void 0?(i[r]=he(o),i):(Array.isArray(o)||Array.isArray(i)?(n=n?Array.isArray(n)?i[r]=n.slice():i[r]=[n]:i[r]=[],o&&(Array.isArray(o)||(o=[o]),s?o.forEach(a=>{n.includes(a)||n.push(a)}):i[r]=o.slice())):o&&typeof o=="object"?i[r]=Roe(n,o,s):i.hasOwnProperty(r)&&!e.hasOwnProperty(r)||(i[r]=o),i)},t||{}):t}var Une;const Ds={apiKey:void 0,applicationName:"",applicationUrl:(Une=globalThis.location)==null?void 0:Une.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(hz(Ds,globalThis.esriConfig,!0),delete Ds.has),!Ds.assetsPath){{const t="4.32";Ds.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}Ds.defaultAssetsPath=Ds.assetsPath}const KSe=/\{([^}]+)\}/g;function VX(t){return t??""}function jc(t,e){return e?t.replaceAll(KSe,typeof e=="object"?(s,i)=>VX(IC(i,e)):(s,i)=>VX(e(i))):t}function qut(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,s=>e!=null&&e.includes(s)?s:`\\${s}`)}function koe(t){let e=0;for(let s=0;s<t.length;s++)e=(e<<5)-e+t.charCodeAt(s),e|=0;return e}let qX;function F_(t){return qX??(qX=new DOMParser),qX.parseFromString(t||"","text/html").body.innerText||""}function GX(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function Gut(t,...e){let s=t[0];for(let i=0;i<e.length;++i)s+=e[i]+t[i+1];return s}const zX={info:0,warn:1,error:2,none:3};let Ne=class vl{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,vl._loggers.set(this.module,this);const s=this.module.lastIndexOf(".");s!==-1&&(this._parent=vl.getLogger(this.module.slice(0,s)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,vl._loggers.get(e)||new vl({module:e})}_log(e,s,...i){if(this._matchLevel(e)){if(s!=="always"&&!vl._throttlingDisabled){const r=tEe(i),n=this._loggedMessages[e].get(r);if(s==="once"&&n!=null||s==="oncePerTick"&&n&&n>=vl._tickCounter)return;this._loggedMessages[e].set(r,vl._tickCounter),vl._scheduleTickCounterIncrement()}for(const r of Ds.log.interceptors)if(r(e,this.module,...i))return;this._inheritedWriter()(e,this.module,...i)}}_parentWithMember(e,s){let i=this;for(;i!=null;){const r=i[e];if(r!=null)return r;i=i.parent}return s}_inheritedWriter(){return this._parentWithMember("writer",eEe)}_matchLevel(e){const s=Ds.log.level||"warn";return zX[this._parentWithMember("level",s)]<=zX[e]}static _scheduleTickCounterIncrement(){vl._tickCounterScheduled||(vl._tickCounterScheduled=!0,Promise.resolve().then(()=>{vl._tickCounter++,vl._tickCounterScheduled=!1}))}};function eEe(t,e,...s){console[t](`[${e}]`,...s)}function tEe(...t){return koe(JSON.stringify(t,(s,i)=>typeof i!="object"||Array.isArray(i)?i:"[Object]"))}Ne._loggers=new Map,Ne._tickCounter=0,Ne._tickCounterScheduled=!1,Ne._throttlingDisabled=!1;function sEe(t,e){for(const s of t.values())if(e(s))return!0;return!1}function zut(t,e){for(const s of t.values())if(e(s))return s;return null}function Zb(t,e,s){const i=t.get(e);if(i!==void 0)return i;const r=s();return t.set(e,r),r}function Uut(t){const e=new Map;return s=>(e.has(s)||e.set(s,t(s)),e.get(s))}const Uv=()=>Ne.getLogger("esri.core.accessorSupport.ensureTypes");function iEe(t){return t==null?t:new Date(t)}function rEe(t){return t==null?t:!!t}function MC(t){return t==null?t:t.toString()}function ma(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function mz(t){return t==null?t:Math.round(parseFloat(t))}function nEe(t){return null}function oEe(t,e){return s=>{let i=t(s);return e.step!=null&&(i=Math.round(i/e.step)*e.step),e.min!=null&&(i=Math.max(e.min,i)),e.max!=null&&(i=Math.min(e.max,i)),i}}function Foe(t){return(t==null?void 0:t.constructor)&&t.constructor.__accessorMetadata__!==void 0}function vN(t,e){return e!=null&&t&&!(e instanceof t)}function Ooe(t){return t&&"isCollection"in t}function UX(t){return t!=null&&t.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function aEe(t,e){if(!(e!=null&&e.constructor)||!Ooe(e.constructor))return qL(t,e)?e:new t(e);const s=UX(t.prototype.itemType),i=UX(e.constructor.prototype.itemType);return s?i?s===i?e:s.prototype.isPrototypeOf(i.prototype)?new t(e):(qL(t,e),e):new t(e):e}function qL(t,e){return!!Foe(e)&&(Uv().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+AD(t)+"'"),!0)}function Qb(t,e){return e==null?e:Ooe(t)?aEe(t,e):vN(t,e)?qL(t,e)?e:new t(e):e}function AD(t){var e;return((e=t==null?void 0:t.prototype)==null?void 0:e.declaredClass)||"unknown"}const lEe=new WeakMap;function uEe(t){switch(t){case Number:return e=>ma(e);case fs:return mz;case Boolean:return rEe;case String:return MC;case Date:return iEe;case ND:return nEe;default:return Zb(lEe,t,()=>Qb.bind(null,t))}}function nn(t,e){const s=uEe(t);return arguments.length===1?s:s(e)}function xE(t,e,s){return arguments.length===1?xE.bind(null,t):e&&(Array.isArray(e)?e.map(i=>t(i,s)):[t(e,s)])}function cEe(t,e){return arguments.length===1?xE(s=>nn(t,s)):xE(s=>nn(t,s),e)}function Loe(t,e,s){return e!==0&&Array.isArray(s)?s.map(i=>Loe(t,e-1,i)):t(s)}function bN(t,e,s){if(arguments.length===2)return n=>bN(t,e,n);if(!s)return s;s=Loe(t,e,s);let i=e,r=s;for(;i>0&&Array.isArray(r);)i--,r=r[0];if(r!==void 0)for(let n=0;n<i;n++)s=[s];return s}function hEe(t,e,s){return arguments.length===2?bN(i=>nn(t,i),e):bN(i=>nn(t,i),e,s)}function Voe(t){return!!Array.isArray(t)&&!t.some(e=>{const s=typeof e;return!(s==="string"||s==="number"||s==="function"&&t.length>1)})}function GL(t,e){if(arguments.length===2)return GL(t).call(null,e);const s=new Set,i=t.filter(a=>typeof a!="function"),r=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||s.add(a);let n=null,o=null;return(a,l)=>{if(a==null)return a;const u=typeof a,c=u==="string"||u==="number";return c&&(s.has(a)||r.some(h=>u==="string"&&h===String||u==="number"&&h===Number))||u==="object"&&r.some(h=>!vN(a,h))?a:(c&&i.length?(n||(n=i.map(h=>typeof h=="string"?`'${h}'`:`${h}`).join(", ")),Uv().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${n}`)):typeof a=="object"&&r.length?(o||(o=r.map(h=>AD(h)).join(", ")),Uv().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):Uv().error("Accessor#set",`'${a}' is not a valid value for this property`),l&&(l.valid=!1),null)}}function Hc(t,e){if(arguments.length===2)return Hc(t).call(null,e);const s={},i=[],r=[];for(const l in t.typeMap){const u=t.typeMap[l];s[l]=nn(u),i.push(AD(u)),r.push(l)}const n=()=>`'${i.join("', '")}'`,o=()=>`'${r.join("', '")}'`,a=typeof t.key=="string"?l=>l[t.key]:t.key;return l=>{if(t.base&&!vN(t.base,l)||l==null)return l;const u=a(l)||t.defaultKeyValue,c=s[u];if(!c)return Uv().error("Accessor#set",`Invalid property value, value needs to be one of ${n()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!vN(t.typeMap[u],l))return l;if(typeof t.key=="string"&&!Foe(l)){const h={};for(const m in l)m!==t.key&&(h[m]=l[m]);return c(h)}return c(l)}}let fs=class{},ND=class{};const Hut={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function mEe(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function qoe(t){switch(t.type){case"native":return nn(t.value);case"array":return xE(qoe(t.value));case"one-of":return dEe(t);default:return null}}function dEe(t){let e=null;return(s,i)=>UL(s,t)?s:(e==null&&(e=zL(t)),Uv().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),i&&(i.valid=!1),null)}function zL(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case fs:return"integer";case Date:return"date";case ND:return"null";default:return AD(t.value)}case"array":return`array of ${zL(t.value)}`;case"one-of":{const e=t.values.map(s=>zL(s));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function UL(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case fs:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case ND:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(s=>!UL(s,e.value));case"one-of":return e.values.some(s=>UL(t,s))}}const pEe={remove:()=>{}};function xs(t){return t?{remove(){t&&(t(),t=void 0)}}:pEe}function Goe(t){t.forEach(e=>e==null?void 0:e.remove())}function Yut(t){Goe(t),t.length=0}function AC(t){return xs(()=>Goe(t))}function Xut(t){return xs(()=>{var e;return(e=t())==null?void 0:e.remove()})}function Wut(t){return xs(()=>t==null?void 0:t.abort())}function fEe(t){return xs(t!=null?()=>t.destroy():void 0)}function Ja(t){return t.__accessor__??null}function gEe(t,e){var s;return((s=t==null?void 0:t.metadata)==null?void 0:s[e])!=null}function MM(t,e,s){return s?xN(t,e,{policy:s,path:""}):xN(t,e,null)}function xN(t,e,s){return e?Object.keys(e).reduce((i,r)=>{const n=r;let o=null,a="merge";if(s&&(o=s.path?`${s.path}.${r}`:r,a=s.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(i[n]))return i[n]=e[n],i;if(i[n]===void 0)return i[n]=he(e[n]),i;let l=i[n],u=e[n];if(l===u)return i;if(Array.isArray(u)||Array.isArray(i))l=l?Array.isArray(l)?i[n]=l.slice():i[n]=[l]:i[n]=[],u&&(Array.isArray(u)||(u=[u]),u.forEach(c=>{l.includes(c)||l.push(c)}));else if(u&&typeof u=="object")if(s){const c=s.path;s.path=o,i[n]=xN(l,u,s),s.path=c}else i[n]=xN(l,u,null);else i.hasOwnProperty(r)&&!e.hasOwnProperty(r)||(i[n]=u);return i},t||{}):t}function zoe(t){return Array.isArray(t)?t:t.split(".")}function BX(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function yEe(t){if(Array.isArray(t)){const e=[];for(const s of t)e.push(...BX(s));return e}return BX(t)}function Uoe(t,e,s,i){const r=yEe(e);if(r.length!==1){const n=r.map(o=>i(t,o,s));return AC(n)}return i(t,r[0],s)}function Boe(t,e){const s=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const r=parseInt(s,10);if(!isNaN(r))return Array.isArray(e)?e[r]:e.at(r)}const i=Ja(e);return gEe(i,s)?i.get(s):e[s]}function joe(t,e,s){if(t==null)return t;const i=Boe(e[s],t);return!i&&s<e.length-1?void 0:s===e.length-1?i:joe(i,e,s+1)}function NC(t,e,s=0){return typeof e!="string"||e.includes(".")?joe(t,zoe(e),s):Boe(e,t)}function Xa(t,e){return NC(t,e)}function jX(t,e){return NC(e,t)!==void 0}function DC(t){let e=t.constructor.__accessorMetadata__;const s=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!s){e=Object.create(e);for(const i in e)e[i]=he(e[i]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function DD(t,e){const s=DC(t);let i=s[e];return i||(i=s[e]={}),i}function _Ee(t,e){return MM(t,e,bEe)}const vEe=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function bEe(t){return vEe.test(t)?"replace":"merge"}function xEe(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(s,i)=>i===""?"$":(IC(i,e)??"").toString())}let Hoe=class{constructor(e,s,i=void 0){this.name=e,this.details=i,this.message=(s&&xEe(s,i))??""}toString(){return"["+this.name+"]: "+this.message}},ae=class Yoe extends Hoe{constructor(e,s,i){super(e,s,i)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,s)=>{if(s&&typeof s=="object"&&typeof s.toJSON=="function")return s;try{return he(s)}catch{return"[object]"}}))}}catch(e){throw Ne.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new Yoe(e.name,e.message,e.details)}};ae.prototype.type="error";function wN(t,e,s){if(t&&e)if(typeof e=="object")for(const i of Object.getOwnPropertyNames(e))wN(t,i,e[i]);else{if(e.includes(".")){const r=e.split("."),n=r.splice(-1,1)[0];return void wN(Xa(t,r),n,s)}const i=t.__accessor__;i!=null&&wEe(e,i),t[e]=s}}function wEe(t,e){if(ge("esri-unknown-property-errors")&&!SEe(t,e))throw new ae("set:unknown-property",EEe(t,e))}function SEe(t,e){return e.metadata[t]!=null}function EEe(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}function _(t={}){return(e,s)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${s}. Accessor does not support static properties.`);const i=Object.getOwnPropertyDescriptor(e,s),r=DD(e,s);i&&(i.get||i.set?(r.get=i.get||r.get,r.set=i.set||r.set):"value"in i&&("value"in t&&Ne.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${s}" on "${e.constructor.name}" already defined in the metadata`,t),r.value=t.value=i.value)),t.readOnly!=null&&(r.readOnly=t.readOnly);const n=t.aliasOf;if(n){const l=typeof n=="string"?n:n.source,u=typeof n=="string"?null:n.overridable===!0;let c;r.dependsOn=[l],r.get=function(){let h=Xa(this,l);if(typeof h=="function"){c||(c=l.split(".").slice(0,-1).join("."));const m=Xa(this,c);m&&(h=h.bind(m))}return h},r.readOnly||(r.set=u?function(h){this._override(s,h)}:function(h){wN(this,l,h)})}const o=t.type,a=t.types;if(!r.cast){let l;o?l=CEe(o):a&&(l=Array.isArray(a)?xE(Hc(a[0])):Hc(a)),t.cast=PEe(t.cast,l)}_Ee(r,t),t.range&&(r.cast=oEe(r.cast,t.range))}}function Xoe(t,e,s){const i=DD(t,s);i.json||(i.json={});let r=i.json;return e!==void 0&&(r.origins||(r.origins={}),r.origins[e]||(r.origins[e]={}),r=r.origins[e]),r}function CEe(t){let e=0,s=t;if(mEe(t))return qoe(t);for(;Array.isArray(s)&&s.length===1&&typeof s[0]!="string"&&typeof s[0]!="number";)s=s[0],e++;const i=s;if(Voe(i))return e===0?GL(i):bN(GL(i),e);if(e===1)return cEe(i);if(e>1)return hEe(i,e);const r=t;return r.from?r.from:nn(r)}function PEe(t,e){if(t||e)return t?e?(s,i)=>e(t(s,i),i):t:e}const Woe=Symbol("Accessor-beforeDestroy");var Ba;(function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.CONSTRUCTED=2]="CONSTRUCTED",t[t.DESTROYED=3]="DESTROYED"})(Ba||(Ba={}));var qs;(function(t){t[t.Dirty=1]="Dirty",t[t.Overridden=2]="Overridden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"})(qs||(qs={}));let $D=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){var e;(e=this.accessed)==null||e.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const SN=new $D,f2=[];let GS=SN;function lt(t){GS.onAccessed(t)}let AM=!1,NM=!1;function Cd(t,e,s){if(AM)return dz(t,e,s);let i=null;return Zoe(t),i=e.call(s),Qoe(),i}function TEe(t,e){return Cd(SN,t,e)}function dz(t,e,s){const i=AM;AM=!0,Zoe(t);let r=null;try{r=e.call(s)}catch(n){NM&&Ne.getLogger("esri.core.accessorSupport.tracking").error(n)}return Qoe(),AM=i,r}function Zoe(t){GS=t,f2.push(t)}function Qoe(){const t=f2.length;if(t>1){const e=f2.pop();GS=f2[t-2],e.onTrackingEnd()}else if(t===1){const e=f2.pop();GS=SN,e.onTrackingEnd()}else GS=SN}function Joe(t,e){if(e.flags&qs.DepTrackingInitialized)return;e.flags|=qs.DepTrackingInitialized;const s=NM;NM=!1,e.flags&qs.AutoTracked?dz(e.trackingTarget,e.metadata.get,t):Koe(t,e),NM=s}const IEe=[];function Koe(t,e){e.flags&qs.ExplicitlyTracking||(e.flags|=qs.ExplicitlyTracking,dz(e.trackingTarget,()=>{const s=e.metadata.dependsOn||IEe;for(const i of s)if(typeof i!="string"||i.includes(".")){const r=zoe(i);for(let n=0,o=t;n<r.length&&o!=null&&typeof o=="object";++n)o=HX(o,r[n],n!==r.length-1)}else HX(t,i,!1)}),e.flags&=~qs.ExplicitlyTracking)}function HX(t,e,s){const i=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(t)?t[n]:t.at(n)}const r=Ja(t);if(r){const n=r.propertiesByName.get(i);n&&(lt(n),Joe(t,n))}return s?t[i]:void 0}function MEe(t){if(t.json&&t.json.origins){const e=t.json.origins,s={"web-document":["web-scene","web-map"]};for(const i in s)if(e[i]){const r=e[i];s[i].forEach(n=>{e[n]=r}),delete e[i]}}}let qu=class extends Hoe{constructor(e,s,i){super(e,s,i)}};qu.prototype.type="warning";function eae(t){var e;return!!t&&((e=t.prototype)==null?void 0:e.declaredClass)&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}const BL=()=>Ne.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function YX(t,e,s){var i,r;t&&(!s&&!e.read||(i=e.read)!=null&&i.reader||((r=e.read)==null?void 0:r.enabled)===!1||DEe(t)&&Hn("read.reader",Jb(t),e))}function Jb(t){var s,i;const e=t.ndimArray??0;if(e>1)return NEe(t);if(e===1)return XX(t);if("type"in t&&sae(t.type)){const r=(i=(s=t.type.prototype)==null?void 0:s.itemType)==null?void 0:i.Type,n=XX(typeof r=="function"?{type:r}:{types:r});return(o,a,l)=>{const u=n(o,a,l);return u&&new t.type(u)}}return pz(t)}function pz(t){return"type"in t?AEe(t.type):$Ee(t.types)}function AEe(t){return t.prototype.read?(e,s,i)=>{if(e==null)return e;const r=typeof e;if(r!=="object")return void BL().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${r}'`);const n=new t;return n.read(e,i),n}:t.fromJSON}function tae(t,e,s,i){return i!==0&&Array.isArray(e)?e.map(r=>tae(t,r,s,i-1)):t(e,void 0,s)}function NEe(t){const e=pz(t),s=tae.bind(null,e),i=t.ndimArray??0;return(r,n,o)=>{if(r==null)return r;r=s(r,o,i);let a=i,l=r;for(;a>0&&Array.isArray(l);)a--,l=l[0];if(l!==void 0)for(let u=0;u<a;u++)r=[r];return r}}function XX(t){const e=pz(t);return(s,i,r)=>{if(s==null)return s;if(Array.isArray(s)){const o=[];for(const a of s){const l=e(a,void 0,r);l!==void 0&&o.push(l)}return o}const n=e(s,void 0,r);return n!==void 0?[n]:void 0}}function sae(t){if(!eae(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?fz(e.Type):iae(e.Type))}function DEe(t){return"types"in t?iae(t.types):fz(t.type)}function fz(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||sae(t))}function iae(t){for(const e in t.typeMap)if(!fz(t.typeMap[e]))return!1;return!0}function $Ee(t){let e=null;const s=t.errorContext??"type",i=t.validate;return(r,n,o)=>{if(r==null)return r;const a=typeof r;if(a!=="object")return void BL().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=REe(t));const l=t.key;if(typeof l!="string")return;const u=r[l],c=u?e[u]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!c){const m=`Type '${u||"unknown"}' is not supported`;return o!=null&&o.messages&&r&&o.messages.push(new qu(`${s}:unsupported`,m,{definition:r,context:o})),void BL().error(m)}const h=new c;return h.read(r,o),i?i(h):h}}function REe(t){var s,i;const e={};for(const r in t.typeMap){const n=t.typeMap[r],o=DC(n.prototype);if(typeof t.key=="function")continue;const a=o[t.key];if(!a)continue;if((s=a.json)!=null&&s.type&&Array.isArray(a.json.type)&&a.json.type.length===1&&typeof a.json.type[0]=="string"){e[a.json.type[0]]=n;continue}const l=(i=a.json)==null?void 0:i.write;if(!(l!=null&&l.writer)){e[r]=n;continue}const u=l.target,c=typeof u=="string"?u:t.key,h={};l.writer(r,h,c),h[c]&&(e[h[c]]=n)}return e}function kEe(t){if(t.json||(t.json={}),ZX(t.json),QX(t.json),WX(t.json),t.json.origins)for(const e in t.json.origins)ZX(t.json.origins[e]),QX(t.json.origins[e]),WX(t.json.origins[e]);return!0}function WX(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function ZX(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function QX(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function JX(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const s=(t==null?void 0:t.ndimArray)??0;t&&(s===1||"type"in t&&eae(t.type))?e.write.writer=LEe:s>1?e.write.writer=VEe(s):e.types?Array.isArray(e.types)?e.write.writer=OEe(e.types[0]):e.write.writer=FEe(e.types):e.write.writer=wE}function FEe(t){return(e,s,i,r)=>e?rae(e,t,r)?wE(e,s,i,r):void 0:wE(e,s,i,r)}function rae(t,e,s){for(const i in e.typeMap)if(t instanceof e.typeMap[i])return!0;if(s!=null&&s.messages){const i=e.errorContext??"type",r=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;s&&s.messages&&t&&s.messages.push(new ae(`${i}:unsupported`,r,{definition:t,context:s})),Ne.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(r)}return!1}function OEe(t){return(e,s,i,r)=>!e||!Array.isArray(e)?wE(e,s,i,r):wE(e.filter(n=>rae(n,t,r)),s,i,r)}function wE(t,e,s,i){Hn(s,EN(t,i),e)}function EN(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?CN(t):t}function CN(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function LEe(t,e,s,i){let r;t===null?r=null:t&&typeof t.map=="function"?(r=t.map(n=>EN(n,i)),typeof r.toArray=="function"&&(r=r.toArray())):r=[EN(t,i)],Hn(s,r,e)}function nae(t,e,s){return s!==0&&Array.isArray(t)?t.map(i=>nae(i,e,s-1)):EN(t,e)}function VEe(t){return(e,s,i,r)=>{let n;if(e===null)n=null;else{n=nae(e,r,t);let o=t,a=n;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let l=0;l<o;l++)n=[n]}Hn(i,n,s)}}function qEe(t,e){return gz(t,"any",e==null?void 0:e.origin)}function jL(t,e){return gz(t,"read",e==null?void 0:e.origin)}function oae(t,e){return gz(t,"write",e==null?void 0:e.origin)}function gz(t,e,s){let i=t==null?void 0:t.json;if(i!=null&&i.origins&&s){let r;r=s==="link-chart"?i.origins[s]&&(e==="any"||e in i.origins[s])?i.origins[s]:i.origins["web-map"]:i.origins[s],r&&(e==="any"||e in r)&&(i=r)}return i}function GEe(t){var s;const e=zEe(t);if(t.json.origins)for(const i in t.json.origins){const r=t.json.origins[i],n=r.types?UEe(r):e;YX(n,r,!1),r.types&&!r.write&&((s=t.json.write)!=null&&s.enabled)&&(r.write={...t.json.write}),JX(n,r)}YX(e,t.json,!0),JX(e,t.json)}function zEe(t){return t.json.types?HL(t.json):t.type?aae(t):HL(t)}function UEe(t){return t.type?aae(t):HL(t)}function aae(t){if(!t.type)return;let e=0,s=t.type;for(;Array.isArray(s)&&!Voe(s);)s=s[0],e++;return{type:s,ndimArray:e}}function HL(t){if(!t.types)return;let e=0,s=t.types;for(;Array.isArray(s);)s=s[0],e++;return{types:s,ndimArray:e}}function BEe(t){kEe(t)&&(MEe(t),GEe(t))}const i4=new Set,r4=new Set;function Q(t){return e=>{t??(t="esri.core.Accessor"),e.prototype.declaredClass=t,HEe(e);const s=[],i=[];let r=e.prototype;for(;r;)r.hasOwnProperty("initialize")&&!i4.has(r.initialize)&&(i4.add(r.initialize),s.push(r.initialize)),r.hasOwnProperty("destroy")&&!r4.has(r.destroy)&&(r4.add(r.destroy),i.push(r.destroy)),r=Object.getPrototypeOf(r);i4.clear(),r4.clear();const n=class extends e{constructor(...a){if(super(...a),this.constructor===n&&typeof this.postscript=="function"){if(s.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let l=s.length-1;l>=0;l--)s[l].call(this)}}),i.length){let l=!1;const u=this[Woe];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!l){l=!0,u.call(this);for(let c=0;c<i.length;c++)i[c].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};n.__accessorMetadata__=DC(e.prototype),n.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(n,"name",{value:o,configurable:!0}),n}}function jEe(t,e){return e.get==null?function(){const s=this.__accessor__,i=s.propertiesByName.get(t);if(i===void 0)return;s.mutable&&lt(i);const r=s.store;return r.has(t)?r.get(t):i.metadata.value}:function(){const s=this.__accessor__,i=s.propertiesByName.get(t);if(i!==void 0)return i.getComputed(s)}}function HEe(t){const e=t.prototype,s=DC(e),i={};for(const r of Object.getOwnPropertyNames(s)){const n=s[r];BEe(n),i[r]={enumerable:!0,configurable:!0,get:jEe(r,n),set(o){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&n.readOnly?KX("read-only",r):a.lifecycle===Ba.CONSTRUCTED&&n.constructOnly?KX("construct-only",r):void a.set(r,o)}else Object.defineProperty(this,r,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,i)}const KX=(t,e)=>{Ne.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)},YEe="modulepreload",XEe=function(t){return"/Agriculture-land/"+t},eW={},me=function(e,s,i){let r=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(s.map(l=>{if(l=XEe(l),l in eW)return;eW[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":YEe,u||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((m,f)=>{h.addEventListener("load",m),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return e().catch(n)})},tW=new WeakMap;function WEe(t,e,s=!1){const i=`🛑 DEPRECATED - ${e}`;if(!s)return void t.warn(i);let r=tW.get(t);r||(r=new Set,tW.set(t,r)),r.has(e)||(r.add(e),t.warn(i))}function ZEe(t,e,s={}){if(ge("esri-deprecation-warnings")){const{moduleName:i}=s;SE(t,`Function: ${(i?i+"::":"")+e+"()"}`,s)}}function QEe(t,e,s={}){if(ge("esri-deprecation-warnings")){const{moduleName:i}=s;SE(t,`Property: ${(i?i+"::":"")+e}`,s)}}function JEe(t,e,s={}){ge("esri-deprecation-warnings")&&SE(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...s})}function SE(t,e,s={}){if(ge("esri-deprecation-warnings")){const{replacement:i,version:r,see:n,warnOnce:o}=s;let a=e;if(i&&(a+=`
	🛠️ Replacement: ${i}`),r&&(a+=`
	⚙️ Version: ${r}`),n)if(Array.isArray(n)){a+=`
	🔗 See for more details:`;for(const l of n)a+=`
		${l}`}else a+=`
	🔗 See ${n} for more details.`;WEe(t,a,o)}}function Kut(t){const e=[];return function*(){yield*e;for(const s of t)e.push(s),yield s}}function KEe(t,e){for(const s of t)if(s!=null&&e(s))return s}function PN(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let Kb=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(s=>{e+=s.length}),e}add(e,s){if(PN(e)){const i=this._getOrCreateGroup(s);for(const r of e)iW(r)&&i.push(r)}else iW(e)&&this._getOrCreateGroup(s).push(e);return this}forEach(e,s){if(typeof e=="function")this._groups.forEach(i=>i.forEach(e));else{const i=this._getGroup(e);i&&s&&i.forEach(s)}}has(e){return this._groups.has(BT(e))}remove(e){if(typeof e!="string"&&PN(e)){for(const s of e)this.remove(s);return this}return this.has(e)?(sW(this._getGroup(e)),this._groups.delete(BT(e)),this):this}removeAll(){return this._groups.forEach(sW),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const s=[];return this._groups.set(BT(e),s),s}_getGroup(e){return this._groups.get(BT(e))}};function BT(t){return t||"_default_"}function sW(t){for(const e of t)e instanceof Kb?e.removeAll():e.remove()}function iW(t){return t!=null&&(!!t.remove||t instanceof Kb)}function $C(t,e){if(t==null)throw new Error(e??"value is None")}function ii(t){return t==null||t.destroy(),null}function tct(t){return t==null||t.dispose(),null}function qi(t){return t==null||t.remove(),null}function Do(t){return t==null||t.abort(),null}function sct(t){return t==null||t.release(),null}function eCe(t,e,s){return t!=null&&e!=null?s!=null?s(t,e):t.equals(e):t===e}function tCe(t,e){let s;return t.some((i,r)=>(s=e(i,r),s!=null)),s??void 0}function sCe(t){return(t==null?void 0:t.release)&&typeof t.release=="function"}function iCe(t){return(t==null?void 0:t.acquire)&&typeof t.acquire=="function"}let mg=class YL{constructor(e,s,i,r=1,n=0){this._ctor=e,this._acquireFunction=s,this._releaseFunction=i,this.allocationSize=r,this._pool=new Array(n),this._initialSize=n;for(let o=0;o<n;o++)this._pool[o]=new this._ctor;this.allocationSize=Math.max(r,1)}destroy(){this.prune(0)}acquire(...e){let s;if(YL.test.disabled)s=new this._ctor;else{if(this._pool.length===0){const i=this.allocationSize;for(let r=0;r<i;r++)this._pool[r]=new this._ctor}s=this._pool.pop()}return this._acquireFunction?this._acquireFunction(s,...e):iCe(s)&&s.acquire(...e),s}release(e){e&&!YL.test.disabled&&(this._releaseFunction?this._releaseFunction(e):sCe(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let s=e;s<this._pool.length;++s){const i=this._pool[s];this._dispose(i)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}};mg.test={disabled:!1};let rCe=class{constructor(e,s){this._observers=e,this._observer=s}remove(){woe(this._observers,this._observer)}},lae=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return nCe;this._observers==null&&(this._observers=[]);const s=this._observers;let i=!1,r=!1;const n=s.length;for(let o=0;o<n;++o){const a=s[o];if(a.destroyed)r=!0;else if(a===e){i=!0;break}}return i||(s.push(e),r&&this._removeDestroyedObservers()),new rCe(s,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const s=e.length;let i=0;for(let r=0;r<s;++r){for(;r+i<s&&e[r+i].destroyed;)++i;if(i>0){if(!(r+i<s))break;e[r]=e[r+i]}}e.length=s-i}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const s of e)s.onCommitted();this._observers=null}}};const nCe=xs();var Xt;(function(t){t[t.DEFAULTS=0]="DEFAULTS",t[t.COMPUTED=1]="COMPUTED",t[t.SERVICE=2]="SERVICE",t[t.PORTAL_ITEM=3]="PORTAL_ITEM",t[t.WEB_SCENE=4]="WEB_SCENE",t[t.WEB_MAP=5]="WEB_MAP",t[t.LINK_CHART=6]="LINK_CHART",t[t.USER=7]="USER"})(Xt||(Xt={}));const XL=Xt.USER+1;function Tf(t){switch(t){case"defaults":return Xt.DEFAULTS;case"service":return Xt.SERVICE;case"portal-item":return Xt.PORTAL_ITEM;case"web-scene":return Xt.WEB_SCENE;case"web-map":return Xt.WEB_MAP;case"link-chart":return Xt.LINK_CHART;case"user":return Xt.USER;default:return null}}function TN(t){switch(t){case Xt.DEFAULTS:return"defaults";case Xt.SERVICE:return"service";case Xt.PORTAL_ITEM:return"portal-item";case Xt.WEB_SCENE:return"web-scene";case Xt.WEB_MAP:return"web-map";case Xt.LINK_CHART:return"link-chart";case Xt.USER:return"user"}}function oCe(t){return TN(t)}let rW=class extends lae{constructor(e,s){super(),this.propertyName=e,this.metadata=s,this.trackingTarget=new $D(this),this.flags=0,this.flags=qs.Dirty|(s.nonNullable?qs.NonNullable:0)|(s.hasOwnProperty("value")?qs.HasDefaultValue:0)|(s.get===void 0?qs.DepTrackingInitialized:0)|(s.dependsOn===void 0?qs.AutoTracked:0)}destroy(){this.flags&qs.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&lt(this);const s=e.store,i=this.propertyName,r=this.flags,n=s.get(i);if(r&qs.Computing||~r&qs.Dirty&&s.has(i))return n;this.flags|=qs.Computing;const o=e.host;let a;r&qs.AutoTracked?a=Cd(this.trackingTarget,this.metadata.get,o):(Koe(o,this),a=this.metadata.get.call(o)),this.flags|=qs.DepTrackingInitialized,s.set(i,a,Xt.COMPUTED);const l=s.get(i);return l===n?this.flags&=~qs.Dirty:TEe(this.commit,this),this.flags&=~qs.Computing,l}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=~qs.Dirty,this.onCommitted()}onInvalidated(){~this.flags&qs.Overridden&&(this.flags|=qs.Dirty);const e=this._observers;if(e&&e.length>0)for(const s of e)s.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const s=e.slice();for(const i of s)i.onCommitted()}}},aCe=class uae{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const s=new uae;return this._values.forEach((i,r)=>{e&&e.has(r)||s.set(r,he(i))}),s}get(e){return this._values.get(e)}originOf(){return Xt.USER}keys(){return[...this._values.keys()]}set(e,s){this._values.set(e,s)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}forEach(e){this._values.forEach(e)}};function jT(t,e,s){return t!==void 0}function nW(t,e,s,i){return t!==void 0&&(!(s==null&&t.flags&qs.NonNullable)||(i.lifecycle,Ba.INITIALIZING,!1))}let lCe=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=Ba.INITIALIZING,this.store=new aCe,this.mutable=!0,this._origin=Xt.USER;const s=this.host.constructor.__accessorMetadata__;for(const i in s){const r=new rW(i,s[i]);this.propertiesByName.set(i,r)}this.metadata=s}initialize(){this.lifecycle=Ba.CONSTRUCTING}constructed(){this.lifecycle=Ba.CONSTRUCTED}destroy(){this.lifecycle=Ba.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==Ba.INITIALIZING}get(e){const s=this.propertiesByName.get(e);if(s.metadata.get)return s.getComputed(this);this.mutable&&lt(s);const i=this.store;return i.has(e)?i.get(e):s.metadata.value}originOf(e){const s=this.store.originOf(e);if(s===void 0){const i=this.propertiesByName.get(e);if(i!==void 0&&i.flags&qs.HasDefaultValue)return"defaults"}return TN(s)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const s=this.propertiesByName.get(e);if(jT(s))return this.store.has(e)?this.store.get(e):s.metadata.value}internalSet(e,s){const i=this.propertiesByName.get(e);jT(i)&&this._internalSet(i,s)}getDependsInfo(e,s,i){const r=this.propertiesByName.get(s);if(!jT(r))return"";const n=new $D,o=Cd(n,()=>{var u;return(u=r.metadata.get)==null?void 0:u.call(e)});let a=`${i}${e.declaredClass.split(".").pop()}.${s}: ${o}
`;const l=n.accessed??new Set;if(l.size===0)return a;i+="  ";for(const u of l)u instanceof rW&&(a+=`${i}${u.propertyName}: undefined
`);return a}setAtOrigin(e,s,i){const r=this.propertiesByName.get(e);if(jT(r))return this._setAtOrigin(r,s,i)}isOverridden(e){const s=this.propertiesByName.get(e);return s!==void 0&&!!(s.flags&qs.Overridden)}clearOverride(e){const s=this.propertiesByName.get(e);s&&s.flags&qs.Overridden&&(s.flags&=~qs.Overridden,s.notifyChange())}override(e,s){const i=this.propertiesByName.get(e);if(!nW(i,e,s,this))return;const r=i.metadata.cast;if(r){const n=this._cast(r,s),{valid:o,value:a}=n;if(n4.release(n),!o)return;s=a}i.flags|=qs.Overridden,this._internalSet(i,s)}set(e,s){const i=this.propertiesByName.get(e);if(!nW(i,e,s,this))return;const r=i.metadata.cast;if(r){const o=this._cast(r,s),{valid:a,value:l}=o;if(n4.release(o),!a)return;s=l}const n=i.metadata.set;n?n.call(this.host,s):this._internalSet(i,s)}setDefaultOrigin(e){this._origin=Tf(e)}getDefaultOrigin(){return TN(this._origin)}notifyChange(e){const s=this.propertiesByName.get(e);s!==void 0&&s.notifyChange()}invalidate(e){const s=this.propertiesByName.get(e);s!==void 0&&s.invalidate()}commit(e){const s=this.propertiesByName.get(e);s!==void 0&&s.commit()}_internalSet(e,s){const i=this.lifecycle!==Ba.INITIALIZING?this._origin:Xt.DEFAULTS;this._setAtOrigin(e,s,i)}_setAtOrigin(e,s,i){const r=this.store,n=e.propertyName;r.has(n,i)&&cz(s,r.get(n))&&~e.flags&qs.Overridden&&i===r.originOf(n)||(e.invalidate(),r.set(n,s,i),e.commit(),Joe(this.host,e))}_cast(e,s){const i=n4.acquire();return i.valid=!0,i.value=s,e&&(i.value=e.call(this.host,s,i)),i}},uCe=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const n4=new mg(uCe);let cCe;function hCe(){return cCe}var oW;(function(t){t[t.Ignore=0]="Ignore",t[t.Destroy=1]="Destroy",t[t.ThrowError=2]="ThrowError"})(oW||(oW={}));function mCe(t){t.length=0}let da=class{constructor(e=50,s=50){this._pool=new mg(Array,void 0,mCe,s,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return o4.acquire()}static release(e){return o4.release(e)}static prune(){o4.prune()}};const o4=new da(100);let cae=class extends mg{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const s=super.acquire(...e);return this._set.delete(s),s}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const HT=[];function IN(t){HT.push(t),HT.length===1&&queueMicrotask(()=>{const e=HT.slice();HT.length=0;for(const s of e)s()})}let zS=class{constructor(e,s=30){this.name=e,this._counter=0,this._samples=new Array(s)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,s)=>e-s)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,s)=>e+s,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var WL;(function(t){const e=(n,o,a,l)=>{let u=o,c=o;const h=a>>>1,m=n[u-1];for(;c<=h;){c=u<<1,c<a&&l(n[c-1],n[c])<0&&++c;const f=n[c-1];if(l(f,m)<=0)break;n[u-1]=f,u=c}n[u-1]=m},s=(n,o)=>n<o?-1:n>o?1:0;function i(n,o,a,l){o===void 0&&(o=0),a===void 0&&(a=n.length),l===void 0&&(l=s);for(let c=a>>>1;c>o;c--)e(n,c,a,l);const u=o+1;for(let c=a-1;c>o;c--){const h=n[o];n[o]=n[c],n[c]=h,e(n,u,c,l)}}function*r(n,o,a,l){o===void 0&&(o=0),a===void 0&&(a=n.length),l===void 0&&(l=s);for(let c=a>>>1;c>o;c--)e(n,c,a,l),yield;const u=o+1;for(let c=a-1;c>o;c--){const h=n[o];n[o]=n[c],n[c]=h,e(n,u,c,l),yield}}t.sort=i,t.iterableSort=r})(WL||(WL={}));const aW=WL,dCe=1.5,pCe=1.1;let y_=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new voe,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>lW(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const s=new Array;for(let i=0;i<this._length;i++){const r=this.data[i];e(r)&&s.push(r)}return s}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,s){const i=this.data.indexOf(e,s);return i!==-1&&i<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let s=e;s<this._length;++s)this.data[s]=this._deallocator(this.data[s]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,s=e.length){for(let i=0;i<s;i++)this.data[this._length++]=e[i]}fill(e,s){for(let i=0;i<s;i++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,lW(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const s=LL(this.data,e,this.length,this._hint);if(s!==-1)return this.data.splice(s,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(LL(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,s=e.length,i){this.length=XSe(this.data,e,this.length,s,this._hint,i),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,s){if(e>=this.length||s>=this.length||e===s)return;const i=this.data[e];this.data[e]=this.data[s],this.data[s]=i}sort(e){aW.sort(this.data,0,this.length,e)}iterableSort(e){return aW.iterableSort(this.data,0,this.length,e)}some(e,s){for(let i=0;i<this.length;++i)if(e.call(s,this.data[i],i,this.data))return!0;return!1}find(e,s){const{data:i,length:r}=this;for(let n=0;n<r;++n)if(e.call(s,i[n]))return i[n]}filterInPlace(e,s){let i=0;for(let r=0;r<this._length;++r){const n=this.data[r];e.call(s,n,r,this.data)&&(this.data[r]=this.data[i],this.data[i]=n,i++)}if(this._deallocator)for(let r=i;r<this._length;r++)this.data[r]=this._deallocator(this.data[r]);return this._length=i,this._shrink(),this}forAll(e,s){const{data:i,length:r}=this;for(let n=0;n<r;++n)e.call(s,i[n],n,i)}forEach(e,s){this.data.slice(0,this.length).forEach(e,s)}map(e,s){const i=new Array(this.length);for(let r=0;r<this.length;++r)i[r]=e.call(s,this.data[r],r,this.data);return i}reduce(e,s){let i=s;for(let r=0;r<this.length;++r)i=e(i,this.data[r],r,this.data);return i}has(e){const s=this.length,i=this.data;for(let r=0;r<s;++r)if(i[r]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function lW(t){t.data.length>dCe*t.length&&(t.data.length=Math.floor(t.length*pCe))}function fCe(t){return{setTimeout:(e,s)=>{const i=t.setTimeout(e,s);return xs(()=>t.clearTimeout(i))}}}const ex=fCe(globalThis);function RD(t){return gCe(t)||hae(t)}function gCe(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function hae(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function RC(t,e,s){if(!RD(t))throw new TypeError("target is not a Evented or EventTarget object");return hae(t)?yCe(t,e,s):t.on(e,s)}function yCe(t,e,s,i){if(Array.isArray(e)){const r=e.slice();for(const n of r)t.addEventListener(n,s,i);return xs(()=>{for(const n of r)t.removeEventListener(n,s,i)})}return t.addEventListener(e,s,i),xs(()=>t.removeEventListener(e,s,i))}function mae(t,e,s){if(!RD(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,s);const i=RC(t,e,r=>{i.remove(),s.call(t,r)});return i}function xi(t="Aborted"){return new ae("AbortError",t)}function ni(t,e="Aborted"){if(Yl(t))throw xi(e)}function kC(t){return t instanceof AbortSignal?t:(t==null?void 0:t.signal)??void 0}function Yl(t){const e=kC(t);return e!=null&&e.aborted}function Nc(t){if(Lr(t))throw t}function ZL(t){if(!Lr(t))throw t}function Ou(t,e){const s=kC(t);if(s!=null){if(!s.aborted)return mae(s,"abort",()=>e());e()}}function yz(t,e){const s=kC(t);if(s!=null)return ni(s),mae(s,"abort",()=>e(xi()))}function _z(t,e){return kC(e)==null?t:new Promise((s,i)=>{let r=Ou(e,()=>i(xi()));const n=()=>{r=qi(r)};t.then(n,n),t.then(s,i)})}function Lr(t){return(t==null?void 0:t.name)==="AbortError"}async function zl(t){try{return await t}catch(e){if(!Lr(e))throw e;return}}async function Pd(t){if(!t)return;if(typeof t.forEach!="function"){const s=Object.keys(t),i=s.map(o=>t[o]),r=await Pd(i),n={};return s.map((o,a)=>n[o]=r[a]),n}const e=t;return Promise.allSettled(e).then(s=>Array.from(e,(i,r)=>{const n=s[r];return n.status==="fulfilled"?{promise:i,value:n.value}:{promise:i,error:n.reason}}))}async function _Ce(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function mct(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function FC(t,e=void 0,s){const i=new AbortController;return Ou(s,()=>i.abort()),new Promise((r,n)=>{let o=setTimeout(()=>{o=0,r(e)},t);Ou(i,()=>{o&&(clearTimeout(o),n(xi()))})})}function dct(t,e,s,i){const r=s&&"abort"in s?s:null;i!=null||r||(i=s);let n=setTimeout(()=>{n=0,r==null||r.abort()},e);const o=()=>i||new ae("promiseUtils:timeout","The wrapped promise did not resolve within "+e+" ms");return t.then(a=>{if(n===0)throw o();return clearTimeout(n),a},a=>{throw clearTimeout(n),n===0?o():a})}function vCe(t,e){const s=new AbortController,i=setTimeout(()=>s.abort(),e);return Ou(t,()=>{s.abort(),clearTimeout(i)}),{...t,signal:s.signal}}function sm(t){return t&&typeof t.then=="function"}function QL(t){return sm(t)?t:Promise.resolve(t)}function jh(t,e=-1){let s,i,r,n,o=null;const a=(...l)=>{if(s){i=l,n&&n.reject(xi()),n=Xl();const m=n.promise;if(o){const f=o;o=null,f.abort()}return m}if(r=n||Xl(),n=null,e>0){const m=new AbortController;s=QL(t(...l,m.signal));const f=s;FC(e).then(()=>{s===f&&(n?m.abort():o=m)})}else s=1,s=QL(t(...l));const u=()=>{const m=i;i=r=s=o=null,m!=null&&a(...m)},c=s,h=r;return c.then(u,u),c.then(h.resolve,h.reject),h.promise};return a}function Xl(){let t,e;const s=new Promise((r,n)=>{t=r,e=n}),i=r=>{t(r)};return i.resolve=r=>t(r),i.reject=r=>e(r),i.timeout=(r,n)=>ex.setTimeout(()=>i.reject(n),r),i.promise=s,i}async function uW(t){await Promise.resolve(),ni(t)}function pct(t){return t}function bCe(t){return 1e3*t}function fct(t){return t}function gct(t){return .001*t}let xCe=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},wCe=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},JL=0;const Dw={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},KL=["prepare","preRender","render","postRender","update","finish"],e5=[],O_=new y_;let SCe=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,dae()}};function ECe(){__!=null&&(cancelAnimationFrame(__),__=requestAnimationFrame(vz))}function dae(){__==null&&(JL=performance.now(),__=requestAnimationFrame(vz))}const MN={frameTasks:O_,willDispatch:!1,clearFrameTasks:CCe,dispatch:fae,executeFrameTasks:PCe,reschedule:ECe};function OC(t){const e=new wCe(t);return e5.push(e),MN.willDispatch||(MN.willDispatch=!0,IN(fae)),e}function fb(t){const e=new xCe(t);return O_.push(e),dae(),new SCe(e)}let __=null;function CCe(t=!1){O_.forAll(e=>{e.removed=!0}),t&&pae()}function vz(){const t=performance.now();__=null,__=O_.some(s=>!s.paused&&!s.removed)?requestAnimationFrame(vz):null,MN.executeFrameTasks(t)}function PCe(t){const e=t-JL;JL=t;const s=1e3/60,i=Math.max(0,e-s);Dw.time=t,Dw.frameDuration=s-i;for(let r=0;r<KL.length;r++){const n=performance.now(),o=KL[r];O_.forAll(a=>{var l;a.paused||a.removed||(r===0&&a.ticks++,a.phases[o]&&(Dw.elapsedFrameTime=performance.now()-t,Dw.deltaTime=a.ticks===0?0:e,(l=a.phases[o])==null||l.call(a,Dw)))}),MCe[r].push(performance.now()-n)}pae(),ACe.push(performance.now()-t)}const YT=new y_;function pae(){O_.forAll(t=>{t.removed&&YT.push(t)}),O_.removeUnorderedMany(YT.data,YT.length),YT.clear()}function fae(){for(;e5.length;){const t=e5.shift();t.isActive&&t.callback()}MN.willDispatch=!1}function TCe(t=1,e){const s=Xl(),i=()=>{Yl(e)?s.reject(xi()):t===0?s():(--t,IN(()=>i()))};return i(),s.promise}function ICe(t){return TCe(1,t)}async function bz(t){await ICe(t),await new Promise(e=>requestAnimationFrame(()=>{t!=null&&t.aborted||e()}))}const MCe=KL.map(t=>new zS(t)),ACe=new zS("total");function gae(t,e){for(const s of t.values())if(e(s))return!0;return!1}function AN(t,e){if(!e)return t;for(const s of e)s!=null&&t.add(s);return t}function cW(t,e){return e!=null&&t.add(e),t}function xz(t,e){const s=new Set;return AN(s,t),AN(s,e),s}function NCe(t,e){const s=new Set;for(const i of e)t.has(i)&&s.add(i);return s}function bct(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const s of t)if(!e.has(s))return!1;return!0}function xct(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const s of t)if(!e.has(s))return!1;return!0}function DCe(t,e){const s=new Set(t);for(const i of e)s.delete(i);return s}function $Ce(t,e){return DCe(xz(t,e),NCe(t,e))}let RCe=0;function DM(){return++RCe}let kD=class extends $D{constructor(e){super(new kCe(e)),this._observer&&hW.register(this,new WeakRef(this._observer),this)}destroy(){var e,s;this._observer&&hW.unregister(this._observer),(e=this.accessed)==null||e.clear(),this.clear(),(s=this._observer)==null||s.destroy()}},kCe=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=FCe}};const hW=new FinalizationRegistry(t=>{var e;(e=t.deref())==null||e.destroy()});function FCe(){}let Bv=!1;const NN=[];function yae(t,e){let s=new kD(n),i=null,r=!1;function n(){if(!s||r)return;if(Bv)return void bae(n);const a=i;s.clear(),Bv=!0,r=!0,i=Cd(s,t),r=!1,Bv=!1,e(i,a),xae()}function o(){s&&(s.destroy(),s=null,i=null)}return r=!0,i=Cd(s,t),r=!1,xs(o)}function _ae(t,e){let s=new kD(r),i=null;function r(){e(i,o)}function n(){s&&(s.destroy(),s=null),i=null}function o(){return s?(s.clear(),i=Cd(s,t),i):null}return o(),xs(n)}function vae(t,e){let s=!1,i=!1;const r=!!(e!=null&&e.sync);let n=new kD(()=>{s||i||(i=!0,r?o():queueMicrotask(o))});function o(){i=!1,n&&!s&&(Bv?bae(o):(n.clear(),Bv=!0,s=!0,Cd(n,t),s=!1,Bv=!1,xae()))}function a(){n&&(n.destroy(),n=null)}return s=!0,Cd(n,t),s=!1,xs(a)}function bae(t){NN.includes(t)||NN.unshift(t)}function xae(){for(;NN.length;)NN.pop()()}var US;(function(t){t[t.Untracked=0]="Untracked",t[t.Tracked=1]="Tracked"})(US||(US={}));let EE=class{constructor(){this.uid=DM(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,s,i,r,n){return this.pool.acquire(US.Untracked,e,s,i,r,n,cz)}static acquireTracked(e,s,i,r){return this.pool.acquire(US.Tracked,e,s,i,null,null,r)}notify(e,s){this.type===US.Untracked?this.callback.call(this.target,e,s,this.path,this.target):this.callback.call(null,e,s,void 0,void 0)}acquire(e,s,i,r,n,o,a){this.uid=DM(),this.removed=!1,this.type=e,this.oldValue=s,this.callback=i,this.getValue=r,this.target=n,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=DM(),this.removed=!0}};EE.pool=new cae(EE);const $M=new da,vd=new Set;let DN;function $N(t){vd.delete(t),vd.add(t),DN||(DN=OC(VCe))}function OCe(t){if(t.removed)return;const e=t.oldValue,s=t.getValue();t.equals(e,s)||(t.oldValue=s,t.notify(s,e))}function LCe(t){for(const e of vd.values())e.target===t&&(e.removed=!0)}function VCe(){let t=10;for(;DN&&t--;){DN=null;const e=qCe(),s=$M.acquire();for(const i of e){const r=i.uid;OCe(i),r===i.uid&&i.removed&&s.push(i)}for(const i of vd)i.removed&&(s.push(i),vd.delete(i));for(const i of s)EE.pool.release(i);$M.release(s),$M.release(e),t5.forEach(i=>i())}}function qCe(){const t=$M.acquire();t.length=vd.size;let e=0;for(const s of vd)t[e]=s,++e;return vd.clear(),t}const t5=new Set;function GCe(t){return t5.add(t),xs(()=>t5.delete(t))}function zCe(t,e,s){let i=Uoe(t,e,s,(r,n,o)=>{let a,l,u=_ae(()=>NC(r,n),(c,h)=>{var m;((m=r.__accessor__)==null?void 0:m.lifecycle)===Ba.DESTROYED||a&&a.uid!==l?i.remove():(a||(a=EE.acquireUntracked(c,o,h,r,n),l=a.uid),$N(a))});return xs(()=>{u.remove(),a&&(a.uid!==l||a.removed||(a.removed=!0,$N(a)),a=null),i=u=null})});return i}function UCe(t,e,s){const i=Uoe(t,e,s,(r,n,o)=>{let a=!1;return yae(()=>NC(r,n),(l,u)=>{r.__accessor__.lifecycle!==Ba.DESTROYED?a||(a=!0,cz(u,l)||o.call(r,l,u,n,r),a=!1):i.remove()})});return i}function BCe(t,e,s,i=!1){return t.__accessor__&&t.__accessor__.lifecycle!==Ba.DESTROYED?i?UCe(t,e,s):zCe(t,e,s):xs()}function jCe(t,e,s){let i,r,n=_ae(t,(o,a)=>{i&&i.uid!==r?n.remove():(i||(i=EE.acquireTracked(o,e,a,s),r=i.uid),$N(i))});return xs(()=>{n.remove(),i&&(i.uid!==r||i.removed||(i.removed=!0,$N(i)),i=null),n=null})}function HCe(t,e,s){let i=!1;return yae(t,(r,n)=>{i||(i=!0,s(n,r)||e(r,n),i=!1)})}function YCe(t,e,s=!1,i=Doe){return s?HCe(t,e,i):jCe(t,e,i)}function mW(t){return gae(vd,e=>e.oldValue===t)}var wae,Sae;function XCe(t){var e;if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return(e=t.constructor)!=null&&e.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const hh=Symbol("Accessor-Handles"),s5=Symbol("Accessor-Initialized");let Ye=class RM{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:s,declaredClass:i,constructor:r}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const n=this;class o extends n{constructor(...l){super(...l),this.inherited=null,r&&r.apply(this,l)}}DC(o.prototype);for(const a in e){const l=e[a];o.prototype[a]=typeof l=="function"?function(...u){const c=this.inherited;let h;this.inherited=function(...m){if(n.prototype[a])return n.prototype[a].apply(this,m)};try{h=l.apply(this,u)}catch(m){throw this.inherited=c,m}return this.inherited=c,h}:e[a]}for(const a in s){const l=XCe(s[a]);_(l)(o.prototype,a)}return Q(i)(o)}static freeze(e){return e instanceof RM?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof RM?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){var i;if(this[wae]=null,this[Sae]=!1,this.constructor===RM)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const s=new lCe(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:s}),e.length>0&&(s.ctorArgs=((i=this.normalizeCtorArgs)==null?void 0:i.apply(this,e))??e[0])}postscript(){const e=this.__accessor__,s=e.ctorArgs;e.initialize(),s&&(this.set(s),e.ctorArgs=null),e.constructed(),this.initialize(),this[s5]=!0}initialize(){}[Woe](){this[hh]=ii(this[hh])}destroy(){var e;this.destroyed||(LCe(this),this.__accessor__.destroy(),(e=hCe())==null||e.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[s5]}get destroyed(){var e;return((e=this.__accessor__)==null?void 0:e.lifecycle)===Ba.DESTROYED||!1}commitProperty(e){Xa(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,s){return wN(this,e,s),this}watch(e,s,i){return ZEe(Ne.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-core-reactiveUtils.html#watch",warnOnce:!0}),BCe(this,e,s,i)}addHandles(e,s){if(this.destroyed){const i=Array.isArray(e)?e:[e];for(const r of i)r.remove();return}(this[hh]??(this[hh]=new Kb)).add(e,s)}removeHandles(e){var s;(s=this[hh])==null||s.remove(e)}removeAllHandles(){var e;(e=this[hh])==null||e.removeAll()}removeHandlesReference(e){var s;(s=this[hh])==null||s.removeReference(e)}hasHandles(e){var s;return((s=this[hh])==null?void 0:s.has(e))===!0}_override(e,s){s===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,s)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,s){s==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,s)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,s){return this.__accessor__.internalSet(e,s),this}};wae=hh,Sae=s5;const Eae=t=>{let e=class extends t{clone(){var l;const s=Ja(this);$C(s,"unable to clone instance of non-accessor class");const i=s.metadata,r=s.store,n={},o=new Map;for(const u in i){const c=i[u],h=r==null?void 0:r.originOf(u),m=c.clonable;if(c.readOnly||m===!1||h!==Xt.USER&&h!==Xt.DEFAULTS&&h!==Xt.WEB_MAP&&h!==Xt.WEB_SCENE)continue;const f=this[u];let g=null;g=typeof m=="function"?m(f):m==="reference"?f:VL(f),f!=null&&g==null||(h===Xt.DEFAULTS?o.set(u,g):n[u]=g)}const a=new(Object.getPrototypeOf(this)).constructor(n);if(o.size){const u=(l=Ja(a))==null?void 0:l.store;if(u)for(const[c,h]of o)u.set(c,h,Xt.DEFAULTS)}return a}};return e=p([Q("esri.core.Clonable")],e),e};let g2=class extends Eae(Ye){};g2=p([Q("esri.core.Clonable")],g2),function(t){t.ClonableMixin=Eae}(g2||(g2={}));const Wt=g2;let ay=class extends Wt{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};p([_({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ay.prototype,"row",void 0),p([_({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ay.prototype,"column",void 0),p([_({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ay.prototype,"rows",void 0),p([_({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ay.prototype,"columns",void 0),ay=p([Q("esri.CameraLayout")],ay);const Cae=ay,dW=new Float32Array(1);function Tct(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function Ka(t,e,s){return Math.min(Math.max(t,e),s)}function Ict(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function y2(t,e,s){return t+(e-t)*s}function Mct(t,e,s,i,r){return y2(i,r,(t-e)/(s-e))}function FD(t){return t*Math.PI/180}function Pae(t){return 180*t/Math.PI}function Act(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function Nct(t){return Math.acos(Ka(t,-1,1))}function WCe(t){return Math.asin(Ka(t,-1,1))}function qc(t,e,s=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=s}function Tae(t,e,s=1e-6){return!qc(t,e,s)&&t>e}function i5(t,e,s=1e-6){return!qc(t,e,s)&&t<e}function ZCe(t,e,s=1e-6){return qc(t,e,s)||t>e}const RN=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function r5(t){return RN.setFloat64(0,t),RN.getBigInt64(0)}function QCe(t){return RN.setBigInt64(0,t),RN.getFloat64(0)}const kM=BigInt("1000000"),JCe=Iae(1);function Iae(t){const e=r5(t=Math.abs(t)),s=QCe(e<=kM?kM:e-kM);return Math.abs(t-s)}function Dct(t,e,s=JCe){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(s!=null&&Iae(Math.min(Math.abs(t),Math.abs(e)))<s)return Math.abs(t-e)<=s;const i=r5(t),r=r5(e);return i<0!=r<0?!1:!((i<r?r-i:i-r)>kM)}function $ct(t){return Mae(Math.max(-pW,Math.min(t,pW)))}function Mae(t){return dW[0]=t,dW[0]}function Rct(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],s=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],i=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(qc(e,1)&&qc(s,1)&&qc(i,1))}const pW=Mae(34028234663852886e22);function kct(t,e,s){if(s===void 0||+s==0)return Math[t](e);if(e=+e,s=+s,isNaN(e)||typeof s!="number"||s%1!=0)return NaN;let i=e.toString().split("e");return i=(e=Math[t](+(i[0]+"e"+(i[1]?+i[1]-s:-s)))).toString().split("e"),+(i[0]+"e"+(i[1]?+i[1]+s:s))}let wz=class{constructor(e,s){this.min=e,this.max=s,this.range=s-e}normalize(e,s=0,i=!1){return fW(this.range,this.min,this.max,e,s,i)}clamp(e,s=0){return Ka(e-s,this.min,this.max)+s}monotonic(e,s,i){return e<s?s:s+n5(this.range,e-s,i)}minimalMonotonic(e,s,i){return fW(this.range,e,e+this.range,s,i)}center(e,s,i){return s=this.monotonic(e,s,i),this.normalize((e+s)/2,i)}diff(e,s,i){return this.monotonic(e,s,i)-e}shortestSignedDiff(e,s){e=this.normalize(e);const i=(s=this.normalize(s))-e,r=s<e?this.minimalMonotonic(e,s)-e:s-this.minimalMonotonic(s,e);return Math.abs(i)<Math.abs(r)?i:r}contains(e,s,i){return s=this.minimalMonotonic(e,s),(i=this.minimalMonotonic(e,i))>e&&i<s}};function fW(t,e,s,i,r=0,n=!1){return(i-=r)<e?i+=n5(t,e-i):i>s&&(i-=n5(t,i-s)),n&&i===s&&(i=e),i+r}function n5(t,e,s=0){return Math.ceil((e-s)/t)*t+s}const Oct=new wz(0,2*Math.PI),Lct=new wz(-Math.PI,Math.PI),Aae=new wz(0,360);let KCe=class Nae{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const s=new Nae;return this._values.forEach((i,r)=>{e&&e.has(r)||s.set(r,he(i.value),i.origin)}),s}get(e,s){s=this._normalizeOrigin(s);const i=this._values.get(e);return s==null||(i==null?void 0:i.origin)===s?i==null?void 0:i.value:void 0}originOf(e){var s;return((s=this._values.get(e))==null?void 0:s.origin)??Xt.USER}keys(e){e=this._normalizeOrigin(e);const s=[...this._values.keys()];return e==null?s:s.filter(i=>{var r;return((r=this._values.get(i))==null?void 0:r.origin)===e})}set(e,s,i){if((i=this._normalizeOrigin(i))===Xt.DEFAULTS){const r=this._values.get(e);if((r==null?void 0:r.origin)!=null&&r.origin>i)return}this._values.set(e,new ePe(s,i))}delete(e,s){var i;(s=this._normalizeOrigin(s))!=null&&((i=this._values.get(e))==null?void 0:i.origin)!==s||this._values.delete(e)}has(e,s){var i;return(s=this._normalizeOrigin(s))!=null?((i=this._values.get(e))==null?void 0:i.origin)===s:this._values.has(e)}forEach(e){this._values.forEach(({value:s},i)=>e(s,i))}_normalizeOrigin(e){if(e!=null)return e===Xt.DEFAULTS?e:Xt.USER}},ePe=class{constructor(e,s){this.value=e,this.origin=s}};function Dae(t,e,s){e.keys().forEach(r=>{s.set(r,e.get(r),Xt.DEFAULTS)});const i=t.metadata;Object.keys(i).forEach(r=>{t.internalGet(r)&&s.set(r,t.internalGet(r),Xt.DEFAULTS)})}function tPe(t,e,s){if(!(t!=null&&t.read)||t.read.enabled===!1||!t.read.source)return!1;const i=t.read.source;if(typeof i=="string"){if(i===e||i.includes(".")&&i.indexOf(e)===0&&jX(i,s))return!0}else for(const r of i)if(r===e||r.includes(".")&&r.indexOf(e)===0&&jX(r,s))return!0;return!1}function sPe(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function iPe(t,e,s,i,r){let n=jL(e[s],r);sPe(n)&&(t[s]=!0);for(const o of Object.getOwnPropertyNames(e))n=jL(e[o],r),tPe(n,s,i)&&(t[o]=!0)}function rPe(t,e,s,i){const r=s.metadata,n=qEe(r[e],i),o=n==null?void 0:n.default;if(o===void 0)return;const a=typeof o=="function"?o.call(t,e,i):o;a!==void 0&&s.set(e,a)}const $ae={origin:"service"};function Rae(t,e,s=$ae){if(!e||typeof e!="object")return;const i=Ja(t),r=i.metadata,n={};for(const o of Object.getOwnPropertyNames(e))iPe(n,r,o,e,s);i.setDefaultOrigin(s.origin);for(const o of Object.getOwnPropertyNames(n)){const a=jL(r[o],s).read,l=a==null?void 0:a.source;let u;u=l&&typeof l=="string"?NC(e,l):e[o],a!=null&&a.reader&&(u=a.reader.call(t,u,e,s)),u!==void 0&&i.set(o,u)}if(!s||!s.ignoreDefaults){i.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(r))n[o]||rPe(t,o,i,s)}i.setDefaultOrigin("user")}function nPe(t,e,s,i=$ae){var n;const r={...i,messages:[]};s(r),(n=r.messages)==null||n.forEach(o=>{o.type!=="warning"||t.loaded?i!=null&&i.messages&&i.messages.push(o):t.loadWarnings.push(o)})}function oPe(t,e,s,i,r){var o,a;const n={};return(a=(o=e.write)==null?void 0:o.writer)==null||a.call(t,i,n,s,r),n}function kae(t,e,s,i,r,n){if(!(i!=null&&i.write))return!1;const o=Xa(t,s);if(!r&&i.write.overridePolicy){const a=i.write.overridePolicy.call(t,o,s,n??void 0);a!==void 0&&(r=a)}if(r||(r=i.write),!r||r.enabled===!1||r.layerContainerTypes&&(n!=null&&n.layerContainerType)&&!r.layerContainerTypes.includes(n.layerContainerType))return!1;if((o===null&&!r.allowNull&&!r.writerEnsuresNonNull||o===void 0)&&r.isRequired){const a=new ae("web-document-write:property-required",`Missing value for required property '${s}' on '${t.declaredClass}'`,{propertyName:s,target:t});return a&&(n!=null&&n.messages)?n.messages.push(a):a&&!n&&Ne.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!r.allowNull&&!r.writerEnsuresNonNull||!r.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(s)===Xt.DEFAULTS)&&aPe(t,s,n,i,o)||!r.ignoreOrigin&&(n!=null&&n.origin)&&e.store.multipleOriginsSupported&&e.store.originOf(s)<Tf(n.origin))}function aPe(t,e,s,i,r){const n=i.default;if(n===void 0)return!1;if(i.defaultEquals!=null)return i.defaultEquals(r);if(typeof n=="function"){if(Array.isArray(r)){const o=n.call(t,e,s??void 0);return TD(o,r)}return!1}return n===r}function lPe(t,e,s,i){const r=Ja(t),n=r.metadata,o=oae(n[e],i);return!!o&&kae(t,r,e,o,s,i)}function Fae(t,e,s){var n,o;if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return MM(e,t.toJSON(s));const i=Ja(t),r=i.metadata;for(const a in r){const l=oae(r[a],s);if(!kae(t,i,a,l,void 0,s))continue;const u=Xa(t,a),c=oPe(t,l,l.write&&typeof l.write.target=="string"?l.write.target:a,u,s);Object.keys(c).length>0&&(e=MM(e,c),(o=(n=s==null?void 0:s.resources)==null?void 0:n.pendingOperations)!=null&&o.length&&s.resources.pendingOperations.push(Promise.all(s.resources.pendingOperations).then(()=>MM(e,c,()=>"replace-arrays"))),s!=null&&s.writtenProperties&&s.writtenProperties.push({target:t,propName:a,oldOrigin:oCe(i.store.originOf(a)),newOrigin:s.origin}))}return e}const Oae=t=>{let e=class extends t{constructor(...s){super(...s);const i=Ja(this),r=i.store,n=new KCe;i.store=n,Dae(i,r,n)}read(s,i){Rae(this,s,i)}write(s,i){return Fae(this,s??{},i)}toJSON(s){return this.write({},s)}static fromJSON(s,i){return uPe.call(this,s,i)}};return e=p([Q("esri.core.JSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function uPe(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const s=new this;return s.read(t,e),s}let _2=class extends Oae(Ye){};_2=p([Q("esri.core.JSONSupport")],_2),function(t){function e(s){return s&&typeof s=="object"&&"toJSON"in s&&typeof s.toJSON=="function"}t.JSONSupportMixin=Oae,t.isSerializable=e}(_2||(_2={}));const Te=_2,cPe=Object.prototype.toString;function hPe(t){const e="__accessorMetadata__"in t?nn(t):t;return function(...s){if(s.push(e),typeof s[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return mPe.apply(this,s)}}function mPe(t,e,s,i){DD(t,e).cast=i}function dPe(t){return(e,s)=>{DD(e,t).cast=e[s]}}function Ht(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&cPe.call(t[0])==="[object Function]"?hPe(t[0]):t.length===1&&typeof t[0]=="string"?dPe(t[0]):void 0}function qe(t,e,s){let i,r;return e===void 0||Array.isArray(e)?(r=t,s=e,i=[void 0]):(r=e,i=Array.isArray(t)?t:[t]),(n,o)=>{const a=n.constructor.prototype;i.forEach(l=>{const u=Xoe(n,l,r);u.read&&typeof u.read=="object"||(u.read={}),u.read.reader=a[o],s&&(u.read.source=(u.read.source||[]).concat(s))})}}function Ue(t,e,s){let i,r;return e===void 0?(r=t,i=[void 0]):typeof e!="string"?(r=t,i=[void 0],s=e):(r=e,i=Array.isArray(t)?t:[t]),(n,o)=>{const a=n.constructor.prototype;for(const l of i){const u=Xoe(n,l,r);u.write&&typeof u.write=="object"||(u.write={}),s&&(u.write.target=s),u.write.writer=a[o]}}}let Jt=class{constructor(e,s={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=s,this.apiValues=[],this.jsonValues=[],this._apiToJSON=pPe(e),this.apiValues=gW(this._apiToJSON),this.jsonValues=gW(this._jsonToAPI),this.read=i=>this.fromJSON(i),this.write=(i,r,n)=>{const o=this.toJSON(i);o!==void 0&&Hn(n,o,r)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const s=this._apiToJSON[e];return this._options.useNumericKeys?+s:s}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function pPe(t){const e={};for(const s in t)e[t[s]]=s;return e}function gW(t){const e=[];for(const s in t)e.push(s);return e.sort(),e}function Xn(){return function(t,e){return new Jt(t,{ignoreUnknown:!0,...e})}}let Sz=class{constructor(e,s,i,r,n,o){this.semiMajorAxis=e,this.flattening=s,this.outerAtmosphereRimWidth=i,this.atmosphereHeight=r,this.scaleHeight=n;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const lr=new Sz(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),Hh=new Sz(3396190,1/169.8944472236118,23e4,6e4,.111),Wf=new Sz(1737400,0,0,0,0),fPe=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,gPe={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function yW(t){const e=t==null?void 0:t.match(fPe);if(!e)return null;const[,s,i,r]=e;if(!s)return null;let n=null,o=null,a=null;const{devext:l,qaext:u,www:c}=gPe;if(i)if(n=s,r)switch(r.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}else({customBaseUrl:o,portalHostname:a}=c);else switch(s.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=u);break;case"www":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:n}}function yPe(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function Lae(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,s=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,i=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):s.test(t)?t=t.replace(s,"https://devext.arcgis.com"):i.test(t)&&(t=t.replace(i,"https://qaext.arcgis.com")),t}function Vae(t){const e=atob(t),s=new Uint8Array(e.length);for(let i=0;i<e.length;i++)s[i]=e.charCodeAt(i);return s.buffer}function _Pe(t){const e=new Uint8Array(t);let s="";for(let i=0;i<e.length;i++)s+=String.fromCharCode(e[i]);return btoa(s)}const vPe=()=>Ne.getLogger("esri.core.urlUtils"),tx=Ds.request,_W="esri/config: esriConfig.request.proxyUrl is not set.",qae=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,Gae=/^\s*http:/i,bPe=/^\s*https:/i,xPe=/^\s*file:/i,wPe=/:\d+$/,SPe=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,EPe=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),CPe=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let jv=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let s=this.uri.match(EPe);this.scheme=s[2]||(s[1]?"":null),this.authority=s[4]||(s[3]?"":null),this.path=s[5],this.query=s[7]||(s[6]?"":null),this.fragment=s[9]||(s[8]?"":null),this.authority!=null&&(s=this.authority.match(CPe),this.user=s[3]||null,this.password=s[4]||null,this.host=s[6]||s[7],this.port=s[9]||null)}toString(){return this.uri}};const XT={},PPe=new jv(Ds.applicationUrl);let $o=PPe;const TPe=IPe();let Ez=TPe;const Cz=()=>$o,Bct=()=>Ez;function IPe(){const t=$o.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${$o.scheme}://${$o.host}${$o.port!=null?`:${$o.port}`:""}`}${e}`}function Sr(t){if(!t)return null;const e={path:null,query:null},s=new jv(t),i=t.indexOf("?");return s.query===null?e.path=t:(e.path=t.slice(0,i),e.query=Pz(s.query)),s.fragment&&(e.hash=s.fragment,s.query===null&&(e.path=e.path.slice(0,e.path.length-(s.fragment.length+1)))),e}function Pz(t){const e=t.split("&"),s={};for(const i of e){if(!i)continue;const r=i.indexOf("=");let n,o;r<0?(n=decodeURIComponent(i),o=""):(n=decodeURIComponent(i.slice(0,r)),o=decodeURIComponent(i.slice(r+1)));let a=s[n];typeof a=="string"&&(a=s[n]=[a]),Array.isArray(a)?a.push(o):s[n]=o}return s}function CE(t,e){return t?Object.keys(t).map(s=>{const i=t[s];if(i==null)return"";const r=encodeURIComponent(s)+"=",n=e==null?void 0:e[s];return n?r+encodeURIComponent(n(i)):Array.isArray(i)?i.map(o=>Te.isSerializable(o)?r+encodeURIComponent(JSON.stringify(o)):r+encodeURIComponent(o)).join("&"):Te.isSerializable(i)?r+encodeURIComponent(JSON.stringify(i)):r+encodeURIComponent(i)}).filter(s=>s).join("&"):""}function zae(t=!1){let e,s=tx.proxyUrl;if(typeof t=="string"){e=RPe(t);const i=OD(t);i&&(s=i.proxyUrl)}else e=!!t;if(!s)throw vPe().warn(_W),new ae("urlUtils:proxy-not-set",_W);return e&&a5()&&(s=Nz(s)),Sr(s)}function jct(t,e=!1){const s=OD(t);let i,r;if(s){const n=Tz(s.proxyUrl);i=n.path,r=n.query?Pz(n.query):null}else if(e){const n=zae(t);i=n.path,r=n.query}if(i){const n=Sr(t);t=i+"?"+n.path;const o=CE({...r,...n.query});o&&(t=`${t}?${o}`)}return t}const $w={path:"",query:""};function Tz(t){const e=t.indexOf("?");return e!==-1?($w.path=t.slice(0,e),$w.query=t.slice(e+1)):($w.path=t,$w.query=null),$w}function Uae(t){return t=(t=FN(t=VPe(t=Tz(t).path),!0)).toLowerCase()}function MPe(t){const e={proxyUrl:t.proxyUrl,urlPrefix:Uae(t.urlPrefix)},s=tx.proxyRules,i=e.urlPrefix;let r=s.length;for(let n=0;n<s.length;n++){const o=s[n].urlPrefix;if(i.indexOf(o)===0){if(i.length===o.length)return-1;r=n;break}o.indexOf(i)===0&&(r=n+1)}return s.splice(r,0,e),r}function OD(t){const e=tx.proxyRules,s=Uae(t);for(let i=0;i<e.length;i++)if(s.indexOf(e[i].urlPrefix)===0)return e[i]}function APe(t,e){if(!t||!e)return!1;t=kN(t),e=kN(e);const s=yW(t),i=yW(e);return s!=null&&i!=null?s.portalHostname===i.portalHostname:s==null&&i==null&&gb(t,e,!0)}function Bae(t,e){return t=kN(t),e=kN(e),FN(t)===FN(e)}function kN(t){const e=(t=Gc(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function o5(t,e=tx.interceptors){const s=i=>i==null||i instanceof RegExp&&i.test(t)||typeof i=="string"&&t.startsWith(i);if(e){for(const i of e)if(Array.isArray(i.urls)){if(i.urls.some(s))return i}else if(s(i.urls))return i}return null}function gb(t,e,s=!1){if(!t||!e)return!1;const i=u5(t),r=u5(e);return!(!s&&i.scheme!==r.scheme)&&i.host!=null&&r.host!=null&&i.host.toLowerCase()===r.host.toLowerCase()&&i.port===r.port}function Iz(t){if(typeof t=="string"){if(!Bl(t))return!0;t=u5(t)}if(gb(t,$o))return!0;const e=tx.trustedServers||[];for(let s=0;s<e.length;s++){const i=NPe(e[s]);for(let r=0;r<i.length;r++)if(gb(t,i[r]))return!0}return!1}function NPe(t){return XT[t]||(Az(t)||Wh(t)?XT[t]=[new jv($u(t))]:XT[t]=[new jv(`http://${t}`),new jv(`https://${t}`)]),XT[t]}function $u(t,e=Ez,s){return Wh(t)?s!=null&&s.preserveProtocolRelative?t:$o.scheme==="http"&&$o.authority===Ul(t).slice(2)?`http:${t}`:`https:${t}`:Az(t)?t:L_(t[0]==="/"?LPe(e):e,t)}function Mz(t,e=Ez,s){if(t==null||!Bl(t))return t;const i=Gc(t),r=i.toLowerCase(),n=Gc(e).toLowerCase().replace(/\/+$/,""),o=s?Gc(s).toLowerCase().replace(/\/+$/,""):null;if(o&&n.indexOf(o)!==0)return t;const a=(h,m,f)=>(f=h.indexOf(m,f))===-1?h.length:f;let l=a(r,"/",r.indexOf("//")+2),u=-1;for(;r.slice(0,l+1)===n.slice(0,l)+"/"&&(u=l+1,l!==r.length);)l=a(r,"/",l+1);if(u===-1||o&&u<o.length)return t;t=i.slice(u);const c=n.slice(u-1).replaceAll(/[^/]+/g,"").length;if(c>0)for(let h=0;h<c;h++)t=`../${t}`;else t=`./${t}`;return t}function Gc(t){return t=zPe(t=GPe(t=qPe(t=$u(t=t.trim()))))}function L_(...t){const e=t.filter(Qa);if(!(e!=null&&e.length))return;const s=[];if(Bl(e[0])){const r=e[0],n=r.indexOf("//");n!==-1&&(s.push(r.slice(0,n+1)),FPe(e[0])&&(s[0]+="/"),e[0]=r.slice(n+2))}else e[0][0]==="/"&&s.push("");const i=e.reduce((r,n)=>n?r.concat(n.split("/")):r,[]);for(let r=0;r<i.length;r++){const n=i[r];n===".."&&s.length>0&&s[s.length-1]!==".."?s.pop():(!n&&r===i.length-1||n&&(n!=="."||s.length===0))&&s.push(n)}return s.join("/")}function Ul(t,e=!1){if(t==null||LD(t)||d0(t))return null;let s=t.indexOf("://");if(s===-1&&Wh(t))s=2;else{if(s===-1)return null;s+=3}const i=t.indexOf("/",s);return i!==-1&&(t=t.slice(0,i)),e&&(t=FN(t,!0)),t}function Bl(t){return Wh(t)||Az(t)}function LD(t){return t!=null&&t.slice(0,5)==="blob:"}function d0(t){return t!=null&&t.slice(0,5)==="data:"}function DPe(t){const e=yb(t);return e!=null&&e.isBase64?Vae(e.data):null}function Hct(t){return _Pe(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const $Pe=/^data:(.*?)(;base64)?,(.*)$/;function yb(t){const e=t.match($Pe);if(!e)return null;const[,s,i,r]=e;return{mediaType:s,isBase64:!!i,data:r}}function jae(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function Yct(t){return(await fetch(t)).blob()}function Xct(t){const e=DPe(t);if(!e)return null;const s=yb(t);return new Blob([e],{type:s.mediaType})}function Wh(t){return t!=null&&t[0]==="/"&&t[1]==="/"}function Az(t){return t!=null&&qae.test(t)}function RPe(t){return t!=null&&bPe.test(t)||$o.scheme==="https"&&Wh(t)}function kPe(t){return t!=null&&Gae.test(t)||$o.scheme==="http"&&Wh(t)}function FPe(t){return t!=null&&xPe.test(t)}function Nz(t){return Wh(t)?`https:${t}`:t.replace(Gae,"https:")}function OPe(){return $o.scheme==="http"}function a5(){return $o.scheme==="https"}function FN(t,e=!1){return Wh(t)?t.slice(2):(t=t.replace(qae,""),e&&t.length>1&&t[0]==="/"&&t[1]==="/"&&(t=t.slice(2)),t)}function LPe(t){const e=t.indexOf("//"),s=t.indexOf("/",e+2);return s===-1?t:t.slice(0,s)}function Dz(t){let e=0;if(Bl(t)){const i=t.indexOf("//");i!==-1&&(e=i+2)}const s=t.lastIndexOf("/");return s<e?t:t.slice(0,s+1)}function Wct(t,e){if(!t)return"";const s=Sr(t).path.replace(/\/+$/,""),i=s.slice(s.lastIndexOf("/")+1);if(!(e!=null&&e.length))return i;const r=new RegExp(`\\.(${e.join("|")})$`,"i");return i.replace(r,"")}function VPe(t){return t.endsWith("/")?t:`${t}/`}function Hae(t){return t.replace(/\/+$/,"")}function qPe(t){if(/^https?:\/\//i.test(t)){const e=Tz(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function GPe(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function zPe(t){const e=tx.httpsDomains;if(!kPe(t))return t;const s=t.indexOf("/",7);let i;if(i=s===-1?t:t.slice(0,s),i=i.toLowerCase().slice(7),wPe.test(i)){if(!i.endsWith(":80"))return t;i=i.slice(0,-3),t=t.replace(":80","")}return OPe()&&i===$o.authority&&!SPe.test(t)||(a5()&&i===$o.authority||e&&e.some(r=>i===r||i.endsWith(`.${r}`))||a5()&&!OD(t))&&(t=Nz(t)),t}function l5(t,e,s){if(!(e&&s&&t&&Bl(t)))return t;const i=t.indexOf("//"),r=t.indexOf("/",i+2),n=t.indexOf(":",i+2),o=Math.min(r<0?t.length:r,n<0?t.length:n);return t.slice(i+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,i+2)}${s}${t.slice(o)}`}function u5(t){return typeof t=="string"?new jv($u(t)):(t.scheme||(t.scheme=$o.scheme),t)}function Zct(t){return BPe.test(t)}function Yae(t,e){const s=Sr(t),i=Object.keys(s.query||{});return i.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${i.join(", ")}.`),s.path}function UPe(t,e,s){const i=Sr(t),r=i.query||{};return r[e]=String(s),`${i.path}?${CE(r)}`}function a4(t,e){if(!e)return t;const s=Sr(t),i=s.query||{};for(const[n,o]of Object.entries(e))o!=null&&(i[n]=o);const r=CE(i);return r?`${s.path}?${r}`:s.path}function Qct(t){if(t==null)return null;const e=t.match(Xae);return e?e[2]:null}function vW(t){if(t==null)return null;const e=t.match(Xae);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function Jct(t){return typeof t=="string"?yb(t)??{data:t}:new Promise((e,s)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=()=>e(yb(i.result)),i.onerror=r=>s(r)})}const Xae=/([^.]*)\.([^/]*)$/,BPe=/(^data:image\/svg|\.svg$)/i,Wae="20250407",Zae="04d2b42da93678ca718b23aaf7e216985f10fa8e";Symbol.dispose??(Symbol.dispose=Symbol("Symbol.dispose")),Symbol.asyncDispose??(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));const jPe="4.32";let Mt,$z=jPe;$z="4.32.10";function Kct(t){Mt=t}function eht(t){const e=Mt==null?void 0:Mt.findCredential(t);return e!=null&&e.token?UPe(t,"token",e.token):t}ge("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),ge("host-webworker");function Zf(t,e){var i;const s=(i=e==null?void 0:e.url)==null?void 0:i.path;if(t&&s&&(t=$u(t,s,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const r=Mz(t,e.portalItem.itemUrl);r!=null&&HPe.test(r)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(r).path)}return(t=c5(t,e==null?void 0:e.portal))&&VD.test(t)?kz(t):t}function LC(t,e,s=PE.YES){var r,n;if((t=t&&VD.test(t)?Jae(t):t)==null)return t;!Bl(t)&&(e!=null&&e.blockedRelativeUrls)&&e.blockedRelativeUrls.push(t);let i=$u(t);if(e){const o=((r=e.verifyItemRelativeUrls)==null?void 0:r.rootPath)||((n=e.url)==null?void 0:n.path);if(o){const a=c5(o,e.portal),l=c5(i,e.portal);i=Mz(l,a,a),i!=null&&i!==l&&i!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(i)}}return i=Qae(i,e==null?void 0:e.portal),Bl(i)&&(i=Gc(i)),e!=null&&e.resources&&(e!=null&&e.portalItem)&&!Bl(i)&&!d0(i)&&s===PE.YES&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(i),compress:!1}),i}function Rz(t,e,s){return Zf(t,s)}function V_(t,e,s,i){const r=LC(t,i);r!==void 0&&(e[s]=r)}const VD=/\/items\/([^/]+)\/resources\/(.*)/,HPe=/^\.\/resources\//;function YPe(t){const e=(t==null?void 0:t.match(VD))??null;return(e==null?void 0:e[1])??null}function XPe(t){const e=(t==null?void 0:t.match(VD))??null;if(e==null)return null;const s=e[2],i=s.lastIndexOf("/");if(i===-1){const{path:o,extension:a}=vW(s);return{prefix:null,filename:o,extension:a}}const{path:r,extension:n}=vW(s.slice(i+1));return{prefix:s.slice(0,i),filename:r,extension:n}}function Qae(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?l5(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function c5(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const s=`${e.urlKey}.${e.customBaseUrl}`,i=Cz();return gb(i,`${i.scheme}://${s}`)?l5(t,e.portalHostname,s):l5(t,s,e.portalHostname)}function kz(t){if(!t)return t||null;let e=t;return e&&Mt&&!Mt.findCredential(e)&&(e=Lae(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function Jae(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Mt&&!Mt.findCredential(e)&&(e=Lae(e)),e}var PE;(function(t){t[t.YES=0]="YES",t[t.NO=1]="NO"})(PE||(PE={}));const tht=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return PE},ensureMainOnlineDomain:Qae,fromCDNUrl:Jae,fromJSON:Zf,itemIdFromResourceUrl:YPe,prefixAndFilenameFromResourceUrl:XPe,read:Rz,toCDNUrl:kz,toJSON:LC,write:V_},Symbol.toStringTag,{value:"Module"})),Kae={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},ele=Object.values(Kae),tle=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${ele.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),WPe=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${ele.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),ZPe=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function sht(t){return tle.test(t)}function sx(t){if(t==null)return null;const e=Sr(t),s=(e==null?void 0:e.path.match(tle))||(e==null?void 0:e.path.match(WPe));if(!s)return null;const[,i,r,n,o]=s,a=r.indexOf("/");return{title:Fz(a!==-1?r.slice(a+1):r),serverType:Kae[n.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:i}}}function QPe(t){const e=Sr(t).path.match(ZPe);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function Fz(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function JPe(t,e){const s=[];if(t){const i=sx(t);i!=null&&i.title&&s.push(i.title)}if(e){const i=Fz(e);s.push(i)}if(s.length===2){if(s[0].toLowerCase().includes(s[1].toLowerCase()))return s[0];if(s[1].toLowerCase().includes(s[0].toLowerCase()))return s[1]}return s.join(" - ")}function ON(t){let e=Ul(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function KPe(t,e){return t&&Hae(Yae(t,e))}function eTe(t){let{url:e}=t;if(!e)return{url:e};e=Yae(e,t.logger);const s=Sr(e),i=sx(s.path);let r;if(i!=null)i.sublayer!=null&&t.layer.layerId==null&&(r=i.sublayer),e=i.url.path;else if(t.nonStandardUrlAllowed){const n=QPe(s.path);n!=null&&(e=n.serviceUrl,r=n.sublayerId)}return{url:Hae(e),layerId:r}}function tTe(t,e,s,i,r){V_(e,i,"url",r),i.url&&t.layerId!=null&&(i.url=L_(i.url,s,t.layerId.toString()))}function iht(t){if(!t)return!1;const e=t.toLowerCase(),s=e.includes("/services/"),i=e.includes("/mapserver/wmsserver"),r=e.includes("/imageserver/wmsserver"),n=e.includes("/wmsserver");return s&&(i||r||n)}const sTe=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function iTe(t){const e=Ul(t,!0);return!!e&&e.endsWith(".arcgis.com")&&!sTe.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function sle(t,e){return!(!Ds.apiKey||!iTe(t))}function rTe(t,e,s=!1,i){return new Promise((r,n)=>{if(Yl(i))return void n(bW());let o=()=>{u(),n(new Error(`Unable to load ${e}`))},a=()=>{const c=t;u(),r(c)},l=()=>{if(!t)return;const c=t;u(),c.src="",n(bW())};const u=()=>{ge("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",a)),o=null,a=null,t=null,i!=null&&i.removeEventListener("abort",l),l=null,s&&URL.revokeObjectURL(e)};i!=null&&i.addEventListener("abort",l),ge("esri-image-decode")?t.decode().then(a,o):(t.addEventListener("error",o),t.addEventListener("load",a))})}function bW(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const ile="Timeout exceeded";function nTe(){return new Error(ile)}function rht(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===ile}function oTe(t){Ds.request.crossOriginNoCorsDomains||(Ds.request.crossOriginNoCorsDomains={});const e=Ds.request.crossOriginNoCorsDomains;for(let s of t)s=s.toLowerCase(),/^https?:\/\//.test(s)?e[Ul(s)??""]=0:(e[Ul("http://"+s)??""]=0,e[Ul("https://"+s)??""]=0)}function aTe(t){const e=Ds.request.crossOriginNoCorsDomains;if(e){let s=Ul(t);if(s)return s=s.toLowerCase(),!gb(s,Cz())&&e[s]<Date.now()-36e5}return!1}async function lTe(t){var r;const e=Sr(t);t=e.path,((r=e.query)==null?void 0:r.f)==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const s=Ds.request.crossOriginNoCorsDomains,i=Ul(t);s&&i&&(s[i.toLowerCase()]=Date.now())}async function js(t,e){var f;t instanceof URL&&(t=t.toString()),(e==null?void 0:e.query)instanceof URLSearchParams&&(e.query=Pz(e.query.toString().replaceAll("+"," ")));const s=d0(t),i=LD(t);i||s||(t=Gc(t));const r={url:t,requestOptions:{...e}},n=g=>({data:g,getAllHeaders:_b,getHeader:_b,httpStatus:200,requestOptions:r.requestOptions,url:r.url}),o=o5(t,Au.internalInterceptors);if(o){const g=await wW(o,r);if(g!=null)return n(g)}let a=o5(t);if(a){const g=await wW(a,r);if(g!=null)return n(g);a.after||a.error||(a=null)}if(t=r.url,(e=r.requestOptions).responseType==="image"&&(ge("host-webworker")||ge("host-node")))throw zc("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),r);if(e.method==="head"){if(e.body)throw zc("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),r);if(s||i)throw zc("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),r)}if(await dTe(),LN)return LN.execute(t,e);const l=new AbortController,u=Ou(e,()=>l.abort()),c={controller:l,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:r,redoRequest:!1,useIdentity:Au.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},h=e.useRequestQueue?_Te(c):m5(c),m=await h.finally(()=>u==null?void 0:u.remove());return(f=a==null?void 0:a.after)==null||f.call(a,m),m}let LN;const Au=Ds.request,rle="FormData"in globalThis,uTe=new Set([499,498,403,401]),cTe=new Set(["COM_0056","COM_0057","SB_0008"]),hTe=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_b=()=>null,VN=Symbol();function mTe(t){const e=Ul(t);e&&!js._corsServers.includes(e)&&js._corsServers.push(e)}function xW(t){const e=Ul(t);return!e||e.endsWith(".arcgis.com")||js._corsServers.includes(e)||Iz(e)}function zc(t,e,s,i){let r="Error";const n={url:s.url,requestOptions:s.requestOptions,getAllHeaders:_b,getHeader:_b,ssl:!1};if(e instanceof ae)return e.details?(e.details=he(e.details),e.details.url=s.url,e.details.requestOptions=s.requestOptions):e.details=n,e;if(e){const o=i&&(()=>Array.from(i.headers)),a=i&&(c=>i.headers.get(c)),l=i==null?void 0:i.status,u=e.message;u&&(r=u),o&&a&&(n.getAllHeaders=o,n.getHeader=a),n.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||l||0,n.subCode=e.subcode,n.messageCode=e.messageCode,typeof e.details=="string"?n.messages=[e.details]:n.messages=e.details,n.raw=VN in e?e[VN]:e}return Lr(e)?xi():new ae(t,r,n)}async function dTe(){ge("host-webworker")&&!LN&&(LN=await me(()=>import("./request-CtHnH-jG.js"),[]))}async function h5(){Mt||await me(()=>import("./IdentityManager-DvPAbnFv.js"),[])}async function pTe(t){var a;const e=t.params.url,s=t.params.requestOptions,i=t.controller.signal,r=s.body;let n=null,o=null;if(rle&&"HTMLFormElement"in globalThis&&(r instanceof FormData?n=r:r instanceof HTMLFormElement&&(n=new FormData(r))),typeof r=="string"&&(o=r),t.fetchOptions={cache:s.cacheBust?"no-cache":"default",credentials:"same-origin",headers:s.headers||{},method:s.method==="head"?"HEAD":"GET",mode:"cors",priority:Au.priority,redirect:"follow",signal:i},(n||o)&&(t.fetchOptions.body=n||o),s.authMode==="anonymous"&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||(a=s.query)!=null&&a.token||n!=null&&n.get("token")),!t.hasToken&&sle(e)&&(s.query||(s.query={}),s.query.token=Ds.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!nle(e)&&!Yl(i)){let l;s.authMode==="immediate"?(await h5(),l=await Mt.getCredential(e,{signal:i}),t.credential=l):s.authMode==="no-prompt"?(await h5(),l=await Mt.getCredential(e,{prompt:!1,signal:i}).catch(()=>{}),t.credential=l):Mt&&(l=Mt.findCredential(e)),l&&(t.credentialToken=l.token,t.useSSL=!!l.ssl)}}function nle(t){return hTe.some(e=>e.test(t))}async function fTe(t){let e=t.params.url;const s=t.params.requestOptions,i=t.fetchOptions??{},r=LD(e)||d0(e),n=s.responseType||"json",o=r?0:s.timeout!=null?s.timeout:Au.timeout;let a=!1;if(!r){t.useSSL&&(e=Nz(e));let m={...s.query};t.credentialToken&&(m.token=t.credentialToken);let f=CE(m);ge("esri-url-encodes-apostrophe")&&(f=f.replaceAll("'","%27"));const g=e.length+1+f.length;let v;a=s.method==="delete"||s.method==="post"||s.method==="put"||!!s.body||g>Au.maxUrlLength;const b=s.useProxy||!!OD(e);if(b){const w=zae(e);v=w.path,!a&&v.length+1+g>Au.maxUrlLength&&(a=!0),w.query&&(m={...w.query,...m})}if(i.method==="HEAD"&&(a||b)){if(a)throw g>Au.maxUrlLength?zc("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):zc("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(b)throw zc("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}if(a?(i.method=s.method==="delete"?"DELETE":s.method==="put"?"PUT":"POST",s.body?e=a4(e,m):(i.body=CE(m),i.headers||(i.headers={}),i.headers["Content-Type"]="application/x-www-form-urlencoded")):e=a4(e,m),b&&(t.useProxy=!0,e=`${v}?${e}`),m.token&&rle&&i.body instanceof FormData&&!yPe(e)&&i.body.set("token",m.token),s.hasOwnProperty("withCredentials"))t.withCredentials=s.withCredentials;else if(!gb(e,Cz())){if(Iz(e))t.withCredentials=!0;else if(Mt){const w=Mt.findServerInfo(e);w!=null&&w.webTierAuth&&(t.withCredentials=!0)}}t.withCredentials&&(i.credentials="include",aTe(e)&&await lTe(a?a4(e,m):e))}let l,u,c=0,h=!1;o>0&&(c=setTimeout(()=>{h=!0,t.controller.abort()},o));try{if(s.responseType==="native-request-init")u=i,u.url=e,s.signal?u.signal=s.signal:delete u.signal;else if(s.responseType!=="image"||i.cache!=="default"||i.method!=="GET"||a||gTe(s.headers)||!r&&!t.useProxy&&Au.proxyUrl&&!xW(e)){if(js._beforeFetch&&await js._beforeFetch(e,i),l=await fetch(e,i),js._afterFetch&&await js._afterFetch(l),t.useProxy||mTe(e),s.responseType==="native")u=l;else if(i.method!=="HEAD")if(l.ok){switch(n){case"array-buffer":u=await l.arrayBuffer();break;case"blob":case"image":u=await l.blob();break;default:u=await l.text()}if(c&&(clearTimeout(c),c=0),n==="json"||n==="xml"||n==="document")if(u)switch(n){case"json":u=JSON.parse(u);break;case"xml":u=SW(u,"application/xml");break;case"document":u=SW(u,"text/html")}else u=null;if(u){if(n==="array-buffer"||n==="blob"){const m=l.headers.get("Content-Type");if(m&&/application\/json|text\/plain/i.test(m)&&u[n==="blob"?"size":"byteLength"]<=750)try{const f=await new Response(u).json();f.error&&(u=f)}catch{}}n==="image"&&u instanceof Blob&&(u=await EW(URL.createObjectURL(u),t,!0))}}else{u=await l.text();try{u=JSON.parse(u)}catch{}}}else u=await EW(e,t)}catch(m){if(m.name==="AbortError")throw h?nTe():xi("Request canceled");if(!(!l&&m instanceof TypeError&&Au.proxyUrl)||s.body||s.method==="delete"||s.method==="head"||s.method==="post"||s.method==="put"||t.useProxy||xW(e))throw m;t.redoRequest=!0,MPe({proxyUrl:Au.proxyUrl,urlPrefix:Ul(e)??""})}finally{c&&clearTimeout(c)}return[l,u]}async function wW(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let s,i;try{i=await t.before(e)}catch(r){s=zc("request:interceptor",r,e)}if((i instanceof Error||i instanceof ae)&&(s=zc("request:interceptor",i,e)),s)throw t.error&&t.error(s),s;return i}}function gTe(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function SW(t,e){let s;try{s=new DOMParser().parseFromString(t,e)}catch{}if(!s||s.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return s}js._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],js._beforeFetch=void 0,js._afterFetch=void 0;const yTe=new Map;async function _Te(t){const e=bTe(t.params.url);if(!e)return m5(t);const{QueueProcessor:s}=await me(()=>import("./QueueProcessor-DSWTIJWW.js"),[]);return Zb(yTe,e.origin,()=>{const r=e.isHosted?ge("request-queue-concurrency-hosted"):ge("request-queue-concurrency-non-hosted");return new s({concurrency:r,process:n=>{if(Yl(n.params.requestOptions))throw zc("",xi("Request canceled"),n.params);return m5(n)}})}).push(t)}async function m5(t){var n,o;let e,s;await pTe(t);try{do[e,s]=await fTe(t);while(!await vTe(t,e,s))}catch(a){const l=zc("request:server",a,t.params,e);throw l.details.ssl=t.useSSL,(n=t.interceptor)!=null&&n.error&&t.interceptor.error(l),l}const i=t.params.url;if(s&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(i)){if(!t.hasToken&&!t.credentialToken&&((o=s.user)!=null&&o.username)&&!Iz(i)){const a=Ul(i,!0);a&&Au.trustedServers.push(a)}Array.isArray(s.authorizedCrossOriginNoCorsDomains)&&oTe(s.authorizedCrossOriginNoCorsDomains)}const r=t.credential;if(r&&Mt){const a=Mt.findServerInfo(r.server);let l=a==null?void 0:a.owningSystemUrl;if(l){l=l.replace(/\/?$/,"/sharing");const u=Mt.findCredential(l,r.userId);u&&Mt._getIdenticalSvcIdx(l,u)===-1&&u.resources.unshift(l)}}return{data:s,getAllHeaders:e?()=>Array.from(e.headers):_b,getHeader:e?a=>e.headers.get(a):_b,httpStatus:(e==null?void 0:e.status)??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function vTe(t,e,s){var u;if(t.redoRequest)return t.redoRequest=!1,!1;const i=t.params.requestOptions;if(!e||i.responseType==="native"||i.responseType==="native-request-init")return!0;let r,n;if(s&&(s.error&&typeof s.error=="object"?r=s.error:s.status==="error"&&Array.isArray(s.messages)&&(r={...s},r[VN]=s,r.details=s.messages)),!r&&!e.ok)throw r=new Error(`Unable to load ${e.url} status: ${e.status}`),r[VN]=s,r;let o,a=null;r&&(n=Number(r.code),a=r.hasOwnProperty("subcode")?Number(r.subcode):null,o=r.messageCode,o=o==null?void 0:o.toUpperCase());const l=i.authMode;if(n===403&&(a===4||(u=r.message)!=null&&u.toLowerCase().includes("ssl")&&!r.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(l!=="no-prompt"||n===498)&&n!==void 0&&uTe.has(n)&&!nle(t.params.url)&&(n!==403||(!o||!cTe.has(o))&&(a==null||a===2&&t.credentialToken))){await h5();try{const c=await Mt.getCredential(t.params.url,{error:zc("request:server",r,t.params),prompt:l!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=c,t.credentialToken=c.token,t.useSSL=t.useSSL||c.ssl,!1}catch(c){if(l==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;r=c}}if(r)throw r;return!0}function EW(t,e,s=!1){const i=e.controller.signal,r=new Image;return e.withCredentials?r.crossOrigin="use-credentials":r.crossOrigin="anonymous",r.alt="",r.fetchPriority=Au.priority,r.src=t,rTe(r,t,s,i)}function bTe(t){let e,s;return typeof t=="string"?(e=Ul(t,!0),s=ON(t)):(e=t.origin,s=ON(t.toString())),e==null?null:{origin:e,isHosted:s}}function Ii(t){if(!Ds.assetsPath)throw Ne.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new ae("assets:path-not-set","config.assetsPath is not set");return L_(Ds.assetsPath,t)}let l4,ue=null;function qD(){return!!ue}function xTe(){return!!ge("esri-wasm")}function Oz(){return l4||(l4=me(()=>import("./pe-wasm-Co3DzcyP.js"),__vite__mapDeps([0,1])).then(t=>t.p).then(({default:t})=>t({locateFile:e=>Ii(`esri/geometry/support/${e}`)})).then(t=>{lle(t)}),l4)}var d5,Oi;(function(t){function e(n,o,a){ue.ensureCache.prepare();const l=Xy(a),u=a===l,c=ue.ensureFloat64(l),h=ue._pe_geog_to_proj(ue.getPointer(n),o,c);return h&&wf(a,o,c,u),h}function s(n,o,a,l){switch(l){case Oi.PE_TRANSFORM_P_TO_G:return i(n,o,a);case Oi.PE_TRANSFORM_G_TO_P:return e(n,o,a)}return 0}function i(n,o,a){return r(n,o,a,0)}function r(n,o,a,l){ue.ensureCache.prepare();const u=Xy(a),c=a===u,h=ue.ensureFloat64(u),m=ue._pe_proj_to_geog_center(ue.getPointer(n),o,h,l);return m&&wf(a,o,h,c),m}t.geogToProj=e,t.projGeog=s,t.projToGeog=i,t.projToGeogCenter=r})(d5||(d5={})),function(t){function e(){t.PE_BUFFER_MAX=ue.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=ue.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=ue.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=ue.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=ue.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=ue.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=ue.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=ue.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=ue.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=ue.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=ue.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=ue.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=ue.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=ue.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=ue.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=ue.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=ue.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=ue.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=ue.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=ue.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_STR_FMT_WKT=ue.PeDefs.prototype.PE_STR_FMT_WKT,t.PE_STR_FMT_WKT2=ue.PeDefs.prototype.PE_STR_FMT_WKT2,t.PE_PARM_X0=ue.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=ue.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=ue.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=ue.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=ue.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=ue.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=ue.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=ue.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=ue.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=ue.PeDefs.prototype.PE_HORIZON_DELTA}t.init=e}(Oi||(Oi={}));let ole=null;var p5;(function(t){const e={},s={},i=f=>{const g=f.getType();switch(g){case Oi.PE_TYPE_GEOGCS:f=ue.castObject(f,ue.PeGeogcs);break;case Oi.PE_TYPE_PROJCS:f=ue.castObject(f,ue.PeProjcs);break;case Oi.PE_TYPE_GEOGTRAN:f=ue.castObject(f,ue.PeGeogtran);break;default:g&Oi.PE_TYPE_UNIT&&(f=ue.castObject(f,ue.PeUnit))}return f};function r(){ue.PeFactory.prototype.initialize(null)}function n(f){return o(Oi.PE_TYPE_COORDSYS,f)}function o(f,g){let v=null,b=e[f];if(b||(b={},e[f]=b),b.hasOwnProperty(String(g))&&(v=b[g],ue.compare(v,ue.NULL)&&(v=null)),!v){const w=ue.PeFactory.prototype.factoryByType(f,g);ue.compare(w,ue.NULL)||(v=i(w),b[g]=v)}return v}function a(f,g){let v=null,b=s[f];if(b||(b={},s[f]=b),b.hasOwnProperty(g)&&(v=b[g],ue.compare(v,ue.NULL)&&(v=null)),!v){const w=ue.PeFactory.prototype.fromString(f,g);ue.compare(w,ue.NULL)||(v=i(w),b[g]=v)}return v}function l(f){return o(Oi.PE_TYPE_GEOGCS,f)}function u(f){return o(Oi.PE_TYPE_GEOGTRAN,f)}function c(f){return ue.PeFactory.prototype.getCode(f)}function h(f){return o(Oi.PE_TYPE_PROJCS,f)}function m(f){return o(Oi.PE_TYPE_UNIT,f)}t.initialize=r,t.coordsys=n,t.factoryByType=o,t.fromString=a,t.geogcs=l,t.geogtran=u,t.getCode=c,t.projcs=h,t.unit=m})(p5||(p5={}));let ale=null;var qN,f5,g5,y5,_5,v5,GN,b5,zN,UN,x5;function lle(t){function e(n,o,a){n[o]=a(n[o])}ue=t,Oi.init(),qN.init(),GN.init(),zN.init(),UN.init(),ole=class extends ue.PeDouble{constructor(n=NaN){super(n)}destroy(){ue.destroy(this)}[Symbol.dispose](){this.destroy()}},ale=class extends ue.PeGCSExtent{destroy(){ue.destroy(this)}[Symbol.dispose](){this.destroy()}};const s=[ue.PeAngunit,ue.PeDatum,ue.PeGeogcs,ue.PeGeogtran,ue.PeObject,ue.PeParameter,ue.PePrimem,ue.PeProjcs,ue.PeSpheroid,ue.PeUnit];for(const n of s)e(n.prototype,"getName",o=>function(){return o.call(this,new Array(Oi.PE_NAME_MAX))});for(const n of[ue.PeGeogtran,ue.PeProjcs])e(n.prototype,"getParameters",o=>function(){const a=new Array(Oi.PE_PARM_MAX);let l=o.call(this);for(let u=0;u<a.length;u++){const c=ue.getValue(l,"*");a[u]=c?ue.wrapPointer(c,ue.PeParameter):null,l+=Int32Array.BYTES_PER_ELEMENT}return a});e(ue.PeHorizon.prototype,"getCoord",n=>function(o=!1){const a=this.getSize();if(!a)return null;const l=[];return wf(l,a,n.call(this),o),l}),e(ue.PeGTlistExtendedEntry.prototype,"getEntries",n=>{const o=ue._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const l=n.call(this);if(!ue.compare(l,ue.NULL)){a=[l];const u=this.getSteps();if(u>1){const c=ue.getPointer(l);for(let h=1;h<u;h++)a.push(ue.wrapPointer(c+o*h,ue.PeGTlistExtendedGTs))}}return a}});const i=ue._pe_getPeHorizonSize(),r=n=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(n))return o.get(n);let a=null;const l=n.call(this);if(!ue.compare(l,ue.NULL)){a=[l];const u=l.getNump();if(u>1){const c=ue.getPointer(l);for(let h=1;h<u;h++)a.push(ue.wrapPointer(c+i*h,ue.PeHorizon))}}return o.set(n,a),a};e(ue.PeProjcs.prototype,"horizonGcsGenerate",r),e(ue.PeProjcs.prototype,"horizonPcsGenerate",r),ue.PeObject.prototype.toString=function(n=Oi.PE_STR_OPTS_NONE){ue.ensureCache.prepare();const o=ue.getPointer(this),a=ue.ensureInt8(new Array(Oi.PE_BUFFER_MAX));return ue.UTF8ToString(ue._pe_object_to_string_ext(o,n,a))},ue.PeGeogcs.prototype.destroy=function(){this.Delete(),Cc(this),this.ptr=0},ue.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},ue.PeProjcs.prototype.destroy=function(){this.Delete(),Cc(this),this.ptr=0},ue.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function Cc(t){if(!t)return;const e=ue.getClass(t);if(!e)return;const s=ue.getCache(e);if(!s)return;const i=ue.getPointer(t);i&&delete s[i]}function WT(t,e){const s=[],i=new Array(e);for(let r=0;r<t;r++)s.push(ue.ensureInt8(i));return s}function Xy(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function wf(t,e,s,i=!1){if(i)for(let r=0;r<2*e;r++)t[r]=ue.getValue(s+r*Float64Array.BYTES_PER_ELEMENT,"double");else{const r=t.length===0;for(let n=0;n<e;n++)r&&(t[n]=new Array(2)),t[n][0]=ue.getValue(s,"double"),t[n][1]=ue.getValue(s+Float64Array.BYTES_PER_ELEMENT,"double"),s+=2*Float64Array.BYTES_PER_ELEMENT}}(function(t){let e;function s(){t.PE_GTLIST_OPTS_COMMON=ue.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=ue._pe_getPeGTlistExtendedEntrySize()}function i(r,n,o,a,l,u){let c=null;const h=new ue.PeInteger(u);try{const m=ue.PeGTlistExtended.prototype.getGTlist(r,n,o,a,l,h);if((u=h.val)&&(c=[m],u>1)){const f=ue.getPointer(m);for(let g=1;g<u;g++)c.push(ue.wrapPointer(f+e*g,ue.PeGTlistExtendedEntry))}}finally{ue.destroy(h)}return c}t.init=s,t.getGTlist=i})(qN||(qN={})),function(t){function e(s){if(s!=null&&s.length){for(const i of s)Cc(i),i.getEntries().forEach(r=>{Cc(r);const n=r.getGeogtran();Cc(n),n.getParameters().forEach(Cc),[n.getGeogcs1(),n.getGeogcs2()].forEach(o=>{Cc(o);const a=o.getDatum();Cc(a),Cc(a.getSpheroid()),Cc(o.getPrimem()),Cc(o.getUnit())})});ue.PeGTlistExtendedEntry.prototype.Delete(s[0])}}t.destroy=e}(f5||(f5={})),function(t){function e(s,i,r,n,o){ue.ensureCache.prepare();const a=Xy(r),l=r===a,u=ue.ensureFloat64(a);let c=0;n&&(c=ue.ensureFloat64(n));const h=ue._pe_geog_to_geog(ue.getPointer(s),i,u,c,o);return h&&wf(r,i,u,l),h}t.geogToGeog=e}(g5||(g5={})),function(t){function e(n,o,a,l,u,c,h,m){ue.PeLineType.prototype.geodesic_coordinate(n,o,a,l,u,c,h,m)}function s(n,o,a,l,u,c,h,m,f){ue.PeLineType.prototype.geodetic_coordinate(n,o,a,l,u,c,h,m,f)}function i(n,o,a,l,u,c,h,m,f,g){ue.PeLineType.prototype.geodetic_distance(n,o,a,l,u,c,h,m,f,g)}function r(n,o,a,l,u,c,h,m,f){ue.PeLineType.prototype.great_elliptic_distance(n,o,a,l,u,c,h,m,f)}t.geodesicCoordinate=e,t.geodeticCoordinate=s,t.geodeticDistance=i,t.greatEllipticDistance=r}(y5||(y5={})),function(t){function e(o,a){return ue.PeMath.prototype.phi_to_eta(o,a)}function s(o,a){return ue.PeMath.prototype.eta_to_phi(o,a)}function i(o,a){return ue.PeMath.prototype.phi_to_phig(o,a)}function r(o,a,l){return ue.PeMath.prototype.q(o,a,l)}function n(o,a){return ue.PeMath.prototype.q90(o,a)}t.phiToEta=e,t.etaToPhi=s,t.phiToPhig=i,t.q=r,t.q90=n}(_5||(_5={})),function(t){const e=(u,c,h,m,f,g)=>{let v,b;switch(ue.ensureCache.prepare(),u){case"dd":v=ue._pe_geog_to_dd,b=Oi.PE_DD_MAX;break;case"ddm":v=ue._pe_geog_to_ddm,b=Oi.PE_DDM_MAX;break;case"dms":v=ue._pe_geog_to_dms,b=Oi.PE_DMS_MAX}let w=0;c&&(w=ue.getPointer(c));const S=Xy(m),T=ue.ensureFloat64(S),P=WT(h,b),I=v(w,h,T,f,ue.ensureInt32(P));if(I)for(let A=0;A<h;A++)g[A]=ue.UTF8ToString(P[A]);return I},s=(u,c,h,m,f)=>{let g;switch(ue.ensureCache.prepare(),u){case"dd":g=ue._pe_dd_to_geog;break;case"ddm":g=ue._pe_ddm_to_geog;break;case"dms":g=ue._pe_dms_to_geog}let v=0;c&&(v=ue.getPointer(c));const b=m.map(P=>ue.ensureString(P)),w=ue.ensureInt32(b),S=ue.ensureFloat64(new Array(2*h)),T=g(v,h,w,S);return T&&wf(f,h,S),T};function i(u,c,h,m,f){return e("dms",u,c,h,m,f)}function r(u,c,h,m){return s("dms",u,c,h,m)}function n(u,c,h,m,f){return e("ddm",u,c,h,m,f)}function o(u,c,h,m){return s("ddm",u,c,h,m)}function a(u,c,h,m,f){return e("dd",u,c,h,m,f)}function l(u,c,h,m){return s("dd",u,c,h,m)}t.geogToDms=i,t.dmsToGeog=r,t.geogToDdm=n,t.ddmToGeog=o,t.geogToDd=a,t.ddToGeog=l}(v5||(v5={})),function(t){function e(){t.PE_MGRS_STYLE_NEW=ue.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=ue.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=ue.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=ue.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=ue.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function s(r,n,o,a,l,u,c){ue.ensureCache.prepare();let h=0;r&&(h=ue.getPointer(r));const m=Xy(o),f=ue.ensureFloat64(m),g=WT(n,Oi.PE_MGRS_MAX),v=ue.ensureInt32(g),b=ue._pe_geog_to_mgrs_extended(h,n,f,a,l,u,v);if(b)for(let w=0;w<n;w++)c[w]=ue.UTF8ToString(g[w]);return b}function i(r,n,o,a,l){ue.ensureCache.prepare();let u=0;r&&(u=ue.getPointer(r));const c=o.map(g=>ue.ensureString(g)),h=ue.ensureInt32(c),m=ue.ensureFloat64(new Array(2*n)),f=ue._pe_mgrs_to_geog_extended(u,n,h,a,m);return f&&wf(l,n,m),f}t.init=e,t.geogToMgrsExtended=s,t.mgrsToGeogExtended=i}(GN||(GN={})),function(t){function e(i,r,n,o,a,l,u){ue.ensureCache.prepare();let c=0;i&&(c=ue.getPointer(i));const h=Xy(n),m=ue.ensureFloat64(h),f=WT(r,Oi.PE_MGRS_MAX),g=ue.ensureInt32(f),v=ue._pe_geog_to_usng(c,r,m,o,a,l,g);if(v)for(let b=0;b<r;b++)u[b]=ue.UTF8ToString(f[b]);return v}function s(i,r,n,o){ue.ensureCache.prepare();let a=0;i&&(a=ue.getPointer(i));const l=n.map(m=>ue.ensureString(m)),u=ue.ensureInt32(l),c=ue.ensureFloat64(new Array(2*r)),h=ue._pe_usng_to_geog(a,r,u,c);return h&&wf(o,r,c),h}t.geogToUsng=e,t.usngToGeog=s}(b5||(b5={})),function(t){function e(){t.PE_UTM_OPTS_NONE=ue.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=ue.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=ue.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function s(r,n,o,a,l){ue.ensureCache.prepare();let u=0;r&&(u=ue.getPointer(r));const c=Xy(o),h=ue.ensureFloat64(c),m=WT(n,Oi.PE_UTM_MAX),f=ue.ensureInt32(m),g=ue._pe_geog_to_utm(u,n,h,a,f);if(g)for(let v=0;v<n;v++)l[v]=ue.UTF8ToString(m[v]);return g}function i(r,n,o,a,l){ue.ensureCache.prepare();let u=0;r&&(u=ue.getPointer(r));const c=o.map(g=>ue.ensureString(g)),h=ue.ensureInt32(c),m=ue.ensureFloat64(new Array(2*n)),f=ue._pe_utm_to_geog(u,n,h,a,m);return f&&wf(l,n,m),f}t.init=e,t.geogToUtm=s,t.utmToGeog=i}(zN||(zN={})),function(t){const e=new Map;function s(){t.PE_PCSINFO_OPTION_NONE=ue.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=ue.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=ue.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=ue.PePCSInfo.prototype.PE_POLE_POINT}function i(r,n=t.PE_PCSINFO_OPTION_DOMAIN){let o=null,a=null;return e.has(r)&&(a=e.get(r),a[n]&&(o=a[n])),o||(o=ue.PePCSInfo.prototype.generate(r,n),a||(a=[],e.set(r,a)),a[n]=o),o}t.init=s,t.generate=i}(UN||(UN={})),function(t){function e(){return ue.PeVersion.prototype.version_string()}t.versionString=e}(x5||(x5={}));const ule=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return d5},get PeDefs(){return Oi},get PeDouble(){return ole},get PeFactory(){return p5},get PeGCSExtent(){return ale},get PeGTTransformations(){return g5},get PeGTlistExtended(){return qN},get PeGTlistExtendedEntry(){return f5},get PeLineType(){return y5},get PeMath(){return _5},get PeNotationDms(){return v5},get PeNotationMgrs(){return GN},get PeNotationUsng(){return b5},get PeNotationUtm(){return zN},get PePCSInfo(){return UN},get PeVersion(){return x5},_init:lle,get _pe(){return ue},isLoaded:qD,isSupported:xTe,load:Oz},Symbol.toStringTag,{value:"Module"}));var q_;(function(t){t[t.CGCS2000=4490]="CGCS2000",t[t.GCSMARS2000=104971]="GCSMARS2000",t[t.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",t[t.GCSMOON2000=104903]="GCSMOON2000"})(q_||(q_={}));let E;const Y={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10665:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(E=2e3;E<=2045;E++)Y[E]=0;for(E=2056;E<=2065;E++)Y[E]=0;for(E=2067;E<=2135;E++)Y[E]=0;for(E=2137;E<=2154;E++)Y[E]=0;for(E=2161;E<=2170;E++)Y[E]=0;for(E=2172;E<=2193;E++)Y[E]=0;for(E=2195;E<=2198;E++)Y[E]=0;for(E=2200;E<=2203;E++)Y[E]=0;for(E=2205;E<=2217;E++)Y[E]=0;for(E=2222;E<=2224;E++)Y[E]=1;for(E=2225;E<=2250;E++)Y[E]=2;for(E=2251;E<=2253;E++)Y[E]=1;for(E=2257;E<=2264;E++)Y[E]=2;for(E=2274;E<=2279;E++)Y[E]=2;for(E=2280;E<=2282;E++)Y[E]=1;for(E=2283;E<=2289;E++)Y[E]=2;for(E=2290;E<=2292;E++)Y[E]=0;for(E=2308;E<=2313;E++)Y[E]=0;for(E=2315;E<=2491;E++)Y[E]=0;for(E=2494;E<=2866;E++)Y[E]=0;for(E=2867;E<=2869;E++)Y[E]=1;for(E=2870;E<=2888;E++)Y[E]=2;for(E=2891;E<=2895;E++)Y[E]=2;for(E=2896;E<=2898;E++)Y[E]=1;for(E=2902;E<=2908;E++)Y[E]=2;for(E=2915;E<=2920;E++)Y[E]=2;for(E=2921;E<=2923;E++)Y[E]=1;for(E=2924;E<=2930;E++)Y[E]=2;for(E=2931;E<=2962;E++)Y[E]=0;for(E=2964;E<=2968;E++)Y[E]=2;for(E=2969;E<=2973;E++)Y[E]=0;for(E=2975;E<=2991;E++)Y[E]=0;for(E=2995;E<=3051;E++)Y[E]=0;for(E=3054;E<=3079;E++)Y[E]=0;for(E=3081;E<=3088;E++)Y[E]=0;for(E=3092;E<=3101;E++)Y[E]=0;for(E=3106;E<=3138;E++)Y[E]=0;for(E=3146;E<=3151;E++)Y[E]=0;for(E=3153;E<=3166;E++)Y[E]=0;for(E=3168;E<=3172;E++)Y[E]=0;for(E=3174;E<=3203;E++)Y[E]=0;for(E=3294;E<=3358;E++)Y[E]=0;for(E=3367;E<=3403;E++)Y[E]=0;for(E=3408;E<=3416;E++)Y[E]=0;for(E=3417;E<=3438;E++)Y[E]=2;for(E=3441;E<=3446;E++)Y[E]=2;for(E=3447;E<=3450;E++)Y[E]=0;for(E=3451;E<=3459;E++)Y[E]=2;for(E=3460;E<=3478;E++)Y[E]=0;for(E=3554;E<=3559;E++)Y[E]=0;for(E=3560;E<=3570;E++)Y[E]=2;for(E=3571;E<=3581;E++)Y[E]=0;for(E=3594;E<=3597;E++)Y[E]=0;for(E=3601;E<=3604;E++)Y[E]=0;for(E=3637;E<=3639;E++)Y[E]=0;for(E=3665;E<=3667;E++)Y[E]=0;for(E=3693;E<=3695;E++)Y[E]=0;for(E=3701;E<=3727;E++)Y[E]=0;for(E=3728;E<=3739;E++)Y[E]=2;for(E=3740;E<=3751;E++)Y[E]=0;for(E=3753;E<=3760;E++)Y[E]=2;for(E=3761;E<=3773;E++)Y[E]=0;for(E=3775;E<=3777;E++)Y[E]=0;for(E=3779;E<=3781;E++)Y[E]=0;for(E=3783;E<=3785;E++)Y[E]=0;for(E=3788;E<=3791;E++)Y[E]=0;for(E=3797;E<=3802;E++)Y[E]=0;for(E=3814;E<=3816;E++)Y[E]=0;for(E=3825;E<=3829;E++)Y[E]=0;for(E=3832;E<=3841;E++)Y[E]=0;for(E=3844;E<=3852;E++)Y[E]=0;for(E=3873;E<=3885;E++)Y[E]=0;for(E=3890;E<=3893;E++)Y[E]=0;for(E=3907;E<=3912;E++)Y[E]=0;for(E=3942;E<=3950;E++)Y[E]=0;for(E=3968;E<=3970;E++)Y[E]=0;for(E=3973;E<=3976;E++)Y[E]=0;for(E=3986;E<=3989;E++)Y[E]=0;for(E=3994;E<=3997;E++)Y[E]=0;for(E=4048;E<=4051;E++)Y[E]=0;for(E=4056;E<=4063;E++)Y[E]=0;for(E=4093;E<=4096;E++)Y[E]=0;for(E=4390;E<=4398;E++)Y[E]=0;for(E=4399;E<=4413;E++)Y[E]=2;for(E=4418;E<=4433;E++)Y[E]=2;for(E=4455;E<=4457;E++)Y[E]=2;for(E=4484;E<=4489;E++)Y[E]=0;for(E=4491;E<=4554;E++)Y[E]=0;for(E=4568;E<=4589;E++)Y[E]=0;for(E=4652;E<=4656;E++)Y[E]=0;for(E=4766;E<=4800;E++)Y[E]=0;for(E=5014;E<=5016;E++)Y[E]=0;for(E=5069;E<=5072;E++)Y[E]=0;for(E=5105;E<=5130;E++)Y[E]=0;for(E=5167;E<=5188;E++)Y[E]=0;for(E=5253;E<=5259;E++)Y[E]=0;for(E=5269;E<=5275;E++)Y[E]=0;for(E=5292;E<=5311;E++)Y[E]=0;for(E=5329;E<=5331;E++)Y[E]=0;for(E=5343;E<=5349;E++)Y[E]=0;for(E=5355;E<=5357;E++)Y[E]=0;for(E=5387;E<=5389;E++)Y[E]=0;for(E=5459;E<=5463;E++)Y[E]=0;for(E=5479;E<=5482;E++)Y[E]=0;for(E=5518;E<=5520;E++)Y[E]=0;for(E=5530;E<=5539;E++)Y[E]=0;for(E=5550;E<=5552;E++)Y[E]=0;for(E=5562;E<=5583;E++)Y[E]=0;for(E=5623;E<=5625;E++)Y[E]=2;for(E=5631;E<=5639;E++)Y[E]=0;for(E=5649;E<=5653;E++)Y[E]=0;for(E=5663;E<=5680;E++)Y[E]=0;for(E=5682;E<=5685;E++)Y[E]=0;for(E=5875;E<=5877;E++)Y[E]=0;for(E=5896;E<=5899;E++)Y[E]=0;for(E=5921;E<=5940;E++)Y[E]=0;for(E=6050;E<=6125;E++)Y[E]=0;for(E=6244;E<=6275;E++)Y[E]=0;for(E=6328;E<=6348;E++)Y[E]=0;for(E=6350;E<=6356;E++)Y[E]=0;for(E=6366;E<=6372;E++)Y[E]=0;for(E=6381;E<=6387;E++)Y[E]=0;for(E=6393;E<=6404;E++)Y[E]=0;for(E=6480;E<=6483;E++)Y[E]=0;for(E=6511;E<=6514;E++)Y[E]=0;for(E=6579;E<=6581;E++)Y[E]=0;for(E=6619;E<=6624;E++)Y[E]=0;for(E=6625;E<=6627;E++)Y[E]=2;for(E=6628;E<=6632;E++)Y[E]=0;for(E=6634;E<=6637;E++)Y[E]=0;for(E=6669;E<=6692;E++)Y[E]=0;for(E=6707;E<=6709;E++)Y[E]=0;for(E=6720;E<=6723;E++)Y[E]=0;for(E=6732;E<=6738;E++)Y[E]=0;for(E=6931;E<=6933;E++)Y[E]=0;for(E=6956;E<=6959;E++)Y[E]=0;for(E=7005;E<=7007;E++)Y[E]=0;for(E=7057;E<=7070;E++)Y[E]=2;for(E=7074;E<=7082;E++)Y[E]=0;for(E=7109;E<=7118;E++)Y[E]=0;for(E=7119;E<=7127;E++)Y[E]=1;for(E=7374;E<=7376;E++)Y[E]=0;for(E=7528;E<=7586;E++)Y[E]=0;for(E=7587;E<=7645;E++)Y[E]=2;for(E=7692;E<=7696;E++)Y[E]=0;for(E=7755;E<=7787;E++)Y[E]=0;for(E=7791;E<=7795;E++)Y[E]=0;for(E=7799;E<=7801;E++)Y[E]=0;for(E=7803;E<=7805;E++)Y[E]=0;for(E=7825;E<=7831;E++)Y[E]=0;for(E=7845;E<=7859;E++)Y[E]=0;for(E=8013;E<=8032;E++)Y[E]=0;for(E=8065;E<=8068;E++)Y[E]=1;for(E=8518;E<=8529;E++)Y[E]=2;for(E=8533;E<=8536;E++)Y[E]=2;for(E=8538;E<=8540;E++)Y[E]=2;for(E=8677;E<=8679;E++)Y[E]=0;for(E=8836;E<=8840;E++)Y[E]=0;for(E=8857;E<=8859;E++)Y[E]=0;for(E=8908;E<=8910;E++)Y[E]=0;for(E=9154;E<=9159;E++)Y[E]=0;for(E=9205;E<=9218;E++)Y[E]=0;for(E=9271;E<=9273;E++)Y[E]=0;for(E=9295;E<=9297;E++)Y[E]=0;for(E=9356;E<=9360;E++)Y[E]=0;for(E=9404;E<=9407;E++)Y[E]=0;for(E=9476;E<=9482;E++)Y[E]=0;for(E=9487;E<=9494;E++)Y[E]=0;for(E=9697;E<=9699;E++)Y[E]=0;for(E=9821;E<=9865;E++)Y[E]=0;for(E=10285;E<=10291;E++)Y[E]=0;for(E=10314;E<=10317;E++)Y[E]=0;for(E=10448;E<=10465;E++)Y[E]=0;for(E=10731;E<=10733;E++)Y[E]=0;for(E=11114;E<=11118;E++)Y[E]=0;for(E=20004;E<=20032;E++)Y[E]=0;for(E=20047;E<=20049;E++)Y[E]=0;for(E=20062;E<=20092;E++)Y[E]=0;for(E=20135;E<=20138;E++)Y[E]=0;for(E=20248;E<=20258;E++)Y[E]=0;for(E=20348;E<=20358;E++)Y[E]=0;for(E=20436;E<=20440;E++)Y[E]=0;for(E=20822;E<=20824;E++)Y[E]=0;for(E=20904;E<=20932;E++)Y[E]=0;for(E=20934;E<=20936;E++)Y[E]=0;for(E=21004;E<=21032;E++)Y[E]=0;for(E=21035;E<=21037;E++)Y[E]=0;for(E=21095;E<=21097;E++)Y[E]=0;for(E=21148;E<=21150;E++)Y[E]=0;for(E=21207;E<=21264;E++)Y[E]=0;for(E=21307;E<=21364;E++)Y[E]=0;for(E=21413;E<=21423;E++)Y[E]=0;for(E=21453;E<=21463;E++)Y[E]=0;for(E=21473;E<=21483;E++)Y[E]=0;for(E=21780;E<=21782;E++)Y[E]=0;for(E=21891;E<=21894;E++)Y[E]=0;for(E=21896;E<=21899;E++)Y[E]=0;for(E=22171;E<=22177;E++)Y[E]=0;for(E=22181;E<=22187;E++)Y[E]=0;for(E=22191;E<=22197;E++)Y[E]=0;for(E=22207;E<=22222;E++)Y[E]=0;for(E=22229;E<=22232;E++)Y[E]=0;for(E=22234;E<=22236;E++)Y[E]=0;for(E=22243;E<=22250;E++)Y[E]=0;for(E=22262;E<=22265;E++)Y[E]=0;for(E=22307;E<=22322;E++)Y[E]=0;for(E=22348;E<=22357;E++)Y[E]=0;for(E=22407;E<=22422;E++)Y[E]=0;for(E=22462;E<=22465;E++)Y[E]=0;for(E=22521;E<=22525;E++)Y[E]=0;for(E=22607;E<=22622;E++)Y[E]=0;for(E=22641;E<=22646;E++)Y[E]=0;for(E=22648;E<=22657;E++)Y[E]=0;for(E=22707;E<=22722;E++)Y[E]=0;for(E=22762;E<=22765;E++)Y[E]=0;for(E=22807;E<=22822;E++)Y[E]=0;for(E=22991;E<=22994;E++)Y[E]=0;for(E=23028;E<=23038;E++)Y[E]=0;for(E=23301;E<=23333;E++)Y[E]=2;for(E=23830;E<=23853;E++)Y[E]=0;for(E=23866;E<=23872;E++)Y[E]=0;for(E=23877;E<=23884;E++)Y[E]=0;for(E=23886;E<=23894;E++)Y[E]=0;for(E=23946;E<=23948;E++)Y[E]=0;for(E=24311;E<=24313;E++)Y[E]=0;for(E=24342;E<=24347;E++)Y[E]=0;for(E=24370;E<=24374;E++)Y[E]=10;for(E=24375;E<=24381;E++)Y[E]=0;for(E=24718;E<=24721;E++)Y[E]=0;for(E=24817;E<=24821;E++)Y[E]=0;for(E=24877;E<=24882;E++)Y[E]=0;for(E=24891;E<=24893;E++)Y[E]=0;for(E=25391;E<=25395;E++)Y[E]=0;for(E=25828;E<=25838;E++)Y[E]=0;for(E=26191;E<=26195;E++)Y[E]=0;for(E=26391;E<=26393;E++)Y[E]=0;for(E=26701;E<=26722;E++)Y[E]=0;for(E=26729;E<=26799;E++)Y[E]=2;for(E=26801;E<=26803;E++)Y[E]=2;for(E=26811;E<=26813;E++)Y[E]=2;for(E=26847;E<=26870;E++)Y[E]=2;for(E=26891;E<=26899;E++)Y[E]=0;for(E=26901;E<=26923;E++)Y[E]=0;for(E=26929;E<=26946;E++)Y[E]=0;for(E=26948;E<=26998;E++)Y[E]=0;for(E=27037;E<=27040;E++)Y[E]=0;for(E=27205;E<=27232;E++)Y[E]=0;for(E=27258;E<=27260;E++)Y[E]=0;for(E=27391;E<=27398;E++)Y[E]=0;for(E=27561;E<=27564;E++)Y[E]=0;for(E=27571;E<=27574;E++)Y[E]=0;for(E=27581;E<=27584;E++)Y[E]=0;for(E=27591;E<=27594;E++)Y[E]=0;for(E=27700;E<=27707;E++)Y[E]=0;for(E=28191;E<=28193;E++)Y[E]=0;for(E=28348;E<=28358;E++)Y[E]=0;for(E=28402;E<=28432;E++)Y[E]=0;for(E=28462;E<=28492;E++)Y[E]=0;for(E=29118;E<=29122;E++)Y[E]=0;for(E=29168;E<=29172;E++)Y[E]=0;for(E=29177;E<=29185;E++)Y[E]=0;for(E=29187;E<=29195;E++)Y[E]=0;for(E=29900;E<=29903;E++)Y[E]=0;for(E=30161;E<=30179;E++)Y[E]=0;for(E=30491;E<=30494;E++)Y[E]=0;for(E=30729;E<=30732;E++)Y[E]=0;for(E=31251;E<=31259;E++)Y[E]=0;for(E=31265;E<=31268;E++)Y[E]=0;for(E=31275;E<=31279;E++)Y[E]=0;for(E=31281;E<=31297;E++)Y[E]=0;for(E=31461;E<=31469;E++)Y[E]=0;for(E=31491;E<=31495;E++)Y[E]=0;for(E=31917;E<=31922;E++)Y[E]=0;for(E=31965;E<=32e3;E++)Y[E]=0;for(E=32001;E<=32003;E++)Y[E]=2;for(E=32005;E<=32031;E++)Y[E]=2;for(E=32033;E<=32060;E++)Y[E]=2;for(E=32064;E<=32067;E++)Y[E]=2;for(E=32074;E<=32077;E++)Y[E]=2;for(E=32081;E<=32086;E++)Y[E]=0;for(E=32107;E<=32130;E++)Y[E]=0;for(E=32133;E<=32159;E++)Y[E]=0;for(E=32164;E<=32167;E++)Y[E]=2;for(E=32180;E<=32199;E++)Y[E]=0;for(E=32201;E<=32260;E++)Y[E]=0;for(E=32301;E<=32360;E++)Y[E]=0;for(E=32401;E<=32460;E++)Y[E]=0;for(E=32501;E<=32560;E++)Y[E]=0;for(E=32601;E<=32662;E++)Y[E]=0;for(E=32664;E<=32667;E++)Y[E]=2;for(E=32701;E<=32761;E++)Y[E]=0;for(E=53001;E<=53004;E++)Y[E]=0;for(E=53008;E<=53019;E++)Y[E]=0;for(E=53021;E<=53032;E++)Y[E]=0;for(E=53034;E<=53037;E++)Y[E]=0;for(E=53042;E<=53046;E++)Y[E]=0;for(E=53074;E<=53080;E++)Y[E]=0;for(E=54001;E<=54004;E++)Y[E]=0;for(E=54008;E<=54019;E++)Y[E]=0;for(E=54021;E<=54032;E++)Y[E]=0;for(E=54034;E<=54037;E++)Y[E]=0;for(E=54042;E<=54046;E++)Y[E]=0;for(E=54048;E<=54053;E++)Y[E]=0;for(E=54074;E<=54080;E++)Y[E]=0;for(E=54098;E<=54101;E++)Y[E]=0;for(E=102001;E<=102040;E++)Y[E]=0;for(E=102042;E<=102063;E++)Y[E]=0;for(E=102065;E<=102067;E++)Y[E]=0;for(E=102070;E<=102117;E++)Y[E]=0;for(E=102122;E<=102216;E++)Y[E]=0;for(E=102221;E<=102377;E++)Y[E]=0;for(E=102382;E<=102388;E++)Y[E]=0;for(E=102389;E<=102398;E++)Y[E]=2;for(E=102399;E<=102444;E++)Y[E]=0;for(E=102445;E<=102447;E++)Y[E]=2;for(E=102448;E<=102458;E++)Y[E]=0;for(E=102459;E<=102468;E++)Y[E]=2;for(E=102469;E<=102499;E++)Y[E]=0;for(E=102500;E<=102519;E++)Y[E]=1;for(E=102520;E<=102524;E++)Y[E]=0;for(E=102525;E<=102529;E++)Y[E]=2;for(E=102530;E<=102588;E++)Y[E]=0;for(E=102590;E<=102598;E++)Y[E]=0;for(E=102601;E<=102603;E++)Y[E]=0;for(E=102605;E<=102628;E++)Y[E]=0;for(E=102629;E<=102646;E++)Y[E]=2;for(E=102648;E<=102700;E++)Y[E]=2;for(E=102701;E<=102703;E++)Y[E]=0;for(E=102707;E<=102730;E++)Y[E]=2;for(E=102733;E<=102758;E++)Y[E]=2;for(E=102767;E<=102900;E++)Y[E]=0;for(E=102901;E<=102933;E++)Y[E]=2;for(E=102934;E<=102950;E++)Y[E]=13;for(E=102951;E<=102963;E++)Y[E]=0;for(E=102965;E<=102969;E++)Y[E]=0;for(E=102971;E<=102973;E++)Y[E]=0;for(E=102975;E<=102989;E++)Y[E]=0;for(E=102990;E<=102992;E++)Y[E]=1;for(E=102997;E<=103002;E++)Y[E]=0;for(E=103003;E<=103008;E++)Y[E]=2;for(E=103009;E<=103011;E++)Y[E]=0;for(E=103012;E<=103014;E++)Y[E]=2;for(E=103019;E<=103021;E++)Y[E]=0;for(E=103022;E<=103024;E++)Y[E]=2;for(E=103029;E<=103031;E++)Y[E]=0;for(E=103032;E<=103034;E++)Y[E]=2;for(E=103065;E<=103068;E++)Y[E]=0;for(E=103074;E<=103076;E++)Y[E]=0;for(E=103077;E<=103079;E++)Y[E]=1;for(E=103080;E<=103082;E++)Y[E]=0;for(E=103083;E<=103085;E++)Y[E]=2;for(E=103090;E<=103093;E++)Y[E]=0;for(E=103097;E<=103099;E++)Y[E]=0;for(E=103100;E<=103102;E++)Y[E]=2;for(E=103107;E<=103109;E++)Y[E]=0;for(E=103110;E<=103112;E++)Y[E]=2;for(E=103113;E<=103116;E++)Y[E]=0;for(E=103117;E<=103120;E++)Y[E]=2;for(E=103153;E<=103157;E++)Y[E]=0;for(E=103158;E<=103162;E++)Y[E]=2;for(E=103163;E<=103165;E++)Y[E]=0;for(E=103166;E<=103168;E++)Y[E]=1;for(E=103169;E<=103171;E++)Y[E]=2;for(E=103186;E<=103188;E++)Y[E]=0;for(E=103189;E<=103191;E++)Y[E]=2;for(E=103192;E<=103195;E++)Y[E]=0;for(E=103196;E<=103199;E++)Y[E]=2;for(E=103200;E<=103224;E++)Y[E]=0;for(E=103225;E<=103227;E++)Y[E]=1;for(E=103232;E<=103237;E++)Y[E]=0;for(E=103238;E<=103243;E++)Y[E]=2;for(E=103244;E<=103246;E++)Y[E]=0;for(E=103247;E<=103249;E++)Y[E]=2;for(E=103254;E<=103256;E++)Y[E]=0;for(E=103257;E<=103259;E++)Y[E]=2;for(E=103264;E<=103266;E++)Y[E]=0;for(E=103267;E<=103269;E++)Y[E]=2;for(E=103300;E<=103375;E++)Y[E]=0;for(E=103381;E<=103383;E++)Y[E]=0;for(E=103384;E<=103386;E++)Y[E]=1;for(E=103387;E<=103389;E++)Y[E]=0;for(E=103390;E<=103392;E++)Y[E]=2;for(E=103397;E<=103399;E++)Y[E]=0;for(E=103400;E<=103471;E++)Y[E]=2;for(E=103476;E<=103478;E++)Y[E]=0;for(E=103479;E<=103481;E++)Y[E]=2;for(E=103486;E<=103488;E++)Y[E]=0;for(E=103489;E<=103491;E++)Y[E]=2;for(E=103492;E<=103495;E++)Y[E]=0;for(E=103496;E<=103499;E++)Y[E]=2;for(E=103528;E<=103543;E++)Y[E]=0;for(E=103544;E<=103548;E++)Y[E]=2;for(E=103549;E<=103551;E++)Y[E]=0;for(E=103552;E<=103554;E++)Y[E]=1;for(E=103555;E<=103557;E++)Y[E]=2;for(E=103558;E<=103560;E++)Y[E]=0;for(E=103571;E<=103573;E++)Y[E]=0;for(E=103574;E<=103576;E++)Y[E]=2;for(E=103577;E<=103580;E++)Y[E]=0;for(E=103581;E<=103583;E++)Y[E]=2;for(E=103595;E<=103694;E++)Y[E]=0;for(E=103696;E<=103699;E++)Y[E]=0;for(E=103700;E<=103793;E++)Y[E]=2;for(E=103794;E<=103890;E++)Y[E]=0;for(E=103891;E<=103896;E++)Y[E]=2;for(E=103900;E<=103971;E++)Y[E]=2;for(E=103972;E<=103977;E++)Y[E]=0;for(E=112e3;E<=112101;E++)Y[E]=0;const cle=[102100,102113,3857,3785,900913],wTe=[104905,104971],STe=[4326,...cle,...wTe],TE=[-20037508342788905e-9,20037508342788905e-9],w5=[-20037508342787e-6,20037508342787e-6],u4={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:TE,origin:w5,dx:1e-5},hle={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:TE,origin:w5,dx:1e-5},102100:u4,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:TE,origin:w5,dx:1e-5},3857:u4,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:u4};function on(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const s=t.wkid,i=e.wkid;if(s!=null||i!=null){if(s===i||Yc(t)&&Yc(e))return!0;const o=t.latestWkid;if(o!=null&&i===o)return!0;const a=e.latestWkid;return a!=null&&s===a}let r,n;return t.wkt2&&e.wkt2?(r=t.wkt2,n=e.wkt2):t.wkt&&e.wkt&&(r=t.wkt,n=e.wkt),!(!r||!n)&&r.toUpperCase()===n.toUpperCase()}function ya(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&hle[e]||null}function BN(t){if(!t)return;const{wkid:e,vcsWkid:s}=t;if(e)return s?JSON.stringify({wkid:e,vcsWkid:s}):String(e);const i=t.wkt||t.wkt2;return JSON.stringify(i?s?{wkt:i,vcsWkid:s}:{wkt:i}:{})}function Td(t){if(!Ll(t))return!1;const{wkid:e}=t;if(e)return Y[e]==null;const s=t.wkt2||t.wkt;return!!s&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(s)}function ETe(t){return!(mle(t)||dle(t))}function G_(t){return(t==null?void 0:t.wkid)===4326}function nht(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function CW(t){return(t==null?void 0:t.wkid)===q_.CGCS2000}function Yc(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&cle.includes(e)}function CTe(t){return(t==null?void 0:t.wkid)===32662}function GD(t){return t===q_.GCSMARS2000||t===q_.GCSMARS2000_SPHERE}function mle(t){return GD(t==null?void 0:t.wkid)}function zD(t){return t===q_.GCSMOON2000}function dle(t){return zD(t==null?void 0:t.wkid)}function PTe(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&STe.includes(e)}function Ll(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const ple={wkid:4326,wkt:jc(hle[4326].wkTemplate,{Central_Meridian:"0.0"})},fle={wkid:102100,latestWkid:3857},TTe={wkid:32662};function Lz(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const ITe=Lz(lr),Vz=Lz(Hh),qz=Lz(Wf),MTe={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${lr.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},ATe=Vz.wkt.toUpperCase(),NTe=qz.wkt.toUpperCase();function gle(t){if(t!=null&&Ll(t)){const e=t.wkid,s=t.wkt2??t.wkt;if(GD(e))return Hh;const i=s==null?void 0:s.toUpperCase();if(s&&i===ATe)return Hh;if(zD(e)||i&&i===NTe)return Wf}return lr}function oht(t){return GD(t)?Hh:zD(t)?Wf:lr}function jN(t){return on(t,ITe)}function Qf(t){return jN(t)||on(t,Vz)||on(t,qz)}const yle=39.37,DTe=lr.radius*Math.PI/200,_le=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,vb=Y,vle=/UNIT\[([^\]]+)]/i,ble=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),$Te=Xn()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),ec=t=>t*t,yp=t=>t*t*t,IE={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:ec(.001)},"square-centimeters":{inBaseUnits:ec(.01)},"square-decimeters":{inBaseUnits:ec(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:ec(1e3)},"square-inches":{inBaseUnits:ec(.0254)},"square-feet":{inBaseUnits:ec(.3048)},"square-yards":{inBaseUnits:ec(.9144)},"square-miles":{inBaseUnits:ec(1609.344)},"square-nautical-miles":{inBaseUnits:ec(1852)},"square-us-feet":{inBaseUnits:ec(1200/3937)},acres:{inBaseUnits:.0015625*ec(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*yp(.001)},"cubic-centimeters":{inBaseUnits:1e3*yp(.01)},"cubic-decimeters":{inBaseUnits:1e3*yp(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*yp(1e3)},"cubic-inches":{inBaseUnits:1e3*yp(.0254)},"cubic-feet":{inBaseUnits:1e3*yp(.3048)},"cubic-yards":{inBaseUnits:1e3*yp(.9144)},"cubic-miles":{inBaseUnits:1e3*yp(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},RTe=(()=>{const t={};for(const e in IE)for(const s in IE[e].units)t[s]=e;return t})();function kTe(t,e,s){return t*IE[s].units[e].inBaseUnits}function FTe(t,e,s){return t/IE[s].units[e].inBaseUnits}const xle=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],OTe=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function z_(t){const e=RTe[t];if(!e)throw new Error("unknown type");return e}function PW(t,e=null){return e=e||z_(t),IE[e].baseUnit===t}function os(t,e,s){if(e===s)return t;const i=z_(e);if(i!==z_(s))throw new Error("incompatible units");const r=PW(e,i)?t:kTe(t,e,i);return PW(s,i)?r:FTe(r,s,i)}function aht(t,e,s,i=!1){if(!i&&Td(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const r=p0(e);return r!==s&&(t=r?os(t,r,s):os(t*=Uu(e),"meters",s)),t}function lht(t,e,s,i=!1){if(!i&&Td(s))throw new Error("Unable to convert from a linear unit to an angular unit.");const r=p0(s);return e!==r&&(t=r?os(t,e,r):os(t,e,"meters")/Uu(s)),t}function LTe(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function uht(t){return LTe(t)}function cht(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function wle(t,e){const s=os(t,e,"meters");return Math.abs(s)<3e3?"meters":"kilometers"}function Sle(t,e){const s=os(t,e,"meters");return Math.abs(s)<1e5?"meters":"kilometers"}function Ele(t,e){const s=os(t,e,"feet");return Math.abs(s)<1e3?"feet":"miles"}function Cle(t,e){const s=os(t,e,"feet");return Math.abs(s)<1e5?"feet":"miles"}function VTe(t,e){const s=os(t,e,"square-meters");return Math.abs(s)<3e6?"square-meters":"square-kilometers"}function qTe(t,e){const s=os(t,e,"square-feet");return Math.abs(s)<1e6?"square-feet":"square-miles"}function Ple(t,e,s){return os(t,e,"meters")/(s*Math.PI/180)}function Gz(t){return $Te.fromJSON(t.toLowerCase())||null}function bb(t){if(t!=null&&!ETe(t))return 1;const e=Uu(t);return e>1e5?1:e}function Tle(t){return Uu(t)>=gle(t).metersPerDegree?"meters":p0(t)}function Uu(t,e=lr.metersPerDegree){return zz(t,!0)??e}function zz(t,e=!1){const s=(t==null?void 0:t.wkid)??null,i=(t==null?void 0:t.wkt2)??(t==null?void 0:t.wkt)??null;let r=null;if(s){if(GD(s))return Hh.metersPerDegree;if(zD(s))return Wf.metersPerDegree;r=vb.values[vb[s]],!r&&e&&ble.has(s)&&(r=DTe)}else i&&(UD(i)?r=TW(_le.exec(i),r):Mle(i)&&(r=TW(vle.exec(i),r)));return r}function hht(t){return Td(t)?1:Uu(t)}function TW(t,e){return t!=null&&t[1]?Ile(t[1]):e}function Ile(t){return parseFloat(t.split(",")[1])}function p0(t){const e=(t==null?void 0:t.wkid)??null,s=(t==null?void 0:t.wkt2)??(t==null?void 0:t.wkt)??null;let i=null;if(e)i=vb.units[vb[e]];else if(s){const r=UD(s)?_le:Mle(s)?vle:null;if(r){const n=r.exec(s);n!=null&&n[1]&&(i=zTe(n[1]))}}return i!=null?Gz(i):null}function mht(t){const e=p0(t);return e!=null&&xle.includes(e)?e:null}function dht(t){const e=Tle(t);return e!=null&&xle.includes(e)?e:null}function pht(t){const e=p0(t);return e==null?null:OTe.get(e)}function Mle(t){return/^GEOCCS/i.test(t)}function UD(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const GTe=1e-7;function zTe(t){const e=/[\\"']{1}([^\\"']+)/.exec(t);let s=e==null?void 0:e[1];if(!s||!Gz(s)){const i=Ile(t);s=null;const r=vb.values;for(let n=0;n<r.length;++n)if(Math.abs(i-r[n])<GTe){s=vb.units[n];break}}return s}function fht(t){const e=p0(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"fathoms":case"nautical-miles":case"us-chains":case"us-links":case"us-miles":case"clarke-yards":case"clarke-chains":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"sears-links":case"benoit-1895-a-yards":case"benoit-1895-a-feet":case"benoit-1895-a-chains":case"benoit-1895-a-links":case"benoit-1895-b-yards":case"benoit-1895-b-feet":case"benoit-1895-b-chains":case"benoit-1895-b-links":case"1865-feet":case"indian-feet":case"indian-1937-feet":case"indian-1962-feet":case"indian-1975-feet":case"indian-yards":case"indian-1937-yards":case"indian-1962-yards":case"indian-1975-yards":case"statute-miles":case"gold-coast-feet":case"british-1936-feet":case"yards":case"chains":case"links":case"sears-1922-truncated-yards":case"sears-1922-truncated-feet":case"sears-1922-truncated-chains":case"sears-1922-truncated-links":case"us-yards":case"inches":case"us-inches":case"rods":case"us-rods":case"us-nautical-miles":case"uk-nautical-miles":case"smoots":case"tx-vara":case"points":return"imperial";case"millimeters":case"centimeters":case"meters":case"german-meters":case"kilometers":case"decimeters":case"micrometers":case"nanometers":case"50-kilometers":case"150-kilometers":return"metric"}return null}const UTe={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},BTe={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},jTe={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},HTe=Xn()(UTe),YTe=Xn()(BTe),ght=Xn()(jTe);var mh;let Ys=mh=class extends Te{static fromJSON(t){if(!t)return null;if((t==null?void 0:t.wkid)===102100)return mh.WebMercator;if((t==null?void 0:t.wkid)===4326)return mh.WGS84;const e=new mh;return e.read(t),e}constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(t){return t&&typeof t=="object"?t:{[typeof t=="string"?"wkt":"wkid"]:t}}get isWGS84(){return G_(this)}get isWebMercator(){return Yc(this)}get isGeographic(){return Td(this)}get isWrappable(){return PTe(this)}get metersPerUnit(){return Uu(this)}get unit(){return p0(this)||(this.isGeographic?"degrees":null)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===mh.WGS84)return new mh(ple);if(this===mh.WebMercator)return new mh(fle);const t=new mh;return this.wkid!=null?(t.wkid=this.wkid,this.latestWkid!=null&&(t.latestWkid=this.latestWkid),this.vcsWkid!=null&&(t.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(t.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(t.wkt=this.wkt),this.wkt2!=null&&(t.wkt2=this.wkt2)),this.imageCoordinateSystem&&(t.imageCoordinateSystem=he(this.imageCoordinateSystem)),t}equals(t){if(t==null)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(this.imageCoordinateSystem==null||t.imageCoordinateSystem==null)return!1;const{id:e,referenceServiceName:s}=t.imageCoordinateSystem,{geodataXform:i}=t.imageCoordinateSystem,r=this.imageCoordinateSystem;return e==null||i?JSON.stringify(r)===JSON.stringify(t.imageCoordinateSystem):s?r.id===e&&r.referenceServiceName===s:r.id===e}return on(this,t)}toJSON(t){return this.write(void 0,t)}};Ys.GCS_NAD_1927=null,Ys.WGS84=null,Ys.WebMercator=null,Ys.PlateCarree=null,p([_({readOnly:!0})],Ys.prototype,"isWGS84",null),p([_({readOnly:!0})],Ys.prototype,"isWebMercator",null),p([_({readOnly:!0})],Ys.prototype,"isGeographic",null),p([_({readOnly:!0})],Ys.prototype,"isWrappable",null),p([_({type:fs,json:{write:!0}})],Ys.prototype,"latestWkid",void 0),p([_({readOnly:!0})],Ys.prototype,"metersPerUnit",null),p([_({readOnly:!0})],Ys.prototype,"unit",null),p([_({type:fs,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Ys.prototype,"wkid",void 0),p([_({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Ys.prototype,"wkt",void 0),p([Ue("wkt"),Ue("web-scene","wkt")],Ys.prototype,"writeWkt",null),p([_({type:String,json:{write:!1}})],Ys.prototype,"wkt2",void 0),p([_({type:fs,json:{write:!0}})],Ys.prototype,"vcsWkid",void 0),p([_({type:fs,json:{write:!0}})],Ys.prototype,"latestVcsWkid",void 0),p([_()],Ys.prototype,"imageCoordinateSystem",void 0),Ys=mh=p([Q("esri.geometry.SpatialReference")],Ys),Ys.prototype.toJSON.isDefaultToJSON=!0,Ys.GCS_NAD_1927=Ye.freeze(new Ys({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),Ys.WGS84=Ye.freeze(new Ys(ple)),Ys.WebMercator=Ye.freeze(new Ys(fle)),Ys.PlateCarree=Ye.freeze(new Ys(TTe));const St=Ys;let dh=class extends Te{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=St.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,s){if(e instanceof St)return e;if(e!=null){const i=new St;return i.read(e,s),i}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,s){this.cache[e]=s}};p([_()],dh.prototype,"type",void 0),p([_({readOnly:!0})],dh.prototype,"cache",null),p([_({readOnly:!0})],dh.prototype,"extent",null),p([_({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],dh.prototype,"hasM",void 0),p([_({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],dh.prototype,"hasZ",void 0),p([_({type:St,json:{write:!0},value:St.WGS84})],dh.prototype,"spatialReference",void 0),p([qe("spatialReference")],dh.prototype,"readSpatialReference",null),dh=p([Q("esri.geometry.Geometry")],dh);const Ld=dh;function xb(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new ae("Mesh geometries are not supported for this operation")}function XTe(t){t.forEach(xb)}const WTe=57.29577951308232,ZTe=.017453292519943;function IW(t){return t*WTe}function MW(t){return t*ZTe}function _ht(t){return Math.PI/2-2*Math.atan(Math.exp(-t/lr.radius))}function S5(t){return t.wkid!=null||t.wkt!=null}const c4=[0,0];function HN(t,e,s,i,r){const n=t,o=r;if(o.spatialReference=s,"x"in n&&"x"in o)[o.x,o.y]=e(n.x,n.y,c4,i);else if("xmin"in n&&"xmin"in o)[o.xmin,o.ymin]=e(n.xmin,n.ymin,c4,i),[o.xmax,o.ymax]=e(n.xmax,n.ymax,c4,i);else if("paths"in n&&"paths"in o||"rings"in n&&"rings"in o){const a="paths"in n?n.paths:n.rings,l=[];let u;for(let c=0;c<a.length;c++){const h=a[c];u=[],l.push(u);for(let m=0;m<h.length;m++)u.push(e(h[m][0],h[m][1],[0,0],i)),h[m].length>2&&u[m].push(h[m][2]),h[m].length>3&&u[m].push(h[m][3])}"paths"in o?o.paths=l:o.rings=l}else if("points"in n&&"points"in o){const a=n.points,l=[];for(let u=0;u<a.length;u++)l[u]=e(a[u][0],a[u][1],[0,0],i),a[u].length>2&&l[u].push(a[u][2]),a[u].length>3&&l[u].push(a[u][3]);o.points=l}return r}function FM(t,e){const s=t&&(S5(t)?t:t.spatialReference),i=e&&(S5(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!s||!i)&&(!!on(i,s)||Yc(i)&&G_(s)||Yc(s)&&G_(i))}function BD(t,e){if(t==null)return null;const s=t.spatialReference,i=e&&(S5(e)?e:e.spatialReference);return FM(s,i)?on(s,i)?he(t):Yc(i)?HN(t,Tv,St.WebMercator,!1,he(t)):G_(i)?HN(t,jD,St.WGS84,!1,he(t)):null:null}function Tv(t,e,s=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const i=MW(e);return s[0]=MW(t)*lr.radius,s[1]=lr.halfSemiMajorAxis*Math.log((1+Math.sin(i))/(1-Math.sin(i))),s}function jD(t,e,s=[0,0],i=!1){if(t===TE[0])s[0]=-180;else if(t===TE[1])s[0]=180;else{const r=IW(t/lr.radius);s[0]=i?r:r-360*Math.floor((r+180)/360)}return s[1]=IW(Math.PI/2-2*Math.atan(Math.exp(-e/lr.radius))),s}function bd(t,e=!1,s=he(t)){return xb(t),xb(s),HN(t,Tv,St.WebMercator,e,s)}function o_(t,e=!1,s=he(t)){return xb(t),xb(s),HN(t,jD,St.WGS84,e,s)}function Ale(t,e){const s=t.x-e.x,i=t.y-e.y,r=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(s*s+i*i+r*r)}function QTe(t){var e;return((e=Nle(t,Dle))==null?void 0:e[0])??null}function JTe(t){var e;return((e=Nle(t,Dle))==null?void 0:e[1])??null}function Nle({x:t,y:e,spatialReference:s},i=[0,0]){if(s){if(Yc(s))return jD(t,e,i);if(Td(s))return i[0]=t,i[1]=e,i}return null}const Dle=[0,0];var OM;const h4=[0,0];function AW(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let Ko=OM=class extends Ld{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const s=t._get("spatialReference");e._set("spatialReference",Ye.isFrozen(s)?s:s.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,s,i,r){let n;if(Array.isArray(t))n=t,r=e,t=n[0],e=n[1],s=n[2],i=n[3];else if(t&&typeof t=="object"){if(n=t,t=n.x!=null?n.x:n.longitude,e=n.y!=null?n.y:n.latitude,s=n.z,i=n.m,(r=n.spatialReference)&&r.declaredClass!=="esri.geometry.SpatialReference"&&(r=new St(r)),n.longitude!=null||n.latitude!=null){if(n.longitude==null)Ne.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(n.latitude==null)Ne.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!n.declaredClass&&(r!=null&&r.isWebMercator)){const a=Tv(n.longitude,n.latitude,h4);t=a[0],e=a[1]}}}else AW(s)?(r=s,s=null):AW(i)&&(r=i,i=null);const o={x:t,y:e};return o.x==null&&o.y!=null?Ne.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&Ne.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),r!=null&&(o.spatialReference=r),s!=null&&(o.z=s),i!=null&&(o.m=i),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return JTe(this)}set latitude(t){const{spatialReference:e,x:s}=this;t!=null&&e&&(e.isWebMercator?this._set("y",Tv(s,t,h4)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return QTe(this)}set longitude(t){const{y:e,spatialReference:s}=this;t!=null&&s&&(s.isWebMercator?this._set("x",Tv(t,e,h4)[0]):s.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,s){e[s]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new OM;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return OM.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:s,z:i,m:r,spatialReference:n}=this,{z:o,m:a}=t;let{x:l,y:u,spatialReference:c}=t;if(!n.equals(c))if(n.isWebMercator&&c.isWGS84)[l,u]=Tv(l,u),c=n;else{if(!n.isWGS84||!c.isWebMercator)return!1;[l,u]=jD(l,u),c=n}return e===l&&s===u&&i===o&&r===a&&n.wkid===c.wkid}offset(t,e,s){return this.x+=t,this.y+=e,s!=null&&(this.z=(this.z??0)+s),this}normalize(){if(!this.spatialReference)return this;const t=ya(this.spatialReference);if(!t)return this;let e=this.x;const[s,i]=t.valid,r=2*i;let n;return e>i?(n=Math.ceil(Math.abs(e-i)/r),e-=n*r):e<s&&(n=Math.ceil(Math.abs(e-s)/r),e+=n*r),this._set("x",e),this}distance(t){return Ale(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};p([_({readOnly:!0})],Ko.prototype,"cache",null),p([_({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Ko.prototype,"hasM",null),p([_({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Ko.prototype,"hasZ",null),p([_({type:Number})],Ko.prototype,"latitude",null),p([_({type:Number})],Ko.prototype,"longitude",null),p([_({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Ht(t=>isNaN(t)?t:ma(t))],Ko.prototype,"x",void 0),p([Ue("x")],Ko.prototype,"writeX",null),p([qe("x")],Ko.prototype,"readX",null),p([_({type:Number,json:{write:!0}})],Ko.prototype,"y",void 0),p([_({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Ko.prototype,"z",void 0),p([_({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Ko.prototype,"m",void 0),Ko=OM=p([Q("esri.geometry.Point")],Ko),Ko.prototype.toJSON.isDefaultToJSON=!0;const Et=Ko;let ph=class extends Wt.ClonableMixin(Te){constructor(...e){super(...e),this.position=new Et([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new Cae}normalizeCtorArgs(e,s,i,r){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const n={position:e};return s!=null&&(n.heading=s),i!=null&&(n.tilt=i),r!=null&&(n.fov=r),n}return e}writePosition(e,s,i,r){const n=e.clone();n.x=ma(e.x||0),n.y=ma(e.y||0),n.z=e.hasZ?ma(e.z||0):e.z,s[i]=n.write({},r)}readPosition(e,s){const i=new Et;return i.read(e,s),i.x=ma(i.x||0),i.y=ma(i.y||0),i.z=i.hasZ?ma(i.z||0):i.z,i}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};p([_({type:Et,json:{write:{isRequired:!0}}})],ph.prototype,"position",void 0),p([Ue("position")],ph.prototype,"writePosition",null),p([qe("position")],ph.prototype,"readPosition",null),p([_({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ht(t=>Aae.normalize(ma(t)))],ph.prototype,"heading",void 0),p([_({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ht(t=>Ka(ma(t),-180,180))],ph.prototype,"tilt",void 0),p([_({type:Number,nonNullable:!0,json:{default:55,write:!0}}),Ht(t=>Ka(ma(t,55),1,170))],ph.prototype,"fov",void 0),p([_({type:Cae,nonNullable:!0,json:{read:!1,write:!1}})],ph.prototype,"layout",void 0),ph=p([Q("esri.Camera")],ph);const KTe=ph,m4=[0,0];function VC(t,e){return e!=null&&ua(t,e.x,e.y,e.z)}function bht(t,e){var s;if(!((s=e.points)!=null&&s.length))return!1;for(const i of e.points)if(!wb(t,i))return!1;return!0}function eIe(t,e){const{xmin:s,ymin:i,zmin:r,xmax:n,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?ua(t,s,i,r)&&ua(t,s,o,r)&&ua(t,n,o,r)&&ua(t,n,i,r)&&ua(t,s,i,a)&&ua(t,s,o,a)&&ua(t,n,o,a)&&ua(t,n,i,a):ua(t,s,i)&&ua(t,s,o)&&ua(t,n,o)&&ua(t,n,i)}function wb(t,e){return ua(t,e[0],e[1])}function tIe(t,e){return ua(t,e[0],e[1],e[2])}function ua(t,e,s,i){return e>=t.xmin&&e<=t.xmax&&s>=t.ymin&&s<=t.ymax&&(i==null||!t.hasZ||i>=t.zmin&&i<=t.zmax)}function Uz(t,e){return m4[1]=e.y,m4[0]=e.x,sIe(t,m4)}function sIe(t,e){return Bz(t.rings,e)}function Bz(t,e){if(!t)return!1;if(iIe(t))return NW(!1,t,e);let s=!1;for(let i=0,r=t.length;i<r;i++)s=NW(s,t[i],e);return s}function iIe(t){return!Array.isArray(t[0][0])}function NW(t,e,s){const[i,r]=s;let n=t,o=0;for(let a=0,l=e.length;a<l;a++){o++,o===l&&(o=0);const[u,c]=e[a],[h,m]=e[o];(c<r&&m>=r||m<r&&c>=r)&&u+(r-c)/(m-c)*(h-u)<i&&(n=!n)}return n}function rIe(t,e){return VC(t,e)}function nIe(t,e){const s=t.hasZ&&e.hasZ;let i,r,n;if(t.xmin<=e.xmin){if(i=e.xmin,t.xmax<i)return!1}else if(i=t.xmin,e.xmax<i)return!1;if(t.ymin<=e.ymin){if(r=e.ymin,t.ymax<r)return!1}else if(r=t.ymin,e.ymax<r)return!1;if(s&&e.hasZ){if(t.zmin<=e.zmin){if(n=e.zmin,t.zmax<n)return!1}else if(n=t.zmin,e.zmax<n)return!1}return!0}function oIe(t,e){const{points:s,hasZ:i}=e,r=i?tIe:wb;for(const n of s)if(r(t,n))return!0;return!1}const U_=[0,0],B_=[0,0],j_=[0,0],H_=[0,0],aIe=[U_,B_,j_,H_],$le=[[j_,U_],[U_,B_],[B_,H_],[H_,j_]];function lIe(t,e){return uIe(t,e.rings)}function uIe(t,e){U_[0]=t.xmin,U_[1]=t.ymax,B_[0]=t.xmax,B_[1]=t.ymax,j_[0]=t.xmin,j_[1]=t.ymin,H_[0]=t.xmax,H_[1]=t.ymin;for(const s of aIe)if(Bz(e,s))return!0;for(const s of e){if(!s.length)continue;let i=s[0];if(wb(t,i))return!0;for(let r=1;r<s.length;r++){const n=s[r];if(wb(t,n)||Rle(i,n,$le))return!0;i=n}}return!1}function cIe(t,e){U_[0]=t.xmin,U_[1]=t.ymax,B_[0]=t.xmax,B_[1]=t.ymax,j_[0]=t.xmin,j_[1]=t.ymin,H_[0]=t.xmax,H_[1]=t.ymin;const s=e.paths;for(const i of s){if(!s.length)continue;let r=i[0];if(wb(t,r))return!0;for(let n=1;n<i.length;n++){const o=i[n];if(wb(t,o)||Rle(r,o,$le))return!0;r=o}}return!1}const An=[0,0];function hIe(t){for(let e=0;e<t.length;e++){const s=t[e];for(let r=0;r<s.length-1;r++){const n=s[r],o=s[r+1];for(let a=e+1;a<t.length;a++)for(let l=0;l<t[a].length-1;l++){const u=t[a][l],c=t[a][l+1];if(E5(n,o,u,c,An)&&!(An[0]===n[0]&&An[1]===n[1]||An[0]===u[0]&&An[1]===u[1]||An[0]===o[0]&&An[1]===o[1]||An[0]===c[0]&&An[1]===c[1]))return!0}}const i=s.length;if(!(i<=4))for(let r=0;r<i-3;r++){let n=i-1;r===0&&(n=i-2);const o=s[r],a=s[r+1];for(let l=r+2;l<n;l++){const u=s[l],c=s[l+1];if(E5(o,a,u,c,An)&&!(An[0]===o[0]&&An[1]===o[1]||An[0]===u[0]&&An[1]===u[1]||An[0]===a[0]&&An[1]===a[1]||An[0]===c[0]&&An[1]===c[1]))return!0}}}return!1}function Rle(t,e,s){for(let i=0;i<s.length;i++)if(E5(t,e,s[i][0],s[i][1]))return!0;return!1}function E5(t,e,s,i,r){const[n,o]=t,[a,l]=e,[u,c]=s,[h,m]=i,f=h-u,g=n-u,v=a-n,b=m-c,w=o-c,S=l-o,T=b*v-f*S;if(T===0)return!1;const P=(f*w-b*g)/T,I=(v*w-S*g)/T;return P>=0&&P<=1&&I>=0&&I<=1&&(r&&(r[0]=n+P*(a-n),r[1]=o+P*(l-o)),!0)}function mIe(t){switch(t){case"esriGeometryEnvelope":case"extent":return nIe;case"esriGeometryMultipoint":case"multipoint":return oIe;case"esriGeometryPoint":case"point":return rIe;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return lIe;case"esriGeometryPolyline":case"polyline":return cIe}}var lc;function dIe(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function _p(t,e,s){return e==null?s:s==null?e:t(e,s)}let dn=lc=class extends Ld{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,s,i,r){return dIe(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?St.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:s,ymax:i,spatialReference:r??St.WGS84}}static fromPoint(t){return new lc({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new Et({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new lc;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,s=t.spatialReference;return e&&s&&!e.equals(s)&&FM(e,s)&&(t=e.isWebMercator?bd(t):o_(t,!0)),t.type==="point"?VC(this,t):t.type==="extent"&&eIe(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,s=t.spatialReference;return e&&s&&!e.equals(s)&&FM(e,s)&&(t=e.isWebMercator?bd(t):o_(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),s=this.width*e,i=this.height*e;if(this.xmin+=s,this.ymin+=i,this.xmax-=s,this.ymax-=i,this.hasZ){const r=(this.zmax-this.zmin)*e;this.zmin+=r,this.zmax-=r}if(this.hasM){const r=(this.mmax-this.mmin)*e;this.mmin+=r,this.mmax-=r}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,s=t.spatialReference;return e&&s&&!on(e,s)&&FM(e,s)&&(t=e.isWebMercator?bd(t):o_(t,!0)),mIe(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,s){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,s!=null&&(this.zmin+=s,this.zmax+=s),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=_p(Math.min,this.zmin,t.zmin),this.zmax=_p(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=_p(Math.min,this.mmin,t.mmin),this.mmax=_p(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=_p(Math.max,this.zmin,t.zmin),this.zmax=_p(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=_p(Math.max,this.mmin,t.mmin),this.mmax=_p(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=ya(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,s=this._getCM(t);if(s){const i=e.isWebMercator?o_(s):s;this.xmin-=s.x,this.xmax-=s.x,e.isWebMercator||(i.x=d4(i.x,t).x),this.spatialReference=new St(jc((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:i.x}))}return this}_getCM(t){let e=null;const[s,i]=t.valid,r=this.xmin,n=this.xmax;return r>=s&&r<=i&&n>=s&&n<=i||(e=this.center),e}_normalize(t,e,s){const i=this.spatialReference;if(!i)return this;const r=s??ya(i);if(r==null)return this;const n=this._getParts(r).map(l=>l.extent);if(n.length<2)return n[0]||this;if(n.length>2)return t?this._shiftCM(r):this.set({xmin:r.valid[0],xmax:r.valid[1]});if(t)return this._shiftCM(r);if(e)return n;let o=!0,a=!0;return n.forEach(l=>{l.hasZ||(o=!1),l.hasM||(a=!1)}),{rings:n.map(l=>{const u=[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]];if(o){const c=(l.zmax-l.zmin)/2;for(let h=0;h<u.length;h++)u[h].push(c)}if(a){const c=(l.mmax-l.mmin)/2;for(let h=0;h<u.length;h++)u[h].push(c)}return u}),hasZ:o,hasM:a,spatialReference:i}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:r,ymax:n,spatialReference:o}=this,a=this.width,l=this.xmin,u=this.xmax;let c;t=t||ya(o);const[h,m]=t.valid;c=d4(this.xmin,t);const f=c.x,g=c.frameId;c=d4(this.xmax,t);const v=c.x,b=c.frameId,w=f===v&&a>0;if(a>2*m){const S=new lc(l<u?f:v,r,m,n,o),T=new lc(h,r,l<u?v:f,n,o),P=new lc(0,r,m,n,o),I=new lc(h,r,0,n,o),A=[],D=[];S.contains(P)&&A.push(g),S.contains(I)&&D.push(g),T.contains(P)&&A.push(b),T.contains(I)&&D.push(b);for(let k=g+1;k<b;k++)A.push(k),D.push(k);e.push({extent:S,frameIds:[g]},{extent:T,frameIds:[b]},{extent:P,frameIds:A},{extent:I,frameIds:D})}else f>v||w?e.push({extent:new lc(f,r,m,n,o),frameIds:[g]},{extent:new lc(h,r,v,n,o),frameIds:[b]}):e.push({extent:new lc(f,r,v,n,o),frameIds:[g]});this.cache._parts=e}const s=this.hasZ,i=this.hasM;if(s||i){const r={};s&&(r.zmin=this.zmin,r.zmax=this.zmax),i&&(r.mmin=this.mmin,r.mmax=this.mmax);for(let n=0;n<e.length;n++)e[n].extent.set(r)}return e}};function d4(t,e){const[s,i]=e.valid,r=2*i;let n,o=0;return t>i?(n=Math.ceil(Math.abs(t-i)/r),t-=n*r,o=n):t<s&&(n=Math.ceil(Math.abs(t-s)/r),t+=n*r,o=-n),{x:t,frameId:o}}p([_({readOnly:!0})],dn.prototype,"cache",null),p([_({readOnly:!0})],dn.prototype,"center",null),p([_({readOnly:!0})],dn.prototype,"extent",null),p([_({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],dn.prototype,"hasM",null),p([_({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],dn.prototype,"hasZ",null),p([_({readOnly:!0})],dn.prototype,"height",null),p([_({readOnly:!0})],dn.prototype,"width",null),p([_({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],dn.prototype,"xmin",void 0),p([_({type:Number,json:{write:!0}})],dn.prototype,"ymin",void 0),p([_({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],dn.prototype,"mmin",void 0),p([_({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],dn.prototype,"zmin",void 0),p([_({type:Number,json:{write:!0}})],dn.prototype,"xmax",void 0),p([_({type:Number,json:{write:!0}})],dn.prototype,"ymax",void 0),p([_({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],dn.prototype,"mmax",void 0),p([_({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],dn.prototype,"zmax",void 0),dn=lc=p([Q("esri.geometry.Extent")],dn),dn.prototype.toJSON.isDefaultToJSON=!0;const Hs=dn;function Sb(t,e,s=!1){let{hasM:i,hasZ:r}=t;Array.isArray(e)?e.length!==4||i||r?e.length===3&&s&&!i?(r=!0,i=!1):e.length===3&&i&&r&&(i=!1,r=!1):(i=!0,r=!0):(r=!r&&e.hasZ&&(!i||e.hasM),i=!i&&e.hasM&&(!r||e.hasZ)),t.hasZ=r,t.hasM=i}var C5;function DW(t){return(e,s)=>e==null?s:s==null?e:t(e,s)}function pIe(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let Dp=C5=class extends Ld{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){var r;if(!t&&!e)return{};const s={};Array.isArray(t)?(s.points=t,s.spatialReference=e):pIe(t)?s.spatialReference=t:(t.points&&(s.points=t.points),t.spatialReference&&(s.spatialReference=t.spatialReference),t.hasZ&&(s.hasZ=t.hasZ),t.hasM&&(s.hasM=t.hasM));const i=(r=s.points)==null?void 0:r[0];return i&&(s.hasZ===void 0&&s.hasM===void 0?(s.hasZ=i.length>2,s.hasM=!1):s.hasZ===void 0?s.hasZ=i.length>3:s.hasM===void 0&&(s.hasM=i.length>3)),s}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new Hs,s=this.hasZ,i=this.hasM,r=s?3:2,n=t[0],o=DW(Math.min),a=DW(Math.max);let l,u,c,h,[m,f]=n,[g,v]=n;for(let b=0,w=t.length;b<w;b++){const S=t[b],[T,P]=S;if(m=o(m,T),f=o(f,P),g=a(g,T),v=a(v,P),s&&S.length>2){const I=S[2];l=o(l,I),c=a(c,I)}if(i&&S.length>r){const I=S[r];u=o(u,I),h=a(h,I)}}return e.xmin=m,e.ymin=f,e.xmax=g,e.ymax=v,e.spatialReference=this.spatialReference,s?(e.zmin=l,e.zmax=c):(e.zmin=void 0,e.zmax=void 0),i?(e.mmin=u,e.mmax=h):(e.mmin=void 0,e.mmax=void 0),e}writePoints(t,e){e.points=he(this.points)}addPoint(t){return Sb(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}clone(){const t={points:he(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new C5(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],s={x:e[0],y:e[1],spatialReference:this.spatialReference};let i=2;return this.hasZ&&(s.z=e[2],i=3),this.hasM&&(s.m=e[i]),new Et(s)}removePoint(t){if(!this._validateInputs(t))return null;const e=new Et(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(Sb(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};p([_({readOnly:!0})],Dp.prototype,"cache",null),p([_()],Dp.prototype,"extent",null),p([_({type:[[Number]],json:{write:{isRequired:!0}}})],Dp.prototype,"points",void 0),p([Ue("points")],Dp.prototype,"writePoints",null),Dp=C5=p([Q("esri.geometry.Multipoint")],Dp),Dp.prototype.toJSON.isDefaultToJSON=!0;const qC=Dp;function xht(t){const e=[];for(t.reset();t.nextPath();){const s=[];for(;t.nextPoint();)s.push([t.x,t.y]);e.push(s)}return t.reset(),e}function fIe(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}var YN;(function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"})(YN||(YN={}));function wht(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,s=t.hasM;if(t.type==="point")return s&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:s?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice();if(t.type==="polyline")return t.paths.slice();if(t.type==="multipoint")return t.points.slice();if(t.type==="extent"){const i=t.clone().normalize();if(!i)return null;let r=!1,n=!1;return i.forEach(o=>{o.hasZ&&(r=!0),o.hasM&&(n=!0)}),i.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(r&&o.hasZ){const l=.5*(o.zmax-o.zmin);for(let u=0;u<a.length;u++)a[u].push(l)}if(n&&o.hasM){const l=.5*(o.mmax-o.mmin);for(let u=0;u<a.length;u++)a[u].push(l)}return a})}return null}function HD(t,e){const s=e[0]-t[0],i=e[1]-t[1];if(t.length>2&&e.length>2){const r=t[2]-e[2];return Math.sqrt(s*s+i*i+r*r)}return Math.sqrt(s*s+i*i)}function kle(t,e,s){const i=t[0]+s*(e[0]-t[0]),r=t[1]+s*(e[1]-t[1]);return t.length>2&&e.length>2?[i,r,t[2]+s*(e[2]-t[2])]:[i,r]}function gIe(t,e,s,i){return yIe(t,e,s[i],s[i+1])}function yIe(t,e,s,i){const[r,n]=e,[o,a]=s,[l,u]=i,c=l-o,h=u-a,m=c*c+h*h,f=(r-o)*c+(n-a)*h,g=Math.min(1,Math.max(0,f/m));return t[0]=o+c*g,t[1]=a+h*g,t}function Sht(t,e,s,i,r,n){let o=s,a=i,l=r-o,u=n-a;if(l!==0||u!==0){const c=((t-o)*l+(e-a)*u)/(l*l+u*u);c>1?(o=r,a=n):c>0&&(o+=l*c,a+=u*c)}return l=t-o,u=e-a,l*l+u*u}function Fle(t,e){return kle(t,e,.5)}function Eht(t){const e=t.length;let s=0;for(let i=0;i<e-1;++i)s+=HD(t[i],t[i+1]);return s}function Cht(t,e){if(e<=0)return t[0];const s=t.length;let i=0;for(let r=0;r<s-1;++r){const n=HD(t[r],t[r+1]);if(e-i<n){const o=(e-i)/n;return kle(t[r],t[r+1],o)}i+=n}return t[s-1]}function Ole(t,e=YN.X,s=YN.Y){let i=0;const r=t.length;let n=t[0];for(let o=1;o<r;o++){const a=t[o];i+=(a[e]-n[e])*(a[s]+n[s]),n=a}if(!Lle(t)){const o=t[0];i+=(o[e]-n[e])*(o[s]+n[s])}return i>=0}function Lle(t){const e=t.length;return e<3||TD(t[0],t[e-1])}function Pht(t){"rings"in t&&(_Ie(t),vIe(t))}function _Ie(t){if(!("rings"in t))return!1;let e=!1;for(const s of t.rings)Lle(s)||(s.push(s[0].slice()),e=!0);return e}function vIe(t){if(!("rings"in t)||t.rings.length===0||Ole(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function Tht(t){return t.type!=="polygon"&&t.type!=="polyline"||bIe(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function bIe(t,e){const s=ya(e);if(!s)return;const i=s.valid[0],r=s.valid[1],n=r-i;for(const o of t){let a=1/0,l=-1/0;for(const c of o){const h=xIe(c[0],i,r);a=Math.min(a,h),l=Math.max(l,h),c[0]=h}const u=l-a;n-u<u&&o.forEach(c=>{c[0]<0&&(c[0]+=n)})}}function xIe(t,e,s){const i=s-e;return t<e?s-(e-t)%i:t>s?e+(t-e)%i:t}function Iht(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[s,i]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return s.length===i.length&&s.every((r,n)=>r.length===i[n].length)}function Mht(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function wIe(t){return t?SIe(t.rings,t.hasZ??!1):null}function SIe(t,e){if(!(t!=null&&t.length))return null;const s=[],i=[],r=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let n=0,o=t.length;n<o;n++){const a=Vle(t[n],e,r);a&&i.push(a)}if(i.sort((n,o)=>{let a=n[2]-o[2];return a===0&&e&&(a=n[4]-o[4]),a}),i.length&&(s[0]=i[0][0],s[1]=i[0][1],e&&(s[2]=i[0][3]),(s[0]<r[0]||s[0]>r[1]||s[1]<r[2]||s[1]>r[3]||e&&(s[2]<r[4]||s[2]>r[5]))&&(s.length=0)),!s.length){const n=t[0]&&t[0].length?EIe(t[0],e):null;if(!n)return null;s[0]=n[0],s[1]=n[1],e&&n.length>2&&(s[2]=n[2])}return s}function Vle(t,e,s){let i=0,r=0,n=0,o=0,a=0;const l=t.length?t[0][0]:0,u=t.length?t[0][1]:0,c=t.length&&e?t[0][2]:0;for(let m=0;m<t.length;m++){const f=t[m],g=t[(m+1)%t.length],[v,b,w]=f,S=v-l,T=b-u,[P,I,A]=g,D=P-l,k=I-u,R=S*k-D*T;if(o+=R,i+=(S+D)*R,r+=(T+k)*R,e&&f.length>2&&g.length>2){const O=w-c,z=A-c,q=S*z-D*O;n+=(O+z)*q,a+=q}v<s[0]&&(s[0]=v),v>s[1]&&(s[1]=v),b<s[2]&&(s[2]=b),b>s[3]&&(s[3]=b),e&&(w<s[4]&&(s[4]=w),w>s[5]&&(s[5]=w))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[i/(6*o)+l,r/(6*o)+u,o];return e&&(s[4]===s[5]||a===0?(h[3]=(s[4]+s[5])/2,h[4]=0):(h[3]=n/(6*a)+c,h[4]=a)),h}function Aht(t,e){let s=0,i=0,r=0;t.nextPoint();const n=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const l=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const u=[t.x,t.y],[c,h]=l,m=c-n,f=h-o,[g,v]=u,b=g-n,w=v-o,S=m*w-b*f;r+=S,s+=(m+b)*S,i+=(f+w)*S,c<e[0]&&(e[0]=c),c>e[1]&&(e[1]=c),h<e[2]&&(e[2]=h),h>e[3]&&(e[3]=h)}return r>0&&(r*=-1),r?(r*=.5,[s/(6*r)+n,i/(6*r)+o,r]):null}function EIe(t,e){const s=e?[0,0,0]:[0,0],i=e?[0,0,0]:[0,0];let r=0,n=0,o=0,a=0;for(let l=0,u=t.length;l<u-1;l++){const c=t[l],h=t[l+1];if(c&&h){s[0]=c[0],s[1]=c[1],i[0]=h[0],i[1]=h[1],e&&c.length>2&&h.length>2&&(s[2]=c[2],i[2]=h[2]);const m=HD(s,i);if(m){r+=m;const f=Fle(c,h);n+=m*f[0],o+=m*f[1],e&&f.length>2&&(a+=m*f[2])}}}return r>0?e?[n/r,o/r,a/r]:[n/r,o/r]:t.length?t[0]:null}function CIe(t){const{hasZ:e,totalSize:s}=t;if(s===0)return null;const i=[],r=[],n=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=Vle(fIe(t),t.hasZ,n);o&&r.push(o)}if(r.sort((o,a)=>{let l=o[2]-a[2];return l===0&&e&&(l=o[4]-a[4]),l}),r.length&&(i[0]=r[0][0],i[1]=r[0][1],e&&(i[2]=r[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){t.reset(),t.nextPath();const o=t.pathSize?PIe(t):null;if(!o)return null;i[0]=o[0],i[1]=o[1],e&&o.length>2&&(i[2]=o[2])}return i}function PIe(t){const{hasZ:e}=t,s=e?[0,0,0]:[0,0],i=e?[0,0,0]:[0,0];let r=0,n=0,o=0,a=0;if(t.nextPoint()){let l=t.x,u=t.y,c=t.z;for(;t.nextPoint();){const h=t.x,m=t.y,f=t.z;s[0]=l,s[1]=u,i[0]=h,i[1]=m,e&&(s[2]=c,i[2]=f);const g=HD(s,i);if(g){r+=g;const v=Fle(s,i);n+=g*v[0],o+=g*v[1],e&&v.length>2&&(a+=g*v[2])}l=h,u=m,c=f}}return r>0?e?[n/r,o/r,a/r]:[n/r,o/r]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const TIe=1e-6;function Nht(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<TIe){const r=CIe(t);return r?[r[0],r[1]]:null}const s=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const i=[t.x,t.y];for(t.reset();t.nextPath();)MIe(s,i,t);return s[0]*=1/e,s[1]*=1/e,s[0]+=i[0],s[1]+=i[1],s}const IIe=1/3;function MIe(t,e,s){if(!s||s.pathSize<3)return null;s.nextPoint();const i=s.x,r=s.y;s.nextPoint();let n,o=s.x-i,a=s.y-r,l=0,u=0;for(;s.nextPoint();)l=s.x-i,u=s.y-r,n=.5*IIe*(l*a-u*o),t[0]+=n*(o+l),t[1]+=n*(a+u),o=l,a=u;const c=s.getCurrentRingArea(),h=[i,r];return h[0]-=e[0],h[1]-=e[1],h[0]*=c,h[1]*=c,t[0]+=h[0],t[1]+=h[1],t}function pa(t=$Ie){return[t[0],t[1],t[2],t[3]]}function qle(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function Dht(t,e,s,i,r=pa()){return r[0]=t,r[1]=e,r[2]=s,r[3]=i,r}function $ht(t,e=pa()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function AIe(t,e,s=new Hs){return s.xmin=t[0],s.ymin=t[1],s.xmax=t[2],s.ymax=t[3],s.spatialReference=e,s}function Rht(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function kht(t,e,s){if(e!=null)if("length"in e)P5(e)?(s[0]=Math.min(t[0],e[0]),s[1]=Math.min(t[1],e[1]),s[2]=Math.max(t[2],e[2]),s[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(s[0]=Math.min(t[0],e[0]),s[1]=Math.min(t[1],e[1]),s[2]=Math.max(t[2],e[0]),s[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":s[0]=Math.min(t[0],e.xmin),s[1]=Math.min(t[1],e.ymin),s[2]=Math.max(t[2],e.xmax),s[3]=Math.max(t[3],e.ymax);break;case"point":s[0]=Math.min(t[0],e.x),s[1]=Math.min(t[1],e.y),s[2]=Math.max(t[2],e.x),s[3]=Math.max(t[3],e.y)}else qle(s,t)}function Fht(t,e,s=t){const i=e.length;let r=t[0],n=t[1],o=t[2],a=t[3];for(let l=0;l<i;l++){const u=e[l];r=Math.min(r,u[0]),n=Math.min(n,u[1]),o=Math.max(o,u[0]),a=Math.max(a,u[1])}return s[0]=r,s[1]=n,s[2]=o,s[3]=a,s}function Oht(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function jz(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function Hz(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function Lht(t){return jz(t)*Hz(t)}function Vht(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function qht(t){const e=jz(t),s=Hz(t);return Math.sqrt(e*e+s*s)}function Ght(t,e){return NIe(t,e.x,e.y)}function NIe(t,e,s){return e>=t[0]&&s>=t[1]&&e<=t[2]&&s<=t[3]}function zht(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function Uht(t,e,s){return Math.max(e[0],t[0])-s<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-s<=Math.min(e[3],t[3])}function DIe(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function Bht(t,e,s,i=t){return i[0]=t[0]+e,i[1]=t[1]+s,i[2]=t[2]+e,i[3]=t[3]+s,i}function jht(t){return t?qle(t,$W):pa($W)}function P5(t){return t!=null&&t.length===4}function Hht(t,e){return P5(t)&&P5(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const $W=[1/0,1/0,-1/0,-1/0],$Ie=[0,0,0,0];function Gle(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function zle(t){return t.points!==void 0}function Ule(t){return t.x!==void 0&&t.y!==void 0}function Ble(t){return t.paths!==void 0}function jle(t){return t.rings!==void 0}function Hle(t){function e(s,i){return s==null?i:i==null?s:t(s,i)}return e}const If=Hle(Math.min),Mf=Hle(Math.max);function Yht(t,e){return Ble(e)?Eb(t,e.paths,!1,!1):jle(e)?Eb(t,e.rings,!1,!1):zle(e)?Yz(t,e.points,!1,!1,!1,!1):Gle(e)?Yle(t,e):(Ule(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function Xht(t){let e,s,i,r;for(t.reset(),e=i=1/0,s=r=-1/0;t.nextPath();){const n=RIe(t);e=Math.min(n[0],e),i=Math.min(n[1],i),s=Math.max(n[2],s),r=Math.max(n[3],r)}return pa([e,i,s,r])}function RIe(t){let e,s,i,r;for(e=i=1/0,s=r=-1/0;t.nextPoint();)e=Math.min(t.x,e),i=Math.min(t.y,i),s=Math.max(t.x,s),r=Math.max(t.y,r);return pa([e,i,s,r])}function Wht(t,e){return Ble(e)?Eb(t,e.paths,!0,!1):jle(e)?Eb(t,e.rings,!0,!1):zle(e)?Yz(t,e.points,!0,!1,!0,!1):Gle(e)?Yle(t,e,!0,!1,!0,!1):(Ule(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function Eb(t,e,s,i){const r=s?3:2;if(!e.length||!e[0].length)return null;let n,o,a,l,[u,c]=e[0][0],[h,m]=e[0][0];for(let f=0;f<e.length;f++){const g=e[f];for(let v=0;v<g.length;v++){const b=g[v],[w,S]=b;if(u=If(u,w),c=If(c,S),h=Mf(h,w),m=Mf(m,S),s&&b.length>2){const T=b[2];n=If(n,T),o=Mf(o,T)}if(i&&b.length>r){const T=b[r];a=If(n,T),l=Mf(o,T)}}}return s?i?(t[0]=u,t[1]=c,t[2]=n,t[3]=a,t[4]=h,t[5]=m,t[6]=o,t[7]=l,t.length=8,t):(t[0]=u,t[1]=c,t[2]=n,t[3]=h,t[4]=m,t[5]=o,t.length=6,t):i?(t[0]=u,t[1]=c,t[2]=a,t[3]=h,t[4]=m,t[5]=l,t.length=6,t):(t[0]=u,t[1]=c,t[2]=h,t[3]=m,t.length=4,t)}function Yle(t,e,s,i,r,n){const o=e.xmin,a=e.xmax,l=e.ymin,u=e.ymax;let c=e.zmin,h=e.zmax,m=e.mmin,f=e.mmax;return r?(c=c||0,h=h||0,n?(m=m||0,f=f||0,t[0]=o,t[1]=l,t[2]=c,t[3]=m,t[4]=a,t[5]=u,t[6]=h,t[7]=f,t):(t[0]=o,t[1]=l,t[2]=c,t[3]=a,t[4]=u,t[5]=h,t)):n?(m=m||0,f=f||0,t[0]=o,t[1]=l,t[2]=m,t[3]=a,t[4]=u,t[5]=f,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=u,t)}function Yz(t,e,s,i,r,n){const o=s?3:2,a=i&&n,l=s&&r;if(!e.length||!e[0].length)return null;let u,c,h,m,[f,g]=e[0],[v,b]=e[0];for(let w=0;w<e.length;w++){const S=e[w],[T,P]=S;if(f=If(f,T),g=If(g,P),v=Mf(v,T),b=Mf(b,P),l&&S.length>2){const I=S[2];u=If(u,I),c=Mf(c,I)}if(a&&S.length>o){const I=S[o];h=If(u,I),m=Mf(c,I)}}return r?(u=u||0,c=c||0,n?(h=h||0,m=m||0,t[0]=f,t[1]=g,t[2]=u,t[3]=h,t[4]=v,t[5]=b,t[6]=c,t[7]=m,t):(t[0]=f,t[1]=g,t[2]=u,t[3]=v,t[4]=b,t[5]=c,t)):n?(h=h||0,m=m||0,t[0]=f,t[1]=g,t[2]=h,t[3]=v,t[4]=b,t[5]=m,t):(t[0]=f,t[1]=g,t[2]=v,t[3]=b,t)}function kIe(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function FIe(t){return t.points!==void 0}function OIe(t){return t.x!==void 0&&t.y!==void 0}function LIe(t){return t.paths!==void 0}function VIe(t){return t.rings!==void 0}const Xz=[];function Xle(t,e,s,i){return{xmin:t,ymin:e,xmax:s,ymax:i}}function Wle(t,e,s,i,r,n){return{xmin:t,ymin:e,zmin:s,xmax:i,ymax:r,zmax:n}}function Zle(t,e,s,i,r,n){return{xmin:t,ymin:e,mmin:s,xmax:i,ymax:r,mmax:n}}function Qle(t,e,s,i,r,n,o,a){return{xmin:t,ymin:e,zmin:s,mmin:i,xmax:r,ymax:n,zmax:o,mmax:a}}function Wz(t,e=!1,s=!1){return e?s?Qle(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):Wle(t[0],t[1],t[2],t[3],t[4],t[5]):s?Zle(t[0],t[1],t[2],t[3],t[4],t[5]):Xle(t[0],t[1],t[2],t[3])}function Zht(t){return t?kIe(t)?t:OIe(t)?GIe(t):VIe(t)?Jle(t):LIe(t)?Kle(t):FIe(t)?qIe(t):null:null}function qIe(t){const{hasZ:e,hasM:s,points:i}=t;return Wz(Yz(Xz,i,e??!1,s??!1),e,s)}function GIe(t){const{x:e,y:s,z:i,m:r}=t,n=r!=null;return i!=null?n?Qle(e,s,i,r,e,s,i,r):Wle(e,s,i,e,s,i):n?Zle(e,s,r,e,s,r):Xle(e,s,e,s)}function Jle(t){const{hasZ:e,hasM:s,rings:i}=t,r=Eb(Xz,i,e??!1,s??!1);return r?Wz(r,e,s):null}function Kle(t){const{hasZ:e,hasM:s,paths:i}=t,r=Eb(Xz,i,e??!1,s??!1);return r?Wz(r,e,s):null}var LM;function RW(t){return!Array.isArray(t[0])}function zIe(t){var e;return typeof((e=t[0])==null?void 0:e[0])=="number"}function UIe(t){var n,o;if(!t)return;let{rings:e,hasM:s,hasZ:i,spatialReference:r}=t;switch(e??(e=[]),zIe(e)&&(e=[e]),(o=(n=e[0])==null?void 0:n[0])==null?void 0:o.length){case 4:i??(i=!0),s??(s=!0);break;case 3:i??(i=s!==!0),s??(s=!i);break;default:i??(i=!1),s??(s=!1)}return r??(r=St.WGS84),{...t,hasM:s,hasZ:i,rings:e,spatialReference:r}}let Eu=LM=class extends Ld{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:s}=t;let i=!1,r=!1;for(const o of e)o.hasZ&&(i=!0),o.hasM&&(r=!0);const n={rings:e.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(i&&o.hasZ){const l=o.zmin+.5*(o.zmax-o.zmin);for(let u=0;u<a.length;u++)a[u].push(l)}if(r&&o.hasM){const l=o.mmin+.5*(o.mmax-o.mmin);for(let u=0;u<a.length;u++)a[u].push(l)}return a}),spatialReference:s};return i&&(n.hasZ=!0),r&&(n.hasM=!0),new LM(n)}constructor(t){super(UIe(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){const t=wIe(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new Et;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}writeCurveRings(t,e){e.curveRings=he(t)}get extent(){const t=Jle(this),{spatialReference:e}=this;return t?new Hs({...t,spatialReference:e}):null}get isSelfIntersecting(){return hIe(this.rings)}writeRings(t,e){e.rings=he(this.rings)}addRing(t){if(!t)return;const e=this.rings,s=e.length;if(RW(t)){const i=[];for(let r=0,n=t.length;r<n;r++)i[r]=t[r].toArray();e[s]=i}else e[s]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new LM;return t.spatialReference=this.spatialReference,t.rings=he(this.rings),t.curveRings=he(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,s=t.spatialReference;if(e!=null!=(s!=null)||e!=null&&s!=null&&!e.equals(s)||this.rings.length!==t.rings.length)return!1;const i=([r,n,o,a],[l,u,c,h])=>r===l&&n===u&&(o==null&&c==null||o===c)&&(a==null&&h==null||a===h);for(let r=0;r<this.rings.length;r++){const n=this.rings[r],o=t.rings[r];if(!TD(n,o,i))return!1}return!0}contains(t){if(!t)return!1;const e=BD(t,this.spatialReference);return Uz(this,e??t)}isClockwise(t){const e=RW(t)?t.map(s=>this.hasZ?this.hasM?[s.x,s.y,s.z,s.m]:[s.x,s.y,s.z]:[s.x,s.y]):t;return Ole(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const s=this.rings[t][e],i=this.hasZ,r=this.hasM;return i&&!r?new Et(s[0],s[1],s[2],void 0,this.spatialReference):r&&!i?new Et(s[0],s[1],void 0,s[2],this.spatialReference):i&&r?new Et(s[0],s[1],s[2],s[3],this.spatialReference):new Et(s[0],s[1],this.spatialReference)}insertPoint(t,e,s){return this._validateInputs(t,e,!0)?(Sb(this,s),Array.isArray(s)||(s=s.toArray()),this.rings[t].splice(e,0,s),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const s=new Et(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),s}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],s=this.spatialReference,i=e.map(r=>new Et(r,s));return this.notifyChange("rings"),i}setPoint(t,e,s){return this._validateInputs(t,e)?(Sb(this,s),Array.isArray(s)||(s=s.toArray()),this.rings[t][e]=s,this.notifyChange("rings"),this):this}_validateInputs(t,e,s=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const i=this.rings[t];if(s&&(e<0||e>i.length)||!s&&(e<0||e>=i.length))return!1}return!0}toJSON(t){return this.write({},t)}};p([_({readOnly:!0})],Eu.prototype,"cache",null),p([_({readOnly:!0})],Eu.prototype,"centroid",null),p([_({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Eu.prototype,"curveRings",void 0),p([Ue("curveRings")],Eu.prototype,"writeCurveRings",null),p([_({readOnly:!0})],Eu.prototype,"extent",null),p([_({readOnly:!0})],Eu.prototype,"isSelfIntersecting",null),p([_({type:[[[Number]]],json:{write:{isRequired:!0}}})],Eu.prototype,"rings",void 0),p([Ue("rings")],Eu.prototype,"writeRings",null),Eu=LM=p([Q("esri.geometry.Polygon")],Eu);const po=Eu;Eu.prototype.toJSON.isDefaultToJSON=!0;var T5;function BIe(t){return!Array.isArray(t[0])}function jIe(t){var e;return typeof((e=t[0])==null?void 0:e[0])=="number"}function HIe(t){var n,o;if(!t)return;let{paths:e,hasM:s,hasZ:i,spatialReference:r}=t;switch(e??(e=[]),jIe(e)&&(e=[e]),(o=(n=e[0])==null?void 0:n[0])==null?void 0:o.length){case 4:i??(i=!0),s??(s=!0);break;case 3:i??(i=s!==!0),s??(s=!i);break;default:i??(i=!1),s??(s=!1)}return r??(r=St.WGS84),{...t,hasM:s,hasZ:i,paths:e,spatialReference:r}}let Nh=T5=class extends Ld{constructor(t){super(HIe(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=he(t)}get extent(){const t=Kle(this),{spatialReference:e}=this;return t?new Hs({...t,spatialReference:e}):null}writePaths(t,e){e.paths=he(this.paths)}addPath(t){if(!t)return;const e=this.paths,s=e.length;if(BIe(t)){const i=[];for(let r=0,n=t.length;r<n;r++)i[r]=t[r].toArray();e[s]=i}else e[s]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new T5;return t.spatialReference=this.spatialReference,t.paths=he(this.paths),t.curvePaths=he(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const s=this.paths[t][e],i=this.hasZ,r=this.hasM;return i&&!r?new Et(s[0],s[1],s[2],void 0,this.spatialReference):r&&!i?new Et(s[0],s[1],void 0,s[2],this.spatialReference):i&&r?new Et(s[0],s[1],s[2],s[3],this.spatialReference):new Et(s[0],s[1],this.spatialReference)}insertPoint(t,e,s){return this._validateInputs(t,e,!0)?(Sb(this,s),Array.isArray(s)||(s=s.toArray()),this.paths[t].splice(e,0,s),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],s=this.spatialReference,i=e.map(r=>new Et(r,s));return this.notifyChange("paths"),i}removePoint(t,e){if(!this._validateInputs(t,e))return null;const s=new Et(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),s}setPoint(t,e,s){return this._validateInputs(t,e)?(Sb(this,s),Array.isArray(s)||(s=s.toArray()),this.paths[t][e]=s,this.notifyChange("paths"),this):this}_validateInputs(t,e,s=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const i=this.paths[t];if(s&&(e<0||e>i.length)||!s&&(e<0||e>=i.length))return!1}return!0}toJSON(t){return this.write({},t)}};p([_({readOnly:!0})],Nh.prototype,"cache",null),p([_({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Nh.prototype,"curvePaths",void 0),p([Ue("curvePaths")],Nh.prototype,"writeCurvePaths",null),p([_({readOnly:!0})],Nh.prototype,"extent",null),p([_({type:[[[Number]]],json:{write:{isRequired:!0}}})],Nh.prototype,"paths",void 0),p([Ue("paths")],Nh.prototype,"writePaths",null),Nh=T5=p([Q("esri.geometry.Polyline")],Nh);const Vl=Nh;Nh.prototype.toJSON.isDefaultToJSON=!0;function eue(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function tue(t){return t.points!==void 0}function sue(t){return t.x!==void 0&&t.y!==void 0}function Zz(t){return t.paths!==void 0||t.curvePaths!==void 0}function v_(t){return t.rings!==void 0||t.curveRings!==void 0}function Y_(t){return t==null?null:t instanceof Ld?t:sue(t)?Et.fromJSON(t):Zz(t)?Vl.fromJSON(t):v_(t)?po.fromJSON(t):tue(t)?qC.fromJSON(t):eue(t)?Hs.fromJSON(t):null}function YD(t){return t?sue(t)?"esriGeometryPoint":Zz(t)?"esriGeometryPolyline":v_(t)?"esriGeometryPolygon":eue(t)?"esriGeometryEnvelope":tue(t)?"esriGeometryMultipoint":null:null}const YIe={esriGeometryPoint:Et,esriGeometryPolyline:Vl,esriGeometryPolygon:po,esriGeometryEnvelope:Hs,esriGeometryMultipoint:qC,esriGeometryMultiPatch:po};function XIe(t){return t&&YIe[t]||null}const Qz=Xn()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),kW=Xn()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),GC={base:Ld,key:"type",typeMap:{extent:Hs,multipoint:qC,point:Et,polyline:Vl,polygon:po}};var I5;let $p=I5=class extends Te{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new I5({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};p([_({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:p4}}}}})],$p.prototype,"rotation",void 0),p([Ht("rotation")],$p.prototype,"castRotation",null),p([_({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:p4}}}}})],$p.prototype,"scale",void 0),p([_({types:GC,json:{read:Y_,write:!0,origins:{"web-scene":{read:Y_,write:{overridePolicy:p4}}}}})],$p.prototype,"targetGeometry",void 0),p([_({type:KTe,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],$p.prototype,"camera",void 0),$p=I5=p([Q("esri.Viewpoint")],$p);const Lu=$p;function p4(){return{enabled:!this.camera}}let Wl=class iue{constructor(){this._emitter=new iue.EventEmitter(this)}emit(e,s){return this._emitter.emit(e,s)}on(e,s){return this._emitter.on(e,s)}once(e,s){return this._emitter.once(e,s)}hasEventListener(e){return this._emitter.hasEventListener(e)}};(function(t){class e{constructor(r=null){this._target=r,this._listenersMap=null}clear(){var r;(r=this._listenersMap)==null||r.clear(),this._listenersMap=null}destroy(){this.clear()}emit(r,n){var u;let o=(u=this._listenersMap)==null?void 0:u.get(r);if(!o)return!1;const a=this._target||this;let l=!1;for(const c of o.slice()){const h="deref"in c?c.deref():c;h?h==null||h.call(a,n):l=!0}return l&&(o=o.filter(c=>!("deref"in c)||c.deref()!=null),this._listenersMap.set(r,o)),o.length>0}on(r,n){if(Array.isArray(r)){const a=r.map(l=>this.on(l,n));return AC(a)}if(r.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??(this._listenersMap=new Map);const o=this._listenersMap.get(r)||[];return o.push(n),this._listenersMap.set(r,o),xs(()=>{var u;const a=(u=this._listenersMap)==null?void 0:u.get(r),l=(a==null?void 0:a.indexOf(n))??-1;l>=0&&a.splice(l,1)})}once(r,n){const o=this.on(r,a=>{o.remove();const l="deref"in n?n.deref():n;l==null||l.call(null,a)});return o}hasEventListener(r){var o;const n=(o=this._listenersMap)==null?void 0:o.get(r);return n!=null&&n.length>0}}t.EventEmitter=e,t.EventedMixin=i=>{let r=class extends i{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(n,o){return this._emitter.emit(n,o)}on(n,o){return this._emitter.on(n,o)}once(n,o){return this._emitter.once(n,o)}hasEventListener(n){return this._emitter.hasEventListener(n)}};return r=p([Q("esri.core.Evented")],r),r};let s=class extends Ye{constructor(){super(...arguments),this._emitter=new Wl.EventEmitter(this)}destroy(){this._emitter.clear()}emit(i,r){return this._emitter.emit(i,r)}on(i,r){return this._emitter.on(i,r)}once(i,r){return this._emitter.once(i,r)}hasEventListener(i){return this._emitter.hasEventListener(i)}};s=p([Q("esri.core.Evented.EventedAccessor")],s),t.EventedAccessor=s})(Wl);var Ms;(function(t){t[t.ADD=1]="ADD",t[t.REMOVE=2]="REMOVE",t[t.MOVE=4]="MOVE"})(Ms||(Ms={}));function Jz(t){return(e,s)=>{e[s]=t}}let ix=class extends lae{notify(){const e=this._observers;if(e&&e.length>0){const s=e.slice();for(const i of s)i.onInvalidated(),i.onCommitted()}}};var ud;let WIe=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},ZIe=class{constructor(e,s,i,r,n){this.target=e,this.added=s,this.removed=i,this.start=r,this.deleteCount=n}};const hu=new mg(WIe,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function FW(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function f4(t){return t?t instanceof id?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function g4(t){if(t!=null&&t.length)return t[0]}function QIe(t,e,s,i){const r=Math.min(t.length-s,e.length-i);let n=0;for(;n<r&&t[s+n]===e[i+n];)n++;return n}function rue(t,e,s,i){e&&e.forEach((r,n,o)=>{t.push(r),rue(t,s.call(i,r,n,o),s,i)})}const vp=new Set,bp=new Set,xp=new Set,y4=new Map;let JIe=0,id=ud=class extends Wl.EventedAccessor{static isCollection(t){return t!=null&&t instanceof ud}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new ix,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:JIe++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof ud?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),this._emitter.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return lt(this._observable),this._items}set items(t){this._emitBeforeChanges(Ms.ADD)||(this._splice(0,this.length,f4(t)),this._emitAfterChanges(Ms.ADD))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(t))}on(t,e){if(this.destroyed)return xs();if(t==="change"){const s=this._chgListeners,i={removed:!1,callback:e};return s.push(i),this._notifications&&this._notifications.push({listeners:s.slice(),items:this._items.slice(),changes:[]}),xs(()=>{i.removed=!0,s.splice(s.indexOf(i),1)})}return this._emitter.on(t,e)}once(t,e){const s="deref"in e?()=>e.deref():()=>e,i=this.on(t,r=>{var n;(n=s())==null||n.call(null,r),i.remove()});return i}add(t,e){if(lt(this._observable),this._emitBeforeChanges(Ms.ADD))return this;const s=this.getNextIndex(e??null);return this._splice(s,0,[t]),this._emitAfterChanges(Ms.ADD),this}addMany(t,e=this._items.length){if(lt(this._observable),!(t!=null&&t.length))return this;if(this._emitBeforeChanges(Ms.ADD))return this;const s=this.getNextIndex(e);return this._splice(s,0,f4(t)),this._emitAfterChanges(Ms.ADD),this}at(t){if(lt(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(lt(this._observable),!this.length||this._emitBeforeChanges(Ms.REMOVE))return[];const t=this._removeAllRaw();return this._emitAfterChanges(Ms.REMOVE),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return lt(this._observable),this._createNewInstance({items:this._items.map(he)})}concat(...t){lt(this._observable);const e=t.map(f4);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(lt(this._observable),!this.length||this._emitBeforeChanges(Ms.REMOVE))return;const s=this._splice(0,this.length),i=s.length;for(let r=0;r<i;r++)t.call(e,s[r],r,s);this._emitAfterChanges(Ms.REMOVE)}destroyAll(){this.drain(FW)}destroyMany(t){const e=this.removeMany(t);return e.forEach(FW),e}every(t,e){return lt(this._observable),this._items.every(t,e)}filter(t,e){lt(this._observable);const s=arguments.length===2?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:s})}find(t,e){return lt(this._observable),this._items.find(t,e)}findIndex(t,e){return lt(this._observable),this._items.findIndex(t,e)}flatten(t,e){lt(this._observable);const s=[];return rue(s,this,t,e),new ud(s)}forEach(t,e){return lt(this._observable),this._items.forEach(t,e)}getItemAt(t){return lt(this._observable),this._items[t]}getNextIndex(t){lt(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return lt(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return lt(this._observable),this._items.indexOf(t,e)}join(t=","){return lt(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return lt(this._observable),this._items.lastIndexOf(t,e)}map(t,e){lt(this._observable);const s=this._items.map(t,e);return new ud({items:s})}reorder(t,e=this.length-1){lt(this._observable);const s=this.indexOf(t);if(s!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),s!==e){if(this._emitBeforeChanges(Ms.MOVE))return t;this._splice(s,1),this._splice(e,0,[t]),this._emitAfterChanges(Ms.MOVE)}return t}}pop(){if(lt(this._observable),!this.length||this._emitBeforeChanges(Ms.REMOVE))return;const t=g4(this._splice(this.length-1,1));return this._emitAfterChanges(Ms.REMOVE),t}push(...t){return lt(this._observable),this._emitBeforeChanges(Ms.ADD)||(this._splice(this.length,0,t),this._emitAfterChanges(Ms.ADD)),this.length}reduce(t,e){lt(this._observable);const s=this._items;return arguments.length===2?s.reduce(t,e):s.reduce(t)}reduceRight(t,e){lt(this._observable);const s=this._items;return arguments.length===2?s.reduceRight(t,e):s.reduceRight(t)}remove(t){return lt(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(lt(this._observable),t<0||t>=this.length||this._emitBeforeChanges(Ms.REMOVE))return;const e=g4(this._splice(t,1));return this._emitAfterChanges(Ms.REMOVE),e}removeMany(t){if(lt(this._observable),!(t!=null&&t.length)||this._emitBeforeChanges(Ms.REMOVE))return[];const e=t instanceof ud?t.toArray():t,s=this._items,i=[],r=e.length;for(let n=0;n<r;n++){const o=e[n],a=s.indexOf(o);if(a>-1){const l=1+QIe(e,s,n+1,a+1),u=this._splice(a,l);u&&u.length>0&&i.push.apply(i,u),n+=l-1}}return this._emitAfterChanges(Ms.REMOVE),i}reverse(){if(lt(this._observable),this._emitBeforeChanges(Ms.MOVE))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(Ms.MOVE),this}shift(){if(lt(this._observable),!this.length||this._emitBeforeChanges(Ms.REMOVE))return;const t=g4(this._splice(0,1));return this._emitAfterChanges(Ms.REMOVE),t}slice(t=0,e=this.length){return lt(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return lt(this._observable),this._items.some(t,e)}sort(t){if(lt(this._observable),!this.length||this._emitBeforeChanges(Ms.MOVE)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(Ms.MOVE),this}_requiresSort(t=(e,s)=>e===s?0:e<s?-1:1){const e=this.length-1;for(let s=0;s<e;s++)if(t(this.items[s],this.items[s+1])>0)return!0;return!1}splice(t,e,...s){lt(this._observable);const i=(e?Ms.REMOVE:0)|(s.length?Ms.ADD:0);if(this._emitBeforeChanges(i))return[];const r=this._splice(t,e,s)||[];return this._emitAfterChanges(i),r}toArray(){return lt(this._observable),this._items.slice()}toJSON(){return lt(this._observable),this.toArray()}toLocaleString(){return lt(this._observable),this._items.toLocaleString()}toString(){return lt(this._observable),this._items.toString()}unshift(...t){return lt(this._observable),!t.length||this._emitBeforeChanges(Ms.ADD)||(this._splice(0,0,t),this._emitAfterChanges(Ms.ADD)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,s){const i=this._items,r=this.itemType;let n,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=OC(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(o=i.splice(t,e),this.hasEventListener("before-remove")){const a=hu.acquire();a.target=this,a.cancellable=!0;for(let l=0,u=o.length;l<u;l++)n=o[l],a.reset(n),this.emit("before-remove",a),a.defaultPrevented&&(o.splice(l,1),i.splice(t,0,n),t+=1,l-=1,u-=1);hu.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=hu.acquire();a.target=this,a.cancellable=!1;const l=o.length;for(let u=0;u<l;u++)a.reset(o[u]),this.emit("after-remove",a);hu.release(a)}}if(s!=null&&s.length){if(r){const c=[];for(const h of s){const m=r.ensureType(h);m==null&&h!=null||c.push(m)}s=c}const a=this.hasEventListener("before-add"),l=this.hasEventListener("after-add"),u=t===this.length;if(a||l){const c=hu.acquire();c.target=this,c.cancellable=!0;const h=hu.acquire();h.target=this,h.cancellable=!1;for(const m of s)a?(c.reset(m),this.emit("before-add",c),c.defaultPrevented||(u?i.push(m):i.splice(t++,0,m),this._set("length",i.length),l&&(h.reset(m),this.emit("after-add",h)))):(u?i.push(m):i.splice(t++,0,m),this._set("length",i.length),h.reset(m),this.emit("after-add",h));hu.release(h),hu.release(c)}else{if(u)for(const c of s)i.push(c);else i.splice(t,0,...s);this._set("length",i.length)}}if((s!=null&&s.length||o!=null&&o.length)&&this._notifyChangeEvent(s,o),this.hasEventListener("after-splice")){const a=new ZIe(this,s,o,t,e);this.emit("after-splice",a)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const s=hu.acquire();s.target=this,s.cancellable=!0,s.type=t,this.emit("before-changes",s),e=s.defaultPrevented,hu.release(s)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=hu.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),hu.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const s=e.changes;vp.clear(),bp.clear(),xp.clear();for(const{added:l,removed:u}of s){if(l)if(xp.size===0&&bp.size===0)for(const c of l)vp.add(c);else for(const c of l)bp.has(c)?(xp.add(c),bp.delete(c)):xp.has(c)||vp.add(c);if(u)if(xp.size===0&&vp.size===0)for(const c of u)bp.add(c);else for(const c of u)vp.has(c)?vp.delete(c):(xp.delete(c),bp.add(c))}const i=da.acquire();vp.forEach(l=>{i.push(l)});const r=da.acquire();bp.forEach(l=>{r.push(l)});const n=this._items,o=e.items,a=da.acquire();if(xp.forEach(l=>{o.indexOf(l)!==n.indexOf(l)&&a.push(l)}),e.listeners&&(i.length||r.length||a.length)){const l={target:this,added:i,removed:r,moved:a},u=e.listeners.length;for(let c=0;c<u;c++){const h=e.listeners[c];h.removed||h.callback.call(this,l)}}da.release(i),da.release(r),da.release(a)}vp.clear(),bp.clear(),xp.clear()}};id.ofType=t=>{if(!t)return ud;if(y4.has(t))return y4.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const i in t.typeMap){const r=t.typeMap[i].prototype.declaredClass;e?e+=` | ${r}`:e=r}let s=class extends ud{};return p([Jz({Type:t,ensureType:typeof t=="function"?nn(t):Hc(t)})],s.prototype,"itemType",void 0),s=p([Q(`esri.core.Collection<${e}>`)],s),y4.set(t,s),s},p([_()],id.prototype,"_updating",void 0),p([_()],id.prototype,"length",void 0),p([_()],id.prototype,"items",null),p([_({readOnly:!0})],id.prototype,"updating",null),id=ud=p([Q("esri.core.Collection")],id);const Ge=id;function KIe(t,e,s){return Pd(t.map((i,r)=>e.apply(s,[i,r])))}async function eMe(t,e,s){return(await Pd(t.map((i,r)=>e.apply(s,[i,r])))).map(i=>i.value)}function Kz(t){return{ok:!0,value:t}}function e7(t){return{ok:!1,error:t}}function tMe(t){return t!=null&&t.ok===!0?t.value:null}function sMe(t){return t!=null&&t.ok===!1?t.error:null}async function XD(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return Kz(await t)}catch(e){return e7(e)}}async function iMe(t){try{return Kz(await t)}catch(e){return Nc(e),e7(e)}}function Id(t,e){return new Rp(t,e)}let Rp=class extends Ye{get value(){return tMe(this._result)}get error(){return sMe(this._result)}get finished(){return this._result!=null}constructor(e,s){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=Do(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:i}=this._abortController;this.promise=e(i),this.promise.then(r=>{this._result=Kz(r),this._cleanup()},r=>{this._result=e7(r),this._cleanup()}),this._abortHandle=Ou(s,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=qi(this._abortHandle),this._abortController=null}};p([_()],Rp.prototype,"value",null),p([_()],Rp.prototype,"error",null),p([_()],Rp.prototype,"finished",null),p([_()],Rp.prototype,"promise",void 0),p([_()],Rp.prototype,"_result",void 0),Rp=p([Q("esri.core.asyncUtils.ReactiveTask")],Rp);function Ee(t,e,s={}){return t7(t,e,s,nue)}function Or(t,e,s={}){return t7(t,e,s,oue)}function t7(t,e,s={},i){let r=null;const n=s.once?(o,a)=>{i(o)&&(qi(r),e(o,a))}:(o,a)=>{i(o)&&e(o,a)};if(r=YCe(t,n,s.sync,s.equals),s.initial){const o=t();n(o,o)}return r}function Vo(t,e,s,i={}){let r=null,n=null,o=null;function a(){var c;r&&n&&(n.remove(),(c=i.onListenerRemove)==null||c.call(i,r),r=null,n=null)}function l(c){i.once&&i.once&&qi(o),s(c)}const u=Ee(t,(c,h)=>{var m;a(),RD(c)&&(r=c,n=RC(c,e,l),(m=i.onListenerAdd)==null||m.call(i,c))},{sync:i.sync,initial:!0});return o=xs(()=>{u.remove(),a()}),o}function zC(t,e){return rMe(t,oue,e)}function rMe(t,e,s){if(Yl(s))return Promise.reject(xi());const i=t();if(e!=null&&e(i))return Promise.resolve(i);let r=null;function n(){r=qi(r)}return new Promise((o,a)=>{r=AC([Ou(s,()=>{n(),a(xi())}),t7(t,l=>{n(),o(l)},{sync:!1,once:!0},e??nue)])})}function nue(t){return!0}function oue(t){return!!t}function nMe(t,e,s={}){let i=!1;const r=Ee(t,(n,o)=>{i||e(n,o)},s);return{remove(){r.remove()},pause(){i=!0},resume(){i=!1}}}function oMe(t,e){const s=new Ge,i=Vo(t,"after-splice",({added:r,start:n,deleteCount:o})=>{const a=s.splice(n,o);for(const l of a)l.remove();if(r!=null&&r.length){const l=r.map(e);s.addMany(l,n)}},{sync:!0,onListenerRemove:()=>s.drain(r=>r.remove()),onListenerAdd:r=>s.addMany(r.items.map(e))});return s.addHandles(i),s}function tmt(t,e){const s=new Ge,i=oMe(t,a=>Id(async l=>{const u=await e(a,l);if(Yl(l))throw u.remove(),xi();return u})),r=()=>null,n=async a=>{const l=await a.promise,u=i.indexOf(a);u<0||s.splice(u,1,l)};s.addMany(i.items.map(r));for(const a of i)zl(n(a));const o=i.on("after-splice",({added:a,start:l,deleteCount:u})=>{const c=s.splice(l,u);for(const h of c)h==null||h.remove();if(a!=null&&a.length){s.addMany(a.map(r),l);for(const h of a)zl(n(h))}});return s.addHandles([fEe(i),o]),s}const Xc={sync:!0},ht={initial:!0},Ga={sync:!0,initial:!0};let k1=class extends Ge{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(vae(()=>this._refresh(),Xc))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections!=null?this.getCollections():null;if(e==null)return void this.removeAll();let s=0;for(const i of e)i!=null&&(s=this._processCollection(s,i));this.splice(s,this.length)}_createNewInstance(e){return new Ge(e)}_processCollection(e,s){if(!s)return e;const i=this.itemFilterFunction??(r=>!!r);for(const r of s)if(r){if(i(r)){const n=this.indexOf(r,e);n>=0?n!==e&&this.reorder(r,e):this.add(r,e),++e}if(this.getChildrenFunction){const n=this.getChildrenFunction(r);if(Array.isArray(n))for(const o of n)e=this._processCollection(e,o);else e=this._processCollection(e,n)}}return e}};p([_()],k1.prototype,"getCollections",void 0),p([_()],k1.prototype,"getChildrenFunction",void 0),p([_()],k1.prototype,"itemFilterFunction",void 0),k1=p([Q("esri.core.CollectionFlattener")],k1);const ME=k1;let XN=class{constructor(e=s=>s.values().next().value){this._peeker=e,this._observable=new ix,this._items=new Set}get length(){return lt(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return lt(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const s=this.length;return this._items.forEach(i=>{e(i)||this._items.delete(i)}),s!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){lt(this._observable),yield*this._items}};const aue=new FinalizationRegistry(t=>{t.close()});function aMe(t,e){aue.register(t,e,e)}function lMe(t){aue.unregister(t)}function lue(t,e){return new Proxy({},{get:(s,i,r)=>(...n)=>{let o,a;const l=n[n.length-1];return uMe(l)&&(o=l.signal,a=l.transferList,n.pop()),t.apply(e?`${e}.${i.toString()}`:i.toString(),n,{transferList:a,signal:o})}})}function uMe(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const cMe={statsWorker:()=>me(()=>import("./statsWorker-CPLaXa3N.js"),__vite__mapDeps([2,3,4,5,6])),geometryEngineWorker:()=>me(()=>import("./geometryEngineWorker-CA-tZxOm.js"),__vite__mapDeps([7,8,9,1,10])),arcadeGeometryOperatorsWorker:()=>me(()=>import("./operatorsWorker-C8VGvW2H.js"),[]),CSVSourceWorker:()=>me(()=>import("./CSVSourceWorker-f7lYrPi2.js"),__vite__mapDeps([11,12,10,13,14,15,16,17,18,19,4,3,5,6,20,21,22,23,24,25,26])),EdgeProcessingWorker:()=>me(()=>import("./EdgeProcessingWorker-Dla8ImDd.js"),__vite__mapDeps([27,28,29,30,31,32,33,34,35,36,37,38])),ElevationSamplerWorker:()=>me(()=>import("./ElevationSamplerWorker-3T2UH-zC.js"),__vite__mapDeps([39,24,40,41,42,43,44,45,46,47,48,30,49])),FeatureServiceSnappingSourceWorker:()=>me(()=>import("./FeatureServiceSnappingSourceWorker-MYFCNgZe.js"),__vite__mapDeps([50,13,14,10,15,16,17,18,19,4,3,5,6,20,21,22,23,24,25,51])),GeoJSONSourceWorker:()=>me(()=>import("./GeoJSONSourceWorker-DnhPQApc.js"),__vite__mapDeps([52,16,13,14,10,15,17,18,19,4,3,5,6,20,21,22,23,24,25,53,12,54])),LercWorker:()=>me(()=>import("./LercWorker-BSBjW27i.js"),[]),MemorySourceWorker:()=>me(()=>import("./MemorySourceWorker-Hnk35b-Y.js"),__vite__mapDeps([55,16,56,13,14,10,15,17,18,19,4,3,5,6,20,21,22,23,24,25,54,12])),PBFDecoderWorker:()=>me(()=>import("./PBFDecoderWorker-pb8qJGNm.js"),__vite__mapDeps([57,58,16])),FeaturePipelineWorker:()=>me(()=>import("./FeaturePipelineWorker-Dw1e1EZc.js"),__vite__mapDeps([59,60,61,62,37,63,14,10,19,16,64,65,66,67,68,69,70,4,71,72,73,74,75,76,77,78,79,25,15,17,18,3,5,6,20,21,80,81,82,83,53,12,54,84,85,86])),PointCloudWorker:()=>me(()=>import("./PointCloudWorker-CHmBH4SP.js"),__vite__mapDeps([87,88,42,89,90,91,92,35,93,43,44,45,94])),RasterWorker:()=>me(()=>import("./RasterWorker-CQQcbau5.js"),__vite__mapDeps([95,96,97,98,1,99,100,101])),SceneLayerSnappingSourceWorker:()=>me(()=>import("./SceneLayerSnappingSourceWorker-CKevdsg_.js"),__vite__mapDeps([102,103,104,42,94,43,89,105,29,30,31,32,33,34,35,36,37,38])),SceneLayerWorker:()=>me(()=>import("./SceneLayerWorker-oQ1siDte.js"),__vite__mapDeps([106,40,48,107,46,104,42,94,43,89,108,92,35,109,69,110,111,112,113,93,88,44,45])),WFSSourceWorker:()=>me(()=>import("./WFSSourceWorker-p52qgiFT.js"),__vite__mapDeps([114,16,13,14,10,15,17,18,19,4,3,5,6,20,21,22,23,24,25,53,12,54,115,116])),WorkerTileHandler:()=>me(()=>import("./WorkerTileHandler-Cg74MZ6h.js"),__vite__mapDeps([117,118,67,70,119,120,75,121,122,37,77,65])),Lyr3DWorker:()=>me(()=>import("./Lyr3DWorker-DSOf7gp5.js"),[]),Feature3DPipelineWorker:()=>me(()=>import("./Feature3DPipelineWorker-nxMK_Pir.js"),__vite__mapDeps([123,15,16,17,18,19,14,10,4,3,5,6,20,21,24,34,124,125,126,127,112,43,113,111,42,35,128,104,94,89,103,93,88,44,45,129,130,29,30,31,131,36,37,132,105,133,69,134,135,47,40,107,46,136,90,137,138,139,110,140])),TextureCompressionWorker:()=>me(()=>import("./TextureCompressionWorker-CHsTOkdN.js"),__vite__mapDeps([141,130]))},uue="worker:port-closed";var qn;(function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"})(qn||(qn={}));let hMe=0;function cue(){return hMe++}function mMe(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function AE(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function s7(t,e,s,i){if(e.type===qn.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==qn.INVOKE&&e.type!==qn.RESPONSE)return void t.postMessage(e);let r;if(mMe(s)?(r=OW(s.transferList),e.data=s.result):(r=OW(i),e.data=s),r){if(ge("ff")){for(const n of r)if("byteLength"in n&&n.byteLength>267386880){const o="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case qn.INVOKE:throw o;case qn.RESPONSE:return void s7(t,{type:qn.RESPONSE,jobId:e.jobId,error:AE(o)})}}}t.postMessage(e,r)}else t.postMessage(e)}function NE(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function OW(t){if(!(t!=null&&t.length))return null;if(ge("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(s=>!dMe(s));return e.length?e:null}function dMe(t){var e;return t instanceof ArrayBuffer||((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="ArrayBuffer"}async function rmt(t){try{return await t}catch(e){const s=(e==null?void 0:e.name)===uue;if(!(Lr(e)||s))throw e;return}}const{CLOSE:LW,ABORT:VW,INVOKE:qW,RESPONSE:Rw,OPEN_PORT:GW,ON:pMe}=qn,fMe=2;let gMe=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===qn.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}},Jf=class F1{static connect(e,s){const i=new MessageChannel;let r;r=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const n=new F1(i.port1,{channel:i,client:r,schedule:s});return typeof r=="object"&&"remoteClient"in r&&(r.remoteClient=n),F1.clients.set(n,r),i.port2}static loadWorker(e){const s=cMe[e];return s?s():Promise.resolve(null)}constructor(e,s,i){this._port=e,this._jobQueue=i,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new gMe(r=>this._onInvokeMessage(r)),this._client=s.client,this._onMessage=this._onMessage.bind(this),this._channel=s.channel,this._schedule=s.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:LW}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,s,i){return this.apply(e,[s],i)}apply(e,s,i){const r=i==null?void 0:i.signal,n=i==null?void 0:i.transferList;if(!this._port)return Promise.reject(new ae(uue,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:s}));const o=cue();return new Promise((a,l)=>{if(Yl(r))return this._processWork(),void l(xi());const u=Ou(r,()=>{const h=this._outJobs.get(o);h&&(this._outJobs.delete(o),this._processWork(),qi(h.abortHandle),this._post({type:VW,jobId:o}),l(xi()))}),c={resolve:a,reject:l,abortHandle:u,debugInfo:e};this._outJobs.set(o,c),this._post({type:qW,jobId:o,methodName:e,abortable:r!=null},s,n)})}createInvokeProxy(e){return lue(this,e)}on(e,s){const i=new MessageChannel;function r(n){s(n.data)}return this._port.postMessage({type:qn.ON,eventType:e,port:i.port2},[i.port2]),i.port1.addEventListener("message",r),i.port1.start(),xs(()=>{i.port1.postMessage({type:qn.CLOSE}),i.port1.close(),i.port1.removeEventListener("message",r)})}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:GW,port:e.port2}),e.port1}_processWork(){var o;if(this._outJobs.size>=fMe)return;const e=(o=this._jobQueue)==null?void 0:o.pop();if(!e)return;const{methodName:s,data:i,invokeOptions:r,resolver:n}=e;this.apply(s,i,r).then(a=>n.resolve(a)).catch(a=>n.reject(a))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{qi(e.abortHandle),e.reject(xi(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e,!0)):this._processMessage(e,!1)}_processMessage(e,s){const i=NE(e);if(i)switch(i.type){case Rw:this._onResponseMessage(i);break;case qW:s?this._onInvokeMessage(i):this._invokeQueue.push(i);break;case VW:this._onAbortMessage(i);break;case LW:this._onCloseMessage();break;case GW:this._onOpenPortMessage(i);break;case pMe:this._onOnMessage(i)}}_onAbortMessage(e){const s=this._inJobs,i=e.jobId,r=s.get(i);this._invokeQueue.push(e),r&&(r.controller&&r.controller.abort(),s.delete(i))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&F1.clients.get(this)===e&&e.destroy(),F1.clients.delete(this),e!=null&&e.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:s,jobId:i,data:r=[],abortable:n}=e,o=n?new AbortController:null,a=this._inJobs;let l,u=this._client,c=u[s];try{if(!c&&s&&s.includes(".")){const h=s.split(".");for(let m=0;m<h.length-1;m++)u=u[h[m]],c=u[h[m+1]]}if(typeof c!="function")throw new TypeError(`${s} is not a function`);r.push({client:this,signal:o?o.signal:null}),l=c.apply(u,r)}catch(h){return void this._post({type:Rw,jobId:i,error:AE(h)})}sm(l)?(a.set(i,{controller:o,promise:l}),l.then(h=>{a.has(i)&&(a.delete(i),this._post({type:Rw,jobId:i},h))},h=>{a.has(i)&&(a.delete(i),Lr(h)||this._post({type:Rw,jobId:i,error:AE(h||{message:`Error encountered at method ${s}`})}))})):this._post({type:Rw,jobId:i},l)}_onOpenPortMessage(e){new F1(e.port,{client:this._client})}_onOnMessage(e){const{port:s}=e,i=this._client.on(e.eventType,n=>{s.postMessage(n)}),r=RC(e.port,"message",n=>{const o=NE(n);(o==null?void 0:o.type)===qn.CLOSE&&(r.remove(),i.remove(),s.close())})}_onResponseMessage(e){const{jobId:s,error:i,data:r}=e,n=this._outJobs;if(!n.has(s))return;const o=n.get(s);n.delete(s),this._processWork(),qi(o.abortHandle),i?o.reject(ae.fromJSON(JSON.parse(i))):o.resolve(r)}_post(e,s,i){return s7(this._port,e,s,i)}};Jf.kernelInfo={buildDate:Wae,fullVersion:$z,revision:Zae},Jf.clients=new Map;let yMe=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new XN}destroy(){this.close()}get closed(){var e;return!((e=this._clients)!=null&&e.length)}open(e,s){return new Promise((i,r)=>{let n=!0;const o=a=>{ni(s.signal),n&&(n=!1,a())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let a=0;a<e.length;++a){const l=e[a];sm(l)?this._clientPromises[a]=l.then(u=>(this._clients[a]=new Jf(u,s,this._ongoingJobsQueue),o(i),this._clients[a]),()=>(o(r),null)):(this._clients[a]=new Jf(l,s,this._ongoingJobsQueue),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(i))}})}broadcast(e,s,i){const r=new Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n){const o=this._clientPromises[n];r[n]=o.then(a=>a==null?void 0:a.invoke(e,s,i))}return r}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(xi(`Worker closing, aborting job calling '${e.methodName}'`));for(const s of this._clientPromises)s.then(i=>i==null?void 0:i.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,lMe(this)}invoke(e,s,i){return this.apply(e,[s],i)}apply(e,s,i){const r=Xl();this._ongoingJobsQueue.push({methodName:e,data:s,invokeOptions:i,resolver:r});for(let n=0;n<this._clientPromises.length;n++){const o=this._clients[n];o?o.jobAdded():this._clientPromises[n].then(a=>a==null?void 0:a.jobAdded())}return r.promise}createInvokeProxy(e){return lue(this,e)}on(e,s){return Promise.all(this._clientPromises).then(()=>AC(this._clients.map(i=>i.on(e,s))))}openPorts(){return new Promise(e=>{const s=new Array(this._clientPromises.length);let i=s.length;for(let r=0;r<this._clientPromises.length;++r)this._clientPromises[r].then(n=>{n&&(s[r]=n.openPort()),--i==0&&e(s)})})}get test(){}};const _Me={async request(t,e){var o,a;const s=t.options,i=s.responseType;s.signal=e==null?void 0:e.signal,s.responseType=i==="native"||i==="native-request-init"?"native-request-init":i&&["blob","json","text"].includes(i)&&((o=o5(t.url))!=null&&o.after)?i:"array-buffer";const r=await js(t.url,s),n={data:r.data,httpStatus:r.httpStatus,ssl:r.ssl};switch((a=r.requestOptions)==null?void 0:a.responseType){case"native-request-init":return delete n.data.signal,n;case"blob":n.data=await n.data.arrayBuffer();break;case"json":n.data=new TextEncoder().encode(JSON.stringify(n.data)).buffer;break;case"text":n.data=new TextEncoder().encode(n.data).buffer}return{result:n,transferList:[n.data]}}};let BS;var Bne,jne;const vMe=((Bne=globalThis.esriConfig)==null?void 0:Bne.locale)??((jne=globalThis.dojoConfig)==null?void 0:jne.locale);var Hne;const jS=(Hne=globalThis.document)==null?void 0:Hne.documentElement;function hue(){var s;const t=jS==null?void 0:jS.getAttribute("lang"),e=(s=globalThis.navigator)==null?void 0:s.language;return vMe??t??e??"en"}function Lo(){return BS===void 0&&(BS=hue()),BS}function amt(t=Lo()){const e=/^([a-zA-Z]{2,3})(?:[_-][a-zA-Z0-9]+)*$/.exec(t);return e==null?void 0:e[1].toLowerCase()}const VM=[];function mue(t){return VM.push(t),xs(()=>VM.splice(VM.indexOf(t),1))}const qM=[];function i7(t){return qM.push(t),xs(()=>qM.splice(qM.indexOf(t),1))}function zW(){const t=hue();BS!==t&&([...qM].forEach(e=>e(t)),BS=t,[...VM].forEach(e=>e(t)))}var Yne;(Yne=globalThis.addEventListener)==null||Yne.call(globalThis,"languagechange",zW),jS&&new MutationObserver(()=>{zW()}).observe(jS,{attributeFilter:["lang"]});const Gu="system",X_="unknown",Zh="UTC",bMe=Intl.DateTimeFormat().resolvedOptions().timeZone,UW=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class f0 extends Error{}class xMe extends f0{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class wMe extends f0{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class SMe extends f0{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class Iv extends f0{}class due extends f0{constructor(e){super(`Invalid unit ${e}`)}}class Ao extends f0{}class wp extends f0{constructor(){super("Zone is an abstract class")}}const Ze="numeric",Wc="short",jl="long",WN={year:Ze,month:Ze,day:Ze},pue={year:Ze,month:Wc,day:Ze},EMe={year:Ze,month:Wc,day:Ze,weekday:Wc},fue={year:Ze,month:jl,day:Ze},gue={year:Ze,month:jl,day:Ze,weekday:jl},yue={hour:Ze,minute:Ze},_ue={hour:Ze,minute:Ze,second:Ze},vue={hour:Ze,minute:Ze,second:Ze,timeZoneName:Wc},bue={hour:Ze,minute:Ze,second:Ze,timeZoneName:jl},xue={hour:Ze,minute:Ze,hourCycle:"h23"},wue={hour:Ze,minute:Ze,second:Ze,hourCycle:"h23"},Sue={hour:Ze,minute:Ze,second:Ze,hourCycle:"h23",timeZoneName:Wc},Eue={hour:Ze,minute:Ze,second:Ze,hourCycle:"h23",timeZoneName:jl},Cue={year:Ze,month:Ze,day:Ze,hour:Ze,minute:Ze},Pue={year:Ze,month:Ze,day:Ze,hour:Ze,minute:Ze,second:Ze},Tue={year:Ze,month:Wc,day:Ze,hour:Ze,minute:Ze},Iue={year:Ze,month:Wc,day:Ze,hour:Ze,minute:Ze,second:Ze},CMe={year:Ze,month:Wc,day:Ze,weekday:Wc,hour:Ze,minute:Ze},Mue={year:Ze,month:jl,day:Ze,hour:Ze,minute:Ze,timeZoneName:Wc},Aue={year:Ze,month:jl,day:Ze,hour:Ze,minute:Ze,second:Ze,timeZoneName:Wc},Nue={year:Ze,month:jl,day:Ze,weekday:jl,hour:Ze,minute:Ze,timeZoneName:jl},Due={year:Ze,month:jl,day:Ze,weekday:jl,hour:Ze,minute:Ze,second:Ze,timeZoneName:jl};class g0{get type(){throw new wp}get name(){throw new wp}get ianaName(){return this.name}get isUniversal(){throw new wp}offsetName(e,s){throw new wp}formatOffset(e,s){throw new wp}offset(e){throw new wp}equals(e){throw new wp}get isValid(){throw new wp}}let _4=null;class WD extends g0{static get instance(){return _4===null&&(_4=new WD),_4}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:s,locale:i}){return Gue(e,s,i)}formatOffset(e,s){return HS(this.offset(e),s)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let GM={};function PMe(t){return GM[t]||(GM[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),GM[t]}const TMe={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function IMe(t,e){const s=t.format(e).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(s),[,r,n,o,a,l,u,c]=i;return[o,r,n,a,l,u,c]}function MMe(t,e){const s=t.formatToParts(e),i=[];for(let r=0;r<s.length;r++){const{type:n,value:o}=s[r],a=TMe[n];n==="era"?i[a]=o:Gt(a)||(i[a]=parseInt(o,10))}return i}let ZT={};class el extends g0{static create(e){return ZT[e]||(ZT[e]=new el(e)),ZT[e]}static resetCache(){ZT={},GM={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=el.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:s,locale:i}){return Gue(e,s,i,this.name)}formatOffset(e,s){return HS(this.offset(e),s)}offset(e){const s=new Date(e);if(isNaN(s))return NaN;const i=PMe(this.name);let[r,n,o,a,l,u,c]=i.formatToParts?MMe(i,s):IMe(i,s);a==="BC"&&(r=-Math.abs(r)+1);const m=QD({year:r,month:n,day:o,hour:l===24?0:l,minute:u,second:c,millisecond:0});let f=+s;const g=f%1e3;return f-=g>=0?g:1e3+g,(m-f)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let BW={};function AMe(t,e={}){const s=JSON.stringify([t,e]);let i=BW[s];return i||(i=new Intl.ListFormat(t,e),BW[s]=i),i}let M5={};function A5(t,e={}){const s=JSON.stringify([t,e]);let i=M5[s];return i||(i=new Intl.DateTimeFormat(t,e),M5[s]=i),i}let N5={};function NMe(t,e={}){const s=JSON.stringify([t,e]);let i=N5[s];return i||(i=new Intl.NumberFormat(t,e),N5[s]=i),i}let D5={};function DMe(t,e={}){const{base:s,...i}=e,r=JSON.stringify([t,i]);let n=D5[r];return n||(n=new Intl.RelativeTimeFormat(t,e),D5[r]=n),n}let v2=null;function $Me(){return v2||(v2=new Intl.DateTimeFormat().resolvedOptions().locale,v2)}let jW={};function RMe(t){let e=jW[t];if(!e){const s=new Intl.Locale(t);e="getWeekInfo"in s?s.getWeekInfo():s.weekInfo,jW[t]=e}return e}function kMe(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const s=t.indexOf("-u-");if(s===-1)return[t];{let i,r;try{i=A5(t).resolvedOptions(),r=t}catch{const l=t.substring(0,s);i=A5(l).resolvedOptions(),r=l}const{numberingSystem:n,calendar:o}=i;return[r,n,o]}}function FMe(t,e,s){return(s||e)&&(t.includes("-u-")||(t+="-u"),s&&(t+=`-ca-${s}`),e&&(t+=`-nu-${e}`)),t}function OMe(t){const e=[];for(let s=1;s<=12;s++){const i=Je.utc(2009,s,1);e.push(t(i))}return e}function LMe(t){const e=[];for(let s=1;s<=7;s++){const i=Je.utc(2016,11,13+s);e.push(t(i))}return e}function QT(t,e,s,i){const r=t.listingMode();return r==="error"?null:r==="en"?s(e):i(e)}function VMe(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}class qMe{constructor(e,s,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:r,floor:n,...o}=i;if(!s||Object.keys(o).length>0){const a={useGrouping:!1,...i};i.padTo>0&&(a.minimumIntegerDigits=i.padTo),this.inf=NMe(e,a)}}format(e){if(this.inf){const s=this.floor?Math.floor(e):e;return this.inf.format(s)}else{const s=this.floor?Math.floor(e):l7(e,3);return Zr(s,this.padTo)}}}class GMe{constructor(e,s,i){this.opts=i,this.originalZone=void 0;let r;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&el.create(a).valid?(r=a,this.dt=e):(r="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,r=e.zone.name):(r="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const n={...this.opts};n.timeZone=n.timeZone||r,this.dtf=A5(s,n)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(s=>{if(s.type==="timeZoneName"){const i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...s,value:i}}else return s}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class zMe{constructor(e,s,i){this.opts={style:"long",...i},!s&&Vue()&&(this.rtf=DMe(e,i))}format(e,s){return this.rtf?this.rtf.format(e,s):hAe(s,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,s){return this.rtf?this.rtf.formatToParts(e,s):[]}}const UMe={firstDay:1,minimalDays:4,weekend:[6,7]};class Zs{static fromOpts(e){return Zs.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,s,i,r,n=!1){const o=e||wr.defaultLocale,a=o||(n?"en-US":$Me()),l=s||wr.defaultNumberingSystem,u=i||wr.defaultOutputCalendar,c=$5(r)||wr.defaultWeekSettings;return new Zs(a,l,u,c,o)}static resetCache(){v2=null,M5={},N5={},D5={}}static fromObject({locale:e,numberingSystem:s,outputCalendar:i,weekSettings:r}={}){return Zs.create(e,s,i,r)}constructor(e,s,i,r,n){const[o,a,l]=kMe(e);this.locale=o,this.numberingSystem=s||a||null,this.outputCalendar=i||l||null,this.weekSettings=r,this.intl=FMe(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=VMe(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),s=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&s?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Zs.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,$5(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,s=!1){return QT(this,e,Bue,()=>{const i=s?{month:e,day:"numeric"}:{month:e},r=s?"format":"standalone";return this.monthsCache[r][e]||(this.monthsCache[r][e]=OMe(n=>this.extract(n,i,"month"))),this.monthsCache[r][e]})}weekdays(e,s=!1){return QT(this,e,Yue,()=>{const i=s?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},r=s?"format":"standalone";return this.weekdaysCache[r][e]||(this.weekdaysCache[r][e]=LMe(n=>this.extract(n,i,"weekday"))),this.weekdaysCache[r][e]})}meridiems(){return QT(this,void 0,()=>Xue,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Je.utc(2016,11,13,9),Je.utc(2016,11,13,19)].map(s=>this.extract(s,e,"dayperiod"))}return this.meridiemCache})}eras(e){return QT(this,e,Wue,()=>{const s={era:e};return this.eraCache[e]||(this.eraCache[e]=[Je.utc(-40,1,1),Je.utc(2017,1,1)].map(i=>this.extract(i,s,"era"))),this.eraCache[e]})}extract(e,s,i){const r=this.dtFormatter(e,s),n=r.formatToParts(),o=n.find(a=>a.type.toLowerCase()===i);return o?o.value:null}numberFormatter(e={}){return new qMe(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,s={}){return new GMe(e,this.intl,s)}relFormatter(e={}){return new zMe(this.intl,this.isEnglish(),e)}listFormatter(e={}){return AMe(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:que()?RMe(this.locale):UMe}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let v4=null;class en extends g0{static get utcInstance(){return v4===null&&(v4=new en(0)),v4}static instance(e){return e===0?en.utcInstance:new en(e)}static parseSpecifier(e){if(e){const s=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(s)return new en(JD(s[1],s[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${HS(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${HS(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,s){return HS(this.fixed,s)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class BMe extends g0{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Sf(t,e){if(Gt(t)||t===null)return e;if(t instanceof g0)return t;if(ZMe(t)){const s=t.toLowerCase();return s==="default"?e:s==="local"||s==="system"?WD.instance:s==="utc"||s==="gmt"?en.utcInstance:en.parseSpecifier(s)||el.create(t)}else return qf(t)?en.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new BMe(t)}const r7={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},HW={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},jMe=r7.hanidec.replace(/[\[|\]]/g,"").split("");function HMe(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let s=0;s<t.length;s++){const i=t.charCodeAt(s);if(t[s].search(r7.hanidec)!==-1)e+=jMe.indexOf(t[s]);else for(const r in HW){const[n,o]=HW[r];i>=n&&i<=o&&(e+=i-n)}}return parseInt(e,10)}else return e}let O1={};function YMe(){O1={}}function tc({numberingSystem:t},e=""){const s=t||"latn";return O1[s]||(O1[s]={}),O1[s][e]||(O1[s][e]=new RegExp(`${r7[s]}${e}`)),O1[s][e]}let YW=()=>Date.now(),XW="system",WW=null,ZW=null,QW=null,JW=60,KW,eZ=null;class wr{static get now(){return YW}static set now(e){YW=e}static set defaultZone(e){XW=e}static get defaultZone(){return Sf(XW,WD.instance)}static get defaultLocale(){return WW}static set defaultLocale(e){WW=e}static get defaultNumberingSystem(){return ZW}static set defaultNumberingSystem(e){ZW=e}static get defaultOutputCalendar(){return QW}static set defaultOutputCalendar(e){QW=e}static get defaultWeekSettings(){return eZ}static set defaultWeekSettings(e){eZ=$5(e)}static get twoDigitCutoffYear(){return JW}static set twoDigitCutoffYear(e){JW=e%100}static get throwOnInvalid(){return KW}static set throwOnInvalid(e){KW=e}static resetCaches(){Zs.resetCache(),el.resetCache(),Je.resetCache(),YMe()}}class Lc{constructor(e,s){this.reason=e,this.explanation=s}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const $ue=[0,31,59,90,120,151,181,212,243,273,304,334],Rue=[0,31,60,91,121,152,182,213,244,274,305,335];function ku(t,e){return new Lc("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function n7(t,e,s){const i=new Date(Date.UTC(t,e-1,s));t<100&&t>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);const r=i.getUTCDay();return r===0?7:r}function kue(t,e,s){return s+(UC(t)?Rue:$ue)[e-1]}function Fue(t,e){const s=UC(t)?Rue:$ue,i=s.findIndex(n=>n<e),r=e-s[i];return{month:i+1,day:r}}function o7(t,e){return(t-e+7)%7+1}function ZN(t,e=4,s=1){const{year:i,month:r,day:n}=t,o=kue(i,r,n),a=o7(n7(i,r,n),s);let l=Math.floor((o-a+14-e)/7),u;return l<1?(u=i-1,l=DE(u,e,s)):l>DE(i,e,s)?(u=i+1,l=1):u=i,{weekYear:u,weekNumber:l,weekday:a,...KD(t)}}function tZ(t,e=4,s=1){const{weekYear:i,weekNumber:r,weekday:n}=t,o=o7(n7(i,1,e),s),a=Hv(i);let l=r*7+n-o-7+e,u;l<1?(u=i-1,l+=Hv(u)):l>a?(u=i+1,l-=Hv(i)):u=i;const{month:c,day:h}=Fue(u,l);return{year:u,month:c,day:h,...KD(t)}}function b4(t){const{year:e,month:s,day:i}=t,r=kue(e,s,i);return{year:e,ordinal:r,...KD(t)}}function sZ(t){const{year:e,ordinal:s}=t,{month:i,day:r}=Fue(e,s);return{year:e,month:i,day:r,...KD(t)}}function iZ(t,e){if(!Gt(t.localWeekday)||!Gt(t.localWeekNumber)||!Gt(t.localWeekYear)){if(!Gt(t.weekday)||!Gt(t.weekNumber)||!Gt(t.weekYear))throw new Iv("Cannot mix locale-based week fields with ISO-based week fields");return Gt(t.localWeekday)||(t.weekday=t.localWeekday),Gt(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),Gt(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function XMe(t,e=4,s=1){const i=ZD(t.weekYear),r=Fu(t.weekNumber,1,DE(t.weekYear,e,s)),n=Fu(t.weekday,1,7);return i?r?n?!1:ku("weekday",t.weekday):ku("week",t.weekNumber):ku("weekYear",t.weekYear)}function WMe(t){const e=ZD(t.year),s=Fu(t.ordinal,1,Hv(t.year));return e?s?!1:ku("ordinal",t.ordinal):ku("year",t.year)}function Oue(t){const e=ZD(t.year),s=Fu(t.month,1,12),i=Fu(t.day,1,QN(t.year,t.month));return e?s?i?!1:ku("day",t.day):ku("month",t.month):ku("year",t.year)}function Lue(t){const{hour:e,minute:s,second:i,millisecond:r}=t,n=Fu(e,0,23)||e===24&&s===0&&i===0&&r===0,o=Fu(s,0,59),a=Fu(i,0,59),l=Fu(r,0,999);return n?o?a?l?!1:ku("millisecond",r):ku("second",i):ku("minute",s):ku("hour",e)}function Gt(t){return typeof t>"u"}function qf(t){return typeof t=="number"}function ZD(t){return typeof t=="number"&&t%1===0}function ZMe(t){return typeof t=="string"}function QMe(t){return Object.prototype.toString.call(t)==="[object Date]"}function Vue(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function que(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function JMe(t){return Array.isArray(t)?t:[t]}function rZ(t,e,s){if(t.length!==0)return t.reduce((i,r)=>{const n=[e(r),r];return i&&s(i[0],n[0])===i[0]?i:n},null)[1]}function KMe(t,e){return e.reduce((s,i)=>(s[i]=t[i],s),{})}function Cb(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $5(t){if(t==null)return null;if(typeof t!="object")throw new Ao("Week settings must be an object");if(!Fu(t.firstDay,1,7)||!Fu(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!Fu(e,1,7)))throw new Ao("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function Fu(t,e,s){return ZD(t)&&t>=e&&t<=s}function eAe(t,e){return t-e*Math.floor(t/e)}function Zr(t,e=2){const s=t<0;let i;return s?i="-"+(""+-t).padStart(e,"0"):i=(""+t).padStart(e,"0"),i}function hf(t){if(!(Gt(t)||t===null||t===""))return parseInt(t,10)}function jg(t){if(!(Gt(t)||t===null||t===""))return parseFloat(t)}function a7(t){if(!(Gt(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function l7(t,e,s=!1){const i=10**e;return(s?Math.trunc:Math.round)(t*i)/i}function UC(t){return t%4===0&&(t%100!==0||t%400===0)}function Hv(t){return UC(t)?366:365}function QN(t,e){const s=eAe(e-1,12)+1,i=t+(e-s)/12;return s===2?UC(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][s-1]}function QD(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function nZ(t,e,s){return-o7(n7(t,1,e),s)+e-1}function DE(t,e=4,s=1){const i=nZ(t,e,s),r=nZ(t+1,e,s);return(Hv(t)-i+r)/7}function R5(t){return t>99?t:t>wr.twoDigitCutoffYear?1900+t:2e3+t}function Gue(t,e,s,i=null){const r=new Date(t),n={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(n.timeZone=i);const o={timeZoneName:e,...n},a=new Intl.DateTimeFormat(s,o).formatToParts(r).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function JD(t,e){let s=parseInt(t,10);Number.isNaN(s)&&(s=0);const i=parseInt(e,10)||0,r=s<0||Object.is(s,-0)?-i:i;return s*60+r}function zue(t){const e=Number(t);if(typeof t=="boolean"||t===""||Number.isNaN(e))throw new Ao(`Invalid unit value ${t}`);return e}function JN(t,e){const s={};for(const i in t)if(Cb(t,i)){const r=t[i];if(r==null)continue;s[e(i)]=zue(r)}return s}function HS(t,e){const s=Math.trunc(Math.abs(t/60)),i=Math.trunc(Math.abs(t%60)),r=t>=0?"+":"-";switch(e){case"short":return`${r}${Zr(s,2)}:${Zr(i,2)}`;case"narrow":return`${r}${s}${i>0?`:${i}`:""}`;case"techie":return`${r}${Zr(s,2)}${Zr(i,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function KD(t){return KMe(t,["hour","minute","second","millisecond"])}const tAe=["January","February","March","April","May","June","July","August","September","October","November","December"],Uue=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],sAe=["J","F","M","A","M","J","J","A","S","O","N","D"];function Bue(t){switch(t){case"narrow":return[...sAe];case"short":return[...Uue];case"long":return[...tAe];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const jue=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Hue=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],iAe=["M","T","W","T","F","S","S"];function Yue(t){switch(t){case"narrow":return[...iAe];case"short":return[...Hue];case"long":return[...jue];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const Xue=["AM","PM"],rAe=["Before Christ","Anno Domini"],nAe=["BC","AD"],oAe=["B","A"];function Wue(t){switch(t){case"narrow":return[...oAe];case"short":return[...nAe];case"long":return[...rAe];default:return null}}function aAe(t){return Xue[t.hour<12?0:1]}function lAe(t,e){return Yue(e)[t.weekday-1]}function uAe(t,e){return Bue(e)[t.month-1]}function cAe(t,e){return Wue(e)[t.year<0?0:1]}function hAe(t,e,s="always",i=!1){const r={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},n=["hours","minutes","seconds"].indexOf(t)===-1;if(s==="auto"&&n){const h=t==="days";switch(e){case 1:return h?"tomorrow":`next ${r[t][0]}`;case-1:return h?"yesterday":`last ${r[t][0]}`;case 0:return h?"today":`this ${r[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,u=r[t],c=i?l?u[1]:u[2]||u[1]:l?r[t][0]:t;return o?`${a} ${c} ago`:`in ${a} ${c}`}function oZ(t,e){let s="";for(const i of t)i.literal?s+=i.val:s+=e(i.val);return s}const mAe={D:WN,DD:pue,DDD:fue,DDDD:gue,t:yue,tt:_ue,ttt:vue,tttt:bue,T:xue,TT:wue,TTT:Sue,TTTT:Eue,f:Cue,ff:Tue,fff:Mue,ffff:Nue,F:Pue,FF:Iue,FFF:Aue,FFFF:Due};class Ro{static create(e,s={}){return new Ro(e,s)}static parseFormat(e){let s=null,i="",r=!1;const n=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?(i.length>0&&n.push({literal:r||/^\s+$/.test(i),val:i}),s=null,i="",r=!r):r||a===s?i+=a:(i.length>0&&n.push({literal:/^\s+$/.test(i),val:i}),i=a,s=a)}return i.length>0&&n.push({literal:r||/^\s+$/.test(i),val:i}),n}static macroTokenToFormatOpts(e){return mAe[e]}constructor(e,s){this.opts=s,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,s){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...s}).format()}dtFormatter(e,s={}){return this.loc.dtFormatter(e,{...this.opts,...s})}formatDateTime(e,s){return this.dtFormatter(e,s).format()}formatDateTimeParts(e,s){return this.dtFormatter(e,s).formatToParts()}formatInterval(e,s){return this.dtFormatter(e.start,s).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,s){return this.dtFormatter(e,s).resolvedOptions()}num(e,s=0){if(this.opts.forceSimple)return Zr(e,s);const i={...this.opts};return s>0&&(i.padTo=s),this.loc.numberFormatter(i).format(e)}formatDateTimeFromString(e,s){const i=this.loc.listingMode()==="en",r=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",n=(f,g)=>this.loc.extract(e,f,g),o=f=>e.isOffsetFixed&&e.offset===0&&f.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,f.format):"",a=()=>i?aAe(e):n({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(f,g)=>i?uAe(e,f):n(g?{month:f}:{month:f,day:"numeric"},"month"),u=(f,g)=>i?lAe(e,f):n(g?{weekday:f}:{weekday:f,month:"long",day:"numeric"},"weekday"),c=f=>{const g=Ro.macroTokenToFormatOpts(f);return g?this.formatWithSystemDefault(e,g):f},h=f=>i?cAe(e,f):n({era:f},"era"),m=f=>{switch(f){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return r?n({day:"numeric"},"day"):this.num(e.day);case"dd":return r?n({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return u("short",!0);case"cccc":return u("long",!0);case"ccccc":return u("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return u("short",!1);case"EEEE":return u("long",!1);case"EEEEE":return u("narrow",!1);case"L":return r?n({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return r?n({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return r?n({month:"numeric"},"month"):this.num(e.month);case"MM":return r?n({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return r?n({year:"numeric"},"year"):this.num(e.year);case"yy":return r?n({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return r?n({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return r?n({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return c(f)}};return oZ(Ro.parseFormat(s),m)}formatDurationFromString(e,s){const i=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},r=l=>u=>{const c=i(u);return c?this.num(l.get(c),u.length):u},n=Ro.parseFormat(s),o=n.reduce((l,{literal:u,val:c})=>u?l:l.concat(c),[]),a=e.shiftTo(...o.map(i).filter(l=>l));return oZ(n,r(a))}}const Zue=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function rx(...t){const e=t.reduce((s,i)=>s+i.source,"");return RegExp(`^${e}$`)}function nx(...t){return e=>t.reduce(([s,i,r],n)=>{const[o,a,l]=n(e,r);return[{...s,...o},a||i,l]},[{},null,1]).slice(0,2)}function ox(t,...e){if(t==null)return[null,null];for(const[s,i]of e){const r=s.exec(t);if(r)return i(r)}return[null,null]}function Que(...t){return(e,s)=>{const i={};let r;for(r=0;r<t.length;r++)i[t[r]]=hf(e[s+r]);return[i,null,s+r]}}const Jue=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,dAe=`(?:${Jue.source}?(?:\\[(${Zue.source})\\])?)?`,u7=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Kue=RegExp(`${u7.source}${dAe}`),c7=RegExp(`(?:T${Kue.source})?`),pAe=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,fAe=/(\d{4})-?W(\d\d)(?:-?(\d))?/,gAe=/(\d{4})-?(\d{3})/,yAe=Que("weekYear","weekNumber","weekDay"),_Ae=Que("year","ordinal"),vAe=/(\d{4})-(\d\d)-(\d\d)/,ece=RegExp(`${u7.source} ?(?:${Jue.source}|(${Zue.source}))?`),bAe=RegExp(`(?: ${ece.source})?`);function Yv(t,e,s){const i=t[e];return Gt(i)?s:hf(i)}function xAe(t,e){return[{year:Yv(t,e),month:Yv(t,e+1,1),day:Yv(t,e+2,1)},null,e+3]}function ax(t,e){return[{hours:Yv(t,e,0),minutes:Yv(t,e+1,0),seconds:Yv(t,e+2,0),milliseconds:a7(t[e+3])},null,e+4]}function BC(t,e){const s=!t[e]&&!t[e+1],i=JD(t[e+1],t[e+2]),r=s?null:en.instance(i);return[{},r,e+3]}function jC(t,e){const s=t[e]?el.create(t[e]):null;return[{},s,e+1]}const wAe=RegExp(`^T?${u7.source}$`),SAe=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function EAe(t){const[e,s,i,r,n,o,a,l,u]=t,c=e[0]==="-",h=l&&l[0]==="-",m=(f,g=!1)=>f!==void 0&&(g||f&&c)?-f:f;return[{years:m(jg(s)),months:m(jg(i)),weeks:m(jg(r)),days:m(jg(n)),hours:m(jg(o)),minutes:m(jg(a)),seconds:m(jg(l),l==="-0"),milliseconds:m(a7(u),h)}]}const CAe={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function h7(t,e,s,i,r,n,o){const a={year:e.length===2?R5(hf(e)):hf(e),month:Uue.indexOf(s)+1,day:hf(i),hour:hf(r),minute:hf(n)};return o&&(a.second=hf(o)),t&&(a.weekday=t.length>3?jue.indexOf(t)+1:Hue.indexOf(t)+1),a}const PAe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function TAe(t){const[,e,s,i,r,n,o,a,l,u,c,h]=t,m=h7(e,r,i,s,n,o,a);let f;return l?f=CAe[l]:u?f=0:f=JD(c,h),[m,new en(f)]}function IAe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const MAe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,AAe=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,NAe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function aZ(t){const[,e,s,i,r,n,o,a]=t;return[h7(e,r,i,s,n,o,a),en.utcInstance]}function DAe(t){const[,e,s,i,r,n,o,a]=t;return[h7(e,a,s,i,r,n,o),en.utcInstance]}const $Ae=rx(pAe,c7),RAe=rx(fAe,c7),kAe=rx(gAe,c7),FAe=rx(Kue),tce=nx(xAe,ax,BC,jC),OAe=nx(yAe,ax,BC,jC),LAe=nx(_Ae,ax,BC,jC),VAe=nx(ax,BC,jC);function qAe(t){return ox(t,[$Ae,tce],[RAe,OAe],[kAe,LAe],[FAe,VAe])}function GAe(t){return ox(IAe(t),[PAe,TAe])}function zAe(t){return ox(t,[MAe,aZ],[AAe,aZ],[NAe,DAe])}function UAe(t){return ox(t,[SAe,EAe])}const BAe=nx(ax);function jAe(t){return ox(t,[wAe,BAe])}const HAe=rx(vAe,bAe),YAe=rx(ece),XAe=nx(ax,BC,jC);function WAe(t){return ox(t,[HAe,tce],[YAe,XAe])}const lZ="Invalid Duration",sce={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},ZAe={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...sce},mu=146097/400,u1=146097/4800,QAe={years:{quarters:4,months:12,weeks:mu/7,days:mu,hours:mu*24,minutes:mu*24*60,seconds:mu*24*60*60,milliseconds:mu*24*60*60*1e3},quarters:{months:3,weeks:mu/28,days:mu/4,hours:mu*24/4,minutes:mu*24*60/4,seconds:mu*24*60*60/4,milliseconds:mu*24*60*60*1e3/4},months:{weeks:u1/7,days:u1,hours:u1*24,minutes:u1*24*60,seconds:u1*24*60*60,milliseconds:u1*24*60*60*1e3},...sce},a_=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],JAe=a_.slice(0).reverse();function Sp(t,e,s=!1){const i={values:s?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new Ss(i)}function ice(t,e){let s=e.milliseconds??0;for(const i of JAe.slice(1))e[i]&&(s+=e[i]*t[i].milliseconds);return s}function uZ(t,e){const s=ice(t,e)<0?-1:1;a_.reduceRight((i,r)=>{if(Gt(e[r]))return i;if(i){const n=e[i]*s,o=t[r][i],a=Math.floor(n/o);e[r]+=a*s,e[i]-=a*o*s}return r},null),a_.reduce((i,r)=>{if(Gt(e[r]))return i;if(i){const n=e[i]%1;e[i]-=n,e[r]+=n*t[i][r]}return r},null)}function KAe(t){const e={};for(const[s,i]of Object.entries(t))i!==0&&(e[s]=i);return e}class Ss{constructor(e){const s=e.conversionAccuracy==="longterm"||!1;let i=s?QAe:ZAe;e.matrix&&(i=e.matrix),this.values=e.values,this.loc=e.loc||Zs.create(),this.conversionAccuracy=s?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(e,s){return Ss.fromObject({milliseconds:e},s)}static fromObject(e,s={}){if(e==null||typeof e!="object")throw new Ao(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Ss({values:JN(e,Ss.normalizeUnit),loc:Zs.fromObject(s),conversionAccuracy:s.conversionAccuracy,matrix:s.matrix})}static fromDurationLike(e){if(qf(e))return Ss.fromMillis(e);if(Ss.isDuration(e))return e;if(typeof e=="object")return Ss.fromObject(e);throw new Ao(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,s){const[i]=UAe(e);return i?Ss.fromObject(i,s):Ss.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,s){const[i]=jAe(e);return i?Ss.fromObject(i,s):Ss.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,s=null){if(!e)throw new Ao("need to specify a reason the Duration is invalid");const i=e instanceof Lc?e:new Lc(e,s);if(wr.throwOnInvalid)throw new SMe(i);return new Ss({invalid:i})}static normalizeUnit(e){const s={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!s)throw new due(e);return s}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,s={}){const i={...s,floor:s.round!==!1&&s.floor!==!1};return this.isValid?Ro.create(this.loc,i).formatDurationFromString(this,e):lZ}toHuman(e={}){if(!this.isValid)return lZ;const s=a_.map(i=>{const r=this.values[i];return Gt(r)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:i.slice(0,-1)}).format(r)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(s)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=l7(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const s=this.toMillis();return s<0||s>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},Je.fromMillis(s,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?ice(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const s=Ss.fromDurationLike(e),i={};for(const r of a_)(Cb(s.values,r)||Cb(this.values,r))&&(i[r]=s.get(r)+this.get(r));return Sp(this,{values:i},!0)}minus(e){if(!this.isValid)return this;const s=Ss.fromDurationLike(e);return this.plus(s.negate())}mapUnits(e){if(!this.isValid)return this;const s={};for(const i of Object.keys(this.values))s[i]=zue(e(this.values[i],i));return Sp(this,{values:s},!0)}get(e){return this[Ss.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const s={...this.values,...JN(e,Ss.normalizeUnit)};return Sp(this,{values:s})}reconfigure({locale:e,numberingSystem:s,conversionAccuracy:i,matrix:r}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:s}),matrix:r,conversionAccuracy:i};return Sp(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return uZ(this.matrix,e),Sp(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=KAe(this.normalize().shiftToAll().toObject());return Sp(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>Ss.normalizeUnit(o));const s={},i={},r=this.toObject();let n;for(const o of a_)if(e.indexOf(o)>=0){n=o;let a=0;for(const u in i)a+=this.matrix[u][o]*i[u],i[u]=0;qf(r[o])&&(a+=r[o]);const l=Math.trunc(a);s[o]=l,i[o]=(a*1e3-l*1e3)/1e3}else qf(r[o])&&(i[o]=r[o]);for(const o in i)i[o]!==0&&(s[n]+=o===n?i[o]:i[o]/this.matrix[n][o]);return uZ(this.matrix,s),Sp(this,{values:s},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const s of Object.keys(this.values))e[s]=this.values[s]===0?0:-this.values[s];return Sp(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function s(i,r){return i===void 0||i===0?r===void 0||r===0:i===r}for(const i of a_)if(!s(this.values[i],e.values[i]))return!1;return!0}}const c1="Invalid Interval";function eNe(t,e){return!t||!t.isValid?xr.invalid("missing or invalid start"):!e||!e.isValid?xr.invalid("missing or invalid end"):e<t?xr.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class xr{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,s=null){if(!e)throw new Ao("need to specify a reason the Interval is invalid");const i=e instanceof Lc?e:new Lc(e,s);if(wr.throwOnInvalid)throw new wMe(i);return new xr({invalid:i})}static fromDateTimes(e,s){const i=kw(e),r=kw(s),n=eNe(i,r);return n??new xr({start:i,end:r})}static after(e,s){const i=Ss.fromDurationLike(s),r=kw(e);return xr.fromDateTimes(r,r.plus(i))}static before(e,s){const i=Ss.fromDurationLike(s),r=kw(e);return xr.fromDateTimes(r.minus(i),r)}static fromISO(e,s){const[i,r]=(e||"").split("/",2);if(i&&r){let n,o;try{n=Je.fromISO(i,s),o=n.isValid}catch{o=!1}let a,l;try{a=Je.fromISO(r,s),l=a.isValid}catch{l=!1}if(o&&l)return xr.fromDateTimes(n,a);if(o){const u=Ss.fromISO(r,s);if(u.isValid)return xr.after(n,u)}else if(l){const u=Ss.fromISO(i,s);if(u.isValid)return xr.before(a,u)}}return xr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",s){if(!this.isValid)return NaN;const i=this.start.startOf(e,s);let r;return s!=null&&s.useLocaleWeeks?r=this.end.reconfigure({locale:i.locale}):r=this.end,r=r.startOf(e,s),Math.floor(r.diff(i,e).get(e))+(r.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:s}={}){return this.isValid?xr.fromDateTimes(e||this.s,s||this.e):this}splitAt(...e){if(!this.isValid)return[];const s=e.map(kw).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),i=[];let{s:r}=this,n=0;for(;r<this.e;){const o=s[n]||this.e,a=+o>+this.e?this.e:o;i.push(xr.fromDateTimes(r,a)),r=a,n+=1}return i}splitBy(e){const s=Ss.fromDurationLike(e);if(!this.isValid||!s.isValid||s.as("milliseconds")===0)return[];let{s:i}=this,r=1,n;const o=[];for(;i<this.e;){const a=this.start.plus(s.mapUnits(l=>l*r));n=+a>+this.e?this.e:a,o.push(xr.fromDateTimes(i,n)),i=n,r+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const s=this.s>e.s?this.s:e.s,i=this.e<e.e?this.e:e.e;return s>=i?null:xr.fromDateTimes(s,i)}union(e){if(!this.isValid)return this;const s=this.s<e.s?this.s:e.s,i=this.e>e.e?this.e:e.e;return xr.fromDateTimes(s,i)}static merge(e){const[s,i]=e.sort((r,n)=>r.s-n.s).reduce(([r,n],o)=>n?n.overlaps(o)||n.abutsStart(o)?[r,n.union(o)]:[r.concat([n]),o]:[r,o],[[],null]);return i&&s.push(i),s}static xor(e){let s=null,i=0;const r=[],n=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...n),a=o.sort((l,u)=>l.time-u.time);for(const l of a)i+=l.type==="s"?1:-1,i===1?s=l.time:(s&&+s!=+l.time&&r.push(xr.fromDateTimes(s,l.time)),s=null);return xr.merge(r)}difference(...e){return xr.xor([this].concat(e)).map(s=>this.intersection(s)).filter(s=>s&&!s.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:c1}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=WN,s={}){return this.isValid?Ro.create(this.s.loc.clone(s),e).formatInterval(this):c1}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:c1}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:c1}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:c1}toFormat(e,{separator:s=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${s}${this.e.toFormat(e)}`:c1}toDuration(e,s){return this.isValid?this.e.diff(this.s,e,s):Ss.invalid(this.invalidReason)}mapEndpoints(e){return xr.fromDateTimes(e(this.s),e(this.e))}}class JT{static hasDST(e=wr.defaultZone){const s=Je.now().setZone(e).set({month:12});return!e.isUniversal&&s.offset!==s.set({month:6}).offset}static isValidIANAZone(e){return el.isValidZone(e)}static normalizeZone(e){return Sf(e,wr.defaultZone)}static getStartOfWeek({locale:e=null,locObj:s=null}={}){return(s||Zs.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:s=null}={}){return(s||Zs.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:s=null}={}){return(s||Zs.create(e)).getWeekendDays().slice()}static months(e="long",{locale:s=null,numberingSystem:i=null,locObj:r=null,outputCalendar:n="gregory"}={}){return(r||Zs.create(s,i,n)).months(e)}static monthsFormat(e="long",{locale:s=null,numberingSystem:i=null,locObj:r=null,outputCalendar:n="gregory"}={}){return(r||Zs.create(s,i,n)).months(e,!0)}static weekdays(e="long",{locale:s=null,numberingSystem:i=null,locObj:r=null}={}){return(r||Zs.create(s,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:s=null,numberingSystem:i=null,locObj:r=null}={}){return(r||Zs.create(s,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Zs.create(e).meridiems()}static eras(e="short",{locale:s=null}={}){return Zs.create(s,null,"gregory").eras(e)}static features(){return{relative:Vue(),localeWeek:que()}}}function cZ(t,e){const s=r=>r.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=s(e)-s(t);return Math.floor(Ss.fromMillis(i).as("days"))}function tNe(t,e,s){const i=[["years",(l,u)=>u.year-l.year],["quarters",(l,u)=>u.quarter-l.quarter+(u.year-l.year)*4],["months",(l,u)=>u.month-l.month+(u.year-l.year)*12],["weeks",(l,u)=>{const c=cZ(l,u);return(c-c%7)/7}],["days",cZ]],r={},n=t;let o,a;for(const[l,u]of i)s.indexOf(l)>=0&&(o=l,r[l]=u(t,e),a=n.plus(r),a>e?(r[l]--,t=n.plus(r),t>e&&(a=t,r[l]--,t=n.plus(r))):t=a);return[t,r,a,o]}function sNe(t,e,s,i){let[r,n,o,a]=tNe(t,e,s);const l=e-r,u=s.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);u.length===0&&(o<e&&(o=r.plus({[a]:1})),o!==r&&(n[a]=(n[a]||0)+l/(o-r)));const c=Ss.fromObject(n,i);return u.length>0?Ss.fromMillis(l,i).shiftTo(...u).plus(c):c}const iNe="missing Intl.DateTimeFormat.formatToParts support";function Os(t,e=s=>s){return{regex:t,deser:([s])=>e(HMe(s))}}const rNe=" ",rce=`[ ${rNe}]`,nce=new RegExp(rce,"g");function nNe(t){return t.replace(/\./g,"\\.?").replace(nce,rce)}function hZ(t){return t.replace(/\./g,"").replace(nce," ").toLowerCase()}function sc(t,e){return t===null?null:{regex:RegExp(t.map(nNe).join("|")),deser:([s])=>t.findIndex(i=>hZ(s)===hZ(i))+e}}function mZ(t,e){return{regex:t,deser:([,s,i])=>JD(s,i),groups:e}}function KT(t){return{regex:t,deser:([e])=>e}}function oNe(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function aNe(t,e){const s=tc(e),i=tc(e,"{2}"),r=tc(e,"{3}"),n=tc(e,"{4}"),o=tc(e,"{6}"),a=tc(e,"{1,2}"),l=tc(e,"{1,3}"),u=tc(e,"{1,6}"),c=tc(e,"{1,9}"),h=tc(e,"{2,4}"),m=tc(e,"{4,6}"),f=b=>({regex:RegExp(oNe(b.val)),deser:([w])=>w,literal:!0}),v=(b=>{if(t.literal)return f(b);switch(b.val){case"G":return sc(e.eras("short"),0);case"GG":return sc(e.eras("long"),0);case"y":return Os(u);case"yy":return Os(h,R5);case"yyyy":return Os(n);case"yyyyy":return Os(m);case"yyyyyy":return Os(o);case"M":return Os(a);case"MM":return Os(i);case"MMM":return sc(e.months("short",!0),1);case"MMMM":return sc(e.months("long",!0),1);case"L":return Os(a);case"LL":return Os(i);case"LLL":return sc(e.months("short",!1),1);case"LLLL":return sc(e.months("long",!1),1);case"d":return Os(a);case"dd":return Os(i);case"o":return Os(l);case"ooo":return Os(r);case"HH":return Os(i);case"H":return Os(a);case"hh":return Os(i);case"h":return Os(a);case"mm":return Os(i);case"m":return Os(a);case"q":return Os(a);case"qq":return Os(i);case"s":return Os(a);case"ss":return Os(i);case"S":return Os(l);case"SSS":return Os(r);case"u":return KT(c);case"uu":return KT(a);case"uuu":return Os(s);case"a":return sc(e.meridiems(),0);case"kkkk":return Os(n);case"kk":return Os(h,R5);case"W":return Os(a);case"WW":return Os(i);case"E":case"c":return Os(s);case"EEE":return sc(e.weekdays("short",!1),1);case"EEEE":return sc(e.weekdays("long",!1),1);case"ccc":return sc(e.weekdays("short",!0),1);case"cccc":return sc(e.weekdays("long",!0),1);case"Z":case"ZZ":return mZ(new RegExp(`([+-]${a.source})(?::(${i.source}))?`),2);case"ZZZ":return mZ(new RegExp(`([+-]${a.source})(${i.source})?`),2);case"z":return KT(/[a-z_+-/]{1,256}?/i);case" ":return KT(/[^\S\n\r]/);default:return f(b)}})(t)||{invalidReason:iNe};return v.token=t,v}const lNe={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function uNe(t,e,s){const{type:i,value:r}=t;if(i==="literal"){const l=/^\s+$/.test(r);return{literal:!l,val:l?" ":r}}const n=e[i];let o=i;i==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=s.hour12?"hour12":"hour24");let a=lNe[o];if(typeof a=="object"&&(a=a[n]),a)return{literal:!1,val:a}}function cNe(t){return[`^${t.map(s=>s.regex).reduce((s,i)=>`${s}(${i.source})`,"")}$`,t]}function hNe(t,e,s){const i=t.match(e);if(i){const r={};let n=1;for(const o in s)if(Cb(s,o)){const a=s[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(r[a.token.val[0]]=a.deser(i.slice(n,n+l))),n+=l}return[i,r]}else return[i,{}]}function mNe(t){const e=n=>{switch(n){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let s=null,i;return Gt(t.z)||(s=el.create(t.z)),Gt(t.Z)||(s||(s=new en(t.Z)),i=t.Z),Gt(t.q)||(t.M=(t.q-1)*3+1),Gt(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Gt(t.u)||(t.S=a7(t.u)),[Object.keys(t).reduce((n,o)=>{const a=e(o);return a&&(n[a]=t[o]),n},{}),s,i]}let x4=null;function dNe(){return x4||(x4=Je.fromMillis(1555555555555)),x4}function pNe(t,e){if(t.literal)return t;const s=Ro.macroTokenToFormatOpts(t.val),i=uce(s,e);return i==null||i.includes(void 0)?t:i}function oce(t,e){return Array.prototype.concat(...t.map(s=>pNe(s,e)))}class ace{constructor(e,s){if(this.locale=e,this.format=s,this.tokens=oce(Ro.parseFormat(s),e),this.units=this.tokens.map(i=>aNe(i,e)),this.disqualifyingUnit=this.units.find(i=>i.invalidReason),!this.disqualifyingUnit){const[i,r]=cNe(this.units);this.regex=RegExp(i,"i"),this.handlers=r}}explainFromTokens(e){if(this.isValid){const[s,i]=hNe(e,this.regex,this.handlers),[r,n,o]=i?mNe(i):[null,null,void 0];if(Cb(i,"a")&&Cb(i,"H"))throw new Iv("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:s,matches:i,result:r,zone:n,specificOffset:o}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function lce(t,e,s){return new ace(t,s).explainFromTokens(e)}function fNe(t,e,s){const{result:i,zone:r,specificOffset:n,invalidReason:o}=lce(t,e,s);return[i,r,n,o]}function uce(t,e){if(!t)return null;const i=Ro.create(e,t).dtFormatter(dNe()),r=i.formatToParts(),n=i.resolvedOptions();return r.map(o=>uNe(o,t,n))}const w4="Invalid DateTime",gNe=864e13;function b2(t){return new Lc("unsupported zone",`the zone "${t.name}" is not supported`)}function S4(t){return t.weekData===null&&(t.weekData=ZN(t.c)),t.weekData}function E4(t){return t.localWeekData===null&&(t.localWeekData=ZN(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function Hg(t,e){const s={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new Je({...s,...e,old:s})}function cce(t,e,s){let i=t-e*60*1e3;const r=s.offset(i);if(e===r)return[i,e];i-=(r-e)*60*1e3;const n=s.offset(i);return r===n?[i,r]:[t-Math.min(r,n)*60*1e3,Math.max(r,n)]}function eI(t,e){t+=e*60*1e3;const s=new Date(t);return{year:s.getUTCFullYear(),month:s.getUTCMonth()+1,day:s.getUTCDate(),hour:s.getUTCHours(),minute:s.getUTCMinutes(),second:s.getUTCSeconds(),millisecond:s.getUTCMilliseconds()}}function zM(t,e,s){return cce(QD(t),e,s)}function dZ(t,e){const s=t.o,i=t.c.year+Math.trunc(e.years),r=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,n={...t.c,year:i,month:r,day:Math.min(t.c.day,QN(i,r))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=Ss.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=QD(n);let[l,u]=cce(a,s,t.zone);return o!==0&&(l+=o,u=t.zone.offset(l)),{ts:l,o:u}}function h1(t,e,s,i,r,n){const{setZone:o,zone:a}=s;if(t&&Object.keys(t).length!==0||e){const l=e||a,u=Je.fromObject(t,{...s,zone:l,specificOffset:n});return o?u:u.setZone(a)}else return Je.invalid(new Lc("unparsable",`the input "${r}" can't be parsed as ${i}`))}function tI(t,e,s=!0){return t.isValid?Ro.create(Zs.create("en-US"),{allowZ:s,forceSimple:!0}).formatDateTimeFromString(t,e):null}function C4(t,e){const s=t.c.year>9999||t.c.year<0;let i="";return s&&t.c.year>=0&&(i+="+"),i+=Zr(t.c.year,s?6:4),e?(i+="-",i+=Zr(t.c.month),i+="-",i+=Zr(t.c.day)):(i+=Zr(t.c.month),i+=Zr(t.c.day)),i}function pZ(t,e,s,i,r,n){let o=Zr(t.c.hour);return e?(o+=":",o+=Zr(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!s)&&(o+=":")):o+=Zr(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!s)&&(o+=Zr(t.c.second),(t.c.millisecond!==0||!i)&&(o+=".",o+=Zr(t.c.millisecond,3))),r&&(t.isOffsetFixed&&t.offset===0&&!n?o+="Z":t.o<0?(o+="-",o+=Zr(Math.trunc(-t.o/60)),o+=":",o+=Zr(Math.trunc(-t.o%60))):(o+="+",o+=Zr(Math.trunc(t.o/60)),o+=":",o+=Zr(Math.trunc(t.o%60)))),n&&(o+="["+t.zone.ianaName+"]"),o}const hce={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},yNe={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},_Ne={ordinal:1,hour:0,minute:0,second:0,millisecond:0},mce=["year","month","day","hour","minute","second","millisecond"],vNe=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],bNe=["year","ordinal","hour","minute","second","millisecond"];function xNe(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new due(t);return e}function fZ(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return xNe(t)}}function wNe(t){return BM[t]||(UM===void 0&&(UM=wr.now()),BM[t]=t.offset(UM)),BM[t]}function gZ(t,e){const s=Sf(e.zone,wr.defaultZone);if(!s.isValid)return Je.invalid(b2(s));const i=Zs.fromObject(e);let r,n;if(Gt(t.year))r=wr.now();else{for(const l of mce)Gt(t[l])&&(t[l]=hce[l]);const o=Oue(t)||Lue(t);if(o)return Je.invalid(o);const a=wNe(s);[r,n]=zM(t,a,s)}return new Je({ts:r,zone:s,loc:i,o:n})}function yZ(t,e,s){const i=Gt(s.round)?!0:s.round,r=(o,a)=>(o=l7(o,i||s.calendary?0:2,!0),e.loc.clone(s).relFormatter(s).format(o,a)),n=o=>s.calendary?e.hasSame(t,o)?0:e.startOf(o).diff(t.startOf(o),o).get(o):e.diff(t,o).get(o);if(s.unit)return r(n(s.unit),s.unit);for(const o of s.units){const a=n(o);if(Math.abs(a)>=1)return r(a,o)}return r(t>e?-0:0,s.units[s.units.length-1])}function _Z(t){let e={},s;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],s=Array.from(t).slice(0,t.length-1)):s=Array.from(t),[e,s]}let UM,BM={};class Je{constructor(e){const s=e.zone||wr.defaultZone;let i=e.invalid||(Number.isNaN(e.ts)?new Lc("invalid input"):null)||(s.isValid?null:b2(s));this.ts=Gt(e.ts)?wr.now():e.ts;let r=null,n=null;if(!i)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(s))[r,n]=[e.old.c,e.old.o];else{const a=qf(e.o)&&!e.old?e.o:s.offset(this.ts);r=eI(this.ts,a),i=Number.isNaN(r.year)?new Lc("invalid input"):null,r=i?null:r,n=i?null:a}this._zone=s,this.loc=e.loc||Zs.create(),this.invalid=i,this.weekData=null,this.localWeekData=null,this.c=r,this.o=n,this.isLuxonDateTime=!0}static now(){return new Je({})}static local(){const[e,s]=_Z(arguments),[i,r,n,o,a,l,u]=s;return gZ({year:i,month:r,day:n,hour:o,minute:a,second:l,millisecond:u},e)}static utc(){const[e,s]=_Z(arguments),[i,r,n,o,a,l,u]=s;return e.zone=en.utcInstance,gZ({year:i,month:r,day:n,hour:o,minute:a,second:l,millisecond:u},e)}static fromJSDate(e,s={}){const i=QMe(e)?e.valueOf():NaN;if(Number.isNaN(i))return Je.invalid("invalid input");const r=Sf(s.zone,wr.defaultZone);return r.isValid?new Je({ts:i,zone:r,loc:Zs.fromObject(s)}):Je.invalid(b2(r))}static fromMillis(e,s={}){if(qf(e))return e<-864e13||e>gNe?Je.invalid("Timestamp out of range"):new Je({ts:e,zone:Sf(s.zone,wr.defaultZone),loc:Zs.fromObject(s)});throw new Ao(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,s={}){if(qf(e))return new Je({ts:e*1e3,zone:Sf(s.zone,wr.defaultZone),loc:Zs.fromObject(s)});throw new Ao("fromSeconds requires a numerical input")}static fromObject(e,s={}){e=e||{};const i=Sf(s.zone,wr.defaultZone);if(!i.isValid)return Je.invalid(b2(i));const r=Zs.fromObject(s),n=JN(e,fZ),{minDaysInFirstWeek:o,startOfWeek:a}=iZ(n,r),l=wr.now(),u=Gt(s.specificOffset)?i.offset(l):s.specificOffset,c=!Gt(n.ordinal),h=!Gt(n.year),m=!Gt(n.month)||!Gt(n.day),f=h||m,g=n.weekYear||n.weekNumber;if((f||c)&&g)throw new Iv("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(m&&c)throw new Iv("Can't mix ordinal dates with month/day");const v=g||n.weekday&&!f;let b,w,S=eI(l,u);v?(b=vNe,w=yNe,S=ZN(S,o,a)):c?(b=bNe,w=_Ne,S=b4(S)):(b=mce,w=hce);let T=!1;for(const O of b){const z=n[O];Gt(z)?T?n[O]=w[O]:n[O]=S[O]:T=!0}const P=v?XMe(n,o,a):c?WMe(n):Oue(n),I=P||Lue(n);if(I)return Je.invalid(I);const A=v?tZ(n,o,a):c?sZ(n):n,[D,k]=zM(A,u,i),R=new Je({ts:D,zone:i,o:k,loc:r});return n.weekday&&f&&e.weekday!==R.weekday?Je.invalid("mismatched weekday",`you can't specify both a weekday of ${n.weekday} and a date of ${R.toISO()}`):R.isValid?R:Je.invalid(R.invalid)}static fromISO(e,s={}){const[i,r]=qAe(e);return h1(i,r,s,"ISO 8601",e)}static fromRFC2822(e,s={}){const[i,r]=GAe(e);return h1(i,r,s,"RFC 2822",e)}static fromHTTP(e,s={}){const[i,r]=zAe(e);return h1(i,r,s,"HTTP",s)}static fromFormat(e,s,i={}){if(Gt(e)||Gt(s))throw new Ao("fromFormat requires an input string and a format");const{locale:r=null,numberingSystem:n=null}=i,o=Zs.fromOpts({locale:r,numberingSystem:n,defaultToEN:!0}),[a,l,u,c]=fNe(o,e,s);return c?Je.invalid(c):h1(a,l,i,`format ${s}`,e,u)}static fromString(e,s,i={}){return Je.fromFormat(e,s,i)}static fromSQL(e,s={}){const[i,r]=WAe(e);return h1(i,r,s,"SQL",e)}static invalid(e,s=null){if(!e)throw new Ao("need to specify a reason the DateTime is invalid");const i=e instanceof Lc?e:new Lc(e,s);if(wr.throwOnInvalid)throw new xMe(i);return new Je({invalid:i})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,s={}){const i=uce(e,Zs.fromObject(s));return i?i.map(r=>r?r.val:null).join(""):null}static expandFormat(e,s={}){return oce(Ro.parseFormat(e),Zs.fromObject(s)).map(r=>r.val).join("")}static resetCache(){UM=void 0,BM={}}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?S4(this).weekYear:NaN}get weekNumber(){return this.isValid?S4(this).weekNumber:NaN}get weekday(){return this.isValid?S4(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?E4(this).weekday:NaN}get localWeekNumber(){return this.isValid?E4(this).weekNumber:NaN}get localWeekYear(){return this.isValid?E4(this).weekYear:NaN}get ordinal(){return this.isValid?b4(this.c).ordinal:NaN}get monthShort(){return this.isValid?JT.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?JT.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?JT.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?JT.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,s=6e4,i=QD(this.c),r=this.zone.offset(i-e),n=this.zone.offset(i+e),o=this.zone.offset(i-r*s),a=this.zone.offset(i-n*s);if(o===a)return[this];const l=i-o*s,u=i-a*s,c=eI(l,o),h=eI(u,a);return c.hour===h.hour&&c.minute===h.minute&&c.second===h.second&&c.millisecond===h.millisecond?[Hg(this,{ts:l}),Hg(this,{ts:u})]:[this]}get isInLeapYear(){return UC(this.year)}get daysInMonth(){return QN(this.year,this.month)}get daysInYear(){return this.isValid?Hv(this.year):NaN}get weeksInWeekYear(){return this.isValid?DE(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?DE(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:s,numberingSystem:i,calendar:r}=Ro.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:s,numberingSystem:i,outputCalendar:r}}toUTC(e=0,s={}){return this.setZone(en.instance(e),s)}toLocal(){return this.setZone(wr.defaultZone)}setZone(e,{keepLocalTime:s=!1,keepCalendarTime:i=!1}={}){if(e=Sf(e,wr.defaultZone),e.equals(this.zone))return this;if(e.isValid){let r=this.ts;if(s||i){const n=e.offset(this.ts),o=this.toObject();[r]=zM(o,n,e)}return Hg(this,{ts:r,zone:e})}else return Je.invalid(b2(e))}reconfigure({locale:e,numberingSystem:s,outputCalendar:i}={}){const r=this.loc.clone({locale:e,numberingSystem:s,outputCalendar:i});return Hg(this,{loc:r})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const s=JN(e,fZ),{minDaysInFirstWeek:i,startOfWeek:r}=iZ(s,this.loc),n=!Gt(s.weekYear)||!Gt(s.weekNumber)||!Gt(s.weekday),o=!Gt(s.ordinal),a=!Gt(s.year),l=!Gt(s.month)||!Gt(s.day),u=a||l,c=s.weekYear||s.weekNumber;if((u||o)&&c)throw new Iv("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&o)throw new Iv("Can't mix ordinal dates with month/day");let h;n?h=tZ({...ZN(this.c,i,r),...s},i,r):Gt(s.ordinal)?(h={...this.toObject(),...s},Gt(s.day)&&(h.day=Math.min(QN(h.year,h.month),h.day))):h=sZ({...b4(this.c),...s});const[m,f]=zM(h,this.o,this.zone);return Hg(this,{ts:m,o:f})}plus(e){if(!this.isValid)return this;const s=Ss.fromDurationLike(e);return Hg(this,dZ(this,s))}minus(e){if(!this.isValid)return this;const s=Ss.fromDurationLike(e).negate();return Hg(this,dZ(this,s))}startOf(e,{useLocaleWeeks:s=!1}={}){if(!this.isValid)return this;const i={},r=Ss.normalizeUnit(e);switch(r){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break}if(r==="weeks")if(s){const n=this.loc.getStartOfWeek(),{weekday:o}=this;o<n&&(i.weekNumber=this.weekNumber-1),i.weekday=n}else i.weekday=1;if(r==="quarters"){const n=Math.ceil(this.month/3);i.month=(n-1)*3+1}return this.set(i)}endOf(e,s){return this.isValid?this.plus({[e]:1}).startOf(e,s).minus(1):this}toFormat(e,s={}){return this.isValid?Ro.create(this.loc.redefaultToEN(s)).formatDateTimeFromString(this,e):w4}toLocaleString(e=WN,s={}){return this.isValid?Ro.create(this.loc.clone(s),e).formatDateTime(this):w4}toLocaleParts(e={}){return this.isValid?Ro.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:s=!1,suppressMilliseconds:i=!1,includeOffset:r=!0,extendedZone:n=!1}={}){if(!this.isValid)return null;const o=e==="extended";let a=C4(this,o);return a+="T",a+=pZ(this,o,s,i,r,n),a}toISODate({format:e="extended"}={}){return this.isValid?C4(this,e==="extended"):null}toISOWeekDate(){return tI(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:s=!1,includeOffset:i=!0,includePrefix:r=!1,extendedZone:n=!1,format:o="extended"}={}){return this.isValid?(r?"T":"")+pZ(this,o==="extended",s,e,i,n):null}toRFC2822(){return tI(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return tI(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?C4(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:s=!1,includeOffsetSpace:i=!0}={}){let r="HH:mm:ss.SSS";return(s||e)&&(i&&(r+=" "),s?r+="z":e&&(r+="ZZ")),tI(this,r,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():w4}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const s={...this.c};return e.includeConfig&&(s.outputCalendar=this.outputCalendar,s.numberingSystem=this.loc.numberingSystem,s.locale=this.loc.locale),s}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,s="milliseconds",i={}){if(!this.isValid||!e.isValid)return Ss.invalid("created by diffing an invalid DateTime");const r={locale:this.locale,numberingSystem:this.numberingSystem,...i},n=JMe(s).map(Ss.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,l=o?e:this,u=sNe(a,l,n,r);return o?u.negate():u}diffNow(e="milliseconds",s={}){return this.diff(Je.now(),e,s)}until(e){return this.isValid?xr.fromDateTimes(this,e):this}hasSame(e,s,i){if(!this.isValid)return!1;const r=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(s,i)<=r&&r<=n.endOf(s,i)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const s=e.base||Je.fromObject({},{zone:this.zone}),i=e.padding?this<s?-e.padding:e.padding:0;let r=["years","months","days","hours","minutes","seconds"],n=e.unit;return Array.isArray(e.unit)&&(r=e.unit,n=void 0),yZ(s,this.plus(i),{...e,numeric:"always",units:r,unit:n})}toRelativeCalendar(e={}){return this.isValid?yZ(e.base||Je.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Je.isDateTime))throw new Ao("min requires all arguments be DateTimes");return rZ(e,s=>s.valueOf(),Math.min)}static max(...e){if(!e.every(Je.isDateTime))throw new Ao("max requires all arguments be DateTimes");return rZ(e,s=>s.valueOf(),Math.max)}static fromFormatExplain(e,s,i={}){const{locale:r=null,numberingSystem:n=null}=i,o=Zs.fromOpts({locale:r,numberingSystem:n,defaultToEN:!0});return lce(o,e,s)}static fromStringExplain(e,s,i={}){return Je.fromFormatExplain(e,s,i)}static buildFormatParser(e,s={}){const{locale:i=null,numberingSystem:r=null}=s,n=Zs.fromOpts({locale:i,numberingSystem:r,defaultToEN:!0});return new ace(n,e)}static fromFormatParser(e,s,i={}){if(Gt(e)||Gt(s))throw new Ao("fromFormatParser requires an input string and a format parser");const{locale:r=null,numberingSystem:n=null}=i,o=Zs.fromOpts({locale:r,numberingSystem:n,defaultToEN:!0});if(!o.equals(s.locale))throw new Ao(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${s.locale}`);const{result:a,zone:l,specificOffset:u,invalidReason:c}=s.explainFromTokens(e);return c?Je.invalid(c):h1(a,l,i,`format ${s.format}`,e,u)}static get DATE_SHORT(){return WN}static get DATE_MED(){return pue}static get DATE_MED_WITH_WEEKDAY(){return EMe}static get DATE_FULL(){return fue}static get DATE_HUGE(){return gue}static get TIME_SIMPLE(){return yue}static get TIME_WITH_SECONDS(){return _ue}static get TIME_WITH_SHORT_OFFSET(){return vue}static get TIME_WITH_LONG_OFFSET(){return bue}static get TIME_24_SIMPLE(){return xue}static get TIME_24_WITH_SECONDS(){return wue}static get TIME_24_WITH_SHORT_OFFSET(){return Sue}static get TIME_24_WITH_LONG_OFFSET(){return Eue}static get DATETIME_SHORT(){return Cue}static get DATETIME_SHORT_WITH_SECONDS(){return Pue}static get DATETIME_MED(){return Tue}static get DATETIME_MED_WITH_SECONDS(){return Iue}static get DATETIME_MED_WITH_WEEKDAY(){return CMe}static get DATETIME_FULL(){return Mue}static get DATETIME_FULL_WITH_SECONDS(){return Aue}static get DATETIME_HUGE(){return Nue}static get DATETIME_HUGE_WITH_SECONDS(){return Due}}function kw(t){if(Je.isDateTime(t))return t;if(t&&t.valueOf&&qf(t.valueOf()))return Je.fromJSDate(t);if(t&&typeof t=="object")return Je.fromObject(t);throw new Ao(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const SNe="shortOffset";function ENe(t){return"timeZoneIANA"in t}function CNe(t){return t.startsWith("UTC")}function $E(t,e=!1){return{json:{read:{source:t,reader:(s,i)=>i[t]?jM(i[t]):null},write:!!e&&{allowNull:!0,writer(s,i){i[t]=s?PNe(s):null}}}}}function jM(t,e=Gu){return t?ENe(t)?t.timeZoneIANA:TNe(t,e):e}function PNe(t){return{timeZoneIANA:t}}function TNe(t,e=Gu){if(!t||!UW.has(t.timeZone))return e;const s=UW.get(t.timeZone);return CNe(t.timeZone)||t.respectsDaylightSaving?s:INe(s)}function INe(t){const e=Je.local().setZone(t),s=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return s===0?"Etc/UTC":`Etc/GMT${en.instance(-s).formatOffset(0,"narrow")}`}function dce(t,e,s,i,r){if(e&&r==="date")return{timeZone:Zh,timeZoneName:void 0};const n=i.timeStyle||i.hour,o=s===X_;return{timeZone:o?r==="timestamp-offset"?void 0:t??Zh:s,timeZoneName:o&&n?SNe:void 0}}function MNe(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),s=new Set(Intl.supportedValuesOf("timeZone").map(i=>i.toLowerCase()));return t===Gu||t===X_||e.has(t.toLowerCase())||s.has(t.toLowerCase())}const ANe={year:void 0,month:void 0,day:void 0,weekday:void 0},NNe={hour:void 0,minute:void 0,second:void 0},pce={timeZone:Zh},uh={year:"numeric",month:"numeric",day:"numeric"},Fw={year:"numeric",month:"long",day:"numeric"},Ow={year:"numeric",month:"short",day:"numeric"},Lw={year:"numeric",month:"long",weekday:"long",day:"numeric"},mf={hour:"numeric",minute:"numeric"},ly={...mf,second:"numeric"},fce={hourCycle:"h23"},Vw={...mf,...fce},qw={...ly,...fce},gce={"short-date":uh,"short-date-short-time":{...uh,...mf},"short-date-short-time-24":{...uh,...Vw},"short-date-long-time":{...uh,...ly},"short-date-long-time-24":{...uh,...qw},"short-date-le":uh,"short-date-le-short-time":{...uh,...mf},"short-date-le-short-time-24":{...uh,...Vw},"short-date-le-long-time":{...uh,...ly},"short-date-le-long-time-24":{...uh,...qw},"long-month-day-year":Fw,"long-month-day-year-short-time":{...Fw,...mf},"long-month-day-year-short-time-24":{...Fw,...Vw},"long-month-day-year-long-time":{...Fw,...ly},"long-month-day-year-long-time-24":{...Fw,...qw},"day-short-month-year":Ow,"day-short-month-year-short-time":{...Ow,...mf},"day-short-month-year-short-time-24":{...Ow,...Vw},"day-short-month-year-long-time":{...Ow,...ly},"day-short-month-year-long-time-24":{...Ow,...qw},"long-date":Lw,"long-date-short-time":{...Lw,...mf},"long-date-short-time-24":{...Lw,...Vw},"long-date-long-time":{...Lw,...ly},"long-date-long-time-24":{...Lw,...qw},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":mf,"long-time":ly},DNe=Xn()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),yce={ar:"ar-u-nu-latn-ca-gregory"};let k5=new WeakMap;const e$=gce["short-date-short-time"];function $Ne(t){let e=k5.get(t);if(!e){const s=Lo(),i=yce[s]||s,r=m7(t.timeZone??Gu),n={...t,timeZone:r};e=new Intl.DateTimeFormat(i,n),k5.set(t,e)}return e}function L1(t){return gce[t]}function ql(t,e=e$){return $Ne(e).format(t)}function RNe(t,e=e$){return ql(new Date(t),{...e,...pce,...NNe})}function kNe(t,e=e$){return ql(new Date(`1970-01-01T${t}Z`),{...e,...pce,...ANe})}function FNe(t,e=e$){if(e.timeZone)return ql(new Date(t),e);const s=Je.fromISO(t,{setZone:!0}),i=Lo(),r=yce[i]??i,n=s.offset===0?Zh:e.timeZone,o={...e,timeZone:n};return s.toLocaleString(o,{locale:r})}function m7(t){switch(t){case Gu:return bMe;case X_:return Zh;default:return t}}i7(()=>{k5=new WeakMap});const ONe={ar:"ar-u-nu-latn"};let HM=new WeakMap,_ce={};function F5(t){const e=t||_ce;if(!HM.has(e)){const s=Lo(),i=ONe[Lo()]||s;HM.set(e,new Intl.NumberFormat(i,t))}return HM.get(e)}function KN(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function Un(t,e){return Object.is(t,-0)&&(t=0),F5(e).format(t)}function lmt(t,e=Lo()){var i,r;if(!t)return null;let s=vZ.get(e);if(!s){const n=F5().formatToParts(12345.6),o=[...F5({useGrouping:!1}).format(9876543210)].reverse(),a=new Map(o.map((f,g)=>[f,g])),l=new RegExp(`[${(i=n.find(f=>f.type==="group"))==null?void 0:i.value}]`,"g"),u=new RegExp(`[${(r=n.find(f=>f.type==="decimal"))==null?void 0:r.value}]`),c=new RegExp(`[${o.join("")}]`,"g"),h=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,m=/[-\u2212\u2013\u2014\u2015]/g;s=f=>{if((f=f.trim().replaceAll(l,"").replace(u,".").replace(c,v=>String(a.get(v))).replaceAll(h,"").replaceAll(m,"-"))==="")return null;const g=Number(f);return isNaN(g)?null:g},vZ.set(e,s)}return s(t)}i7(()=>{HM=new WeakMap,_ce={}});const vZ=new Map,vce=()=>Ne.getLogger("esri.intl.substitute");function Nu(t,e,s={}){const{format:i={}}=s;return jc(t,r=>LNe(r,e,i))}function LNe(t,e,s){let i,r;const n=t.indexOf(":");if(n===-1?i=t.trim():(i=t.slice(0,n).trim(),r=t.slice(n+1).trim()),!i)return"";const o=IC(i,e);if(o==null)return"";const a=(r?s==null?void 0:s[r]:null)??(s==null?void 0:s[i]);return a?VNe(o,a):r?qNe(o,r):d7(o)}function VNe(t,e){switch(e.type){case"date":return ql(t,e.intlOptions);case"number":return Un(t,e.intlOptions);default:return vce().warn("missing format descriptor for key {key}"),d7(t)}}function qNe(t,e){switch(e.toLowerCase()){case"dateformat":return ql(t);case"numberformat":return Un(t);default:return vce().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?ql(t):/^numberformat/i.test(e)?Un(t):d7(t)}}function d7(t){switch(typeof t){case"string":return t;case"number":return Un(t);case"boolean":return""+t;default:return t instanceof Date?ql(t):""}}const bZ=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,bce={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function GNe(t){return t in bce}function xZ(t){if(GNe(t)){const e=bce[t];return e===!0?t:e}return null}const x2=[],Xv=new Map;function wZ(t){for(const e of Xv.keys())Sce(t.pattern,e)&&Xv.delete(e)}function zNe(t){return x2.includes(t)||(wZ(t),x2.unshift(t)),xs(()=>{const e=x2.indexOf(t);e>-1&&(x2.splice(e,1),wZ(t))})}async function xce(t){const e=Lo();Xv.has(t)||Xv.set(t,UNe(t,e));const s=Xv.get(t);return s&&await BNe.add(s),s}function wce(t){if(!bZ.test(t))return null;const e=bZ.exec(t);if(e===null)return null;const[,s,i]=e;return xZ(s+(i?"-"+i.toUpperCase():""))??xZ(s)}async function UNe(t,e){const s=[];for(const i of x2)if(Sce(i.pattern,t))try{return await i.fetchMessageBundle(t,e)}catch(r){s.push(r)}throw s.length?new ae("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:s}):new ae("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function Sce(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}i7(()=>{Xv.clear()});const BNe=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=Xl())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function jNe(t,e,s,i){const r=e.exec(s);if(!r)throw new ae("esri-intl:invalid-bundle",`Bundle id "${s}" is not compatible with the pattern "${e}"`);const n=r[1]?`${r[1]}/`:"",o=r[2],a=wce(i),l=`${n}${o}.json`,u=a?`${n}${o}_${a}.json`:l;let c;try{c=await SZ(t(u))}catch(h){if(u===l)throw new ae("intl:unknown-bundle",`Bundle "${s}" cannot be loaded`,{error:h});try{c=await SZ(t(l))}catch(m){throw new ae("intl:unknown-bundle",`Bundle "${s}" cannot be loaded`,{error:m})}}return c}async function SZ(t){if(EZ.fetchBundleAsset!=null)return EZ.fetchBundleAsset(t);const e=await js(t,{responseType:"text"});return JSON.parse(e.data)}let HNe=class{constructor({base:e="",pattern:s,location:i=new URL(window.location.href)}){let r;r=typeof i=="string"?n=>new URL(n,new URL(i,window.location.href)).href:i instanceof URL?n=>new URL(n,i).href:i,this.pattern=typeof s=="string"?new RegExp(`^${s}`):s,this.getAssetUrl=r,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,s){return jNe(this.getAssetUrl,this.matcher,e,s)}};function YNe(t){return new HNe(t)}const EZ={};zNe(YNe({pattern:"esri/",location:Ii}));const CZ={};function XNe(t){var s;const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:((s=t.packages)==null?void 0:s.slice())||[],paths:{...CZ.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=CZ.baseUrl),e}let WNe=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(s=>{this[s]=(...i)=>e[s](...i)})}},YM=class{constructor(){this._dispatcher=new WNe,this._workerPostMessage({type:qn.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){IN(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,s,i){this._dispatcher.addEventListener(e,s,i)}removeEventListener(e,s,i){this._dispatcher.removeEventListener(e,s,i)}_workerPostMessage(e){IN(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const s=NE(e);if(s&&s.type===qn.OPEN){const{modulePath:i,jobId:r}=s;let n=await Jf.loadWorker(i);n||(n=await import(i));const o=Jf.connect(n);this._workerPostMessage({type:qn.OPENED,jobId:r,data:o})}}};const O5=()=>Ne.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:ZNe}=qn,QNe='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})})).finally((()=>{t&&t.removeEventListener("abort",s)}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let sI,iI;const PZ="Failed to create Worker. Fallback to execute module in main thread";async function JNe(){if(!ge("esri-workers"))return TZ(new YM);if(!sI&&!iI)try{const e=QNe.split("{CONFIGURATION}").join(KNe());sI=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){iI=e||{}}let t;if(sI)try{t=new Worker(sI,{name:"esri-worker-"+e3e++})}catch{O5().warn(PZ,iI),t=new YM}else O5().warn(PZ,iI),t=new YM;return TZ(t)}async function TZ(t){return new Promise(e=>{function s(r){const n=NE(r);n&&n.type===ZNe&&(t.removeEventListener("message",s),t.removeEventListener("error",i),e(t))}function i(r){r.preventDefault(),t.removeEventListener("message",s),t.removeEventListener("error",i),O5().warn("Failed to create Worker. Fallback to execute module in main thread",r),(t=new YM).addEventListener("message",s),t.addEventListener("error",i)}t.addEventListener("message",s),t.addEventListener("error",i)})}function KNe(){let t;if(Ds.default!=null){const r={...Ds};delete r.default,t=JSON.parse(JSON.stringify(r))}else t=JSON.parse(JSON.stringify(Ds));t.assetsPath=$u(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?$u(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=Lo(),t.has={"esri-csp-restrictions":ge("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":ge("esri-2d-update-debug"),"esri-2d-log-updating":ge("esri-2d-log-updating"),"featurelayer-pbf":ge("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":ge("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":ge("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":ge("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":ge("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":ge("featurelayer-query-max-depth"),"featurelayer-query-pausing-enabled":ge("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-enabled":ge("featurelayer-snapshot-enabled"),"esri-atomics":ge("esri-atomics"),"esri-shared-array-buffer":ge("esri-shared-array-buffer"),"esri-tiles-debug":ge("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":ge("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":ge("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=$u(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=$u(t.workers.workerPath):t.workers.workerPath=$u(Ii("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=Ds.workers.loaderConfig,s=XNe({baseUrl:e==null?void 0:e.baseUrl,locale:Lo(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e==null?void 0:e.has},map:{...e==null?void 0:e.map},paths:{...e==null?void 0:e.paths},packages:(e==null?void 0:e.packages)||[]});return JSON.stringify({esriConfig:t,loaderConfig:s,kernelInfo:{buildDate:Wae,fullVersion:$z,revision:Zae}})}let e3e=0;const{ABORT:IZ,INVOKE:t3e,OPEN:s3e,OPENED:i3e,RESPONSE:Gw}=qn;let r3e=class Ece{static async create(e){const s=await JNe();return new Ece(s,e)}constructor(e,s){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=s,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",i=>{i.preventDefault(),Ne.getLogger("esri.core.workers.WorkerOwner").error(i)})}terminate(){this.worker.terminate()}async open(e,s={}){const{signal:i}=s,r=cue();return new Promise((n,o)=>{const a={resolve:n,reject:o,abortHandle:yz(i,()=>{this._outJobs.delete(r),this._post({type:IZ,jobId:r})})};this._outJobs.set(r,a),this._post({type:s3e,jobId:r,modulePath:e})})}_onMessage(e){const s=NE(e);if(s)switch(s.type){case i3e:this._onOpenedMessage(s);break;case Gw:this._onResponseMessage(s);break;case IZ:this._onAbortMessage(s);break;case t3e:this._onInvokeMessage(s)}}_onAbortMessage(e){const s=this._inJobs,i=e.jobId,r=s.get(i);r&&(r.controller&&r.controller.abort(),s.delete(i))}_onInvokeMessage(e){const{methodName:s,jobId:i,data:r,abortable:n}=e,o=n?new AbortController:null,a=this._inJobs,l=_Me[s];let u;try{if(typeof l!="function")throw new TypeError(`${s} is not a function`);u=l.call(null,r,{signal:o?o.signal:null})}catch(c){return void this._post({type:Gw,jobId:i,error:AE(c)})}sm(u)?(a.set(i,{controller:o,promise:u}),u.then(c=>{a.has(i)&&(a.delete(i),this._post({type:Gw,jobId:i},c))},c=>{a.has(i)&&(a.delete(i),c||(c={message:"Error encountered at method"+s}),Lr(c)||this._post({type:Gw,jobId:i,error:AE(c||{message:`Error encountered at method ${s}`})}))})):this._post({type:Gw,jobId:i},u)}_onOpenedMessage(e){const{jobId:s,data:i}=e,r=this._outJobs.get(s);r&&(this._outJobs.delete(s),qi(r.abortHandle),r.resolve(i))}_onResponseMessage(e){const{jobId:s,error:i,data:r}=e,n=this._outJobs.get(s);n&&(this._outJobs.delete(s),qi(n.abortHandle),i?n.reject(ae.fromJSON(JSON.parse(i))):n.resolve(r))}_post(e,s,i){return s7(this.worker,e,s,i)}};const MZ=ge("host-browser")?Math.min(navigator.hardwareConcurrency-1,ge("workers-pool-size")??8):0;let l_=ge("esri-mobile")?Math.min(MZ,3):MZ;l_||(l_=ge("safari")&&ge("mac")?7:2);let AZ=0;const XM=[];function n3e(){Pce()}async function rI(t,e){const s=new yMe,{registryTarget:i,...r}=e;return await s.open(t,r),i&&aMe(i,s),s}async function Cce(t,e={}){if(typeof t!="string")throw new ae("workers:undefined-module","modulePath is missing");let s=e.strategy||"distributed";if(ge("host-webworker")&&!ge("esri-workers")&&(s="local"),s==="local"){let i=await Jf.loadWorker(t);i||(i=await import(t)),ni(e.signal);const r=e.client||i;return rI([Jf.connect(i,e.schedule)],{...e,client:r})}if(await Pce(),ni(e.signal),s==="dedicated"){const i=AZ++%l_;return rI([await XM[i].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const i=Math.min(e.maxNumWorkers,l_);if(i<l_){const r=new Array(i);for(let n=0;n<i;++n){const o=AZ++%l_;r[n]=XM[o].open(t,e)}return rI(r,e)}}return rI(XM.map(i=>i.open(t,e)),e)}let nI=null;async function Pce(){if(nI)return nI;new AbortController;const t=[];for(let e=0;e<l_;e++){const s=r3e.create(e).then(i=>(XM[e]=i,i));t.push(s)}return nI=Promise.all(t),nI}function dg(){return[0,0,0]}function p7(t){return[t[0],t[1],t[2]]}function lx(t,e,s){return[t,e,s]}function o3e(t,e,s){return[t,e,s]}function a3e(t,e=dg()){const s=Math.min(3,t.length);for(let i=0;i<s;++i)e[i]=t[i];return e}function l3e(t,e){return new Float64Array(t,e,3)}function Tce(){return dg()}function Ice(){return lx(1,1,1)}function Mce(){return lx(1,0,0)}function Ace(){return lx(0,1,0)}function Nce(){return lx(0,0,1)}const u3e=Tce(),Dce=Ice(),c3e=Mce(),h3e=Ace(),m3e=Nce();Object.freeze(Object.defineProperty({__proto__:null,ONES:Dce,UNIT_X:c3e,UNIT_Y:h3e,UNIT_Z:m3e,ZEROS:u3e,clone:p7,create:dg,createView:l3e,freeze:o3e,fromArray:a3e,fromValues:lx,ones:Ice,unitX:Mce,unitY:Ace,unitZ:Nce,zeros:Tce},Symbol.toStringTag,{value:"Module"}));const za=Math.PI/180,d3e=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,Ep=lr.radius,ic=lr.eccentricitySquared,p3e={a1:Ep*ic,a2:Ep*ic*Ep*ic,a3:Ep*ic*ic/2,a4:Ep*ic*Ep*ic*2.5,a5:Ep*ic+Ep*ic*ic/2,a6:1-ic},f3e={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:lr.radius,f:lr.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:Wf.radius,f:Wf.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:Hh.radius,f:Hh.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:Hh.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};var fe;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",t[t.WGS84=2]="WGS84",t[t.WEB_MERCATOR=3]="WEB_MERCATOR",t[t.WGS84_ECEF=4]="WGS84_ECEF",t[t.CGCS2000=5]="CGCS2000",t[t.SPHERICAL_MARS_PCPF=6]="SPHERICAL_MARS_PCPF",t[t.GCSMARS2000=7]="GCSMARS2000",t[t.SPHERICAL_MOON_PCPF=8]="SPHERICAL_MOON_PCPF",t[t.GCSMOON2000=9]="GCSMOON2000",t[t.LON_LAT=10]="LON_LAT",t[t.PLATE_CARREE=11]="PLATE_CARREE"})(fe||(fe={}));const g3e={[fe.WGS84]:{[fe.CGCS2000]:Fi,[fe.GCSMARS2000]:null,[fe.GCSMOON2000]:null,[fe.LON_LAT]:Fi,[fe.SPHERICAL_ECEF]:XS,[fe.SPHERICAL_MARS_PCPF]:null,[fe.SPHERICAL_MOON_PCPF]:null,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:Wv,[fe.PLATE_CARREE]:Zv,[fe.WGS84]:Fi,[fe.WGS84_ECEF]:Kv},[fe.CGCS2000]:{[fe.CGCS2000]:Fi,[fe.GCSMARS2000]:null,[fe.GCSMOON2000]:null,[fe.LON_LAT]:Fi,[fe.SPHERICAL_ECEF]:XS,[fe.SPHERICAL_MARS_PCPF]:null,[fe.SPHERICAL_MOON_PCPF]:null,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:Wv,[fe.PLATE_CARREE]:Zv,[fe.WGS84]:Fi,[fe.WGS84_ECEF]:Kv},[fe.GCSMARS2000]:{[fe.CGCS2000]:null,[fe.GCSMARS2000]:Fi,[fe.GCSMOON2000]:null,[fe.LON_LAT]:Fi,[fe.SPHERICAL_ECEF]:null,[fe.SPHERICAL_MARS_PCPF]:$Z,[fe.SPHERICAL_MOON_PCPF]:null,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:null,[fe.PLATE_CARREE]:null,[fe.WGS84]:null,[fe.WGS84_ECEF]:null},[fe.GCSMOON2000]:{[fe.CGCS2000]:null,[fe.GCSMARS2000]:null,[fe.GCSMOON2000]:Fi,[fe.LON_LAT]:Fi,[fe.SPHERICAL_ECEF]:null,[fe.SPHERICAL_MARS_PCPF]:null,[fe.SPHERICAL_MOON_PCPF]:DZ,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:null,[fe.PLATE_CARREE]:null,[fe.WGS84]:null,[fe.WGS84_ECEF]:null},[fe.WEB_MERCATOR]:{[fe.CGCS2000]:YS,[fe.GCSMARS2000]:null,[fe.GCSMOON2000]:null,[fe.LON_LAT]:YS,[fe.SPHERICAL_ECEF]:_3e,[fe.SPHERICAL_MARS_PCPF]:null,[fe.SPHERICAL_MOON_PCPF]:null,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:Fi,[fe.PLATE_CARREE]:x3e,[fe.WGS84]:YS,[fe.WGS84_ECEF]:v3e},[fe.WGS84_ECEF]:{[fe.CGCS2000]:eb,[fe.GCSMARS2000]:null,[fe.GCSMOON2000]:null,[fe.LON_LAT]:eb,[fe.SPHERICAL_ECEF]:A3e,[fe.SPHERICAL_MARS_PCPF]:null,[fe.SPHERICAL_MOON_PCPF]:null,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:N3e,[fe.PLATE_CARREE]:w3e,[fe.WGS84]:eb,[fe.WGS84_ECEF]:Fi},[fe.SPHERICAL_ECEF]:{[fe.CGCS2000]:Jv,[fe.GCSMARS2000]:null,[fe.GCSMOON2000]:null,[fe.LON_LAT]:Jv,[fe.SPHERICAL_ECEF]:Fi,[fe.SPHERICAL_MARS_PCPF]:null,[fe.SPHERICAL_MOON_PCPF]:null,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:T3e,[fe.PLATE_CARREE]:S3e,[fe.WGS84]:Jv,[fe.WGS84_ECEF]:I3e},[fe.SPHERICAL_MARS_PCPF]:{[fe.CGCS2000]:null,[fe.GCSMARS2000]:kZ,[fe.GCSMOON2000]:null,[fe.LON_LAT]:kZ,[fe.SPHERICAL_ECEF]:null,[fe.SPHERICAL_MARS_PCPF]:Fi,[fe.SPHERICAL_MOON_PCPF]:null,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:null,[fe.PLATE_CARREE]:null,[fe.WGS84]:null,[fe.WGS84_ECEF]:null},[fe.SPHERICAL_MOON_PCPF]:{[fe.CGCS2000]:null,[fe.GCSMARS2000]:null,[fe.GCSMOON2000]:RZ,[fe.LON_LAT]:RZ,[fe.SPHERICAL_ECEF]:null,[fe.SPHERICAL_MARS_PCPF]:null,[fe.SPHERICAL_MOON_PCPF]:Fi,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:null,[fe.PLATE_CARREE]:null,[fe.WGS84]:null,[fe.WGS84_ECEF]:null},[fe.UNKNOWN]:{[fe.CGCS2000]:null,[fe.GCSMARS2000]:null,[fe.GCSMOON2000]:null,[fe.LON_LAT]:null,[fe.SPHERICAL_ECEF]:null,[fe.SPHERICAL_MARS_PCPF]:null,[fe.SPHERICAL_MOON_PCPF]:null,[fe.UNKNOWN]:Fi,[fe.WEB_MERCATOR]:null,[fe.PLATE_CARREE]:null,[fe.WGS84]:null,[fe.WGS84_ECEF]:null},[fe.LON_LAT]:{[fe.CGCS2000]:Fi,[fe.GCSMARS2000]:Fi,[fe.GCSMOON2000]:Fi,[fe.LON_LAT]:Fi,[fe.SPHERICAL_ECEF]:XS,[fe.SPHERICAL_MARS_PCPF]:$Z,[fe.SPHERICAL_MOON_PCPF]:DZ,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:Wv,[fe.PLATE_CARREE]:Zv,[fe.WGS84]:Fi,[fe.WGS84_ECEF]:Kv},[fe.PLATE_CARREE]:{[fe.CGCS2000]:Qv,[fe.GCSMARS2000]:null,[fe.GCSMOON2000]:null,[fe.LON_LAT]:Qv,[fe.SPHERICAL_ECEF]:E3e,[fe.SPHERICAL_MARS_PCPF]:null,[fe.SPHERICAL_MOON_PCPF]:null,[fe.UNKNOWN]:null,[fe.WEB_MERCATOR]:C3e,[fe.PLATE_CARREE]:Fi,[fe.WGS84]:Qv,[fe.WGS84_ECEF]:P3e}};function $ce(t,e){var s;return(s=y3e(t,e))==null?void 0:s.projector}function y3e(t,e){if(t==null||e==null)return null;if(Sm.source.spatialReference===t&&Sm.dest.spatialReference===e)return Sm;const s=NZ(t,Sm.source),i=NZ(e,Sm.dest);return s===fe.UNKNOWN&&i===fe.UNKNOWN?on(t,e)?Sm.projector=Fi:Sm.projector=null:Sm.projector=g3e[s][i],Sm}function NZ(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=Uu(t,1)),jN(t)?e.spatialReferenceId=fe.SPHERICAL_ECEF:G_(t)?e.spatialReferenceId=fe.WGS84:Yc(t)?e.spatialReferenceId=fe.WEB_MERCATOR:CTe(t)?e.spatialReferenceId=fe.PLATE_CARREE:t.wkt===MTe.wkt?e.spatialReferenceId=fe.WGS84_ECEF:t.wkid===q_.CGCS2000?e.spatialReferenceId=fe.CGCS2000:t.wkt===Vz.wkt?e.spatialReferenceId=fe.SPHERICAL_MARS_PCPF:t.wkt===qz.wkt?e.spatialReferenceId=fe.SPHERICAL_MOON_PCPF:mle(t)?e.spatialReferenceId=fe.GCSMARS2000:dle(t)?e.spatialReferenceId=fe.GCSMOON2000:e.spatialReferenceId=fe.UNKNOWN):fe.UNKNOWN}function Fi(t,e,s,i){t!==s&&(s[i++]=t[e++],s[i++]=t[e++],s[i]=t[e])}function YS(t,e,s,i){s[i]=Tb*(t[e]/b_),s[i+1]=Tb*(Rce-2*Math.atan(Math.exp(-t[e+1]/b_))),s[i+2]=t[e+2]}function _3e(t,e,s,i){const r=t[e]/b_,n=Rce-2*Math.atan(Math.exp(-t[e+1]/b_)),o=b_+t[e+2],a=Math.cos(n)*o;s[i]=Math.cos(r)*a,s[i+1]=Math.sin(r)*a,s[i+2]=Math.sin(n)*o}function v3e(t,e,s,i){YS(t,e,s,i),Kv(s,i,s,i)}function b3e(t,e,s,i,r){const n=.4999999*Math.PI,o=Ka(Pb*t[e+1],-n,n),a=Math.sin(o);s[i++]=Pb*t[e]*r.radius,s[i++]=r.halfSemiMajorAxis*Math.log((1+a)/(1-a)),s[i]=t[e+2]}function Wv(t,e,s,i){b3e(t,e,s,i,lr)}function Zv(t,e,s,i){s[i]=t[e]*FZ,s[i+1]=t[e+1]*FZ,s[i+2]=t[e+2]}function Qv(t,e,s,i){s[i]=t[e]*OZ,s[i+1]=t[e+1]*OZ,s[i+2]=t[e+2]}function x3e(t,e,s,i){YS(t,e,s,i),Zv(s,i,s,i)}function w3e(t,e,s,i){eb(t,e,s,i),Zv(s,i,s,i)}function S3e(t,e,s,i){Jv(t,e,s,i),Zv(s,i,s,i)}function E3e(t,e,s,i){Qv(t,e,s,i),XS(s,i,s,i)}function C3e(t,e,s,i){Qv(t,e,s,i),Wv(s,i,s,i)}function P3e(t,e,s,i){Qv(t,e,s,i),Kv(s,i,s,i)}function f7(t,e,s,i,r){const n=r+t[e+2],o=Pb*t[e+1],a=Pb*t[e],l=Math.cos(o)*n;s[i]=Math.cos(a)*l,s[i+1]=Math.sin(a)*l,s[i+2]=Math.sin(o)*n}function DZ(t,e,s,i){f7(t,e,s,i,Wf.radius)}function $Z(t,e,s,i){f7(t,e,s,i,Hh.radius)}function XS(t,e,s,i){f7(t,e,s,i,lr.radius)}function g7(t,e,s,i,r){const n=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(n*n+o*o+a*a),u=WCe(a/(l===0?1:l)),c=Math.atan2(o,n);s[i++]=Tb*c,s[i++]=Tb*u,s[i]=l-r}function RZ(t,e,s,i){g7(t,e,s,i,Wf.radius)}function kZ(t,e,s,i){g7(t,e,s,i,Hh.radius)}function Jv(t,e,s,i){g7(t,e,s,i,lr.radius)}function T3e(t,e,s,i){Jv(t,e,s,i),Wv(s,i,s,i)}function I3e(t,e,s,i){Jv(t,e,s,i),Kv(s,i,s,i)}function M3e(t,e,s,i,r){const n=Pb*t[e],o=Pb*t[e+1],a=t[e+2],l=Math.sin(o),u=Math.cos(o),c=r.radius/Math.sqrt(1-r.eccentricitySquared*l*l);s[i++]=(c+a)*u*Math.cos(n),s[i++]=(c+a)*u*Math.sin(n),s[i++]=(c*(1-r.eccentricitySquared)+a)*l}function Kv(t,e,s,i){M3e(t,e,s,i,lr)}function eb(t,e,s,i){const r=p3e,n=t[e],o=t[e+1],a=t[e+2];let l,u,c,h,m,f,g,v,b,w,S,T,P,I,A,D,k,R,O,z,q;l=Math.abs(a),u=n*n+o*o,c=Math.sqrt(u),h=u+a*a,m=Math.sqrt(h),z=Math.atan2(o,n),f=a*a/h,g=u/h,I=r.a2/m,A=r.a3-r.a4/m,g>.3?(v=l/m*(1+g*(r.a1+I+f*A)/m),O=Math.asin(v),w=v*v,b=Math.sqrt(1-w)):(b=c/m*(1-f*(r.a5-I-g*A)/m),O=Math.acos(b),w=1-b*b,v=Math.sqrt(w)),S=1-lr.eccentricitySquared*w,T=lr.radius/Math.sqrt(S),P=r.a6*T,I=c-T*b,A=l-P*v,k=b*I+v*A,D=b*A-v*I,R=D/(P/S+k),O+=R,q=k+D*R/2,a<0&&(O=-O),s[i++]=Tb*z,s[i++]=Tb*O,s[i]=q}function A3e(t,e,s,i){eb(t,e,s,i),XS(s,i,s,i)}function N3e(t,e,s,i){eb(t,e,s,i),Wv(s,i,s,i)}const Sm={source:{spatialReference:null,spatialReferenceId:fe.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:fe.UNKNOWN,metersPerUnit:1},projector:Fi},Pb=FD(1),Tb=Pae(1),Rce=.5*Math.PI,b_=lr.radius,FZ=b_*Math.PI/180,OZ=180/(b_*Math.PI);function HC(t,e,s,i,r,n,o=Math.floor(t.length/3)){const a=$ce(e,r);if(a==null)return!1;if(a===Fi){if(t===i&&s===n)return!0;const u=s+3*o;for(let c=s,h=n;c<u;c++,h++)i[h]=t[c];return!0}const l=s+3*o;for(let u=s,c=n;u<l;u+=3,c+=3)a(t,u,i,c);return!0}const mmt=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:HC},Symbol.toStringTag,{value:"Module"}));function LZ(t,e,s,i,r,n){return oI[0]=t,oI[1]=e,oI[2]=s,HC(oI,i,0,r,n,0)}const oI=dg();let aI=0,P4=class L5{static fromGE(e){const s=new L5;return s._wkt=e.wkt,s._wkid=e.wkid,s._isInverse=e.isInverse,s}constructor(e){this.uid=aI++,e?(this._wkt=e.wkt!=null?e.wkt:null,this._wkid=e.wkid!=null?e.wkid:-1,this._isInverse=e.isInverse!=null&&e.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(e){this._wkt=e,this.uid=aI++}get wkid(){return this._wkid}set wkid(e){this._wkid=e,this.uid=aI++}get isInverse(){return this._isInverse}set isInverse(e){this._isInverse=e,this.uid=aI++}getInverse(){const e=new L5;return e._wkt=this.wkt,e._wkid=this._wkid,e._isInverse=!this.isInverse,e}},e3=class w2{static cacheKey(e,s){var i,r,n,o,a,l;return[((i=e.wkid)==null?void 0:i.toString())??"-1",((r=e.wkt)==null?void 0:r.toString())??"",((n=e.wkt2)==null?void 0:n.toString())??"",((o=s.wkid)==null?void 0:o.toString())??"-1",((a=s.wkt)==null?void 0:a.toString())??"",((l=s.wkt2)==null?void 0:l.toString())??""].join()}static fromGE(e){const s=new w2;let i="";for(const r of e.steps){const n=P4.fromGE(r);s.steps.push(n),i+=n.uid.toString()+","}return s._cachedProjection={},s._gtlistentry=null,s._chain=i,s}constructor(e){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,e==null?void 0:e.steps)for(const s of e.steps)s instanceof P4?this.steps.push(s):this.steps.push(new P4({wkid:s.wkid,wkt:s.wkt,isInverse:s.isInverse}))}getInverse(){const e=new w2;e.steps=[];for(let s=this.steps.length-1;s>=0;s--){const i=this.steps[s];e.steps.push(i.getInverse())}return e}getGTListEntry(){let e="";for(const s of this.steps)e+=s.uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=e),this._gtlistentry}assignCachedGe(e,s,i){this._cachedProjection[w2.cacheKey(e,s)]=i}getCachedGeTransformation(e,s){let i="";for(const n of this.steps)i+=n.uid.toString()+",";i!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=i);const r=this._cachedProjection[w2.cacheKey(e,s)];return r===void 0?null:r}};function kce(t,e,s){if(e==null||s==null||s.vcsWkid||on(e,s)||Qf(e)||Qf(s))return null;const i=bb(e)/bb(s);if(i===1)return null;switch(t){case"point":case"esriGeometryPoint":return r=>D3e(r,i);case"polyline":case"esriGeometryPolyline":return r=>R3e(r,i);case"polygon":case"esriGeometryPolygon":return r=>$3e(r,i);case"multipoint":case"esriGeometryMultipoint":return r=>k3e(r,i);case"extent":case"esriGeometryEnvelope":return r=>F3e(r,i);default:return null}}function D3e(t,e){(t==null?void 0:t.z)!=null&&(t.z*=e)}function $3e(t,e){if(t)for(const s of t.rings)for(const i of s)i.length>2&&(i[2]*=e)}function R3e(t,e){if(t)for(const s of t.paths)for(const i of s)i.length>2&&(i[2]*=e)}function k3e(t,e){if(t)for(const s of t.points)s.length>2&&(s[2]*=e)}function F3e(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let Uc=null,Kf=null,WS=null,WM={};const y7=new ix;function pg(){return!!Uc&&qD()}function Fce(){return!!pg()||(lt(y7),eg(),!1)}function Oce(t,e){return!t||!e||Qh(t,e)||Fce()}function O3e(t,e){return!Qh(t,e)&&!pg()}function eg(t){return WS==null&&(WS=Promise.all([Oz(),me(()=>import("./geometryEngineBase-B0ZyeKAX.js"),__vite__mapDeps([9,1])).then(e=>e.g),me(()=>import("./hydrated-BIne5Lpz.js"),[])])),WS.then(([,e,{hydratedAdapter:s}])=>{ni(t),Kf=s,Uc=e.default,Uc._enableProjection(ule),y7.notify()})}function Vd(t,e,s=null,i=null){return Array.isArray(t)?t.length===0?[]:(XTe(t),V5(Kf,t,t[0].spatialReference,e,s,i)):(xb(t),V5(Kf,[t],t.spatialReference,e,s,i)[0])}function V5(t,e,s,i,r=null,n=null){if(s==null||i==null)return e;if(Qh(s,i,r))return e.map(o=>ZM(o,s,i));if(r==null&&jN(s))return e.map(o=>ZM(o,s,St.WGS84)).map(o=>RE(o,i));if(r==null&&jN(i))return e.map(o=>RE(o,St.WGS84)).map(o=>ZM(o,St.WGS84,i));if(r==null){const o=e3.cacheKey(s,i);WM[o]!==void 0?r=WM[o]:((r=qce(s,i,void 0))==null&&(r=new e3),WM[o]=r)}if(Uc==null||t==null)throw new t$;return n!=null?Uc._project(t,e,s,i,r,n):Uc._project(t,e,s,i,r)}function Lce(t,e){const s=Vce([t],e);return s.pending!=null?{pending:s.pending,geometry:null}:s.geometries!=null?{pending:null,geometry:s.geometries[0]}:{pending:null,geometry:null}}function Vce(t,e){if(!pg()){for(const s of t)if(s!=null&&!on(s.spatialReference,e)&&Ll(s.spatialReference)&&Ll(e)&&!Qh(s.spatialReference,e))return lt(y7),{pending:eg(),geometries:null}}return{pending:null,geometries:t.map(s=>s==null?null:on(s.spatialReference,e)?s:Ll(s.spatialReference)&&Ll(e)?RE(s,e):null)}}function qce(t,e,s=null){if(t==null||e==null)return null;if(Uc==null||Kf==null)throw new t$;const i=Uc._getTransformation(Kf,t,e,s,s==null?void 0:s.spatialReference);return i!==null?e3.fromGE(i):null}function L3e(t,e,s=null){if(Uc==null||Kf==null)throw new t$;const i=Uc._getTransformationBySuitability(Kf,t,e,s,s==null?void 0:s.spatialReference);if(i!==null){const r=[];for(const n of i)r.push(e3.fromGE(n));return r}return[]}let t$=class extends ae{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function V3e(){Uc=null,Kf=null,WS=null,WM={}}const q3e={get loadPromise(){return WS}};function RE(t,e){try{const s=Vd(t,e);if(s==null)return null;"xmin"in t&&"xmin"in s&&(s.zmin=t.zmin,s.zmax=t.zmax);const i=kce(s.type,t.spatialReference,e);return i!=null&&i(s),s}catch(s){if(!(s instanceof t$))throw s;return null}}async function G3e(t,e,s){const i=t.spatialReference;return i!=null&&e!=null&&await s$(i,e,null,s),RE(t,e)}function Qh(t,e,s){return!s&&(!!on(t,e)||Ll(t)&&Ll(e)&&!!$ce(t,e))}function z3e(t,e){if(on(t,e))return!0;if(!Ll(t)||!Ll(e))return!1;const s=G_(t)||Yc(t)||CW(t),i=G_(e)||Yc(e)||CW(e);return s&&i}async function s$(t,e,s,i){if(pg())return uW(i);if(Array.isArray(t)){for(const{source:r,dest:n,geographicTransformation:o}of t)if(r&&n&&!Qh(r,n,o))return eg(i)}else if(t&&e&&!Qh(t,e,s))return eg(i);return uW(i)}function ZM(t,e,s){return t?"x"in t?Gce(t,e,new Et,s,0):"xmin"in t?jce(t,e,new Hs,s,0):"rings"in t?Bce(t,e,new po,s,0):"paths"in t?Uce(t,e,new Vl,s,0):"points"in t?zce(t,e,new qC,s,0):null:null}function U3e(t,e,s=e.spatialReference,i=0){return s!=null&&t.spatialReference!=null&&Gce(t,t.spatialReference,e,s,i)!=null}function Gce(t,e,s,i,r){No[0]=t.x,No[1]=t.y;const n=t.z;return No[2]=n!==void 0?n:r,HC(No,e,0,No,i,0)?(s.x=No[0],s.y=No[1],s.spatialReference=i,n!==void 0||Qf(i)?(s.z=No[2],s.hasZ=!0):(s.z=void 0,s.hasZ=!1),t.m===void 0?(s.m=void 0,s.hasM=!1):(s.m=t.m,s.hasM=!0),s):null}function B3e(t,e,s=e.spatialReference,i=0){return t.spatialReference!=null&&s!=null&&zce(t,t.spatialReference,e,s,i)!=null}function zce(t,e,s,i,r){const{points:n,hasZ:o,hasM:a}=t,l=[],u=n.length,c=[];for(const m of n)c.push(m[0],m[1],o?m[2]:r);if(!HC(c,e,0,c,i,0,u))return null;const h=o||Qf(i);for(let m=0;m<u;++m){const f=3*m,g=c[f],v=c[f+1];h&&a?l.push([g,v,c[f+2],n[m][3]]):h?l.push([g,v,c[f+2]]):a?l.push([g,v,n[m][2]]):l.push([g,v])}return s.points=l,s.spatialReference=i,s.hasZ=o,s.hasM=a,s}function j3e(t,e,s=e.spatialReference,i=0){return t.spatialReference!=null&&s!=null&&Uce(t,t.spatialReference,e,s,i)!=null}function Uce(t,e,s,i,r){const{paths:n,hasZ:o,hasM:a}=t,l=[];if(!Hce(n,o??!1,a??!1,e,l,i,r))return null;const u=o||Qf(i);return s.paths=l,s.spatialReference=i,s.hasZ=u,s.hasM=a,s}function H3e(t,e,s=e.spatialReference,i=0){return t.spatialReference!=null&&s!=null&&Bce(t,t.spatialReference,e,s,i)!=null}function Bce(t,e,s,i,r){const{rings:n,hasZ:o,hasM:a}=t,l=[];if(!Hce(n,o??!1,a??!1,e,l,i,r))return null;const u=o||Qf(i);return s.rings=l,s.spatialReference=i,s.hasZ=u,s.hasM=a,s}function Y3e(t,e,s=e.spatialReference,i=0){return t.spatialReference!=null&&s!=null&&jce(t,t.spatialReference,e,s,i)!=null}function jce(t,e,s,i,r){const{xmin:n,ymin:o,xmax:a,ymax:l,hasZ:u,hasM:c}=t,h=u?t.zmin:r;if(!LZ(n,o,h,e,No,i))return null;const m=u||Qf(i);s.xmin=No[0],s.ymin=No[1],m&&(s.zmin=No[2]);const f=u?t.zmax:r;return LZ(a,l,f,e,No,i)?(s.xmax=No[0],s.ymax=No[1],m&&(s.zmax=No[2]),c&&(s.mmin=t.mmin,s.mmax=t.mmax),s.spatialReference=i,s):null}function Hce(t,e,s,i,r,n,o=0){const a=new Array;for(const c of t)for(const h of c)a.push(h[0],h[1],e?h[2]:o);if(!HC(a,i,0,a,n,0))return!1;let l=0;r.length=0;const u=e||Qf(n);for(const c of t){const h=new Array;for(const m of c)u&&s?h.push([a[l++],a[l++],a[l++],m[3]]):u?h.push([a[l++],a[l++],a[l++]]):s?(h.push([a[l++],a[l++],m[2]]),l++):(h.push([a[l++],a[l++]]),l++);r.push(h)}return!0}const No=dg(),pmt=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:Qh,getTransformation:qce,getTransformations:L3e,initializeProjection:s$,isEqualBaseGCS:z3e,isLoaded:pg,isLoadedOrLoad:Fce,isLoadedOrLoadFor:Oce,load:eg,project:Vd,projectExtent:Y3e,projectMany:V5,projectMultipoint:B3e,projectOrLoad:Lce,projectOrLoadMany:Vce,projectPoint:U3e,projectPolygon:H3e,projectPolyline:j3e,projectWithZConversion:G3e,projectWithoutEngine:ZM,requiresLoad:O3e,test:q3e,tryProjectWithZConversion:RE,unload:V3e},Symbol.toStringTag,{value:"Module"}));var q5;let fh=q5=class extends Te{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new q5({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};p([_({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],fh.prototype,"cols",void 0),p([_({type:fs,json:{write:!0}})],fh.prototype,"level",void 0),p([_({type:String,json:{write:!0}})],fh.prototype,"levelValue",void 0),p([_({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],fh.prototype,"origin",void 0),p([_({type:Number,json:{write:!0}})],fh.prototype,"resolution",void 0),p([_({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],fh.prototype,"rows",void 0),p([_({type:Number,json:{write:!0}})],fh.prototype,"scale",void 0),fh=q5=p([Q("esri.layers.support.LOD")],fh);const df=fh;let X3e=class{constructor(e,s,i,r,n=void 0){this.id=e,this.level=s,this.row=i,this.col=r,this.extent=n}};var kp;const VZ=new Jt({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let so=kp=class extends Te{static create(t={}){const{resolutionFactor:e=1,scales:s,size:i=256,spatialReference:r=St.WebMercator,numLODs:n=24}=t;if(!Ll(r)){const h=[];if(s)for(let m=0;m<s.length;m++){const f=s[m];h.push(new df({level:m,scale:f,resolution:f}))}else{let m=5e-4;for(let f=n-1;f>=0;f--)h.unshift(new df({level:f,scale:m,resolution:m})),m*=2}return new kp({dpi:96,lods:h,origin:new Et(0,0,r),size:[i,i],spatialReference:r})}const o=ya(r),a=t.origin?new Et({x:t.origin.x,y:t.origin.y,spatialReference:r}):new Et(o?{x:o.origin[0],y:o.origin[1],spatialReference:r}:{x:0,y:0,spatialReference:r}),l=96,u=1/(Uu(r)*39.37*l),c=[];if(s)for(let h=0;h<s.length;h++){const m=s[h],f=m*u;c.push(new df({level:h,scale:m,resolution:f}))}else{let h=Td(r)?512/i*5916575275917094e-7:256/i*591657527591555e-6;const m=Math.ceil(n/e);c.push(new df({level:0,scale:h,resolution:h*u}));for(let f=1;f<m;f++){const g=h/2**e,v=g*u;c.push(new df({level:f,scale:g,resolution:v})),h=g}}return new kp({dpi:l,lods:c,origin:a,size:[i,i],spatialReference:r})}constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:t,origin:e}=this;if(t&&e){const s=ya(t);return t.isWrappable&&!!s&&Math.abs(s.origin[0]-e.x)<=s.dx}return!1}readOrigin(t,e){return Et.fromJSON({spatialReference:e.spatialReference,...t})}set lods(t){let e=0,s=0;const i=[],r=this._levelToLOD={};t&&(e=-1/0,s=1/0,t.forEach(n=>{i.push(n.scale),e=n.scale>e?n.scale:e,s=n.scale<s?n.scale:s,r[n.level]=n})),this._set("scales",i),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,e){return[e.cols,e.rows]}writeSize(t,e){e.cols=t[0],e.rows=t[1]}zoomToScale(t){const e=this.scales;if(t<=0)return e[0];if(t>=e.length-1)return e[e.length-1];const s=Math.floor(t),i=s+1;return e[s]/(e[s]/e[i])**(t-s)}scaleToZoom(t){const e=this.scales,s=e.length-1;let i=0;for(;i<s;i++){const r=e[i],n=e[i+1];if(r<=t)return i;if(n===t)return i+1;if(r>t&&n<t)return i+Math.log(r/t)/Math.log(r/n)}return i}tileAt(t,e,s,i){const r=this.lodAt(t);if(!r)return null;let n,o;if(typeof e=="number")n=e,o=s;else if(on(e.spatialReference,this.spatialReference))n=e.x,o=e.y,i=s;else{const u=BD(e,this.spatialReference);if(u==null)return null;n=u.x,o=u.y,i=s}const a=r.resolution*this.size[0],l=r.resolution*this.size[1];return i||(i=new X3e(null,0,0,0,pa())),i.level=t,i.row=Math.floor((this.origin.y-o)/l+.001),i.col=Math.floor((n-this.origin.x)/a+.001),this.updateTileInfo(i),i}updateTileInfo(t,e=kp.ExtrapolateOptions.NONE){let s=this.lodAt(t.level);if(!s&&e===kp.ExtrapolateOptions.POWER_OF_TWO){const o=this.lods[this.lods.length-1];o.level<t.level&&(s=o)}if(!s)return;const i=t.level-s.level,r=s.resolution*this.size[0]/2**i,n=s.resolution*this.size[1]/2**i;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=pa()),t.extent[0]=this.origin.x+t.col*r,t.extent[1]=this.origin.y-(t.row+1)*n,t.extent[2]=t.extent[0]+r,t.extent[3]=t.extent[1]+n}upsampleTile(t){const e=this._upsampleLevels[t.level];return!(!e||e.parentLevel===-1)&&(t.level=e.parentLevel,t.row=Math.floor(t.row/e.factor+.001),t.col=Math.floor(t.col/e.factor+.001),this.updateTileInfo(t),!0)}getTileBounds(t,e){const s=this.lodAt(e.level);if(s==null)return null;const{resolution:i}=s,r=i*this.size[0],n=i*this.size[1];return t[0]=this.origin.x+e.col*r,t[1]=this.origin.y-(e.row+1)*n,t[2]=t[0]+r,t[3]=t[1]+n,t}lodAt(t){var e;return((e=this._levelToLOD)==null?void 0:e[t])??null}clone(){return kp.fromJSON(this.write({}))}getCompatibleForVTL(t){if(this.size[0]!==this.size[1]||this.size[0]===256&&t===512)return null;const e=(this.size[0]===512&&t===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===t&&e===0)return this;const s=[],i=this.lods.length-e;for(let r=0;r<i;r++){const n=r+e,{scale:o,resolution:a}=n>=0?this.lods[n]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};s.push(new df({level:r,scale:o,resolution:a}))}return new kp({size:[t,t],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:s})}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let e=null;for(let s=0;s<t.length;s++){const i=t[s];this._upsampleLevels[i.level]={parentLevel:e?e.level:-1,factor:e?e.resolution/i.resolution:0},e=i}}};p([_({type:Number,json:{write:!0}})],so.prototype,"compressionQuality",void 0),p([_({type:Number,json:{write:!0}})],so.prototype,"dpi",void 0),p([_({type:String,json:{read:VZ.read,write:VZ.write,origins:{"web-scene":{read:!1,write:!1}}}})],so.prototype,"format",void 0),p([_({readOnly:!0})],so.prototype,"isWrappable",null),p([_({type:Et,json:{write:!0}})],so.prototype,"origin",void 0),p([qe("origin")],so.prototype,"readOrigin",null),p([_({type:[df],value:null,json:{write:!0}})],so.prototype,"lods",null),p([_({readOnly:!0})],so.prototype,"scales",void 0),p([_({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],so.prototype,"size",void 0),p([qe("size",["rows","cols"])],so.prototype,"readSize",null),p([Ue("size",{cols:{type:fs},rows:{type:fs}})],so.prototype,"writeSize",null),p([_({type:St,json:{write:!0}})],so.prototype,"spatialReference",void 0),so=kp=p([Q("esri.layers.support.TileInfo")],so),function(t){var e;(e=t.ExtrapolateOptions||(t.ExtrapolateOptions={}))[e.NONE=0]="NONE",e[e.POWER_OF_TWO=1]="POWER_OF_TWO"}(so||(so={}));const W3e=so,QM={widthBreakpoint:{getValue(t){const e=t.viewSize[0],s=t.breakpoints,i=this.values;return e<=s.xsmall?i.xsmall:e<=s.small?i.small:e<=s.medium?i.medium:e<=s.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],s=t.breakpoints,i=this.values;return e<=s.xsmall?i.xsmall:e<=s.small?i.small:e<=s.medium?i.medium:e<=s.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,s=e[0],i=e[1],r=this.values;return i>=s?r.portrait:r.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},T4={xsmall:544,small:768,medium:992,large:1200};function Z3e(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function I4(t,e){return e?QM[t].valueToClassName[e].split(" "):[]}const Q3e=t=>{let e=class extends t{constructor(...s){super(...s),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=T4}initialize(){this.addHandles(Ee(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),ht))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(s){if(s!==this._get("breakpoints")){if(!Z3e(s)){const i=JSON.stringify(T4,null,2);console.warn("provided breakpoints are not valid, using defaults:"+i),s=T4}this._set("breakpoints",{...s})}}_updateClassNames(){if(!this.container)return;const s=da.acquire(),i=da.acquire();let r,n=!1;for(r in QM){const o=this[r],a=QM[r].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==a&&(n=!0,this[r]=a,I4(r,o).forEach(l=>i.push(l)),I4(r,a).forEach(l=>s.push(l)))}n&&(this._applyClassNameChanges(s,i),da.release(s),da.release(i))}_applyClassNameChanges(s,i){const r=this.container;r&&(i.forEach(n=>r.classList.remove(n)),s.forEach(n=>r.classList.add(n)))}_removeActiveClassNames(){const s=this.container;if(!s)return;let i;for(i in QM)I4(i,this[i]).forEach(r=>s.classList.remove(r))}};return p([_()],e.prototype,"breakpoints",null),p([_()],e.prototype,"orientation",void 0),p([_()],e.prototype,"widthBreakpoint",void 0),p([_()],e.prototype,"heightBreakpoint",void 0),e=p([Q("esri.views.BreakpointsOwner")],e),e};function _7(t){return typeof t=="string"?document.getElementById(t):t??null}function qZ(t,e){for(;;){const s=t.firstChild;if(!s)break;e.appendChild(s)}}let x_=class extends Ye{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,s,i={}){return this._installWatch(e,s,i,Ee)}addWhen(e,s,i={}){return this._installWatch(e,s,i,Or)}addOnCollectionChange(e,s,{initial:i=!1,final:r=!1}={}){const n=++this._handleId;return this.addHandles([Vo(e,"after-changes",this._createSyncUpdatingCallback(),Xc),Vo(e,"change",s,{onListenerAdd:i?o=>s({added:o.toArray(),removed:[]}):void 0,onListenerRemove:r?o=>s({added:[],removed:o.toArray()}):void 0})],n),xs(()=>this.removeHandles(n))}addPromise(e){if(e==null)return e;const s=++this._handleId;this.addHandles(xs(()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(lI)||this._set("updating",!1))}),s),this._pendingPromises.add(e),this._set("updating",!0);const i=()=>this.removeHandles(s);return e.then(i,i),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,s,i={},r){const n=++this._handleId;i.sync||this._installSyncUpdatingWatch(e,n);const o=r(e,s,i);return this.addHandles(o,n),xs(()=>this.removeHandles(n))}_installSyncUpdatingWatch(e,s){const i=this._createSyncUpdatingCallback(),r=Ee(e,i,{sync:!0,equals:()=>!1});return this.addHandles(r,s),r}_createSyncUpdatingCallback(){return()=>{this.removeHandles(lI),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(OC(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(lI))}),lI)}}};p([_({readOnly:!0})],x_.prototype,"updating",void 0),x_=p([Q("esri.core.support.UpdatingHandles")],x_);const lI=-42;/*!
 * @esri/arcgis-html-sanitizer - v4.1.0 - Tue Dec 03 2024 09:13:28 GMT-0500 (Eastern Standard Time)
 * Copyright (c) 2024 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var t3=function(){return t3=Object.assign||function(e){for(var s,i=1,r=arguments.length;i<r;i++){s=arguments[i];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},t3.apply(this,arguments)},G5={exports:{}},hr={},z5={exports:{}},y0={};function Yce(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function J3e(t,e,s){}function K3e(t,e,s){}var eDe=/javascript\s*\:/img;function tDe(t,e){return eDe.test(e)?"":e}y0.whiteList=Yce();y0.getDefaultWhiteList=Yce;y0.onAttr=J3e;y0.onIgnoreAttr=K3e;y0.safeAttrValue=tDe;var sDe={indexOf:function(t,e){var s,i;if(Array.prototype.indexOf)return t.indexOf(e);for(s=0,i=t.length;s<i;s++)if(t[s]===e)return s;return-1},forEach:function(t,e,s){var i,r;if(Array.prototype.forEach)return t.forEach(e,s);for(i=0,r=t.length;i<r;i++)e.call(s,t[i],i,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},zw=sDe;function iDe(t,e){t=zw.trimRight(t),t[t.length-1]!==";"&&(t+=";");var s=t.length,i=!1,r=0,n=0,o="";function a(){if(!i){var c=zw.trim(t.slice(r,n)),h=c.indexOf(":");if(h!==-1){var m=zw.trim(c.slice(0,h)),f=zw.trim(c.slice(h+1));if(m){var g=e(r,o.length,m,f,c);g&&(o+=g+"; ")}}}r=n+1}for(;n<s;n++){var l=t[n];if(l==="/"&&t[n+1]==="*"){var u=t.indexOf("*/",n+2);if(u===-1)break;n=u+1,r=n+1,i=!1}else l==="("?i=!0:l===")"?i=!1:l===";"?i||a():l===`
`&&a()}return zw.trim(o)}var rDe=iDe,uI=y0,nDe=rDe;function GZ(t){return t==null}function oDe(t){var e={};for(var s in t)e[s]=t[s];return e}function Xce(t){t=oDe(t||{}),t.whiteList=t.whiteList||uI.whiteList,t.onAttr=t.onAttr||uI.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||uI.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||uI.safeAttrValue,this.options=t}Xce.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,s=e.options,i=s.whiteList,r=s.onAttr,n=s.onIgnoreAttr,o=s.safeAttrValue,a=nDe(t,function(l,u,c,h,m){var f=i[c],g=!1;if(f===!0?g=f:typeof f=="function"?g=f(h):f instanceof RegExp&&(g=f.test(h)),g!==!0&&(g=!1),h=o(c,h),!!h){var v={position:u,sourcePosition:l,source:m,isWhite:g};if(g){var b=r(c,h,v);return GZ(b)?c+":"+h:b}else{var b=n(c,h,v);if(!GZ(b))return b}}});return a};var aDe=Xce;(function(t,e){var s=y0,i=aDe;function r(o,a){var l=new i(a);return l.process(o)}e=t.exports=r,e.FilterCSS=i;for(var n in s)e[n]=s[n]})(z5,z5.exports);var v7=z5.exports,b7={indexOf:function(t,e){var s,i;if(Array.prototype.indexOf)return t.indexOf(e);for(s=0,i=t.length;s<i;s++)if(t[s]===e)return s;return-1},forEach:function(t,e,s){var i,r;if(Array.prototype.forEach)return t.forEach(e,s);for(i=0,r=t.length;i<r;i++)e.call(s,t[i],i,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,s=e.exec(t);return s?s.index:-1}},lDe=v7.FilterCSS,uDe=v7.getDefaultWhiteList,s3=b7;function Wce(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var Zce=new lDe;function cDe(t,e,s){}function hDe(t,e,s){}function mDe(t,e,s){}function dDe(t,e,s){}function Qce(t){return t.replace(fDe,"&lt;").replace(gDe,"&gt;")}function pDe(t,e,s,i){if(s=ihe(s),e==="href"||e==="src"){if(s=s3.trim(s),s==="#")return"#";if(!(s.substr(0,7)==="http://"||s.substr(0,8)==="https://"||s.substr(0,7)==="mailto:"||s.substr(0,4)==="tel:"||s.substr(0,11)==="data:image/"||s.substr(0,6)==="ftp://"||s.substr(0,2)==="./"||s.substr(0,3)==="../"||s[0]==="#"||s[0]==="/"))return""}else if(e==="background"){if(cI.lastIndex=0,cI.test(s))return""}else if(e==="style"){if(zZ.lastIndex=0,zZ.test(s)||(UZ.lastIndex=0,UZ.test(s)&&(cI.lastIndex=0,cI.test(s))))return"";i!==!1&&(i=i||Zce,s=i.process(s))}return s=rhe(s),s}var fDe=/</g,gDe=/>/g,yDe=/"/g,_De=/&quot;/g,vDe=/&#([a-zA-Z0-9]*);?/gim,bDe=/&colon;?/gim,xDe=/&newline;?/gim,cI=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,zZ=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,UZ=/u\s*r\s*l\s*\(.*/gi;function Jce(t){return t.replace(yDe,"&quot;")}function Kce(t){return t.replace(_De,'"')}function ehe(t){return t.replace(vDe,function(s,i){return i[0]==="x"||i[0]==="X"?String.fromCharCode(parseInt(i.substr(1),16)):String.fromCharCode(parseInt(i,10))})}function the(t){return t.replace(bDe,":").replace(xDe," ")}function she(t){for(var e="",s=0,i=t.length;s<i;s++)e+=t.charCodeAt(s)<32?" ":t.charAt(s);return s3.trim(e)}function ihe(t){return t=Kce(t),t=ehe(t),t=the(t),t=she(t),t}function rhe(t){return t=Jce(t),t=Qce(t),t}function wDe(){return""}function SDe(t,e){typeof e!="function"&&(e=function(){});var s=!Array.isArray(t);function i(o){return s?!0:s3.indexOf(t,o)!==-1}var r=[],n=!1;return{onIgnoreTag:function(o,a,l){if(i(o))if(l.isClosing){var u="[/removed]",c=l.position+u.length;return r.push([n!==!1?n:l.position,c]),n=!1,u}else return n||(n=l.position),"[removed]";else return e(o,a,l)},remove:function(o){var a="",l=0;return s3.forEach(r,function(u){a+=o.slice(l,u[0]),l=u[1]}),a+=o.slice(l),a}}}function EDe(t){for(var e="",s=0;s<t.length;){var i=t.indexOf("<!--",s);if(i===-1){e+=t.slice(s);break}e+=t.slice(s,i);var r=t.indexOf("-->",i);if(r===-1)break;s=r+3}return e}function CDe(t){var e=t.split("");return e=e.filter(function(s){var i=s.charCodeAt(0);return i===127?!1:i<=31?i===10||i===13:!0}),e.join("")}hr.whiteList=Wce();hr.getDefaultWhiteList=Wce;hr.onTag=cDe;hr.onIgnoreTag=hDe;hr.onTagAttr=mDe;hr.onIgnoreTagAttr=dDe;hr.safeAttrValue=pDe;hr.escapeHtml=Qce;hr.escapeQuote=Jce;hr.unescapeQuote=Kce;hr.escapeHtmlEntities=ehe;hr.escapeDangerHtml5Entities=the;hr.clearNonPrintableCharacter=she;hr.friendlyAttrValue=ihe;hr.escapeAttrValue=rhe;hr.onIgnoreTagStripAll=wDe;hr.StripTagBody=SDe;hr.stripCommentTag=EDe;hr.stripBlankChar=CDe;hr.cssFilter=Zce;hr.getDefaultCSSWhiteList=uDe;var i$={},pf=b7;function PDe(t){var e=pf.spaceIndex(t),s;return e===-1?s=t.slice(1,-1):s=t.slice(1,e+1),s=pf.trim(s).toLowerCase(),s.slice(0,1)==="/"&&(s=s.slice(1)),s.slice(-1)==="/"&&(s=s.slice(0,-1)),s}function TDe(t){return t.slice(0,2)==="</"}function IDe(t,e,s){var i="",r=0,n=!1,o=!1,a=0,l=t.length,u="",c="";e:for(a=0;a<l;a++){var h=t.charAt(a);if(n===!1){if(h==="<"){n=a;continue}}else if(o===!1){if(h==="<"){i+=s(t.slice(r,a)),n=a,r=a;continue}if(h===">"){i+=s(t.slice(r,n)),c=t.slice(n,a+1),u=PDe(c),i+=e(n,i.length,u,c,TDe(c)),r=a+1,n=!1;continue}if(h==='"'||h==="'")for(var m=1,f=t.charAt(a-m);f.trim()===""||f==="=";){if(f==="="){o=h;continue e}f=t.charAt(a-++m)}}else if(h===o){o=!1;continue}}return r<t.length&&(i+=s(t.substr(r))),i}var MDe=/[^a-zA-Z0-9\\_:.-]/gim;function ADe(t,e){var s=0,i=0,r=[],n=!1,o=t.length;function a(m,f){if(m=pf.trim(m),m=m.replace(MDe,"").toLowerCase(),!(m.length<1)){var g=e(m,f||"");g&&r.push(g)}}for(var l=0;l<o;l++){var u=t.charAt(l),c,h;if(n===!1&&u==="="){n=t.slice(s,l),s=l+1,i=t.charAt(s)==='"'||t.charAt(s)==="'"?s:DDe(t,l+1);continue}if(n!==!1&&l===i){if(h=t.indexOf(u,l+1),h===-1)break;c=pf.trim(t.slice(i+1,h)),a(n,c),n=!1,l=h,s=l+1;continue}if(/\s|\n|\t/.test(u))if(t=t.replace(/\s|\n|\t/g," "),n===!1)if(h=NDe(t,l),h===-1){c=pf.trim(t.slice(s,l)),a(c),n=!1,s=l+1;continue}else{l=h-1;continue}else if(h=$De(t,l-1),h===-1){c=pf.trim(t.slice(s,l)),c=BZ(c),a(n,c),n=!1,s=l+1;continue}else continue}return s<t.length&&(n===!1?a(t.slice(s)):a(n,BZ(pf.trim(t.slice(s))))),pf.trim(r.join(" "))}function NDe(t,e){for(;e<t.length;e++){var s=t[e];if(s!==" ")return s==="="?e:-1}}function DDe(t,e){for(;e<t.length;e++){var s=t[e];if(s!==" ")return s==="'"||s==='"'?e:-1}}function $De(t,e){for(;e>0;e--){var s=t[e];if(s!==" ")return s==="="?e:-1}}function RDe(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function BZ(t){return RDe(t)?t.substr(1,t.length-2):t}i$.parseTag=IDe;i$.parseAttr=ADe;var kDe=v7.FilterCSS,Tc=hr,nhe=i$,FDe=nhe.parseTag,ODe=nhe.parseAttr,JM=b7;function hI(t){return t==null}function LDe(t){var e=JM.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=JM.trim(t.slice(e+1,-1));var s=t[t.length-1]==="/";return s&&(t=JM.trim(t.slice(0,-1))),{html:t,closing:s}}function VDe(t){var e={};for(var s in t)e[s]=t[s];return e}function qDe(t){var e={};for(var s in t)Array.isArray(t[s])?e[s.toLowerCase()]=t[s].map(function(i){return i.toLowerCase()}):e[s.toLowerCase()]=t[s];return e}function ohe(t){t=VDe(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=Tc.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=qDe(t.whiteList||t.allowList):t.whiteList=Tc.whiteList,t.onTag=t.onTag||Tc.onTag,t.onTagAttr=t.onTagAttr||Tc.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||Tc.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||Tc.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||Tc.safeAttrValue,t.escapeHtml=t.escapeHtml||Tc.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new kDe(t.css))}ohe.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,s=e.options,i=s.whiteList,r=s.onTag,n=s.onIgnoreTag,o=s.onTagAttr,a=s.onIgnoreTagAttr,l=s.safeAttrValue,u=s.escapeHtml,c=e.cssFilter;s.stripBlankChar&&(t=Tc.stripBlankChar(t)),s.allowCommentTag||(t=Tc.stripCommentTag(t));var h=!1;s.stripIgnoreTagBody&&(h=Tc.StripTagBody(s.stripIgnoreTagBody,n),n=h.onIgnoreTag);var m=FDe(t,function(f,g,v,b,w){var S={sourcePosition:f,position:g,isClosing:w,isWhite:Object.prototype.hasOwnProperty.call(i,v)},T=r(v,b,S);if(!hI(T))return T;if(S.isWhite){if(S.isClosing)return"</"+v+">";var P=LDe(b),I=i[v],A=ODe(P.html,function(D,k){var R=JM.indexOf(I,D)!==-1,O=o(v,D,k,R);return hI(O)?R?(k=l(v,D,k,c),k?D+'="'+k+'"':D):(O=a(v,D,k,R),hI(O)?void 0:O):O});return b="<"+v,A&&(b+=" "+A),P.closing&&(b+=" /"),b+=">",b}else return T=n(v,b,S),hI(T)?u(b):T},u);return h&&(m=h.remove(m)),m};var GDe=ohe;(function(t,e){var s=hr,i=i$,r=GDe;function n(a,l){var u=new r(l);return u.process(a)}e=t.exports=n,e.filterXSS=n,e.FilterXSS=r,function(){for(var a in s)e[a]=s[a];for(var l in i)e[l]=i[l]}();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(G5,G5.exports);var m1=G5.exports,zDe=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},UDe=function(){function t(e,s){var i=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=t3(t3({},m1.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(n,o,a,l){return n==="a"&&o==="href"||(n==="img"||n==="source")&&o==="src"?i.sanitizeUrl(a):m1.safeAttrValue(n,o,a,l)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var r;e&&!s?r=e:e&&s?(r=Object.create(this.arcgisFilterOptions),r.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(n){if(n==="whiteList")r.whiteList=i._extendObjectOfArrays([i.arcgisWhiteList,e.whiteList||{}]);else if(n==="css"){var o=e.css.whiteList;o!=null&&e.css instanceof Object&&Object.keys(o).forEach(function(a){return r.css.whiteList[a]=o[a]})}else r[n]=e[n]})):(r=Object.create(this.arcgisFilterOptions),r.whiteList=this.arcgisWhiteList,r.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=r,this._xssFilter=new m1.FilterXSS(r)}return t.prototype.sanitize=function(e,s){switch(s===void 0&&(s={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,s);default:return s.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,s){var i=(s??{}).isProtocolRequired,r=i===void 0?!0:i,n=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",a=/^#/.test(e),l=n&&this.allowedProtocols.indexOf(n.toLowerCase())>-1;return o||a||l?m1.escapeAttrValue(e):!n&&!r?m1.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,s,i,r){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,s,i,r):m1.safeAttrValue(e,s,i,r)},t.prototype.validate=function(e,s){s===void 0&&(s={});var i=this.sanitize(e,s);return{isValid:e===i,sanitized:i}},t.prototype.encodeHTML=function(e){var s=this;return String(e).replace(/[&<>"'\/]/g,function(i){return s._entityMap[i]})},t.prototype.encodeAttrValue=function(e){var s=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(i,r){return s.test(i)?i:"&#x".concat(Number(e.charCodeAt(r)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var s={};return e.forEach(function(i){Object.keys(i).forEach(function(r){Array.isArray(i[r])&&Array.isArray(s[r])?s[r]=s[r].concat(i[r]):s[r]=i[r]})}),s},t.prototype._iterateOverObject=function(e,s){var i=this;s===void 0&&(s={});try{var r=!1,n=void 0;if(Array.isArray(e))n=e.reduce(function(a,l){var u=i.validate(l,s);return u.isValid?a.concat([l]):(r=!0,a.concat([u.sanitized]))},[]);else if(zDe(e)){var o=Object.keys(e);n=o.reduce(function(a,l){var u=e[l],c=i.validate(u,s);return c.isValid?a[l]=u:(r=!0,a[l]=c.sanitized),a},{})}else return s.allowUndefined&&typeof e>"u"?void 0:null;return r?n:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t}();const r$=new Map;function ahe(){r$.clear()}function BDe(t){return r$.get(t)}function jDe(t,e){r$.set(t,e)}function M4(t){r$.delete(t)}function lhe(...t){const e=da.acquire();for(let i=0;i<t.length;i++){const r=t[i],n=typeof r;if(n==="string")e.push(r);else if(Array.isArray(r))e.push.apply(e,r);else if(n==="object")for(const o in r)r[o]&&e.push(o)}const s=e.join(" ");return da.release(e),s}(()=>{const t=new Map,e=new ResizeObserver(i=>{var r;ahe();for(const n of i)(r=t.get(n.target))==null||r(n)}),s=(i,r,n)=>(t.set(i,r),e.observe(i,n),xs(()=>{e.unobserve(i),t.delete(i)}));return(i,r,n)=>{let o=null;return AC([Ee(()=>typeof i=="function"?i():i,a=>{o==null||o.remove(),a&&(o=s(a,r,n))},Ga),xs(()=>o==null?void 0:o.remove())])}})();function zh(t){const e=t==null?void 0:t.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function jZ(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function HZ(t){const e="data-node-ref";this[t.getAttribute(e)]=t}const HDe=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],YDe=HDe.reduce((t,e)=>(t[e]=[],t),{}),XDe=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],uhe=new UDe({whiteList:YDe,onTagAttr:(t,e,s)=>{const i=`${e}="${s}"`;if(XDe.includes(e))return i},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function WDe(t){return t==="Enter"||t===" "}async function tb(t,e){await bz(kC(e));const s=typeof t=="function"?t():t;s&&("setFocus"in s&&typeof s.setFocus=="function"?await s.setFocus():s instanceof HTMLElement&&s.focus())}const che="http://www.w3.org/",n$=`${che}2000/svg`,hhe=`${che}1999/xlink`;let YZ=[],x7=(t,e)=>{let s={};return Object.keys(t).forEach(i=>{s[i]=t[i]}),e&&Object.keys(e).forEach(i=>{s[i]=e[i]}),s},w7=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),mhe=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},ZDe=(t,e,s)=>{if(e.vnodeSelector!==""){for(let i=s;i<t.length;i++)if(w7(t[i],e))return i}return-1},A4=(t,e,s,i)=>{let r=t[e];if(r.vnodeSelector==="")return;let n=r.properties;if(!(n&&(n.key===void 0?n.bind:n.key))){for(let o=0;o<t.length;o++)if(o!==e){let a=t[o];if(w7(a,r))throw new Error(`${s.vnodeSelector} had a ${r.vnodeSelector} child ${i==="added"?i:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},QDe=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},U5=[],B5=!1,dhe=t=>{(t.children||[]).forEach(dhe),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},XZ=()=>{B5=!1,U5.forEach(dhe),U5.length=0},WZ=t=>{U5.push(t),B5||(B5=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(XZ,{timeout:16}):setTimeout(XZ,16))},ZZ=t=>{let e=t.domNode;if(t.properties){let s=t.properties.exitAnimation;if(s)return e.style.pointerEvents="none",void s(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),WZ(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),WZ(t))},JDe=(t,e,s)=>{if(!e)return;let i=s.eventHandlerInterceptor,r=Object.keys(e),n=r.length;for(let o=0;o<n;o++){let a=r[o],l=e[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")H5(t,l,!0);else if(a==="classes"){let u=Object.keys(l),c=u.length;for(let h=0;h<c;h++){let m=u[h];l[m]&&t.classList.add(m)}}else if(a==="styles"){let u=Object.keys(l),c=u.length;for(let h=0;h<c;h++){let m=u[h],f=l[m];f&&(mhe(f),s.styleApplyer(t,m,f))}}else if(a!=="key"&&l!=null){let u=typeof l;u==="function"?(a.lastIndexOf("on",0)===0&&(i&&(l=i(a,l,t,e)),a==="oninput"&&function(){let c=l;l=function(h){c.apply(this,[h]),h.target["oninput-value"]=h.target.value}}()),t[a]=l):s.namespace===n$?a==="href"?t.setAttributeNS(hhe,a,l):t.setAttribute(a,l):u==="string"&&a!=="value"?a==="innerHTML"?t[a]=uhe.sanitize(l):j5(t)&&a in t?t[a]=l:t.setAttribute(a,l):t[a]=l}}};function j5(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let i3,KDe=(t,e,s)=>{if(e)for(let i of e)ZS(i,t,void 0,s)},phe=(t,e,s)=>{KDe(t,e.children,s),e.text&&(t.textContent=e.text),JDe(t,e.properties,s),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,s,e.vnodeSelector,e.properties,e.children])},ZS=(t,e,s,i)=>{let r,n=0,o=t.vnodeSelector,a=e.ownerDocument;if(o==="")r=t.domNode=a.createTextNode(t.text),s!==void 0?e.insertBefore(r,s):e.appendChild(r);else{for(let l=0;l<=o.length;++l){let u=o.charAt(l);if(l===o.length||u==="."||u==="#"){let c=o.charAt(n-1),h=o.slice(n,l);c==="."?r.classList.add(h):c==="#"?r.id=h:(h==="svg"&&(i=x7(i,{namespace:n$})),i.namespace!==void 0?r=t.domNode=a.createElementNS(i.namespace,h):(r=t.domNode=t.domNode||a.createElement(h),h==="input"&&t.properties&&t.properties.type!==void 0&&r.setAttribute("type",t.properties.type)),s!==void 0?e.insertBefore(r,s):r.parentNode!==e&&e.appendChild(r)),n=l+1}}phe(r,t,i)}},H5=(t,e,s)=>{e&&e.split(" ").forEach(i=>{i&&t.classList.toggle(i,s)})},e$e=(t,e,s,i)=>{if(!s)return;let r=!1,n=Object.keys(s),o=n.length;for(let a=0;a<o;a++){let l=n[a],u=s[l],c=e[l];if(l==="class")c!==u&&(H5(t,c,!1),H5(t,u,!0));else if(l==="classes"){let h=t.classList,m=Object.keys(u),f=m.length;for(let g=0;g<f;g++){let v=m[g],b=!!u[v];b!==!!c[v]&&(r=!0,b?h.add(v):h.remove(v))}}else if(l==="styles"){let h=Object.keys(u),m=h.length;for(let f=0;f<m;f++){let g=h[f],v=u[g];v!==c[g]&&(r=!0,v?(mhe(v),i.styleApplyer(t,g,v)):i.styleApplyer(t,g,""))}}else if(u||typeof c!="string"||(u=""),l!=="value"||j5(t)){if(u!==c){let h=typeof u;h==="function"&&i.eventHandlerInterceptor||(i.namespace===n$?l==="href"?t.setAttributeNS(hhe,l,u):t.setAttribute(l,u):h==="string"?l==="innerHTML"?t[l]=uhe.sanitize(u):l==="role"&&u===""?t.removeAttribute(l):j5(t)&&l in t?t[l]=u:t.setAttribute(l,u):t[l]!==u&&(t[l]=u),r=!0)}}else{let h=t[l];h!==u&&(t["oninput-value"]?h===t["oninput-value"]:u!==c)&&(t[l]=u,t["oninput-value"]=void 0),u!==c&&(r=!0)}}return r},t$e=(t,e,s,i,r)=>{if(s===i)return!1;i=i||YZ;let n,o=(s=s||YZ).length,a=i.length,l=0,u=0,c=!1;for(;u<a;){let h=l<o?s[l]:void 0,m=i[u];if(h!==void 0&&w7(h,m))c=i3(h,m,r)||c,l++;else{let f=ZDe(s,m,l+1);if(f>=0){for(n=l;n<f;n++)ZZ(s[n]),A4(s,n,t,"removed");c=i3(s[f],m,r)||c,l=f+1}else ZS(m,e,l<o?s[l].domNode:void 0,r),QDe(m),A4(i,u,t,"added")}u++}if(o>l)for(n=l;n<o;n++)ZZ(s[n]),A4(s,n,t,"removed");return c};i3=(t,e,s)=>{let i=t.domNode,r=!1;if(t===e)return!1;let n=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=i.ownerDocument.createTextNode(e.text);return i.parentNode.replaceChild(o,i),e.domNode=o,r=!0,r}e.domNode=i}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(s=x7(s,{namespace:n$})),t.text!==e.text&&(n=!0,e.text===void 0?i.removeChild(i.firstChild):i.textContent=e.text),e.domNode=i,n=t$e(e,i,t.children,e.children,s)||n,n=e$e(i,t.properties,e.properties,s)||n,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[i,s,e.vnodeSelector,e.properties,e.children]);return n&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(i,e.properties,t.properties),r};let mI=(t,e)=>({getLastRender:()=>t,update:s=>{if(t.vnodeSelector!==s.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let i=t;t=s,i3(i,s,e)},domNode:t.domNode});const s$e={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,s)=>{e.charAt(0)==="-"?t.style.setProperty(e,s):t.style[e]=s}};let S2=t=>x7(s$e,t),Af={append:(t,e,s)=>(s=S2(s),ZS(e,t,void 0,s),mI(e,s)),insertBefore:(t,e,s)=>(s=S2(s),ZS(e,t.parentNode,t,s),mI(e,s)),merge:(t,e,s)=>(s=S2(s),e.domNode=t,phe(t,e,s),mI(e,s)),replace:(t,e,s)=>(s=S2(s),ZS(e,t.parentNode,t,s),t.parentNode.removeChild(t),mI(e,s))},fhe,i$e=(t,e)=>{let s=[];for(;t&&t!==e;)s.push(t),t=t.parentNode;return s};fhe=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let r$e=(t,e)=>{let s=t;return e.forEach(i=>{s=s&&s.children?fhe(s.children,r=>r.domNode===i):void 0}),s},n$e=(t,e,s)=>{let i=function(r){s("domEvent",r);let n=e(),o=i$e(r.currentTarget,n.domNode);o.reverse();let a,l=r$e(n.getLastRender(),o);return t.scheduleRender(),l&&(a=l.properties[`on${r.type}`].apply(l.properties.bind||this,arguments)),s("domEventProcessed",r),a};return(r,n,o,a)=>i},Y5=t=>{let e,s,i=S2(t),r=i.performanceLogger,n=!0,o=!1,a=[],l=[],u=(h,m,f)=>{let g,v=()=>g;i.eventHandlerInterceptor=n$e(e,v,r),g=h(m,f(),i),a.push(g),l.push(f)},c=()=>{if(s=void 0,n){n=!1,r("renderStart",void 0);for(let h=0;h<a.length;h++){let m=l[h]();r("rendered",void 0),a[h].update(m),r("patched",void 0)}r("renderDone",void 0),n=!0}};return e={renderNow:c,scheduleRender:()=>{s||o||(s=requestAnimationFrame(c))},stop:()=>{s&&(cancelAnimationFrame(s),s=void 0),o=!0},resume:()=>{o=!1,n=!0,e.scheduleRender()},append:(h,m)=>{u(Af.append,h,m)},insertBefore:(h,m)=>{u(Af.insertBefore,h,m)},merge:(h,m)=>{u(Af.merge,h,m)},replace:(h,m)=>{u(Af.replace,h,m)},detach:h=>{for(let m=0;m<l.length;m++)if(l[m]===h)return l.splice(m,1),a.splice(m,1)[0];throw new Error("renderFunction was not found")}},e},Fp=class extends Ye{constructor(){super(...arguments),this.items=new Ge,this._watchUpdatingTracking=new x_,this._callbacks=new Map,this._projector=Y5(),this._hiddenProjector=Y5()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,s=>{for(const i of s.added){const r=()=>i.render();this._callbacks.set(i,r),this._projector.append(this.surface,r)}for(const i of s.removed){const r=this._projector.detach(this._callbacks.get(i));this.surface.removeChild(r.domNode),this._callbacks.delete(i)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const s=this._hiddenSurface,i=this._hiddenProjector;let r;const n=()=>(r=e.render(),r);i.append(s,n),i.renderNow();const o={left:0,top:0,right:0,bottom:0};if(r!=null&&r.domNode){const a=r.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(i.detach(n);s.firstChild;)s.removeChild(s.firstChild);return o}overlaps(e,s){const i=this.computeBoundingRect(e),r=this.computeBoundingRect(s);return Math.max(i.left,r.left)<=Math.min(i.right,r.right)&&Math.max(i.top,r.top)<=Math.min(i.bottom,r.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,s){const i=!!(s!=null&&s.disableDecorations);if(!this.items.some(n=>n.visible&&!(i&&n.isDecoration)))return;const r=e.getContext("2d");r.save(),r.font=this._fontString(),this.items.forEach(n=>{i&&n.isDecoration||(r.save(),n.renderCanvas(r),r.restore())}),r.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};p([_({readOnly:!0})],Fp.prototype,"surface",void 0),p([_({readOnly:!0})],Fp.prototype,"items",void 0),p([_({readOnly:!0})],Fp.prototype,"needsRender",null),p([_({readOnly:!0})],Fp.prototype,"_watchUpdatingTracking",void 0),p([_({readOnly:!0})],Fp.prototype,"updating",null),Fp=p([Q("esri.views.overlay.ViewOverlay")],Fp);const QZ=Fp,N4=[0,0];function o$e(t){const e=(t.ownerDocument||window.document).defaultView,s=t.getBoundingClientRect();return N4[0]=s.left+((e==null?void 0:e.pageXOffset)??0),N4[1]=s.top+((e==null?void 0:e.pageYOffset)??0),N4}function JZ(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function a$e(t){const e=document.createElement("div");return t.appendChild(e),e}const d1=16,Uw=750,l$e=512,u$e=2,c$e=t=>{let e=class extends t{constructor(...s){super(...s),this._freqInfo={freq:d1,time:Uw},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([Ee(()=>this.cursor,i=>{const{surface:r}=this;r&&r.setAttribute("data-cursor",i)}),Ee(()=>this.navigating,i=>{const{surface:r}=this;r&&r.setAttribute("data-navigating",i.toString())})])}initialize(){this.addHandles([Ee(()=>this.ui,(s,i)=>this._handleUIChange(s,i),ht),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){var s;this.destroyed||((s=this.ui)==null||s.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(s){const i=this._get("container"),r=_7(s);if(r||typeof s!="string"||Ne.getLogger(this).error("#container",`element with id '${s}' not found`),i===r)return;if(this._stopMeasuring(),i&&(i.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(JZ(this.root),this._set("root",null)),this.userContent&&(qZ(this.userContent,i),JZ(this.userContent),this._set("userContent",null))),!r)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);r.classList.add("esri-view");const n=document.createElement("div");n.className="esri-view-user-storage",qZ(r,n),r.appendChild(n),this._set("userContent",n);const o=document.createElement("div");o.className="esri-view-root",r.insertBefore(o,r.firstChild),this._set("root",o);const a=document.createElement("div");a.className="esri-view-surface",a.setAttribute("role","application"),a.tabIndex=0,o.appendChild(a),this._set("surface",a);const l=new QZ;o.appendChild(l.surface),this._set("overlay",l),this.addHandles(Ee(()=>l.needsRender,u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=fb({render:()=>{var c;return(c=this.overlay)==null?void 0:c.render()}}):this._overlayRenderTaskHandle=qi(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",r),this._startMeasuring()}get focused(){const s=document.activeElement===this.surface;return document.hasFocus()&&s}get size(){return[this.width,this.height]}blur(){var s;(s=this.surface)==null||s.blur()}focus(){var s;(s=this.surface)==null||s.focus()}pageToContainer(s,i,r){const n=this.position;return s-=n?n[0]:0,i-=n?n[1]:0,r?(r[0]=s,r[1]=i):r=[s,i],r}containerToPage(s,i,r){const n=this.position;return s+=n?n[0]:0,i+=n?n[1]:0,r?(r[0]=s,r[1]=i):r=[s,i],r}_handleUIChange(s,i){this.removeHandles("ui"),i&&i!==s&&i.destroy(),s&&(s.view=this,this.addHandles(Ee(()=>this.root,r=>{s.container=r?a$e(r):null},ht),"ui")),this._set("ui",s)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const s=this._freqInfo;s.freq=d1,s.time=Uw;const i=fb({prepare:o=>{const a=this._measure(),l=this._freqInfo;if(l.time+=o.deltaTime,a&&(l.freq=d1,this._get("resizing")||this._set("resizing",!0)),l.time<l.freq)return;l.time=0;const u=this._position();l.freq=u||a?d1:Math.min(Uw,l.freq*u$e),!a&&l.freq>=l$e&&(i.pause(),this._get("resizing")&&this._set("resizing",!1))}}),r=new ResizeObserver(o=>{s.freq=d1,s.time=Uw,i.resume()});this.container!=null&&r.observe(this.container);const n=xs(()=>r.disconnect());this.addHandles([RC(window,"resize",()=>{s.freq=d1,s.time=Uw,i.resume()}),n,i],"measuring"),this._measure(),this._position()}_measure(){const s=this.container,i=s?s.clientWidth:0,r=s?s.clientHeight:0;if(i===0||r===0)return this.suspended||this._set("suspended",!0),!1;const n=this.width,o=this.height;return i===n&&r===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",i),this._set("height",r),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:n,oldHeight:o,width:i,height:r}),!0)}_position(){const s=this.container,i=this.position,r=s&&o$e(s);return!!r&&(!i||r[0]!==i[0]||r[1]!==i[1])&&(this._set("position",[r[0],r[1]]),!0)}forceDOMReadyCycle(){}};return p([_()],e.prototype,"container",null),p([_({readOnly:!0})],e.prototype,"focused",null),p([_({readOnly:!0})],e.prototype,"height",void 0),p([_()],e.prototype,"messagesCommon",void 0),p([_({type:QZ})],e.prototype,"overlay",void 0),p([_({readOnly:!0})],e.prototype,"position",void 0),p([_({readOnly:!0})],e.prototype,"resizing",void 0),p([_({readOnly:!0})],e.prototype,"root",void 0),p([_({value:null,readOnly:!0})],e.prototype,"size",null),p([_({readOnly:!0})],e.prototype,"surface",void 0),p([_({readOnly:!0})],e.prototype,"suspended",void 0),p([_({nonNullable:!0})],e.prototype,"ui",void 0),p([_({readOnly:!0})],e.prototype,"userContent",void 0),p([_({readOnly:!0})],e.prototype,"width",void 0),p([_()],e.prototype,"widthBreakpoint",void 0),e=p([Q("esri.views.DOMContainer")],e),e},h$e=ge("mac")?"Meta":"Control",m$e=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),d$e=t=>m$e.has(t);let p$e=class{constructor(e,s=[]){this.eventType=e,this.keyModifiers=s}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const s=e.modifiers;for(const i of this.keyModifiers)if(!s.has(i))return!1;return!0}},Cn=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const s=this._incoming[e];for(const i of s)this._incomingEventMatches.push(i.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(s=>this._handleEvent(s)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,s,i){let r;typeof s=="function"?(i=s,r=[]):r=s||[];const n=typeof e=="string"?new p$e(e,r):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=c=>{const h=this._incoming[c.match.eventType];if(h){const m=h.indexOf(c);h.splice(m,1),o(),this._manager&&this._manager.updateDependencies()}},l=new f$e(n,i,{onPause:a,onRemove:a,onResume:c=>{const h=this._incoming[c.match.eventType];h&&!h.includes(c)&&(h.push(c),o(),this._manager&&this._manager.updateDependencies())}});let u=this._incoming[n.eventType];return u||(u=[],this._incoming[n.eventType]=u),u.push(l),o(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const s=new g$e(e,{onEmit:(i,r,n,o)=>{var a;(a=this._manager)==null||a.emit(i.eventType,r,n,o)},onRemove:i=>{var r;delete this._outgoing[i.eventType],(r=this._manager)==null||r.updateDependencies()}});return this._outgoing[e]=s,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),s}startCapturingPointer(e){var s;(s=this._manager)==null||s.setPointerCapture(e,!0)}stopCapturingPointer(e){var s;(s=this._manager)==null||s.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){var i;const s=this._incoming[e.type];if(s){for(const r of s)if(r.match.matches(e)&&((i=r.callback)==null||i.call(r,e),e.shouldStopPropagation()))break}}},f$e=class{constructor(e,s,i){this.match=e,this._callback=s,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},g$e=class{constructor(e,s){this.eventType=e,this._removed=!1,this._handler=s}emit(e,s,i){this._removed||this._handler.onEmit(this,e,s,i)}remove(){this._removed=!0,this._handler.onRemove(this)}},y$e=class extends Cn{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",s=>this._update(s.data))}_update(e){const s=e.native.pointerType==="touch"?"touch":"mouse",{x:i,y:r}=e;s===this._value&&this._x===i&&this._y===r||(this._value=s,this._x=i,this._y=r,this._onChange(s,i,r))}},_$e=class{constructor(e,s){this._observable=new ix,this._value=e,this._equalityFunction=s}get value(){return lt(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function Ib(t,e=Doe){return new _$e(t,e)}let v$e=class extends Cn{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=Ib(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},b$e=class{constructor(e,s){this._owner=s,this._properties={},this._afterDispatchHandle=null;for(const i in e){const r=e[i],n=new cae(r,void 0,void 0,2,2);this._properties[i]={pool:n,acquired:[]}}this._afterDispatchHandle=GCe(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const s=this._properties[e];for(const i of s.acquired)mW(i)||s.pool.release(i);s.pool.destroy(),s.pool=null,s.acquired=null}this._properties=null,this._owner=null}get(e){const s=this._owner._get(e),i=this._properties[e];let r=i.pool.acquire();for(i.acquired.push(r);r===s;)i.acquired.push(r),r=i.pool.acquire();return r}_release(){for(const e in this._properties){const s=this._properties[e];let i=0;for(const r of s.acquired)mW(r)?s.acquired[i++]=r:s.pool.release(r);s.acquired.length=i}}},pu=class extends Ye{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=h$e,this._latestPointerType="mouse",this._propertiesPool=new b$e({latestPointerLocation:S$e},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const s of e)this.uninstallHandlers(s);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,s,i=Gf.INTERNAL){if(this._nameToGroup[e]||s.length===0)return;const r={name:e,handlers:s.map(n=>({handler:n,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=r;for(let n=r.handlers.length-1;n>=0;n--){const o=r.handlers[n];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,l,u,c,h)=>{this._emitInputEvent(o.priorityIndex+1,a,l,u,h,c)},setPointerCapture:(a,l)=>{this._setPointerCapture(r,o,a,l)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const s=this._nameToGroup[e];s?(s.handlers.forEach(i=>{var r;i.removed=!0,(r=i.uninstallCallback)==null||r.call(i)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):Ne.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,s=new Set;this._handlersPriority=[];for(let i=this._handlers.length-1;i>=0;i--){const r=this._handlers[i];r.priorityIndex=i,this._handlersPriority.push(r)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const r=this._handlersPriority[i];r.priorityIndex=i;let n=r.handler.hasSideEffects;if(!n){for(const o of r.handler.outgoingEventTypes)if(e.has(o)){n=!0;break}}if(n)for(const o of r.handler.incomingEventMatches){e.add(o.eventType);for(const a of o.keyModifiers)d$e(a)||s.add(a)}r.active=n}this._sourceEvents=e,this._keyModifiers=s,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,s,i){this._latestPointerType=e;const r=this._get("latestPointerLocation");if(r==null||r.x!==s||r.y!==i){const n=this._propertiesPool.get("latestPointerLocation");n.x=s,n.y=i,this._set("latestPointerLocation",n)}}_onEventReceived(e,s){if(e==="pointer-capture-lost"){const n=s;this._pointerCaptures.delete(n.native.pointerId)}this._updateKeyModifiers(e,s);const i=this.test.timestamp!=null?this.test.timestamp:s.native?s.native.timestamp:void 0,r=s.native?s.native.cancelable:void 0;this._emitInputEventFromSource(e,s,i,r)}_updateKeyModifiers(e,s){if(!s)return;let i=!1;const r=()=>{i||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),i=!0)},n=(a,l)=>{l&&!this._activeKeyModifiers.has(a)?(r(),this._activeKeyModifiers.add(a)):!l&&this._activeKeyModifiers.has(a)&&(r(),this._activeKeyModifiers.delete(a))};if(e==="key-down"||e==="key-up"){const a=s.key;this._keyModifiers.has(a)&&n(a,e==="key-down")}const o=s.native;n("Alt",!!(o!=null&&o.altKey)),n("Control",!!(o!=null&&o.ctrlKey)),n("Ctrl",!!(o!=null&&o.ctrlKey)),n("Shift",!!(o!=null&&o.shiftKey)),n("Meta",!!(o!=null&&o.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new y$e((e,s,i)=>this._setLatestPointer(e,s,i)),this._multiTouchHandler=new v$e,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Gf.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Gf.INTERNAL)}_setPointerCapture(e,s,i,r){const n=e.name+"-"+s.priorityIndex,o=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,o),r?(o.add(n),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):o.has(n)&&(o.delete(n),o.size===0&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,s,i,r){this._emitInputEvent(0,e,s,i,r)}_emitInputEvent(e,s,i,r,n,o){const a=r!==void 0?r:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),l=n!==void 0&&n,u={event:new x$e(s,i,a,o||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(u):this._doNewPropagation(u)}_doNewPropagation(e){this._currentPropagation={events:new XN,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var s,i,r;this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:n,priorityIndex:o}=e.events.pop(),a=(s=n.data)==null?void 0:s.eventId;if(!(a!=null&&this._stoppedPropagationEventIds.has(a)))for(e.currentHandler=this._handlersPriority[o];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!n.shouldStopPropagation()&&((r=(i=e.currentHandler).eventCallback)==null||r.call(i,n)),n.shouldStopPropagation()){a!=null&&this._stoppedPropagationEventIds.add(a);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const s=new XN;s.push(e);const i=this._currentPropagation;if(i){for(;i.events.length;)s.push(i.events.pop());i.events=s,i.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,s){if(e.handler.hasSideEffects!==s.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==s.groupPriority)return e.groupPriority>s.groupPriority?-1:1;for(const i of e.handler.incomingEventMatches)for(const r of s.handler.incomingEventMatches){if(i.eventType!==r.eventType)continue;const n=i.keyModifiers.filter(o=>r.keyModifiers.includes(o));if(n.length===i.keyModifiers.length!=(n.length===r.keyModifiers.length))return i.keyModifiers.length>r.keyModifiers.length?-1:1}return e.priorityIndex>s.priorityIndex?-1:1}_sortHandlersPriority(e){const s=[];for(const i of e){let r=0;for(;r<s.length&&this._compareHandlerPriority(i,s[r])>=0;)r++;s.splice(r,0,i)}return s}get debug(){const e=s=>{const i=this._setPointerCapture;this._setPointerCapture=()=>{},s(),this._setPointerCapture=i};return{injectEvent:(s,i)=>{e(()=>this._onEventReceived(s,i))},disablePointerCapture:e}}};p([_({readOnly:!0})],pu.prototype,"hasPendingInputs",null),p([_({constructOnly:!0})],pu.prototype,"eventSource",void 0),p([_({constructOnly:!0})],pu.prototype,"recognizers",void 0),p([_()],pu.prototype,"_latestPointerType",void 0),p([_()],pu.prototype,"latestPointerType",null),p([_()],pu.prototype,"multiTouchActive",null),p([_({readOnly:!0})],pu.prototype,"latestPointerLocation",void 0),p([_()],pu.prototype,"_paused",void 0),p([_({readOnly:!0})],pu.prototype,"updating",null),pu=p([Q("esri.views.input.InputManager")],pu);let x$e=class{constructor(e,s,i,r,n){this.type=e,this.data=s,this.timestamp=i,this.modifiers=r,this.cancelable=n,this._propagationState=ff.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=ff.STOPPED}shouldStopPropagation(){return!!(this._propagationState&ff.STOPPED)}async(e){this._propagationState|=ff.PAUSED;const s=(i,r)=>{this._propagationState&=~ff.PAUSED;const n=this._resumeCallback;if(this._resumeCallback=null,n&&n(),r)throw i;return i};return(typeof e=="function"?e():e).then(i=>s(i,!1),i=>s(i,!0))}shouldPausePropagation(e){return!!(this._propagationState&ff.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var ff;(function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"})(ff||(ff={}));const Gf={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let w$e=class{};const S$e=w$e;function Cp(t){return t!=null&&"open"in t&&"declaredClass"in t}function KZ(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const E$e=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([Ee(()=>[this.ui,this.popup],([s,i],r)=>{const n="popup",o="manual";if(r){const[a,l]=r;a&&Cp(l)&&(l.view=null,KZ(l)&&a.remove(l,n))}s&&Cp(i)&&(i.view=this,KZ(i)&&s.add(i,{key:n,position:o,internal:!0}))},ht),this.on("click",s=>{this.popup&&this.popupEnabled&&(s.pointerType!=="mouse"||s.button===0)&&(Cp(this.popup)?this.popup.viewModel.handleViewClick(s):s.async(async()=>{await this.setupPopup(),Cp(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(s)}))},Gf.WIDGET)]),zC(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{me(()=>Promise.resolve().then(()=>tie),void 0)})}destroy(){this.destroyed||this.closePopup()}async openPopup(s){if(Cp(this.popup))return this.popup.open(s);try{if(await this.setupPopup(),!this.popup)return void Ne.getLogger(this).error(new ae("view:null-popup","Popup is null and can't be opened"));this.popup.open(s)}catch{}}closePopup(){var s;(s=this._popupSetupTask)==null||s.abort(),Cp(this.popup)&&this.popup.close()}async fetchPopupFeatures(s,i){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(s,i),i)}async setupPopup(){var s;if((s=this._popupSetupTask)==null||s.abort(),this.popup&&!Cp(this.popup))return this._popupSetupTask=Id(async i=>{const{default:r}=await me(()=>Promise.resolve().then(()=>tie),void 0);if(ni(i),!this.popup||Cp(this.popup))return;const n=this.popup;delete n.open,delete n.close,this.popup=new r(n)}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:s,hits:i},r){const n=[],o=[];let a=!1;const l=vCe(r,ge("popup-view-fetch-timeout")??P$e),u=m=>{const f=new C$e(m);return o.push(f),n.push(f.promise),f},c=m=>{const f=o.at(-1);return f&&f.layerView===m&&!a?f:u(m)};for(const m of i)"graphic"in m?(c(m.layerView).graphics.push(m.graphic),a=!1):(n.push(m.layerView.fetchPopupFeaturesAtLocation(m.mapPoint,l)),a=!0);o.map(m=>m.resolve(l));const h=_Ce(n).then(m=>m.filter(f=>!!f).flat());return{pendingFeatures:n,allGraphicsPromise:h,location:s}}async _getPopupHits(s,i){const{hits:r,location:n}=await this.popupHitTest(s);ni(i);const o=[];for(const a of r)if("graphic"in a){if(this._isValidPopupGraphic(a.graphic,i)){const l=this._isValidPopupGraphicsLayerView(a.layerView)?a.layerView:void 0;o.push({graphic:a.graphic,layerView:l})}}else this._isValidPopupLocationLayerView(a.layerView)&&o.push({mapPoint:a.mapPoint,layerView:a.layerView});return{hits:o,location:n}}_isValidPopupGraphic(s,i){return s&&!!s.getEffectivePopupTemplate(i==null?void 0:i.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(s){return!s||(!("layer"in s)||!s.suspended)&&"fetchPopupFeaturesFromGraphics"in s}_isValidPopupLocationLayerView(s){return(!("layer"in s)||!s.suspended)&&"fetchPopupFeaturesAtLocation"in s}};return p([_()],e.prototype,"popup",void 0),p([_()],e.prototype,"popupEnabled",void 0),e=p([Q("esri.views.PopupView")],e),e};let C$e=class{constructor(e){this.layerView=e,this._resolver=Xl(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:s,graphics:i,_resolver:r}=this;if(!s)return r.resolve(i),r.promise;let n;return s.fetchPopupFeaturesFromGraphics(i,e).catch(o=>(n=o,null)).then(o=>{o?r.resolve(o):r.reject(n)}),r.promise}};const P$e=5e3;function Md(t,e,s=Ge){return e||(e=new s),e===t||(e.removeAll(),T$e(t)?e.addMany(t):t&&e.add(t)),e}function ghe(t){return t}function T$e(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}var gf;(function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"})(gf||(gf={}));let I$e=class{constructor(){this._resolver=Xl(),this._status=gf.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=gf.RESOLVED,this._cleanUp()},()=>{this._status=gf.REJECTED,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===gf.RESOLVED}isRejected(){return this._status===gf.REJECTED}isFulfilled(){return this._status!==gf.PENDING}abort(){this._resolver.reject(xi())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=Xl(),s=[...this._resolvingPromises,e.promise],i=this._allPromise=Promise.all(s);i.then(()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve()},r=>{this.isFulfilled()||this._allPromise!==i||Lr(r)||this._resolver.reject(r)}),e.resolve()}};const yhe=t=>{let e=class extends t{constructor(...s){super(...s),this._promiseProps=new I$e,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(s,i){return this._promiseProps.promise.then(()=>this).then(s,i)}catch(s){return this.when(null,s)}addResolvingPromise(s){s&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in s?s.when():s)}};return e=p([Q("esri.core.Promise")],e),e};let E2=class extends yhe(Ye){};E2=p([Q("esri.core.Promise")],E2),function(t){t.EsriPromiseMixin=yhe}(E2||(E2={}));const YC=E2,M$e="not-loaded",A$e="loading",N$e="failed",eQ="loaded",_he=t=>{let e=class extends t{constructor(...s){super(...s),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(i=>{const r=this.load.bind(this);this.load=n=>{const o=new Promise((a,l)=>{const u=yz(n,l);this.destroyed&&l(new ae("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(a,l).finally(()=>{u&&u.remove()})});if(this.loadStatus===M$e){this._set("loadStatus",A$e);const a=this._loadController=new AbortController;r({signal:a.signal})}return i(),o}})),this.when(()=>{this._set("loadStatus",eQ),this._loadController=null},i=>{this._set("loadStatus",N$e),this._set("loadError",i),this._loadController=null})}destroy(){this._loadController&&(this._loadController=Do(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===eQ}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var s;return this.isFulfilled()||(this._set("loadError",new ae("load:cancelled","Cancelled")),(s=this._loadController)==null||s.abort(),this._promiseProps.abort()),this}};return p([_({readOnly:!0})],e.prototype,"loaded",null),p([_({readOnly:!0})],e.prototype,"loadError",void 0),p([_({clonable:!1})],e.prototype,"loadStatus",void 0),p([_({type:[qu],readOnly:!0})],e.prototype,"loadWarnings",null),e=p([Q("esri.core.Loadable")],e),e};let C2=class extends _he(YC){};C2=p([Q("esri.core.Loadable")],C2),function(t){function e(s){return!(!s||!s.load)}t.LoadableMixin=_he,t.isLoadable=e}(C2||(C2={}));const Jh=C2;async function vhe(t,e){return await t.load(),D$e(t,e)}async function D$e(t,e){const s=[],i=(...n)=>{for(const o of n)o!=null&&(Array.isArray(o)?i(...o):Ge.isCollection(o)?o.forEach(a=>i(a)):Jh.isLoadable(o)&&s.push(o))};e(i);let r=null;if(await eMe(s,async n=>{const o=await XD($$e(n)?n.loadAll():n.load());o.ok!==!1||r||(r=o)}),r)throw r.error;return t}function $$e(t){return"loadAll"in t&&typeof t.loadAll=="function"}let dI;function R$e(t){return dI&&!dI.destroyed||(dI=t()),dI}var X5;const k$e=new Jt({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let fu=X5=class extends Ye{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new X5({categories:this.categories?he(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let s=[];this.categories&&(s=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let i="";if(this.extent){const o=BD(this.extent,St.WGS84);o!=null&&(i=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let r=this.query;!this.disableExtraQuery&&t.extraQuery&&(r="("+r+")"+t.extraQuery);const n={categories:s,bbox:i,q:r,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(n.sortField=this.sortField.split(",").map(o=>k$e.toJSON(o.trim())).join(","),n.sortOrder=this.sortOrder),{query:{...e,...n}}}};p([_()],fu.prototype,"categories",void 0),p([_()],fu.prototype,"disableExtraQuery",void 0),p([_({type:Hs})],fu.prototype,"extent",void 0),p([_()],fu.prototype,"filter",void 0),p([_()],fu.prototype,"num",void 0),p([_()],fu.prototype,"query",void 0),p([_()],fu.prototype,"sortField",void 0),p([_()],fu.prototype,"sortOrder",null),p([_()],fu.prototype,"start",void 0),fu=X5=p([Q("esri.portal.PortalQueryParams")],fu);const Rc=fu;var W5;let Ur=W5=class extends Te{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){var s;const t=this.url,e=this.thumbnail;return t&&e&&this.portal?(s=this.portal)==null?void 0:s.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const s=e.categorySchema||[];return s.some(i=>i.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):s})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new ae("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new W5({sourceJSON:t});return e.read(t),e}queryItems(t,e){let s=nn(Rc,t);const i=this.portal;return parseFloat(i.currentVersion)>5?(s=s||new Rc,i.queryPortal(`/content/groups/${this.id}/search`,s,"PortalItem",e)):(s=s?s.clone():new Rc,s.query="group:"+this.id+(s.query?" "+s.query:""),i.queryItems(s,e))}_fetchCategorySchemaSet(t,e){const s=this.portal;return s.fetchSelf(s.authMode,!0,e).then(i=>{const r=i.contentCategorySetsGroupQuery;if(r){const n=new Rc({disableExtraQuery:!0,num:1,query:r});return s.queryGroups(n,e)}throw new ae("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(i=>{if(i.total){const r=i.results[0],n=new Rc({num:1,query:`typekeywords:"${t}"`});return r.queryItems(n,e)}throw new ae("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(i=>i.total?i.results[0].fetchData("json",e).then(r=>{const n=r==null?void 0:r.categorySchema;return n!=null&&n.length?n:[]}):[])}};p([_()],Ur.prototype,"access",void 0),p([_({type:Date})],Ur.prototype,"created",void 0),p([_()],Ur.prototype,"description",void 0),p([_()],Ur.prototype,"id",void 0),p([_()],Ur.prototype,"isInvitationOnly",void 0),p([_({type:Date})],Ur.prototype,"modified",void 0),p([_()],Ur.prototype,"owner",void 0),p([_()],Ur.prototype,"portal",void 0),p([_()],Ur.prototype,"snippet",void 0),p([_()],Ur.prototype,"sortField",void 0),p([_()],Ur.prototype,"sortOrder",void 0),p([_()],Ur.prototype,"sourceJSON",void 0),p([_()],Ur.prototype,"tags",void 0),p([_()],Ur.prototype,"thumbnail",void 0),p([_({readOnly:!0})],Ur.prototype,"thumbnailUrl",null),p([_()],Ur.prototype,"title",void 0),p([_({readOnly:!0})],Ur.prototype,"url",null),Ur=W5=p([Q("esri.portal.PortalGroup")],Ur);const Z5=Ur;let uy=class extends Ye{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};p([_()],uy.prototype,"nextQueryParams",void 0),p([_()],uy.prototype,"queryParams",void 0),p([_()],uy.prototype,"results",void 0),p([_()],uy.prototype,"total",void 0),uy=p([Q("esri.portal.PortalQueryResult")],uy);const F$e=uy;let Dm=class extends Te{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){var s;const e=(s=this.portal)==null?void 0:s.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new ae("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};p([_({type:Date})],Dm.prototype,"created",void 0),p([_()],Dm.prototype,"id",void 0),p([_()],Dm.prototype,"portal",void 0),p([_()],Dm.prototype,"title",void 0),p([_({readOnly:!0})],Dm.prototype,"url",null),p([_()],Dm.prototype,"username",void 0),Dm=p([Q("esri.portal.PortalFolder")],Dm);const O$e=Dm;var Q5;let _i=Q5=class extends Te{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?`${t}/content/users/${this.username}`:null}get url(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,s=t==null?void 0:t.data,i=t==null?void 0:t.folder,r={method:"post"};e&&(r.query=e.createPostQuery(),s!=null&&(typeof s=="string"?r.query.text=s:typeof s=="object"&&(r.query.text=JSON.stringify(s))));let n=this.userContentUrl;return i&&(n+="/"+(typeof i=="string"?i:i.id)),this.portal.request(n+"/addItem",r).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let s=this.userContentUrl;t.ownerFolder&&(s+="/"+t.ownerFolder);const i=e?{permanentDelete:!0}:{};await this.portal.request(s+`/items/${t.id}/delete`,{method:"post",query:i}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const s=this.userContentUrl+"/deleteItems",i=[],r=t.map(n=>n.id);if(r.length){const n={method:"post",query:{items:r.join(","),permanentDelete:e}},o=await this.portal.request(s,n);for(const a of o.results){const l=t.find(h=>a.itemId===h.id),u=a.success;let c=null;u?(l.id=null,l.portal=null):a.error&&(c=new ae("portal:delete-item-failed",a.error.message,a.error)),i.push({item:l,success:u,error:c})}}return i}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let s;return s=e&&e.folders?e.folders.map(i=>{const r=O$e.fromJSON(i);return r.portal=this.portal,r}):[],s})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(s=>{const i=Z5.fromJSON(s);return i.portal=this.portal,i}):[],e})}async fetchItems(t){t??(t={});let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:s}=await me(()=>Promise.resolve().then(()=>bhe),void 0),i={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},r=await this.portal.request(e,{query:i});let n;return r!=null&&r.items?(n=r.items.map(o=>{const a=s.fromJSON(o);return a.portal=this.portal,a}),await Promise.all(n.map(o=>o.load())),{items:n,nextStart:r.nextStart,total:r.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new Z5({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new ae("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const s=this.userContentUrl,i=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(s+`/items/${t.id}/restore`,{method:"post",query:i})}toJSON(){throw new ae("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new Q5({sourceJSON:t});return e.read(t),e}};p([_()],_i.prototype,"access",void 0),p([_({type:Date})],_i.prototype,"created",void 0),p([_()],_i.prototype,"culture",void 0),p([_()],_i.prototype,"description",void 0),p([_()],_i.prototype,"email",void 0),p([_()],_i.prototype,"favGroupId",void 0),p([_()],_i.prototype,"fullName",void 0),p([_({type:Date})],_i.prototype,"modified",void 0),p([_()],_i.prototype,"orgId",void 0),p([_()],_i.prototype,"portal",void 0),p([_()],_i.prototype,"preferredView",void 0),p([_()],_i.prototype,"privileges",void 0),p([_()],_i.prototype,"region",void 0),p([_()],_i.prototype,"role",void 0),p([_()],_i.prototype,"roleId",void 0),p([_()],_i.prototype,"sourceJSON",void 0),p([_()],_i.prototype,"thumbnail",void 0),p([_({readOnly:!0})],_i.prototype,"thumbnailUrl",null),p([_()],_i.prototype,"units",void 0),p([_({readOnly:!0})],_i.prototype,"userContentUrl",null),p([_({readOnly:!0})],_i.prototype,"url",null),p([_()],_i.prototype,"username",void 0),p([_()],_i.prototype,"userLicenseTypeId",void 0),p([_()],_i.prototype,"userType",void 0),_i=Q5=p([Q("esri.portal.PortalUser")],_i);const S7=_i;var bl;let Bw;const tQ={PortalGroup:()=>Promise.resolve({default:Z5}),PortalItem:()=>me(()=>Promise.resolve().then(()=>bhe),void 0),PortalUser:()=>Promise.resolve({default:S7})};let ze=bl=class extends Te.JSONSupportMixin(Jh){constructor(t){super(t),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Ds.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return typeof t=="string"?{url:t}:t}destroy(){sQ.unregister(this),this.defaultBasemap=ii(this.defaultBasemap),this.defaultDevBasemap=ii(this.defaultDevBasemap),this.defaultVectorBasemap=ii(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=qi(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)Ds.request.trustedServers.includes(e)||Ds.request.trustedServers.push(e);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){var s;const t=(s=this.user)==null?void 0:s.orgId,e=!t||this.canSearchPublic;return this.id&&!e?` AND orgid:${this.id}`:null}get hasAPIKey(){return sle(this.url)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.slice(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t&&t.toLowerCase()}readUser(t){let e=null;return t&&(e=S7.fromJSON(t),e.portal=this),e}load(t){const e=me(()=>Promise.resolve().then(()=>sRe),void 0).then(({default:s})=>{ni(t),Bw=s}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,t)).then(s=>{var i;if(!this.hasAPIKey&&Mt){const r=Mt;this.credential=r.findCredential(this.restUrl),this.credential||this.authMode!==bl.AUTH_MODE_AUTO&&this.authMode!==bl.AUTH_MODE_NO_PROMPT||((i=this._esriIdCredentialCreateHandle)==null||i.remove(),this._esriIdCredentialCreateHandle=r.on("credential-create",L$e(new WeakRef(this))),sQ.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=s,this.read(s)});return this.addResolvingPromise(e),Promise.resolve(this)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await me(async()=>{const{default:s}=await import("./ElevationLayer-BXyVyaGs.js");return{default:s}},__vite__mapDeps([142,143,144,145,146]))).default;return t?t.map(s=>new e({id:s.id,url:s.url})):[]}async fetchBasemaps(t,e){const s=await this._fetchBasemaps(t,e);if((e==null?void 0:e.include3d)===!0&&this.use3dBasemaps!==!1){const i=await this._fetchBasemaps3D(t,e);s.unshift(...i)}return s}async fetchDefault3DBasemap(t){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const e=new Rc;e.query=this.default3DBasemapQuery,e.disableExtraQuery=!0;const s=(await this.queryItems(e,t)).results.find(i=>i.type==="Web Scene");return s?new Bw({portalItem:s}):null}fetchCategorySchema(t){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",t).then(e=>e.categorySchema):Yl(t)?Promise.reject(xi()):Promise.resolve([])}async fetchClassificationSchema(t){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",t).then(e=>e.classificationSchema):null}fetchFeaturedGroups(t){const e=this.featuredGroups,s=new Rc({num:100,sortField:"title"});if(e!=null&&e.length){const i=[];for(const r of e)i.push(`(title:"${r.title}" AND owner:${r.owner})`);return s.query=i.join(" OR "),this.queryGroups(s,t).then(r=>r.results)}return Yl(t)?Promise.reject(xi()):Promise.resolve([])}fetchRegions(t){var s;const e=((s=this.user)==null?void 0:s.culture)||this.culture||Lo();return this.request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}fetchSettings(t){var s;const e=((s=this.user)==null?void 0:s.culture)||this.culture||Lo();return this.request(this.restUrl+"/portals/self/settings",{...t,query:{culture:e}})}static getDefault(){return R$e(()=>new bl)}queryGroups(t,e){return this.queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this.queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this.queryPortal("/community/users",t,"PortalUser",e)}fetchSelf(t=this.authMode,e=!1,s){const i=this.restUrl+"/portals/self",r={authMode:t,query:{culture:Lo().toLowerCase()},withCredentials:!0,...s};return r.authMode==="auto"&&(r.authMode="no-prompt"),e&&(r.query.default=!0),this.request(i,r)}queryPortal(t,e,s,i){const r=nn(Rc,e),n=o=>this.request(this.restUrl+t,{...r.toRequestOptions(this),...i}).then(a=>{const l=r.clone();return l.start=a.nextStart,new F$e({nextQueryParams:l,queryParams:r,total:a.total,results:bl._resultsToTypedArray(o,{portal:this},a,i)})}).then(a=>Promise.all(a.results.map(l=>typeof l.when=="function"?l.when():a)).then(()=>a,l=>(Nc(l),a)));return s&&tQ[s]?tQ[s]().then(({default:o})=>(ni(i),n(o))):n()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new ae("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")});if(this.authMode===bl.AUTH_MODE_ANONYMOUS||this.authMode===bl.AUTH_MODE_NO_PROMPT&&!Mt)return Promise.reject(new ae("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const t=e=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(e||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=e,this.fetchSelf("immediate"))):this.user&&this.credential===e?null:(this.credential=e,this.fetchSelf("immediate"))).then(s=>{s&&(this.sourceJSON=s,this.read(s))});return Mt?Mt.getCredential(this.restUrl,{prompt:this.authMode!==bl.AUTH_MODE_NO_PROMPT}).then(e=>t(e)):t(this.credential)}normalizeUrl(t){var s;const e=(s=this.credential)==null?void 0:s.token;return this._normalizeSSL(e?t+(t.includes("?")?"&":"?")+"token="+e:t)}requestToTypedArray(t,e,s){return this.request(t,e).then(i=>{const r=bl._resultsToTypedArray(s,{portal:this},i);return Promise.all(r.map(n=>typeof n.when=="function"?n.when():i)).then(()=>r,()=>r)})}request(t,e={}){const s={f:"json",...e.query},{authMode:i=this.authMode===bl.AUTH_MODE_ANONYMOUS||this.authMode===bl.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:r=null,cacheBust:n=!1,method:o="auto",responseType:a="json",signal:l}=e,u={authMode:i,body:r,cacheBust:n,method:o,query:s,responseType:a,timeout:0,signal:l};return e.withCredentials&&(u.withCredentials=!0),js(this._normalizeSSL(t),u).then(c=>c.data)}toJSON(){throw new ae("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new bl({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new ae("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}async _fetchBasemaps(t,e){const s=new Rc;s.query=t||(this.hasAPIKey?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),s.disableExtraQuery=!0;const i=await this.queryGroups(s,e);if(!i.total)return[];const r=i.results[0];s.num=100,s.query='type:"Web Map" -type:"Web Application"',s.sortField=r.sortField||"name",s.sortOrder=r.sortOrder||"desc";const n=await r.queryItems(s,e);return n.total?n.results.filter(o=>o.type==="Web Map").map(o=>new Bw({portalItem:o})):[]}async _fetchBasemaps3D(t,e){const s=t||this.basemapGalleryGroupQuery3D;if(!s)return[];if(this.hasAPIKey)return[];const i=new Rc({query:s,disableExtraQuery:!0}),r=await this.queryGroups(i,e);if(!r.total)return[];const n=r.results[0];i.num=100,i.query='type:"Web Scene"',i.sortField=n.sortField||"name",i.sortOrder=n.sortOrder||"desc";const o=await n.queryItems(i,e);return o.total?o.results.filter(a=>a.type==="Web Scene").map(a=>new Bw({portalItem:a})):[]}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(t){if(t){const e=Bw.fromJSON(t);return e.portalItem={portal:this},e}return null}static _resultsToTypedArray(t,e,s,i){let r;if(s){const n=i!=null?i.signal:null;r=s.listings||s.notifications||s.userInvitations||s.tags||s.items||s.groups||s.comments||s.provisions||s.results||s.relatedItems||s,(t||e)&&(r=r.map(o=>{const a=Object.assign(t?t.fromJSON(o):o,e);return typeof a.load=="function"&&a.load(n),a}))}else r=[];return r}};ze.AUTH_MODE_ANONYMOUS="anonymous",ze.AUTH_MODE_AUTO="auto",ze.AUTH_MODE_IMMEDIATE="immediate",ze.AUTH_MODE_NO_PROMPT="no-prompt",p([_()],ze.prototype,"access",void 0),p([_()],ze.prototype,"allSSL",void 0),p([_()],ze.prototype,"authMode",void 0),p([_()],ze.prototype,"authorizedCrossOriginDomains",void 0),p([qe("authorizedCrossOriginDomains")],ze.prototype,"readAuthorizedCrossOriginDomains",null),p([_()],ze.prototype,"basemapGalleryGroupQuery",void 0),p([_({json:{name:"3DBasemapGalleryGroupQuery"}})],ze.prototype,"basemapGalleryGroupQuery3D",void 0),p([_()],ze.prototype,"bingKey",void 0),p([_()],ze.prototype,"canListApps",void 0),p([_()],ze.prototype,"canListData",void 0),p([_()],ze.prototype,"canListPreProvisionedItems",void 0),p([_()],ze.prototype,"canProvisionDirectPurchase",void 0),p([_()],ze.prototype,"canSearchPublic",void 0),p([_()],ze.prototype,"canShareBingPublic",void 0),p([_()],ze.prototype,"canSharePublic",void 0),p([_()],ze.prototype,"canSignInArcGIS",void 0),p([_()],ze.prototype,"canSignInIDP",void 0),p([_()],ze.prototype,"colorSetsGroupQuery",void 0),p([_()],ze.prototype,"commentsEnabled",void 0),p([_({type:Date})],ze.prototype,"created",void 0),p([_()],ze.prototype,"credential",void 0),p([_()],ze.prototype,"culture",void 0),p([_()],ze.prototype,"currentVersion",void 0),p([_()],ze.prototype,"customBaseUrl",void 0),p([_()],ze.prototype,"default3DBasemapQuery",void 0),p([_()],ze.prototype,"defaultBasemap",void 0),p([qe("defaultBasemap")],ze.prototype,"readDefaultBasemap",null),p([_()],ze.prototype,"defaultDevBasemap",void 0),p([qe("defaultDevBasemap")],ze.prototype,"readDefaultDevBasemap",null),p([_({type:Hs})],ze.prototype,"defaultExtent",void 0),p([_()],ze.prototype,"defaultVectorBasemap",void 0),p([qe("defaultVectorBasemap")],ze.prototype,"readDefaultVectorBasemap",null),p([_()],ze.prototype,"description",void 0),p([_()],ze.prototype,"devBasemapGalleryGroupQuery",void 0),p([_()],ze.prototype,"eueiEnabled",void 0),p([_({readOnly:!0})],ze.prototype,"extraQuery",null),p([_()],ze.prototype,"featuredGroups",void 0),p([_()],ze.prototype,"featuredItemsGroupQuery",void 0),p([_()],ze.prototype,"galleryTemplatesGroupQuery",void 0),p([_()],ze.prototype,"layoutGroupQuery",void 0),p([_()],ze.prototype,"livingAtlasGroupQuery",void 0),p([_({readOnly:!0})],ze.prototype,"hasAPIKey",null),p([_()],ze.prototype,"hasCategorySchema",void 0),p([_()],ze.prototype,"hasClassificationSchema",void 0),p([_()],ze.prototype,"helpBase",void 0),p([_()],ze.prototype,"helperServices",void 0),p([_()],ze.prototype,"helpMap",void 0),p([_()],ze.prototype,"homePageFeaturedContent",void 0),p([_()],ze.prototype,"homePageFeaturedContentCount",void 0),p([_()],ze.prototype,"httpPort",void 0),p([_()],ze.prototype,"httpsPort",void 0),p([_()],ze.prototype,"id",void 0),p([_()],ze.prototype,"ipCntryCode",void 0),p([_({readOnly:!0})],ze.prototype,"isOrganization",null),p([_()],ze.prototype,"isPortal",void 0),p([_()],ze.prototype,"isReadOnly",void 0),p([_({readOnly:!0})],ze.prototype,"itemPageUrl",null),p([_()],ze.prototype,"layerTemplatesGroupQuery",void 0),p([_()],ze.prototype,"maxTokenExpirationMinutes",void 0),p([_({type:Date})],ze.prototype,"modified",void 0),p([_()],ze.prototype,"name",void 0),p([_()],ze.prototype,"portalHostname",void 0),p([_()],ze.prototype,"portalMode",void 0),p([_()],ze.prototype,"portalProperties",void 0),p([_()],ze.prototype,"region",void 0),p([_()],ze.prototype,"recycleBinEnabled",void 0),p([_({readOnly:!0})],ze.prototype,"restUrl",null),p([_()],ze.prototype,"rotatorPanels",void 0),p([_()],ze.prototype,"showHomePageDescription",void 0),p([_()],ze.prototype,"sourceJSON",void 0),p([_()],ze.prototype,"staticImagesUrl",void 0),p([_({json:{name:"2DStylesGroupQuery"}})],ze.prototype,"stylesGroupQuery2d",void 0),p([_({json:{name:"stylesGroupQuery"}})],ze.prototype,"stylesGroupQuery3d",void 0),p([_()],ze.prototype,"supportsHostedServices",void 0),p([_()],ze.prototype,"symbolSetsGroupQuery",void 0),p([_()],ze.prototype,"templatesGroupQuery",void 0),p([_()],ze.prototype,"thumbnail",void 0),p([_({readOnly:!0})],ze.prototype,"thumbnailUrl",null),p([_()],ze.prototype,"units",void 0),p([_()],ze.prototype,"url",void 0),p([_()],ze.prototype,"urlKey",void 0),p([qe("urlKey")],ze.prototype,"readUrlKey",null),p([_()],ze.prototype,"user",void 0),p([qe("user")],ze.prototype,"readUser",null),p([_()],ze.prototype,"use3dBasemaps",void 0),p([_()],ze.prototype,"useDefault3dBasemap",void 0),p([_()],ze.prototype,"useStandardizedQuery",void 0),p([_()],ze.prototype,"useVectorBasemaps",void 0),p([_()],ze.prototype,"vectorBasemapGalleryGroupQuery",void 0),ze=bl=p([Q("esri.portal.Portal")],ze);const qo=ze,sQ=new FinalizationRegistry(t=>{t.remove()});function L$e(t){const e=Mt;return()=>{const s=t.deref();s&&e.findCredential(s.restUrl)&&s.signIn().catch(()=>{})}}let $m=class extends Ye{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e!=null&&e.portalItem&&e.path?{...e,path:iQ(e.path,e.portalItem)}:e}set path(e){e!=null&&Bl(e)?Ne.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return iQ(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",s){const i=this.cdnUrl;if(i==null)throw new ae("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(i,{responseType:e,query:{token:this.portalItem.apiKey,_ts:s!=null&&s.cacheBust?Date.now():null},signal:s==null?void 0:s.signal})}async update(e,s){const{addOrUpdateResources:i}=await me(()=>import("./resourceUtils-6rzXTzA8.js"),[]);return await i(this.portalItem,[{resource:this,content:e,compress:s==null?void 0:s.compress,access:s==null?void 0:s.access}],"update",s),this}hasPath(){return this.path!=null}};function iQ(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&Bl(t)&&(t=Mz(t,e.itemUrl)),t==null?void 0:t.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}p([_()],$m.prototype,"portalItem",void 0),p([_({type:String,value:null})],$m.prototype,"path",null),p([Ht("path")],$m.prototype,"_castPath",null),p([_({type:String,readOnly:!0})],$m.prototype,"url",null),p([_({type:String,readOnly:!0})],$m.prototype,"cdnUrl",null),p([_({type:String,readOnly:!0})],$m.prototype,"itemRelativeUrl",null),$m=p([Q("esri.portal.PortalItemResource")],$m);const V$e=$m;let P2=class extends Ye{constructor(e){super(e),this.created=null,this.rating=null}};p([_({type:Date})],P2.prototype,"created",void 0),p([_()],P2.prototype,"rating",void 0),P2=p([Q("esri.portal.PortalRating")],P2);const D4=P2;var cy;const q$e=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Map Service","Media Layer","Scene Service","Stream Service","Vector Tile Service","WFS","WMS","WMTS"]),G$e=new Set(["KML","GeoJson","CSV"]);let kt=cy=class extends Te.JSONSupportMixin(Jh){static from(t){return Qb(cy,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let s=t;return t==="Feature Service"||t==="Feature Collection"?s=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?s=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?s="Scene Layer":t==="Video Service"?s="Video Layer":t==="Scene Package"?s="Scene Layer Package":t==="Stream Service"?s="Feature Layer":t==="Geoprocessing Service"?s=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?s="GeoEnrichment Service":t==="Geocoding Service"?s="Locator":t==="Microsoft Powerpoint"?s="Microsoft PowerPoint":t==="GeoJson"?s="GeoJSON":t==="Globe Service"?s="Globe Layer":t==="Vector Tile Service"?s="Tile Layer":t==="netCDF"?s="NetCDF":t==="Map Service"?s=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t!=null&&t.toLowerCase().includes("add in")?s=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?s="Big Data File Share":t==="Compact Tile Package"?s="Tile Package (tpkx)":t==="Raster function template"?s="Raster Function Template":t==="OGCFeatureServer"?s="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?s="Instant App":t==="Insights Page"?s="Insights Report":t==="Excalibur Imagery Project"?s="Excalibur Project":t==="3DTiles Service"?s="3D tiles layer":t==="3DTiles Package"&&(s="3D tiles package"),s}readExtent(t){return t&&t.length?new Hs(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){var f;const t=((f=this.type)==null?void 0:f.toLowerCase())||"",e=this.typeKeywords||[],s="esri/images/portal/",i="16";let r,n=!1,o=!1,a=!1,l=!1,u=!1,c=!1,h=!1,m=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(n=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),u=e.includes("Spatiotemporal"),c=e.includes("UtilityNetwork"),r=u&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":u?"spatiotemporal":c?"utilitynetwork":n?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(u=e.includes("Spatiotemporal"),h=e.includes("Relational"),r=u||h?"mapimages":n||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):r=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?r="maps":t==="web scene"?r=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?r="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?r="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?r="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?r="datafiles":t==="360 vr experience"?r="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?r="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?r="addindesktop":t==="pdf"?r="pdf":t==="microsoft word"?r="word":t==="microsoft excel"?r="excel":t==="microsoft powerpoint"?r="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?r="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?r="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?r="layersgray":t==="analysis model"?r="analysismodel":t==="scene package"?r="scenepackage":t==="3dtiles package"?r="3dtileslayerpackage":t==="3dtiles service"?r="3dtileslayer":t==="mobile scene package"?r="mobilescenepackage":t==="tile package"||t==="compact tile package"?r="tilepackage":t==="task file"?r="taskfile":t==="report template"?r="report-template":t==="statistical data collection"?r="statisticaldatacollection":t==="insights workbook"?r="workbook":t==="insights model"?r="insightsmodel":t==="insights page"?r="insightspage":t==="insights theme"?r="insightstheme":t==="hub initiative"?r="hubinitiative":t==="hub page"?r="hubpage":t==="hub site application"?r="hubsite":t==="hub event"?r="hubevent":t==="hub project"?r="hubproject":t==="relational database connection"?r="relationaldatabaseconnection":t==="big data file share"?r="datastorecollection":t==="image collection"?r="imagecollection":t==="desktop style"?r="desktopstyle":t==="style"?r=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?r="dashboard":t==="raster function template"?r="rasterprocessingtemplate":t==="vector tile package"?r="vectortilepackage":t==="ortho mapping project"?r="orthomappingproject":t==="ortho mapping template"?r="orthomappingtemplate":t==="solution"?r="solutions":t==="geopackage"?r="geopackage":t==="deep learning package"?r="deeplearningpackage":t==="real time analytic"?r="realtimeanalytics":t==="reality mapping project"?r="realitymappingproject":t==="big data analytic"?r="bigdataanalytics":t==="feed"?r="feed":t==="excalibur imagery project"?r="excaliburimageryproject":t==="notebook"?r="notebook":t==="storymap"?r="storymap":t==="survey123 add in"?r="survey123addin":t==="mission"?r="mission":t==="mission report"?r="missionreport":t==="mission template"?r="missiontemplate":t==="quickcapture project"?r="quickcaptureproject":t==="pro report"?r="proreport":t==="pro report template"?r="proreporttemplate":t==="urban model"?r="urbanmodel":t==="urban project"?r="urbanproject":t==="web experience"?r="experiencebuilder":t==="web experience template"?r="webexperiencetemplate":t==="experience builder widget"?r="experiencebuilderwidget":t==="experience builder widget package"?r="experiencebuilderwidgetpackage":t==="workflow"?r="workflow":t==="kernel gateway connection"?r="kernelgatewayconnection":t==="insights script"?r="insightsscript":t==="hub initiative template"?r="hubinitiativetemplate":t==="storymap theme"?r="storymaptheme":t==="knowledge graph"?r="knowledgegraph":t==="knowledge graph layer"?r="knowledgegraphlayer":t==="knowledge studio project"?r="knowledgestudio":t==="native application"?r="nativeapp":t==="native application installer"?r="nativeappinstaller":t==="web link chart"?r="linkchart":t==="knowledge graph web investigation"?r="investigation":t==="ogcfeatureserver"?r="features":t==="pro presentation"?r="propresentation":t==="pro project"?r="proproject":t==="insights workbook package"?r="insightsworkbookpackage":t==="apache parquet"?r="apacheparquet":t==="notebook code snippet library"?r="notebookcodesnippets":t==="suitability model"?r="suitabilitymodel":t==="esri classifier definition"?r="classifierdefinition":t==="esri classification schema"?r="classificationschema":t==="insights data engineering workbook"?r="dataengineeringworkbook":t==="insights data engineering model"?r="dataengineeringmodel":t==="deep learning studio project"?r="deeplearningproject":t==="discussion"?r="discussion":t==="allsource project"?r="allsourceproject":t==="api key"?r="apikey":t==="data pipeline"?r="datapipelines":t==="group layer"?(m=e.includes("Map"),r=m?"layergroup2d":"layergroup"):r=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":"maps",r?Ii(s+r+i+".png"):null}get isLayer(){return this.type!=null&&q$e.has(this.type)}get itemCdnUrl(){return kz(this.itemUrl)}get itemPageUrl(){var e;const t=(e=this.portal)==null?void 0:e.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get thumbnailUrl(){var s;const t=this.itemUrl,e=this.thumbnail;return t&&e?((s=this.portal)==null?void 0:s.normalizeUrl(`${t}/info/${e}?f=json`))??null:null}get userItemUrl(){var s,i,r;const t=(s=this.portal)==null?void 0:s.restUrl;if(!t)return null;const e=this.owner||((r=(i=this.portal)==null?void 0:i.user)==null?void 0:r.username);return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=qo.getDefault()),s=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(i=>{this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(s),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}},s=t instanceof D4?t.rating:t;return s==null||isNaN(s)||typeof t!="number"||(e.query.rating=s),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new D4({rating:s,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:he(this.applicationProxies),avgRating:this.avgRating,categories:he(this.categories),classification:he(this.classification),created:he(this.created),culture:this.culture,description:this.description,extent:he(this.extent),groupCategories:he(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:he(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:he(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:he(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:he(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new cy({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){var e;const t=this.toJSON();for(const s of["tags","typeKeywords","categories"])t[s]=(e=t[s])==null?void 0:e.join(", ");for(const s of["extent","classification"]){const i=t[s];i&&(t[s]=JSON.stringify(i))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new D4(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},cy)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t==null?void 0:t.data,s={method:"post"};s.query=this.createPostQuery();for(const i in s.query)s.query[i]===null&&(s.query[i]="");return s.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?s.query.text=e:typeof e=="object"&&(s.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,s).then(()=>this.reload())}):Promise.reject(new ae("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new ae("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:s}=this;await e.signIn();const{copyResources:i,folder:r,tags:n,title:o}=t||{},a={method:"post",query:{copyPrivateResources:i==="all",folder:typeof r=="string"?r:r==null?void 0:r.id,includeResources:!!i,tags:n==null?void 0:n.join(","),title:o}},{itemId:l}=await e.request(`${s}/copy`,a);return new cy({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,s=t.filename,i={method:"post"};if(typeof e=="string")d0(e)?i.query={data:e}:i.query={url:$u(e)},s!=null&&(i.query.filename=s);else{const r=new FormData;s!=null?r.append("file",e,s):r.append("file",e),i.body=r}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,i).then(()=>this.reload())}):Promise.reject(new ae("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:s}=await me(()=>import("./resourceUtils-6rzXTzA8.js"),[]);return s(this,t,e)}async addResource(t,e,s){const{addOrUpdateResources:i}=await me(()=>import("./resourceUtils-6rzXTzA8.js"),[]);return t.portalItem=this,await i(this,[{resource:t,content:e,compress:s==null?void 0:s.compress,access:s==null?void 0:s.access}],"add",s),t}async removeResource(t,e){const{removeResource:s}=await me(()=>import("./resourceUtils-6rzXTzA8.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new ae("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return s(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await me(()=>import("./resourceUtils-6rzXTzA8.js"),[]);return e(this,t)}resourceFromPath(t){return new V$e({portalItem:this,path:t})}toJSON(){var s,i;const t=this.extent,e={accessInformation:this.accessInformation,categories:he(this.categories),classification:he(this.classification),created:(s=this.created)==null?void 0:s.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:(i=this.modified)==null?void 0:i.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:he(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:he(this.typeKeywords),url:this.url};return WSe(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new cy({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};p([_({type:["private","shared","org","public"]})],kt.prototype,"access",void 0),p([_()],kt.prototype,"accessInformation",void 0),p([_({type:String})],kt.prototype,"apiKey",void 0),p([_({json:{read:{source:"appProxies"}}})],kt.prototype,"applicationProxies",void 0),p([_()],kt.prototype,"avgRating",void 0),p([_()],kt.prototype,"categories",void 0),p([_()],kt.prototype,"classification",void 0),p([_({type:Date})],kt.prototype,"created",void 0),p([_()],kt.prototype,"culture",void 0),p([_()],kt.prototype,"description",void 0),p([_({readOnly:!0})],kt.prototype,"displayName",null),p([_({type:Hs})],kt.prototype,"extent",void 0),p([qe("extent")],kt.prototype,"readExtent",null),p([_()],kt.prototype,"groupCategories",void 0),p([_({readOnly:!0})],kt.prototype,"iconUrl",null),p([_()],kt.prototype,"id",void 0),p([_({readOnly:!0})],kt.prototype,"isLayer",null),p([_({type:Boolean,readOnly:!0})],kt.prototype,"isOrgItem",void 0),p([_()],kt.prototype,"itemControl",void 0),p([_({readOnly:!0})],kt.prototype,"itemPageUrl",null),p([_({readOnly:!0})],kt.prototype,"itemUrl",null),p([_()],kt.prototype,"licenseInfo",void 0),p([_({type:Date})],kt.prototype,"modified",void 0),p([_()],kt.prototype,"name",void 0),p([_()],kt.prototype,"numComments",void 0),p([_()],kt.prototype,"numRatings",void 0),p([_()],kt.prototype,"numViews",void 0),p([_()],kt.prototype,"owner",void 0),p([_()],kt.prototype,"ownerFolder",void 0),p([_({type:qo})],kt.prototype,"portal",void 0),p([_()],kt.prototype,"screenshots",void 0),p([_()],kt.prototype,"size",void 0),p([_()],kt.prototype,"snippet",void 0),p([_()],kt.prototype,"sourceJSON",void 0),p([_({type:String})],kt.prototype,"sourceUrl",void 0),p([_({type:String})],kt.prototype,"spatialReference",void 0),p([_()],kt.prototype,"tags",void 0),p([_()],kt.prototype,"thumbnail",void 0),p([_({readOnly:!0})],kt.prototype,"thumbnailUrl",null),p([_()],kt.prototype,"title",void 0),p([_()],kt.prototype,"type",void 0),p([_()],kt.prototype,"typeKeywords",void 0),p([_({type:String,json:{read(t,e){var s;if(G$e.has(e.type)){const i=(s=this.portal)==null?void 0:s.restUrl;t||(t=i&&this.id?`${i}/content/items/${this.id}/data`:null)}return t}}})],kt.prototype,"url",void 0),p([_({readOnly:!0})],kt.prototype,"userItemUrl",null),kt=cy=p([Q("esri.portal.PortalItem")],kt);const sb=kt,bhe=Object.freeze(Object.defineProperty({__proto__:null,default:sb},Symbol.toStringTag,{value:"Module"}));async function z$e(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,s=await xce("esri/t9n/basemaps");return s[t]||s[e]}const J5={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return Ii("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return Ii("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return Ii("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return Ii("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return Ii("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]}};let Rm=class extends Ye{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let s=e==="local"||e==="global"?e:wce(e??Lo())??"global";return s=s==="no"?"nb":s,s}};p([_()],Rm.prototype,"apiKey",void 0),p([_()],Rm.prototype,"id",void 0),p([_()],Rm.prototype,"language",void 0),p([_()],Rm.prototype,"places",void 0),p([_()],Rm.prototype,"serviceUrl",void 0),p([_()],Rm.prototype,"worldview",void 0),Rm=p([Q("esri.support.BasemapStyle")],Rm);const U$e=Rm;function Lmt(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function B$e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function cd(t){return(t==null?void 0:t.type)==="subtype-sublayer"}const Vmt={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function K5(t){const e=t==null?void 0:t.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function qmt(t){return t==="integrated-mesh"||t==="integrated-mesh-3dtiles"}function o$(t){var e;return(t==null?void 0:t.type)==="feature"&&!t.url&&((e=t.source)==null?void 0:e.type)==="memory"}function Gmt(t){var s;const e=t==null?void 0:t.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&((s=t==null?void 0:t.source)==null?void 0:s.type)==="feature-layer"}async function E7(t,e){const s=Mt==null?void 0:Mt.findServerInfo(t);if((s==null?void 0:s.currentVersion)!=null)return s.owningSystemUrl||null;const i=t.toLowerCase().indexOf("/rest/services");if(i===-1)return null;const r=`${t.slice(0,i)}/rest/info`,n=e!=null?e.signal:null,{data:o}=await js(r,{query:{f:"json"},responseType:"json",signal:n});return(o==null?void 0:o.owningSystemUrl)||null}function xhe(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function whe(t){return xhe(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function j$e(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function H$e(t){return!!j$e(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}const Y$e=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),She=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wcs","wfs","wms","wmts"]),X$e=new Set([...She,"link-chart"]);function W$e(t){switch(t.layerContainerType){case"basemap":return Y$e;case"operational-layers":return t.origin==="link-chart"?X$e:She;default:return null}}function Z$e(t,e){if(e.restrictedWebMapWriting){const s=W$e(e);return s==null||s.has(t.type)&&!o$(t)}return!0}function Q$e(t,e){var s;if(e)if(o$(t)){const i=IC("featureCollection.layers",e),r=(s=i==null?void 0:i[0])==null?void 0:s.layerDefinition;r&&rQ(t,r)}else t.type!=="group"&&rQ(t,e)}function rQ(t,e){"maxScale"in t&&(e.maxScale=CN(t.maxScale)??void 0),"minScale"in t&&(e.minScale=CN(t.minScale)??void 0)}function J$e(t,e){if(Q$e(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=CN(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(o$(t)){const s=e.featureCollection;s&&(s.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function nQ(t,e,s){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return s!=null&&s.messages&&s.messages.push(new ae("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(o$(t)&&!t.isTable)e=t.resourceInfo;else if(Z$e(t,s)){const i={};return t.write(i,s)?i:null}return e!=null&&J$e(t,e=he(e)),e}var T2;let K$e=0,xl=T2=class extends Te.JSONSupportMixin(Jh){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+K$e++,this.baseLayers=new Ge,this.referenceLayers=new Ge;const e=i=>{i.parent&&i.parent!==this&&"remove"in i.parent&&i.parent.remove(i),i.parent=this,i.type==="elevation"&&Ne.getLogger(this).error(`Layer '${i.title}, id:${i.id}' of type '${i.type}' is not supported as a basemap layer and will therefore be ignored.`)},s=i=>{i.parent=null};this.addHandles([this.baseLayers.on("after-add",i=>e(i.item)),this.referenceLayers.on("after-add",i=>e(i.item)),this.baseLayers.on("after-remove",i=>s(i.item)),this.referenceLayers.on("after-remove",i=>s(i.item))])}initialize(){this.when().catch(t=>{Ne.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.baseLayers.toArray();for(const s of t)s.destroy();const e=this.referenceLayers.toArray();for(const s of e)s.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=ii(this.portalItem)}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",Md(t,this._get("baseLayers")))}_writeBaseLayers(t,e,s){const i=[];t&&(s={...s,layerContainerType:"basemap"},this.baseLayers.forEach(r=>{const n=nQ(r,s.webmap?s.webmap.getLayerJSONFromResourceInfo(r):null,s);n!=null&&i.push(n)}),this.referenceLayers.forEach(r=>{const n=nQ(r,s.webmap?s.webmap.getLayerJSONFromResourceInfo(r):null,s);n!=null&&(r.type!=="scene"&&(n.isReference=!0),i.push(n))})),e.baseMapLayers=i}set referenceLayers(t){this._set("referenceLayers",Md(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return vhe(this,t=>{t(this.baseLayers,this.referenceLayers)})}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(e=>_N(e)?e.clone():e),referenceLayers:this.referenceLayers.map(e=>_N(e)?e.clone():e)};return this.loaded&&(t.loadStatus="loaded"),new T2({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){var s;return t=t||{},e!=null&&e.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&((s=this.resourceInfo)!=null&&s.data.baseMapLayers)&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(i=>{const r=he(i);return r.url&&Wh(r.url)&&(r.url=`https:${r.url}`),r.templateUrl&&Wh(r.templateUrl)&&(r.templateUrl=`https:${r.templateUrl}`),r})),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:s,style:i}=this;ni(t);const r=[];if(e){const n=e.context?e.context.url:null;if(r.push(this._loadLayersFromJSON(e.data,n,t)),e.data.id&&!e.data.title){const o=e.data.id;r.push(z$e(o).then(a=>{a&&this.read({title:a},e.context)}))}}else s?r.push(this._loadFromItem(s,t)):i&&r.push(this._loadFromStylesService(i,t));await Promise.all(r)}async _loadLayersFromJSON(t,e,s){var l,u;const i=(l=this.resourceInfo)==null?void 0:l.context,r=((u=this.portalItem)==null?void 0:u.portal)||(i==null?void 0:i.portal)||null,n=tRe[(i==null?void 0:i.origin)||""]??"web-map",{populateOperationalLayers:o}=await me(async()=>{const{populateOperationalLayers:c}=await import("./layersCreator-CQpJfFOa.js");return{populateOperationalLayers:c}},__vite__mapDeps([147,148,149,150,151,152])),a=[];if(ni(s),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const c={context:{...i,origin:n,url:e,portal:r,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},h=g=>n==="web-scene"&&g.layerType==="ArcGISSceneServiceLayer"||g.isReference,m=o(this.baseLayers,t.baseMapLayers.filter(g=>!h(g)),c);a.push(m);const f=o(this.referenceLayers,t.baseMapLayers.filter(h),c);a.push(f)}await Promise.allSettled(a)}async _loadFromItem(t,e){const s=await t.load(e),i=await s.fetchData("json",e),r=Sr(t.itemUrl??"");return this._set("resourceInfo",{data:i.baseMap??{},context:{origin:eRe[t.type||""]??"web-map",portal:t.portal||qo.getDefault(),url:r}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:i.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||qo.getDefault(),url:r}),this._loadLayersFromJSON(this.resourceInfo.data,r,e)}async _loadFromStylesService(t,e){const s=t.serviceUrl.endsWith("/webmaps")?t.serviceUrl.slice(0,-8):t.serviceUrl,i=`${s}/styles/${t.id}/self`,r=`${s}/webmaps/${t.id}`,[n,o]=await Promise.all([(await js(i,{query:{token:t.apiKey},signal:e==null?void 0:e.signal})).data,(await js(r,{query:{language:t.languageParameter,places:t.places,worldview:t.worldview,token:t.apiKey},signal:e==null?void 0:e.signal})).data]);this.thumbnailUrl??(this.thumbnailUrl=n.thumbnailUrl);const a=Sr(r);if(this._set("resourceInfo",{data:o.baseMap??{},context:{origin:"web-map",url:a}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:o.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,a,e),t.apiKey)for(const l of[...this.baseLayers,...this.referenceLayers])"apiKey"in l&&(l.apiKey=t.apiKey)}static fromId(t){const e=J5[t];return e?e.itemId?new T2({portalItem:{id:e.itemId,portal:{url:"https://www.arcgis.com"}}}):T2.fromJSON(e,{origin:e.is3d?"web-scene":"web-map"}):null}};p([_({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,s,i){this._writeBaseLayers(t,e,i)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Ge}},writer(t,e,s,i){this._writeBaseLayers(t,e,i)}}}}}})],xl.prototype,"baseLayers",null),p([_({type:String,json:{origins:{"web-scene":{write:!0}}}})],xl.prototype,"id",void 0),p([_({type:sb})],xl.prototype,"portalItem",void 0),p([_()],xl.prototype,"referenceLayers",null),p([_({readOnly:!0})],xl.prototype,"resourceInfo",void 0),p([_({type:St})],xl.prototype,"spatialReference",void 0),p([_({type:U$e})],xl.prototype,"style",void 0),p([_()],xl.prototype,"thumbnailUrl",void 0),p([_({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],xl.prototype,"title",void 0),p([Ue("title")],xl.prototype,"writeTitle",null),xl=T2=p([Q("esri.Basemap")],xl);const eRe={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},tRe={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},QS=xl,sRe=Object.freeze(Object.defineProperty({__proto__:null,default:QS},Symbol.toStringTag,{value:"Module"})),r3={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function Ehe(t){return!!r3[t]||!!r3[t.toLowerCase()]}function C7(t){return r3[t]??r3[t.toLowerCase()]}function iRe(t){return[...C7(t)]}function $4(t,e,s){s<0&&++s,s>1&&--s;const i=6*s;return i<1?t+(e-t)*i:2*s<1?e:3*s<2?t+(e-t)*(2/3-s)*6:t}function Che(t,e,s,i=1){const r=(t%360+360)%360/360,n=s<=.5?s*(e+1):s+e-s*e,o=2*s-n;return[Math.round(255*$4(o,n,r+1/3)),Math.round(255*$4(o,n,r)),Math.round(255*$4(o,n,r-1/3)),i]}function rRe(t){const e=t.length>5,s=e?8:4,i=(1<<s)-1,r=e?1:17,n=e?t.length===9:t.length===5;let o=+("0x"+t.slice(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return n&&(l=o&i,o>>=s,a[3]=r*l/255),l=o&i,o>>=s,a[2]=r*l,l=o&i,o>>=s,a[1]=r*l,l=o&i,o>>=s,a[0]=r*l,a}const zmt=2.2;function pI(t){return Ka(mz(t),0,255)}function fI(t,e,s){return t=Number(t),isNaN(t)?s:t<e?e:t>s?s:t}function gI(t,e){const s=t.toString(16).padStart(2,"0");return e?s.slice(0,1):s}let Be=class pn{static blendColors(e,s,i,r=new pn){return r.r=Math.round(e.r+(s.r-e.r)*i),r.g=Math.round(e.g+(s.g-e.g)*i),r.b=Math.round(e.b+(s.b-e.b)*i),r.a=e.a+(s.a-e.a)*i,r._sanitize()}static fromRgb(e,s){const i=e.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(i){const r=i[2].split(/\s*,\s*/),n=i[1];if(n==="rgb"&&r.length===3||n==="rgba"&&r.length===4){const o=r[0];if(o.charAt(o.length-1)==="%"){const a=r.map(l=>2.56*parseFloat(l));return r.length===4&&(a[3]=parseFloat(r[3])),pn.fromArray(a,s)}return pn.fromArray(r.map(a=>parseFloat(a)),s)}if(n==="hsl"&&r.length===3||n==="hsla"&&r.length===4)return pn.fromArray(Che(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100,parseFloat(r[3])),s)}return null}static fromHex(e,s=new pn){if(e[0]!=="#"||isNaN(+`0x${e.slice(1)}`))return null;switch(e.length){case 4:case 5:{const i=parseInt(e.slice(1,2),16),r=parseInt(e.slice(2,3),16),n=parseInt(e.slice(3,4),16),o=e.length===5?15:parseInt(e.slice(4),16);return pn.fromArray([i+16*i,r+16*r,n+16*n,(o+16*o)/255],s)}case 7:case 9:{const i=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16),o=e.length===7?255:parseInt(e.slice(7),16);return pn.fromArray([i,r,n,o/255],s)}default:return null}}static fromArray(e,s=new pn){return s._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(s.a)&&(s.a=1),s._sanitize()}static fromString(e,s){const i=Ehe(e)?C7(e):null;return i&&pn.fromArray(i,s)||pn.fromRgb(e,s)||pn.fromHex(e,s)}static fromJSON(e){return e!=null?new pn([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e){return e!=null?[e.r/255,e.g/255,e.b/255,e.a!=null?e.a:1]:null}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?pn.fromString(e,this):Array.isArray(e)?pn.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof pn||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const s=(e==null?void 0:e.capitalize)??!1,i=(e==null?void 0:e.digits)??6,r=i===3||i===4,n=i===4||i===8,o=`#${gI(this.r,r)}${gI(this.g,r)}${gI(this.b,r)}${n?gI(Math.round(255*this.a),r):""}`;return s?o.toUpperCase():o}toCss(e=!1){const s=this.r+", "+this.g+", "+this.b;return e?`rgba(${s}, ${this.a})`:`rgb(${s})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=pn.AlphaMode.ALWAYS){const s=pI(this.r),i=pI(this.g),r=pI(this.b);return e===pn.AlphaMode.ALWAYS||this.a!==1?[s,i,r,pI(255*this.a)]:[s,i,r]}clone(){return new pn(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Math.round(fI(this.r,0,255)),this.g=Math.round(fI(this.g,0,255)),this.b=Math.round(fI(this.b,0,255)),this.a=fI(this.a,0,1),this}_set(e,s,i,r){this.r=e,this.g=s,this.b=i,this.a=r}};Be.prototype.declaredClass="esri.Color",function(t){var e;(e=t.AlphaMode||(t.AlphaMode={}))[e.ALWAYS=0]="ALWAYS",e[e.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(Be);function mt(t,e={}){const s=t instanceof Jt?t:new Jt(t,e),{alwaysWriteDefaults:i,default:r,ignoreUnknown:n=!0,name:o,nonNullable:a,readOnly:l=!1}=e;return _({type:n?s.apiValues:String,json:{type:s.jsonValues,default:r,name:o,read:!l&&{reader:s.read},write:{writer:s.write,alwaysWriteDefaults:i}},nonNullable:a,readOnly:l})}var e6;let KM=e6=class extends Te{constructor(t){super(t),this.type="none"}clone(){return new e6({type:this.type})}};p([mt({none:"none",stayAbove:"stay-above"}),_({json:{write:{isRequired:!0}}})],KM.prototype,"type",void 0),KM=e6=p([Q("esri.ground.NavigationConstraint")],KM);const nRe=Symbol("GroundInstance");function a$(t){const e=mz(100*(1-t));return Math.max(0,Math.min(e,100))}function kE(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var Phe,t6;let km=t6=class extends Te.JSONSupportMixin(Jh){constructor(t){super(t),this[Phe]=!0,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Ge;const e=i=>{i.parent&&i.parent!==this&&"remove"in i.parent&&i.parent.remove(i),i.parent=this,i.type!=="elevation"&&i.type!=="base-elevation"&&Ne.getLogger(this).error(`Layer '${i.title}, id:${i.id}' of type '${i.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},s=i=>{i.parent=null};this.addHandles([this.layers.on("after-add",i=>e(i.item)),this.layers.on("after-remove",i=>s(i.item))])}initialize(){this.when().catch(t=>{Lr(t)||Ne.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)ii(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}get layers(){return this._get("layers")}set layers(t){this._set("layers",Md(t,this._get("layers")))}writeLayers(t,e,s,i){const r=[];t&&(i={...i,layerContainerType:"ground"},t.forEach(n=>{if("write"in n){const o={};jSe(n)().write(o,i)&&r.push(o)}else i!=null&&i.messages&&i.messages.push(new ae("layer:unsupported",`Layers (${n.title}, ${n.id}) of type '${n.declaredClass}' cannot be persisted in the ground`,{layer:n}))})),e.layers=r}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return vhe(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:s}=await me(()=>import("./ElevationQuery-BLUq5rsH.js"),[]);ni(e);const i=new s,r=this.layers.filter(oQ).toArray();return i.queryAll(r,t,e)}async createElevationSampler(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:s}=await me(()=>import("./ElevationQuery-BLUq5rsH.js"),[]);ni(e);const i=new s,r=this.layers.filter(oQ).toArray();return i.createSamplerAll(r,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:he(this.surfaceColor),navigationConstraint:he(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new t6({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,s){const i=(e==null?void 0:e.origin)||"web-scene",r=(e==null?void 0:e.portal)||null,n=(e==null?void 0:e.url)||null,{populateOperationalLayers:o}=await me(async()=>{const{populateOperationalLayers:l}=await import("./layersCreator-CQpJfFOa.js");return{populateOperationalLayers:l}},__vite__mapDeps([147,148,149,150,151,152]));ni(s);const a=[];if(t.layers&&Array.isArray(t.layers)){const l={context:{origin:i,url:n,portal:r,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,l))}await Promise.allSettled(a)}};function oRe(t){return t&&"createElevationSampler"in t}function oQ(t){return t.type==="elevation"||oRe(t)}Phe=nRe,p([_({json:{read:!1,write:{isRequired:!0}}})],km.prototype,"layers",null),p([Ue("layers")],km.prototype,"writeLayers",null),p([_({readOnly:!0})],km.prototype,"resourceInfo",void 0),p([_({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:fs,read:{reader:kE,source:"transparency"},write:{writer:(t,e)=>{e.transparency=a$(t)},target:"transparency"}}})],km.prototype,"opacity",void 0),p([_({type:Be,json:{type:[fs],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],km.prototype,"surfaceColor",void 0),p([_({type:KM,json:{write:!0}})],km.prototype,"navigationConstraint",void 0),km=t6=p([Q("esri.Ground")],km);const n3=km,yI=new WeakMap;function P7(t){return!t.destroyed&&(yI.has(t)||t.addHandles([Ee(()=>{const e=t.parent;return!(!e||!("type"in e))&&(e.type==="catalog-dynamic-group"||P7(e))},e=>yI.set(t,e),Ga),xs(()=>yI.delete(t))]),yI.get(t))}function aQ(t,e){var a;const s=t.parent,i=t.layer;if((i==null?void 0:i.type)!=="map-image"||!i.sourceJSON||!s)return!1;const r=i.sourceJSON.layers;if(!r)return!1;const n=r.find(l=>t.id===l.id),o=e==="footprints"?"Feature Layer":"Catalog Dynamic Group Layer";return(n==null?void 0:n.type)===o&&((a=r.find(l=>l.id===s.id))==null?void 0:a.type)==="Catalog Layer"}function aRe(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function lRe(t){var e,s;return!(!aRe(t)||!((s=(e=whe(t))==null?void 0:e.operations)!=null&&s.supportsEditing)||"editingEnabled"in t&&!H$e(t)||P7(t))}const uRe=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,cRe="screenUtils.toPt: input not recognized!",The=96;function ko(t){return t?t/72*The:0}function Zl(t){return t?72*t/The:0}function ms(t){if(typeof t=="string"){const e=t.match(uRe);if(e){const s=Number(e[1]),i=e[3]&&e[3].toLowerCase(),r=t.charAt(0)==="-",n=i==="px"?Zl(s):s;return r?-n:n}return console.warn(cRe),null}return t}function Bn(t=0,e=0){return{x:t,y:e}}function Umt(t){return t?Bn(t.x,t.y):null}function Bmt(t=0,e=0){return[t,e]}function jmt(t=0,e=0,s=0){return[t,e,s]}function Hmt(t){return t}function Ymt(t){return t}function Xmt(t){return t}function Wmt(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function l$(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function hRe(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function mRe(t,e,s,i,r,n,o,a,l,u,c,h,m,f,g,v){const b=new Float32Array(16);return b[0]=t,b[1]=e,b[2]=s,b[3]=i,b[4]=r,b[5]=n,b[6]=o,b[7]=a,b[8]=l,b[9]=u,b[10]=c,b[11]=h,b[12]=m,b[13]=f,b[14]=g,b[15]=v,b}function dRe(t,e){return new Float32Array(t,e,16)}const pRe=l$();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:pRe,clone:hRe,create:l$,createView:dRe,fromValues:mRe},Symbol.toStringTag,{value:"Module"}));let T7=1e-6;function _a(){return T7}function fRe(t){T7=t}const u$=Math.random,gRe=Math.PI/180,yRe=180/Math.PI;function I7(t){return t*gRe}function _Re(t){return t*yRe}function vRe(t,e){return Math.abs(t-e)<=T7*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:u$,equals:vRe,getEpsilon:_a,setEpsilon:fRe,toDegree:_Re,toRadian:I7},Symbol.toStringTag,{value:"Module"}));function Ihe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function fg(t,e,s,i,r,n,o,a,l,u,c,h,m,f,g,v,b){return t[0]=e,t[1]=s,t[2]=i,t[3]=r,t[4]=n,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=m,t[12]=f,t[13]=g,t[14]=v,t[15]=b,t}function c$(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gg(t,e){if(t===e){const s=e[1],i=e[2],r=e[3],n=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=s,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=n,t[11]=e[14],t[12]=r,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function bRe(t,e){return Mhe(t,e)||c$(t),t}function Mhe(t,e){const s=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],m=e[10],f=e[11],g=e[12],v=e[13],b=e[14],w=e[15],S=s*a-i*o,T=s*l-r*o,P=s*u-n*o,I=i*l-r*a,A=i*u-n*a,D=r*u-n*l,k=c*v-h*g,R=c*b-m*g,O=c*w-f*g,z=h*b-m*v,q=h*w-f*v,U=m*w-f*b;let V=S*U-T*q+P*z+I*O-A*R+D*k;return V?(V=1/V,t[0]=(a*U-l*q+u*z)*V,t[1]=(r*q-i*U-n*z)*V,t[2]=(v*D-b*A+w*I)*V,t[3]=(m*A-h*D-f*I)*V,t[4]=(l*O-o*U-u*R)*V,t[5]=(s*U-r*O+n*R)*V,t[6]=(b*P-g*D-w*T)*V,t[7]=(c*D-m*P+f*T)*V,t[8]=(o*q-a*O+u*k)*V,t[9]=(i*O-s*q-n*k)*V,t[10]=(g*A-v*P+w*S)*V,t[11]=(h*P-c*A-f*S)*V,t[12]=(a*R-o*z-l*k)*V,t[13]=(s*z-i*R+r*k)*V,t[14]=(v*T-g*I-b*S)*V,t[15]=(c*I-h*T+m*S)*V,t):null}function xRe(t,e){const s=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],m=e[10],f=e[11],g=e[12],v=e[13],b=e[14],w=e[15];return t[0]=a*(m*w-f*b)-h*(l*w-u*b)+v*(l*f-u*m),t[1]=-(i*(m*w-f*b)-h*(r*w-n*b)+v*(r*f-n*m)),t[2]=i*(l*w-u*b)-a*(r*w-n*b)+v*(r*u-n*l),t[3]=-(i*(l*f-u*m)-a*(r*f-n*m)+h*(r*u-n*l)),t[4]=-(o*(m*w-f*b)-c*(l*w-u*b)+g*(l*f-u*m)),t[5]=s*(m*w-f*b)-c*(r*w-n*b)+g*(r*f-n*m),t[6]=-(s*(l*w-u*b)-o*(r*w-n*b)+g*(r*u-n*l)),t[7]=s*(l*f-u*m)-o*(r*f-n*m)+c*(r*u-n*l),t[8]=o*(h*w-f*v)-c*(a*w-u*v)+g*(a*f-u*h),t[9]=-(s*(h*w-f*v)-c*(i*w-n*v)+g*(i*f-n*h)),t[10]=s*(a*w-u*v)-o*(i*w-n*v)+g*(i*u-n*a),t[11]=-(s*(a*f-u*h)-o*(i*f-n*h)+c*(i*u-n*a)),t[12]=-(o*(h*b-m*v)-c*(a*b-l*v)+g*(a*m-l*h)),t[13]=s*(h*b-m*v)-c*(i*b-r*v)+g*(i*m-r*h),t[14]=-(s*(a*b-l*v)-o*(i*b-r*v)+g*(i*l-r*a)),t[15]=s*(a*m-l*h)-o*(i*m-r*h)+c*(i*l-r*a),t}function wRe(t){const e=t[0],s=t[1],i=t[2],r=t[3],n=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],m=t[11],f=t[12],g=t[13],v=t[14],b=t[15];return(e*o-s*n)*(h*b-m*v)-(e*a-i*n)*(c*b-m*g)+(e*l-r*n)*(c*v-h*g)+(s*a-i*o)*(u*b-m*f)-(s*l-r*o)*(u*v-h*f)+(i*l-r*a)*(u*g-c*f)}function Ahe(t,e,s){const i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],m=e[9],f=e[10],g=e[11],v=e[12],b=e[13],w=e[14],S=e[15];let T=s[0],P=s[1],I=s[2],A=s[3];return t[0]=T*i+P*a+I*h+A*v,t[1]=T*r+P*l+I*m+A*b,t[2]=T*n+P*u+I*f+A*w,t[3]=T*o+P*c+I*g+A*S,T=s[4],P=s[5],I=s[6],A=s[7],t[4]=T*i+P*a+I*h+A*v,t[5]=T*r+P*l+I*m+A*b,t[6]=T*n+P*u+I*f+A*w,t[7]=T*o+P*c+I*g+A*S,T=s[8],P=s[9],I=s[10],A=s[11],t[8]=T*i+P*a+I*h+A*v,t[9]=T*r+P*l+I*m+A*b,t[10]=T*n+P*u+I*f+A*w,t[11]=T*o+P*c+I*g+A*S,T=s[12],P=s[13],I=s[14],A=s[15],t[12]=T*i+P*a+I*h+A*v,t[13]=T*r+P*l+I*m+A*b,t[14]=T*n+P*u+I*f+A*w,t[15]=T*o+P*c+I*g+A*S,t}function SRe(t,e,s){const i=s[0],r=s[1],n=s[2];if(e===t)t[12]=e[0]*i+e[4]*r+e[8]*n+e[12],t[13]=e[1]*i+e[5]*r+e[9]*n+e[13],t[14]=e[2]*i+e[6]*r+e[10]*n+e[14],t[15]=e[3]*i+e[7]*r+e[11]*n+e[15];else{const o=e[0],a=e[1],l=e[2],u=e[3],c=e[4],h=e[5],m=e[6],f=e[7],g=e[8],v=e[9],b=e[10],w=e[11];t[0]=o,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=h,t[6]=m,t[7]=f,t[8]=g,t[9]=v,t[10]=b,t[11]=w,t[12]=o*i+c*r+g*n+e[12],t[13]=a*i+h*r+v*n+e[13],t[14]=l*i+m*r+b*n+e[14],t[15]=u*i+f*r+w*n+e[15]}return t}function ERe(t,e,s){const i=s[0],r=s[1],n=s[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function CRe(t,e,s,i){let r=i[0],n=i[1],o=i[2],a=Math.sqrt(r*r+n*n+o*o);if(a<=_a())return void Ihe(t,e);a=1/a,r*=a,n*=a,o*=a;const l=Math.sin(s),u=Math.cos(s),c=1-u,h=e[0],m=e[1],f=e[2],g=e[3],v=e[4],b=e[5],w=e[6],S=e[7],T=e[8],P=e[9],I=e[10],A=e[11],D=r*r*c+u,k=n*r*c+o*l,R=o*r*c-n*l,O=r*n*c-o*l,z=n*n*c+u,q=o*n*c+r*l,U=r*o*c+n*l,V=n*o*c-r*l,B=o*o*c+u;t[0]=h*D+v*k+T*R,t[1]=m*D+b*k+P*R,t[2]=f*D+w*k+I*R,t[3]=g*D+S*k+A*R,t[4]=h*O+v*z+T*q,t[5]=m*O+b*z+P*q,t[6]=f*O+w*z+I*q,t[7]=g*O+S*z+A*q,t[8]=h*U+v*V+T*B,t[9]=m*U+b*V+P*B,t[10]=f*U+w*V+I*B,t[11]=g*U+S*V+A*B,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function PRe(t,e,s){const i=Math.sin(s),r=Math.cos(s),n=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],m=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*r+u*i,t[5]=o*r+c*i,t[6]=a*r+h*i,t[7]=l*r+m*i,t[8]=u*r-n*i,t[9]=c*r-o*i,t[10]=h*r-a*i,t[11]=m*r-l*i,t}function TRe(t,e,s){const i=Math.sin(s),r=Math.cos(s),n=e[0],o=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],m=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*r-u*i,t[1]=o*r-c*i,t[2]=a*r-h*i,t[3]=l*r-m*i,t[8]=n*i+u*r,t[9]=o*i+c*r,t[10]=a*i+h*r,t[11]=l*i+m*r,t}function IRe(t,e,s){const i=Math.sin(s),r=Math.cos(s),n=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],m=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*r+u*i,t[1]=o*r+c*i,t[2]=a*r+h*i,t[3]=l*r+m*i,t[4]=u*r-n*i,t[5]=c*r-o*i,t[6]=h*r-a*i,t[7]=m*r-l*i,t}function MRe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function ARe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function NRe(t,e,s){if(e===0)return c$(t);let i=s[0],r=s[1],n=s[2],o=Math.sqrt(i*i+r*r+n*n);if(o<=_a())return null;o=1/o,i*=o,r*=o,n*=o;const a=Math.sin(e),l=Math.cos(e),u=1-l;return t[0]=i*i*u+l,t[1]=r*i*u+n*a,t[2]=n*i*u-r*a,t[3]=0,t[4]=i*r*u-n*a,t[5]=r*r*u+l,t[6]=n*r*u+i*a,t[7]=0,t[8]=i*n*u+r*a,t[9]=r*n*u-i*a,t[10]=n*n*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function DRe(t,e){const s=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=s,t[7]=0,t[8]=0,t[9]=-s,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function $Re(t,e){const s=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-s,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=s,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function RRe(t,e){const s=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=s,t[2]=0,t[3]=0,t[4]=-s,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Nhe(t,e,s){const i=e[0],r=e[1],n=e[2],o=e[3],a=i+i,l=r+r,u=n+n,c=i*a,h=i*l,m=i*u,f=r*l,g=r*u,v=n*u,b=o*a,w=o*l,S=o*u;return t[0]=1-(f+v),t[1]=h+S,t[2]=m-w,t[3]=0,t[4]=h-S,t[5]=1-(c+v),t[6]=g+b,t[7]=0,t[8]=m+w,t[9]=g-b,t[10]=1-(c+f),t[11]=0,t[12]=s[0],t[13]=s[1],t[14]=s[2],t[15]=1,t}function kRe(t,e){const s=FRe,i=-e[0],r=-e[1],n=-e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=i*i+r*r+n*n+o*o;return h>0?(s[0]=2*(a*o+c*i+l*n-u*r)/h,s[1]=2*(l*o+c*r+u*i-a*n)/h,s[2]=2*(u*o+c*n+a*r-l*i)/h):(s[0]=2*(a*o+c*i+l*n-u*r),s[1]=2*(l*o+c*r+u*i-a*n),s[2]=2*(u*o+c*n+a*r-l*i)),Nhe(t,e,s),t}const FRe=dg();function ORe(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function LRe(t,e){const s=e[0],i=e[1],r=e[2],n=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(s*s+i*i+r*r),t[1]=Math.sqrt(n*n+o*o+a*a),t[2]=Math.sqrt(l*l+u*u+c*c),t}function VRe(t,e){const s=e[0]+e[5]+e[10];let i=0;return s>0?(i=2*Math.sqrt(s+1),t[3]=.25*i,t[0]=(e[6]-e[9])/i,t[1]=(e[8]-e[2])/i,t[2]=(e[1]-e[4])/i):e[0]>e[5]&&e[0]>e[10]?(i=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/i,t[0]=.25*i,t[1]=(e[1]+e[4])/i,t[2]=(e[8]+e[2])/i):e[5]>e[10]?(i=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/i,t[0]=(e[1]+e[4])/i,t[1]=.25*i,t[2]=(e[6]+e[9])/i):(i=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/i,t[0]=(e[8]+e[2])/i,t[1]=(e[6]+e[9])/i,t[2]=.25*i),t}function qRe(t,e,s,i){const r=e[0],n=e[1],o=e[2],a=e[3],l=r+r,u=n+n,c=o+o,h=r*l,m=r*u,f=r*c,g=n*u,v=n*c,b=o*c,w=a*l,S=a*u,T=a*c,P=i[0],I=i[1],A=i[2];return t[0]=(1-(g+b))*P,t[1]=(m+T)*P,t[2]=(f-S)*P,t[3]=0,t[4]=(m-T)*I,t[5]=(1-(h+b))*I,t[6]=(v+w)*I,t[7]=0,t[8]=(f+S)*A,t[9]=(v-w)*A,t[10]=(1-(h+g))*A,t[11]=0,t[12]=s[0],t[13]=s[1],t[14]=s[2],t[15]=1,t}function GRe(t,e,s,i,r){const n=e[0],o=e[1],a=e[2],l=e[3],u=n+n,c=o+o,h=a+a,m=n*u,f=n*c,g=n*h,v=o*c,b=o*h,w=a*h,S=l*u,T=l*c,P=l*h,I=i[0],A=i[1],D=i[2],k=r[0],R=r[1],O=r[2],z=(1-(v+w))*I,q=(f+P)*I,U=(g-T)*I,V=(f-P)*A,B=(1-(m+w))*A,H=(b+S)*A,W=(g+T)*D,ie=(b-S)*D,se=(1-(m+v))*D;return t[0]=z,t[1]=q,t[2]=U,t[3]=0,t[4]=V,t[5]=B,t[6]=H,t[7]=0,t[8]=W,t[9]=ie,t[10]=se,t[11]=0,t[12]=s[0]+k-(z*k+V*R+W*O),t[13]=s[1]+R-(q*k+B*R+ie*O),t[14]=s[2]+O-(U*k+H*R+se*O),t[15]=1,t}function zRe(t,e){const s=e[0],i=e[1],r=e[2],n=e[3],o=s+s,a=i+i,l=r+r,u=s*o,c=i*o,h=i*a,m=r*o,f=r*a,g=r*l,v=n*o,b=n*a,w=n*l;return t[0]=1-h-g,t[1]=c+w,t[2]=m-b,t[3]=0,t[4]=c-w,t[5]=1-u-g,t[6]=f+v,t[7]=0,t[8]=m+b,t[9]=f-v,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function URe(t,e,s,i,r,n,o){const a=1/(s-e),l=1/(r-i),u=1/(n-o);return t[0]=2*n*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*n*l,t[6]=0,t[7]=0,t[8]=(s+e)*a,t[9]=(r+i)*l,t[10]=(o+n)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*n*2*u,t[15]=0,t}function BRe(t,e,s,i,r){const n=1/Math.tan(e/2);let o;return t[0]=n/s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t}function jRe(t,e,s,i){const r=Math.tan(e.upDegrees*Math.PI/180),n=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),u=2/(r+n);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(r-n)*u*.5,t[10]=i/(s-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*s/(s-i),t[15]=0,t}function HRe(t,e,s,i,r,n,o){const a=1/(e-s),l=1/(i-r),u=1/(n-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+s)*a,t[13]=(r+i)*l,t[14]=(o+n)*u,t[15]=1,t}function YRe(t,e,s,i){const r=e[0],n=e[1],o=e[2];let a=r-s[0],l=n-s[1],u=o-s[2];const c=_a();if(Math.abs(a)<c&&Math.abs(l)<c&&Math.abs(u)<c)return void c$(t);let h=1/Math.sqrt(a*a+l*l+u*u);a*=h,l*=h,u*=h;const m=i[0],f=i[1],g=i[2];let v=f*u-g*l,b=g*a-m*u,w=m*l-f*a;h=Math.sqrt(v*v+b*b+w*w),h?(h=1/h,v*=h,b*=h,w*=h):(v=0,b=0,w=0);let S=l*w-u*b,T=u*v-a*w,P=a*b-l*v;h=Math.sqrt(S*S+T*T+P*P),h?(h=1/h,S*=h,T*=h,P*=h):(S=0,T=0,P=0),t[0]=v,t[1]=S,t[2]=a,t[3]=0,t[4]=b,t[5]=T,t[6]=l,t[7]=0,t[8]=w,t[9]=P,t[10]=u,t[11]=0,t[12]=-(v*r+b*n+w*o),t[13]=-(S*r+T*n+P*o),t[14]=-(a*r+l*n+u*o),t[15]=1}function XRe(t,e,s,i){const r=e[0],n=e[1],o=e[2],a=i[0],l=i[1],u=i[2];let c=r-s[0],h=n-s[1],m=o-s[2],f=c*c+h*h+m*m;f>0&&(f=1/Math.sqrt(f),c*=f,h*=f,m*=f);let g=l*m-u*h,v=u*c-a*m,b=a*h-l*c;return f=g*g+v*v+b*b,f>0&&(f=1/Math.sqrt(f),g*=f,v*=f,b*=f),t[0]=g,t[1]=v,t[2]=b,t[3]=0,t[4]=h*b-m*v,t[5]=m*g-c*b,t[6]=c*v-h*g,t[7]=0,t[8]=c,t[9]=h,t[10]=m,t[11]=0,t[12]=r,t[13]=n,t[14]=o,t[15]=1,t}function WRe(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function ZRe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function QRe(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t[3]=e[3]+s[3],t[4]=e[4]+s[4],t[5]=e[5]+s[5],t[6]=e[6]+s[6],t[7]=e[7]+s[7],t[8]=e[8]+s[8],t[9]=e[9]+s[9],t[10]=e[10]+s[10],t[11]=e[11]+s[11],t[12]=e[12]+s[12],t[13]=e[13]+s[13],t[14]=e[14]+s[14],t[15]=e[15]+s[15],t}function Dhe(t,e,s){return t[0]=e[0]-s[0],t[1]=e[1]-s[1],t[2]=e[2]-s[2],t[3]=e[3]-s[3],t[4]=e[4]-s[4],t[5]=e[5]-s[5],t[6]=e[6]-s[6],t[7]=e[7]-s[7],t[8]=e[8]-s[8],t[9]=e[9]-s[9],t[10]=e[10]-s[10],t[11]=e[11]-s[11],t[12]=e[12]-s[12],t[13]=e[13]-s[13],t[14]=e[14]-s[14],t[15]=e[15]-s[15],t}function JRe(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12]*s,t[13]=e[13]*s,t[14]=e[14]*s,t[15]=e[15]*s,t}function KRe(t,e,s,i){return t[0]=e[0]+s[0]*i,t[1]=e[1]+s[1]*i,t[2]=e[2]+s[2]*i,t[3]=e[3]+s[3]*i,t[4]=e[4]+s[4]*i,t[5]=e[5]+s[5]*i,t[6]=e[6]+s[6]*i,t[7]=e[7]+s[7]*i,t[8]=e[8]+s[8]*i,t[9]=e[9]+s[9]*i,t[10]=e[10]+s[10]*i,t[11]=e[11]+s[11]*i,t[12]=e[12]+s[12]*i,t[13]=e[13]+s[13]*i,t[14]=e[14]+s[14]*i,t[15]=e[15]+s[15]*i,t}function eke(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function tke(t,e){if(t===e)return!0;const s=t[0],i=t[1],r=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],m=t[10],f=t[11],g=t[12],v=t[13],b=t[14],w=t[15],S=e[0],T=e[1],P=e[2],I=e[3],A=e[4],D=e[5],k=e[6],R=e[7],O=e[8],z=e[9],q=e[10],U=e[11],V=e[12],B=e[13],H=e[14],W=e[15],ie=_a();return Math.abs(s-S)<=ie*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(i-T)<=ie*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(r-P)<=ie*Math.max(1,Math.abs(r),Math.abs(P))&&Math.abs(n-I)<=ie*Math.max(1,Math.abs(n),Math.abs(I))&&Math.abs(o-A)<=ie*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(a-D)<=ie*Math.max(1,Math.abs(a),Math.abs(D))&&Math.abs(l-k)<=ie*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(u-R)<=ie*Math.max(1,Math.abs(u),Math.abs(R))&&Math.abs(c-O)<=ie*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(h-z)<=ie*Math.max(1,Math.abs(h),Math.abs(z))&&Math.abs(m-q)<=ie*Math.max(1,Math.abs(m),Math.abs(q))&&Math.abs(f-U)<=ie*Math.max(1,Math.abs(f),Math.abs(U))&&Math.abs(g-V)<=ie*Math.max(1,Math.abs(g),Math.abs(V))&&Math.abs(v-B)<=ie*Math.max(1,Math.abs(v),Math.abs(B))&&Math.abs(b-H)<=ie*Math.max(1,Math.abs(b),Math.abs(H))&&Math.abs(w-W)<=ie*Math.max(1,Math.abs(w),Math.abs(W))}function ske(t){const e=_a(),s=t[0],i=t[1],r=t[2],n=t[4],o=t[5],a=t[6],l=t[8],u=t[9],c=t[10];return Math.abs(1-(s*s+n*n+l*l))<=e&&Math.abs(1-(i*i+o*o+u*u))<=e&&Math.abs(1-(r*r+a*a+c*c))<=e}function ike(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const rke=Ahe,nke=Dhe;Object.freeze(Object.defineProperty({__proto__:null,add:QRe,adjoint:xRe,copy:Ihe,determinant:wRe,equals:tke,exactEquals:eke,frob:ZRe,fromQuat:zRe,fromQuat2:kRe,fromRotation:NRe,fromRotationTranslation:Nhe,fromRotationTranslationScale:qRe,fromRotationTranslationScaleOrigin:GRe,fromScaling:ARe,fromTranslation:MRe,fromXRotation:DRe,fromYRotation:$Re,fromZRotation:RRe,frustum:URe,getRotation:VRe,getScaling:LRe,getTranslation:ORe,hasIdentityRotation:ike,identity:c$,invert:Mhe,invertOrIdentity:bRe,isOrthoNormal:ske,lookAt:YRe,mul:rke,multiply:Ahe,multiplyScalar:JRe,multiplyScalarAndAdd:KRe,ortho:HRe,perspective:BRe,perspectiveFromFieldOfView:jRe,rotate:CRe,rotateX:PRe,rotateY:TRe,rotateZ:IRe,scale:ERe,set:fg,str:WRe,sub:nke,subtract:Dhe,targetTo:XRe,translate:SRe,transpose:gg},Symbol.toStringTag,{value:"Module"}));const oke=(t,e)=>{const s=fg(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return gg(s,s)},ake=(t,e)=>{const s=fg(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return gg(s,s)},lke=(t,e)=>{const s=1-e,i=fg(t,.2126+.7874*s,.7152-.7152*s,.0722-.0722*s,0,.2126-.2126*s,.7152+.2848*s,.0722-.0722*s,0,.2126-.2126*s,.7152-.7152*s,.0722+.9278*s,0,0,0,0,1);return gg(i,i)},uke=(t,e)=>{const s=Math.sin(e*Math.PI/180),i=Math.cos(e*Math.PI/180),r=fg(t,.213+.787*i-.213*s,.715-.715*i-.715*s,.072-.072*i+.928*s,0,.213-.213*i+.143*s,.715+.285*i+.14*s,.072-.072*i-.283*s,0,.213-.213*i-.787*s,.715-.715*i+.715*s,.072+.928*i+.072*s,0,0,0,0,1);return gg(r,r)},cke=(t,e)=>{const s=1-2*e,i=fg(t,s,0,0,e,0,s,0,e,0,0,s,e,0,0,0,1);return gg(i,i)},hke=(t,e)=>{const s=fg(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return gg(s,s)},mke=(t,e)=>{const s=1-e,i=fg(t,.393+.607*s,.769-.769*s,.189-.189*s,0,.349-.349*s,.686+.314*s,.168-.168*s,0,.272-.272*s,.534-.534*s,.131+.869*s,0,0,0,0,1);return gg(i,i)};let $he=class Rhe{constructor(e,s,i){this.strength=e,this.radius=s,this.threshold=i,this.type="bloom"}interpolate(e,s,i){this.strength=Ua(e.strength,s.strength,i),this.radius=Ua(e.radius,s.radius,i),this.threshold=Ua(e.threshold,s.threshold,i)}clone(){return new Rhe(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:JS(this.radius),strength:this.strength,threshold:this.threshold}}},khe=class Fhe{constructor(e){this.radius=e,this.type="blur"}interpolate(e,s,i){this.radius=Math.round(Ua(e.radius,s.radius,i))}clone(){return new Fhe(this.radius)}toJSON(){return{type:"blur",radius:JS(this.radius)}}},s6=class Ohe{constructor(e,s){this.type=e,this.amount=s,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,s,i){this.amount=Ua(e.amount,s.amount,i),this._updateMatrix()}clone(){return new Ohe(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const e=this._colorMatrix||l$();switch(this.type){case"brightness":this._colorMatrix=oke(e,this.amount);break;case"contrast":this._colorMatrix=ake(e,this.amount);break;case"grayscale":this._colorMatrix=lke(e,this.amount);break;case"invert":this._colorMatrix=cke(e,this.amount);break;case"saturate":this._colorMatrix=hke(e,this.amount);break;case"sepia":this._colorMatrix=mke(e,this.amount)}}},Lhe=class Vhe{constructor(e,s,i,r){this.offsetX=e,this.offsetY=s,this.blurRadius=i,this.color=r,this.type="drop-shadow"}interpolate(e,s,i){this.offsetX=Ua(e.offsetX,s.offsetX,i),this.offsetY=Ua(e.offsetY,s.offsetY,i),this.blurRadius=Ua(e.blurRadius,s.blurRadius,i),this.color[0]=Math.round(Ua(e.color[0],s.color[0],i)),this.color[1]=Math.round(Ua(e.color[1],s.color[1],i)),this.color[2]=Math.round(Ua(e.color[2],s.color[2],i)),this.color[3]=Ua(e.color[3],s.color[3],i)}clone(){return new Vhe(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const e=[...this.color];return e[3]*=255,{type:"drop-shadow",xoffset:JS(this.offsetX),yoffset:JS(this.offsetY),blurRadius:JS(this.blurRadius),color:e}}},qhe=class Ghe{constructor(e){this.angle=e,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,s,i){this.angle=Ua(e.angle,s.angle,i),this._updateMatrix()}clone(){return new Ghe(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const e=this._colorMatrix||l$();this._colorMatrix=uke(e,this.angle)}},zhe=class Uhe{constructor(e){this.amount=e,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(e,s,i){this.amount=Ua(e.amount,s.amount,i)}clone(){return new Uhe(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function Ua(t,e,s){return t+(e-t)*s}function JS(t){return Math.round(1e3*Zl(t))/1e3}function dke(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new s6(t.type,0);case"saturate":case"brightness":case"contrast":return new s6(t.type,1);case"opacity":return new zhe(1);case"hue-rotate":return new qhe(0);case"blur":return new khe(0);case"drop-shadow":return new Lhe(0,0,0,[...C7("transparent")]);case"bloom":return new $he(0,0,1)}}function pke(t,e){const s=t.length>e.length?t:e;return(t.length>e.length?e:t).every((i,r)=>i.type===s[r].type)}function fke(t,e){const s=t.length>e.length?t:e,i=t.length>e.length?e:t;for(let r=i.length;r<s.length;r++)i.push(dke(s[r]))}function gke(t){const e=t[0];return!!e&&"type"in e}const R4=()=>Ne.getLogger("esri.support.basemapUtils");function yke(){return{}}function _ke(t){for(const e in t){const s=t[e];ii(s),delete t[e]}}function vke(t,e){let s;if(typeof t=="string"){const i=t in J5,r=!i&&t.includes("/");if(!i&&!r){if(Ds.apiKey)R4().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const n=Object.entries(J5).filter(([o,a])=>a.classic||a.is3d).map(([o])=>`"${o}"`).sort().join(", ");R4().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${n}`)}return null}e&&(s=e[t]),s||(s=i?QS.fromId(t):new QS({style:{id:t}}),e&&(e[t]=s))}else s=nn(QS,t);return s!=null&&s.destroyed&&(R4().warn("The provided basemap is already destroyed",{basemap:s}),s=null),s}function bke(t){return new ME({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const s=[];return"tables"in e&&s.push(e.tables),"layers"in e&&s.push(e.layers),s},itemFilterFunction:e=>{const s=e.parent;return!!s&&"tables"in s&&s.tables.includes(e)}})}function k4(t){for(const e of t.values())e==null||e.destroy();t.clear()}const lQ={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function xke(t){let e=null;if(typeof t=="string")if(t in lQ){const s=lQ[t];e=new n3({resourceInfo:{data:{layers:[s]}}})}else Ne.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=nn(n3,t);return e}let Bhe=0;const jhe=t=>{let e=class extends t{constructor(...s){super(...s),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+Bhe++})}};return e=p([Q("esri.core.Identifiable")],e),e},wke=t=>{let e=class extends t{constructor(...s){super(...s),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Bhe++})}};return e=p([Q("esri.core.Identifiable.NumericIdentifiable")],e),e};let I2=class extends jhe(class{}){};I2=p([Q("esri.core.Identifiable")],I2),function(t){t.IdentifiableMixin=jhe,t.NumericIdentifiableMixin=wke}(I2||(I2={}));const sh=I2;async function Ske(t){var i;const e="portalItem"in t?t:{portalItem:t},{fromItem:s}=await me(async()=>{const{fromItem:r}=await import("./portalLayers-C6so4ZSM.js");return{fromItem:r}},__vite__mapDeps([152,150,149,148,151]));try{return await s(e)}catch(r){const n=e==null?void 0:e.portalItem,o=(n==null?void 0:n.id)||"unset",a=((i=n==null?void 0:n.portal)==null?void 0:i.url)||Ds.portalUrl;throw Ne.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+a+"', id: '"+o+"')",r),r}}const i6={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function F4(t,e,s,i=Gu){const r=new el(m7(i)),n=Je.fromJSDate(t,{zone:r}),o=s==="decades"||s==="centuries"?"year":Yhe(s);return s==="decades"&&(e*=10),s==="centuries"&&(e*=100),n.plus({[o]:e}).toJSDate()}function Qmt(t,e,s="milliseconds"){const i=t.getTime(),r=Hhe(e,s,"milliseconds");return new Date(i+r)}function uQ(t,e,s=Gu){const i=new el(m7(s)),r=Je.fromJSDate(t,{zone:i});if(e==="decades"||e==="centuries"){const o=r.startOf("year"),{year:a}=o,l=a-a%(e==="decades"?10:100);return o.set({year:l}).toJSDate()}const n=Yhe(e);return r.startOf(n).toJSDate()}function Hhe(t,e,s){return t===0?0:t*i6[e]/i6[s]}function Jmt(t,e){return t&&e?t.intersection(e):t||e}function Yhe(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var gu;let Dl=gu=class extends Te{static get allTime(){return cQ}static get empty(){return Eke}static fromArray(t){return new gu({start:t[0]!=null?new Date(t[0]):t[0],end:t[1]!=null?new Date(t[1]):t[1]})}constructor(t){super(t),this.end=null,this.start=null}readEnd(t,e){return e.end!=null?new Date(e.end):null}writeEnd(t,e){e.end=(t==null?void 0:t.getTime())??null}get isAllTime(){return this.equals(gu.allTime)}get isEmpty(){return this.equals(gu.empty)}readStart(t,e){return e.start!=null?new Date(e.start):null}writeStart(t,e){e.start=(t==null?void 0:t.getTime())??null}clone(){return new gu({end:this.end,start:this.start})}equals(t){var n,o,a,l;if(!t)return!1;const e=((n=this.start)==null?void 0:n.getTime())??this.start,s=((o=this.end)==null?void 0:o.getTime())??this.end,i=((a=t.start)==null?void 0:a.getTime())??t.start,r=((l=t.end)==null?void 0:l.getTime())??t.end;return e===i&&s===r}expandTo(t,e=Gu){if(this.isEmpty||this.isAllTime)return this.clone();let s=this.start;s&&(s=uQ(s,t,e));let i=this.end;if(i){const r=uQ(i,t,e);i=i.getTime()===r.getTime()?r:F4(r,1,t,e)}return new gu({start:s,end:i})}intersection(t){var a,l,u,c;if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return gu.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const e=((a=this.start)==null?void 0:a.getTime())??-1/0,s=((l=this.end)==null?void 0:l.getTime())??1/0,i=((u=t.start)==null?void 0:u.getTime())??-1/0,r=((c=t.end)==null?void 0:c.getTime())??1/0;let n,o;return i>=e&&i<=s?n=i:e>=i&&e<=r&&(n=e),s>=i&&s<=r?o=s:r>=e&&r<=s&&(o=r),n==null||o==null||isNaN(n)||isNaN(o)?gu.empty:new gu({start:n===-1/0?null:new Date(n),end:o===1/0?null:new Date(o)})}offset(t,e,s=Gu){if(this.isEmpty||this.isAllTime)return this.clone();const i=new gu,{start:r,end:n}=this;return r!=null&&(i.start=F4(r,t,e,s)),n!=null&&(i.end=F4(n,t,e,s)),i}toArray(){var t,e;return this.isEmpty?[void 0,void 0]:[((t=this.start)==null?void 0:t.getTime())??null,((e=this.end)==null?void 0:e.getTime())??null]}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return cQ.clone();const e=this.start!=null&&t.start!=null?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,s=this.end!=null&&t.end!=null?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new gu({start:e,end:s})}};p([_({type:Date,json:{write:{allowNull:!0}}})],Dl.prototype,"end",void 0),p([qe("end")],Dl.prototype,"readEnd",null),p([Ue("end")],Dl.prototype,"writeEnd",null),p([_({readOnly:!0,json:{read:!1}})],Dl.prototype,"isAllTime",null),p([_({readOnly:!0,json:{read:!1}})],Dl.prototype,"isEmpty",null),p([_({type:Date,json:{write:{allowNull:!0}}})],Dl.prototype,"start",void 0),p([qe("start")],Dl.prototype,"readStart",null),p([Ue("start")],Dl.prototype,"writeStart",null),Dl=gu=p([Q("esri.time.TimeExtent")],Dl);const Ad=Dl,cQ=new Dl,Eke=new Dl({start:void 0,end:void 0});let Cke=0,gr=class extends Wl.EventedMixin(sh.IdentifiableMixin(Jh)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Hs(-180,-90,180,90,St.WGS84),this.id=Date.now().toString(16)+"-layer-"+Cke++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=St.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const s=typeof e=="string"?{url:e}:e;return(await me(async()=>{const{fromUrl:i}=await import("./arcgisLayers-o8j3RCAI.js");return{fromUrl:i}},__vite__mapDeps([153,150,149,151]))).fromUrl(s)}static fromPortalItem(e){return Ske(e)}initialize(){this.when().catch(e=>{Lr(e)||Ne.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const e=this.parent;if(e){const s=this;"layers"in e&&e.layers.includes(s)?e.layers.remove(s):"tables"in e&&e.tables.includes(s)?e.tables.remove(s):"baseLayers"in e&&e.baseLayers.includes(s)?e.baseLayers.remove(s):"referenceLayers"in e&&e.referenceLayers.includes(s)&&e.referenceLayers.remove(s),this._set("parent",null)}}get effectiveVisible(){let e=this.visible;const s=this.parent;return e&&s&&"effectiveVisible"in s&&e&&(e=s.effectiveVisible),e}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return Sr(this.url)}createLayerView(e,s){return Promise.reject(new ae("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await js(e,{query:{f:"json"},responseType:"json"})).data;throw new ae("layer:no-attribution-data","Layer does not have attribution data")}};p([_({type:String})],gr.prototype,"attributionDataUrl",void 0),p([_({readOnly:!0})],gr.prototype,"effectiveVisible",null),p([_({type:Hs})],gr.prototype,"fullExtent",void 0),p([_({readOnly:!0})],gr.prototype,"hasAttributionData",null),p([_({type:String,clonable:!1})],gr.prototype,"id",void 0),p([_({type:Boolean,nonNullable:!0})],gr.prototype,"legendEnabled",void 0),p([_({type:["show","hide","hide-children"]})],gr.prototype,"listMode",void 0),p([_({type:Number,range:{min:0,max:1},nonNullable:!0})],gr.prototype,"opacity",void 0),p([_({clonable:!1})],gr.prototype,"parent",void 0),p([_({readOnly:!0})],gr.prototype,"parsedUrl",null),p([_({type:Boolean,readOnly:!0})],gr.prototype,"persistenceEnabled",void 0),p([_({type:Boolean})],gr.prototype,"popupEnabled",void 0),p([_({type:Boolean})],gr.prototype,"attributionVisible",void 0),p([_({type:St})],gr.prototype,"spatialReference",void 0),p([_({type:String})],gr.prototype,"title",void 0),p([_({readOnly:!0,json:{read:!1}})],gr.prototype,"type",void 0),p([_()],gr.prototype,"url",void 0),p([_({type:Ad})],gr.prototype,"visibilityTimeExtent",void 0),p([_({type:Boolean,nonNullable:!0})],gr.prototype,"visible",void 0),gr=p([Q("esri.layers.Layer")],gr);const XC=gr;function r6(t,e,s){let i,r;if(t)for(let n=0,o=t.length;n<o;n++){if(i=t.at(n),(i==null?void 0:i[e])===s)return i;if((i==null?void 0:i.type)==="group"&&(r=r6(i.layers,e,s),r))return r}}const Pke=t=>{let e=class extends t{constructor(...s){super(...s),this.layers=new Ge;const i=o=>{o.parent&&"remove"in o.parent&&o.parent.remove(o)},r=o=>{o.parent=this,this.layerAdded(o),o.type!=="elevation"&&o.type!=="base-elevation"||Ne.getLogger(this).error(`Layer 'title:${o.title}, id:${o.id}' of type '${o.type}' is not supported as an operational layer and will therefore be ignored.`)},n=o=>{o.parent=null,this.layerRemoved(o)};this.addHandles([this.layers.on("before-add",o=>{if(o.item===this)return o.preventDefault(),void Ne.getLogger(this).error("#add()","Cannot add layer to itself.");i(o.item)}),this.layers.on("after-add",o=>r(o.item)),this.layers.on("after-remove",o=>n(o.item))])}destroy(){const s=this.layers.toArray();for(const i of s)i.destroy();this.layers.destroy()}set layers(s){this._set("layers",Md(s,this._get("layers")))}add(s,i){const r=this.layers;if(i=r.getNextIndex(i),s instanceof XC){const n=s;n.parent===this?this.reorder(n,i):r.add(n,i)}else sm(s)?s.then(n=>{this.destroyed||this.add(n,i)}):Ne.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(s,i){const r=this.layers;let n=r.getNextIndex(i);s.slice().forEach(o=>{o.parent!==this?(r.add(o,n),n+=1):this.reorder(o,n)})}findLayerById(s){return r6(this.layers,"id",s)}findLayerByUid(s){return r6(this.layers,"uid",s)}remove(s){return this.layers.remove(s)}removeMany(s){return this.layers.removeMany(s)}removeAll(){return this.layers.removeAll()}reorder(s,i){return this.layers.reorder(s,i)}layerAdded(s){}layerRemoved(s){}};return p([_()],e.prototype,"layers",null),e=p([Q("esri.support.LayersMixin")],e),e},Tke=new Set(["feature","subtype-group"]);function n6(t,e,s){if(t)for(let i=0,r=t.length;i<r;i++){const n=t.at(i);if(n[e]===s)return n;if((n==null?void 0:n.type)==="group"){const o=n6(n.tables,e,s);if(o)return o}}}const Ike=t=>{let e=class extends t{constructor(...s){super(...s),this.tables=new Ge,this.addHandles([this.tables.on("after-add",i=>{const r=i.item;r.parent&&r.parent!==this&&"tables"in r.parent&&r.parent.tables.remove(r),r.parent=this,Tke.has(r.type)||Ne.getLogger(this).error(`Layer 'title:${r.title}, id:${r.id}' of type '${r.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",i=>{i.item.parent=null})])}destroy(){const s=this.tables.toArray();for(const i of s)i.destroy();this.tables.destroy()}set tables(s){this._set("tables",Md(s,this._get("tables")))}findTableById(s){return n6(this.tables,"id",s)}findTableByUid(s){return n6(this.tables,"uid",s)}};return p([_()],e.prototype,"tables",null),e=p([Q("esri.support.TablesMixin")],e),e};let uc=class extends Ike(Pke(Wl.EventedMixin(Ye))){constructor(e){super(e),this.allLayers=new ME({getCollections:()=>{var s,i,r;return[(s=this.basemap)==null?void 0:s.baseLayers,(i=this.ground)==null?void 0:i.layers,this.layers,(r=this.basemap)==null?void 0:r.referenceLayers]},getChildrenFunction:s=>"layers"in s?s.layers:null}),this.allTables=bke(this),this.basemap=null,this.editableLayers=new ME({getCollections:()=>[this.allLayers],itemFilterFunction:lRe}),this.ground=new n3,this._basemapCache=yke()}destroy(){_ke(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=ii(this.basemap),ii(this.ground),this._set("ground",null)}castBasemap(e){return vke(e,this._basemapCache)}castGround(e){return xke(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(s=>s.id===e)}findTableById(e){return this.allTables.find(s=>s.id===e)}};p([_({readOnly:!0,dependsOn:[]})],uc.prototype,"allLayers",void 0),p([_({readOnly:!0})],uc.prototype,"allTables",void 0),p([_({type:QS,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],uc.prototype,"basemap",void 0),p([Ht("basemap")],uc.prototype,"castBasemap",null),p([_({readOnly:!0})],uc.prototype,"editableLayers",void 0),p([_({type:n3,nonNullable:!0})],uc.prototype,"ground",void 0),p([Ht("ground")],uc.prototype,"castGround",null),p([_()],uc.prototype,"undoRedo",void 0),uc=p([Q("esri.Map")],uc);const Xhe=uc;let KS=class extends Ge{constructor(e){super(e),this.addHandles([this.on("before-add",s=>{s.item==null&&s.preventDefault()}),this.on("after-add",s=>this._own(s.item)),this.on("after-remove",s=>this._release(s.item))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(Ge.ofType(this.itemType.Type))(e):new Ge(e)}};function o6(t,e){return{type:t,cast:ghe,set(s){const i=Md(s,this._get(e),t);i.owner=this,this._set(e,i)}}}p([_()],KS.prototype,"owner",null),KS=p([Q("esri.core.support.OwningCollection")],KS);var M2;const o3=Xn()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),Whe=o3.jsonValues.slice();YSe(Whe,"orthometric");const eE=Xn()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let cc=M2=class extends Te{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,s){return o3.write(t,e,s)}readHeightModel(t,e,s){return o3.read(t)||(s!=null&&s.messages&&s.messages.push(Mke(t,{context:s})),null)}readHeightUnit(t,e,s){return eE.read(t)||(s!=null&&s.messages&&s.messages.push(hQ(t,{context:s})),null)}readHeightUnitService(t,e,s){return Gz(t)||eE.read(t)||(s!=null&&s.messages&&s.messages.push(hQ(t,{context:s})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new M2({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const s=Tle(e);return new M2({heightModel:t.heightModel,heightUnit:s??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new M2;return e.read(t,{origin:"web-scene"}),e}};function hQ(t,e){return new qu("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function Mke(t,e){return new qu("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}p([_({type:o3.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:Whe,default:"ellipsoidal",write:{isRequired:!0}}}}})],cc.prototype,"heightModel",void 0),p([Ue("web-scene","heightModel")],cc.prototype,"writeHeightModel",null),p([qe(["web-scene","service"],"heightModel")],cc.prototype,"readHeightModel",null),p([_({type:eE.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:eE.jsonValues,write:{writer:eE.write,isRequired:!0}}}}})],cc.prototype,"heightUnit",void 0),p([qe("web-scene","heightUnit")],cc.prototype,"readHeightUnit",null),p([qe("service","heightUnit")],cc.prototype,"readHeightUnitService",null),p([_({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],cc.prototype,"vertCRS",void 0),p([qe("service","vertCRS",["vertCRS","ellipsoid","geoid"])],cc.prototype,"readVertCRS",null),cc=M2=p([Q("esri.geometry.HeightModelInfo")],cc);const WC=cc;let a3=class extends KS{constructor(e){super(e),this.addHandles(this.on("before-add",s=>{s.item!=null&&s.item.parent===this.owner&&(Ne.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),s.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};a3=p([Q("esri.support.AnalysesCollection")],a3);let O4;async function Ake(){return O4==null&&(O4=me(()=>import("./WhereClauseCache-DPX74x27.js"),__vite__mapDeps([17,18])).then(t=>new t.WhereClauseCache(500,500))),O4}async function Zhe(t,e){const s=await Ake(),i=s.get(t,e);if(i==null)throw s.getError(t,e);return i}function Nke(t,e){return t||(t=null),e||(e=null),t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function Dke(t,e){return t||(t=null),e||(e=null),t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function idt(t,e){return e.length===0?null:`${t} IN (${$ke(e)})`}function $ke(t){return t.map(e=>typeof e=="string"?Rke(e):e).join(",")}function Rke(t){return`'${t.replaceAll("'","''")}'`}function mQ(t){return typeof t=="number"}function rdt(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function ndt(t){return typeof t=="boolean"}function ZC(t){return typeof t=="string"||t instanceof String}function kke(t){return t==null||ZC(t)}function odt(t){return Array.isArray(t)}function Fke(t){return(t==null?void 0:t.declaredClass)==="esri.Graphic"}function adt(t){return t instanceof Date}const Oke="HH:mm",Lke="HH:mm:ss",Vke="HH:mm:ss.SSS",qke=[Vke,Lke,Oke,"TT"],Gke="yyyy-MM-dd";function dQ(t){if(!t||!ZC(t))return null;const e=Je.fromFormat(t,Gke);return e.isValid?e:null}function pQ(t){return t&&ZC(t)?tCe(qke,e=>{const s=Je.fromFormat(t,e);return s.isValid?s:null})??null:null}function fQ(t){if(!t||!ZC(t))return null;const e=Je.fromISO(t);return e.isValid?e:null}var l3;(function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(l3||(l3={}));const Qhe=new Set(["integer","small-integer","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"]);function zke(t){return t!=null&&Qhe.has(t.type)}function Jhe(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function Khe(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function eme(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const Uke=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);xz(Qhe,Uke);function ldt(t,e){const s=t==null?void 0:t.domain;if(!s||s.type!=="range")return;const i="range"in s?s.range[0]:s.minValue,r="range"in s?s.range[1]:s.maxValue,n=zke(t);return Jhe(t)||eme(t)||Khe(t)?{...Bke(t,r,i),isInteger:n}:{min:i!=null&&typeof i=="number"?i:null,max:r!=null&&typeof r=="number"?r:null,rawMin:i,rawMax:r,isInteger:n}}function Bke(t,e,s){var i,r,n,o,a,l;return Jhe(t)?{min:(i=dQ(s))==null?void 0:i.toMillis(),max:(r=dQ(e))==null?void 0:r.toMillis(),rawMin:s,rawMax:e}:eme(t)?{min:(n=pQ(s))==null?void 0:n.toMillis(),max:(o=pQ(e))==null?void 0:o.toMillis(),rawMin:s,rawMax:e}:Khe(t)?{min:(a=fQ(s))==null?void 0:a.toMillis(),max:(l=fQ(e))==null?void 0:l.toMillis(),rawMin:s,rawMax:e}:{max:null,min:null}}function jke(t){if(!t)return;const e=t.match(Hke);return e!=null&&e.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const Hke=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-zA-Z_][a-zA-Z0-9_]*))$/i;function Yke(t){var e,s;return((s=(e=t.match(Xke))==null?void 0:e[1])==null?void 0:s.replace(/\\'/g,"'"))??null}const Xke=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let Dc=class{};function Wke(t){return t instanceof g0?t===Dc.instance:(t==null?void 0:t.toString().toLowerCase())==="unknown"}function cdt(t){return Wke(t)?Dc.instance:t}Dc.instance=new el("Etc/UTC");var u3;(function(t){t.TimeZoneNotRecognized="TimeZoneNotRecognized"})(u3||(u3={}));const Zke={[u3.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};let Qke=class tme extends Error{constructor(e,s){super(jc(Zke[e],s)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,tme)}};function p1(t,e,s){return t<e?t-e:t>s?t-s:0}function f1(t,e,s){return t<e?e:t>s?s:t}let u_=class $r{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,s=1,i=1,r=0,n=0,o=0,a=0,l){if(isNaN(e)||isNaN(s)||isNaN(i)||isNaN(r)||isNaN(n)||isNaN(o)||isNaN(a))return null;const u=Je.local(e,s).daysInMonth;let c=Je.fromObject({day:f1(i,1,u),year:e,month:f1(s,1,12),hour:f1(r,0,23),minute:f1(n,0,59),second:f1(o,0,59),millisecond:f1(a,0,999)},{zone:Fh(l)});return c=c.plus({months:p1(s,1,12),days:p1(i,1,u),hours:p1(r,0,23),minutes:p1(n,0,59),seconds:p1(o,0,59),milliseconds:p1(a,0,999)}),new $r(c)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,s){const i=Fh(s);return e.isUnknownTimeZone||i===Dc.instance?$r.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,i):new $r(e._date.setZone(i))}static dateJSToArcadeDate(e){return new $r(Je.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,s="system"){const i=Fh(s);return new $r(Je.fromJSDate(e,{zone:i}))}static unknownEpochToArcadeDate(e){return new $r(Je.fromMillis(e,{zone:Dc.instance}))}static unknownDateJSToArcadeDate(e){return new $r(Je.fromMillis(e.getTime(),{zone:Dc.instance}))}static epochToArcadeDate(e,s="system"){const i=Fh(s);return new $r(Je.fromMillis(e,{zone:i}))}static dateTimeToArcadeDate(e){return new $r(e)}clone(){return new $r(this._date)}changeTimeZone(e){const s=Fh(e);return $r.dateTimeToArcadeDate(this._date.setZone(s))}static dateTimeAndZoneToArcadeDate(e,s){const i=Fh(s);return e.zone===Dc.instance||i===Dc.instance?$r.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,i):new $r(e.setZone(i))}static nowToArcadeDate(e){const s=Fh(e);return new $r(Je.fromJSDate(new Date,{zone:s}))}static nowUTCToArcadeDate(){return new $r(Je.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===$r.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===Dc.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const e=this.zone;return e.type==="fixed"?e.fixed===0?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new $r(this._date.plus(e))}diff(e,s="milliseconds"){return this._date.diff(e._date,s)[s]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,s){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:s&&!this.isUnknownTimeZone})}toFormat(e,s){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,s)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new $r(this._date.toUTC())}toLocal(){return new $r(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const s=Je.fromISO(e,{setZone:!0});return new $r(s)}};function Fh(t,e=!0){if(t instanceof g0)return t;if(t.toLowerCase()==="system")return"system";if(t.toLowerCase()==="utc")return"UTC";if(t.toLowerCase()==="unknown")return Dc.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(t)){const i=en.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(i)return i}const s=el.create(t);if(!s.isValid){if(e)throw new Qke(u3.TimeZoneNotRecognized);return null}return s}const Jke=()=>Ne.getLogger("esri.support.arcadeOnDemand"),Kke=["geometry","scale","timeProperties"];function hdt(t,e){if(e!=null)for(const s of Kke)e.hasArcadeDependency(s)&&t.add(s);return t}let L4;function Zc(){return L4||(L4=(async()=>{const t=await me(()=>import("./arcadeUtils-nnNXR338.js"),__vite__mapDeps([154,155,156,157,26,16,18]));return{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel}})()),L4}const mdt=(t,e,s)=>sme.create(t,e,s,null,["$feature","$view"],[]),eFe=(t,e,s,i)=>sme.create(t,e,s,i,["$feature","$view"],[]);let sme=class ime{constructor(e,s,i,r,n,o,a){this._dependencies=new Map,this.services=null,this.script=e,this.evaluate=r;const l=Array.isArray(o)?o:o==null?void 0:o.fields;this.fields=l??[],this._syntaxTree=i,this._arcade=s,this._arcadeFeature=n,this._spatialReference=a,this._dependencies.set("geometry",s.scriptTouchesGeometry(this._syntaxTree)),this._dependencies.set("scale",this._arcade.referencesMember(this._syntaxTree,"scale")),this._dependencies.set("timeProperties",this._arcade.scriptUsesViewProperties(this._syntaxTree,["timeProperties"]))}static async create(e,s,i,r,n,o){const{arcade:a,Feature:l,Dictionary:u}=await Zc(),c=s instanceof St?s:St.fromJSON(s);let h;try{h=a.parseScript(e,o)}catch(k){return Jke().error(new ae("arcade-bad-expression","Failed to parse arcade script",{script:e,error:k})),null}const m=n.reduce((k,R)=>({...k,[R]:null}),{});let f=null;r!=null&&(f=new u(r),f.immutable=!0,m.$config=null);const g=a.scriptUsesGeometryEngine(h),v=g&&a.enableGeometrySupport(),b=a.scriptUsesFeatureSet(h)&&a.enableFeatureSetSupport(),w=a.scriptIsAsync(h),S=w&&a.enableAsyncSupport(),T={vars:m,spatialReference:c,useAsync:!!S};await Promise.all([v,b,S]);const P=new Set;await a.loadDependentModules(P,h,null,w,g);const I=new u;I.immutable=!1,I.setField("scale",0);const A=a.compileScript(h,T),D=(k,R)=>{var z;const O=(z=k.$view)==null?void 0:z.timeZone;if("$view"in k&&k.$view){let q;if(I.setField("scale",typeof k.$view=="object"&&"scale"in k.$view?k.$view.scale:void 0),typeof k.$view=="object"&&"timeProperties"in k.$view&&k.$view.timeProperties!=null){const{currentStart:U,currentEnd:V}=k.$view.timeProperties;q=new u({currentStart:U!=null?O!=null?u_.epochToArcadeDate(U,O):u_.unknownEpochToArcadeDate(U):void 0,currentEnd:V!=null?O!=null?u_.epochToArcadeDate(V,O):u_.unknownEpochToArcadeDate(V):void 0,startIncluded:!0,endIncluded:!0})}I.setField("timeProperties",q),k.$view=I}return f&&(k.$config=f),A({vars:k,spatialReference:c,services:R,timeZone:O})};return new ime(e,a,h,D,new l,i,c)}repurposeFeature(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}references(e){return this._dependencies.get(e)??!1}};const tFe=/^([0-9_])/,sFe=/[^a-z0-9_\u0080-\uffff]+/gi;function iFe(t){return t==null?null:t.trim().replaceAll(sFe,"_").replace(tFe,"F$1")||null}const rFe=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],nFe=["field","normalizationField"];function c3(t,e){if(t!=null&&e!=null){for(const s of Array.isArray(t)?t:[t])if(gQ(rFe,s,e),"visualVariables"in s&&s.visualVariables)for(const i of s.visualVariables)gQ(nFe,i,e)}}function gQ(t,e,s){if(t)for(const i of t){const r=IC(i,e),n=r&&typeof r!="function"&&s.get(r);n&&Hn(i,n.name,e)}}function M7(t,e){var s;if(t!=null&&((s=e==null?void 0:e.fields)!=null&&s.length))if("startField"in t){const i=e.get(t.startField),r=e.get(t.endField);t.startField=(i==null?void 0:i.name)??null,t.endField=(r==null?void 0:r.name)??null}else{const i=e.get(t.startTimeField),r=e.get(t.endTimeField);t.startTimeField=(i==null?void 0:i.name)??null,t.endTimeField=(r==null?void 0:r.name)??null}}const V4=new Set;function h$(t,e){return t&&e?(V4.clear(),W_(V4,t,e),Array.from(V4).sort()):[]}function W_(t,e,s){var i;if(s)if((i=e==null?void 0:e.fields)!=null&&i.length)if(s.includes("*"))for(const{name:r}of e.fields)t.add(r);else for(const r of s)va(t,e,r);else{if(s.includes("*"))return t.clear(),void t.add("*");for(const r of s)r!=null&&t.add(r)}}function va(t,e,s){if(typeof s=="string")if(e){const i=e.get(s);i&&t.add(i.name)}else t.add(s)}function ddt(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(s=>s.name):e}function pdt(t,e,s=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const i=h$(t,e);return i.length/t.fields.length>=s?["*"]:i}async function Go(t,e,s){var n;if(!s)return;let i;const r=jke(s);if(r)i=[r];else{const{arcadeUtils:o}=await Zc();i=o.extractFieldNames(s,(n=e==null?void 0:e.fields)==null?void 0:n.map(a=>a.name))}for(const o of i)va(t,e,o)}async function A7(t,e,s){if(s&&s!=="1=1"){const i=await Zhe(s,e);if(!i.isStandardized)throw new ae("fieldUtils:collectFilterFields","Where clause is not standardized",{where:s});W_(t,e,i.fieldNames)}}function oFe({displayField:t,fields:e}){return t||(e!=null&&e.length?q4(e,"name-or-title")||q4(e,"unique-identifier")||q4(e,"type-or-category")||aFe(e):null)}function aFe(t){for(const e of t){if(!(e!=null&&e.name))continue;const s=e.name.toLowerCase();if(s.includes("name")||s.includes("title"))return e.name}return null}function q4(t,e){for(const s of t)if(s!=null&&s.valueType&&s.valueType===e)return s.name;return null}async function fdt(t,e){var i;if(!e)return;const s=(i=e.elevationInfo)==null?void 0:i.featureExpressionInfo;return s?s.collectRequiredFields(t,e.fieldsIndex):void 0}function lFe(t,e,s){s.onStatisticExpression?Go(t,e,s.onStatisticExpression.expression):t.add(s.onStatisticField)}async function gdt(t,e,s){if(!e||!s||!("fields"in s))return;const i=[],r=s.popupTemplate;i.push(rme(t,e,r)),s.fields&&i.push(...s.fields.map(async n=>lFe(t,e.fieldsIndex,n))),await Promise.all(i)}async function ydt(t,e){var n,o,a;const{fieldsIndex:s,trackInfo:i}=e;if(!e||!i||!s)return;const r=[(n=i.latestObservations.renderer)==null?void 0:n.collectRequiredFields(t,s),(o=i.previousObservations.renderer)==null?void 0:o.collectRequiredFields(t,s),(a=i.trackLines.renderer)==null?void 0:a.collectRequiredFields(t,s)];i.popupTemplate&&r.push(rme(t,e,i.popupTemplate));for(const l of[i.latestObservations.labelingInfo,i.previousObservations.labelingInfo,i.trackLines.labelingInfo])if(l)for(const u of l)r.push(ame(t,s,u));await Promise.all(r)}async function rme(t,e,s){const i=[];s!=null&&s.expressionInfos&&i.push(...s.expressionInfos.map(n=>Go(t,e.fieldsIndex,n.expression)));const r=s==null?void 0:s.content;if(Array.isArray(r))for(const n of r)n.type==="expression"&&n.expressionInfo&&i.push(Go(t,e.fieldsIndex,n.expressionInfo.expression));await Promise.all(i)}async function _dt(t,e,s){e&&(e.timeInfo&&(s!=null&&s.timeExtent)&&W_(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&W_(t,e.fieldsIndex,[e.floorInfo.floorField]),(s==null?void 0:s.where)!=null&&await A7(t,e.fieldsIndex,s.where))}async function vdt(t,e,s){e&&s&&await Promise.all(s.map(i=>uFe(t,e,i)))}async function uFe(t,e,s){e&&s&&(s.valueExpression?await Go(t,e.fieldsIndex,s.valueExpression):s.field&&va(t,e.fieldsIndex,s.field))}function bdt(t){return t?h$(t.fieldsIndex,nme(t)):[]}function cFe(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?h$(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}async function xdt(t,e,s){if(!e||!s)return;const i=e.fieldsIndex;await Promise.all(s.filters.map(r=>A7(t,i,r.where)))}const hFe=new Set(["oid","global-id","guid"]),mFe=new Set(["oid","global-id"]),dFe=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/perimeter/i,/objectid/i,/_i$/i];function pFe(t){const e=new Set;ome(t).forEach(i=>e.add(i)),cFe(t).forEach(i=>e.add(i.toLowerCase()));const s=t&&"infoFor3D"in t?t.infoFor3D:void 0;return s&&(Object.values(s.assetMapFieldRoles).forEach(i=>e.add(i.toLowerCase())),Object.values(s.transformFieldRoles).forEach(i=>e.add(i.toLowerCase()))),Array.from(e)}function nme(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:s,creatorField:i,editDateField:r,editorField:n}=e;return[s,i,r,n].filter(Boolean)}function ome(t){return nme(t).map(e=>e.toLowerCase())}function fFe(t,e){var s;return t.editable&&!hFe.has(t.type)&&!ome(e).includes(((s=t.name)==null?void 0:s.toLowerCase())??"")}function gFe(t,e){var i;const s=((i=t.name)==null?void 0:i.toLowerCase())??"";return!((e==null?void 0:e.objectIdField)!=null&&s===e.objectIdField.toLowerCase()||(e==null?void 0:e.globalIdField)!=null&&s===e.globalIdField.toLowerCase()||pFe(e).includes(s)||mFe.has(t.type)||dFe.some(r=>r.test(s)))}async function wdt(t,e){const{labelingInfo:s,fieldsIndex:i}=e;s!=null&&s.length&&await Promise.all(s.map(r=>ame(t,i,r)))}async function ame(t,e,s){if(!s)return;const i=s.getLabelExpression(),r=s.where;if(i.type==="arcade")await Go(t,e,i.expression);else{const n=i.expression.match(/{[^}]*}/g);n&&n.forEach(o=>{va(t,e,o.slice(1,-1))})}await A7(t,e,r)}function yFe(t){const e=t.defaultValue;return e!==void 0&&ume(t,e)?e:t.nullable?null:void 0}function Sdt(t){const e=typeof t=="string"?{type:t}:t;return hme(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function lme(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function _Fe(t){return t===null||lme(t)}function vFe(t){return t===null||Number.isInteger(t)}function bFe(){return!0}function ume(t,e){let s;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":s=t.nullable?vFe:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":s=t.nullable?_Fe:lme;break;case"string":case"esriFieldTypeString":s=t.nullable?kke:ZC;break;default:s=bFe}return arguments.length===1?s:s(e)}const xFe=["integer","small-integer","big-integer"],wFe=["single","double"],SFe=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],EFe=["esriFieldTypeSingle","esriFieldTypeDouble"],cme=new Set([...xFe,...SFe]),CFe=new Set([...wFe,...EFe]),PFe=xz(cme,CFe);function TFe(t){return t!=null&&cme.has(t.type)}function N7(t){return t!=null&&PFe.has(t.type)}function hme(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function D7(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function IFe(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function MFe(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function $7(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function yQ(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function _Q(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function Edt(t,e){return AFe(t,e)===null}var h3,m3;function Cdt(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function AFe(t,e){return t==null||t.nullable&&e===null?null:ume(t,e)?N7(t)&&!NFe(t.type,Number(e))?h3.OUT_OF_RANGE:null:m3.INVALID_TYPE}function NFe(t,e){const s=typeof t=="string"?mme(t):t;if(!s)return!1;const i=s.min,r=s.max;return s.isInteger?Number.isInteger(e)&&e>=i&&e<=r:e>=i&&e<=r}function mme(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return DFe;case"esriFieldTypeInteger":case"integer":return $Fe;case"esriFieldTypeBigInteger":case"big-integer":return RFe;case"esriFieldTypeSingle":case"single":return kFe;case"esriFieldTypeDouble":case"double":return FFe}}(function(t){t.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(h3||(h3={})),function(t){t.INVALID_TYPE="type-validation-error::invalid-type"}(m3||(m3={}));const DFe={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},$Fe={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},RFe={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},kFe={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},FFe={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function Pdt(t,e,s){switch(t){case l3.INVALID_CODED_VALUE:return`Value ${s} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case l3.VALUE_OUT_OF_RANGE:return`Value ${s} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case m3.INVALID_TYPE:return`Value ${s} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case h3.OUT_OF_RANGE:{const{min:i,max:r}=mme(e.type);return`Value ${s} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${i} to ${r}`}}}function dme(t,e){return!OFe(t,e,null)}function OFe(t,e,s){if(!(e!=null&&e.attributes)||!t)return!0;const i=new Set(Object.keys(e.attributes));let r=!1;for(const n of t)if(!i.has(n)&&(r=!0,s==null))break;return r}function a6(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}async function Tdt(t,e){const s=new Set;return t!=null&&t.collectRequiredFields&&await t.collectRequiredFields(s,e),Array.from(s).sort()}function R7(t){const e=t==null?void 0:t.match(/{[^}]+}/g);return e?e.map(s=>s.slice(1,-1).split(":")[0].trim()):[]}let eA=class extends Te{constructor(e){super(e),this.type=null}};p([_({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],eA.prototype,"type",void 0),eA=p([Q("esri.popup.content.Content")],eA);const qd=eA,_I=new Jt({asc:"ascending",desc:"descending"});let A2=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.field=null,this.order="ascending"}};p([_({type:String,json:{write:!0}})],A2.prototype,"field",void 0),p([_({type:_I.apiValues,json:{type:_I.jsonValues,read:_I.read,write:_I.write}})],A2.prototype,"order",void 0),A2=p([Q("esri.popup.support.AttachmentsOrderByInfo")],A2);const pme=A2;let Op=class extends Wt.ClonableMixin(qd){constructor(e){super(e),this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};p([_({type:String,json:{write:!0}})],Op.prototype,"description",void 0),p([_({type:["auto","preview","list"],json:{write:!0}})],Op.prototype,"displayType",void 0),p([_({type:[pme],json:{write:!0}})],Op.prototype,"orderByFields",void 0),p([_({type:String,json:{write:!0}})],Op.prototype,"title",void 0),p([_({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Op.prototype,"type",void 0),Op=p([Q("esri.popup.content.AttachmentsContent")],Op);const Mb=Op;var l6;let hy=l6=class extends qd{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new l6({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?he(this.outFields):null})}};p([_()],hy.prototype,"creator",void 0),p([_()],hy.prototype,"destroyer",void 0),p([_()],hy.prototype,"outFields",void 0),p([_({type:["custom"],readOnly:!0})],hy.prototype,"type",void 0),hy=l6=p([Q("esri.popup.content.CustomContent")],hy);const LFe=hy;var u6;let V1=u6=class extends Te{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new u6({title:this.title,expression:this.expression})}};p([_({type:String,json:{write:!0}})],V1.prototype,"title",void 0),p([_({type:String,json:{write:!0}})],V1.prototype,"expression",void 0),p([_({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],V1.prototype,"returnType",void 0),V1=u6=p([Q("esri.popup.ElementExpressionInfo")],V1);const fme=V1;var c6;let N2=c6=class extends qd{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){var t;return new c6({expressionInfo:(t=this.expressionInfo)==null?void 0:t.clone()})}};p([_({type:fme,json:{write:!0}})],N2.prototype,"expressionInfo",void 0),p([_({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],N2.prototype,"type",void 0),N2=c6=p([Q("esri.popup.content.ExpressionContent")],N2);const m$=N2;let q1=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};p([mt(DNe)],q1.prototype,"dateFormat",void 0),p([_({type:Boolean,json:{write:!0}})],q1.prototype,"digitSeparator",void 0),p([_({type:fs,json:{write:!0}})],q1.prototype,"places",void 0),q1=p([Q("esri.popup.support.FieldInfoFormat")],q1);const tA=q1;var h6;let hc=h6=class extends Te{constructor(t){super(t),this.fieldName=null,this.format=void 0,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){var t;return new h6({fieldName:this.fieldName,format:(t=this.format)==null?void 0:t.clone(),isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};p([_({type:String,json:{write:!0}})],hc.prototype,"fieldName",void 0),p([_({type:tA,json:{write:!0}})],hc.prototype,"format",void 0),p([_({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],hc.prototype,"isEditable",void 0),p([_({type:String,json:{write:!0}})],hc.prototype,"label",void 0),p([mt(new Jt({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],hc.prototype,"stringFieldOption",void 0),p([_({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],hc.prototype,"statisticType",void 0),p([_({type:String,json:{write:!0}})],hc.prototype,"tooltip",void 0),p([_({type:Boolean,json:{write:!0}})],hc.prototype,"visible",void 0),hc=h6=p([Q("esri.popup.FieldInfo")],hc);const QC=hc;var m6;let Fm=m6=class extends qd{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map(s=>s.toJSON())}clone(){return new m6(he({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};p([_({type:Object,json:{write:!0}})],Fm.prototype,"attributes",void 0),p([_({type:String,json:{write:!0}})],Fm.prototype,"description",void 0),p([_({type:[QC]})],Fm.prototype,"fieldInfos",void 0),p([Ue("fieldInfos")],Fm.prototype,"writeFieldInfos",null),p([_({type:String,json:{write:!0}})],Fm.prototype,"title",void 0),p([_({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Fm.prototype,"type",void 0),Fm=m6=p([Q("esri.popup.content.FieldsContent")],Fm);const Z_=Fm;let my=class extends Te{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};p([_({type:String,json:{write:!0}})],my.prototype,"altText",void 0),p([_({type:String,json:{write:!0}})],my.prototype,"caption",void 0),p([_({type:String,json:{write:!0}})],my.prototype,"title",void 0),p([_({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],my.prototype,"type",void 0),my=p([Q("esri.popup.content.mixins.MediaInfo")],my);const k7=my;var d6;let dy=d6=class extends Ye{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){var t;return new d6({color:(t=this.color)==null?void 0:t.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};p([_()],dy.prototype,"color",void 0),p([_()],dy.prototype,"fieldName",void 0),p([_()],dy.prototype,"tooltip",void 0),p([_()],dy.prototype,"value",void 0),dy=d6=p([Q("esri.popup.content.support.ChartMediaInfoValueSeries")],dy);const gme=dy;var p6;let Lp=p6=class extends Te{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new p6({colors:he(this.colors),fields:he(this.fields),normalizeField:this.normalizeField,series:he(this.series),tooltipField:this.tooltipField})}};p([_({type:[Be],json:{type:[[fs]],write:!0}})],Lp.prototype,"colors",void 0),p([_({type:[String],json:{write:{isRequired:!0}}})],Lp.prototype,"fields",void 0),p([_({type:String,json:{write:!0}})],Lp.prototype,"normalizeField",void 0),p([_({type:[gme],json:{read:!1}})],Lp.prototype,"series",void 0),p([_({type:String,json:{write:!0}})],Lp.prototype,"tooltipField",void 0),Lp=p6=p([Q("esri.popup.content.support.ChartMediaInfoValue")],Lp);const VFe=Lp;let D2=class extends k7{constructor(e){super(e),this.type=null,this.value=void 0}};p([_({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],D2.prototype,"type",void 0),p([_({type:VFe,json:{write:{isRequired:!0}}})],D2.prototype,"value",void 0),D2=p([Q("esri.popup.content.mixins.ChartMediaInfo")],D2);const d$=D2,p$=Xn()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var f6;let sA=f6=class extends d${constructor(t){super(t),this.type="bar-chart"}clone(){var t;return new f6({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};p([_({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:p$.write,isRequired:!0}}})],sA.prototype,"type",void 0),sA=f6=p([Q("esri.popup.content.BarChartMediaInfo")],sA);const yme=sA;var g6;let iA=g6=class extends d${constructor(t){super(t),this.type="column-chart"}clone(){var t;return new g6({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};p([_({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:p$.write,isRequired:!0}}})],iA.prototype,"type",void 0),iA=g6=p([Q("esri.popup.content.ColumnChartMediaInfo")],iA);const _me=iA;var y6;let $2=y6=class extends Te{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new y6({linkURL:this.linkURL,sourceURL:this.sourceURL})}};p([_({type:String,json:{write:!0}})],$2.prototype,"linkURL",void 0),p([_({type:String,json:{write:{isRequired:!0}}})],$2.prototype,"sourceURL",void 0),$2=y6=p([Q("esri.popup.content.support.ImageMediaInfoValue")],$2);const qFe=$2;var _6;let G1=_6=class extends k7{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){var t;return new _6({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:(t=this.value)==null?void 0:t.clone()})}};p([_({type:Number,json:{write:!0}})],G1.prototype,"refreshInterval",void 0),p([_({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],G1.prototype,"type",void 0),p([_({type:qFe,json:{write:{isRequired:!0}}})],G1.prototype,"value",void 0),G1=_6=p([Q("esri.popup.content.ImageMediaInfo")],G1);const vme=G1;var v6;let rA=v6=class extends d${constructor(t){super(t),this.type="line-chart"}clone(){var t;return new v6({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};p([_({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:p$.write,isRequired:!0}}})],rA.prototype,"type",void 0),rA=v6=p([Q("esri.popup.content.LineChartMediaInfo")],rA);const bme=rA;var b6;let nA=b6=class extends d${constructor(t){super(t),this.type="pie-chart"}clone(){var t;return new b6({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};p([_({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:p$.write,isRequired:!0}}})],nA.prototype,"type",void 0),nA=b6=p([Q("esri.popup.content.PieChartMediaInfo")],nA);const xme=nA,x6={base:k7,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":yme,"column-chart":_me,"line-chart":bme,"pie-chart":xme,image:vme}};var w6;let mc=w6=class extends qd{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?vme.fromJSON(e):e.type==="barchart"?yme.fromJSON(e):e.type==="columnchart"?_me.fromJSON(e):e.type==="linechart"?bme.fromJSON(e):e.type==="piechart"?xme.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(s=>s.toJSON())}clone(){return new w6(he({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};p([_()],mc.prototype,"activeMediaInfoIndex",void 0),p([_({type:Object,json:{write:!0}})],mc.prototype,"attributes",void 0),p([_({type:String,json:{write:!0}})],mc.prototype,"description",void 0),p([_({types:[x6]})],mc.prototype,"mediaInfos",void 0),p([qe("mediaInfos")],mc.prototype,"readMediaInfos",null),p([Ue("mediaInfos")],mc.prototype,"writeMediaInfos",null),p([_({type:String,json:{write:!0}})],mc.prototype,"title",void 0),p([_({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],mc.prototype,"type",void 0),mc=w6=p([Q("esri.popup.content.MediaContent")],mc);const Ab=mc;var S6;let R2=S6=class extends Te{constructor(t){super(t),this.field=null,this.order=null}clone(){return new S6({field:this.field,order:this.order})}};p([_({type:String,json:{write:!0}})],R2.prototype,"field",void 0),p([_({type:["asc","desc"],json:{write:!0}})],R2.prototype,"order",void 0),R2=S6=p([Q("esri.popup.support.RelatedRecordsInfoFieldOrder")],R2);const F7=R2;let gh=class extends Wt.ClonableMixin(qd){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};p([_({type:String,json:{write:!0}})],gh.prototype,"description",void 0),p([_({type:Number,json:{type:fs,write:!0}})],gh.prototype,"displayCount",void 0),p([_({type:["list"],json:{write:{isRequired:!0}}})],gh.prototype,"displayType",void 0),p([_({type:[F7],json:{write:!0}})],gh.prototype,"orderByFields",void 0),p([_({type:Number,json:{type:fs,write:{isRequired:!0}}})],gh.prototype,"relationshipId",void 0),p([_({type:String,json:{write:!0}})],gh.prototype,"title",void 0),p([_({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],gh.prototype,"type",void 0),gh=p([Q("esri.popup.content.RelationshipContent")],gh);const FE=gh;var E6;let k2=E6=class extends qd{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new E6({text:this.text})}};p([_({type:String,json:{write:!0}})],k2.prototype,"text",void 0),p([_({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],k2.prototype,"type",void 0),k2=E6=p([Q("esri.popup.content.TextContent")],k2);const Q_=k2;let Om=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};p([_({type:String,json:{write:!0}})],Om.prototype,"title",void 0),p([_({type:String,json:{write:!0}})],Om.prototype,"description",void 0),p([_({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],Om.prototype,"type",void 0),p([_({type:Number,json:{type:fs,write:!0}})],Om.prototype,"associatedNetworkSourceId",void 0),p([_({type:Number,json:{type:fs,write:!0}})],Om.prototype,"associatedAssetGroup",void 0),p([_({type:Number,json:{type:fs,write:!0}})],Om.prototype,"associatedAssetType",void 0),Om=p([Q("esri.popup.support.UtilityNetworkAssociationType")],Om);const wme=Om;let Vp=class extends Wt.ClonableMixin(qd){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};p([_({type:String,json:{write:!0}})],Vp.prototype,"description",void 0),p([_({type:Number,json:{type:fs,write:!0}})],Vp.prototype,"displayCount",void 0),p([_({type:String,json:{write:!0}})],Vp.prototype,"title",void 0),p([_({type:[wme],json:{write:!0}})],Vp.prototype,"associationTypes",void 0),p([mt({utilityNetworkAssociations:"utility-network-associations"})],Vp.prototype,"type",void 0),Vp=p([Q("esri.popup.content.UtilityNetworkAssociationsContent")],Vp);const O7=Vp,GFe={base:null,key:"type",typeMap:{attachment:Mb,media:Ab,text:Q_,expression:m$,field:Z_,relationship:FE,utilityNetworkAssociations:O7}},zFe={base:null,key:"type",typeMap:{attachment:Mb,media:Ab,text:Q_,expression:m$,field:Z_,relationship:FE}};var C6;let py=C6=class extends Te{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new C6({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};p([_({type:String,json:{write:!0}})],py.prototype,"name",void 0),p([_({type:String,json:{write:!0}})],py.prototype,"title",void 0),p([_({type:String,json:{write:!0}})],py.prototype,"expression",void 0),p([_({type:["string","number"],json:{write:!0}})],py.prototype,"returnType",void 0),py=C6=p([Q("esri.popup.ExpressionInfo")],py);const Sme=py;var P6;let F2=P6=class extends Te{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new P6({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};p([_({type:Boolean,json:{write:!0}})],F2.prototype,"returnTopmostRaster",void 0),p([_({type:Boolean,json:{write:!0}})],F2.prototype,"showNoDataRecords",void 0),F2=P6=p([Q("esri.popup.LayerOptions")],F2);const UFe=F2;var T6;let O2=T6=class extends Te{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new T6({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?he(this.orderByFields):null})}};p([_({type:Boolean,json:{write:!0}})],O2.prototype,"showRelatedRecords",void 0),p([_({type:[F7],json:{write:!0}})],O2.prototype,"orderByFields",void 0),O2=T6=p([Q("esri.popup.RelatedRecordsInfo")],O2);const vQ=O2;var I6;let yu=I6=class extends sh.IdentifiableMixin(Ye){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new I6({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};p([_()],yu.prototype,"active",void 0),p([_()],yu.prototype,"className",void 0),p([_()],yu.prototype,"disabled",void 0),p([_()],yu.prototype,"icon",void 0),p([_()],yu.prototype,"id",void 0),p([_()],yu.prototype,"indicator",void 0),p([_()],yu.prototype,"title",void 0),p([_()],yu.prototype,"type",void 0),p([_()],yu.prototype,"visible",void 0),yu=I6=p([Q("esri.support.actions.ActionBase")],yu);const JC=yu;var M6;let oA=M6=class extends JC{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new M6({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};p([_()],oA.prototype,"image",void 0),oA=M6=p([Q("esri.support.actions.ActionButton")],oA);const _0=oA;var A6;let L2=A6=class extends JC{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new A6({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};p([_()],L2.prototype,"image",void 0),p([_()],L2.prototype,"value",void 0),L2=A6=p([Q("esri.support.actions.ActionToggle")],L2);const f$=L2,jw="relationships/",bQ="expression/",BFe=Ge.ofType({key:"type",defaultKeyValue:"button",base:JC,typeMap:{button:_0,toggle:f$}}),jFe={base:qd,key:"type",typeMap:{media:Ab,custom:LFe,text:Q_,attachments:Mb,fields:Z_,expression:m$,relationship:FE,utilityNetworkAssociations:O7}},Eme=new Set(["attachments","fields","media","text","expression","relationship"]),HFe=new Set([...Eme,"utility-network-associations"]);let Br=class extends Wt.ClonableMixin(Te){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(s=>Hc(jFe,s)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||sm(e)?e:(Ne.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,s){const{popupElements:i}=s;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(s.description,s.mediaInfos,i):this._readPopupInfo(s)}writeWebSceneContent(e,s,i,r){this._writePopupTemplateContent(e,s,r)}writeWebMapContent(e,s,i,r){this._writePopupTemplateContent(e,s,r)}writeFieldInfos(e,s,i,r){const{content:n}=this,o=Array.isArray(n)?n:null;if(e){const a=o?o.filter(u=>u.type==="fields"):[],l=a.length&&a.every(u=>{var c;return(c=u.fieldInfos)==null?void 0:c.length});s.fieldInfos=e.filter(Boolean).map(u=>{const c=u.toJSON(r);return l&&(c.visible=!1),c})}if(o)for(const a of o)a.type==="fields"&&this._writeFieldsContent(a,s)}writeLayerOptions(e,s,i,r){s[i]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(r)}writeTitle(e,s){s.title=e||""}async collectRequiredFields(e,s){const i=this.expressionInfos||[];await this._collectExpressionInfoFields(e,s,[...i,...this._getContentExpressionInfos(this.content,i)]),W_(e,s,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e){const s=new Set;return await this.collectRequiredFields(s,e),[...s].sort()}_writePopupTemplateContent(e,s,i){typeof e!="string"?Array.isArray(e)&&(s.popupElements=e.filter(r=>(i==null?void 0:i.origin)==="web-scene"?Eme.has(r.type):HFe.has(r.type)).map(r=>r==null?void 0:r.toJSON(i)),s.popupElements.forEach(r=>{r.type==="attachments"?this._writeAttachmentContent(s):r.type==="media"?this._writeMediaContent(r,s):r.type==="text"?this._writeTextContent(r,s):r.type==="relationship"&&this._writeRelationshipContent(r,s)})):s.description=e}_writeFieldsContent(e,s){if(!Array.isArray(e.fieldInfos)||!e.fieldInfos.length)return;const i=he(e.fieldInfos);Array.isArray(s.fieldInfos)?i.forEach(r=>{const n=s.fieldInfos.find(o=>{var a,l;return((a=o.fieldName)==null?void 0:a.toLowerCase())===((l=r.fieldName)==null?void 0:l.toLowerCase())});n?n.visible=!0:s.fieldInfos.push(r)}):s.fieldInfos=i}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,s){var n,o;const i=((n=e.orderByFields)==null?void 0:n.map(a=>this._toFieldOrderJSON(a,e.relationshipId)))||[],r=[...((o=s.relatedRecordsInfo)==null?void 0:o.orderByFields)||[],...i];s.relatedRecordsInfo={showRelatedRecords:!0,...(r==null?void 0:r.length)&&{orderByFields:r}}}_writeTextContent(e,s){!s.description&&e.text&&(s.description=e.text)}_writeMediaContent(e,s){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const i=he(e.mediaInfos);Array.isArray(s.mediaInfos)?s.mediaInfos=[...s.mediaInfos,...i]:s.mediaInfos=i}_readPopupInfoElements(e,s,i){const r={description:!1,mediaInfos:!1};return i.map(n=>n.type==="media"?(n.mediaInfos||!s||r.mediaInfos||(n.mediaInfos=s,r.mediaInfos=!0),Ab.fromJSON(n)):n.type==="text"?(n.text||!e||r.description||(n.text=e,r.description=!0),Q_.fromJSON(n)):n.type==="attachments"?Mb.fromJSON(n):n.type==="fields"?Z_.fromJSON(n):n.type==="expression"?m$.fromJSON(n):n.type==="relationship"?FE.fromJSON(n):n.type==="utilityNetworkAssociations"?O7.fromJSON(n):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:s,order:i}=e;if(!(s!=null&&s.startsWith(jw)))return null;const r=s.replace(jw,"").split("/");if(r.length!==2)return null;const n=parseInt(r[0],10),o=r[1];return!Number.isNaN(n)&&o?FE.fromJSON({relationshipId:n,orderByFields:[{field:o,order:i}]}):null}_toFieldOrderJSON(e,s){const{order:i,field:r}=e;return{field:`${jw}${s}/${r}`,order:i}}_readPopupInfo({description:e,mediaInfos:s,showAttachments:i,relatedRecordsInfo:r={showRelatedRecords:!1}}){const n=[];e?n.push(new Q_({text:e})):n.push(new Z_),Array.isArray(s)&&s.length&&n.push(Ab.fromJSON({mediaInfos:s})),i&&n.push(Mb.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=r;return o&&(a!=null&&a.length)&&a.forEach(l=>{const u=this._toRelationshipContent(l);u&&n.push(u)}),n.length?n:e}_getContentElementFields(e){const s=e==null?void 0:e.type;if(s==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(s==="custom")return e.outFields||[];if(s==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(s==="media"){const i=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...i.reduce((r,n)=>[...r,...this._getMediaInfoFields(n)],[])]}return s==="text"?this._extractFieldNames(e.text):s==="relationship"||s==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:s,title:i,value:r}=e,n=r||{},{fields:o,normalizeField:a,tooltipField:l,sourceURL:u,linkURL:c}=n,h=[...this._extractFieldNames(i),...this._extractFieldNames(s),...this._extractFieldNames(u),...this._extractFieldNames(c),...o??[]];return a&&h.push(a),l&&h.push(l),h}_getContentExpressionInfos(e,s){return Array.isArray(e)?e.reduce((i,r)=>[...i,...r.type==="expression"&&r.expressionInfo?[r.expressionInfo]:[]],s):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((s,i)=>[...s,...this._getContentElementFields(i)],[]):[]}async _collectExpressionInfoFields(e,s,i){i&&await Promise.all(i.map(r=>Go(e,s,r.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:s,visible:i})=>!(i!==void 0&&!i||!s||s.startsWith(jw)||s.startsWith(bQ))).map(s=>s.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((s,i)=>[...s,...this._getActionFields(i)],[]):[]}_getActionFields(e){const{className:s,title:i,type:r}=e,n=r==="button"||r==="toggle"?e.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(s),...this._extractFieldNames(n)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return R7(e).filter(s=>!(s.indexOf(jw)===0||s.indexOf(bQ)===0))}};p([_({type:BFe})],Br.prototype,"actions",void 0),p([_()],Br.prototype,"content",void 0),p([Ht("content")],Br.prototype,"castContent",null),p([qe("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],Br.prototype,"readContent",null),p([Ue("web-scene","content",{popupElements:{type:Ge.ofType(zFe)},showAttachments:{type:Boolean},mediaInfos:{type:Ge.ofType(x6)},description:{type:String},relatedRecordsInfo:{type:vQ}})],Br.prototype,"writeWebSceneContent",null),p([Ue("content",{popupElements:{type:Ge.ofType(GFe)},showAttachments:{type:Boolean},mediaInfos:{type:Ge.ofType(x6)},description:{type:String},relatedRecordsInfo:{type:vQ}})],Br.prototype,"writeWebMapContent",null),p([_({type:[Sme],json:{write:!0}})],Br.prototype,"expressionInfos",void 0),p([_({type:[QC]})],Br.prototype,"fieldInfos",void 0),p([Ue("fieldInfos")],Br.prototype,"writeFieldInfos",null),p([_({type:UFe})],Br.prototype,"layerOptions",void 0),p([Ue("layerOptions")],Br.prototype,"writeLayerOptions",null),p([_({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],Br.prototype,"lastEditInfoEnabled",void 0),p([_()],Br.prototype,"outFields",void 0),p([_()],Br.prototype,"overwriteActions",void 0),p([_()],Br.prototype,"returnGeometry",void 0),p([_({json:{type:String}})],Br.prototype,"title",void 0),p([Ue("title")],Br.prototype,"writeTitle",null),Br=p([Q("esri.PopupTemplate")],Br);const v0=Br,xQ=new Jt({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let YFe=0,z1=class extends Te{constructor(e){super(e),this.id="sym"+YFe++,this.type=null,this.color=new Be([0,0,0,1])}readColor(e){return(e==null?void 0:e[0])!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,s){}hash(){return JSON.stringify(this.toJSON())}clone(){}};p([_({type:xQ.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:xQ.write,isRequired:!0}}})],z1.prototype,"type",void 0),p([_({type:Be,json:{write:{allowNull:!0}}})],z1.prototype,"color",void 0),p([qe("color")],z1.prototype,"readColor",null),z1=p([Q("esri.symbols.Symbol")],z1);const go=z1;var N6;let qp=N6=class extends go{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){var s;if(((s=this.data)==null?void 0:s.type)==="CIMSymbolReference"){const i=this.data.primitiveOverrides;if(i){const r=i.map(n=>{const o=n.valueExpressionInfo;return o?Go(t,e,o.expression):null});await Promise.all(r)}}}clone(){return new N6({data:he(this.data)})}hash(){return koe(JSON.stringify(this.data)).toString()}};p([_({json:{write:!1}})],qp.prototype,"color",void 0),p([_({json:{write:!0}})],qp.prototype,"data",void 0),p([qe("data",["symbol"])],qp.prototype,"readData",null),p([Ue("data",{})],qp.prototype,"writeData",null),p([mt({CIMSymbolReference:"cim"},{readOnly:!0})],qp.prototype,"type",void 0),qp=N6=p([Q("esri.symbols.CIMSymbol")],qp);const yg=qp;let U1=class extends Te{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,s,i){e||(s[i]=e)}};p([_({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],U1.prototype,"enabled",void 0),p([Ue("enabled")],U1.prototype,"writeEnabled",null),p([_({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],U1.prototype,"type",void 0),U1=p([Q("esri.symbols.Symbol3DLayer")],U1);const im=U1;function XFe(t,e){const s=e.transparency!=null?kE(e.transparency):1,i=e.color;return i&&Array.isArray(i)?new Be([i[0]||0,i[1]||0,i[2]||0,s]):null}function WFe(t,e){e.color=t.toJSON().slice(0,3);const s=a$(t.a);s!==0&&(e.transparency=s)}function _g(t){return{type:Be,nonNullable:t==null?void 0:t.nonNullable,json:{type:[fs],default:null,read:{source:["color","transparency"],reader:XFe},write:{target:{color:{type:[fs],isRequired:t==null?void 0:t.colorRequiredOnWrite},transparency:{type:fs}},writer:WFe}}}}const Kh={type:Number,cast:ms,json:{write:!0}};let fy=class extends Te{constructor(e){super(e),this.color=new Be([0,0,0,1]),this.extensionLength=0,this.size=Zl(1)}clone(){}cloneProperties(){return{color:he(this.color),size:this.size,extensionLength:this.extensionLength}}};p([_({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],fy.prototype,"type",void 0),p([_(_g({colorRequiredOnWrite:!0}))],fy.prototype,"color",void 0),p([_({...Kh,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],fy.prototype,"extensionLength",void 0),p([_(Kh)],fy.prototype,"size",void 0),fy=p([Q("esri.symbols.edges.Edges3D")],fy);const L7=fy;var D6;let aA=D6=class extends L7{constructor(t){super(t),this.type="sketch"}clone(){return new D6(this.cloneProperties())}};p([mt({sketch:"sketch"},{readOnly:!0})],aA.prototype,"type",void 0),aA=D6=p([Q("esri.symbols.edges.SketchEdges3D")],aA);const ZFe=aA;var $6;let lA=$6=class extends L7{constructor(t){super(t),this.type="solid"}clone(){return new $6(this.cloneProperties())}};p([mt({solid:"solid"},{readOnly:!0})],lA.prototype,"type",void 0),lA=$6=p([Q("esri.symbols.edges.SolidEdges3D")],lA);const Cme=lA,Pme={types:{key:"type",base:L7,typeMap:{solid:Cme,sketch:ZFe}},json:{write:!0}};var R6;let Wa=R6=class extends Te{constructor(t){super(t),this.color=null,this.emissiveFactor=null}clone(){var e;const t={color:((e=this.color)==null?void 0:e.clone())??null,emissiveFactor:this.emissiveFactor?p7(this.emissiveFactor):null};return new R6(t)}};p([_(_g())],Wa.prototype,"color",void 0),p([_({type:[Number],json:{write:!1}})],Wa.prototype,"emissiveFactor",void 0),Wa=R6=p([Q("esri.symbols.support.Symbol3DMaterial")],Wa);var k6;let Gp=k6=class extends im{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){var t,e;return new k6({edges:(t=this.edges)==null?void 0:t.clone(),enabled:this.enabled,material:(e=this.material)==null?void 0:e.clone(),castShadows:this.castShadows,size:this.size})}};p([mt({Extrude:"extrude"},{readOnly:!0})],Gp.prototype,"type",void 0),p([_({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Gp.prototype,"size",void 0),p([_({type:Wa,json:{write:!0}})],Gp.prototype,"material",void 0),p([_({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Gp.prototype,"castShadows",void 0),p([_(Pme)],Gp.prototype,"edges",void 0),Gp=k6=p([Q("esri.symbols.ExtrudeSymbol3DLayer")],Gp);const Tme=Gp;let uA=class extends Te{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};p([_({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],uA.prototype,"type",void 0),uA=p([Q("esri.symbols.patterns.LinePattern3D")],uA);const Ime=uA,QFe=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var F6;const JFe=Xn()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let V2=F6=class extends Ime{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new F6(t)}};p([_({type:["style"],json:{write:{isRequired:!0}}})],V2.prototype,"type",void 0),p([mt(JFe),_({type:QFe,json:{write:{isRequired:!0}}})],V2.prototype,"style",void 0),V2=F6=p([Q("esri.symbols.patterns.LineStylePattern3D")],V2);const V7=V2;let cA=class extends Te{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};p([_({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],cA.prototype,"type",void 0),cA=p([Q("esri.symbols.patterns.Pattern3D")],cA);const Mme=cA,KFe=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var O6;let q2=O6=class extends Mme{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new O6({style:this.style})}};p([_({type:["style"],json:{write:{isRequired:!0}}})],q2.prototype,"type",void 0),p([_({type:KFe,json:{read:!0,write:{isRequired:!0}}})],q2.prototype,"style",void 0),q2=O6=p([Q("esri.symbols.patterns.StylePattern3D")],q2);const Ame=q2,e4e={types:{key:"type",base:Mme,typeMap:{style:Ame}},json:{write:!0}},Nme={types:{key:"type",base:Ime,typeMap:{style:V7}},json:{write:!0}},tE=new Be("white"),t4e=new Be([255,255,255,0]);function s4e(t){return t.r===0&&t.g===0&&t.b===0}var L6;let sE=L6=class extends Wa{constructor(t){super(t),this.colorMixMode=null}clone(){var e;const t={color:((e=this.color)==null?void 0:e.clone())??null,emissiveFactor:this.emissiveFactor?p7(this.emissiveFactor):null,colorMixMode:this.colorMixMode};return new L6(t)}};p([mt({multiply:"multiply",replace:"replace",tint:"tint"})],sE.prototype,"colorMixMode",void 0),sE=L6=p([Q("esri.symbols.support.Symbol3DFillMaterial")],sE);function i4e(t,e=!1){return t<=Ioe?e?new Array(t).fill(0):new Array(t):new Float64Array(t)}function Udt(t){return(Toe(t)?t.byteLength/8:t.length)<=Ioe?Array.from(t):new Float64Array(t)}function Bdt(t,e,s){return Array.isArray(t)?t.slice(e,e+s):t.subarray(e,e+s)}function KC(t=a4e){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function q7(t,e,s,i,r,n,o=KC()){return o[0]=t,o[1]=e,o[2]=s,o[3]=i,o[4]=r,o[5]=n,o}function jdt(t,e=KC()){return r4e(t,0,t.length/3,e)}function r4e(t,e,s,i=KC()){return Dme(i,V6),n4e(i,t,e,s),i}function Hdt(t,e=i4e(24)){const[s,i,r,n,o,a]=t;return e[0]=s,e[1]=i,e[2]=r,e[3]=s,e[4]=i,e[5]=a,e[6]=s,e[7]=o,e[8]=r,e[9]=s,e[10]=o,e[11]=a,e[12]=n,e[13]=i,e[14]=r,e[15]=n,e[16]=i,e[17]=a,e[18]=n,e[19]=o,e[20]=r,e[21]=n,e[22]=o,e[23]=a,e}function Ydt(t,e){const s=isFinite(t[2])||isFinite(t[5]);return new Hs(s?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function Xdt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function Wdt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function Zdt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function n4e(t,e,s=0,i=e.length/3){let r=t[0],n=t[1],o=t[2],a=t[3],l=t[4],u=t[5];for(let c=0;c<i;c++)r=Math.min(r,e[s+3*c]),n=Math.min(n,e[s+3*c+1]),o=Math.min(o,e[s+3*c+2]),a=Math.max(a,e[s+3*c]),l=Math.max(l,e[s+3*c+1]),u=Math.max(u,e[s+3*c+2]);t[0]=r,t[1]=n,t[2]=o,t[3]=a,t[4]=l,t[5]=u}function Qdt(t,e,s){const i=e.length;let r=t[0],n=t[1],o=t[2],a=t[3],l=t[4],u=t[5];if(s)for(let c=0;c<i;c++){const h=e[c];r=Math.min(r,h[0]),n=Math.min(n,h[1]),o=Math.min(o,h[2]),a=Math.max(a,h[0]),l=Math.max(l,h[1]),u=Math.max(u,h[2])}else for(let c=0;c<i;c++){const h=e[c];r=Math.min(r,h[0]),n=Math.min(n,h[1]),a=Math.max(a,h[0]),l=Math.max(l,h[1])}t[0]=r,t[1]=n,t[2]=o,t[3]=a,t[4]=l,t[5]=u}function Jdt(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function eP(t){return t[0]>=t[3]?0:t[3]-t[0]}function tP(t){return t[1]>=t[4]?0:t[4]-t[1]}function sP(t){return t[2]>=t[5]?0:t[5]-t[2]}function Kdt(t){const e=eP(t),s=sP(t),i=tP(t);return Math.sqrt(e*e+s*s+i*i)}function ept(t,e=[0,0,0]){return e[0]=t[0]+eP(t)/2,e[1]=t[1]+tP(t)/2,e[2]=t[2]+sP(t)/2,e}function tpt(t,e=[0,0,0]){return e[0]=eP(t),e[1]=tP(t),e[2]=sP(t),e}function spt(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function o4e(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function ipt(t,e){return e==null||o4e(t,e)}function rpt(t,e,s,i,r=t){return r[0]=t[0]+e,r[1]=t[1]+s,r[2]=t[2]+i,r[3]=t[3]+e,r[4]=t[4]+s,r[5]=t[5]+i,r}function npt(t,e,s=t){const i=t[0]+eP(t)/2,r=t[1]+tP(t)/2,n=t[2]+sP(t)/2;return s[0]=i+(t[0]-i)*e,s[1]=r+(t[1]-r)*e,s[2]=n+(t[2]-n)*e,s[3]=i+(t[3]-i)*e,s[4]=r+(t[4]-r)*e,s[5]=n+(t[5]-n)*e,s}function opt(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function apt(t,e,s=t){return s[0]=e[0],s[1]=e[1],s[2]=e[2],s!==t&&(s[3]=t[3],s[4]=t[4],s[5]=t[5]),s}function lpt(t,e,s=t){return s[3]=e[0],s[4]=e[1],s[5]=e[2],s!==t&&(s[0]=t[0],s[1]=t[1],s[2]=t[2]),t}function Dme(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function upt(t){return t?Dme(t,V6):KC(V6)}function cpt(t,e){return e||(e=pa()),e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function hpt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function mpt(t,e,s,i,r){return t[0]=e,t[1]=s,t[2]=Number.NEGATIVE_INFINITY,t[3]=i,t[4]=r,t[5]=Number.POSITIVE_INFINITY,t}function wQ(t){return t.length===6}function dpt(t){return eP(t)===0&&tP(t)===0&&sP(t)===0}function ppt(t,e,s){if(t==null||e==null)return t===e;if(!wQ(t)||!wQ(e))return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}const V6=[1/0,1/0,1/0,-1/0,-1/0,-1/0],a4e=[0,0,0,0,0,0];KC();function fpt(t,{isPrimitive:e,width:s,depth:i,height:r}){const n=e?10:1;if(s==null&&r==null&&i==null)return[n*t[0],n*t[1],n*t[2]];const o=lx(s,i,r);let a;for(let l=0;l<3;l++){const u=o[l];if(u!=null){a=u/t[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=t[l]*a);return o}const l4e=q7(-.5,-.5,-.5,.5,.5,.5),u4e=q7(-.5,-.5,0,.5,.5,1),c4e=q7(-.5,-.5,0,.5,.5,.5);function gpt(t){switch(t){case"sphere":case"cube":case"diamond":return l4e;case"cylinder":case"cone":case"inverted-cone":return u4e;case"tetrahedron":return c4e;default:return}}const G7=["butt","square","round"],h4e=[...G7,"none"],$me=["miter","bevel","round"];var q6;let gy=q6=class extends Te{constructor(t){super(t),this.color=new Be([0,0,0,1]),this.size=Zl(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new q6(t)}};p([_(_g({colorRequiredOnWrite:!0}))],gy.prototype,"color",void 0),p([_({...Kh,json:{write:{isRequired:!0}}})],gy.prototype,"size",void 0),p([_(Nme)],gy.prototype,"pattern",void 0),p([_({type:G7,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],gy.prototype,"patternCap",void 0),gy=q6=p([Q("esri.symbols.support.Symbol3DOutline")],gy);var hA;let Lm=hA=class extends im{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new hA(t)}static fromSimpleFillSymbol(t){var i,r,n;const e=t.outline&&t.outline.style&&t.outline.style!=="solid"?new V7({style:t.outline.style}):null,s={size:((i=t.outline)==null?void 0:i.width)??0,color:(((r=t.outline)==null?void 0:r.color)??tE).clone(),pattern:e};return e&&((n=t.outline)!=null&&n.cap)&&(s.patternCap=t.outline.cap),new hA({material:new sE({color:(t.color??t4e).clone()}),pattern:t.style&&t.style!=="solid"?new Ame({style:t.style}):null,outline:s})}};p([mt({Fill:"fill"},{readOnly:!0})],Lm.prototype,"type",void 0),p([_({type:sE,json:{write:!0}})],Lm.prototype,"material",void 0),p([_(e4e)],Lm.prototype,"pattern",void 0),p([_({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Lm.prototype,"castShadows",void 0),p([_({type:gy,json:{write:!0}})],Lm.prototype,"outline",void 0),p([_(Pme)],Lm.prototype,"edges",void 0),Lm=hA=p([Q("esri.symbols.FillSymbol3DLayer")],Lm);const b0=Lm;var G6;const m4e=Xn()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let yy=G6=class extends Te{constructor(t){super(t)}readHref(t,e,s){return t?Zf(t,s):e.dataURI}writeHref(t,e,s,i){t&&(d0(t)?e.dataURI=t:(e.href=LC(t,i),Bl(e.href)&&(e.href=Gc(e.href))))}clone(){return new G6({href:this.href,primitive:this.primitive})}};p([_({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],yy.prototype,"href",void 0),p([qe("href")],yy.prototype,"readHref",null),p([Ue("href",{href:{type:String},dataURI:{type:String}})],yy.prototype,"writeHref",null),p([mt(m4e)],yy.prototype,"primitive",void 0),yy=G6=p([Q("esri.symbols.support.IconSymbol3DLayerResource")],yy);const d4e="circle";var z6;let Mv=z6=class extends Ye{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new z6({x:this.x,y:this.y})}};p([_({type:Number})],Mv.prototype,"x",void 0),p([_({type:Number})],Mv.prototype,"y",void 0),Mv=z6=p([Q("esri.symbols.support.Symbol3DAnchorPosition2D")],Mv);var U6;let G2=U6=class extends Te{constructor(t){super(t),this.color=new Be([0,0,0,1]),this.size=Zl(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new U6(t)}};p([_(_g({colorRequiredOnWrite:!0}))],G2.prototype,"color",void 0),p([_({...Kh,json:{write:{isRequired:!0}}})],G2.prototype,"size",void 0),G2=U6=p([Q("esri.symbols.support.Symbol3DIconOutline")],G2);var B1;const Rme="esri.symbols.IconSymbol3DLayer";let dc=B1=class extends im{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0}clone(){return new B1({anchor:this.anchor,anchorPosition:he(this.anchorPosition),enabled:this.enabled,material:he(this.material),outline:he(this.outline),resource:he(this.resource),angle:this.angle,size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||tE,s=SQ(t),i=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||tE).clone()}:null;return new B1({size:t.size,angle:t.angle,resource:{primitive:f4e(t.style)},material:{color:e},outline:i,anchor:s?"relative":void 0,anchorPosition:s})}static fromPictureMarkerSymbol(t){const e=!t.color||s4e(t.color)?tE:t.color,s=SQ(t);return new B1({size:t.width<=t.height?t.height:t.width,angle:t.angle,resource:{href:t.url},material:{color:e.clone()},anchor:s?"relative":void 0,anchorPosition:s})}static fromCIMSymbol(t){return new B1({resource:{href:jae({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};p([_({type:Wa,json:{write:!0}})],dc.prototype,"material",void 0),p([_({type:yy,json:{write:!0}})],dc.prototype,"resource",void 0),p([mt({Icon:"icon"},{readOnly:!0})],dc.prototype,"type",void 0),p([_({...Kh,json:{write:{isRequired:!0}}})],dc.prototype,"size",void 0),p([mt({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],dc.prototype,"anchor",void 0),p([_({type:Mv,json:{type:[Number],read:{reader:t=>new Mv({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],dc.prototype,"anchorPosition",void 0),p([_({type:G2,json:{write:!0}})],dc.prototype,"outline",void 0),p([_({type:Number,json:{write:!0,default:0}})],dc.prototype,"angle",void 0),dc=B1=p([Q(Rme)],dc);const c_=dc;function SQ(t){const e="width"in t?t.width:t.size,s="height"in t?t.height:t.size,i=EQ(t.xoffset),r=EQ(t.yoffset);return(i||r)&&e&&s?{x:-i/e,y:r/s}:null}function EQ(t){return isFinite(t)?t:0}const p4e={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function f4e(t){return p4e[t]||(Ne.getLogger(Rme).warn(`${t} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const g4e=["begin","end","begin-end"],kme=["arrow","circle","square","diamond","cross","x"];let _y=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};p([_({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],_y.prototype,"type",void 0),p([_({type:g4e,json:{default:"begin-end",write:!0}})],_y.prototype,"placement",void 0),p([_({type:kme,json:{default:"arrow",write:!0}})],_y.prototype,"style",void 0),p([_({type:Be,json:{type:[fs],default:null,write:!0}})],_y.prototype,"color",void 0),_y=p([Q("esri.symbols.LineStyleMarker3D")],_y);const B6=_y;var mA;let yh=mA=class extends im{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=Zl(1),this.pattern=null,this.marker=null}clone(){const t={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new mA(t)}static fromSimpleLineSymbol(t){var s;const e={enabled:!0,size:t.width??Zl(1),cap:t.cap||"butt",join:t.join||"miter",pattern:t.style?new V7({style:t.style}):null,material:new Wa({color:(t.color||tE).clone()}),marker:t.marker?new B6({placement:t.marker.placement,style:t.marker.style,color:((s=t.marker.color)==null?void 0:s.clone())??null}):null};return new mA(e)}};p([_({type:Wa,json:{write:!0}})],yh.prototype,"material",void 0),p([mt({Line:"line"},{readOnly:!0})],yh.prototype,"type",void 0),p([_({type:$me,json:{write:!0,default:"miter"}})],yh.prototype,"join",void 0),p([_({type:G7,json:{write:!0,default:"butt"}})],yh.prototype,"cap",void 0),p([_({...Kh,json:{write:{isRequired:!0}}})],yh.prototype,"size",void 0),p([_(Nme)],yh.prototype,"pattern",void 0),p([_({types:{key:"type",base:B6,typeMap:{style:B6}},json:{write:!0}})],yh.prototype,"marker",void 0),yh=mA=p([Q("esri.symbols.LineSymbol3DLayer")],yh);const ux=yh;var j6;const y4e=Xn()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let z2=j6=class extends Te{clone(){return new j6({href:this.href,primitive:this.primitive})}};p([_({type:String,json:{read:Rz,write:V_}})],z2.prototype,"href",void 0),p([mt(y4e)],z2.prototype,"primitive",void 0),z2=j6=p([Q("esri.symbols.support.ObjectSymbol3DLayerResource")],z2);const _4e="sphere";var H6;let Wy=H6=class extends Ye{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new H6({x:this.x,y:this.y,z:this.z})}};p([_({type:Number})],Wy.prototype,"x",void 0),p([_({type:Number})],Wy.prototype,"y",void 0),p([_({type:Number})],Wy.prototype,"z",void 0),Wy=H6=p([Q("esri.symbols.support.Symbol3DAnchorPosition3D")],Wy);var Y6;let Eo=Y6=class extends im{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){var t,e,s;return new Y6({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:(t=this.anchorPosition)==null?void 0:t.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:((e=this.material)==null?void 0:e.clone())??null,castShadows:this.castShadows,resource:(s=this.resource)==null?void 0:s.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}};p([_({type:Wa,json:{write:!0}})],Eo.prototype,"material",void 0),p([_({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Eo.prototype,"castShadows",void 0),p([_({type:z2,json:{write:!0}})],Eo.prototype,"resource",void 0),p([mt({Object:"object"},{readOnly:!0})],Eo.prototype,"type",void 0),p([_({type:Number,json:{write:!0}})],Eo.prototype,"width",void 0),p([_({type:Number,json:{write:!0}})],Eo.prototype,"height",void 0),p([_({type:Number,json:{write:!0}})],Eo.prototype,"depth",void 0),p([mt({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],Eo.prototype,"anchor",void 0),p([_({type:Wy,json:{type:[Number],read:{reader:t=>new Wy({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Eo.prototype,"anchorPosition",void 0),p([_({type:Number,json:{write:!0}})],Eo.prototype,"heading",void 0),p([_({type:Number,json:{write:!0}})],Eo.prototype,"tilt",void 0),p([_({type:Number,json:{write:!0}})],Eo.prototype,"roll",void 0),p([_({readOnly:!0})],Eo.prototype,"isPrimitive",null),Eo=Y6=p([Q("esri.symbols.ObjectSymbol3DLayer")],Eo);const z7=Eo;var X6;let ea=X6=class extends im{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,e){return t??(e.height==null&&e.size!=null?e.size:void 0)}readHeight(t,e){return t??(e.width==null&&e.size!=null?e.size:void 0)}clone(){return new X6({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};p([_({type:Wa,json:{write:!0}})],ea.prototype,"material",void 0),p([_({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],ea.prototype,"castShadows",void 0),p([mt({Path:"path"},{readOnly:!0})],ea.prototype,"type",void 0),p([_({type:["circle","quad"],json:{write:!0,default:"circle"}})],ea.prototype,"profile",void 0),p([_({type:$me,json:{write:!0,default:"miter"}})],ea.prototype,"join",void 0),p([_({type:h4e,json:{write:!0,default:"butt"}})],ea.prototype,"cap",void 0),p([_({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],ea.prototype,"width",void 0),p([qe("width",["width","size","height"])],ea.prototype,"readWidth",null),p([_({type:Number,json:{write:!0}})],ea.prototype,"height",void 0),p([qe("height",["height","size","width"])],ea.prototype,"readHeight",null),p([_({type:["center","bottom","top"],json:{write:!0,default:"center"}})],ea.prototype,"anchor",void 0),p([_({type:["heading","all"],json:{write:!0,default:"all"}})],ea.prototype,"profileRotation",void 0),ea=X6=p([Q("esri.symbols.PathSymbol3DLayer")],ea);const U7=ea,v4e=["none","underline","line-through"],b4e=["normal","italic","oblique"],x4e=["normal","lighter","bold","bolder"],Fme={type:Number,cast:t=>{const e=ma(t);return e===0?1:Ka(e,.1,4)},nonNullable:!0},w4e=["left","right","center"],S4e=["baseline","top","middle","bottom"],Ome={type:w4e,nonNullable:!0},Lme={type:S4e,nonNullable:!0},_pt=8;var W6;let Vm=W6=class extends Te{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return ms(t)}clone(){return new W6({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};p([_({type:v4e,json:{default:"none",write:!0}})],Vm.prototype,"decoration",void 0),p([_({type:String,json:{write:!0}})],Vm.prototype,"family",void 0),p([_({type:Number,json:{write:{overridePolicy:(t,e,s)=>({enabled:!s||!s.textSymbol3D})}}})],Vm.prototype,"size",void 0),p([Ht("size")],Vm.prototype,"castSize",null),p([_({type:b4e,json:{default:"normal",write:!0}})],Vm.prototype,"style",void 0),p([_({type:x4e,json:{default:"normal",write:!0}})],Vm.prototype,"weight",void 0),Vm=W6=p([Q("esri.symbols.Font")],Vm);const g$=Vm;var Z6;let Av=Z6=class extends Te{constructor(){super(...arguments),this.color=new Be([0,0,0,1]),this.size=0}clone(){const t={color:he(this.color),size:this.size};return new Z6(t)}};p([_(_g())],Av.prototype,"color",void 0),p([_(Kh)],Av.prototype,"size",void 0),Av=Z6=p([Q("esri.symbols.support.Symbol3DHalo")],Av);let iE=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.color=null}};p([_(_g())],iE.prototype,"color",void 0),iE=p([Q("esri.symbols.support.Symbol3DTextBackground")],iE);var dA;let Na=dA=class extends im{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(t){t!=null&&this._userSize!=null&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,s,i){const r={...i,textSymbol3D:!0};e.font=t.write({},r),delete e.font.size}get size(){var t;return this._userSize!=null?this._userSize:((t=this.font)==null?void 0:t.size)!=null?this.font.size:9}set size(t){this._userSize=t,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const t=new dA({enabled:this.enabled,font:this.font&&he(this.font),halo:this.halo&&he(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:he(this.background)});return t._userSize=this._userSize,t}static fromTextSymbol(t){return new dA({font:t.font!=null?t.font.clone():new g$,halo:E4e(t.haloColor,t.haloSize),horizontalAlignment:t.horizontalAlignment,lineHeight:t.lineHeight,material:t.color?new Wa({color:t.color.clone()}):null,text:t.text,verticalAlignment:t.verticalAlignment,background:t.backgroundColor?new iE({color:t.backgroundColor.clone()}):null})}};function E4e(t,e){return t&&e!=null&&e>0?new Av({color:he(t),size:e}):null}p([_({type:g$,json:{write:!0}})],Na.prototype,"font",null),p([Ue("font")],Na.prototype,"writeFont",null),p([_({type:Av,json:{write:!0}})],Na.prototype,"halo",void 0),p([_({...Ome,json:{default:"center",write:!0}})],Na.prototype,"horizontalAlignment",void 0),p([_({...Fme,json:{default:1,write:!0}})],Na.prototype,"lineHeight",void 0),p([_({type:Wa,json:{write:!0}})],Na.prototype,"material",void 0),p([_({type:iE,json:{write:!0}})],Na.prototype,"background",void 0),p([_(Kh)],Na.prototype,"size",null),p([_({type:String,json:{write:!0}})],Na.prototype,"text",void 0),p([mt({Text:"text"},{readOnly:!0})],Na.prototype,"type",void 0),p([_({...Lme,json:{default:"baseline",write:!0}})],Na.prototype,"verticalAlignment",void 0),Na=dA=p([Q("esri.symbols.TextSymbol3DLayer")],Na);const cx=Na;var Q6;let zp=Q6=class extends im{constructor(t){super(t),this.color=J6.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new Q6({color:he(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};p([_({type:Be,nonNullable:!0,json:{type:[fs],write:(t,e,s)=>e[s]=t.toArray(Be.AlphaMode.UNLESS_OPAQUE),default:()=>J6.clone(),defaultEquals:t=>t.toCss(!0)===J6.toCss(!0)}})],zp.prototype,"color",void 0),p([mt({Water:"water"},{readOnly:!0})],zp.prototype,"type",void 0),p([_({type:["small","medium","large"],json:{write:!0,default:"medium"}})],zp.prototype,"waterbodySize",void 0),p([_({type:Number,json:{write:!0,default:null}})],zp.prototype,"waveDirection",void 0),p([_({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],zp.prototype,"waveStrength",void 0),zp=Q6=p([Q("esri.symbols.WaterSymbol3DLayer")],zp);const Vme=zp,J6=new Be([0,119,190]);var K6;let vy=K6=class extends Ye{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new K6({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};p([_({type:String})],vy.prototype,"name",void 0),p([_({type:String})],vy.prototype,"styleUrl",void 0),p([_({type:String})],vy.prototype,"styleName",void 0),p([_({type:qo})],vy.prototype,"portal",void 0),vy=K6=p([Q("esri.symbols.support.StyleOrigin")],vy);const OE=vy;var eV;let w_=eV=class extends Ye{constructor(){super(...arguments),this.url=""}clone(){return new eV({url:this.url})}};p([_({type:String})],w_.prototype,"url",void 0),w_=eV=p([Q("esri.symbols.support.Thumbnail")],w_);const qme={icon:c_,object:z7,line:ux,path:U7,fill:b0,extrude:Tme,text:cx,water:Vme},C4e=Ge.ofType({base:im,key:"type",typeMap:qme,errorContext:"symbol-layer"});let _h=class extends go{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const s=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,i=s==null?void 0:s.type,r=i||Ge;this._set("symbolLayers",new r)}get color(){return null}set color(e){this.constructed&&Ne.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){Md(e,this._get("symbolLayers"))}readStyleOrigin(e,s,i){if(e.styleUrl&&e.name){const r=Zf(e.styleUrl,i);return new OE({styleUrl:r,name:e.name})}if(e.styleName&&e.name)return new OE({portal:(i==null?void 0:i.portal)||qo.getDefault(),styleName:e.styleName,name:e.name});i!=null&&i.messages&&i.messages.push(new qu("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:e}))}writeStyleOrigin(e,s,i,r){if(e.styleUrl&&e.name){let n=LC(e.styleUrl,r);Bl(n)&&(n=Gc(n)),s.styleOrigin={styleUrl:n,name:e.name}}else e.styleName&&e.name&&(e.portal&&(r!=null&&r.portal)&&!Bae(e.portal.restUrl,r.portal.restUrl)?r!=null&&r.messages&&r.messages.push(new qu("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):s.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof im||e&&qme[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};p([_({json:{read:!1,write:!1}})],_h.prototype,"color",null),p([_({type:C4e,nonNullable:!0,json:{write:!0}}),Ht(ghe)],_h.prototype,"symbolLayers",null),p([_({type:OE})],_h.prototype,"styleOrigin",void 0),p([qe("styleOrigin")],_h.prototype,"readStyleOrigin",null),p([Ue("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],_h.prototype,"writeStyleOrigin",null),p([_({type:w_,json:{read:!1}})],_h.prototype,"thumbnail",void 0),p([_({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],_h.prototype,"type",void 0),_h=p([Q("esri.symbols.Symbol3D")],_h);const iP=_h;let U2=class extends Te{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};p([_({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],U2.prototype,"type",void 0),p([_({readOnly:!0})],U2.prototype,"visible",void 0),U2=p([Q("esri.symbols.callouts.Callout3D")],U2);const Gme=U2;var tV;let pA=tV=class extends Te{constructor(t){super(t),this.color=new Be("white")}clone(){return new tV({color:he(this.color)})}};p([_(_g({colorRequiredOnWrite:!0}))],pA.prototype,"color",void 0),pA=tV=p([Q("esri.symbols.callouts.LineCallout3DBorder")],pA);const P4e=pA;var sV;let Up=sV=class extends Gme{constructor(t){super(t),this.type="line",this.color=new Be([0,0,0,1]),this.size=Zl(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new sV({color:he(this.color),size:this.size,border:he(this.border)})}};p([mt({line:"line"})],Up.prototype,"type",void 0),p([_(_g({colorRequiredOnWrite:!0}))],Up.prototype,"color",void 0),p([_({...Kh,json:{write:{isRequired:!0}}})],Up.prototype,"size",void 0),p([_({type:P4e,json:{write:!0}})],Up.prototype,"border",void 0),p([_({readOnly:!0})],Up.prototype,"visible",null),Up=sV=p([Q("esri.symbols.callouts.LineCallout3D")],Up);const zme=Up;function B7(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function Ume(t){if(!t||!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!(e!=null&&e.visible)&&!!B7(t)}function wpt(t){return t.type==="point-3d"||t.type==="label-3d"}function Spt(t){return t.horizontalAlignment==="center"}const Bme={types:{key:"type",base:Gme,typeMap:{line:zme}},json:{write:!0}};var iV;let j1=iV=class extends Te{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new iV({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};p([_({...Kh,json:{write:{isRequired:!0}}})],j1.prototype,"screenLength",void 0),p([_({type:Number,nonNullable:!0,json:{write:!0,default:0}})],j1.prototype,"minWorldLength",void 0),p([_({type:Number,json:{write:!0}})],j1.prototype,"maxWorldLength",void 0),j1=iV=p([Q("esri.symbols.support.Symbol3DVerticalOffset")],j1);const j7=j1;var fA;const jme=Ge.ofType({base:null,key:"type",typeMap:{text:cx}});let Bp=fA=class extends iP{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new jme,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return Ume(this)}hasVisibleVerticalOffset(){return B7(this)}clone(){return new fA({styleOrigin:he(this.styleOrigin),symbolLayers:he(this.symbolLayers),thumbnail:he(this.thumbnail),callout:he(this.callout),verticalOffset:he(this.verticalOffset)})}static fromTextSymbol(t){return new fA({symbolLayers:new Ge([cx.fromTextSymbol(t)])})}};p([_({type:j7,json:{write:!0}})],Bp.prototype,"verticalOffset",void 0),p([_(Bme)],Bp.prototype,"callout",void 0),p([_({json:{read:!1,write:!1}})],Bp.prototype,"styleOrigin",void 0),p([_({type:jme})],Bp.prototype,"symbolLayers",void 0),p([mt({LabelSymbol3D:"label-3d"},{readOnly:!0})],Bp.prototype,"type",void 0),Bp=fA=p([Q("esri.symbols.LabelSymbol3D")],Bp);const y$=Bp;var gA;const Hme=Ge.ofType({base:null,key:"type",typeMap:{line:ux,path:U7}}),T4e=Ge.ofType({base:null,key:"type",typeMap:{line:ux,path:U7}});let B2=gA=class extends iP{constructor(t){super(t),this.symbolLayers=new Hme,this.type="line-3d"}clone(){return new gA({styleOrigin:he(this.styleOrigin),symbolLayers:he(this.symbolLayers),thumbnail:he(this.thumbnail)})}static fromSimpleLineSymbol(t){return new gA({symbolLayers:new Ge([ux.fromSimpleLineSymbol(t)])})}};p([_({type:Hme,json:{type:T4e}})],B2.prototype,"symbolLayers",void 0),p([mt({LineSymbol3D:"line-3d"},{readOnly:!0})],B2.prototype,"type",void 0),B2=gA=p([Q("esri.symbols.LineSymbol3D")],B2);const x0=B2;var yA;const Yme=Ge.ofType({base:null,key:"type",typeMap:{fill:b0}});let j2=yA=class extends iP{constructor(t){super(t),this.symbolLayers=new Yme,this.type="mesh-3d"}clone(){return new yA({styleOrigin:he(this.styleOrigin),symbolLayers:he(this.symbolLayers),thumbnail:he(this.thumbnail)})}static fromSimpleFillSymbol(t){return new yA({symbolLayers:new Ge([b0.fromSimpleFillSymbol(t)])})}};p([_({type:Yme})],j2.prototype,"symbolLayers",void 0),p([mt({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],j2.prototype,"type",void 0),j2=yA=p([Q("esri.symbols.MeshSymbol3D")],j2);const rP=j2;let H2=class extends go{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};p([mt({esriSLS:"simple-line"},{readOnly:!0})],H2.prototype,"type",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],H2.prototype,"width",void 0),H2=p([Q("esri.symbols.LineSymbol")],H2);const I4e=H2;var rV;let vh=rV=class extends Te{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,s,i){e[s]=(i==null?void 0:i.origin)==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return(t==null?void 0:t[0])!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,s,i){(i==null?void 0:i.origin)==="web-map"||(e[s]=t)}clone(){return new rV({color:he(this.color),placement:this.placement,style:this.style})}hash(){var t;return`${this.placement}.${(t=this.color)==null?void 0:t.hash()}.${this.style}`}};p([_({type:["begin","end","begin-end"],json:{write:!0}})],vh.prototype,"placement",void 0),p([mt({"line-marker":"line-marker"},{readOnly:!0}),_({json:{origins:{"web-map":{write:!1}}}})],vh.prototype,"type",void 0),p([_({type:kme})],vh.prototype,"style",void 0),p([Ue("style")],vh.prototype,"writeStyle",null),p([_({type:Be,value:null,json:{write:{allowNull:!0}}})],vh.prototype,"color",null),p([qe("color")],vh.prototype,"readColor",null),p([Ue("color")],vh.prototype,"writeColor",null),vh=rV=p([Q("esri.symbols.LineSymbolMarker")],vh);const M4e=vh;var nV;const G4=new Jt({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let qm=nV=class extends I4e{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,s,i,r,n){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),s!=null&&(o.width=ms(s)),i!=null&&(o.cap=i),r!=null&&(o.join=r),n!=null&&(o.miterLimit=ms(n)),o}clone(){var t;return new nV({color:he(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:(t=this.marker)==null?void 0:t.clone()})}hash(){var t,e;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${(e=this.marker)==null?void 0:e.hash()}`}};p([mt({esriSLS:"simple-line"},{readOnly:!0})],qm.prototype,"type",void 0),p([_({type:G4.apiValues,json:{read:G4.read,write:G4.write}})],qm.prototype,"style",void 0),p([_({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,s)=>({enabled:t!=="round"&&(s==null?void 0:s.origin)==null})}}})],qm.prototype,"cap",void 0),p([_({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,s)=>({enabled:t!=="round"&&(s==null?void 0:s.origin)==null})}}})],qm.prototype,"join",void 0),p([_({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":M4e}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],qm.prototype,"marker",void 0),p([_({type:Number,json:{read:!1,write:!1}})],qm.prototype,"miterLimit",void 0),qm=nV=p([Q("esri.symbols.SimpleLineSymbol")],qm);const tl=qm;let Y2=class extends go{constructor(e){super(e),this.outline=null,this.type=null}hash(){var e;return`${this.type}.${(e=this.outline)==null?void 0:e.hash()}`}};p([_({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":tl}},json:{default:null,write:!0}})],Y2.prototype,"outline",void 0),p([_({type:["simple-fill","picture-fill"],readOnly:!0})],Y2.prototype,"type",void 0),Y2=p([Q("esri.symbols.FillSymbol")],Y2);const Xme=Y2;function A4e(t,e,s){return e.imageData?jae({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):Wme(e.url,s)}function Wme(t,e){if(!Bl(t)){const s=D4e(e);if(s)return L_(s,"images",t)}return Zf(t,e)}function N4e(t,e,s,i){if(d0(t)){const r=yb(t);if(!r)return;e.contentType=r.mediaType,e.imageData=r.data,s&&s.imageData===e.imageData&&s.url&&V_(s.url,e,"url",i)}else V_(t,e,"url",i)}const Zme={json:{read:{source:["imageData","url"],reader:A4e},write:{writer(t,e,s,i){N4e(t,e,this.source,i)}}}},Qme={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,s){const i={};return e.imageData&&(i.imageData=e.imageData),e.contentType&&(i.contentType=e.contentType),e.url&&(i.url=Wme(e.url,s)),i}}}};function D4e(t){var r,n;if(!t)return null;const{origin:e,layer:s}=t;if(e!=="service"&&e!=="portal-item")return null;const i=s==null?void 0:s.type;return i==="feature"||i==="stream"?(r=s.parsedUrl)==null?void 0:r.path:i==="map-image"||i==="tile"?(n=t.url)==null?void 0:n.path:null}var oV;let _u=oV=class extends Xme{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,s,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const r={};return t&&(r.url=t),e&&(r.outline=e),s!=null&&(r.width=ms(s)),i!=null&&(r.height=ms(i)),r}clone(){const t=new oV({color:he(this.color),height:this.height,outline:he(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",he(this.source)),t}hash(){var t;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};p([mt({esriPFS:"picture-fill"},{readOnly:!0})],_u.prototype,"type",void 0),p([_(Zme)],_u.prototype,"url",void 0),p([_({type:Number,json:{write:!0}})],_u.prototype,"xscale",void 0),p([_({type:Number,json:{write:!0}})],_u.prototype,"yscale",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],_u.prototype,"width",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],_u.prototype,"height",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],_u.prototype,"xoffset",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],_u.prototype,"yoffset",void 0),p([_(Qme)],_u.prototype,"source",void 0),_u=oV=p([Q("esri.symbols.PictureFillSymbol")],_u);const H7=_u;let jp=class extends go{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};p([_({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],jp.prototype,"angle",void 0),p([_({type:["simple-marker","picture-marker"],readOnly:!0})],jp.prototype,"type",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],jp.prototype,"xoffset",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],jp.prototype,"yoffset",void 0),p([_({cast:t=>t==="auto"?t:ma(ms(t)),json:{write:!0}})],jp.prototype,"size",void 0),jp=p([Q("esri.symbols.MarkerSymbol")],jp);const Jme=jp;var aV;let pc=aV=class extends Jme{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,s){if(t&&typeof t!="string"&&t.imageData==null)return t;const i={};return t&&(i.url=t),e!=null&&(i.width=ms(e)),s!=null&&(i.height=ms(s)),i}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new aV({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",he(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};p([_({json:{write:!1}})],pc.prototype,"color",void 0),p([mt({esriPMS:"picture-marker"},{readOnly:!0})],pc.prototype,"type",void 0),p([_(Zme)],pc.prototype,"url",void 0),p([_(Qme)],pc.prototype,"source",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],pc.prototype,"height",void 0),p([qe("height",["height","size"])],pc.prototype,"readHeight",null),p([_({type:Number,cast:ms,json:{write:!0}})],pc.prototype,"width",void 0),p([_({json:{write:!1}})],pc.prototype,"size",void 0),pc=aV=p([Q("esri.symbols.PictureMarkerSymbol")],pc);const nP=pc;var by;const Kme=Ge.ofType({base:null,key:"type",typeMap:{icon:c_,object:z7,text:cx}});let xy=by=class extends iP{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new Kme,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return Ume(this)}hasVisibleVerticalOffset(){return B7(this)}clone(){return new by({verticalOffset:he(this.verticalOffset),callout:he(this.callout),styleOrigin:he(this.styleOrigin),symbolLayers:he(this.symbolLayers),thumbnail:he(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new by({symbolLayers:new Ge([c_.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new by({symbolLayers:new Ge([c_.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){var i,r;if(((r=(i=t.data)==null?void 0:i.symbol)==null?void 0:r.type)!=="CIMPointSymbol")return null;const s=t.data.symbol;return new by(s!=null&&s.callout?{symbolLayers:new Ge([c_.fromCIMSymbol(t)]),callout:new zme({size:.5,color:new Be([0,0,0])}),verticalOffset:new j7({screenLength:40})}:{symbolLayers:new Ge([c_.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new by({symbolLayers:new Ge([cx.fromTextSymbol(t)])})}};p([_({type:j7,json:{write:!0}})],xy.prototype,"verticalOffset",void 0),p([_(Bme)],xy.prototype,"callout",void 0),p([_({type:Kme,json:{origins:{"web-scene":{write:!0}}}})],xy.prototype,"symbolLayers",void 0),p([mt({PointSymbol3D:"point-3d"},{readOnly:!0})],xy.prototype,"type",void 0),xy=by=p([Q("esri.symbols.PointSymbol3D")],xy);const yd=xy;var X2;const ede=Ge.ofType({base:null,key:"type",typeMap:{extrude:Tme,fill:b0,icon:c_,line:ux,object:z7,text:cx,water:Vme}});let W2=X2=class extends iP{constructor(t){super(t),this.symbolLayers=new ede,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&SE(Ne.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&SE(Ne.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(Vo(()=>this.symbolLayers,"after-add",({item:e})=>t(e),Xc))}clone(){return new X2({styleOrigin:he(this.styleOrigin),symbolLayers:he(this.symbolLayers),thumbnail:he(this.thumbnail)})}static fromJSON(t){var s;const e=new X2;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const i=e.symbolLayers.at(0),r=e.symbolLayers.at(1);!r.enabled||(s=t.symbolLayers)!=null&&s[1]&&t.symbolLayers[1].enable===!1||(i.outline={size:r.size,color:r.material!=null?r.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new X2({symbolLayers:new Ge([b0.fromSimpleFillSymbol(t)])})}};p([_({type:ede,json:{write:!0}})],W2.prototype,"symbolLayers",void 0),p([mt({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],W2.prototype,"type",void 0),W2=X2=p([Q("esri.symbols.PolygonSymbol3D")],W2);const vg=W2;var lV;const z4=new Jt({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let wy=lV=class extends Xme{constructor(...t){super(...t),this.color=new Be([0,0,0,.25]),this.outline=new tl,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,s){if(t&&typeof t!="string")return t;const i={};return t&&(i.style=t),e&&(i.outline=e),s&&(i.color=s),i}clone(){return new lV({color:he(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};p([_()],wy.prototype,"color",void 0),p([_()],wy.prototype,"outline",void 0),p([mt({esriSFS:"simple-fill"},{readOnly:!0})],wy.prototype,"type",void 0),p([_({type:z4.apiValues,json:{read:z4.read,write:z4.write}})],wy.prototype,"style",void 0),wy=lV=p([Q("esri.symbols.SimpleFillSymbol")],wy);const bg=wy;var uV;const U4=new Jt({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let bh=uV=class extends Jme{constructor(...t){super(...t),this.color=new Be([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new tl}normalizeCtorArgs(t,e,s,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.style=t),e!=null&&(r.size=ms(e)),s&&(r.outline=s),i&&(r.color=i),r}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new uV({angle:this.angle,color:he(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${(t=this.outline)==null?void 0:t.hash()}`}};p([_()],bh.prototype,"color",void 0),p([Ue("color")],bh.prototype,"writeColor",null),p([mt({esriSMS:"simple-marker"},{readOnly:!0})],bh.prototype,"type",void 0),p([_()],bh.prototype,"size",void 0),p([_({type:U4.apiValues,json:{read:U4.read,write:U4.write}})],bh.prototype,"style",void 0),p([_({type:String,json:{write:!0}})],bh.prototype,"path",null),p([_({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":tl}},json:{default:null,write:!0}})],bh.prototype,"outline",void 0),bh=uV=p([Q("esri.symbols.SimpleMarkerSymbol")],bh);const rm=bh;var cV;let $i=cV=class extends go{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new g$,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,s){if(t&&typeof t!="string")return t;const i={};return t&&(i.text=t),e&&(i.font=e),s&&(i.color=s),i}writeLineWidth(t,e,s,i){i&&typeof i!="string"?i.origin:e[s]=t}castLineWidth(t){return ms(t)}writeLineHeight(t,e,s,i){i&&typeof i!="string"?i.origin:e[s]=t}clone(){return new cV({angle:this.angle,backgroundColor:he(this.backgroundColor),borderLineColor:he(this.borderLineColor),borderLineSize:this.borderLineSize,color:he(this.color),font:this.font&&this.font.clone(),haloColor:he(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t,e,s;return`${(t=this.backgroundColor)==null?void 0:t.hash()}.${this.borderLineColor}.${this.borderLineSize}.${(e=this.color)==null?void 0:e.hash()}.${this.font&&this.font.hash()}.${(s=this.haloColor)==null?void 0:s.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};p([_({type:Be,json:{write:!0}})],$i.prototype,"backgroundColor",void 0),p([_({type:Be,json:{write:!0}})],$i.prototype,"borderLineColor",void 0),p([_({type:Number,json:{write:!0},cast:ms})],$i.prototype,"borderLineSize",void 0),p([_({type:g$,json:{write:!0}})],$i.prototype,"font",void 0),p([_({...Ome,json:{write:!0}})],$i.prototype,"horizontalAlignment",void 0),p([_({type:Boolean,json:{write:!0}})],$i.prototype,"kerning",void 0),p([_({type:Be,json:{write:!0}})],$i.prototype,"haloColor",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],$i.prototype,"haloSize",void 0),p([_({type:Boolean,json:{write:!0}})],$i.prototype,"rightToLeft",void 0),p([_({type:Boolean,json:{write:!0}})],$i.prototype,"rotated",void 0),p([_({type:String,json:{write:!0}})],$i.prototype,"text",void 0),p([mt({esriTS:"text"},{readOnly:!0})],$i.prototype,"type",void 0),p([_({...Lme,json:{write:!0}})],$i.prototype,"verticalAlignment",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],$i.prototype,"xoffset",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],$i.prototype,"yoffset",void 0),p([_({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],$i.prototype,"angle",void 0),p([_({type:Number,json:{write:!0}})],$i.prototype,"width",void 0),p([_({type:Number})],$i.prototype,"lineWidth",void 0),p([Ue("lineWidth")],$i.prototype,"writeLineWidth",null),p([Ht("lineWidth")],$i.prototype,"castLineWidth",null),p([_(Fme)],$i.prototype,"lineHeight",void 0),p([Ue("lineHeight")],$i.prototype,"writeLineHeight",null),$i=cV=p([Q("esri.symbols.TextSymbol")],$i);const hx=$i;var hV;let fc=hV=class extends go{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:qo.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e==null?void 0:e.portal,super.read(t,e)}clone(){return new hV({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){const e=t&&"acceptedFormats"in t?t.acceptedFormats:["web"];return this._fetchSymbol({...t,acceptedFormats:e})}async fetchCIMSymbol(t){const e=await this.fetchSymbol({...t,acceptedFormats:["cim"]});if((e==null?void 0:e.type)!=="cim")throw new ae("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,s=e?this._fetchCacheKey:null;if(e!=null){const o=s&&e.get(s);if(o)return o.clone()}const{resolveWebStyleSymbol:i}=await me(()=>Promise.resolve().then(()=>iQe),void 0);ni(t);const r=i(this,{portal:this.portal},t);r.catch(o=>{Ne.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)});const n=await r;return e!=null&&e.set(s,n.clone()),n}};p([_({json:{write:!1}})],fc.prototype,"color",void 0),p([_({type:String,json:{write:!0}})],fc.prototype,"styleName",void 0),p([_({type:qo,json:{write:!1}})],fc.prototype,"portal",void 0),p([_({type:String,json:{read:Rz,write:V_}})],fc.prototype,"styleUrl",void 0),p([_({type:w_,json:{read:!1}})],fc.prototype,"thumbnail",void 0),p([_({type:String,json:{write:!0}})],fc.prototype,"name",void 0),p([mt({styleSymbolReference:"web-style"},{readOnly:!0})],fc.prototype,"type",void 0),p([_()],fc.prototype,"_fetchCacheKey",null),fc=hV=p([Q("esri.symbols.WebStyleSymbol")],fc);const tg=fc;function _$(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function xg(t){switch(t==null?void 0:t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const Nf={base:go,key:"type",typeMap:{"simple-fill":bg,"picture-fill":H7,"picture-marker":nP,"simple-line":tl,"simple-marker":rm,text:hx,"label-3d":y$,"line-3d":x0,"mesh-3d":rP,"point-3d":yd,"polygon-3d":vg,"web-style":tg,cim:yg},errorContext:"symbol"},Tpt={base:go,key:"type",typeMap:{"picture-marker":nP,"simple-marker":rm,"point-3d":yd,cim:yg},errorContext:"symbol"},Ipt={base:go,key:"type",typeMap:{"simple-line":tl,"line-3d":x0,cim:yg},errorContext:"symbol"},Mpt={base:go,key:"type",typeMap:{"simple-fill":bg,"picture-fill":H7,"polygon-3d":vg,cim:yg},errorContext:"symbol"},$4e={base:go,key:"type",typeMap:{"picture-marker":nP,"simple-marker":rm,text:hx,"web-style":tg,cim:yg},errorContext:"symbol"},R4e=Jb({types:Nf}),tde={base:go,key:"type",typeMap:{"simple-fill":bg,"picture-fill":H7,"picture-marker":nP,"simple-line":tl,"simple-marker":rm,text:hx,"line-3d":x0,"mesh-3d":rP,"point-3d":yd,"polygon-3d":vg,"web-style":tg,cim:yg},errorContext:"symbol"},k4e={base:go,key:"type",typeMap:{text:hx,"label-3d":y$},errorContext:"symbol"},CQ={base:go,key:"type",typeMap:{"line-3d":x0,"mesh-3d":rP,"point-3d":yd,"polygon-3d":vg,"web-style":tg,cim:yg},errorContext:"symbol"},F4e={base:go,key:"type",typeMap:{"label-3d":y$},errorContext:"symbol"},sde=Hc(Nf);var mV;function O4e(t){if(!t)return null;const e={};for(const s in t){const i=Y_(t[s]);i&&(e[s]=i)}return Object.keys(e).length!==0?e:null}function L4e(t){if(t==null)return null;const e={};for(const s in t){const i=t[s];i&&(e[s]=i.toJSON())}return Object.keys(e).length!==0?e:null}let Da=mV=class extends Wt.ClonableMixin(Te){constructor(t){super(t),this.isAggregate=!1,this.layer=null,this.origin=null,this.popupTemplate=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:DM(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&JEe(Ne.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(t){const e=this._get("aggregateGeometries");JSON.stringify(e)!==JSON.stringify(t)&&this._set("aggregateGeometries",t)}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),(t==null?void 0:t.type)!=="mesh"&&this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}get version(){return this._version}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}cloneShallow(){return new mV({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;const e=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const s of[e,this.sourceLayer,this.layer])if(s){if("popupTemplate"in s&&s.popupTemplate)return s.popupTemplate;if(t&&"defaultPopupTemplate"in s&&s.defaultPopupTemplate!=null)return s.defaultPopupTemplate}return null}getAttribute(t){var e;return(e=this.attributes)==null?void 0:e[t]}setAttribute(t,e){if(this.attributes){const s=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",s,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){var t;return{aggregateGeometries:L4e(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:Te.isSerializable(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:((t=this.popupTemplate)==null?void 0:t.toJSON())??null}}notifyMeshTransformChanged(t={}){const{geometry:e}=this;if((e==null?void 0:e.type)==="mesh"){const s={origin:e.origin,transform:e.transform};this._notifyLayer("origin-transform",s,s,t.action)}}_notifyLayer(t,e,s,i){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const r={graphic:this,property:t,oldValue:e,newValue:s};t==="origin-transform"&&(r.action=i),t==="attributes"&&(r.attributeName=i),this.layer.graphicChanged(r)}_watchMeshGeometryChanges(){this.addHandles([Or(()=>{var t,e;return((t=this.geometry)==null?void 0:t.type)==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:(e=this.geometry.transform)==null?void 0:e.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0},({localMatrix:t,origin:e})=>{this._lastMeshTransform.localMatrix===t&&this._lastMeshTransform.origin===e||(this._lastMeshTransform.localMatrix=t,this._lastMeshTransform.origin=e,this.notifyMeshTransformChanged())}),Or(()=>{var t;return((t=this.geometry)==null?void 0:t.type)==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0},()=>{var e;const t=this.geometry;(t==null?void 0:t.type)==="mesh"&&t.vertexSpace.origin?(this._lastMeshTransform.localMatrix=(e=t.transform)==null?void 0:e.localMatrix,this._lastMeshTransform.origin=t.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(t,e)=>t===e,sync:!0})])}};p([_({value:null,json:{read:O4e}})],Da.prototype,"aggregateGeometries",null),p([_({value:null})],Da.prototype,"attributes",null),p([_({value:null,types:GC,json:{read:Y_}})],Da.prototype,"geometry",null),p([_({type:Boolean})],Da.prototype,"isAggregate",void 0),p([_({clonable:"reference"})],Da.prototype,"layer",void 0),p([_({clonable:"reference"})],Da.prototype,"origin",void 0),p([_({type:v0})],Da.prototype,"popupTemplate",void 0),p([_({clonable:"reference"})],Da.prototype,"sourceLayer",void 0),p([_({value:null,types:Nf})],Da.prototype,"symbol",null),p([_({clonable:!1,json:{read:!1,write:!1}})],Da.prototype,"_version",void 0),p([_({type:Boolean,value:!0})],Da.prototype,"visible",null),Da=mV=p([Q("esri.Graphic")],Da);const tn=Da;let S_=class extends KS{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};p([Jz({Type:tn,ensureType:nn(tn)})],S_.prototype,"itemType",void 0),S_=p([Q("esri.support.GraphicsCollection")],S_);let Hp=class extends Ye{constructor(e){super(e),this.view=null,this.baseLayerViews=new Ge,this.referenceLayerViews=new Ge,this._loadingHandle=Ee(()=>{var s,i;return(i=(s=this.view)==null?void 0:s.map)==null?void 0:i.basemap},s=>{s&&s.load().catch(()=>{})},ht)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){var e;return((e=this.view)==null?void 0:e.suspended)??!0}get updating(){var s,i,r;if((s=this.view)!=null&&s.suspended)return!1;const e=(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.basemap;return!!(e!=null&&e.loaded)&&(this.baseLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};p([_({constructOnly:!0})],Hp.prototype,"view",void 0),p([_({readOnly:!0})],Hp.prototype,"baseLayerViews",void 0),p([_({readOnly:!0})],Hp.prototype,"referenceLayerViews",void 0),p([_({readOnly:!0})],Hp.prototype,"suspended",null),p([_({type:Boolean,readOnly:!0})],Hp.prototype,"updating",null),Hp=p([Q("esri.views.BasemapView")],Hp);const V4e=Hp;function q4e(t){return"tryRecycleWith"in t}function G4e(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let z4e=class{constructor(e,s,i){this.layer=e,this.view=s,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=Xl(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,Ou(this._controller.signal,()=>{const r=new ae("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(r)})}tryRecycle(e){if(!this.done||!this.layerView||!q4e(this.layerView))return null;const s=this.layer.type,i=this._controller.signal;for(let r=0;r<e.length;r++){const n=e[r];if(n.type!==s)continue;const o=this.layerView.tryRecycleWith(n,{signal:i});if(o){e.splice(r,1),this.layer=n;const a=this.layerView,l=a.view;return this.promise=Promise.race([o.then(()=>(ni(this._controller.signal),n.emit("layerview-destroy",{view:l,layerView:a}),l.emit("layerview-destroy",{view:l,layerView:a}),n.emit("layerview-create",{view:l,layerView:a}),l.emit("layerview-create",{view:l,layerView:a}),a)),new Promise((u,c)=>Ou(this._controller.signal,()=>c(xi())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:s,view:i}=this;s.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:s,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var r,n;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:s,view:i}=this;this._map=i.map;try{let o,a;if(await s.load({signal:e}),s.prefetchResources&&await s.prefetchResources({signal:e}),B4e(s))o=await s.createLayerView(i,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(s))throw new ae("layer:view-not-supported","No layerview implementation was found");const c=await this.layerViewImporter.importLayerView(s);ni(e),o="default"in c?new c.default({layer:s,view:i}):new c({layer:s,view:i})}const l=()=>{a=qi(a),o.destroyed||o.destroy(),o.layer=null,o.parent=null,o.view=null,this.done=!0};a=Ou(e,l),ni(e);try{await o.when()}catch(c){throw l(),c}if(!((n=(r=this._map)==null?void 0:r.allLayers)==null?void 0:n.includes(s)))return l(),void this._deferred.reject(new ae("view:no-layerview-for-layer","The layer has been removed from the map",{layer:s}));this.layerView=o,s.emit("layerview-create",{view:i,layerView:o}),i.emit("layerview-create",{layer:s,layerView:o}),this.done=!0,this._deferred.resolve(o)}catch(o){s.emit("layerview-create-error",{view:i,error:o}),i.emit("layerview-create-error",{layer:s,error:o}),this.done=!0,this._deferred.reject(new ae("layerview:create-error","layerview creation failed",{layer:s,error:o}))}}},vu=class extends Ye{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new x_,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var i;const s=(i=this.view.map)==null?void 0:i.allLayers;if(s)for(const r of s)this.layerViewImporter.hasLayerViewModule(r)&&this.layerViewImporter.importLayerView(r)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=Xl(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(OC(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var l,u,c;if(this.destroyed)return;const s=this.view.map;if(this._map!==s&&(this.clear(),this._map=s),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const i=new Set,r=[],n=this.view.ready,o=h=>{if(h!=null){for(const m of h)if(m){i.add(m);const f=this._layerLayerViewInfoMap.get(m);f&&n?f.start():f||this._recyclingInfoMap.has(m)||r.push(m),"layers"in m&&m.layers&&o(m.layers)}}};for(const h of this._rootCollectionNames)o(Xa(this,h));for(const[h,m]of this._layerLayerViewInfoMap)if(!i.has(h)){this._layerLayerViewInfoMap.delete(m.layer);const f=m.tryRecycle(r);f?(this.notifyChange("updating"),this._recyclingInfoMap.set(m.layer,m),f.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(m.layer),this._layerLayerViewInfoMap.set(m.layer,m),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(m.layer),m.destroy(),this._reschedule()})):m.destroy()}for(const[h,m]of this._recyclingInfoMap)i.has(h)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(m.layer),m.destroy());for(const h of r)this._createLayerView(h);this._refreshCollections();const a=[(l=s==null?void 0:s.ground)==null?void 0:l.layers,(u=s==null?void 0:s.basemap)==null?void 0:u.baseLayers,(c=s==null?void 0:s.basemap)==null?void 0:c.referenceLayers,s==null?void 0:s.layers].filter(h=>!!h);i.forEach(h=>"layers"in h&&a.push(h.layers)),this.addHandles(a.map(h=>this._watchUpdatingTracking.addOnCollectionChange(()=>h,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([Vo(()=>{var e,s;return(s=(e=this.view)==null?void 0:e.map)==null?void 0:s.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),Ee(()=>{const e=this.view,s=e==null?void 0:e.map;return[s==null?void 0:s.basemap,s==null?void 0:s.ground,s==null?void 0:s.layers,e==null?void 0:e.ready]},()=>this._reschedule(),Ga)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),k4(this._recyclingInfoMap),k4(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(xi()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||sEe(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const s of this._layerLayerViewInfoMap.values())s.done||++e;return e}clear(){this.destroyed||(k4(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new ae("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}isCreatingLayerViewsForLayer(e,s){var n;this.commitProperty("updatingRemaining");const i=this._layerLayerViewInfoMap.get(e);if(!(i!=null&&i.done))return!0;const r=i.layerView;return!(!r||!s||r.parent===s)||!!(i.done&&r&&"layers"in e&&((n=e.layers)!=null&&n.length))&&e.layers.some(o=>this.isCreatingLayerViewsForLayer(o,r))}_refreshCollections(){for(const[e,s]of this._layersToLayerViews)this._populateLayerViewsOwners(Xa(this,e),Xa(this,s),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,s,i){if(!e||!s)return void(s&&s.removeAll());let r=0;for(const n of e){const o=this._layerLayerViewInfoMap.get(n);if(!(o!=null&&o.layerView))continue;const a=o.layerView;a.layer=n,a.parent=i,s.at(r)!==a&&s.splice(r,0,a),"layers"in n&&G4e(a)&&this._populateLayerViewsOwners(n.layers,a.layerViews,a),r+=1}r<s.length&&s.splice(r,s.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const s=new z4e(e,this.view,this.layerViewImporter);s.promise.then(()=>this._refreshCollections(),i=>{i&&(Lr(i)||i.name==="cancelled:layerview-create")||Ne.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:i}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,s),this.view.ready&&s.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};p([_()],vu.prototype,"_workPromise",void 0),p([_({readOnly:!0})],vu.prototype,"_watchUpdatingTracking",void 0),p([_({readOnly:!0})],vu.prototype,"_layersToLayerViews",null),p([_({readOnly:!0})],vu.prototype,"_rootCollectionNames",null),p([_()],vu.prototype,"layerViewImporter",void 0),p([_()],vu.prototype,"supportsGround",void 0),p([_({readOnly:!0})],vu.prototype,"updating",null),p([_({readOnly:!0})],vu.prototype,"updatingRemaining",null),p([_({constructOnly:!0})],vu.prototype,"view",void 0),vu=p([Q("esri.views.LayerViewManager")],vu);const U4e=vu;function B4e(t){return t.createLayerView!==XC.prototype.createLayerView}let wl=class extends Ye{constructor(e){super(e),this.factor=1.5,this.offset=Bn(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};p([_({type:Number})],wl.prototype,"factor",void 0),p([_({nonNullable:!0})],wl.prototype,"offset",void 0),p([_()],wl.prototype,"position",void 0),p([_({type:Number,range:{min:0}})],wl.prototype,"size",void 0),p([_()],wl.prototype,"maskUrl",void 0),p([_()],wl.prototype,"maskEnabled",void 0),p([_()],wl.prototype,"overlayUrl",void 0),p([_()],wl.prototype,"overlayEnabled",void 0),p([_({readOnly:!0})],wl.prototype,"version",null),p([_({type:Boolean})],wl.prototype,"visible",void 0),wl=p([Q("esri.views.Magnifier")],wl);const ide=wl;let E_=class{constructor(e){this._observable=new ix,this._map=new Map(e)}get size(){return lt(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const s=this._map.delete(e);return s&&this._observable.notify(),s}entries(){return lt(this._observable),this._map.entries()}forEach(e,s){lt(this._observable),this._map.forEach((i,r)=>e.call(s,i,r,this),s)}get(e){return lt(this._observable),this._map.get(e)}has(e){return lt(this._observable),this._map.has(e)}keys(){return lt(this._observable),this._map.keys()}set(e,s){return this._map.set(e,s),this._observable.notify(),this}values(){return lt(this._observable),this._map.values()}[Symbol.iterator](){return lt(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var dV;let h_=dV=class extends Te{constructor(t){super(t),this.name=null,this.code=null}clone(){return new dV({name:this.name,code:this.code})}};p([_({type:String,json:{write:{isRequired:!0}}})],h_.prototype,"name",void 0),p([_({type:[String,Number],json:{write:{isRequired:!0}}})],h_.prototype,"code",void 0),h_=dV=p([Q("esri.layers.support.CodedValue")],h_);const j4e=new Jt({inherited:"inherited",codedValue:"coded-value",range:"range"});let Z2=class extends Te{constructor(e){super(e),this.name=null,this.type=null}};p([_({type:String,json:{write:!0}})],Z2.prototype,"name",void 0),p([mt(j4e),_({json:{write:{isRequired:!0}}})],Z2.prototype,"type",void 0),Z2=p([Q("esri.layers.support.Domain")],Z2);const v$=Z2;var pV;let Q2=pV=class extends v${constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const s=String(t);this.codedValues.some(i=>(String(i.code)===s&&(e=i.name),!!e))}return e}clone(){return new pV({codedValues:he(this.codedValues),name:this.name})}};p([_({type:[h_],json:{write:{isRequired:!0}}})],Q2.prototype,"codedValues",void 0),p([mt({codedValue:"coded-value"})],Q2.prototype,"type",void 0),Q2=pV=p([Q("esri.layers.support.CodedValueDomain")],Q2);const b$=Q2;var fV;let _A=fV=class extends v${constructor(t){super(t),this.type="inherited"}clone(){return new fV}};p([mt({inherited:"inherited"})],_A.prototype,"type",void 0),_A=fV=p([Q("esri.layers.support.InheritedDomain")],_A);const rde=_A;var gV;let H1=gV=class extends v${constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new gV({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};p([_({json:{type:[Number],read:{source:"range",reader:(t,e)=>{var s;return(s=e.range)==null?void 0:s[1]}},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,s){e[s]=[this.minValue||0,t]},isRequired:!0}}})],H1.prototype,"maxValue",void 0),p([_({json:{type:[Number],read:{source:"range",reader:(t,e)=>{var s;return(s=e.range)==null?void 0:s[0]}},write:{target:"range",writer(t,e,s){e[s]=[t,this.maxValue||0]},isRequired:!0}}})],H1.prototype,"minValue",void 0),p([mt({range:"range"})],H1.prototype,"type",void 0),H1=gV=p([Q("esri.layers.support.RangeDomain")],H1);const nde=H1,ode={key:"type",base:v$,typeMap:{range:nde,"coded-value":b$,inherited:rde}};function x$(t){if(!(t!=null&&t.type))return null;switch(t.type){case"range":return nde.fromJSON(t);case"codedValue":return b$.fromJSON(t);case"inherited":return rde.fromJSON(t)}return null}const H4e=new Jt({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var yV;const Y4e=new Jt({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let Co=yV=class extends Te{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(t,{description:e}){let s=null;try{s=e?JSON.parse(e):null}catch{}return(s==null?void 0:s.value)??null}readValueType(t,{description:e}){let s=null;try{s=e?JSON.parse(e):null}catch{}return s?Y4e.fromJSON(s.fieldValueType):null}clone(){var t;return new yV({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:((t=this.domain)==null?void 0:t.clone())??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};p([_({type:String,json:{write:!0}})],Co.prototype,"alias",void 0),p([_({type:[String,Number],json:{write:{allowNull:!0}}})],Co.prototype,"defaultValue",void 0),p([_()],Co.prototype,"description",void 0),p([qe("description")],Co.prototype,"readDescription",null),p([_({types:ode,json:{read:{reader:x$},write:!0}})],Co.prototype,"domain",void 0),p([_({type:Boolean,json:{write:!0}})],Co.prototype,"editable",void 0),p([_({type:fs,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],Co.prototype,"length",void 0),p([_({type:String,json:{write:!0}})],Co.prototype,"name",void 0),p([_({type:Boolean,json:{write:!0}})],Co.prototype,"nullable",void 0),p([mt(H4e)],Co.prototype,"type",void 0),p([_()],Co.prototype,"valueType",void 0),p([qe("valueType",["description"])],Co.prototype,"readValueType",null),p([_({type:Boolean,json:{read:!1}})],Co.prototype,"visible",void 0),Co=yV=p([Q("esri.layers.support.Field")],Co);const oP=Co;var _V;let Y1=_V=class extends Te{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new _V({mapLayerId:t,gdbVersion:e})}};p([mt({mapLayer:"map-layer"}),_({json:{write:{isRequired:!0}}})],Y1.prototype,"type",void 0),p([_({type:fs,json:{write:{isRequired:!0}}})],Y1.prototype,"mapLayerId",void 0),p([_({type:String,json:{write:!0}})],Y1.prototype,"gdbVersion",void 0),Y1=_V=p([Q("esri.layers.support.source.MapLayerSource")],Y1);var vV;let Gm=vV=class extends Te{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:s,spatialReference:i,geometryType:r}=this,n={workspaceId:t,query:e,oidFields:s,spatialReference:(i==null?void 0:i.clone())??void 0,geometryType:r};return new vV(n)}};p([mt({queryTable:"query-table"}),_({json:{write:{isRequired:!0}}})],Gm.prototype,"type",void 0),p([_({type:String,json:{write:!0}})],Gm.prototype,"workspaceId",void 0),p([_({type:String,json:{write:!0}})],Gm.prototype,"query",void 0),p([_({type:String,json:{write:!0}})],Gm.prototype,"oidFields",void 0),p([_({type:St,json:{write:!0}})],Gm.prototype,"spatialReference",void 0),p([mt(Qz)],Gm.prototype,"geometryType",void 0),Gm=vV=p([Q("esri.layers.support.source.QueryTableDataSource")],Gm);var bV;let X1=bV=class extends Te{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new bV({workspaceId:t,dataSourceName:e})}};p([mt({raster:"raster"}),_({json:{write:{isRequired:!0}}})],X1.prototype,"type",void 0),p([_({type:String,json:{write:!0}})],X1.prototype,"dataSourceName",void 0),p([_({type:String,json:{write:!0}})],X1.prototype,"workspaceId",void 0),X1=bV=p([Q("esri.layers.support.source.RasterDataSource")],X1);var xV;let Sy=xV=class extends Te{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:s}=this;return new xV({workspaceId:t,gdbVersion:e,dataSourceName:s})}};p([mt({table:"table"}),_({json:{write:{isRequired:!0}}})],Sy.prototype,"type",void 0),p([_({type:String,json:{write:!0}})],Sy.prototype,"workspaceId",void 0),p([_({type:String,json:{write:!0}})],Sy.prototype,"gdbVersion",void 0),p([_({type:String,json:{write:!0}})],Sy.prototype,"dataSourceName",void 0),Sy=xV=p([Q("esri.layers.support.source.TableDataSource")],Sy);var wV,SV;const X4e=Xn()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let Sl=wV=class extends Te{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,s){return PQ()(t,e,s)}castLeftTableSource(t){return Hc(EV(),t)}readRightTableSource(t,e,s){return PQ()(t,e,s)}castRightTableSource(t){return Hc(EV(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:s,rightTableSource:i,joinType:r}=this,n={leftTableKey:t,rightTableKey:e,leftTableSource:(s==null?void 0:s.clone())??void 0,rightTableSource:(i==null?void 0:i.clone())??void 0,joinType:r};return new wV(n)}};p([mt({joinTable:"join-table"}),_({json:{write:{isRequired:!0}}})],Sl.prototype,"type",void 0),p([_({type:String,json:{write:!0}})],Sl.prototype,"leftTableKey",void 0),p([_({type:String,json:{write:!0}})],Sl.prototype,"rightTableKey",void 0),p([_({json:{write:!0}})],Sl.prototype,"leftTableSource",void 0),p([qe("leftTableSource")],Sl.prototype,"readLeftTableSource",null),p([Ht("leftTableSource")],Sl.prototype,"castLeftTableSource",null),p([_({json:{write:!0}})],Sl.prototype,"rightTableSource",void 0),p([qe("rightTableSource")],Sl.prototype,"readRightTableSource",null),p([Ht("rightTableSource")],Sl.prototype,"castRightTableSource",null),p([mt(X4e)],Sl.prototype,"joinType",void 0),Sl=wV=p([Q("esri.layers.support.source.JoinTableDataSource")],Sl);let B4=null;function PQ(){return B4||(B4=Jb({types:EV()})),B4}let j4=null;function EV(){return j4||(j4={key:"type",base:null,typeMap:{"data-layer":Ic,"map-layer":Y1}}),j4}const W4e={key:"type",base:null,typeMap:{"join-table":Sl,"query-table":Gm,raster:X1,table:Sy}};let Ic=SV=class extends Te{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:e}=this;return new SV({fields:t,dataSource:e})}};p([mt({dataLayer:"data-layer"}),_({json:{write:{isRequired:!0}}})],Ic.prototype,"type",void 0),p([_({type:[oP],json:{write:!0}})],Ic.prototype,"fields",void 0),p([_({types:W4e,json:{write:!0}})],Ic.prototype,"dataSource",void 0),Ic=SV=p([Q("esri.layers.support.source.DataLayerSource")],Ic),Ic.from=nn(Ic);let Ey=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};p([_({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Ey.prototype,"onFields",void 0),p([_({type:String,json:{write:!0}})],Ey.prototype,"operator",void 0),p([_({type:String,json:{write:!0}})],Ey.prototype,"searchTerm",void 0),p([_({type:String,json:{write:!0}})],Ey.prototype,"searchType",void 0),Ey=p([Q("esri.rest.support.FullTextSearch")],Ey);const Z4e=Ey;var CV;const TQ=new Jt({upperLeft:"upper-left",lowerLeft:"lower-left"});let Cy=CV=class extends Te{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new CV(he({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};p([_({type:Hs,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Cy.prototype,"extent",void 0),p([_({type:["view","edit"],json:{write:!0}})],Cy.prototype,"mode",void 0),p([_({type:String,json:{read:TQ.read,write:TQ.write}})],Cy.prototype,"originPosition",void 0),p([_({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Cy.prototype,"tolerance",void 0),Cy=CV=p([Q("esri.rest.support.QuantizationParameters")],Cy);const ade=Cy,Q4e=new Jt({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var PV;const IQ=new Jt({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let gc=PV=class extends Te{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=he(t))}clone(){return new PV({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:he(this.statisticParameters)})}};p([_({type:Number,json:{write:!0}})],gc.prototype,"maxPointCount",void 0),p([_({type:Number,json:{write:!0}})],gc.prototype,"maxRecordCount",void 0),p([_({type:Number,json:{write:!0}})],gc.prototype,"maxVertexCount",void 0),p([_({type:String,json:{write:!0}})],gc.prototype,"onStatisticField",void 0),p([_({type:String,json:{write:!0}})],gc.prototype,"outStatisticFieldName",void 0),p([_({type:String,json:{read:{source:"statisticType",reader:IQ.read},write:{target:"statisticType",writer:IQ.write}}})],gc.prototype,"statisticType",void 0),p([_({type:Object})],gc.prototype,"statisticParameters",void 0),p([Ue("statisticParameters")],gc.prototype,"writeStatisticParameters",null),gc=PV=p([Q("esri.rest.support.StatisticDefinition")],gc);const lde=gc;var vA;const J4e=new Jt({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let ft=vA=class extends Te{static from(t){return Qb(vA,t)}constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.returnTrueCurves=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(t){return typeof t=="number"||typeof t=="object"?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeParameterValues(t,e){if(t){const s={};for(const i in t){const r=t[i];Array.isArray(r)?s[i]=r.map(n=>n instanceof Date?n.getTime():n):r instanceof Date?s[i]=r.getTime():s[i]=r}e.parameterValues=s}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1"}writeWhere(t,e){e.where=t||"1=1"}clone(){return new vA(he({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,returnTrueCurves:this.returnTrueCurves,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};ft.MAX_MAX_RECORD_COUNT_FACTOR=5,p([_({json:{write:!0}})],ft.prototype,"aggregateIds",void 0),p([_({type:Boolean,json:{write:!0}})],ft.prototype,"cacheHint",void 0),p([_({type:Boolean,json:{default:!1,write:!0}})],ft.prototype,"compactGeometryEnabled",void 0),p([_({json:{write:!0}})],ft.prototype,"datumTransformation",void 0),p([Ht("datumTransformation")],ft.prototype,"castDatumTransformation",null),p([_({type:Boolean,json:{default:!1,write:!0}})],ft.prototype,"defaultSpatialReferenceEnabled",void 0),p([_({type:Number,json:{write:!0}})],ft.prototype,"distance",void 0),p([_({type:Ic,json:{write:!0}})],ft.prototype,"dynamicDataSource",void 0),p([_({type:String,json:{write:!0}})],ft.prototype,"formatOf3DObjects",void 0),p([_({type:[Z4e],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],ft.prototype,"fullText",void 0),p([_({type:String,json:{write:!0}})],ft.prototype,"gdbVersion",void 0),p([_({types:GC,json:{read:Y_,write:!0}})],ft.prototype,"geometry",void 0),p([_({type:Number,json:{write:!0}})],ft.prototype,"geometryPrecision",void 0),p([_({type:[String],json:{write:!0}})],ft.prototype,"groupByFieldsForStatistics",void 0),p([_({type:String,json:{write:!0}})],ft.prototype,"having",void 0),p([_({type:Date})],ft.prototype,"historicMoment",void 0),p([Ue("historicMoment")],ft.prototype,"writeHistoricMoment",null),p([_({type:Number,json:{write:!0}})],ft.prototype,"maxAllowableOffset",void 0),p([_({type:Number,cast:t=>t<1?1:t>ft.MAX_MAX_RECORD_COUNT_FACTOR?ft.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],ft.prototype,"maxRecordCountFactor",void 0),p([_({type:["xyFootprint"],json:{write:!0}})],ft.prototype,"multipatchOption",void 0),p([_({type:Number,json:{read:{source:"resultRecordCount"}}})],ft.prototype,"num",void 0),p([_({json:{write:!0}})],ft.prototype,"objectIds",void 0),p([_({type:[String],json:{write:!0}})],ft.prototype,"orderByFields",void 0),p([_({type:[String],json:{write:!0}})],ft.prototype,"outFields",void 0),p([_({type:St,json:{name:"outSR",write:!0}})],ft.prototype,"outSpatialReference",void 0),p([_({type:[lde],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],ft.prototype,"outStatistics",void 0),p([_({json:{write:!0}})],ft.prototype,"parameterValues",void 0),p([Ue("parameterValues")],ft.prototype,"writeParameterValues",null),p([_({type:Et,json:{write:!0}})],ft.prototype,"pixelSize",void 0),p([_({type:ade,json:{write:!0}})],ft.prototype,"quantizationParameters",void 0),p([_({type:[Object],json:{write:!0}})],ft.prototype,"rangeValues",void 0),p([_({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],ft.prototype,"relationParameter",void 0),p([_({type:String,json:{write:!0}})],ft.prototype,"resultType",void 0),p([_({type:Boolean,json:{default:!1,write:!0}})],ft.prototype,"returnCentroid",void 0),p([_({type:Boolean,json:{default:!1,write:!0}})],ft.prototype,"returnDistinctValues",void 0),p([_({type:Boolean,json:{default:!0,write:!0}})],ft.prototype,"returnExceededLimitFeatures",void 0),p([_({type:Boolean,json:{write:!0}})],ft.prototype,"returnGeometry",void 0),p([_({type:Boolean,json:{default:!1,write:!0}})],ft.prototype,"returnQueryGeometry",void 0),p([_({type:Boolean,json:{default:!1,write:!0}})],ft.prototype,"returnM",void 0),p([_({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],ft.prototype,"returnZ",void 0),p([_({type:Boolean,json:{write:!0}})],ft.prototype,"returnTrueCurves",void 0),p([_({type:St,json:{write:!0}})],ft.prototype,"sourceSpatialReference",void 0),p([mt(Q4e,{ignoreUnknown:!1,name:"spatialRel"})],ft.prototype,"spatialRelationship",void 0),p([_({type:Number,json:{read:{source:"resultOffset"}}})],ft.prototype,"start",void 0),p([Ue("start"),Ue("num")],ft.prototype,"writeStart",null),p([_({type:String,json:{write:!0}})],ft.prototype,"sqlFormat",void 0),p([_({type:String,json:{write:!0}})],ft.prototype,"text",void 0),p([_({type:Ad,json:{write:!0}})],ft.prototype,"timeExtent",void 0),p([_({type:Boolean,json:{default:!1,write:!0}})],ft.prototype,"timeReferenceUnknownClient",void 0),p([mt(J4e,{ignoreUnknown:!1}),_({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null}}}}})],ft.prototype,"units",void 0),p([_({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],ft.prototype,"where",void 0),p([Ue("where")],ft.prototype,"writeWhere",null),ft=vA=p([Q("esri.rest.support.Query")],ft);const xn=ft;function vI(t){return!!(t!=null&&typeof t=="object"&&"createQuery"in t&&t.createQuery&&"on"in t&&t.on)}let xh=class extends Wl.EventedAccessor{constructor(e){super(e),this._selectionMap=new E_,this._sources=new Ge,this._trashCan=[],this._layerEditHandles=new Ge,this._vizTaskId=0,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([Ee(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),Vo(()=>this.sources,"change",s=>{const i=this._selectionMap;for(const r of s.removed)i.delete(r);this._refreshListeners(),this._refreshVisualization()},{onListenerAdd:()=>this._refreshListeners()})]);const e=new Ge;this.view.when().then(()=>{this.view.map&&(this.view.map.allLayers.flatten(s=>"sublayers"in s&&s.sublayers?s.sublayers:null).forEach(s=>{(vI(s)&&!B$e(s)||cd(s))&&e.add(s)}),this.sources=e)})}destroy(){this._layerEditHandles.drain(qi)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[s,i]=e;return{layer:s,selection:[...i.selection]}})}get count(){let e=0;for(const s of this._selectionMap.values())e+=s.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){Md(e,this._sources)}async getSelectedFeatures(e,s={},i="layerView"){const{view:r,selections:n}=this,o=(e!==void 0?n.filter(a=>e.includes(a.layer)):n).filter(a=>a.selection.length>0).map(async a=>{const{layer:l,selection:u}=a,c=cd(l)?l.parent:l;if(c==null||!AQ(c))return null;if(i==="layer")return NQ(c,u,s);if(MQ(c))return null;const h=await r.whenLayerView(c).catch(()=>null);return h?NQ(h,u,s):null});return(await Promise.all(o)).filter(a=>a!=null)}updateSelection(e){const s=new Map;for(const[n,o]of this._selectionMap)s.set(n,[...o.selection]);let i=!1;const r=e.current.concat(e.added);for(const n of r){const o=n.sourceLayer,a=n.getObjectId();if(this.sources.includes(o)&&(vI(o)||cd(o))&&a!==null){const l=Zb(s,o,()=>[]);l.includes(a)||(l.push(a),i=!0)}}for(const n of e.removed){const o=n.sourceLayer,a=n.getObjectId();if(this.sources.includes(o)&&(vI(o)||cd(o))&&a!==null){const l=s.get(o),u=l==null?void 0:l.indexOf(a);u!==void 0&&u>=0&&(l==null||l.splice(u,1),i=!0)}}if(i){const{_selectionMap:n,_trashCan:o}=this,a=[];for(const[l,u]of s){const c=n.get(l);c!==void 0&&o.push(c),n.set(l,{selection:u}),a.push({layer:l,selection:u,...kX(c!==void 0?c.selection:[],u)})}this._onSelectionChange(a)}}setSelection(e,s){this._setSelection(e,s)}getSelection(e){const s=this._selectionMap.get(e);return s==null?void 0:s.selection}appendToSelection(e,s){const i=this._selectionMap.get(e),r=i!==void 0?[...i.selection]:[];for(const n of s)r.includes(n)||r.push(n);this._setSelection(e,r)}removeFromSelection(e,s){const i=this._selectionMap.get(e);if(!i)return;const r=[];for(const n of i.selection)s.includes(n)||r.push(n);this._setSelection(e,r)}toggleInSelection(e,s){const i=this._selectionMap.get(e);if(!i||i.selection.length===0)return void this._setSelection(e,s);const r=new Set(i.selection),n=new Set(s),o=$Ce(r,n);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const s=[];for(const[i,r]of this._selectionMap.entries())s.push({layer:i,added:[],removed:[...r.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(s)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){var o;if(this.view==null||this.sources==null)return;for(this._vizTaskId++;this._trashCan.length>0;){const a=this._trashCan.pop();(o=a==null?void 0:a.highlightHandle)==null||o.remove()}const{sources:e,view:s,_selectionMap:i,showHighlight:r}=this,n=this._vizTaskId;for(const a of e){const l=i.get(a),u=cd(a)?a.parent:a;if(u!=null&&AQ(u)){if(MQ(u))continue;s.whenLayerView(u).then(c=>{var h;(h=l==null?void 0:l.highlightHandle)==null||h.remove(),l!=null&&r&&n===this._vizTaskId&&"highlight"in c&&typeof c.highlight=="function"&&l.selection.length>0&&(l.highlightHandle=c.highlight(l.selection,this.highlightName))}).catch(()=>{var c;(c=l==null?void 0:l.highlightHandle)==null||c.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(qi);for(const e of this.sources){const s=cd(e)?e.parent:e;if(s!=null&&vI(s)){const i=s.on("edits",r=>{this._handleEditChanges(r,e)});this._layerEditHandles.push(i)}}}_handleEditChanges(e,s){if(e.deletedFeatures!==void 0&&e.deletedFeatures.length>0&&this._selectionMap.has(s)){const i=e.deletedFeatures.filter(r=>r.error==null).map(r=>r.objectId).filter(Qa);this.removeFromSelection(s,i)}}_setSelection(e,s){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const i=this._selectionMap.get(e);if(i===void 0||!eOe(i,{selection:s})){i!==void 0&&this._trashCan.push(i),this._selectionMap.set(e,{selection:[...s]});const r={layer:e,selection:[...s],...kX(i!==void 0?i.selection:[],s)};this._onSelectionChange([r])}}};p([_({readOnly:!0,nonNullable:!0})],xh.prototype,"selections",null),p([_({readOnly:!0,nonNullable:!0})],xh.prototype,"count",null),p([_({constructOnly:!0,nonNullable:!0})],xh.prototype,"view",void 0),p([_({readOnly:!0,nonNullable:!0})],xh.prototype,"hasSelection",null),p([_()],xh.prototype,"showHighlight",void 0),p([_()],xh.prototype,"sources",null),p([_()],xh.prototype,"highlightName",void 0),xh=p([Q("esri.views.SelectionManager")],xh);const MQ=t=>{var e;return cd(t)?((e=t.parent)==null?void 0:e.isTable)===!0:t.isTable},K4e=t=>t.layer!==void 0,AQ=t=>(t==null?void 0:t.when)!==void 0,eOe=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const s=[...t.selection],i=[...e.selection];if(s.length!==i.length)return!1;s.sort(),i.sort();for(let r=0;r<s.length;r++)if(s[r]!==i[r])return!1}return!0},NQ=async(t,e,s={})=>{let i;if(K4e(t)){const r=t;i=r===void 0?null:await r.queryFeatures(new xn({...s,objectIds:e})).then(n=>({data:n,layer:t.layer}))}else{const r=t;i=r===void 0?null:await r.queryFeatures(new xn({...s,objectIds:e})).then(n=>({data:n,layer:r}))}return i},tOe=xh;let J2=class extends Wt.ClonableMixin(Ye){constructor(e){super(e),this.accentColor=new Be([255,127,0]),this.textColor=new Be([255,255,255])}};p([_({type:Be,nonNullable:!0})],J2.prototype,"accentColor",void 0),p([_({type:Be,nonNullable:!0})],J2.prototype,"textColor",void 0),J2=p([Q("esri.views.Theme")],J2);const TV=J2;var DQ;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"})(DQ||(DQ={}));const ude=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],cde={};function hde(t){return!!cde[t]}function sOe(t){for(const e of t)if(!hde(e))return!1;return!0}ude.forEach(t=>{cde[t]=!0});let mde=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:s,priority:i},r)=>{var n;return(n=this.inputManager)==null?void 0:n.installHandlers(r,[s],i)})}disconnect(){this.inputManager&&this._handlers.forEach((e,s)=>{var i;return(i=this.inputManager)==null?void 0:i.uninstallHandlers(s)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,s,i,r){const n=Array.isArray(e)?e:e.split(",");if(!sOe(n))return n.some(hde)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(s)?a=s:(o=s,a=[]),typeof i=="function"?o=i:r=i,r=r??Gf.DEFAULT;const l=this._createUniqueGroupName(),u=new iOe(this.view,n,a,o);this._handlers.set(l,{handler:u,priority:r});for(const c of n){const h=this._handlerCounts.get(c)||0;this._handlerCounts.set(c,h+1)}return this.inputManager&&this.inputManager.installHandlers(l,[u],r),xs(()=>this._removeHandler(l,n))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,s){if(this._handlers.has(e)){this._handlers.delete(e);for(const i of s){const r=this._handlerCounts.get(i);r===void 0||(r===1?this._handlerCounts.delete(i):this._handlerCounts.set(i,r-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},iOe=class extends Cn{constructor(e,s,i,r){super(!0),this._latestDragStart=void 0,this.view=e;for(const n of s)switch(n){case"click":this.registerIncoming("click",i,o=>r(oOe(e,o)));break;case"double-click":this.registerIncoming("double-click",i,o=>r(aOe(e,o)));break;case"immediate-click":this.registerIncoming("immediate-click",i,o=>r(lOe(e,o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,o=>r(uOe(e,o)));break;case"hold":this.registerIncoming("hold",i,o=>r(cOe(e,o)));break;case"drag":this.registerIncoming("drag",i,o=>{const a=this._wrapDrag(o);a&&r(a)});break;case"key-down":this.registerIncoming("key-down",i,o=>r(hOe(o)));break;case"key-up":this.registerIncoming("key-up",i,o=>r(mOe(o)));break;case"pointer-down":this.registerIncoming("pointer-down",i,o=>r(Hw(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",i,o=>r(Hw(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",i,o=>r(Hw(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,o=>r(dOe(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,o=>r(pOe(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,o=>r(Hw(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,o=>r(Hw(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",i,o=>{r(fOe(o))});break;case"focus":this.registerIncoming("focus",i,o=>{r(rOe(o))});break;case"blur":this.registerIncoming("blur",i,o=>{r(nOe(o))})}}_wrapDrag(e){const s=e.data,{x:i,y:r}=s.center,{action:n,pointerType:o,button:a}=s;if(n==="start"&&(this._latestDragStart=s),!this._latestDragStart)return;const l=s.pointer.native,u=s.buttons,{cancelable:c,timestamp:h}=e,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return n==="end"&&(this._latestDragStart=void 0),{type:"drag",action:n,x:i,y:r,origin:m,pointerType:o,button:a,buttons:u,radius:s.radius,angle:Pae(s.angle),native:l,timestamp:h,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}};function rOe(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function nOe(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function oOe(t,e){const{pointerType:s,button:i,buttons:r,x:n,y:o,native:a,eventId:l}=e.data,{cancelable:u,timestamp:c}=e;return{type:"click",pointerType:s,button:i,buttons:r,x:n,y:o,native:a,timestamp:c,screenPoint:Bn(n,o),mapPoint:aP(t,n,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}function aOe(t,e){const{pointerType:s,button:i,buttons:r,x:n,y:o,native:a,eventId:l}=e.data,{cancelable:u,timestamp:c}=e;return{type:"double-click",pointerType:s,button:i,buttons:r,x:n,y:o,native:a,timestamp:c,mapPoint:aP(t,n,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}function lOe(t,e){const{pointerType:s,button:i,buttons:r,x:n,y:o,native:a,eventId:l}=e.data,u=a.pointerId,{cancelable:c,timestamp:h}=e;return{type:"immediate-click",pointerId:u,pointerType:s,button:i,buttons:r,x:n,y:o,native:a,timestamp:h,mapPoint:aP(t,n,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}function uOe(t,e){const{pointerType:s,button:i,buttons:r,x:n,y:o,native:a,eventId:l}=e.data,u=a.pointerId,{cancelable:c,timestamp:h}=e;return{type:"immediate-double-click",pointerId:u,pointerType:s,button:i,buttons:r,x:n,y:o,native:a,timestamp:h,mapPoint:aP(t,n,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}function cOe(t,e){const{pointerType:s,button:i,buttons:r,x:n,y:o,native:a}=e.data,{cancelable:l,timestamp:u}=e;return{type:"hold",pointerType:s,button:i,buttons:r,x:n,y:o,native:a,timestamp:u,mapPoint:aP(t,n,o),cancelable:l,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}function aP(t,e,s){return t.toMap(Bn(e,s),{exclude:[]})}function hOe(t){const{key:e,repeat:s,native:i}=t.data,{cancelable:r,timestamp:n}=t;return{type:"key-down",key:e,repeat:s,native:i,timestamp:n,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:o=>t.async(o),preventDefault:()=>t.preventDefault()}}function mOe(t){const{key:e,native:s}=t.data,{cancelable:i,timestamp:r}=t;return{type:"key-up",key:e,native:s,timestamp:r,cancelable:i,stopPropagation:()=>t.stopPropagation(),async:n=>t.async(n),preventDefault:()=>t.preventDefault()}}function Hw(t,e){const{x:s,y:i,button:r,buttons:n,native:o,eventId:a}=t.data,l=o.pointerId,u=o.pointerType,{cancelable:c,timestamp:h}=t;return{type:e,x:s,y:i,pointerId:l,pointerType:u,button:r,buttons:n,native:o,timestamp:h,eventId:a,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:m=>t.async(m),preventDefault:()=>t.preventDefault()}}function dOe(t){const{x:e,y:s,buttons:i,native:r,eventId:n}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,u=t.data.action,c={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:h,timestamp:m}=t;return{type:"pointer-drag",x:e,y:s,pointerId:a,pointerType:l,button:o,buttons:i,action:u,origin:c,native:r,timestamp:m,eventId:n,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:f=>t.async(f),preventDefault:()=>t.preventDefault()}}function pOe(t){const{cancelable:e,data:s,timestamp:i}=t,{x:r,y:n,deltaY:o,native:a}=s;return{type:"mouse-wheel",x:r,y:n,deltaY:o,native:a,timestamp:i,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:l=>t.async(l),preventDefault:()=>t.preventDefault()}}function fOe(t){const{action:e,state:s,device:i}=t.data,{cancelable:r,timestamp:n}=t,{buttons:o,axes:a}=s;return{type:"gamepad",device:i,timestamp:n,action:e,buttons:o,axes:a,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:l=>t.async(l),preventDefault:()=>t.preventDefault()}}var LE,$Q,RQ;(function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"})(LE||(LE={})),function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"}($Q||($Q={})),function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"}(RQ||(RQ={}));function gOe(t){return[t.on("before-add",e=>{const s=e.item;if(s==null||t.includes(s))return Ne.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();s.onAdd()}),t.on("after-remove",e=>{const s=e.item;s.active&&(s.view.activeTool=null),s.destroy()})]}function IV(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(LE.USER)&&t.getEditableFlag(LE.MANAGER)}function wh(t){return Bn(t.x,t.y)}function dde(t,e){var i;const s=(i=t instanceof HTMLElement?t:t.surface)==null?void 0:i.getBoundingClientRect();return s?Bn(e.clientX-s.left,e.clientY-s.top):Bn(0,0)}function pde(t,e){return e instanceof Event?dde(t,e):wh(e)}function fde(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let yOe=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,s){const i=()=>e.stopPropagation();switch(e.type){case"pointer-move":FQ(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(i(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!OQ(e))break;const r=wh(e),n=g1(r,e.pointerType,s.forEachTool);if(n==null)break;const o=n.manipulator,a=n.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,s),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:a,start:r,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&s.activeTool==null&&(this._revertToNullActiveTool=!0,s.setActiveTool(n.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:r}),i());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,s);break;case"pointer-drag":{if(!OQ(e))break;const r=this._grabbedManipulators.get(e.pointerId),n=r==null?void 0:r.manipulator,o=r==null?void 0:r.tool;if(n==null||o==null)break;const a=wh(e);a.x=Ka(a.x,0,s.view.width),a.y=Ka(a.y,0,s.view.height);const l=r.start,u=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(n.dragging=!0,u?n.events.emit("drag",{action:"update",start:l,screenPoint:a}):n.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:n,start:l}));break;case"end":n.dragging=!1,u&&n.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,s)}i();break}case"immediate-click":{const r=wh(e),n=g1(r,e.pointerType,s.forEachTool);if(_Oe(e)||s.forEachTool(u=>{if((n==null||n.tool!==u||u.automaticManipulatorSelection)&&u.manipulators){let c=!1;u.manipulators.forEach(({manipulator:h})=>{h.selected&&(h.selected=!1,c=!0)}),c&&u.onManipulatorSelectionChanged&&u.onManipulatorSelectionChanged()}}),n==null)break;const{manipulator:o,tool:a}=n;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const l=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:i}),H4(o,i);break}case"click":{const r=wh(e),n=g1(r,e.pointerType,s.forEachTool),o=n==null?void 0:n.manipulator;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit(e.type,{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:a}),i();break}case"double-click":{const r=wh(e),n=g1(r,e.pointerType,s.forEachTool),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("double-click",{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:i}),H4(o,i);break}case"immediate-double-click":{const r=wh(e),n=g1(r,e.pointerType,s.forEachTool),o=n!=null?n.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:i}),e.pointerType==="mouse"&&H4(o,i);break}}this._onFocusChange(s.forEachTool)}_releaseManipulatorBeforeDragging(e,s,i){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:s.pointerType,screenPoint:wh(s)}),this._grabbedManipulators.forEach(({manipulator:r},n)=>{r===e&&this._grabbedManipulators.delete(n)}),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(e,s){var r;const i=(r=this._grabbedManipulators.get(e.pointerId))==null?void 0:r.manipulator;i!=null&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:wh(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(s.setActiveTool))}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=kQ(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=kQ(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const s=new Set,i=new Set;this._grabbedManipulators.forEach(({tool:r})=>{s.add(r)}),this._hoveredManipulators.forEach(({tool:r})=>{i.add(r)}),e(r=>{r.hasGrabbedManipulators=s.has(r),r.hasHoveredManipulators=i.has(r);const n=this._grabbedManipulators.values(),o=KEe(n,({tool:a})=>a===r);r.firstGrabbedManipulator=o!=null?o.manipulator:null})}clearPointers(e,{forEachTool:s,setActiveTool:i},r=!0,n){const o=(a,l)=>a===e&&(n==null||n===l);this._grabbedManipulators.forEach(({tool:a,manipulator:l,pointerType:u},c)=>{o(a,l)&&(this._grabbedManipulators.delete(c),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:u}))}),this._draggedManipulators.forEach(({tool:a,manipulator:l},u)=>{o(a,l)&&(this._draggedManipulators.delete(u),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),r&&this._hoveredManipulators.forEach(({tool:a,manipulator:l},u)=>{o(a,l)&&(this._hoveredManipulators.delete(u),l.hovering=!1)}),this._afterManipulatorRelease(i),this._onFocusChange(s)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((s,i)=>{this._updateHoveredStateForPointerAtScreenPosition(Bn(s.x,s.y),i,s.pointerType,e)})}handleHoverEvent(e,s){const i=e.type;i!=="pointer-up"&&i!=="immediate-click"&&i!=="pointer-move"||!FQ(e.pointerType)||(i!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(wh(e),e.pointerId,e.pointerType,s))}_updateHoveredStateForPointerAtScreenPosition(e,s,i,r){var a;let n=g1(e,i,r);const o=(a=this._hoveredManipulators.get(s))==null?void 0:a.manipulator;n==null||n.manipulator.interactive||(n=null),n!=null&&o===n.manipulator||(o!=null&&(o.hovering=!1),n!=null?(n.manipulator.hovering=!0,this._hoveredManipulators.set(s,n)):this._hoveredManipulators.delete(s),this._onFocusChange(r))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:s},i)=>{e===i&&(this._hoveredManipulators.delete(e),s.hovering=!1)})}};function kQ(t){for(const{manipulator:e}of t.values())if(e!=null&&e.interactive){if(e.grabbing&&e.grabCursor)return e.grabCursor;if(e.cursor)return e.cursor}return null}function g1(t,e,s){let i=null;return s(r=>{if(r.manipulators==null||!IV(r))return!1;const n=r.manipulators.intersect(t,e);return n!=null&&(i={tool:r,manipulator:n},!0)}),i}function FQ(t){return t==="mouse"}function OQ(t){return t.pointerType!=="mouse"||t.button===0}function _Oe(t){return!!t.native.shiftKey}function H4(t,e){t!=null&&t.consumesClicks&&e()}const LQ="attached",Y4="tools",vOe=1e3;let Sh=class extends Ye{constructor(e){super(e),this._updatingHandles=new x_,this._clock=ex,this._manipulatorState=new yOe,this.tools=new Ge,this.cursor=null,this._interacting=!1,this._interactingTimeout=vOe,this._interactingTimeoutHandle=null,this._forEachTool=s=>{for(const i of this.tools.items)if(s(i))return}}initialize(){this.addHandles([this.view.on(ude,e=>{this._handleInputEvent(e)},Gf.TOOL),...gOe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void Ne.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const s=this.activeTool;this._set("activeTool",e),s!=null&&s.deactivate(),e!=null&&e.activate(),this._removeIncompleteTools(e);for(const i of this.tools){this._updateToolEditableFlag(i);const r=IV(i);this.activeTool!=null&&r||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!r)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=qi(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){var e;this.view.type==="3d"?this.addHandles([Ee(()=>{const{state:s}=this.view;return"camera"in s&&s.camera},()=>this._forEachManipulator(s=>s.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",s=>this._forEachManipulator(i=>i.onElevationChange(s)))],LQ):this.addHandles(Ee(()=>this.view.extent,()=>this._forEachManipulator(s=>s.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(LQ),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(s=>{s.manipulators&&s.manipulators.forEach(({manipulator:i})=>e(i,s))})}_handleInputEvent(e){let s=!1;const i={...e,stopPropagation:()=>{s=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool(r=>{!s&&r.visible&&r.handleInputEvent(i)}),!s&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),s||this.activeTool==null||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(Y4),this._forEachTool(e=>{if(e instanceof Ye){const s=Ee(()=>[e.cursor,e.visible,e.editable],()=>{IV(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(s,Y4)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",s=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,s.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],Y4)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var s;(s=e.setEditableFlag)==null||s.call(e,LE.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(s=>!(s.cursor==null||!s.visible)&&(e=s.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(s=>(e==null||s!==e)&&!s.created&&s.removeIncompleteOnCancel).forEach(s=>{this.tools.remove(s)})}get test(){}};p([_({constructOnly:!0,nonNullable:!0})],Sh.prototype,"view",void 0),p([_({value:null})],Sh.prototype,"activeTool",null),p([_({readOnly:!0,type:Ge})],Sh.prototype,"tools",void 0),p([_({readOnly:!0})],Sh.prototype,"cursor",void 0),p([_({readOnly:!0})],Sh.prototype,"updating",null),p([_()],Sh.prototype,"_interacting",void 0),p([_({readOnly:!0})],Sh.prototype,"interacting",null),Sh=p([Q("esri.views.ToolViewManager")],Sh);const bOe=new Be("cyan"),xOe=1,wOe=.25,SOe=new Be("black"),EOe=.4,COe=.2,Bpt=.25,gde="default",POe="temporary",TOe=new Be("yellow");var MV;let El=MV=class extends Ye{constructor(t){super(t),this.name=gde,this.color=bOe.clone(),this.haloColor=null,this.haloOpacity=xOe,this.fillOpacity=wOe,this.shadowColor=SOe.clone(),this.shadowOpacity=EOe,this.shadowDifference=COe,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){var t,e;return new MV({...this,color:this.color.clone(),haloColor:(t=this.haloColor)==null?void 0:t.clone(),shadowColor:(e=this.shadowColor)==null?void 0:e.clone()})}assignFrom(t){var e;this.color=t.color.clone(),this.haloColor=(e=t.haloColor)==null?void 0:e.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};p([_({type:String,constructOnly:!0,nonNullable:!0})],El.prototype,"name",void 0),p([_({type:Be,nonNullable:!0})],El.prototype,"color",void 0),p([_({type:Be})],El.prototype,"haloColor",void 0),p([_({nonNullable:!0})],El.prototype,"haloOpacity",void 0),p([_({nonNullable:!0})],El.prototype,"fillOpacity",void 0),p([_({type:Be,nonNullable:!0})],El.prototype,"shadowColor",void 0),p([_({nonNullable:!0})],El.prototype,"shadowOpacity",void 0),p([_({nonNullable:!0})],El.prototype,"shadowDifference",void 0),p([_({nonNullable:!0})],El.prototype,"haloWidth",void 0),p([_({nonNullable:!0})],El.prototype,"haloBlur",void 0),El=MV=p([Q("esri.views.support.HighlightOptions")],El);const zf=El;function IOe(){return new(Ge.ofType(zf))([new zf({name:gde}),new zf({name:POe,color:TOe})])}let W1=class extends Ye{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":MOe.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return AOe[this.deviceType]}};p([_({nonNullable:!0,readOnly:!0})],W1.prototype,"nativeIndex",void 0),p([_({type:String,readOnly:!0})],W1.prototype,"deviceType",null),p([_({type:Number,readOnly:!0})],W1.prototype,"axisThreshold",null),W1=p([Q("esri.views.input.gamepad.GamepadInputDevice")],W1);const Y7=W1,MOe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),AOe={standard:.15,spacemouse:.025,unknown:0};let K2=class extends Ye{constructor(...e){super(...e),this.devices=new Ge,this.enabledFocusMode="document"}};p([_({type:Ge.ofType(Y7),readOnly:!0})],K2.prototype,"devices",void 0),p([_({type:["document","view","none"]})],K2.prototype,"enabledFocusMode",void 0),K2=p([Q("esri.views.input.gamepad.GamepadSettings")],K2);const NOe=K2;let bA=class extends Ye{constructor(){super(...arguments),this.gamepad=new NOe}};p([_({readOnly:!0})],bA.prototype,"gamepad",void 0),bA=p([Q("esri.views.input.Input")],bA);const DOe=bA,X7=()=>Ds.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,X4=()=>_({type:["pan","rotate","zoom","none"],nonNullable:!0});let Py=class extends Ye{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};p([X4()],Py.prototype,"dragPrimary",void 0),p([X4()],Py.prototype,"dragSecondary",void 0),p([X4()],Py.prototype,"dragTertiary",void 0),p([_({type:["zoom","none"],nonNullable:!0})],Py.prototype,"mouseWheel",void 0),Py=p([Q("esri.views.navigation.NavigationActionMap")],Py);const W7=Py;let Yp=class extends Ye{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};p([_({type:Boolean,nonNullable:!0})],Yp.prototype,"enabled",void 0),p([_({type:Y7})],Yp.prototype,"device",void 0),p([_({type:["pan","zoom"],nonNullable:!0})],Yp.prototype,"mode",void 0),p([_({type:["forward-down","forward-up"],nonNullable:!0})],Yp.prototype,"tiltDirection",void 0),p([_({type:Number,nonNullable:!0})],Yp.prototype,"velocityFactor",void 0),Yp=p([Q("esri.views.navigation.gamepad.GamepadSettings")],Yp);const yde=Yp;let Xp=class extends Ye{constructor(e){super(e),this.actionMap=new W7,this.browserTouchPanEnabled=!0,this.gamepad=new yde,this.momentumEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!X7()}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){QEe(Ne.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};p([_({type:W7,nonNullable:!0})],Xp.prototype,"actionMap",void 0),p([_({type:Boolean})],Xp.prototype,"browserTouchPanEnabled",void 0),p([_({type:yde,nonNullable:!0})],Xp.prototype,"gamepad",void 0),p([_({type:Boolean})],Xp.prototype,"momentumEnabled",void 0),p([_({type:Boolean})],Xp.prototype,"mouseWheelZoomEnabled",null),Xp=p([Q("esri.views.navigation.Navigation")],Xp);const w$=Xp;function Qpt(t,e,s){const i=_de(t),r=e,n=$Oe(i,r,s);if(i){const o=WC.deriveUnitFromSR(i,t.spatialReference).heightUnit;if(!s&&o!==i.heightUnit){const a=new ae("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new ae("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:i,error:a})}}if(!ROe(t)||n===qa.Unsupported)return new ae("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:i});switch(n){case qa.Units:{const o=(i==null?void 0:i.heightUnit)||"unknown",a=(r==null?void 0:r.heightUnit)||"unknown",l=new ae("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new ae("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:r,error:l})}case qa.HeightModel:{const o=(i==null?void 0:i.heightModel)||"unknown",a=(r==null?void 0:r.heightModel)||"unknown",l=new ae("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new ae("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:r,error:l})}case qa.CRS:{const o=(i==null?void 0:i.vertCRS)||"unknown",a=(r==null?void 0:r.vertCRS)||"unknown",l=new ae("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new ae("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:i,sceneHeightModelInfo:r,error:l})}}return null}function $Oe(t,e,s){if(!VQ(t)||!VQ(e))return qa.Unsupported;if(t==null||e==null)return qa.Ok;if(!s&&t.heightUnit!==e.heightUnit)return qa.Units;if(t.heightModel!==e.heightModel)return qa.HeightModel;switch(t.heightModel){case"gravity-related-height":return qa.Ok;case"ellipsoidal":return t.vertCRS===e.vertCRS?qa.Ok:qa.CRS;default:return qa.Unsupported}}var qa;function VQ(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function ROe(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!xde(t)}function _de(t){var i;if(t.type==="integrated-mesh-3dtiles")return null;const e=t.url?sx(t.url):void 0;return!(((i=t.spatialReference)==null?void 0:i.vcsWkid)==null&&e!=null&&e.serverType==="ImageServer")&&vde(t)&&t.heightModelInfo?t.heightModelInfo:xde(t)?WC.deriveUnitFromSR(FOe,t.spatialReference):null}function vde(t){return"heightModelInfo"in t}function bde(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function xde(t){return bde(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):wde(t)}function kOe(t){return t.layers!=null||wde(t)||bde(t)||vde(t)}function wde(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"})(qa||(qa={}));const FOe=new WC({heightModel:"gravity-related-height"});var d3;(function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"})(d3||(d3={}));let AV,W4=null;async function OOe(t){W4||(W4=me(()=>import("./geometryServiceUtils-CnXnmmoJ.js"),__vite__mapDeps([158,159])).then(e=>AV=e)),await W4,ni(t)}async function Sde(t,e,s,i){if(!t)return null;const r=t.spatialReference;return pg()||Qh(r,e)?Vd(t,e):AV?AV.projectGeometry(t,e,s,i):(await Promise.race([OOe(i),eg(i)]),Sde(t,e,s,i))}let hi=class extends Ye{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Do(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var i,r,n,o;const e=(i=this.map)==null?void 0:i.call(this),s=[];return this.priorityCollection!=null&&s.push(this.priorityCollection),s.push({parent:e==null?void 0:e.basemap,layers:(r=e==null?void 0:e.basemap)==null?void 0:r.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(n=e==null?void 0:e.ground)==null?void 0:n.layers},{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.referenceLayers}),s}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,i=>{const r=this._getSupportedSpatialReferences(i);if(r.length>0){const n=this._narrowDownSpatialReferenceCandidates(e,r);n!=null&&(e=n)}return(e==null?void 0:e.length)===1})&&(e==null?void 0:e.length)!==1)return{updating:!0};const s=this._pickSpatialReferenceCandidate(e);return{spatialReference:(s==null?void 0:s.spatialReference)??null,viewingMode:(s==null?void 0:s.viewingMode)??null,updating:!1}}get _tileInfoTask(){var n,o;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=(n=this.map)==null?void 0:n.call(this),s=this.spatialReference;if(!s)return{updating:this._spatialReferenceTask.updating};let i;const r=this._collectLayers([{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.baseLayers},{layers:e==null?void 0:e.layers}],a=>{var l;return!(!("tileInfo"in a)||!((l=a.tileInfo)!=null&&l.spatialReference.equals(s)))&&(i=a,!0)},a=>"tileInfo"in a);return i?{tileInfo:i.tileInfo,updating:!1}:{updating:r}}get _heightModelInfoTask(){var i;if(!this.required.heightModelInfo||this.suspended&&((i=this._get("_heightModelInfoTask"))!=null&&i.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};let e={};const s=this._collectLayers(this.mapCollections,r=>{var o,a;const n=_de(r);return!!n&&(e={heightModelInfo:n,vcsWkid:(o=r.spatialReference)==null?void 0:o.vcsWkid,latestVcsWkid:(a=r.spatialReference)==null?void 0:a.latestVcsWkid},!0)},r=>kOe(r));return{...e,updating:s}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],s=this._collectLayers(this.mapCollections,i=>{const r="fullExtents"in i&&i.fullExtents||(i.fullExtent!=null?[i.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:r[0],o=r.find(a=>a.spatialReference.equals(this.spatialReference))??n;if(o)return e.push({extent:o,layer:i}),!0;if(this._getSupportedSpatialReferences(i).length>0)for(const a of r)e.push({extent:a,layer:i});return!1});return{candidates:e,updating:s}}get _extentTask(){const{candidates:e,updating:s}=this._extentCandidatesTask;if(s)return{updating:s};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(e),r=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&r.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=Do(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:r.clone(),task:Id(async n=>{try{const o=await Sde(i.extent,r,"portalItem"in i.layer?i.layer.portalItem:void 0,n);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(Yl(n))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,s){if(e==null)return s;const i=new Array;for(const r of e)for(const n of s){if(!r.spatialReference.equals(n.spatialReference))continue;const o=VOe(r.viewingMode,n.viewingMode);if(o!==!1){i.push({spatialReference:r.spatialReference,viewingMode:o});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(e){const s=this.defaultSpatialReference;return e==null||e.length<1?s?{spatialReference:s,viewingMode:null}:null:(s!=null&&e.length>1&&e.some(({spatialReference:i})=>i.equals(s))&&(e=e.filter(({spatialReference:i})=>i.equals(s))),e.length>1&&e.some(({viewingMode:i})=>i!==d3.Local)&&(e=e.filter(({viewingMode:i})=>i!==d3.Local)),e[0])}_getSupportedSpatialReferences(e){const s="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(s.length===0)return[];const i=[];for(const r of s){const n=this.getSpatialReferenceSupport(r,e);if(n!=null){const o=n.constraints??[{spatialReference:r,viewingMode:null}];for(const{spatialReference:a,viewingMode:l}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||i.push({spatialReference:a,viewingMode:l})}}return i}_pickExtentCandidate(e){const s=this.spatialReference;return e.find(({extent:i})=>s.equals(i.spatialReference))||e[0]}_collectLayers(e,s,i=()=>!0){var n;switch(this._loadMaybe((n=this.map)==null?void 0:n.call(this))){case"loading":return!0;case"failed":return!1}const r=new LOe(i,s);for(const o of e)if(this._collectCollection(o,r),r.done||r.preloading===this.sourcePreloadCount)break;return r.updating}_collectCollection(e,s){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return s.updating=!0,void++s.preloading;case"failed":return}for(const i of e.layers)if(s.layerFilter(i)){switch(this._loadMaybe(i)){case"failed":continue;case"loading":s.updating=!0,++s.preloading;break;case"loaded":if(s.updating||(s.done=s.pushLayer(i)),s.done||s.preloading===this.sourcePreloadCount)break;"layers"in i&&this._collectCollection({layers:i.layers},s)}if(s.done||s.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(s=>{Lr(s)}),"loading"):e.loadStatus:"loaded"}};p([_()],hi.prototype,"required",void 0),p([_({constructOnly:!0})],hi.prototype,"map",void 0),p([_({constructOnly:!0})],hi.prototype,"getSpatialReferenceSupport",void 0),p([_()],hi.prototype,"defaultSpatialReference",void 0),p([_()],hi.prototype,"userSpatialReference",void 0),p([_()],hi.prototype,"sourcePreloadCount",void 0),p([_()],hi.prototype,"priorityCollection",void 0),p([_()],hi.prototype,"requiresExtentInSpatialReference",void 0),p([_()],hi.prototype,"suspended",void 0),p([_({readOnly:!0})],hi.prototype,"ready",null),p([_({readOnly:!0})],hi.prototype,"heightModelInfoReady",null),p([_({readOnly:!0})],hi.prototype,"spatialReference",null),p([_({readOnly:!0})],hi.prototype,"extent",null),p([_({readOnly:!0})],hi.prototype,"heightModelInfo",null),p([_({readOnly:!0})],hi.prototype,"vcsWkid",null),p([_({readOnly:!0})],hi.prototype,"latestVcsWkid",null),p([_({readOnly:!0})],hi.prototype,"viewingMode",null),p([_({readOnly:!0})],hi.prototype,"tileInfo",null),p([_({readOnly:!0})],hi.prototype,"mapCollections",null),p([_({readOnly:!0})],hi.prototype,"_spatialReferenceTask",null),p([_({readOnly:!0})],hi.prototype,"_tileInfoTask",null),p([_({readOnly:!0})],hi.prototype,"_heightModelInfoTask",null),p([_({readOnly:!0})],hi.prototype,"_extentCandidatesTask",null),p([_()],hi.prototype,"_extentTask",null),p([_()],hi.prototype,"_projectExtentTask",void 0),hi=p([Q("esri.views.support.DefaultsFromMap")],hi);let LOe=class{constructor(e,s){this.layerFilter=e,this.pushLayer=s,this.preloading=-1,this.updating=!1,this.done=!1}};function VOe(t,e){return t!=null?e!=null?t===e&&t:t:e}let Z1=class extends Ye{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};p([_()],Z1.prototype,"featureTitleFields",void 0),p([_()],Z1.prototype,"utilityNetworkFields",void 0),p([_()],Z1.prototype,"globalIdField",void 0),Z1=p([Q("esri.views.support.RequiredFieldsOptions")],Z1);const qOe=Z1;var eS;let rt=eS=class extends Wl.EventedMixin(YC.EsriPromiseMixin(Ye)){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.handles=new Kb,this.updatingHandles=new x_,this.allLayerViews=new ME({getCollections:()=>{var e,s,i;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(s=this.groundView)==null?void 0:s.layerViews,this.layerViews,(i=this.basemapView)==null?void 0:i.referenceLayerViews]},getChildrenFunction:zOe}),this.groundView=null,this.basemapView=null,this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new S_,this.analyses=new a3,this.typeSpecificPreconditionsReady=!0,this.layerViews=new Ge,this.magnifier=new ide,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new DOe,this.navigation=new w$,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new mde(this),this.persistableViewModels=new Ge,this.requiredFieldsOptions=new qOe,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(Ee(()=>this.preconditionsReady,e=>{var i,r;const s=this.ready;if(e?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,eS.views.add(this)):(this._lockedSpatialReference=null,eS.views.remove(this)),this.notifyChange("spatialReference"),!e&&s)(i=this.toolViewManager)==null||i.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(r=this.layerViewManager)==null||r.clear(),this._teardown();else if(e&&!s){try{this._startup()}catch(n){return void queueMicrotask(()=>{this.fatalError=new ae("startup-error",null,n)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},Xc))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,zC(()=>this.ready)))),this.basemapView=new V4e({view:this}),this.layerViewManager=new U4e({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new Sh({view:this}),this.selectionManager=new tOe({view:this}),this.addHandles([Or(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{Ne.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),Ee(()=>this.initialExtentRequired,t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t},Ga),Ee(()=>this.ready,t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)},Xc),Ee(()=>this._userSpatialReference,t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)},Ga)])}destroy(){var t,e;this.destroyed||(eS.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=ii(this.graphics),this.analyses=ii(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),ii(this.analysisViewManager),this.toolViewManager=ii(this.toolViewManager),this.layerViewManager=ii(this.layerViewManager),this.selectionManager=ii(this.selectionManager),this.basemapView=ii(this.basemapView),(t=this.groundView)==null||t.destroy(),(e=this.layerViews)==null||e.forEach(s=>s.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=ii(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return Ne.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var t;return(t=this.toolViewManager)==null?void 0:t.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new hi({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(t,e)=>this.getSpatialReferenceSupport(t,e),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??IOe()}set highlights(t){this._set("highlights",Md(t,this._get("highlights"),Ge.ofType(zf)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var t;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Jh.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!((t=this.defaultsFromMap)!=null&&t.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t!=null&&t.destroyed&&(Ne.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),Jh.isLoadable(t)&&t.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",t))}get readyState(){var t,e,s,i;if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((((t=this.defaultsFromMap)==null?void 0:t.ready)??!1)&&!this.spatialReference){const r=!("loaded"in this.map)||this.map.loaded,n=this.map.ground.loaded,o=((e=this.map.basemap)==null?void 0:e.loaded)??!0;return r&&o&&n&&!((s=this.map)!=null&&s.allLayers.length)?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=Id(a=>FC(ge("view-readyState-waiting-delay"),null,a)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),(i=this._readyStateWaitingTask)!=null&&i.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=Do(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){var e,s;const t=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(t&&((s=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&s.heightModelInfo)){const i=t.clone();return i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,i}return t}set spatialReference(t){const e=!on(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(t){this._userTimeExtent=t}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Gu}set timeZone(t){this._userTimeZone=t,MNe(t)||Ne.getLogger(this).warn("#timeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}get tools(){var t;return(t=this.toolViewManager)==null?void 0:t.tools}get initialExtent(){var t;return(t=this.defaultsFromMap)==null?void 0:t.extent}get cursor(){var t;return((t=this.toolViewManager)==null?void 0:t.cursor)??this._cursor??"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new TV}whenLayerView(t){var e;return((e=this.layerViewManager)==null?void 0:e.whenLayerView(t))??Promise.reject()}getDefaultSpatialReference(){var t;return(t=this.defaultsFromMap)==null?void 0:t.spatialReference}getDefaultHeightModelInfo(){var t;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((t=this.defaultsFromMap)==null?void 0:t.heightModelInfo)??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(t){throw new ae("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return this.getSpatialReferenceSupport(t)!=null}when(t,e){return this.isResolved()&&!this.ready&&Ne.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(Or(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}};rt.views=new Ge,p([_()],rt.prototype,"_userSpatialReference",void 0),p([_()],rt.prototype,"activeTool",null),p([_({readOnly:!0})],rt.prototype,"allLayerViews",void 0),p([_()],rt.prototype,"groundView",void 0),p([_()],rt.prototype,"animation",null),p([_()],rt.prototype,"basemapView",void 0),p([_()],rt.prototype,"center",null),p([_()],rt.prototype,"defaultsFromMapSettings",null),p([_()],rt.prototype,"defaultsFromMap",null),p([_()],rt.prototype,"displayFilterEnabled",void 0),p([_()],rt.prototype,"fatalError",void 0),p([_({type:Hs})],rt.prototype,"extent",null),p([_(o6(S_,"graphics"))],rt.prototype,"graphics",void 0),p([_(o6(a3,"analyses"))],rt.prototype,"analyses",void 0),p([_({readOnly:!0,type:WC})],rt.prototype,"heightModelInfo",null),p([_({type:Ge.ofType(zf)})],rt.prototype,"highlights",null),p([_({readOnly:!0})],rt.prototype,"interacting",null),p([_({readOnly:!0})],rt.prototype,"navigating",null),p([_({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],rt.prototype,"preconditionsReady",null),p([_({readOnly:!0})],rt.prototype,"typeSpecificPreconditionsReady",void 0),p([_({type:Ge,readOnly:!0})],rt.prototype,"layerViews",void 0),p([_()],rt.prototype,"resolution",null),p([_({type:ide})],rt.prototype,"magnifier",void 0),p([_({value:null,type:Xhe})],rt.prototype,"map",null),p([_()],rt.prototype,"padding",void 0),p([_({readOnly:!0})],rt.prototype,"ready",void 0),p([_()],rt.prototype,"_readyStateWaitingTask",void 0),p([_({readOnly:!0})],rt.prototype,"readyState",null),p([_({type:St})],rt.prototype,"spatialReference",null),p([_()],rt.prototype,"stationary",null),p([_({readOnly:!0})],rt.prototype,"supportsGround",void 0),p([_({type:Ad})],rt.prototype,"timeExtent",null),p([_({type:String,nonNullable:!0})],rt.prototype,"timeZone",null),p([_()],rt.prototype,"tools",null),p([_()],rt.prototype,"toolViewManager",void 0),p([_({readOnly:!0})],rt.prototype,"type",void 0),p([_({type:Number})],rt.prototype,"scale",void 0),p([_({readOnly:!0})],rt.prototype,"updating",void 0),p([_({readOnly:!0})],rt.prototype,"initialExtentRequired",void 0),p([_({readOnly:!0})],rt.prototype,"initialExtent",null),p([_()],rt.prototype,"cursor",null),p([_({readOnly:!0})],rt.prototype,"input",void 0),p([_({type:w$,nonNullable:!0})],rt.prototype,"navigation",void 0),p([_()],rt.prototype,"layerViewManager",void 0),p([_()],rt.prototype,"analysisViewManager",void 0),p([_()],rt.prototype,"selectionManager",void 0),p([_()],rt.prototype,"width",void 0),p([_()],rt.prototype,"height",void 0),p([_({readOnly:!0})],rt.prototype,"resizing",void 0),p([_({value:null,readOnly:!0})],rt.prototype,"size",null),p([_({readOnly:!0})],rt.prototype,"suspended",void 0),p([_({readOnly:!0})],rt.prototype,"viewEvents",void 0),p([_({readOnly:!0})],rt.prototype,"persistableViewModels",void 0),p([_()],rt.prototype,"_isValid",void 0),p([_()],rt.prototype,"_readyCycleForced",void 0),p([_()],rt.prototype,"_lockedSpatialReference",void 0),p([_()],rt.prototype,"_userTimeZone",void 0),p([_()],rt.prototype,"_lockedTimeZone",void 0),p([_()],rt.prototype,"_userTimeExtent",void 0),p([_()],rt.prototype,"_lockedTimeExtent",void 0),p([_({type:TV})],rt.prototype,"theme",void 0),p([_({readOnly:!0,type:TV})],rt.prototype,"effectiveTheme",null),rt=eS=p([Q("esri.views.View")],rt);const Z4=globalThis.$arcgis;Z4&&!Z4.views&&Object.defineProperty(Z4,"views",{configurable:!1,enumerable:!0,writable:!1,value:rt.views});const GOe=rt;function zOe(t){return t.layerViews}function ib(t,e){return t[0]=e[0],t[1]=e[1],t}function On(t,e,s){return t[0]=e,t[1]=s,t}function Ede(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t}function VE(t,e,s){return t[0]=e[0]-s[0],t[1]=e[1]-s[1],t}function Cde(t,e,s){return t[0]=e[0]*s[0],t[1]=e[1]*s[1],t}function Pde(t,e,s){return t[0]=e[0]/s[0],t[1]=e[1]/s[1],t}function UOe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function BOe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function jOe(t,e,s){return t[0]=Math.min(e[0],s[0]),t[1]=Math.min(e[1],s[1]),t}function HOe(t,e,s){return t[0]=Math.max(e[0],s[0]),t[1]=Math.max(e[1],s[1]),t}function YOe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function lP(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t}function XOe(t,e,s,i){return t[0]=e[0]+s[0]*i,t[1]=e[1]+s[1]*i,t}function S$(t,e){const s=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(s*s+i*i)}function p3(t,e){const s=e[0]-t[0],i=e[1]-t[1];return s*s+i*i}function f3(t){const e=t[0],s=t[1];return Math.sqrt(e*e+s*s)}function Tde(t){const e=t[0],s=t[1];return e*e+s*s}function Ide(t,e){return t[0]=-e[0],t[1]=-e[1],t}function WOe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function NV(t,e){const s=e[0],i=e[1];let r=s*s+i*i;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t}function Mde(t,e){return t[0]*e[0]+t[1]*e[1]}function Ade(t,e,s){const i=e[0]*s[1]-e[1]*s[0];return t[0]=t[1]=0,t[2]=i,t}function ZOe(t,e,s,i){const r=e[0],n=e[1];return t[0]=r+i*(s[0]-r),t[1]=n+i*(s[1]-n),t}function QOe(t,e=1){const s=2*u$()*Math.PI;return t[0]=Math.cos(s)*e,t[1]=Math.sin(s)*e,t}function JOe(t,e,s){const i=e[0],r=e[1];return t[0]=s[0]*i+s[2]*r,t[1]=s[1]*i+s[3]*r,t}function Vh(t,e,s){const i=e[0],r=e[1];return t[0]=s[0]*i+s[2]*r+s[4],t[1]=s[1]*i+s[3]*r+s[5],t}function KOe(t,e,s){const i=e[0],r=e[1];return t[0]=s[0]*i+s[3]*r+s[6],t[1]=s[1]*i+s[4]*r+s[7],t}function eLe(t,e,s){const i=e[0],r=e[1];return t[0]=s[0]*i+s[4]*r+s[12],t[1]=s[1]*i+s[5]*r+s[13],t}function tLe(t,e,s,i){const r=e[0]-s[0],n=e[1]-s[1],o=Math.sin(i),a=Math.cos(i);return t[0]=r*a-n*o+s[0],t[1]=r*o+n*a+s[1],t}function sLe(t,e){const s=t[0],i=t[1],r=e[0],n=e[1];let o=s*s+i*i;o>0&&(o=1/Math.sqrt(o));let a=r*r+n*n;a>0&&(a=1/Math.sqrt(a));const l=(s*r+i*n)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function iLe(t){return"vec2("+t[0]+", "+t[1]+")"}function rLe(t,e){return t[0]===e[0]&&t[1]===e[1]}function nLe(t,e){const s=t[0],i=t[1],r=e[0],n=e[1],o=_a();return Math.abs(s-r)<=o*Math.max(1,Math.abs(s),Math.abs(r))&&Math.abs(i-n)<=o*Math.max(1,Math.abs(i),Math.abs(n))}function oLe(t,e,s,i,r){let n=e[0]-s[0],o=e[1]-s[1];const a=(i[0]*n+i[1]*o)*(r-1);return n=i[0]*a,o=i[1]*a,t[0]=e[0]+n,t[1]=e[1]+o,t}const aLe=f3,Z7=VE,lLe=Cde,uLe=Pde,cLe=S$,hLe=p3,mLe=Tde;Object.freeze(Object.defineProperty({__proto__:null,add:Ede,angle:sLe,ceil:UOe,copy:ib,cross:Ade,dist:cLe,distance:S$,div:uLe,divide:Pde,dot:Mde,equals:nLe,exactEquals:rLe,floor:BOe,inverse:WOe,len:aLe,length:f3,lerp:ZOe,max:HOe,min:jOe,mul:lLe,multiply:Cde,negate:Ide,normalize:NV,projectAndScale:oLe,random:QOe,rotate:tLe,round:YOe,scale:lP,scaleAndAdd:XOe,set:On,sqrDist:hLe,sqrLen:mLe,squaredDistance:p3,squaredLength:Tde,str:iLe,sub:Z7,subtract:VE,transformMat2:JOe,transformMat2d:Vh,transformMat3:KOe,transformMat4:eLe},Symbol.toStringTag,{value:"Module"}));function ar(){return[0,0]}function dLe(t){return[t[0],t[1]]}function uP(t,e){return[t,e]}function pLe(t,e){return[t,e]}function fLe(t,e=ar()){const s=Math.min(2,t.length);for(let i=0;i<s;++i)e[i]=t[i];return e}function gLe(t,e){return new Float64Array(t,e,2)}function Nde(){return ar()}function Dde(){return uP(1,1)}function $de(){return uP(1,0)}function Rde(){return uP(0,1)}const yLe=Nde(),_Le=Dde(),vLe=$de(),bLe=Rde();Object.freeze(Object.defineProperty({__proto__:null,ONES:_Le,UNIT_X:vLe,UNIT_Y:bLe,ZEROS:yLe,clone:dLe,create:ar,createView:gLe,freeze:pLe,fromArray:fLe,fromValues:uP,ones:Dde,unitX:$de,unitY:Rde,zeros:Nde},Symbol.toStringTag,{value:"Module"}));function xLe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function E$(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function wLe(t,e,s,i,r,n,o){return t[0]=e,t[1]=s,t[2]=i,t[3]=r,t[4]=n,t[5]=o,t}function Q7(t,e){const s=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5];let l=s*n-i*r;return l?(l=1/l,t[0]=n*l,t[1]=-i*l,t[2]=-r*l,t[3]=s*l,t[4]=(r*a-n*o)*l,t[5]=(i*o-s*a)*l,t):null}function SLe(t){return t[0]*t[3]-t[1]*t[2]}function Zy(t,e,s){const i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=s[0],c=s[1],h=s[2],m=s[3],f=s[4],g=s[5];return t[0]=i*u+n*c,t[1]=r*u+o*c,t[2]=i*h+n*m,t[3]=r*h+o*m,t[4]=i*f+n*g+a,t[5]=r*f+o*g+l,t}function cP(t,e,s){const i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=Math.sin(s),c=Math.cos(s);return t[0]=i*c+n*u,t[1]=r*c+o*u,t[2]=i*-u+n*c,t[3]=r*-u+o*c,t[4]=a,t[5]=l,t}function C$(t,e,s){const i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=s[0],c=s[1];return t[0]=i*u,t[1]=r*u,t[2]=n*c,t[3]=o*c,t[4]=a,t[5]=l,t}function Nb(t,e,s){const i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=s[0],c=s[1];return t[0]=i,t[1]=r,t[2]=n,t[3]=o,t[4]=i*u+n*c+a,t[5]=r*u+o*c+l,t}function kde(t,e){const s=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=s,t[2]=-s,t[3]=i,t[4]=0,t[5]=0,t}function Fde(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function J7(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function ELe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function CLe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function PLe(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t[3]=e[3]+s[3],t[4]=e[4]+s[4],t[5]=e[5]+s[5],t}function Ode(t,e,s){return t[0]=e[0]-s[0],t[1]=e[1]-s[1],t[2]=e[2]-s[2],t[3]=e[3]-s[3],t[4]=e[4]-s[4],t[5]=e[5]-s[5],t}function TLe(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*s,t[5]=e[5]*s,t}function ILe(t,e,s,i){return t[0]=e[0]+s[0]*i,t[1]=e[1]+s[1]*i,t[2]=e[2]+s[2]*i,t[3]=e[3]+s[3]*i,t[4]=e[4]+s[4]*i,t[5]=e[5]+s[5]*i,t}function MLe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function ALe(t,e){const s=t[0],i=t[1],r=t[2],n=t[3],o=t[4],a=t[5],l=e[0],u=e[1],c=e[2],h=e[3],m=e[4],f=e[5],g=_a();return Math.abs(s-l)<=g*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(i-u)<=g*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(r-c)<=g*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-h)<=g*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(o-m)<=g*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-f)<=g*Math.max(1,Math.abs(a),Math.abs(f))}const NLe=Zy,DLe=Ode;Object.freeze(Object.defineProperty({__proto__:null,add:PLe,copy:xLe,determinant:SLe,equals:ALe,exactEquals:MLe,frob:CLe,fromRotation:kde,fromScaling:Fde,fromTranslation:J7,identity:E$,invert:Q7,mul:NLe,multiply:Zy,multiplyScalar:TLe,multiplyScalarAndAdd:ILe,rotate:cP,scale:C$,set:wLe,str:ELe,sub:DLe,subtract:Ode,translate:Nb},Symbol.toStringTag,{value:"Module"}));function xd(){return[1,0,0,1,0,0]}function $Le(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function RLe(t,e,s,i,r,n){return[t,e,s,i,r,n]}function kLe(t,e){return new Float64Array(t,e,6)}const FLe=xd();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:FLe,clone:$Le,create:xd,createView:kLe,fromValues:RLe},Symbol.toStringTag,{value:"Module"}));const bI={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new Vl({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:St.WebMercator}),minus180Line:new Vl({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:St.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Vl({paths:[[[180,-180],[180,180]]],spatialReference:St.WGS84}),minus180Line:new Vl({paths:[[[-180,-180],[-180,180]]],spatialReference:St.WGS84})}};function m_(t,e){return Math.ceil((t-e)/(2*e))}function Lde(t,e){const s=rE(t);for(const i of s)for(const r of i)r[0]+=e;return t}function rE(t){return v_(t)?t.rings:t.paths}function tft(t,e){return e?{...e,query:{...t??{},...e.query}}:{query:t}}function Vde(t){return typeof t=="string"?Sr(t):he(t)}function OLe(t,e,s){const i={};for(const r in t){if(r==="declaredClass")continue;const n=t[r];if(n!=null&&typeof n!="function")if(Array.isArray(n))i[r]=n.map(o=>OLe(o));else if(typeof n=="object")if(n.toJSON){const o=n.toJSON(s==null?void 0:s[r]);i[r]=e?o:JSON.stringify(o)}else i[r]=e?n:JSON.stringify(n);else i[r]=n}return i}async function LLe(t,e,s,i){const r=Vde(t),n=e[0].spatialReference,o={...i,responseType:"json",query:{...r.query,f:"json",sr:BN(n),target:JSON.stringify({geometryType:YD(e[0]),geometries:e}),cutter:JSON.stringify(s)}},a=await js(r.path+"/cut",o),{cutIndexes:l,geometries:u=[]}=a.data;return{cutIndexes:l,geometries:u.map(c=>{const h=Y_(c);return h.spatialReference=n,h})}}function VLe(t){return{geometryType:YD(t[0]),geometries:t.map(e=>e.toJSON())}}function qLe(t,e,s){const i=XIe(e);return t.map(r=>{const n=i.fromJSON(r);return n.spatialReference=s,n})}async function GLe(t,e,s){const i=typeof t=="string"?Sr(t):t,r=e[0].spatialReference,n=YD(e[0]),o={...s,query:{...i.query,f:"json",sr:BN(r),geometries:JSON.stringify(VLe(e))}},{data:a}=await js(i.path+"/simplify",o);return qLe(a.geometries,n,r)}const qde=()=>Ne.getLogger("esri.geometry.support.normalizeUtils");function zLe(t){return t.type==="polygon"}function ULe(t){return t[0].type==="polygon"}function BLe(t){return t[0].type==="polyline"}function qQ(t){const e=[];let s=0,i=0;for(let r=0;r<t.length;r++){const n=t[r];let o=null;for(let a=0;a<n.length;a++)o=n[a],e.push(o),a===0?(s=o[0],i=s):(s=Math.min(s,o[0]),i=Math.max(i,o[0]));o&&e.push([(s+i)/2,0])}return e}function jLe(t,e){if(!(t instanceof Vl||t instanceof po)){const r="straightLineDensify: the input geometry is neither polyline nor polygon";throw qde().error(r),new ae(r)}const s=rE(t),i=[];for(const r of s){const n=[];i.push(n),n.push([r[0][0],r[0][1]]);for(let o=0;o<r.length-1;o++){const a=r[o][0],l=r[o][1],u=r[o+1][0],c=r[o+1][1],h=Math.sqrt((u-a)*(u-a)+(c-l)*(c-l)),m=(c-l)/h,f=(u-a)/h,g=h/e;if(g>1){for(let S=1;S<=g-1;S++){const T=S*e,P=f*T+a,I=m*T+l;n.push([P,I])}const v=(h+Math.floor(g-1)*e)/2,b=f*v+a,w=m*v+l;n.push([b,w])}n.push([u,c])}}return zLe(t)?new po({rings:i,spatialReference:t.spatialReference}):new Vl({paths:i,spatialReference:t.spatialReference})}function GQ(t,e,s){if(e){const i=jLe(t,1e6);t=o_(i,!0)}return s&&(t=Lde(t,s)),t}function zQ(t,e,s){if(Array.isArray(t)){const i=t[0];if(i>e){const r=m_(i,e);t[0]=i+r*(-2*e)}else if(i<s){const r=m_(i,s);t[0]=i+r*(-2*s)}}else{const i=t.x;if(i>e){const r=m_(i,e);t=t.clone().offset(r*(-2*e),0)}else if(i<s){const r=m_(i,s);t=t.clone().offset(r*(-2*s),0)}}return t}function HLe(t,e){let s=-1;for(let i=0;i<e.cutIndexes.length;i++){const r=e.cutIndexes[i],n=e.geometries[i],o=rE(n);for(let a=0;a<o.length;a++){const l=o[a];l.some(u=>{if(u[0]<180)return!0;{let c=0;for(let m=0;m<l.length;m++){const f=l[m][0];c=f>c?f:c}c=Number(c.toFixed(9));const h=-360*m_(c,180);for(let m=0;m<l.length;m++){const f=n.getPoint(a,m);n.setPoint(a,m,f.clone().offset(h,0))}return!0}})}if(r===s){if(ULe(t))for(const a of rE(n))t[r]=t[r].addRing(a);else if(BLe(t))for(const a of rE(n))t[r]=t[r].addPath(a)}else s=r,t[r]=n}return t}async function Gde(t,e,s){if(!Array.isArray(t))return Gde([t],e);e&&typeof e!="string"&&qde().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const i=typeof e=="string"?e:(e==null?void 0:e.url)??Ds.geometryServiceUrl;let r,n,o,a,l,u,c,h,m=0;const f=[],g=[];for(const P of t)if(P!=null)if(r||(r=P.spatialReference,n=ya(r),o=r.isWebMercator,u=o?102100:4326,a=bI[u].maxX,l=bI[u].minX,c=bI[u].plus180Line,h=bI[u].minus180Line),n)if(P.type==="mesh")g.push(P);else if(P.type==="point")g.push(zQ(P.clone(),a,l));else if(P.type==="multipoint"){const I=P.clone();I.points=I.points.map(A=>zQ(A,a,l)),g.push(I)}else if(P.type==="extent"){const I=P.clone()._normalize(!1,!1,n);g.push(I.rings?new po(I):I)}else if(P.extent){const I=P.extent,A=m_(I.xmin,l)*(2*a);let D=A===0?P.clone():Lde(P.clone(),A);I.offset(A,0);let{xmin:k,xmax:R}=I;k=Number(k.toFixed(9)),R=Number(R.toFixed(9)),I.intersects(c)&&R!==a?(m=R>m?R:m,D=GQ(D,o),f.push(D),g.push("cut")):I.intersects(h)&&k!==l?(m=R*(2*a)>m?R*(2*a):m,D=GQ(D,o,360),f.push(D),g.push("cut")):g.push(D)}else g.push(P.clone());else g.push(P);else g.push(P);let v=m_(m,a),b=-90;const w=v,S=new Vl;for(;v>0;){const P=360*v-180;S.addPath([[P,b],[P,-1*b]]),b*=-1,v--}if(f.length>0&&w>0){const P=HLe(f,await LLe(i,f,S,s)),I=[],A=[];for(let R=0;R<g.length;R++){const O=g[R];if(O!=="cut")A.push(O);else{const z=P.shift(),q=t[R];q!=null&&q.type==="polygon"&&q.rings&&q.rings.length>1&&z.rings.length>=q.rings.length?(I.push(z),A.push("simplify")):A.push(o?bd(z):z)}}if(!I.length)return A;const D=await GLe(i,I,s),k=[];for(let R=0;R<A.length;R++){const O=A[R];O!=="simplify"?k.push(O):k.push(o?bd(D.shift()):D.shift())}return k}const T=[];for(let P=0;P<g.length;P++){const I=g[P];if(I!=="cut")T.push(I);else{const A=f.shift();T.push(o===!0?bd(A):A)}}return T}function YLe(t){if(!t)return null;const e=t.extent;if(!e)return null;const s=t.spatialReference&&ya(t.spatialReference);if(!s)return e;const[i,r]=s.valid,n=2*r,{width:o}=e;let a,{xmin:l,xmax:u}=e;if([l,u]=[u,l],t.type==="extent"||o===0||o<=r||o>n||l<i||u>r)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;a=qQ(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;a=qQ(t.paths);break;case"multipoint":a=t.points}const c=e.clone();for(let h=0;h<a.length;h++){let m=a[h][0];m<0?(m+=r,u=Math.max(m,u)):(m-=r,l=Math.min(m,l))}return c.xmin=l,c.xmax=u,c.width<o?(c.xmin-=r,c.xmax-=r,c):e}function K7(t,e,s){const i=ya(s);if(i==null)return t;const[r,n]=i.valid,o=2*n;let a=0,l=0;e>n?a=Math.ceil(Math.abs(e-n)/o):e<r&&(a=-Math.ceil(Math.abs(e-r)/o)),t>n?l=Math.ceil(Math.abs(t-n)/o):t<r&&(l=-Math.ceil(Math.abs(t-r)/o));let u=t+(a-l)*o;const c=u-e;return c>n?u-=o:c<r&&(u+=o),u}function sft(t,e){const s=ya(e);if(s){const[i,r]=s.valid,n=r-i;if(t<i)for(;t<i;)t+=n;if(t>r)for(;t>r;)t-=n}return t}const zde=96,Ude=39.37,XLe=180/Math.PI;function Bde(t){return t.wkid?t:t.spatialReference||St.WGS84}function eU(t,e){return e.type?On(t,e.x,e.y):ib(t,e)}function jde(t){return Uu(t)}function P$(t,e,s=0){let i=t.width,r=t.height;if(s!==0){const a=FD(s),l=Math.abs(Math.cos(a)),u=Math.abs(Math.sin(a));i=t.width*l+t.height*u,r=t.width*u+t.height*l}const n=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(i/n,r/o)*s5e(t.spatialReference)}async function tS(t,e,s,i){var a,l,u;let r,n;if(!t||Array.isArray(t)&&!t.length)return null;if(Ge.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const c=t.every(f=>"attributes"in f),h=t.some(f=>!f.geometry);let m=t;if(c&&h&&e&&e.allLayerViews){const f=new Map;for(const w of t){const S=w.layer,T=f.get(S)||[],P=w.attributes[S.objectIdField];P!=null&&T.push(P),f.set(S,T)}const g=[];f.forEach((w,S)=>{var P;const T=(P=e.allLayerViews)==null?void 0:P.find(I=>I.layer.id===S.id);if(T&&"queryFeatures"in T){const I=S.createQuery();I.objectIds=w,I.returnGeometry=!0,g.push(T.queryFeatures(I))}});const v=await Promise.all(g),b=[];for(const w of v)if(w&&w.features&&w.features.length)for(const S of w.features)S.geometry!=null&&b.push(S.geometry);m=b}for(const f of m)i=await tS(f,e,s,i);return i}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")r=new Et(t);else if(t instanceof Ld)r=t;else if("geometry"in t){if(t.geometry)r=t.geometry;else if(t.layer){const c=t.layer,h=(a=e.allLayerViews)==null?void 0:a.find(m=>m.layer.id===c.id);if(h&&"queryFeatures"in h){const m=c.createQuery();m.objectIds=[t.attributes[c.objectIdField]],m.returnGeometry=!0;const f=await h.queryFeatures(m);r=(u=(l=f==null?void 0:f.features)==null?void 0:l[0])==null?void 0:u.geometry}}}if(r==null)return null;switch(r.type){case"point":n=new Hs({xmin:r.x,ymin:r.y,xmax:r.x,ymax:r.y,spatialReference:r.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":n=YLe(r);break;default:n=r.extent}if(!n)return null;pg()||Qh(n.spatialReference,s)||await eg();const o=Vd(n,s);if(!o)return null;if(i){const c=o.center,h=c.clone();h.x=K7(c.x,i.center.x,s),h.x!==c.x&&o.centerAt(h),i=i.union(o)}else i=o;return i}function WLe(t){var e;if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&((e=t.layer)==null?void 0:e.minScale)!=null&&t.layer.maxScale!=null){const s=t.layer;return{min:s.minScale,max:s.maxScale}}if(Array.isArray(t)&&t.length&&t.every(s=>"layer"in s)){let s=0,i=0;for(const r of t){const n=r.layer;n!=null&&n.minScale&&n.maxScale&&(s=n.minScale<s?n.minScale:s,i=n.maxScale>i?n.maxScale:i)}return s&&i?{min:s,max:i}:null}}}function UQ(t,e){const s=Bde(t);return on(s,e)||s.imageCoordinateSystem||e.imageCoordinateSystem?t:Vd(t,e)}async function ZLe(t,e){var b;if(!t||!e)return new Lu({targetGeometry:new Et,scale:0,rotation:0});let s=e.spatialReference;const{constraints:i,padding:r,viewpoint:n,size:o}=e,a=[r?o[0]-r.left-r.right:o[0],r?o[1]-r.top-r.bottom:o[1]];let l=null;t instanceof Lu?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let u=null;l!=null&&l.targetGeometry?u=l.targetGeometry:t instanceof Hs?u=t:t instanceof Ld?u=await tS(t,e,s):t&&(u=await tS(t.center,e,s)||await tS(t.target,e,s)||await tS(t,e,s)),!u&&(n!=null&&n.targetGeometry)?u=n.targetGeometry:!u&&e.extent&&(u=e.extent),s||(s=Bde(e.spatialReference||e.extent||u)),pg()||on(u.spatialReference,s)||Qh(u.spatialReference,s)||await eg();const c=UQ(u,s),h="center"in c?c.center:c;e.pickClosestTarget!==!1&&h.type==="point"&&((b=n.targetGeometry)==null?void 0:b.type)==="point"&&(h.x=K7(h.x,n.targetGeometry.x,h.spatialReference));let m=0;l?m=l.rotation:t.hasOwnProperty("rotation")?m=t.rotation:n&&(m=n.rotation);let f=0;f=(l==null?void 0:l.targetGeometry)!=null&&l.targetGeometry.type==="point"?l.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&i&&i.effectiveLODs?i.zoomToScale(t.zoom):Array.isArray(u)||u.type==="point"||u.type==="extent"&&u.width===0&&u.height===0?n.scale:P$(UQ(u.extent,s),a,m);const g=WLe(t.target??t);g&&(g.min&&g.min<f?f=g.min:g.max&&g.max>f&&(f=g.max));let v=new Lu({targetGeometry:h,scale:f,rotation:m});return i&&(v=i.fit(v),i.constrainByGeometry(v),i.rotationEnabled||(v.rotation=n.rotation)),v}function Fo(t,e){const s=t.targetGeometry,i=e.targetGeometry;return s.x=i.x,s.y=i.y,s.spatialReference=i.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function QLe(t,e,s){return s?On(t,.5*(e[0]-s.right+s.left),.5*(e[1]-s.bottom+s.top)):lP(t,e,.5)}const JLe=function(){const t=ar();return function(e,s,i){const r=s.targetGeometry;eU(t,r);const n=.5*mx(s);return e.xmin=t[0]-n*i[0],e.ymin=t[1]-n*i[1],e.xmax=t[0]+n*i[0],e.ymax=t[1]+n*i[1],e.spatialReference=r.spatialReference,e}}();function KLe(t,e,s,i,r){var n;return DV(t,e,s.center),t.scale=P$(s,i),(n=r==null?void 0:r.constraints)==null||n.constrain(t),t}function e5e(t,e,s,i){return iU(t,e,s,i),Q7(t,t)}const Hde=function(){const t=ar();return function(e,s,i){return Z7(e,i5e(e,s),QLe(t,s,i))}}(),t5e=function(){const t=xd(),e=ar();return function(s,i,r,n){const o=mx(i),a=tU(i);return On(e,o,o),Fde(t,e),cP(t,t,a),Nb(t,t,Hde(e,r,n)),Nb(t,t,[0,n.top-n.bottom]),On(s,t[4],t[5])}}();function mx(t){var e;return t.scale*Yde((e=t.targetGeometry)==null?void 0:e.spatialReference)}function Yde(t){return Ll(t)?1/(jde(t)*Ude*zde):1}function tU(t){return I7(t.rotation)||0}function s5e(t){return Ll(t)?jde(t)*Ude*zde:1}function i5e(t,e){return lP(t,e,.5)}const sU=function(){const t=ar(),e=ar(),s=ar();return function(i,r,n,o,a,l){return Ide(t,r),lP(e,n,.5*l),On(s,1/o*l,-1/o*l),J7(i,e),a&&cP(i,i,a),C$(i,i,s),Nb(i,i,t),i}}(),iU=function(){const t=ar();return function(e,s,i,r){const n=mx(s),o=tU(s);return eU(t,s.targetGeometry),sU(e,t,i,n,o,r)}}(),r5e=function(){const t=ar();return function(e,s,i,r){const n=mx(s);return eU(t,s.targetGeometry),sU(e,t,i,n,0,r)}}();function Xde(t){const e=ya(t);return e?e.valid[1]-e.valid[0]:0}function n5e(t,e){return Math.round(Xde(t)/e)}const o5e=function(){const t=ar(),e=ar(),s=[0,0,0];return function(i,r,n){VE(t,i,r),NV(t,t),VE(e,i,n),NV(e,e),Ade(s,t,e);let o=Math.acos(Mde(t,e)/(f3(t)*f3(e)))*XLe;return s[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),a5e=function(){const t=ar();return function(e,s,i,r){const n=e.targetGeometry;return Fo(e,s),t5e(t,s,i,r),n.x+=t[0],n.y+=t[1],e}}(),DV=function(t,e,s){Fo(t,e);const i=t.targetGeometry;return i.x=s.x,i.y=s.y,i.spatialReference=s.spatialReference,t},l5e=function(){const t=ar();return function(e,s,i,r,n){n||(n="center"),Z7(t,i,r),lP(t,t,.5);const o=t[0],a=t[1];switch(n){case"center":On(t,0,0);break;case"left":On(t,-o,0);break;case"top":On(t,0,a);break;case"right":On(t,o,0);break;case"bottom":On(t,0,-a);break;case"top-left":On(t,-o,a);break;case"bottom-left":On(t,-o,-a);break;case"top-right":On(t,o,a);break;case"bottom-right":On(t,o,-a)}return T$(e,s,t),e}}();function ift(t,e,s){return Fo(t,e),t.rotation+=s,t}function u5e(t,e,s){return Fo(t,e),t.rotation=s,t}const c5e=function(){const t=ar();return function(e,s,i,r,n){return Fo(e,s),isNaN(i)||i===0||(Zde(t,r,s,n),e.scale=s.scale*i,Qde(t,t,e,n),T$(e,e,On(t,t[0]-r[0],r[1]-t[1]))),e}}();function BQ(t,e,s){return Fo(t,e),t.scale=s,t}const Wde=function(){const t=ar();return function(e,s,i,r,n,o){return Fo(e,s),isNaN(i)||i===0||(Zde(t,n,s,o),e.scale=s.scale*i,e.rotation+=r,Qde(t,t,e,o),T$(e,e,On(t,t[0]-n[0],n[1]-t[1]))),e}}(),rft=function(){const t=ar(),e=ar();return function(s,i,r,n,o,a,l){return Hde(e,a,l),Ede(t,o,e),n?Wde(s,i,r,n,t,a):c5e(s,i,r,t,a)}}(),Zde=function(){const t=xd();return function(e,s,i,r){return Vh(e,s,e5e(t,i,r,1))}}(),Qde=function(){const t=xd();return function(e,s,i,r){return Vh(e,s,iU(t,i,r,1))}}(),T$=function(){const t=ar(),e=xd();return function(s,i,r){Fo(s,i);const n=mx(i),o=s.targetGeometry;return kde(e,tU(i)),C$(e,e,uP(n,n)),Vh(t,r,e),o.x+=t[0],o.y+=t[1],s}}();function g3(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function h5e(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function m5e(t,e,s,i,r,n){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=s,o[3]=i,o[4]=r,o[5]=n,o}function d5e(t,e){return new Float32Array(t,e,6)}function Jde(t,e,s,i){const r=e[i],n=e[i+1];t[i]=s[0]*r+s[2]*n+s[4],t[i+1]=s[1]*r+s[3]*n+s[5]}function p5e(t,e,s,i=0,r=0,n=2){const o=r||e.length/n;for(let a=i;a<o;a++)Jde(t,e,s,a*n)}Object.freeze(Object.defineProperty({__proto__:null,clone:h5e,create:g3,createView:d5e,fromValues:m5e,transform:Jde,transformMany:p5e},Symbol.toStringTag,{value:"Module"}));function f5e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function g5e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Kde(t,e,s,i,r,n,o,a,l,u){return t[0]=e,t[1]=s,t[2]=i,t[3]=r,t[4]=n,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t}function epe(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function y5e(t,e){if(t===e){const s=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=s,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function _5e(t,e){const s=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,m=-c*n+a*l,f=u*n-o*l;let g=s*h+i*m+r*f;return g?(g=1/g,t[0]=h*g,t[1]=(-c*i+r*u)*g,t[2]=(a*i-r*o)*g,t[3]=m*g,t[4]=(c*s-r*l)*g,t[5]=(-a*s+r*n)*g,t[6]=f*g,t[7]=(-u*s+i*l)*g,t[8]=(o*s-i*n)*g,t):null}function v5e(t,e){const s=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t[0]=o*c-a*u,t[1]=r*u-i*c,t[2]=i*a-r*o,t[3]=a*l-n*c,t[4]=s*c-r*l,t[5]=r*n-s*a,t[6]=n*u-o*l,t[7]=i*l-s*u,t[8]=s*o-i*n,t}function b5e(t){const e=t[0],s=t[1],i=t[2],r=t[3],n=t[4],o=t[5],a=t[6],l=t[7],u=t[8];return e*(u*n-o*l)+s*(-u*r+o*a)+i*(l*r-n*a)}function rU(t,e,s){const i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],m=s[0],f=s[1],g=s[2],v=s[3],b=s[4],w=s[5],S=s[6],T=s[7],P=s[8];return t[0]=m*i+f*o+g*u,t[1]=m*r+f*a+g*c,t[2]=m*n+f*l+g*h,t[3]=v*i+b*o+w*u,t[4]=v*r+b*a+w*c,t[5]=v*n+b*l+w*h,t[6]=S*i+T*o+P*u,t[7]=S*r+T*a+P*c,t[8]=S*n+T*l+P*h,t}function $V(t,e,s){const i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],m=s[0],f=s[1];return t[0]=i,t[1]=r,t[2]=n,t[3]=o,t[4]=a,t[5]=l,t[6]=m*i+f*o+u,t[7]=m*r+f*a+c,t[8]=m*n+f*l+h,t}function tpe(t,e,s){const i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],m=Math.sin(s),f=Math.cos(s);return t[0]=f*i+m*o,t[1]=f*r+m*a,t[2]=f*n+m*l,t[3]=f*o-m*i,t[4]=f*a-m*r,t[5]=f*l-m*n,t[6]=u,t[7]=c,t[8]=h,t}function x5e(t,e,s){const i=s[0],r=s[1],n=s[2];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=n*e[6],t[7]=n*e[7],t[8]=n*e[8],t}function w5e(t,e,s){const i=s[0],r=s[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t}function S5e(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function E5e(t,e){const s=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=s,t[2]=0,t[3]=-s,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function C5e(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function P5e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function T5e(t,e){const s=e[0],i=e[1],r=e[2],n=e[3],o=s+s,a=i+i,l=r+r,u=s*o,c=i*o,h=i*a,m=r*o,f=r*a,g=r*l,v=n*o,b=n*a,w=n*l;return t[0]=1-h-g,t[3]=c-w,t[6]=m+b,t[1]=c+w,t[4]=1-u-g,t[7]=f-v,t[2]=m-b,t[5]=f+v,t[8]=1-u-h,t}function I5e(t,e){const s=e[0],i=e[1],r=e[2],n=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10],h=c*o-a*u,m=-c*n+a*l,f=u*n-o*l,g=s*h+i*m+r*f;if(!g)return null;const v=1/g;return t[0]=h*v,t[1]=(-c*i+r*u)*v,t[2]=(a*i-r*o)*v,t[3]=m*v,t[4]=(c*s-r*l)*v,t[5]=(-a*s+r*n)*v,t[6]=f*v,t[7]=(-u*s+i*l)*v,t[8]=(o*s-i*n)*v,t}function M5e(t,e){const s=e[0],i=e[1],r=e[2],n=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],m=e[10],f=e[11],g=e[12],v=e[13],b=e[14],w=e[15],S=s*a-i*o,T=s*l-r*o,P=s*u-n*o,I=i*l-r*a,A=i*u-n*a,D=r*u-n*l,k=c*v-h*g,R=c*b-m*g,O=c*w-f*g,z=h*b-m*v,q=h*w-f*v,U=m*w-f*b;let V=S*U-T*q+P*z+I*O-A*R+D*k;return V?(V=1/V,t[0]=(a*U-l*q+u*z)*V,t[1]=(l*O-o*U-u*R)*V,t[2]=(o*q-a*O+u*k)*V,t[3]=(r*q-i*U-n*z)*V,t[4]=(s*U-r*O+n*R)*V,t[5]=(i*O-s*q-n*k)*V,t[6]=(v*D-b*A+w*I)*V,t[7]=(b*P-g*D-w*T)*V,t[8]=(g*A-v*P+w*S)*V,t):null}function A5e(t,e,s){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/s,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function N5e(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function D5e(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function $5e(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t[3]=e[3]+s[3],t[4]=e[4]+s[4],t[5]=e[5]+s[5],t[6]=e[6]+s[6],t[7]=e[7]+s[7],t[8]=e[8]+s[8],t}function spe(t,e,s){return t[0]=e[0]-s[0],t[1]=e[1]-s[1],t[2]=e[2]-s[2],t[3]=e[3]-s[3],t[4]=e[4]-s[4],t[5]=e[5]-s[5],t[6]=e[6]-s[6],t[7]=e[7]-s[7],t[8]=e[8]-s[8],t}function R5e(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*s,t}function k5e(t,e,s,i){return t[0]=e[0]+s[0]*i,t[1]=e[1]+s[1]*i,t[2]=e[2]+s[2]*i,t[3]=e[3]+s[3]*i,t[4]=e[4]+s[4]*i,t[5]=e[5]+s[5]*i,t[6]=e[6]+s[6]*i,t[7]=e[7]+s[7]*i,t[8]=e[8]+s[8]*i,t}function F5e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function O5e(t,e){const s=t[0],i=t[1],r=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=e[0],m=e[1],f=e[2],g=e[3],v=e[4],b=e[5],w=e[6],S=e[7],T=e[8],P=_a();return Math.abs(s-h)<=P*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(i-m)<=P*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(r-f)<=P*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-g)<=P*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(o-v)<=P*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(a-b)<=P*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(l-w)<=P*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(u-S)<=P*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-T)<=P*Math.max(1,Math.abs(c),Math.abs(T))}function L5e(t){const e=_a(),s=t[0],i=t[1],r=t[2],n=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8];return Math.abs(1-(s*s+n*n+l*l))<=e&&Math.abs(1-(i*i+o*o+u*u))<=e&&Math.abs(1-(r*r+a*a+c*c))<=e}const V5e=rU,q5e=spe;Object.freeze(Object.defineProperty({__proto__:null,add:$5e,adjoint:v5e,copy:g5e,determinant:b5e,equals:O5e,exactEquals:F5e,frob:D5e,fromMat2d:P5e,fromMat4:f5e,fromQuat:T5e,fromRotation:E5e,fromScaling:C5e,fromTranslation:S5e,identity:epe,invert:_5e,isOrthoNormal:L5e,mul:V5e,multiply:rU,multiplyScalar:R5e,multiplyScalarAndAdd:k5e,normalFromMat4:M5e,normalFromMat4Legacy:I5e,projection:A5e,rotate:tpe,scale:x5e,scaleByVec2:w5e,set:Kde,str:N5e,sub:q5e,subtract:spe,translate:$V,transpose:y5e},Symbol.toStringTag,{value:"Module"}));function xA(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function G5e(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function z5e(t,e,s,i,r,n,o,a,l){const u=new Float32Array(9);return u[0]=t,u[1]=e,u[2]=s,u[3]=i,u[4]=r,u[5]=n,u[6]=o,u[7]=a,u[8]=l,u}function U5e(t,e){return new Float32Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:G5e,create:xA,createView:U5e,fromValues:z5e},Symbol.toStringTag,{value:"Module"}));function ipe(){return new Float32Array(2)}function B5e(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function Db(t,e){const s=new Float32Array(2);return s[0]=t,s[1]=e,s}function j5e(t,e){return new Float32Array(t,e,2)}function rpe(){return ipe()}function npe(){return Db(1,1)}function ope(){return Db(1,0)}function ape(){return Db(0,1)}const H5e=rpe(),Y5e=npe(),X5e=ope(),W5e=ape();Object.freeze(Object.defineProperty({__proto__:null,ONES:Y5e,UNIT_X:X5e,UNIT_Y:W5e,ZEROS:H5e,clone:B5e,create:ipe,createView:j5e,fromValues:Db,ones:npe,unitX:ope,unitY:ape,zeros:rpe},Symbol.toStringTag,{value:"Module"}));function Z5e(t){return t instanceof Float32Array&&t.length>=2}function Q5e(t){return Array.isArray(t)&&t.length>=2}function Q4(t){return Z5e(t)||Q5e(t)}var RV;const Em=[0,0];let zm=RV=class extends Te{constructor(t){super(t),this._viewpoint2D={center:ar(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Hs,this.id=0,this.inverseTransform=xd(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=xd(),this.transformNoRotation=xd(),this.displayMat3=xA(),this.displayViewMat3=xA(),this.viewMat3=xA(),this.viewMat2d=g3(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,s=t.targetGeometry;e.center[0]=s.x,e.center[1]=s.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=s.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,s=this.viewpoint;return s&&e?(this.viewpoint=Fo(s,t.viewpoint),this._set("size",ib(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new RV({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,s){return Q4(e)?Vh(t,e,this.inverseTransform):(Em[0]=e,Em[1]=s,Vh(t,Em,this.inverseTransform))}toScreen(t,e,s){return Q4(e)?Vh(t,e,this.transform):(Em[0]=e,Em[1]=s,Vh(t,Em,this.transform))}toScreenNoRotation(t,e,s){return Q4(e)?Vh(t,e,this.transformNoRotation):(Em[0]=e,Em[1]=s,Vh(t,Em,this.transformNoRotation))}wrapMapCoordinate(t,e){ib(t,e);const[s]=e,[i]=this.center,{extent:r,spatialReference:n}=this;let{xmin:o,xmax:a}=r;if(n.isWrappable){const l=Xde(n)/2;o=Math.max(o,i-l),a=Math.min(a,i+l)}return(s<o||s>a)&&(t[0]=K7(s,i,n)),t}getScreenTransform(t,e){const{center:s}=this._viewpoint2D,i=this._get("pixelRatio")||1,r=this._get("size");return sU(t,s,r,e,0,i),t}_update(){const{center:t,spatialReference:e,scale:s,rotation:i}=this._viewpoint2D,r=this._get("pixelRatio")||1,n=this._get("size"),o=new Lu({targetGeometry:new Et(t[0],t[1],e),scale:s,rotation:i});if(this._set("viewpoint",o),!n||!e||!s)return;this.resolution=mx(o),this.rotation=i,this.scale=s,this.spatialReference=e,ib(this.center,t);const a=n[0]!==0?2/n[0]:0,l=n[1]!==0?-2/n[1]:0;Kde(this.displayMat3,a,0,0,0,l,0,-1,1,1);const u=epe(this.viewMat3),c=Db(n[0]/2,n[1]/2),h=Db(-n[0]/2,-n[1]/2),m=I7(i);$V(u,u,c),tpe(u,u,m),$V(u,u,h),rU(this.displayViewMat3,this.displayMat3,u);const f=J7(this.viewMat2d,c);return cP(f,f,m),Nb(f,f,h),JLe(this.extent,o,n),iU(this.transform,o,n,r),Q7(this.inverseTransform,this.transform),r5e(this.transformNoRotation,o,n,r),this.worldScreenWidth=n5e(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};p([_({readOnly:!0})],zm.prototype,"id",void 0),p([_({value:1,json:{write:!0}})],zm.prototype,"pixelRatio",null),p([_({json:{write:!0}})],zm.prototype,"size",null),p([_()],zm.prototype,"spatialReference",void 0),p([_({type:Lu,json:{write:!0}})],zm.prototype,"viewpoint",null),p([_({readOnly:!0})],zm.prototype,"visibleArea",null),zm=RV=p([Q("esri.views.2d.ViewState")],zm);const jQ=zm;var kV,FV;let hd=kV=class extends Ye{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new kV({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};p([_()],hd.prototype,"left",void 0),p([_()],hd.prototype,"top",void 0),p([_()],hd.prototype,"right",void 0),p([_()],hd.prototype,"bottom",void 0),hd=kV=p([Q("esri.views.2d.PaddedViewState.Padding")],hd);let Q1=FV=class extends jQ{constructor(...t){super(...t),this.paddedViewState=new jQ,this._updateContent=(()=>{const e=ar();return()=>{const s=this._get("size"),i=this._get("padding");if(!s||!i)return;const r=this.paddedViewState;On(e,i.left+i.right,i.top+i.bottom),VE(e,s,e),ib(r.size,e);const n=r.viewpoint;n&&(this.viewpoint=n)}})(),this.addHandles(Ee(()=>[this.size,this.padding],()=>this._updateContent(),Xc)),this.padding=new hd,this.size=[0,0]}set padding(t){this._set("padding",t||new hd)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const s=this._get("padding");s&&(e=a5e(t.clone(),t,this._get("size"),s));const{targetGeometry:i,rotation:r,scale:n}=e,{x:o,y:a,spatialReference:l}=i,u=this._viewpoint2D;u.center[0]=o,u.center[1]=a,u.rotation=r,u.scale=n,u.spatialReference=l,this._update()}}clone(){return new FV({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};p([_()],Q1.prototype,"paddedViewState",void 0),p([_({type:hd})],Q1.prototype,"padding",null),p([_()],Q1.prototype,"viewpoint",null),Q1=FV=p([Q("esri.views.2d.PaddedViewState")],Q1);const nU=Q1;var ao;(function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"})(ao||(ao={}));const lpe=Symbol("Yield");let J5e=class{constructor(){this._tasks=new Array,this._runningTasks=Ib(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return lpe;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,s,i){return++this._runningTasks.value,new Promise((r,n)=>this._tasks.push(new HQ(r,n,e,s,i))).finally(()=>--this._runningTasks.value)}unshift(e,s,i){return++this._runningTasks.value,new Promise((r,n)=>this._tasks.unshift(new HQ(r,n,e,s,i))).finally(()=>--this._runningTasks.value)}_process(e){var i;if(this._tasks.length===0)return!1;const s=this._tasks.shift();try{const r=Yl(s.signal);if(r&&!s.abortCallback)s.reject(xi());else{const n=r?(i=s.abortCallback)==null?void 0:i.call(s,xi()):s.callback(e);sm(n)?n.then(s.resolve,s.reject):s.resolve(n)}}catch(r){s.reject(r)}return!0}cancelAll(){const e=xi();for(const s of this._tasks)if(s.abortCallback){const i=s.abortCallback(e);s.resolve(i)}else s.reject(e);this._tasks.length=0}},HQ=class{constructor(e,s,i,r=void 0,n=void 0){this.resolve=e,this.reject=s,this.callback=i,this.signal=r,this.abortCallback=n}},sS=class extends Ye{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};p([_()],sS.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),p([_()],sS.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),sS=p([Q("esri.views.support.debugFlags")],sS);const K5e=new sS;function e6e(){return new y3.Scheduler}var Bt;(function(t){t.RESOURCE_CONTROLLER_IMMEDIATE="immediate",t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.LOD_RENDERER="LoD renderer",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="clouds generator",t.MAPVIEW_FETCH_QUEUE="mapview fetch queue",t.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",t.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",t[t.NONE=0]="NONE",t[t.TEST_PRIO=1]="TEST_PRIO"})(Bt||(Bt={}));const Cu=0,YQ=new Map([[Bt.RESOURCE_CONTROLLER_IMMEDIATE,Cu],[Bt.RESOURCE_CONTROLLER,4],[Bt.SLIDE,Cu],[Bt.STREAM_DATA_LOADER,Cu],[Bt.ELEVATION_QUERY,Cu],[Bt.TERRAIN_SURFACE,1],[Bt.SURFACE_GEOMETRY_UPDATES,1],[Bt.LOD_RENDERER,2],[Bt.GRAPHICS_CORE,2],[Bt.I3S_CONTROLLER,2],[Bt.POINT_CLOUD_LAYER,2],[Bt.FEATURE_TILE_FETCHER,2],[Bt.CLOUDS_GENERATOR,2],[Bt.OVERLAY,4],[Bt.STAGE,4],[Bt.GRAPHICS_DECONFLICTOR,4],[Bt.FILTER_VISIBILITY,4],[Bt.SCALE_VISIBILITY,4],[Bt.FRUSTUM_VISIBILITY,4],[Bt.POINT_OF_INTEREST_FREQUENT,6],[Bt.POINT_OF_INTEREST_INFREQUENT,30],[Bt.LABELER,8],[Bt.FEATURE_QUERY_ENGINE,8],[Bt.FEATURE_TILE_TREE,16],[Bt.FEATURE_TILE_TREE_ACTIVE,Cu],[Bt.ELEVATION_ALIGNMENT,12],[Bt.ELEVATION_ALIGNMENT_SCENE,14],[Bt.TEXT_TEXTURE_ATLAS,12],[Bt.TEXTURE_UNLOAD,12],[Bt.LINE_OF_SIGHT_TOOL,16],[Bt.LINE_OF_SIGHT_TOOL_INTERACTIVE,Cu],[Bt.SNAPPING,Cu],[Bt.SHADOW_ACCUMULATOR,30],[Bt.MAPVIEW_FETCH_QUEUE,Cu],[Bt.MAPVIEW_LAYERVIEW_UPDATE,2],[Bt.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,Cu]]);function XQ(t){return YQ.has(t)?YQ.get(t):typeof t=="number"?t:1}const t6e=6.5,WQ=1,s6e=30,i6e=1e3/30,r6e=100,ZQ=.9;var y3,Yg;(function(t){class e{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(n=>n.needsUpdate)}constructor(){this._updating=Ib(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new zS("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new i,this._state=ao.INTERACTING,this._tasks=new y_,this._runQueue=new y_,this._load=0,this._idleStateCallbacks=new y_,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=Ee(()=>K5e.SCHEDULER_LOG_SLOW_TASKS,n=>this._debug=n,ht);for(const n of Object.keys(Bt))this.performanceInfo.tasks.set(Bt[n],new zS(Bt[n]))}destroy(){this._tasks.toArray().forEach(n=>n.remove()),this._tasks.clear(),qi(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(n){this._updatingChanged(),n&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())}))}registerTask(n,o){const a=new s(this,n,o);return this._tasks.push(a),this._updatingChanged(),this.performanceInfo.tasks.has(n)||this.performanceInfo.tasks.set(n,new zS(n)),a}registerIdleStateCallbacks(n,o){const a={idleBegin:n,idleEnd:o};this._idleStateCallbacks.push(a),this.state===ao.IDLE&&this._idleUpdatesStartFired&&a.idleBegin();const l=this;return{remove:()=>this._removeIdleStateCallbacks(a),set idleBegin(u){l._idleUpdatesStartFired&&(a.idleEnd(),l._state===ao.IDLE&&u()),a.idleBegin=u},set idleEnd(u){a.idleEnd=u}}}get load(){return this._load}set state(n){this._state!==n&&(this._state=n,this.state!==ao.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(o=>o.idleEnd())))}get state(){return this._state}frame(n){this._startFrameTaskTimes();const o=this._updateBudget(n);if(o){const a=this._budget.now();this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-a)}else this._recordFrameTaskTimes(0);return o}_updateBudget(n){this._test&&(this._test.usedBudget=0),++this._frameNumber;let o=t6e,a=n.frameDuration,l=WQ;switch(this.state){case ao.IDLE:o=0,a=Math.max(r6e,n.frameDuration),l=s6e;break;case ao.INTERACTING:a=Math.max(i6e,n.frameDuration);case ao.ANIMATING:}return a=a-n.elapsedFrameTime-o,this.state!==ao.IDLE&&a<WQ&&!this._forceTask?(this._forceTask=!0,!1):(a=Math.max(a,l),this._budget.reset(a,this.state),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case ao.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(n=>n.idleBegin())),this._runIdle();break;case ao.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0,this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(n){this._idleUpdatesStartFired&&n.idleEnd(),this._idleStateCallbacks.removeUnordered(n)}removeTask(n){this._tasks.removeUnordered(n),this._runQueue.removeUnordered(n),this._updatingChanged()}_updateTask(n){this._tasks.forAll(o=>{o.name===n&&o.setPriority(n)})}_getState(n){if(this._runQueue.some(a=>a.name===n))return Yg.SCHEDULED;let o=Yg.IDLE;return this._tasks.forAll(a=>{a.name===n&&a.needsUpdate&&(a.schedulePriority<=1?o=Yg.READY:o!==Yg.READY&&(o=Yg.WAITING))}),o}_getRuntime(n){let o=0;return this._tasks.forAll(a=>{a.name===n&&(o+=a.runtime)}),o}_resetRuntimes(){this._tasks.forAll(n=>n.runtime=0)}_getRunning(){const n=new Map;if(this._tasks.forAll(a=>{a.needsUpdate&&n.set(a.name,(n.get(a.name)||0)+1)}),n.size===0)return null;let o="";return n.forEach((a,l)=>{o+=a>1?` ${a}x ${l}`:` ${l}`}),o}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const n=this._tasks.reduce((o,a)=>a.needsUpdate?++o:o,0);this._load=this._load*ZQ+n*(1-ZQ)}_schedule(){for(this._runQueue.filterInPlace(n=>!!n.needsUpdate||(n.schedulePriority=n.basePriority,!1)),this._tasks.forAll(n=>{n.basePriority===Cu&&n.needsUpdate&&!this._runQueue.includes(n)&&n.blockFrame!==this._frameNumber&&this._runQueue.unshift(n)});this._runQueue.length===0;){let n=!1,o=0;if(this._tasks.forAll(a=>{a.needsUpdate&&a.schedulePriority!==0&&a.basePriority!==Cu&&a.blockFrame!==this._frameNumber&&(n=!0,o=Math.max(o,a.basePriority),a.schedulePriority===1?(a.schedulePriority=0,this._runQueue.push(a)):--a.schedulePriority)}),!n)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do for(;this._runQueue.length>0;){const n=this._budget.now(),o=this._runQueue.pop();this._budget.resetProgress();try{o.task.runTask(this._budget)===lpe&&(o.blockFrame=this._frameNumber)}catch(l){Ne.getLogger("esri.views.support.Scheduler").error(`Exception in task "${o.name}"`,l),o.blockFrame=this._frameNumber}!this._budget.hasProgressed&&o.blockFrame!==this._frameNumber&&o.needsUpdate&&(o.name,Bt.I3S_CONTROLLER,o.blockFrame=this._frameNumber),o.schedulePriority=o.basePriority;const a=this._budget.now()-n;if(o.runtime+=a,this._frameTaskTimes.set(o.priority,this._frameTaskTimes.get(o.priority)+a),this._budget.remaining<=0)return void this._updatingChanged()}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const n of Object.keys(Bt))this._frameTaskTimes.set(Bt[n],0)}_recordFrameTaskTimes(n){this._frameTaskTimes.forEach((o,a)=>this.performanceInfo.tasks.get(a).push(o)),this.performanceInfo.total.push(n)}get test(){return this._test}}t.Scheduler=e;class s{get task(){return this._task.value}get updating(){return this._queue.running}constructor(n,o,a){this._scheduler=n,this.name=o,this.blockFrame=0,this.runtime=0,this._queue=new J5e,this._handles=new Kb,this._basePriority=XQ(o),this.schedulePriority=this._basePriority,this._task=Ib(a??this._queue),this._handles.add(Or(()=>this.task.running,l=>n.taskRunningChanged(l)))}remove(){this.processQueue(upe),this._scheduler.removeTask(this),this.schedule=QQ.schedule,this.reschedule=QQ.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(n){if(this.name===n)return;this.name=n;const o=XQ(n);this._basePriority!==Cu&&this.schedulePriority===0||(this.schedulePriority=o),this._basePriority=o}get priority(){return this.name}set priority(n){this.setPriority(n)}get needsUpdate(){return this.updating||this.task.running}schedule(n,o,a){return this._queue.push(n,o,a)}reschedule(n,o,a){return this._queue.unshift(n,o,a)}processQueue(n){return this._queue.runTask(n)}}class i{constructor(){this._begin=typeof performance<"u"?performance.now():0,this._budget=0,this._state=ao.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(n){return!this.done&&(n()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(n){this._enabled=n}reset(n,o){this._begin=this.now(),this._budget=n,this._state=o,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}t.Budget=i})(y3||(y3={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(Yg||(Yg={}));const upe=(()=>{const t=new y3.Budget;return t.enabled=!1,t})();let n6e=class{remove(){}processQueue(){}schedule(e,s,i){try{if(Yl(s)){const r=xi();return i?Promise.resolve(i(r)):Promise.reject(r)}return QL(e(upe))}catch(r){return Promise.reject(r)}}reschedule(e,s,i){return this.schedule(e,s,i)}};const QQ=new n6e;let o6e=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=e6e(),this._schedulerHandle=Or(()=>this._scheduler.updating,()=>this.requestFrame()),this.stationary=!0,this.prepare=()=>{var s;this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),((s=this.view.animation)==null?void 0:s.target)==null||sm(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=s=>{var a,l,u;if(this._updateRequested=!1,(a=this.view)==null?void 0:a.destroyed)return;const{allLayerViews:i,graphicsView:r,labelManager:n,state:{id:o}}=this.view;i==null||i.forEach(this._updateLayerView,this),n!=null&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),r!=null&&(r.lastUpdateId!==o&&(r.viewChange(),r.lastUpdateId=o),r.updateRequested&&r.processUpdate(this._updateParameters)),(l=this.view.graphicsTileStore)==null||l.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=ao.ANIMATING:this.view.interacting?this._scheduler.state=ao.INTERACTING:this._scheduler.state=ao.IDLE,this._scheduler.frame(s)||this._updateRequested||this._scheduler.state!==ao.IDLE||((u=this._frameTaskHandle)==null||u.pause())}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new nU,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=Ee(()=>e.stationary,s=>{this.stationary=s,this.requestFrame()}),this._frameTaskHandle=fb(this),this.requestUpdate()}stop(){var e;this._frameTaskHandle&&(this._updateRequested=!1,(e=this._stationaryHandle)==null||e.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){var r;if(!e.attached)return void this.requestUpdate();const s=this.view.state,i=e.lastUpdateId;i!=null&&(this.stationary||e.moving)||(e.moving=!0),i!==s.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=s.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&((r=e.layerViews)==null||r.forEach(this._updateLayerView,this))}},Wp=class extends YC{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=Xl(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._resolver)==null||e.reject(new ae("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._resolver)==null||e.resolve())}update(e,s){s||(s=sm(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",s)}};p([_({readOnly:!0})],Wp.prototype,"done",null),p([_({readOnly:!0,type:String})],Wp.prototype,"state",void 0),p([_()],Wp.prototype,"target",void 0),Wp=p([Q("esri.views.ViewAnimation")],Wp),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(Wp||(Wp={}));const OV=Wp;let wA=class extends Ye{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,s){if(!e)return void Ne.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new OV;this.view.animation=i,await zC(()=>this.view.ready,s);const r={...s,animate:(s==null?void 0:s.animate)??!X7(),animationMode:(s==null?void 0:s.animationMode)??"auto"},{extent:n,spatialReference:o,size:a,viewpoint:l,constraints:u,padding:c,allLayerViews:h}=this.view,m=ZLe(e,{extent:n,spatialReference:o,size:a,viewpoint:l,constraints:u,padding:c,allLayerViews:h,pickClosestTarget:(s==null?void 0:s.pickClosestTarget)??!0});return i==null||i.update(m),this._gotoTask={},r.animate?this._gotoAnimated(m,r):this._gotoImmediate(m,r)}_gotoImmediate(e,s){const i=this._gotoTask,r=this.view.animation,n=e.then(o=>{if(ni(s),i!==this._gotoTask)throw new ae("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=r.target=o,r.finish()});return this._cancellableGoTo(i,r,n,s)}_gotoAnimated(e,s){const i=this._gotoTask,r=this.view.animation;if(!r)return Promise.resolve();const n=e.then(o=>{if(ni(s),i!==this._gotoTask)throw new ae("view:goto-interrupted","Goto was interrupted");return r.update(o),this.view.animationManager.animate(r,this.view.viewpoint,s),r.when().then(()=>{},()=>{})});return this._cancellableGoTo(i,r,n,s)}_cancellableGoTo(e,s,i,r){const n=()=>e===this._gotoTask;return _z(i,r).finally(()=>{n()&&(s.done||s.stop())})}};p([_({constructOnly:!0})],wA.prototype,"view",void 0),wA=p([Q("esri.views.2d.GoToManager")],wA);function a6e(t,e){const{spatialReference:s}=e,i=[e.x,e.y];let r,n,o,a;const l=[0,0],u=l6e(t);for(let m=0;m<u.length;m++){const f=u[m];for(let g=0;g<f.length-1;g++){gIe(l,i,f,g);const v=S$(i,l);(r==null||v<r)&&(r=v,n=[...l],o=m,a=g)}}if(r==null||!n||o==null||a==null)throw new ae("nearest-coordinate:failed","Failed to find the nearest coordinate");const[c,h]=n;return{coordinate:new Et({x:c,y:h,spatialReference:s}),distance:r}}function l6e(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var LV;let Qy=LV=class extends sh.NumericIdentifiableMixin(Ye){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Vd(this.geometry,this.spatialReference)}catch(t){return Ne.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const s=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?VC(this.normalizedGeometry,s):Uz(this.normalizedGeometry,s))return t;const{coordinate:i}=a6e(this.normalizedGeometry,s);return i&&(t.targetGeometry=i),t}clone(){var t,e;return new LV({geometry:(t=this.geometry)==null?void 0:t.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};p([_({constructOnly:!0})],Qy.prototype,"geometry",void 0),p([_({readOnly:!0})],Qy.prototype,"normalizedGeometry",null),p([_({constructOnly:!0})],Qy.prototype,"spatialReference",void 0),Qy=LV=p([Q("esri.views.2d.constraints.GeometryConstraint")],Qy);var VV;let iS=VV=class extends sh.NumericIdentifiableMixin(Ye){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new VV({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};p([_()],iS.prototype,"enabled",void 0),p([_()],iS.prototype,"rotationEnabled",void 0),iS=VV=p([Q("esri.views.2d.constraints.RotationConstraint")],iS);const cpe=iS;var qV;let $a=qV=class extends sh.NumericIdentifiableMixin(Ye){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:s,maxScale:i,minZoom:r,maxZoom:n}=this,o=-1,a=-1,l=!1,u=!1;if(s!==0&&i!==0&&s<i&&([s,i]=[i,s]),!(e!=null&&e.length))return this._set("effectiveMinScale",s),void this._set("effectiveMaxScale",i);e=e.map(c=>c.clone()),e.sort((c,h)=>h.scale-c.scale),e.forEach((c,h)=>c.level=h);for(const c of e)!l&&s>0&&s>=c.scale&&(o=c.level,l=!0),!u&&i>0&&i>=c.scale&&(a=t?t.level:-1,u=!0),t=c;r===-1&&(r=s===0?0:o),n===-1&&(n=i===0?e.length-1:a),r=Math.max(r,0),r=Math.min(r,e.length-1),n=Math.max(n,0),n=Math.min(n,e.length-1),r>n&&([r,n]=[n,r]),s=e[r].scale,i=e[n].scale,e.splice(0,r),e.splice(n-r+1,e.length),e.forEach((c,h)=>{this._lodByScale[c.scale]=c,this._scales[h]=c.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",r),this._set("effectiveMaxZoom",n),this._set("effectiveMinScale",s),this._set("effectiveMaxScale",i)}constrain(t,e){if(e&&t.scale===e.scale)return t;const s=this.effectiveMinScale,i=this.effectiveMaxScale,r=t.targetGeometry,n=e&&e.targetGeometry,o=i!==0&&t.scale<i,a=s!==0&&t.scale>s;if(o||a){const l=a?s:i;if(e&&n){const u=(l-e.scale)/(t.scale-e.scale);r.x=n.x+(r.x-n.x)*u,r.y=n.y+(r.y-n.y)*u}t.scale=l}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),s=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(s>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const s=Math.floor(t),i=Math.ceil(t);return e[s]+(t-s)*(e[i]-e[s])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let s,i;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let r=0;r<e.length-1;r++){if(s=e[r],i=e[r+1],i===t)return r+this.effectiveMinZoom+1;if(s>t&&i<t)return r+this.effectiveMinZoom+1-(t-i)/(s-i)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const s=Math.round(this.scaleToZoom(t));return this.zoomToScale(s+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const s=Math.round(this.scaleToZoom(t));return this.zoomToScale(s-1)}clone(){return new qV({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,s)=>Math.abs(s-t)<=Math.abs(e-t)?s:e,this._scales[0])),this._lodByScale[t].scale}};p([_({readOnly:!0})],$a.prototype,"effectiveLODs",void 0),p([_({readOnly:!0})],$a.prototype,"effectiveMinZoom",void 0),p([_({readOnly:!0})],$a.prototype,"effectiveMaxZoom",void 0),p([_({readOnly:!0})],$a.prototype,"effectiveMinScale",void 0),p([_({readOnly:!0})],$a.prototype,"effectiveMaxScale",void 0),p([_()],$a.prototype,"lods",void 0),p([_()],$a.prototype,"minZoom",void 0),p([_()],$a.prototype,"maxZoom",void 0),p([_()],$a.prototype,"minScale",void 0),p([_()],$a.prototype,"maxScale",void 0),p([_()],$a.prototype,"snapToZoom",void 0),$a=qV=p([Q("esri.views.2d.constraints.ZoomConstraint")],$a);const hpe=$a,u6e={base:null,key:"type",typeMap:{extent:Hs,polygon:po}};let yr=class extends Ye{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new Ge}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,s,i;return`${(e=this._zoom)==null?void 0:e.uid}/${(s=this._rotation)==null?void 0:s.uid}/${(i=this._geometry)==null?void 0:i.uid}`}get _geometry(){var s,i;const e=this._get("_geometry");return e&&this.geometry===e.geometry&&((s=this.view)==null?void 0:s.constraintsInfo.spatialReference)===e.spatialReference?e:new Qy({geometry:this.geometry,spatialReference:(i=this.view)==null?void 0:i.constraintsInfo.spatialReference})}get _rotation(){return new cpe({rotationEnabled:this.rotationEnabled})}get _zoom(){var l;const e=this._get("_zoom"),s=this.lods||((l=this.view)==null?void 0:l.constraintsInfo.lods),i=this.minZoom,r=this.maxZoom,n=this.minScale,o=this.maxScale,a=this.snapToZoom;return e&&e.lods===s&&e.minZoom===i&&e.maxZoom===r&&e.minScale===n&&e.maxScale===o&&e.snapToZoom===a?e:new hpe({lods:s,minZoom:i,maxZoom:r,minScale:n,maxScale:o,snapToZoom:a})}canZoomInTo(e){const s=this.effectiveMaxScale;return s===0||e>=s}canZoomOutTo(e){const s=this.effectiveMinScale;return s===0||e<=s}constrain(e,s){return this._zoom.constrain(e,s),this._rotation.constrain(e,s),this._geometry.constrain(e,s),this.customConstraints.forEach(i=>i.constrain(e,s)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(s=>{var i;return(i=s.applyPanConstraint)==null?void 0:i.call(s,e)}),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};p([_({readOnly:!0})],yr.prototype,"effectiveLODs",null),p([_({readOnly:!0})],yr.prototype,"effectiveMinScale",null),p([_({readOnly:!0})],yr.prototype,"effectiveMaxScale",null),p([_({readOnly:!0})],yr.prototype,"effectiveMinZoom",null),p([_({readOnly:!0})],yr.prototype,"effectiveMaxZoom",null),p([_({types:u6e,value:null})],yr.prototype,"geometry",null),p([_({type:[df]})],yr.prototype,"lods",void 0),p([_()],yr.prototype,"minScale",void 0),p([_()],yr.prototype,"maxScale",void 0),p([_()],yr.prototype,"minZoom",void 0),p([_()],yr.prototype,"maxZoom",void 0),p([_()],yr.prototype,"rotationEnabled",void 0),p([_()],yr.prototype,"snapToZoom",void 0),p([_({type:Ge})],yr.prototype,"customConstraints",void 0),p([_()],yr.prototype,"view",void 0),p([_({readOnly:!0})],yr.prototype,"version",null),p([_({type:Qy,readOnly:!0})],yr.prototype,"_geometry",null),p([_({type:cpe})],yr.prototype,"_rotation",null),p([_({readOnly:!0,type:hpe})],yr.prototype,"_zoom",null),yr=p([Q("esri.views.2d.MapViewConstraints")],yr);const JQ=yr;let Po=class extends Ye{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([Ee(()=>{var s;return(s=this.constraints)==null?void 0:s.version},s=>{this.constraints&&s&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},Xc)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:s}=this.state.paddedViewState;return this.state.commitProperty("id"),new Et({x:e[0],y:e[1],spatialReference:s})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let s;try{s=this._project(e,this.state.spatialReference)}catch(r){return void Ne.getLogger(this).error(new ae("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:r}))}const i=this.viewpoint;DV(i,i,s),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void Ne.getLogger(this).error(new ae("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let s;try{s=this._project(e,this.state.spatialReference)}catch(r){return void Ne.getLogger(this).error(new ae("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:r}))}const i=this.viewpoint;KLe(i,i,s,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const s=this.viewpoint;u5e(s,s,e),this.viewpoint=s}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}const s=this.viewpoint;BQ(s,s,e),this.viewpoint=s}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){var n;if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let s,i;try{s=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?i=new ae("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(i=new ae("mapview:invalid-viewpoint","geometry not defined"))}catch(o){i=new ae("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:o})}if(i)return void Ne.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const r=new Lu({targetGeometry:new Et,scale:0,rotation:0});Fo(r,s),(n=this.constraints)==null||n.constrain(r,this.state.paddedViewState.viewpoint),this.state.viewpoint=r,this._set("viewpoint",r)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){var e;return this.ready?((e=this.constraints)==null?void 0:e.scaleToZoom(this.scale))??-1:this._get("zoom")}set zoom(e){var r,n;if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const o=this._get("extent");return void(o&&(this._set("extent",void 0),this._set("center",o.center)))}const s=((r=this.constraints)==null?void 0:r.zoomToScale(e))??0;if(!s)return void this._set("zoom",-1);const i=this.viewpoint;BQ(i,i,s),this.viewpoint=i,this._set("zoom",((n=this.constraints)==null?void 0:n.scaleToZoom(this.scale))??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:s,constraints:i}=this,r=this._get("center"),n=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),l=this._get("viewpoint"),u=this._get("zoom"),c=u!=null&&i!=null&&i.zoomToScale(u)||void 0;let h,m,f;const g=l==null?void 0:l.rotation,v=l==null?void 0:l.targetGeometry;(v==null?void 0:v.type)==="extent"?h=v:(v==null?void 0:v.type)==="point"&&(m=v,f=l==null?void 0:l.scale);const b=n??h;return{center:r??m??(b==null?void 0:b.center),rotation:a??g,scale:(o??c??f??(b&&P$(b,[e[0]-s.left-s.right,e[1]-s.top-s.bottom])))||void 0}}startup(e,s,i,r){var o;const n=e.targetGeometry;try{this._project(e,i)}catch(a){Ne.getLogger(this).warn(new qu("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:n.toJSON(),spatialReference:i,error:a})),e.targetGeometry=r||new Et({x:0,y:0,spatialReference:i})}(o=this.constraints)==null||o.fit(e),this._set("state",new nU({padding:this.padding,size:s,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,s],spatialReference:i,rotation:r,scale:n}=this.state.paddedViewState,o=new Et({x:e,y:s,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",r),this._set("scale",n),this._set("state",null)}changeSpatialReference(e){var l;const s=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=s.scale;else{const u=s.viewpoint.clone();u.scale=this._scaleBeforeChangingSpatialReference,s.viewpoint=u}const i=s.clone(),[r,n]=s.center;let o=null;try{o=this._project(new Et({x:r,y:n,spatialReference:s.spatialReference}),e)}catch(u){qD()||Ne.getLogger(this).warn(new qu("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o==null?void 0:o.toJSON(),spatialReference:e,error:u}))}o||(o=new Et({x:0,y:0,spatialReference:e}));const a=DV(new Lu({targetGeometry:new Et,scale:0,rotation:0}),s.viewpoint,o);i.viewpoint=a;try{const c=[s.size[0]/2,s.size[1]/2],h=[c[0]+20,c[1]],m=s.toMap([0,0],h),{x:f,y:g}=this._project(new Et({x:m[0],y:m[1],spatialReference:s.spatialReference}),e);m[0]=f,m[1]=g,i.toScreen(m,m);const v=o5e(c,m,h),b=Math.hypot(m[0]-c[0],m[1]-c[1])/20;!Number.isFinite(b)||Math.abs(b)>4?(a.rotation=0,a.targetGeometry=new Et({x:0,y:0,spatialReference:e})):(a.scale*=b,a.scale>ge("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(v)?v:0)}catch{}(l=this._get("constraints"))==null||l.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,s){var o;if(!this.ready)return;const i=this.state;let r=this.state.paddedViewState.viewpoint;const n=this.state.paddedViewState.size.slice();i.size=[e,s],l5e(r,r,n,this.state.paddedViewState.size,this.resizeAlign),r=((o=this.constraints)==null?void 0:o.constrain(r,void 0))??r,this.state.viewpoint=r}toMap(e){if(!this.ready)return null;const s=[0,0],[i,r]=this.state.toMap(s,[e.x,e.y]),n=this.state.spatialReference;return new Et({x:i,y:r,spatialReference:n})}toScreen(e,s){if(!this.ready)return null;const i=this._project(e,this.state.spatialReference),r=[i.x,i.y];return(s==null?void 0:s.pickClosestTarget)===!1||this.state.paddedViewState.wrapMapCoordinate(r,r),this.state.toScreen(r,r),Bn(r[0],r[1])}_project(e,s){var n;const i=(e==null?void 0:e.targetGeometry)||e;if(!s)return e;if(!i)return null;if(s.imageCoordinateSystem||(n=i.spatialReference)!=null&&n.imageCoordinateSystem||on(s,i.spatialReference))return e;const r=Vd(i,s);if(!r)throw new ae("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:s});return c6e(e)?(e.targetGeometry=r,e):r}};function c6e(t){return(t==null?void 0:t.declaredClass)==="esri.Viewpoint"}p([_({type:Et})],Po.prototype,"center",null),p([_()],Po.prototype,"constraints",void 0),p([_({type:Hs})],Po.prototype,"extent",null),p([_({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],Po.prototype,"padding",null),p([_()],Po.prototype,"ready",void 0),p([_()],Po.prototype,"resizeAlign",void 0),p([_({readOnly:!0})],Po.prototype,"resolution",null),p([_({type:Number})],Po.prototype,"rotation",null),p([_({type:Number})],Po.prototype,"scale",null),p([_({readOnly:!0})],Po.prototype,"state",void 0),p([_({type:Lu})],Po.prototype,"viewpoint",null),p([_({readOnly:!0})],Po.prototype,"visibleArea",null),p([_()],Po.prototype,"zoom",null),Po=p([Q("esri.views.2d.ViewStateManager")],Po);function mpe(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function dpe(t,e){return e.some(s=>mpe(t,s))}function KQ(t,{dragPrimary:e,dragSecondary:s,dragTertiary:i}){return[{key:"primary",value:e},{key:"secondary",value:s},{key:"tertiary",value:i}].filter(r=>r.value===t).map(r=>r.key)}let eJ=class extends Cn{constructor(e,s){super(!0),this._view=e,this.registerIncoming("double-click",s,i=>this._handleDoubleClick(i,s))}_handleDoubleClick(e,s){mpe(e.data,"primary")&&(e.stopPropagation(),s?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},h6e=class extends Cn{constructor(e,s,i){super(!0),this.view=e,this.pointerType=s,this.registerIncoming("double-tap-drag",i,r=>this._handleDoubleTapDrag(r))}_handleDoubleTapDrag(e){const{data:s}=e,{pointerType:i}=s;if(i!==this.pointerType)return;e.stopPropagation();const{action:r,delta:n}=s,{view:o}=this,{mapViewNavigation:a}=o;switch(r){case"begin":{const{scale:l}=o;this._startScale=l,this._currentScale=l,this._previousDelta=n,a.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;const l=1.015**n.y,u=this._startScale*l,c=u/this._currentScale;a.setViewpointImmediate(c),this._currentScale=u;break}case"end":{const{constraints:l}=o,{effectiveLODs:u,snapToZoom:c}=l;if(!c||!u)return void a.end();const h=l.snapScale(this._currentScale),m=(n.y>0?Math.max(h,l.snapToPreviousScale(this._startScale)):Math.min(h,l.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(m).then(()=>{a.end()});break}}}},I$=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const s=e.data,i=s.pointers.size;switch(s.action){case"start":this._currentCount=i,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var s,i;this._startEvent=e,(i=(s=this._callbacks).condition)!=null&&i.call(s,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var s,i;(i=(s=this._callbacks).condition)!=null&&i.call(s,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var s,i;(i=(s=this._callbacks).condition)!=null&&i.call(s,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},m6e=class extends Cn{constructor(e,s,i){super(!0),this.view=e,this.pointerActions=s,this.registerIncoming("drag",i,r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new I$({start:(s,i)=>{this.view.mapViewNavigation.pan.begin(this.view,i.data),i.stopPropagation()},update:(s,i)=>{this.view.mapViewNavigation.pan.update(this.view,i.data),i.stopPropagation()},end:(s,i)=>{this.view.mapViewNavigation.pan.end(this.view,i.data),i.stopPropagation()},condition:(s,i)=>s===1&&dpe(i.data,this.pointerActions)})}_handleDrag(e){const s=this.view.mapViewNavigation;s.pinch.zoomMomentum||s.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},d6e=class extends Cn{constructor(e,s,i){super(!0),this._view=e,this.pointerActions=s;const r=this._view.mapViewNavigation;this._dragEventSeparator=new I$({start:(n,o)=>{r.rotate.begin(this._view,o.data),o.stopPropagation()},update:(n,o)=>{r.rotate.update(this._view,o.data),o.stopPropagation()},end:(n,o)=>{r.rotate.end(),o.stopPropagation()},condition:(n,o)=>n===1&&dpe(o.data,this.pointerActions)}),this.registerIncoming("drag",i,n=>this._dragEventSeparator.handle(n))}};function ppe(t){const e=t[0],s=t[1],i=t[2];return Math.sqrt(e*e+s*s+i*i)}function p6e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function f6e(t,e,s,i){return t[0]=e,t[1]=s,t[2]=i,t}function g6e(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t}function fpe(t,e,s){return t[0]=e[0]-s[0],t[1]=e[1]-s[1],t[2]=e[2]-s[2],t}function gpe(t,e,s){return t[0]=e[0]*s[0],t[1]=e[1]*s[1],t[2]=e[2]*s[2],t}function ype(t,e,s){return t[0]=e[0]/s[0],t[1]=e[1]/s[1],t[2]=e[2]/s[2],t}function y6e(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function _6e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function v6e(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function b6e(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function x6e(t,e,s){return t[0]=Math.min(e[0],s[0]),t[1]=Math.min(e[1],s[1]),t[2]=Math.min(e[2],s[2]),t}function w6e(t,e,s){return t[0]=Math.max(e[0],s[0]),t[1]=Math.max(e[1],s[1]),t[2]=Math.max(e[2],s[2]),t}function S6e(t,e=0,s=1){return t[0]=Math.min(Math.max(t[0],e),s),t[1]=Math.min(Math.max(t[1],e),s),t[2]=Math.min(Math.max(t[2],e),s),t}function E6e(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function _pe(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function C6e(t,e,s,i){return t[0]=e[0]+s[0]*i,t[1]=e[1]+s[1]*i,t[2]=e[2]+s[2]*i,t}function vpe(t,e){const s=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(s*s+i*i+r*r)}function bpe(t,e){const s=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return s*s+i*i+r*r}function xpe(t){const e=t[0],s=t[1],i=t[2];return e*e+s*s+i*i}function P6e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function T6e(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function GV(t,e){const s=e[0],i=e[1],r=e[2];let n=s*s+i*i+r*r;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n),t}function wpe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function I6e(t,e,s){const i=e[0],r=e[1],n=e[2],o=s[0],a=s[1],l=s[2];return t[0]=r*l-n*a,t[1]=n*o-i*l,t[2]=i*a-r*o,t}function M6e(t,e,s){const i=e[0],r=e[1],n=e[2],o=s[0],a=s[1],l=s[2],u=r*l-n*a,c=n*o-i*l,h=i*a-r*o,m=Math.sqrt(u*u+c*c+h*h);return t[0]=u/m,t[1]=c/m,t[2]=h/m,t}function A6e(t,e,s,i){const r=e[0],n=e[1],o=e[2];return t[0]=r+i*(s[0]-r),t[1]=n+i*(s[1]-n),t[2]=o+i*(s[2]-o),t}function N6e(t,e,s,i,r,n){const o=n*n,a=o*(2*n-3)+1,l=o*(n-2)+n,u=o*(n-1),c=o*(3-2*n);return t[0]=e[0]*a+s[0]*l+i[0]*u+r[0]*c,t[1]=e[1]*a+s[1]*l+i[1]*u+r[1]*c,t[2]=e[2]*a+s[2]*l+i[2]*u+r[2]*c,t}function D6e(t,e,s,i,r,n){const o=1-n,a=o*o,l=n*n,u=a*o,c=3*n*a,h=3*l*o,m=l*n;return t[0]=e[0]*u+s[0]*c+i[0]*h+r[0]*m,t[1]=e[1]*u+s[1]*c+i[1]*h+r[1]*m,t[2]=e[2]*u+s[2]*c+i[2]*h+r[2]*m,t}function $6e(t,e=1){const s=u$,i=2*s()*Math.PI,r=2*s()-1,n=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t[2]=r*e,t}function R6e(t,e,s){const i=e[0],r=e[1],n=e[2];return t[0]=s[0]*i+s[4]*r+s[8]*n+s[12],t[1]=s[1]*i+s[5]*r+s[9]*n+s[13],t[2]=s[2]*i+s[6]*r+s[10]*n+s[14],t}function k6e(t,e,s){const i=e[0],r=e[1],n=e[2];return t[0]=i*s[0]+r*s[3]+n*s[6],t[1]=i*s[1]+r*s[4]+n*s[7],t[2]=i*s[2]+r*s[5]+n*s[8],t}function F6e(t,e,s){const i=s[0],r=s[1],n=s[2],o=s[3],a=e[0],l=e[1],u=e[2],c=r*u-n*l,h=n*a-i*u,m=i*l-r*a,f=r*m-n*h,g=n*c-i*m,v=i*h-r*c,b=2*o;return t[0]=a+c*b+2*f,t[1]=l+h*b+2*g,t[2]=u+m*b+2*v,t}function O6e(t,e,s,i){const r=[],n=[];return r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],n[0]=r[0],n[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),n[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=n[0]+s[0],t[1]=n[1]+s[1],t[2]=n[2]+s[2],t}function L6e(t,e,s,i){const r=[],n=[];return r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],n[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),n[1]=r[1],n[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=n[0]+s[0],t[1]=n[1]+s[1],t[2]=n[2]+s[2],t}function V6e(t,e,s,i){const r=[],n=[];return r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],n[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),n[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),n[2]=r[2],t[0]=n[0]+s[0],t[1]=n[1]+s[1],t[2]=n[2]+s[2],t}function q6e(t,e){GV(tJ,t),GV(sJ,e);const s=wpe(tJ,sJ);return s>1?0:s<-1?Math.PI:Math.acos(s)}const tJ=dg(),sJ=dg();function G6e(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function z6e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function U6e(t,e){if(t===e)return!0;const s=t[0],i=t[1],r=t[2],n=e[0],o=e[1],a=e[2],l=_a();return Math.abs(s-n)<=l*Math.max(1,Math.abs(s),Math.abs(n))&&Math.abs(i-o)<=l*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-a)<=l*Math.max(1,Math.abs(r),Math.abs(a))}function B6e(t,e,s){const i=s[0]-e[0],r=s[1]-e[1],n=s[2]-e[2];let o=i*i+r*r+n*n;return o>0?(o=1/Math.sqrt(o),t[0]=i*o,t[1]=r*o,t[2]=n*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const j6e=fpe,H6e=gpe,Y6e=ype,X6e=vpe,W6e=bpe,Z6e=ppe,Q6e=xpe;Object.freeze(Object.defineProperty({__proto__:null,abs:v6e,add:g6e,angle:q6e,bezier:D6e,ceil:y6e,clamp:S6e,copy:p6e,cross:I6e,crossAndNormalize:M6e,direction:B6e,dist:X6e,distance:vpe,div:Y6e,divide:ype,dot:wpe,equals:U6e,exactEquals:z6e,floor:_6e,hermite:N6e,inverse:T6e,len:Z6e,length:ppe,lerp:A6e,max:w6e,min:x6e,mul:H6e,multiply:gpe,negate:P6e,normalize:GV,random:$6e,rotateX:O6e,rotateY:L6e,rotateZ:V6e,round:E6e,scale:_pe,scaleAndAdd:C6e,set:f6e,sign:b6e,sqrDist:W6e,sqrLen:Q6e,squaredDistance:bpe,squaredLength:xpe,str:G6e,sub:j6e,subtract:fpe,transformMat3:k6e,transformMat4:R6e,transformQuat:F6e},Symbol.toStringTag,{value:"Module"}));function rc(t){let e=t*t;return t<0&&(e*=-1),e}function J6e(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function K6e(t,e,s){const i=s,r=t.state,n=t.device,o=e.tiltDirection==="forward-down"?1:-1,a=1;return n.deviceType==="standard"?(i.translation[0]=rc(r.axes[0]),i.translation[1]=rc(r.axes[1]),i.translation[2]=rc(r.buttons[7])-rc(r.buttons[6]),i.heading=rc(r.axes[2]),i.tilt=rc(r.axes[3])):n.deviceType==="spacemouse"&&(i.translation[0]=1.2*rc(r.axes[0]),i.translation[1]=1.2*rc(r.axes[1]),i.translation[2]=2*-rc(r.axes[2]),i.heading=1.2*rc(r.axes[5]),i.tilt=1.2*rc(r.axes[3])),i.tilt*=o,_pe(i.translation,i.translation,a),i}function eVe(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let tVe=class extends Cn{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Kb,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",s=>this._handleGamePadEvent(s)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([Ee(()=>{var s;return(s=this._view.navigation.gamepad)==null?void 0:s.enabled},s=>{s?(this._handle.resume(),this._frameTask||(this._frameTask=fb({update:i=>this._frameUpdate(i.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},ht)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){var i;const s=this._view.navigation.gamepad.device;s&&e.data.device!==s||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,J6e(this._transformation)):(this._currentDevice=e.data.device,K6e(e.data,this._view.navigation.gamepad,this._transformation)),(i=this._frameTask)==null||i.resume())}_frameUpdate(e){var h;const s=this._transformation;if(eVe(s))return void((h=this._frameTask)==null?void 0:h.pause());const i=this._view.viewpoint.clone(),r=this._view.navigation.gamepad.velocityFactor,n=iVe*r*e;T$(i,i,[s.translation[0]*n,-s.translation[1]*n]);const o=1+s.translation[2]*rVe*e,a=this._view.constraints.rotationEnabled?-s.heading*sVe*e:0,l=this._view.size,u=[l[0]/2,l[1]];Wde(i,i,o,a,u,l);const c=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=c}};const sVe=.06,iVe=.7,rVe=6e-4;function Spe(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),xs(()=>document.removeEventListener("visibilitychange",e))}let nVe=class extends Cn{constructor(e,s,i){super(!0),this.view=e,this.keys=s,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=r=>{const n=this._keyMap[r.data.key];if(r.modifiers.has("Meta")||r.modifiers.has("Control"))return void this._stopMovement();if(n==null)return;r.stopPropagation(),r.preventDefault();const o=r.type==="key-down";if(this._pressedKeys[o?"add":"delete"](n),o){if(this._direction===n)return;this._direction=n,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const a=this._timeout===void 0,l=this._pressedKeys.size>0;a||l?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[s.left]:"left",[s.right]:"right",[s.up]:"up",[s.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=Spe(r=>r?null:this._stopMovement())}onUninstall(){var e;this._stopMovement(),(e=this._visibilityHandle)==null||e.remove()}get _direction(){return this._currentDirection}set _direction(e){const s=this._currentDirection!=null;if(e!=null){if(s||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else s&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},oVe=class extends Cn{constructor(e,s,i){super(!0),this.view=e,this.keys=s,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(s),this.registerIncoming("key-down",i,r=>this._handleKeyDown(r)),this.registerIncoming("key-up",i,r=>this._handleKeyUp(r)),this.registerIncoming("blur",i,()=>this._handleStop()),this._visibilityHandle=Spe(r=>r?null:this._handleStop())}onUninstall(){var e;(e=this._visibilityHandle)==null||e.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,s){for(const i of e)this._keyToDirection.set(i,s)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,s){const i=e.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const r=this._keyToDirection.get(e.data.key);if(this._pressed=r!=null,this._pressed){if(e.preventDefault(),s)switch(this.view.mapViewNavigation.begin(),r){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var Nv;(function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"})(Nv||(Nv={}));let aVe=class extends Cn{constructor(e,s,i){super(!0),this.view=e,this.keys=s,this._keysToZoomAction={},this.registerIncoming("key-down",i,r=>this._handleKeyDown(r)),s.zoomIn.forEach(r=>this._keysToZoomAction[r]=Nv.IN),s.zoomOut.forEach(r=>this._keysToZoomAction[r]=Nv.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const s=e.modifiers;if(s.size>0&&!s.has("Shift"))return;const{key:i}=e.data;if(!(i in this._keysToZoomAction))return;const r=this._keysToZoomAction[i],{mapViewNavigation:n}=this.view;let o=null;switch(r){case Nv.IN:o=n.zoomIn();break;case Nv.OUT:o=n.zoomOut();break;default:return}n.begin(),o.then(()=>n.end()),e.stopPropagation()}};const lVe=.6;let uVe=class extends Cn{constructor(e,s){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",s,i=>this._handleMouseWheel(i))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const s=this._view.mapViewNavigation,{x:i,y:r,deltaY:n}=e.data,o=1/lVe**(1/60*n),a=s.zoom(o,[i,r]);a&&(this._canZoom=!1,a.catch(()=>{}).then(()=>{this._canZoom=!0,s.end()}))}},cVe=class extends Cn{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",i=>this._handleDrag(i)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const s=this.view.mapViewNavigation;this._dragEventSeparator=new I$({start:(i,r)=>{s.pinch.begin(this.view,r.data),r.stopPropagation()},update:(i,r)=>{s.pinch.update(this.view,r.data),r.stopPropagation()},end:(i,r)=>{s.pinch.end(this.view),r.stopPropagation()},condition:i=>i>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function iJ(t){const e=t.native;return e?{buttons:e.buttons.map(s=>s.pressed?s.value||1:0),axes:e.axes.map(s=>dVe(s,t.axisThreshold))}:{buttons:[],axes:[]}}function hVe(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let s=0;s<t.axes.length;s++)if(t.axes[s]!==e.axes[s])return!1;for(let s=0;s<t.buttons.length;s++)if(t.buttons[s]!==e.buttons[s])return!1;return!0}function mVe(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function dVe(t,e){const s=Math.abs(t);return s<e?0:Math.sign(t)*(s-e)/(1-e)}let pVe=class{constructor(e,s){this._element=e,this._input=s,this._hasEventListeners=!1,this._onConnectGamepad=n=>{this._connectGamepad(n.gamepad)},this._onDisconnectGamepad=n=>{const o=n.gamepad,a=o.index,l=this._inputDevices[a];l&&(this._emitGamepadEvent(o,iJ(l),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,r=window.isSecureContext;this.supported=i&&r,this.supported&&(rJ(n=>this._connectGamepad(n)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const s=new Y7(e);s.deviceType!=="unknown"&&(this._inputDevices[e.index]=s,this._input.gamepad.devices.add(s)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=fb({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),s=this._element.contains(document.activeElement),i=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!s;rJ(r=>{const n=this._inputDevices[r.index];if(!n)return;const o=this._latestUpdate[r.index],a=iJ(n),l=i||mVe(a);o&&(o.timestamp===r.timestamp||!o.active&&l||hVe(o.state,a))||this._emitGamepadEvent(r,a,!l)})}_emitGamepadEvent(e,s,i){const r=this._latestUpdate[e.index],n=r&&r.active;if(!n&&!i)return;const o=!n&&i?"start":n&&i?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:s,active:i},this._callback&&this._callback({device:this._inputDevices[e.index],state:s,action:o})}};function fVe(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function rJ(t){for(const e of navigator.getGamepads())fVe(e)&&t(e)}const nJ=ge("edge"),gVe=ge("chrome"),yVe=ge("ff"),_Ve=ge("safari"),oJ="esri-view-surface",y1={touchNone:`${oJ}--touch-none`,touchPan:`${oJ}--touch-pan`};let Epe=class Cpe{constructor(e,s){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new pVe(e,s),this._gamepadSource.onEvent=i=>this._callback("gamepad",i)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=ii(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const s in this._active)if(!e||!e.has(s)){const i=this._active[s];this._element.removeEventListener(J4[s],i),delete this._active[s]}e&&e.forEach(s=>{if(!this._active[s]&&J4[s]){const i=(this._eventHandlers[s]||this._handleDefault).bind(this,s);this._element.addEventListener(J4[s],i),this._active[s]=i}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1)}setPointerCapture(e,s){s?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?y1.touchNone:y1.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?y1.touchPan:y1.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(y1.touchNone),this._element.classList.remove(y1.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,s){const i=dde(this._element,e);return Cpe.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),s.x=i.x,s.y=i.y,s}_handleKey(e,s){const{key:i}=s;i&&e==="key-up"&&this._keyDownState.delete(i);const r={native:s,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&e==="key-down"&&this._keyDownState.add(r.key),this._callback(e,r)}_handlePointer(e,s){const i=this._updateNormalizedPointerLikeEvent(s,{native:s,x:0,y:0,pointerType:s.pointerType,button:s.button,buttons:s.buttons,eventId:this._eventId++});this._callback(e,i)}_handlePointerPreventDefault(e,s){const i=this._updateNormalizedPointerLikeEvent(s,{native:s,x:0,y:0,pointerType:s.pointerType,button:s.button,buttons:s.buttons,eventId:this._eventId++});s.preventDefault(),this._callback(e,i)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&ge("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,s){let i=this._getDeltaFromTrackpadOrMouseWheel(s);switch(s.deltaMode){case 0:nJ&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}nJ?i*=.7:gVe||_Ve?i*=.6:yVe&&(i*=1.375);const r=100,n=Math.abs(i);n>r&&(i=i/n*200/(1+Math.exp(-.02*(n-r))));const o=this._updateNormalizedPointerLikeEvent(s,{native:s,x:0,y:0,deltaY:i});this._callback(e,o)}_handlePointerCaptureLost(e,s){this._activePointerCaptures.delete(s.pointerId),this._handleDefault(e,s)}_handleDefault(e,s){const i={native:s};s.preventDefault(),this._callback(e,i)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};Epe.test={disableSubpixelCoordinates:!1};const J4={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let vVe=class extends Cn{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const lo={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function _3(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function bVe(t,e){const s=e.x-t.x,i=e.y-t.y;return Math.sqrt(s*s+i*i)}function xVe(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Bn()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[T,P]=t,[I,A]=[P.x-T.x,P.y-T.y];return e.radius=Math.sqrt(I*I+A*A)/2,e.center.x=(T.x+P.x)/2,e.center.y=(T.y+P.y)/2,e}let s=0,i=0;for(let T=0;T<t.length;T++)s+=t[T].x,i+=t[T].y;s/=t.length,i/=t.length;const r=t.map(T=>T.x-s),n=t.map(T=>T.y-i);let o=0,a=0,l=0,u=0,c=0,h=0,m=0;for(let T=0;T<r.length;T++){const P=r[T],I=n[T],A=P*P,D=I*I;o+=A,a+=D,l+=P*I,u+=A*P,c+=D*I,h+=P*D,m+=I*A}const f=.5*(u+h),g=.5*(c+m),v=o*a-l*l,b=(f*a-g*l)/v,w=(o*g-l*f)/v,S=Bn(b+s,w+i);return{radius:Math.sqrt(b*b+w*w+(o+a)/t.length),center:S}}function C_(t){const{native:e}=t,{pointerId:s,button:i,pointerType:r}=e;return r==="mouse"?`${s}:${i}`:`${r}`}let wVe=class extends Cn{constructor(e=lo.maximumDoubleClickDelay,s=lo.maximumDoubleClickDistance,i=lo.maximumDoubleTouchDelay,r=lo.maximumDoubleTouchDistance,n=ex){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=s,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=r,this._clock=n,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Bn(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new I$({start:(o,a)=>this._dragStart(o,a),update:(o,a)=>this._dragUpdate(a),end:(o,a)=>this._dragEnd(a)}),this.registerIncoming("drag",o=>this._dragEventSeparator.handle(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=qi(e.doubleTapTimeout)})}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const s=this._pointerState.get(e);s&&(s.doubleTapTimeout=qi(s.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,s){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:r}=s,{center:n}=i;this._dragStartCenter=n;const o=K4("begin",Bn(0,0),i);this._doubleTapDrag.emit(o,void 0,r),s.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:s,modifiers:i}=e,{center:r}=s,n=K4("update",Bn(r.x-this._dragStartCenter.x,r.y-this._dragStartCenter.y),s);this._doubleTapDrag.emit(n,void 0,i),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:s,modifiers:i}=e,{center:r}=s,n=K4("end",Bn(r.x-this._dragStartCenter.x,r.y-this._dragStartCenter.y),s);this._doubleTapDrag.emit(n,void 0,i),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:s}=e,i=C_(s),r=this._pointerState.get(i),{pointerType:n}=s.native;if(r){const o=n==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(i),_3(r.event.data,s)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:s}=e,{pointerType:i}=s.native,r=C_(s),n=i==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(r),n);this._pointerState.set(r,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function K4(t,e,s){const{button:i,buttons:r,pointer:n,pointers:o,pointerType:a,timestamp:l}=s;return{action:t,delta:e,button:i,buttons:r,pointer:n,pointers:o,pointerType:a,timestamp:l}}let SVe=class extends Cn{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,s,i,r){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:s.buttons,timestamp:r,pointers:EVe(this._activePointerMap),pointer:s,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(e){const s=e.native.pointerId,i=xI(this._activePointerMap).angle,r={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(s,r);const n=SA(r,Ppe(this._activePointerMap));r.initialAngle=n,r.lastAngle=n,this._updatePointerAngles(i)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const s=e.native.pointerId,i=this._activePointerMap.get(s);i?i.event=e:this._addPointer(e)}_removePointer(e){const s=xI(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(s)}_updatePointerAngles(e){const s=xI(this._activePointerMap);this._activePointerMap.forEach(i=>{i.initialAngle=SA(i,s)-e,i.lastAngle=SA(i,s)-e})}_emitEvent(e,s,i){const r=xI(this._activePointerMap);this._drag.emit(this._createPayload(e,s,r,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const s=e.data.native.pointerId,i=e.timestamp;this._activePointerMap.get(s)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(s)):(this._removePointer(s),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const s=e.data,i=s.currentEvent,r=e.timestamp;switch(s.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,r)):(this._addPointer(i),this._emitEvent("added",i,r),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,r))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function Ppe(t){const e=[];return t.forEach(s=>{e.push(Bn(s.event.x,s.event.y))}),xVe(e)}function xI(t){const e=Ppe(t);let s=0;return t.forEach(i=>{let r=SA(i,e),n=r-i.lastAngle;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;r=i.lastAngle+n,i.lastAngle=r;const o=r-i.initialAngle;s+=o}),s/=t.size||1,{angle:s,radius:e.radius,center:e.center}}function EVe(t){const e=new Map;return t.forEach((s,i)=>e.set(i,s.event)),e}function SA(t,e){const s=t.event,i=s.x-e.center.x,r=s.y-e.center.y;return Math.atan2(r,i)}var aJ;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(aJ||(aJ={}));let CVe=class extends Cn{constructor(e=lo.maximumDoubleClickDelay,s=lo.maximumDoubleClickDistance,i=lo.maximumDoubleTouchDelay,r=lo.maximumDoubleTouchDistance,n=ex){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=s,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=r,this._clock=n,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const s=e.data,i=C_(s);if(!this._pointerState.has(i)){const r={downButton:s.native.button,x:s.x,y:s.y,immediateDoubleClick:null};this._pointerState.set(i,r),this.startCapturingPointer(s.native)}}_handlePointerUp(e){const s=e.data,i=C_(s),r=this._pointerState.get(i);if(r&&r.downButton===s.native.button){const n=r.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;n?(n.timeoutHandle.remove(),_3(n,e.data)>o?this._startImmediateDoubleClick(e,r):(this._immediateDoubleClick.emit(e.data,void 0,n.modifiers),this._removeState(s))):_3(r,e.data)>o?this._removeState(s):this._startImmediateDoubleClick(e,r)}}_startImmediateDoubleClick(e,s){const i=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;s.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),i)}}_removeState(e){const s=C_(e);this._pointerState.delete(s),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},PVe=class extends Cn{constructor(e=lo.maximumClickDelay,s=lo.movementUntilMouseDrag,i=lo.movementUntilPenDrag,r=lo.movementUntilTouchDrag,n=lo.holdDelay,o=ex){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=s,this._movementUntilPenDrag=i,this._movementUntilTouchDrag=r,this._holdDelay=n,this._clock=o,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",a=>this._handlePointerDown(a)),this.registerIncoming("pointer-up",a=>this._handlePointerLoss(a,"pointer-up")),this.registerIncoming("pointer-capture-lost",a=>this._handlePointerLoss(a,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",a=>this._handlePointerLoss(a,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",a=>this._handlePointerMove(a)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=qi(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const s=e.data,i=s.native.pointerId;let r=null;this._pointerState.size===0&&(r=this._clock.setTimeout(()=>{const o=this._pointerState.get(i);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._holdDelay));const n={startEvent:s,previousEvent:s,startTimestamp:e.timestamp,isDragging:!1,downButton:s.native.button,holdTimeout:r,modifiers:new Set};this._pointerState.set(i,n),this.startCapturingPointer(s.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const s=e.data,i=s.native.pointerId,r=this._pointerState.get(i);r&&(r.isDragging?this._pointerDrag.emit(wI("update",r,s),void 0,r.modifiers):bVe(s,r.startEvent)>this._getDragThreshold(s.native.pointerType)&&this._startDragging(e),r.previousEvent=s)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const s=e.data,i=s.native.pointerId;this._pointerState.forEach(r=>{r.holdTimeout!=null&&(r.holdTimeout.remove(),r.holdTimeout=null),r.isDragging||(r.modifiers=e.modifiers,r.isDragging=!0,i===r.startEvent.native.pointerId?this._pointerDrag.emit(wI("start",r,s)):this._pointerDrag.emit(wI("start",r,r.previousEvent),e.timestamp))})}_handlePointerLoss(e,s){const i=e.data,r=i.native.pointerId,n=this._pointerState.get(r);n&&(n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging?this._pointerDrag.emit(wI("end",n,s==="pointer-up"?i:n.previousEvent),void 0,n.modifiers):s==="pointer-up"&&n.downButton===i.native.button&&e.timestamp-n.startTimestamp<=this._maximumClickDelay&&!n.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(r),this.stopCapturingPointer(i.native),this._pointerState.size===0&&this._moveHandle.pause())}};function wI(t,e,s){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:s}}let TVe=class extends Cn{constructor(e=lo.maximumDoubleClickDelay,s=lo.maximumDoubleClickDistance,i=lo.maximumDoubleTouchDelay,r=lo.maximumDoubleTouchDistance,n=ex){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=s,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=r,this._clock=n,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",o=>this._handleImmediateClick(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=qi(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,s){const i=this._pointerState.get(e);i&&(i.doubleClickTimer=qi(i.doubleClickTimer),s&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const s=this._pointerState.get(e);s.pointerDownCount===1&&this._click.emit(s.event.data,void 0,s.event.modifiers),s.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const s=e.data,{pointerType:i}=s.native,r=IVe(s);if(!this._pointerState.has(r))return void this._startClick(e);const n=this._pointerState.get(r),{data:o,modifiers:a}=n.event,l=i==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;_3(o,s)>l?(this._clearDoubleClickTimer(r,!0),this._startClick(e)):(this._clearDoubleClickTimer(r,!1),n.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(e){const s=C_(e.data),i=this._pointerState.get(s);i&&(i.pointerDownCount+=1)}_startClick(e){const{data:s}=e,{native:{pointerType:i}}=s,r=C_(s),n=i==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(r),n);this._pointerState.set(r,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function IVe(t){const{pointerId:e,pointerType:s,button:i}=t.native;return s==="mouse"?`${e}:${i}`:`${s}`}const SI={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},lJ=Symbol("handles");let Ty=class extends Ye{initialize(){const e=()=>{var s;return(s=this.view)==null?void 0:s.ready};this.addHandles([Or(()=>!e(),()=>this._disconnect()),Or(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}isModifierKeyDown(e){var s;return((s=this._inputManager)==null?void 0:s.isModifierKeyDown(e))??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(lJ),this._inputManager=ii(this._inputManager)}_connect(){const e=this.view.surface,s=new Epe(e,this.view.input),i=[new CVe,new PVe,new TVe,new SVe(this.view.navigation),new wVe],r=new pu({eventSource:s,recognizers:i}),n=new m6e(this.view,["primary"]),o=new d6e(this.view,["secondary"]);r.installHandlers("prevent-context-menu",[new vVe],Gf.INTERNAL),r.installHandlers("navigation",[new cVe(this.view),new tVe(this.view),new uVe(this.view),new eJ(this.view),new eJ(this.view,[SI.counter]),n,new nVe(this.view,SI.pan),new aVe(this.view,SI.zoom),new oVe(this.view,SI.rotate),o,new h6e(this.view,"touch")],Gf.INTERNAL),this.view.viewEvents.connect(r),this._source=s,this._inputManager=r,this.addHandles([Ee(()=>{var a,l;return(l=(a=this.view)==null?void 0:a.navigation)==null?void 0:l.browserTouchPanEnabled},a=>{this._source&&(this._source.browserTouchPanningEnabled=!a)},ht),Ee(()=>{const{actionMap:a}=this.view.navigation;return{panActions:KQ("pan",a),rotateActions:KQ("rotate",a)}},({panActions:a,rotateActions:l})=>{n.pointerActions=a,o.pointerActions=l},Ga)],lJ)}get test(){}};p([_()],Ty.prototype,"view",void 0),p([_()],Ty.prototype,"latestPointerType",null),p([_()],Ty.prototype,"latestPointerLocation",null),p([_()],Ty.prototype,"multiTouchActive",null),Ty=p([Q("esri.views.2d.input.MapViewInputManager")],Ty);const MVe=Ty,uJ=160;let rS=class extends Ye{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=uJ&&this.clear()},uJ))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};p([_()],rS.prototype,"_timer",void 0),p([_()],rS.prototype,"stationary",null),rS=p([Q("esri.views.2d.support.StationaryManager")],rS);const AVe=t=>{let e=class extends t{constructor(...s){super(...s),this.fullOpacity=1,this.stateManager=new Po({constraints:new JQ({view:this})}),this.goToManager=new wA({view:this}),this.stationaryManager=new rS,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new o6e(this),this.inputManager=new MVe({view:this}),this.viewEvents=new mde(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([Ee(()=>this.viewpoint,()=>this.stationaryManager.flip(),Xc),this.on("resize",i=>this.stateManager.resize(i.width,i.height))])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){var s;return((s=this.stateManager)==null?void 0:s.extent)??null}set extent(s){this.stateManager.extent=s}get state(){return this.stateManager.state}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}set animation(s){const i=this._get("animation");if(s===i)return;if(i&&i.stop(),s!==this.animationManager.animation&&this.animationManager.stop(),!s||s.isFulfilled())return void this._set("animation",null);this._set("animation",s);const r=()=>{var n;this.destroyed||s===this._get("animation")&&(this._set("animation",null),(n=this.frameTask)==null||n.requestFrame())};s.when(r,r)}get constraints(){var s;return(s=this.stateManager)==null?void 0:s.constraints}set constraints(s){s.view=this;const i=this.stateManager.constraints;this.stateManager.constraints=s,i==null||i.destroy()}get padding(){var s;return(s=this.stateManager)==null?void 0:s.padding}set padding(s){this.stateManager&&(this.stateManager.padding=s)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(s){this.stateManager.resizeAlign=s}get rotation(){return this.stateManager.rotation??0}set rotation(s){const{rotationEnabled:i}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=s,this.constraints.rotationEnabled=i}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(s){this.stateManager.viewpoint=s,this.frameTask.requestFrame()}on(s,i,r,n){return this.inputManager&&this.viewEvents.on(s,i,r,n)||super.on(s,i)}hasEventListener(s){return super.hasEventListener(s)||this.viewEvents.hasHandler(s)}goTo(s,i){return this.goToManager.goTo(s,i)}};return p([_({readOnly:!0})],e.prototype,"animationManager",void 0),p([_({readOnly:!0})],e.prototype,"fullOpacity",void 0),p([_()],e.prototype,"stateManager",void 0),p([_()],e.prototype,"constraintsInfo",null),p([_()],e.prototype,"extent",null),p([_()],e.prototype,"goToManager",void 0),p([_({readOnly:!0})],e.prototype,"state",null),p([_({readOnly:!0})],e.prototype,"mapViewNavigation",void 0),p([_()],e.prototype,"renderingOptions",void 0),p([_({readOnly:!0})],e.prototype,"interacting",null),p([_()],e.prototype,"stationary",null),p([_()],e.prototype,"animation",null),p([_({type:JQ})],e.prototype,"constraints",null),p([_({readOnly:!0})],e.prototype,"inputManager",void 0),p([_()],e.prototype,"padding",null),p([_()],e.prototype,"resizeAlign",null),p([_()],e.prototype,"rotation",null),p([_({readOnly:!0})],e.prototype,"viewEvents",void 0),p([_({type:Lu})],e.prototype,"viewpoint",null),e=p([Q("esri.views.Viewport2DMixin")],e),e};let cJ=class{constructor(e){this._view=e,this.viewpoint=new Lu({targetGeometry:new Et,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,s]=this._view.size;return Math.sqrt(e*e+s*s)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return Yde(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,s){s.pan=Ale(this.center,e.center);let i=Math.abs(e.rotation-this.rotation);i=i>=180?360-i:i,s.rotate=FD(i),s.sourceZoom=this.scale,s.targetZoom=e.scale}interpolate(e,s,i){const{pan:r,rotate:n,zoom:o,zoomOffset:a}=i,{center:l}=this;l.spatialReference=e.center.spatialReference,l.x=y2(e.center.x,s.center.x,r),l.y=y2(e.center.y,s.center.y,r),this.viewpoint.scale=y2(e.scale,s.scale+a,o);let u=e.rotation;const c=s.rotation;Math.abs(c-u)>=180&&(u+=360*(u<c?1:-1)),this.viewpoint.rotation=y2(u,c,n)}copyFrom(e){Fo(this.viewpoint,e.viewpoint),this._view=e.view}};function Yw(t,e,s,i){const r=3*t,n=3*(s-t)-r,o=1-r-n,a=3*e,l=3*(i-e)-a,u=1-a-l;function c(g){return((o*g+n)*g+r)*g}function h(g){return((u*g+l)*g+a)*g}function m(g){return(3*o*g+2*n)*g+r}function f(g,v){let b,w,S,T,P,I;for(S=g,I=0;I<8;I++){if(T=c(S)-g,Math.abs(T)<v)return S;if(P=m(S),Math.abs(P)<1e-6)break;S-=T/P}if(b=0,w=1,S=g,S<b)return b;if(S>w)return w;for(;b<w;){if(T=c(S),Math.abs(T-g)<v)return S;g>T?b=S:w=S,S=.5*(w-b)+b}return S}return function(g,v=1e-6){return h(f(g,v))}}const Mu={};Mu.ease=Yw(.25,.1,.25,1),Mu.linear=Yw(0,0,1,1),Mu.easeIn=Mu["ease-in"]=Yw(.42,0,1,1),Mu.easeOut=Mu["ease-out"]=Yw(0,0,.58,1),Mu.easeInOut=Mu["ease-in-out"]=Yw(.42,0,.58,1);const NVe=t=>t,M$=t=>t*t,oU=t=>1-M$(1-t),DVe=t=>t<.5?M$(2*t)/2:(oU(2*(t-.5))+1)/2,aU=t=>t*t*t,Tpe=t=>1-aU(1-t),$Ve=t=>t<.5?aU(2*t)/2:(Tpe(2*(t-.5))+1)/2,lU=t=>t*t*t*t,Ipe=t=>1-lU(1-t),RVe=t=>t<.5?lU(2*t)/2:(Ipe(2*(t-.5))+1)/2,uU=t=>t*t*t*t*t,Mpe=t=>1-uU(1-t),kVe=t=>t<.5?uU(2*t)/2:(Mpe(2*(t-.5))+1)/2,cU=t=>1-Math.cos(t*Math.PI/2),Ape=t=>1-cU(1-t),FVe=t=>t<.5?cU(2*t)/2:(Ape(2*(t-.5))+1)/2,hU=t=>2**(10*(t-1)),mU=t=>1-hU(1-t),OVe=t=>t<.5?hU(2*t)/2:(mU(2*(t-.5))+1)/2,dU=t=>-(Math.sqrt(1-t*t)-1),Npe=t=>1-dU(1-t),LVe=t=>t<.5?dU(2*t)/2:(Npe(2*(t-.5))+1)/2;function Bu(t){const e=2*(t-Math.sqrt((t-1)*t)),s=e/2/t;return i=>i<s?t*i*i:e*i-e+1}function ju(t,e){return(s,i)=>s<e?e*t(s/e,i):1-t((1-s)/(1-e),i)*(1-e)}const VVe=ju(Bu(1),1),qVe=ju(Bu(1),0),zV=ju(Bu(1),.5),GVe=ju(Bu(2),1),zVe=ju(Bu(2),0),UVe=ju(Bu(2),.5),BVe=ju(Bu(3),1),jVe=ju(Bu(3),0),HVe=ju(Bu(3),.5),YVe=ju(Bu(4),1),XVe=ju(Bu(4),0),WVe=ju(Bu(4),.5),hJ={linear:NVe,"in-quad":M$,"out-quad":oU,"in-out-quad":DVe,"in-coast-quad":VVe,"out-coast-quad":qVe,"in-out-coast-quad":zV,"in-cubic":aU,"out-cubic":Tpe,"in-out-cubic":$Ve,"in-coast-cubic":GVe,"out-coast-cubic":zVe,"in-out-coast-cubic":UVe,"in-quart":lU,"out-quart":Ipe,"in-out-quart":RVe,"in-coast-quart":BVe,"out-coast-quart":jVe,"in-out-coast-quart":HVe,"in-quint":uU,"out-quint":Mpe,"in-out-quint":kVe,"in-coast-quint":YVe,"out-coast-quint":XVe,"in-out-coast-quint":WVe,"in-sine":cU,"out-sine":Ape,"in-out-sine":FVe,"in-expo":hU,"out-expo":mU,"in-out-expo":OVe,"in-circ":dU,"out-circ":Npe,"in-out-circ":LVe,ease:t=>Mu.ease(t),"ease-in":t=>Mu.easeIn(t),"ease-out":t=>Mu.easeOut(t),"ease-in-out":t=>Mu.easeInOut(t)};let ZVe=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const v3={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},Dpe={maxDuration:4e3};let QVe=class $pe{constructor(e){this._createCamera=e,this.compared=new ZVe,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:v3.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new $pe(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,s,i){this.source!==e&&this.source.copyFrom(e),this.target!==s&&this.target.copyFrom(s),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=i.desiredScreenFlow??v3.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const s=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/s}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>_a()}get hasFov(){return Math.abs(this.compared.fov)>_a()}get hasRotate(){return this.compared.rotate>_a()}},JVe=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},KVe=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,s)=>e+s.time,0)}interpolateComponentsAt(e,s){e=Math.min(Math.max(e,0),1),e*=this.time;let i=0,r=0;const n=this.definition,o=this.segments.reduce((a,l)=>a||l.definition.hasZoom,!1);for(let a=0;a<this.segments.length;a++){const l=this.segments[a],u=l.definition;if(e<=l.time||a===this.segments.length-1){if(this.segmentInterpolateComponentsAt(l,l.time===0?0:e/l.time,s),n.hasPan&&!isNaN(s.pan)&&isFinite(n.compared.pan)?s.pan=(i+u.compared.pan*s.pan)/n.compared.pan:s.pan=1,n.hasRotate&&!isNaN(s.rotate)&&isFinite(n.compared.rotate)?s.rotate=(r+u.compared.rotate*s.rotate)/n.compared.rotate:s.rotate=1,o&&!isNaN(s.zoom)&&isFinite(u.compared.targetZoom)){const{sourceZoom:c,targetZoom:h}=u.compared,m=s.zoom*(h-c)+c,f=this.segments[0].definition.compared.sourceZoom,g=this.segments[this.segments.length-1].definition.compared.targetZoom,v=Math.abs(h-f)>Math.abs(c-f)?h:c;s.zoomOffset=v-g,s.zoom=(m-f)/(v-f)}else s.zoom=1;return s}e-=l.time,i+=u.compared.pan,r+=u.compared.rotate}}segmentInterpolateComponentsAt(e,s,i){e.interpolateComponentsAt(s,i)}},eO=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,s=e.compared,i=s.sourceZoom,r=s.targetZoom;this._zoomSign=i>r?1:-1,this._panPixelsAtSource=s.pan*e.source.pixelsPerPanAtZoom(i);const n=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=s.rotate*n}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,s=this.definition.compared.targetZoom,{hasZoom:i,hasPan:r,hasRotate:n}=this.definition;let o=0,a=0;i&&(r&&(o=(s/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),n&&(a=this._zoomSign*(Math.log(e/s)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(i&&r&&n){const u=o+a+o*a;this._zoomPixelFlow=o*a/u*l,this._panPixelFlow=a/u*l,this._rotatePixelFlow=o/u*l}else if(i&&r){const u=1+o;this._zoomPixelFlow=o/u*l,this._panPixelFlow=1/u*l}else if(i&&n){const u=1+a;this._zoomPixelFlow=a/u*l,this._rotatePixelFlow=1/u*l}else if(r&&n){const u=this._panPixelsAtSource/this._rotatePixels,c=1+u;this._panPixelFlow=u/c*l,this._rotatePixelFlow=1/c*l}else r?this._panPixelFlow=l:i?this._zoomPixelFlow=l:n&&(this._rotatePixelFlow=l);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const u=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=u,this._panPixelFlow/=u,this._rotatePixelFlow/=u}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/eqe:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,s=e*this._panPixelsAtSource;return Math.log(s*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const s=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom;return(s*(s/i)**-e-s)/(i-s)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:s,segmentEnd:i}=this.definition;return s+e*(i-s)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const s=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(s*e*this._time)-1))/(s*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,s){e=Math.min(Math.max(e,0),1),s.zoom=this._interpolateComponentsZoom(e),s.pan=this._interpolateComponentsPan(e),s.rotate=this._interpolateComponentsRotate(e),s.zoomOffset=0,s.fov=this._interpolateComponentsFov(e)}};const eqe=FD(45);function tqe(t,e,s){const i=e-t.compared.sourceZoom,r=t.halfWindowPanAtZoom(i);return-t.halfWindowSize*(s.ascensionFactor*Math.LN2*t.compared.pan+r)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*r)}function sqe(t,e,s){const i=1/e,r=Math.log(t.compared.sourceZoom*i),n=1/t.desiredPixelFlow,o=1/Math.LN2,a=e-t.compared.sourceZoom,l=1/a,u=(s.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(a))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*n*o*l*u-t.halfWindowSize*r*n*o*l+t.halfWindowSize*r*n*o*u/(a*a)}function iqe(t,e,s){const i=e-t.compared.sourceZoom,r=1/i,n=1/e,o=Math.log(t.compared.sourceZoom*n),a=(s.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(i))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*r*(-2*r*n*a+2*r*o+2*n-2*o*a/(i*i)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function rqe(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function nqe(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function oqe(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function aqe(t,e,s){return-t.compared.pan*t.halfWindowSize*(s.ascensionFactor+s.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function lqe(t,e,s){return t.compared.pan*t.halfWindowSize*(s.ascensionFactor+s.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function uqe(t,e,s){return-2*t.compared.pan*t.halfWindowSize*(s.ascensionFactor+s.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function cqe(t,e,s){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-s.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function hqe(t,e,s){const i=Math.log(e/t.compared.targetZoom),r=1/t.desiredPixelFlow,n=1/Math.LN2,o=-e+t.compared.targetZoom,a=1/o,l=(-t.halfWindowPanAtZoom(e)-s.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*i*r*n*a+t.halfWindowSize*i*r*n*l/(o*o)+t.halfWindowSize*r*n*a*l/e}function mqe(t,e,s){const i=e-t.compared.targetZoom,r=1/i,n=1/e,o=Math.log(e/t.compared.targetZoom),a=(t.halfWindowPanAtZoom(e)+s.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*r*(-2*r*n*a-2*r*o+2*n+2*o*a/(i*i)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function dqe(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function pqe(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function fqe(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function gqe(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const s=Math.LN2*t.compared.pan,i=e,r=t.halfWindowPanAtZoom(i),n=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*r);return t.compared.sourceZoom<=t.compared.targetZoom?n*(s-r):n*(s+r)}function yqe(t,e){let s=_qe(t,e);const i={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},r=i.ascensionFactor===0,n=i.descensionFactor===0,o=r?rqe:tqe,a=r?nqe:sqe,l=r?oqe:iqe,u=n?dqe:cqe,c=n?pqe:hqe,h=n?fqe:mqe,m=P=>o(t,P,i)+aqe(t,P,i)+u(t,P,i),f=P=>a(t,P,i)+lqe(t,P,i)+c(t,P,i),g=P=>l(t,P,i)+uqe(t,P,i)+h(t,P,i);let v=m(s);const b=gqe(t);let w;const S=e.maximumIterations||20,T=e.maximumDistance!=null?e.maximumDistance:1/0;for(w=0;w<S;w++){const P=e.desiredSlope??1e-6;let I=f(s);Math.abs(I)>P&&(I+=P);const A=I/g(s);if(isNaN(A)||s>=T&&A<0){if(!isFinite(T))return null;s=T,v=m(s);break}if(s-=A,s<t.compared.sourceZoom||s<t.compared.targetZoom)return null;const D=m(s);if(Math.abs(D-v)/v<=.005)break;v=D}return v>b*(1-.3)||s<t.compared.sourceZoom||s<t.compared.targetZoom?null:s}function _qe(t,e){const s=Math.max(t.compared.sourceZoom,t.compared.targetZoom),i=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return i<s?e.maximumDistance!=null?s+(e.maximumDistance-s)/2:1.5*s:e.maximumDistance?Math.min(e.maximumDistance,i):i}let vqe=class extends KVe{constructor(e,s){super(),this._preallocSegments=[new eO,new eO,new eO],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,s)}update(e,s){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const i=s!=null&&s.apex?yqe(e,s.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,i?this._updateWithApex(i,s==null?void 0:s.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,s,i){e.interpolateComponentsAt(s,i),e===this._ascensionSegment?i.zoom=oU(i.zoom):e===this._descensionSegment&&(i.zoom=M$(i.zoom))}_updateWithApex(e,s){const[i,r,n]=this._preallocSegments,o=(s==null?void 0:s.ascensionFactor)??.5,a=Math.min(1-o,(s==null?void 0:s.ascensionFactor)!=null&&s.descensionFactor!=null?s.descensionFactor:.5),l=1-o-a;i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*o,i.definition.compared.rotate=this.definition.compared.rotate*o,i.definition.segmentEnd=o,i.update(),this._ascensionSegment=i,this.segments.push(i),l>0&&(r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.copyFrom(this.definition),r.definition.compared.sourceZoom=e,r.definition.compared.targetZoom=e,r.definition.compared.pan=this.definition.compared.pan*l,r.definition.compared.rotate=this.definition.compared.rotate*l,r.definition.segmentStart=i.definition.segmentEnd,r.definition.segmentEnd=i.definition.segmentEnd+l,r.update(),this.segments.push(r)),n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.sourceZoom=e,n.definition.compared.pan=this.definition.compared.pan*a,n.definition.compared.rotate=this.definition.compared.rotate*a,n.definition.segmentStart=o+l,n.update(),this._descensionSegment=n,this.segments.push(n)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const bqe=new JVe;let xqe=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=zV,this.definition=new QVe(e),this.path=new vqe}update(e,s,i){this.definition.update(e,s,i),this.path.update(this.definition,i),this._time=this._applyTimeSettings(bCe(isFinite(this.path.time)?this.path.time:0),i),this._easing=i.easing??(this._time>=1e3?zV:mU)}cameraAt(e,s){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const i=this.path.interpolateComponentsAt(e,bqe);s.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(e){const s=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(e,this._time)-s)/(i-s)}_applyTimeSettings(e,s){const i=s.speedFactor!=null?s.speedFactor:1,r=s.minDuration??v3.minDuration/i,n=s.maxDuration??v3.maxDuration/i;return e=s.duration!=null?s.duration:Math.min(Math.max(e/i,r),n)}};const wqe=2e3,Sqe=64;let Eqe=class{constructor(e){this._view=e,this._animation=new xqe(()=>new cJ(this._view)),this._current=new cJ(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,s,i={}){Fo(this._current.viewpoint,e),Fo(this._source.viewpoint,e),Fo(this._target.viewpoint,s),this._animation.update(this._source,this._target,i)}applyRatio(e,s){this._animation.cameraAt(s,this._current),Fo(e,this._current.viewpoint)}},J1=class extends Ye{constructor(e){super(e),this._animation=null,this._destinationViewState=new nU,this.updateFunction=null,this.easing=hJ.ease,this.viewpoint=new Lu({targetGeometry:new Et,scale:0,rotation:0}),this._updateTask=fb({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new Eqe(e.view)}destroy(){this._updateTask=qi(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,s,i){this.stop();const r=this.viewpoint;Fo(r,s);const n=e.target;this._transition.update(this.viewpoint,n,{apex:{maximumDistance:Math.min(Math.min(s.scale,n.scale)*Sqe,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i==null?void 0:i.duration,maxDuration:(i==null?void 0:i.animationMode)==="auto"?1/0:(i==null?void 0:i.maxDuration)??Dpe.maxDuration,speedFactor:i==null?void 0:i.speedFactor,easing:(typeof(i==null?void 0:i.easing)=="string"?hJ[i.easing]:i==null?void 0:i.easing)||this.easing}),(i==null?void 0:i.animationMode)==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=n,Cqe(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,n,{duration:0}));const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,s){this.stop(),this.updateFunction=s,this.viewpoint=e;const i=new OV({target:e.clone()}),r=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(r,r),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){var i,r;const s=this.animation;if(s&&s.state!==OV.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),(i=this.animation)==null||i.update(this.viewpoint);else{const n=performance.now()-this._startTime,o=this._transition.duration,a=o>0?n/o:1,l=a>=1;this._transition.applyRatio(this.viewpoint,a),l&&((r=this.animation)==null||r.finish())}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function Cqe(t,e,s,i){if((e==null?void 0:e.duration)!=null)return!0;const{time:r,isLinear:n}=t,o=(e==null?void 0:e.speedFactor)||1;if(r>((e==null?void 0:e.maxDuration)??Dpe.maxDuration/o))return!1;if(n){const l=ar(),u=Bn(...i.toScreen(l,...s.center)),c=Bn(...s.toScreen(l,...i.center)),h=c!=null&&c.x>-1*s.size[0]&&c.x<(1.5+.5)*s.size[0]&&c.y>-1*s.size[1]&&c.y<(1.5+.5)*s.size[1],m=u!=null&&u.x>-1*i.size[0]&&u.x<(1.5+.5)*i.size[0]&&u.y>-1*i.size[1]&&u.y<(1.5+.5)*i.size[1];if(r>wqe/o&&!h&&!m)return!1}return!0}p([_()],J1.prototype,"easing",void 0),p([_()],J1.prototype,"view",void 0),p([_()],J1.prototype,"viewpoint",void 0),J1=p([Q("esri.views.2d.AnimationManager")],J1);const Pqe=J1;function Ti(){return Promise.all([me(()=>import("./webglDeps-DP6tZZvN.js"),__vite__mapDeps([160,133,161,162,163])),me(()=>import("./mapViewDeps-BisJeTYT.js"),__vite__mapDeps([164,66,165,64,65,67,68,69,70,62,73,166,161,133,162,137,113,63,37,167,61,90,168,169,120,119,77,16,71,79,170,74,75,76,171,4,118,160,163,172,85,173,60,14,10,19,174,126,127,111,135,175,176,78,177,178,72,179,42,82,58,180,181,182,183,129,184]))])}const Xw=()=>Ti().then(()=>me(()=>import("./TileLayerView2D-B0iJyv6Y.js"),__vite__mapDeps([185,69,63,67,64,65,66,68,70,62,171,4,169,168,167,61,37,162,133,90,120,119,77,16,118,172,166,161,137,113,165,73,71,79,85,173,60,14,10,19,74,75,76,126,127,111,179,42,82,58,186,187,183,188,189,181,182,190,191,192,193,194,195]))),Xg=()=>Ti().then(()=>me(()=>import("./FeatureLayerView2D-brHcZ5AI.js").then(t=>t.F),__vite__mapDeps([196,169,16,197,198,199,14,10,21,188,168,182,63,61,62,37,161,133,183,167,162,90,120,119,77,165,64,65,66,67,68,69,70,73,166,137,113,71,79,85,200,170,201,84,192,195,190]))),mJ={"base-dynamic":()=>Ti().then(()=>me(()=>import("./BaseDynamicLayerView2D-D86hh3RR.js"),__vite__mapDeps([202,203,167,61,62,37,162,133,90,168,169,120,119,77,16,187,166,161,137,113,73,188,204,190]))),"base-tile":Xw,"bing-maps":Xw,catalog:()=>Ti().then(()=>me(()=>import("./CatalogLayerView2D-Ccku9nNo.js"),__vite__mapDeps([205,188,168,169]))),"catalog-dynamic-group":()=>Ti().then(()=>me(()=>import("./CatalogDynamicGroupLayerView2D-D2oCaoCW.js"),__vite__mapDeps([206,188,168,169]))),"catalog-footprint":()=>Ti().then(()=>me(()=>import("./CatalogFootprintLayerView2D-BIF7ZS00.js"),__vite__mapDeps([207,196,169,16,197,198,199,14,10,21,188,168,182,63,61,62,37,161,133,183,167,162,90,120,119,77,165,64,65,66,67,68,69,70,73,166,137,113,71,79,85,200,170,201,84,192,195,190]))),csv:Xg,"geo-rss":()=>Ti().then(()=>me(()=>import("./GeoRSSLayerView2D-jtYkqMb8.js"),__vite__mapDeps([208,188,168,169,180,181,182,63,61,62,37,161,133,183,167,162,90,120,119,77,16,165,64,65,66,67,68,69,70,73,166,137,113,71,79,179,171,4,60,14,10,19,42,82,58]))),feature:Xg,geojson:Xg,parquet:Xg,graphics:()=>Ti().then(()=>me(()=>import("./GraphicsLayerView2D-DR_paYGR.js"),__vite__mapDeps([209,188,168,169,180,181,182,63,61,62,37,161,133,183,167,162,90,120,119,77,16,165,64,65,66,67,68,69,70,73,166,137,113,71,79,179,171,4,60,14,10,19,42,82,58]))),group:()=>Ti().then(()=>me(()=>import("./GroupLayerView2D-CBXlXICW.js"),__vite__mapDeps([210,188,168,169]))),imagery:()=>Ti().then(()=>me(()=>import("./ImageryLayerView2D-C-4WC9mt.js"),__vite__mapDeps([211,212,133,37,96,97,167,61,62,162,90,168,169,120,119,77,16,188,179,64,65,66,67,68,69,70,171,4,60,63,14,10,19,165,73,166,161,137,113,71,79,42,82,58,189,181,182,183,203,187,204,100,197,195,190]))),"imagery-tile":()=>Ti().then(()=>me(()=>import("./ImageryTileLayerView2D-CzG3dTyl.js"),__vite__mapDeps([213,214,212,133,37,96,97,167,61,62,162,90,168,169,120,119,77,16,188,215,177,76,161,183,216,100,197,195,190]))),kml:()=>Ti().then(()=>me(()=>import("./KMLLayerView2D-CInLNI0r.js"),__vite__mapDeps([217,218,187,168,169,166,161,133,162,137,113,73,203,167,61,62,37,90,120,119,77,16,188,180,181,182,63,183,165,64,65,66,67,68,69,70,71,79,179,171,4,60,14,10,19,42,82,58,100,177,76,174,160,163,126,127,111,173,135,215]))),"knowledge-graph":()=>Ti().then(()=>me(()=>import("./KnowledgeGraphLayerView2D-qmFSP97m.js"),__vite__mapDeps([219,188,168,169]))),"link-chart":()=>Ti().then(()=>me(()=>import("./KnowledgeGraphLayerView2D-qmFSP97m.js"),__vite__mapDeps([219,188,168,169]))),"knowledge-graph-sublayer":Xg,"map-image":()=>Ti().then(()=>me(()=>import("./MapImageLayerView2D-DYrH9NEF.js"),__vite__mapDeps([220,203,167,61,62,37,162,133,90,168,169,120,119,77,16,187,166,161,137,113,73,188,179,64,65,66,67,68,69,70,171,4,60,63,14,10,19,165,71,79,42,82,58,189,181,182,183,204,221,192,194,197,190,191,193,195]))),"map-notes":()=>Ti().then(()=>me(()=>import("./MapNotesLayerView2D-B8MoSxm4.js"),__vite__mapDeps([222,188,168,169,180,181,182,63,61,62,37,161,133,183,167,162,90,120,119,77,16,165,64,65,66,67,68,69,70,73,166,137,113,71,79,179,171,4,60,14,10,19,42,82,58]))),media:()=>Ti().then(()=>me(()=>import("./MediaLayerView2D-B43M7V53.js"),__vite__mapDeps([223,224,82,42,69,63,67,64,65,66,68,70,62,171,4,169,168,167,61,37,162,133,90,120,119,77,16,118,172,166,161,137,113,165,73,71,79,85,173,60,14,10,19,74,75,76,126,127,111,179,58,176,78,225,178,188]))),"ogc-feature":()=>Ti().then(()=>me(()=>import("./OGCFeatureLayerView2D-Rnip2xVR.js"),__vite__mapDeps([226,196,169,16,197,198,199,14,10,21,188,168,182,63,61,62,37,161,133,183,167,162,90,120,119,77,165,64,65,66,67,68,69,70,73,166,137,113,71,79,85,200,170,201,84,192,195,190]))),"open-street-map":Xw,"oriented-imagery":Xg,route:()=>Ti().then(()=>me(()=>import("./RouteLayerView2D-DwKqrt_G.js"),__vite__mapDeps([227,228,229,188,168,169,180,181,182,63,61,62,37,161,133,183,167,162,90,120,119,77,16,165,64,65,66,67,68,69,70,73,166,137,113,71,79,179,171,4,60,14,10,19,42,82,58]))),stream:()=>Ti().then(()=>me(()=>import("./StreamLayerView2D-D-yww_MT.js"),__vite__mapDeps([230,196,169,16,197,198,199,14,10,21,188,168,182,63,61,62,37,161,133,183,167,162,90,120,119,77,165,64,65,66,67,68,69,70,73,166,137,113,71,79,85,200,170,201,84,192,195,190]))),"subtype-group":()=>Ti().then(()=>me(()=>import("./SubtypeGroupLayerView2D-CSIxhtdg.js"),__vite__mapDeps([231,196,169,16,197,198,199,14,10,21,188,168,182,63,61,62,37,161,133,183,167,162,90,120,119,77,165,64,65,66,67,68,69,70,73,166,137,113,71,79,85,200,170,201,84,192,195,190]))),tile:Xw,"vector-tile":()=>Ti().then(()=>me(()=>import("./VectorTileLayerView2D-D7vahApT.js"),__vite__mapDeps([232,118,70,68,69,67,133,119,167,61,62,37,162,90,168,169,120,77,16,183,24,121,122,188,190]))),video:()=>Ti().then(()=>me(()=>import("./VideoLayerView2D-CUhtdX6P.js"),__vite__mapDeps([233,234,225,90,167,61,62,37,162,133,168,169,120,119,77,16,165,64,65,66,67,68,69,70,73,166,161,137,113,63,71,79,178,188,180,181,182,183,179,171,4,60,14,10,19,42,82,58]))),wcs:()=>Ti().then(()=>me(()=>import("./ImageryTileLayerView2D-CzG3dTyl.js"),__vite__mapDeps([213,214,212,133,37,96,97,167,61,62,162,90,168,169,120,119,77,16,188,215,177,76,161,183,216,100,197,195,190]))),"web-tile":Xw,wfs:Xg,wms:()=>Ti().then(()=>me(()=>import("./WMSLayerView2D-DqGlUAD5.js"),__vite__mapDeps([235,203,167,61,62,37,162,133,90,168,169,120,119,77,16,187,166,161,137,113,73,188,204,190,236,197]))),wmts:()=>Ti().then(()=>me(()=>import("./WMTSLayerView2D-CdGGSbvS.js"),__vite__mapDeps([237,186,187,168,169,166,161,133,162,137,113,73,167,61,62,37,90,120,119,77,16,183,188,190]))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};function Tqe(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",s=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new ae(`${s}:view-not-supported`,`${e} is not supported in 2D`)}const dJ={hasLayerViewModule:t=>mJ[t.type]!=null,importLayerView:t=>{const e=mJ[t.type];if(e==null)throw Tqe(t);return e(t)}};let sg=class Iy{static getId(e,s,i,r){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${s}/${i}/${r}`}constructor(e,s,i,r){this.set(e,s,i,r)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,s=4095&this.col,i=63&this.level;return(3&this.world)<<30|s<<22|e<<8|i}acquire(e,s,i,r){this.set(e,s,i,r)}contains(e){const s=e.level-this.level;return s>=0&&this.row===e.row>>s&&this.col===e.col>>s&&this.world===e.world}containsChild(e){const s=e.level-this.level;return s>0&&this.row===e.row>>s&&this.col===e.col>>s&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new Iy(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,s,i,r){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[n,o,a,l]=e.split("/");this.level=parseFloat(n),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+e,this.row=+s,this.col=+i,this.world=+r||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Iy(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,s,i){const r=this.clone();return r.col+=e,r.row+=s,i.normalizeKey(r),r}getChildKeys(){const e=this.level+1,s=this.row<<1,i=this.col<<1,r=this.world;return[new Iy(e,s,i,r),new Iy(e,s,i+1,r),new Iy(e,s+1,i,r),new Iy(e,s+1,i+1,r)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}};sg.pool=new mg(sg,null,null,25,50);function _1(t,e){return[t,e]}function Wg(t,e,s){return t[0]=e,t[1]=s,t}function Iqe(t,e,s,i,r){return t[0]=e,t[1]=s,t[2]=i,t[3]=r,t}const nc=new sg("0/0/0/0");let Mqe=class Rpe{static create(e,s,i=null){const r=ya(e.spatialReference),n=s.origin||_1(e.origin.x,e.origin.y),o=_1(e.size[0]*s.resolution,e.size[1]*s.resolution),a=_1(-1/0,-1/0),l=_1(1/0,1/0),u=_1(1/0,1/0);i!=null&&(Wg(a,Math.max(0,Math.floor((i.xmin-n[0])/o[0])),Math.max(0,Math.floor((n[1]-i.ymax)/o[1]))),Wg(l,Math.max(0,Math.floor((i.xmax-n[0])/o[0])),Math.max(0,Math.floor((n[1]-i.ymin)/o[1]))),Wg(u,l[0]-a[0]+1,l[1]-a[1]+1));const{cols:c,rows:h}=s;let m,f,g,v;return!i&&c&&h&&(Wg(a,c[0],h[0]),Wg(l,c[1],h[1]),Wg(u,c[1]-c[0]+1,h[1]-h[0]+1)),e.isWrappable?(m=_1(Math.ceil(Math.round((r.valid[1]-r.valid[0])/s.resolution)/e.size[0]),u[1]),f=!0,g=r.origin,v=r.valid):(m=u,f=!1),new Rpe(s.level,s.resolution,s.scale,n,a,l,u,o,m,f,g,v)}constructor(e,s,i,r,n,o,a,l,u,c,h,m){this.level=e,this.resolution=s,this.scale=i,this.origin=r,this.first=n,this.last=o,this.size=a,this.norm=l,this.worldSize=u,this.wrap=c,this._spatialReferenceOrigin=h,this._spatialReferenceValid=m}normalizeCol(e){if(!this.wrap)return e;const s=this.worldSize[0];return e<0?s-1-Math.abs((e+1)%s):e%s}normalizeKey(e){if(!this.wrap)return;const s=this.worldSize[0],i=e.col;i<0?(e.col=i+s,e.world-=1):i>=s&&(e.col=i-s,e.world+=1)}denormalizeCol(e,s){return this.wrap?this.worldSize[0]*s+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const s=this.origin[0]+e*this.norm[0],i=this._spatialReferenceOrigin,r=this._spatialReferenceValid;return this.wrap&&i&&r?s===i[0]?r[0]:this.origin[0]===i[0]&&e===this.worldSize[0]?r[1]:s:s}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,s,i=!1){nc.set(s);const r=i?nc.col:this.denormalizeCol(nc.col,nc.world),n=nc.row;return Iqe(e,this.getXForColumn(r),this.getYForRow(n+1),this.getXForColumn(r+1),this.getYForRow(n)),e}getTileCoords(e,s,i=!1){nc.set(s);const r=i?nc.col:this.denormalizeCol(nc.col,nc.world);return Array.isArray(e)?Wg(e,this.getXForColumn(r),this.getYForRow(nc.row)):(e.x=this.getXForColumn(r),e.y=this.getYForRow(nc.row)),e}},qE=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:s,colFrom:i,colTo:r}of this.spans)for(let n=i;n<=r;n++){const o=e.getWorldForColumn(n);yield new sg(e.level,s,e.normalizeCol(n),o)}}forEach(e,s){const{spans:i,lodInfo:r}=this,{level:n}=r;if(i.length!==0)for(const{row:o,colFrom:a,colTo:l}of i)for(let u=a;u<=l;u++)e.call(s,n,o,r.normalizeCol(u),r.getWorldForColumn(u))}};qE.pool=new mg(qE);let tO=class{constructor(e,s,i){this.row=e,this.colFrom=s,this.colTo=i}};const Ni=new sg("0/0/0/0");let Aqe=class kpe{static create(e,s){e[1]>s[1]&&([e,s]=[s,e]);const[i,r]=e,[n,o]=s,a=n-i,l=o-r,u=l!==0?a/l:0,c=(Math.ceil(r)-r)*u,h=(Math.floor(r)-r)*u;return new kpe(i,Math.floor(r),Math.ceil(o),u,a<0?c:h,a<0?h:c,a<0?n:i,a<0?i:n)}constructor(e,s,i,r,n,o,a,l){this.x=e,this.ymin=s,this.ymax=i,this.invM=r,this.leftAdjust=n,this.rightAdjust=o,this.leftBound=a,this.rightBound=l}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const gl=[[0,0],[0,0],[0,0],[0,0]],Nqe=1e-6;let Dqe=class{constructor(e,s=null,i=e.lods[0].level,r=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=s,this.scales=[],this._infoByScale={},this._infoByLevel={};const n=e.lods.filter(a=>a.level>=i&&a.level<=r);this.minScale=n[0].scale,this.maxScale=n[n.length-1].scale;const o=this._lodInfos=n.map(a=>Mqe.create(e,a,s));n.forEach((a,l)=>{this._infoByLevel[a.level]=o[l],this._infoByScale[a.scale]=o[l],this.scales[l]=a.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,s,i=!1){Ni.set(s);const r=this._infoByLevel[Ni.level];return r?r.getTileBounds(e,Ni,i):e}getTileCoords(e,s,i=!1){Ni.set(s);const r=this._infoByLevel[Ni.level];return r?r.getTileCoords(e,Ni,i):e}getTileCoverage(e,s=192,i=!0,r="closest"){if(!i&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const n=r==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=qE.pool.acquire(n),a=this._wrap;let l,u,c,h=1/0,m=-1/0;const f=o.spans;gl[0][0]=gl[0][1]=gl[1][1]=gl[3][0]=-s,gl[1][0]=gl[2][0]=e.size[0]+s,gl[2][1]=gl[3][1]=e.size[1]+s;for(const w of gl)e.toMap(w,w),w[0]=n.getColumnForX(w[0]),w[1]=n.getRowForY(w[1]);const g=[];let v=3;for(let w=0;w<4;w++){if(gl[w][1]===gl[v][1]){v=w;continue}const S=Aqe.create(gl[w],gl[v]);h=Math.min(S.ymin,h),m=Math.max(S.ymax,m),g[S.ymin]===void 0&&(g[S.ymin]=[]),g[S.ymin].push(S),v=w}if(h==null||m==null||m-h>100)return null;let b=[];for(l=h;l<m;){g[l]!=null&&(b=b.concat(g[l])),u=1/0,c=-1/0;for(let w=b.length-1;w>=0;w--){const S=b[w];u=Math.min(u,S.getLeftCol()),c=Math.max(c,S.getRightCol())}if(u=Math.floor(u),c=Math.floor(c),l>=n.first[1]&&l<=n.last[1])if(a)if(n.size[0]<n.worldSize[0]){const w=Math.floor(c/n.worldSize[0]);for(let S=Math.floor(u/n.worldSize[0]);S<=w;S++)f.push(new tO(l,Math.max(n.getFirstColumnForWorld(S),u),Math.min(n.getLastColumnForWorld(S),c)))}else f.push(new tO(l,u,c));else u>n.last[0]||c<n.first[0]||(u=Math.max(u,n.first[0]),c=Math.min(c,n.last[0]),f.push(new tO(l,u,c)));l+=1;for(let w=b.length-1;w>=0;w--){const S=b[w];S.ymax>=l?S.incrRow():b.splice(w,1)}}return o}getTileParentId(e){Ni.set(e);const s=this._infoByLevel[Ni.level],i=this._lodInfos.indexOf(s)-1;return i<0?null:(this._getTileIdAtLOD(Ni,this._lodInfos[i],Ni),Ni.id)}getTileResolution(e){const s=this._infoByLevel[typeof e=="object"?e.level:e];return s?s.resolution:-1}getTileScale(e){const s=this._infoByLevel[e.level];return s?s.scale:-1}intersects(e,s){Ni.set(s);const i=this._infoByLevel[Ni.level],r=e.lodInfo;if(r.resolution>i.resolution){this._getTileIdAtLOD(Ni,r,Ni);const o=r.denormalizeCol(Ni.col,Ni.world);for(const a of e.spans)if(a.row===Ni.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(r.resolution<i.resolution){const[o,a,l,u]=e.spans.reduce((v,b)=>(v[0]=Math.min(v[0],b.row),v[1]=Math.max(v[1],b.row),v[2]=Math.min(v[2],b.colFrom),v[3]=Math.max(v[3],b.colTo),v),[1/0,-1/0,1/0,-1/0]),c=i.denormalizeCol(Ni.col,Ni.world),h=r.getColumnForX(i.getXForColumn(c)),m=r.getRowForY(i.getYForRow(Ni.row)),f=r.getColumnForX(i.getXForColumn(c+1))-1,g=r.getRowForY(i.getYForRow(Ni.row+1))-1;return!(h>u||f<l||m>a||g<o)}const n=r.denormalizeCol(Ni.col,Ni.world);return e.spans.some(o=>o.row===Ni.row&&o.colFrom<=n&&o.colTo>=n)}normalizeBounds(e,s,i){if(e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],this._wrap){const r=ya(this.tileInfo.spatialReference),n=-i*(r.valid[1]-r.valid[0]);e[0]+=n,e[2]+=n}return e}getSmallestInfoForScale(e){const s=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>s[0])return this._infoByScale[s[0]];for(let i=1;i<s.length-1;i++)if(e>s[i]+Nqe)return this._infoByScale[s[i-1]];return this._infoByScale[s[s.length-1]]}getClosestInfoForScale(e){const s=this.scales;return this._infoByScale[e]||(e=s.reduce((i,r)=>Math.abs(r-e)<Math.abs(i-e)?r:i,s[0])),this._infoByScale[e]}scaleToLevel(e){const s=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let i=s.length-1;i>=0;i--)if(e<s[i])return i===s.length-1?this._infoByScale[s[s.length-1]].level:this._infoByScale[s[i]].level+(s[i]-e)/(s[i]-s[i+1]);return this._infoByScale[s[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,s,i){const r=this._infoByLevel[i.level];return e.set(i),s.resolution<r.resolution?null:(s.resolution===r.resolution||(e.level=s.level,e.col=Math.floor(i.col*r.resolution/s.resolution+.01),e.row=Math.floor(i.row*r.resolution/s.resolution+.01)),e)}},$qe=class{constructor(e,s){this.item=e,this.controller=s,this.promise=null}},Rqe=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new E_,this._controllers=new E_,this._processingItems=new E_,this._pausedSignal=Ib(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new XN(e.peeker),this.process=e.process;const s=e.scheduler;e.priority&&s&&(this._task=s.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=qi(this._schedule),this._task=qi(this._task)}get updating(){var e;return!!((e=this._task)!=null&&e.updating)||this.running}get length(){return this._processingItems.size+this._queue.length}abort(e){const s=this._controllers.get(e);s&&s.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(s=>e.push(s)),this._controllers.clear(),e.forEach(s=>s.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((s,i)=>e(i))}get(e){const s=this._deferreds.get(e);return s?s.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,s){const i=this.get(e);if(i)return i;const r=new AbortController;let n=null;s&&(n=Ou(s,()=>r.abort()));const o=()=>{const c=this._processingItems.get(e);c&&c.controller.abort(),a(),u.reject(xi())},a=()=>{l.remove(),n!=null&&n.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},l=yz(r.signal,o),u=Xl();return this._deferreds.set(e,u),this._controllers.set(e,r),u.promise.then(a,a),this._queue.push(e),this._scheduleNext(),u.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){var s;const e=this._queue.popLast();return e&&((s=this._deferreds.get(e))==null||s.reject(xi()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const s of e)this._queue.push(s.item),s.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=OC(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,s){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(s))}_processError(e,s){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(s))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let s;const i=new AbortController,r=new $qe(e,i);this._processingItems.set(e,r);try{s=this.process(e,i.signal)}catch(n){this._processError(r,n)}sm(s)?(r.promise=s,s.then(n=>this._processResult(r,n),n=>this._processError(r,n))):this._processResult(r,s)}get test(){}};const pJ=[0,0];let Um=class extends Ye{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:s,scheduler:i,priority:r}=this;this._queue=new Rqe({concurrency:e,scheduler:i,priority:r,process:(n,o)=>{const a=this._keyToItem.get(n);return s(a,{signal:o})},peeker:n=>this._peek(n)})}destroy(){this.clear(),this._queue=ii(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const s=typeof e=="string"?e:e.id;this._queue.abort(s)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const s=e.key.id;if(this._queue.has(s))return this._queue.get(s);const i=this._queue.push(s),r=this.tileInfoView.getTileScale(e.key),n=Zb(this._tilesByScale,r,()=>new Set),o=()=>{n.delete(e.key),n.size===0&&this._tilesByScale.delete(r),this._keyToItem.delete(s)};return n.add(e.key),this._keyToItem.set(s,e),i.then(o,o),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const s=new Set;for(const o of e)s.add(this._keyToItem.get(o).key);const i=this.state.scale;let r,n=Number.POSITIVE_INFINITY;for(const[o,a]of this._tilesByScale)if(gae(a,l=>s.has(l))){const l=Math.abs(o-i);l<n&&(r=a,n=l)}return this._getClosestTileKey(r,e).id}_getClosestTileKey(e,s){const i=this.tileInfoView,r=this.state.center;let n,o=Number.POSITIVE_INFINITY;for(const a of e)if(s.has(a.id)){i.getTileCoords(pJ,a);const l=S$(pJ,r);l<o&&(o=l,n=a)}return n}};p([_({constructOnly:!0})],Um.prototype,"concurrency",void 0),p([_({constructOnly:!0})],Um.prototype,"priority",void 0),p([_({constructOnly:!0})],Um.prototype,"process",void 0),p([_({constructOnly:!0})],Um.prototype,"scheduler",void 0),p([_()],Um.prototype,"state",void 0),p([_({constructOnly:!0})],Um.prototype,"tileInfoView",void 0),Um=p([Q("esri.views.2d.tiling.TileQueue")],Um);const Wft=Um;let kqe=class{constructor(e,s,i){this.maxSize=e,this._tileInfoView=s,this._removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const s=this._tilePerId.get(e);if(!s)return;const i=s.key.level,r=this._tileKeysPerLevel[i];fJ(this._tilePerId,e);for(let n=0;n<r.length;n++)if(r[n].id===e){r.splice(n,1);break}return s.visible=!0,s}add(e){e.visible=!1;const s=e.key,i=s.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,e);const r=s.level;this._tileKeysPerLevel[r]||(this._tileKeysPerLevel[r]=[]),this._tileKeysPerLevel[r].push(s)}prune(e,s,i){let r=this._tilePerId.size;if(r<=this.maxSize)return;let n=this._tileKeysPerLevel.length-1;for(;r>this.maxSize&&n>=0;)n!==e&&(r=this._pruneAroundCenterTile(r,s,i,n)),n--;r>this.maxSize&&(r=this._pruneAroundCenterTile(r,s,i,e))}_pruneAroundCenterTile(e,s,i,r){const n=this._tileKeysPerLevel[r];if(!n||n.length===0)return e;const{size:o,origin:a}=this._tileInfoView.tileInfo,l=i*o[0],u=i*o[1],c=[0,0],h=[0,0];for(n.sort((m,f)=>(c[0]=a.x+l*(m.col+.5),c[1]=a.y-u*(m.row+.5),h[0]=a.x+l*(f.col+.5),h[1]=a.y-u*(f.row+.5),p3(c,s)-p3(h,s)));n.length>0;){const m=n.pop();if(this._removeTile(m.id),--e===this.maxSize)break}return e}_removeTile(e){const s=this._tilePerId.get(e);this._removedFunc&&s&&this._removedFunc(s),fJ(this._tilePerId,e)}};function fJ(t,e){t.delete(e)}const Zg=new sg(0,0,0,0),Cm=new Map,Ww=[],sO=[];let Qft=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new kqe(e.cacheSize,this.tileInfoView,s=>{this.releaseTile(s)}))}destroy(){this.tileIndex.clear()}update(e){var w,S;const{resampling:s,tileIndex:i}=this,{scale:r,center:n,resolution:o}=e.state,{minScale:a,maxScale:l}=this.tileInfoView,u=!e.stationary&&r>this._previousScale;if(this._previousScale=r,!s&&(r>a||r<l))return this.tiles.length=0,void this.clear();const c=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!c)return this.tiles.length=0,void this.clear();const{spans:h,lodInfo:m}=c,{level:f}=m;this.tiles.length=0,i.forEach(T=>T.visible=!0);let g=0,v=0;if(h.length>0)for(const{row:T,colFrom:P,colTo:I}of h)for(let A=P;A<=I;A++){g++;const D=Zg.set(f,T,m.normalizeCol(A),m.getWorldForColumn(A)).id;let k=i.get(D);if(k)k.isReady?(Cm.set(D,k),v++):u||this._addParentTile(D,Cm);else{if((w=this._tileCache)!=null&&w.has(D)){if(k=this._tileCache.pop(D),this.tileIndex.set(D,k),k.isReady){Cm.set(D,k),v++;continue}}else k=this.acquireTile(Zg),this.tileIndex.set(D,k);u||this._addParentTile(D,Cm)}}const b=v===g;for(const[T,P]of i){if(Cm.has(T))continue;Zg.set(T);const I=this.tileInfoView.intersects(c,Zg),A=this.cachePolicy==="purge"?Zg.level!==f:Zg.level>f;!I||!u&&b?!A&&I||Ww.push(P):P.isReady?A&&this.cachePolicy==="purge"&&this._hasReadyAncestor(Zg,f)?Ww.push(P):sO.push(P):A&&Ww.push(P)}for(const T of sO)T.isReady&&Cm.set(T.key.id,T);for(const T of Ww)this._tileCache?this._tileCache.add(T):this.releaseTile(T),i.delete(T.key.id);for(const T of Cm.values())this.tiles.push(T);for(const T of i.values())Cm.has(T.key.id)||(T.visible=!1);(S=this._tileCache)==null||S.prune(f,n,o),qE.pool.release(c),sO.length=0,Ww.length=0,Cm.clear()}clear(){const{tileIndex:e}=this;for(const s of e.values())this.releaseTile(s);e.clear()}refresh(e){var s;for(const i of this.tileIndex.values())e(i);(s=this._tileCache)==null||s.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,s){var n;let i=e,r=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(r=this.tileIndex.get(i),r==null?void 0:r.isReady){s.has(r.key.id)||s.set(r.key.id,r);break}}else if((n=this._tileCache)!=null&&n.has(i)&&(r=this._tileCache.pop(i),this.tileIndex.set(i,r),r==null?void 0:r.isReady)){s.has(r.key.id)||s.set(r.key.id,r);break}}_hasReadyAncestor(e,s){const i=pa();this.tileInfoView.getTileBounds(i,e,!0);for(const r of this.tileIndex.values())if(r.isReady&&r.key.level>=s&&r.key.level<e.level){const n=pa();if(this.tileInfoView.getTileBounds(n,r.key,!0),DIe(n,i))return!0}return!1}};function Fqe(t,e,s,i,r){Fpe(t,e,s||0,i||t.length-1,r||Oqe)}function Fpe(t,e,s,i,r){for(;i>s;){if(i-s>600){var n=i-s+1,o=e-s+1,a=Math.log(n),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(n-l)/n)*(o-n/2<0?-1:1);Fpe(t,e,Math.max(s,Math.floor(e-o*l/n+u)),Math.min(i,Math.floor(e+(n-o)*l/n+u)),r)}var c=t[e],h=s,m=i;for(Zw(t,s,e),r(t[i],c)>0&&Zw(t,s,i);h<m;){for(Zw(t,h,m),h++,m--;r(t[h],c)<0;)h++;for(;r(t[m],c)>0;)m--}r(t[s],c)===0?Zw(t,s,m):Zw(t,++m,i),m<=e&&(s=m+1),e<=m&&(i=m-1)}}function Zw(t,e,s){var i=t[e];t[e]=t[s],t[s]=i}function Oqe(t,e){return t<e?-1:t>e?1:0}function b3(t,e){if(!(this instanceof b3))return new b3(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function Lqe(t,e,s){if(!s)return e.indexOf(t);for(var i=0;i<e.length;i++)if(s(t,e[i]))return i;return-1}function v1(t,e){nS(t,0,t.children.length,e,t)}function nS(t,e,s,i,r){r||(r=K1(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var n,o=e;o<s;o++)n=t.children[o],oS(r,t.leaf?i(n):n);return r}function oS(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function gJ(t,e){return t.minX-e.minX}function yJ(t,e){return t.minY-e.minY}function iO(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function EI(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Vqe(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function qqe(t,e){var s=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),n=Math.min(t.maxY,e.maxY);return Math.max(0,r-s)*Math.max(0,n-i)}function rO(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function CI(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function K1(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _J(t,e,s,i,r){for(var n,o=[e,s];o.length;)(s=o.pop())-(e=o.pop())<=i||(n=e+Math.ceil((s-e)/i/2)*i,Fqe(t,n,e,s,r),o.push(e,n,n,s))}b3.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,s=[],i=this.toBBox;if(!CI(t,e))return s;for(var r,n,o,a,l=[];e;){for(r=0,n=e.children.length;r<n;r++)o=e.children[r],CI(t,a=e.leaf?i(o):o)&&(e.leaf?s.push(o):rO(t,a)?this._all(o,s):l.push(o));e=l.pop()}return s},collides:function(t){var e=this.data,s=this.toBBox;if(!CI(t,e))return!1;for(var i,r,n,o,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(n=e.children[i],CI(t,o=e.leaf?s(n):n)){if(e.leaf||rO(t,o))return!0;a.push(n)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,s=t.length;e<s;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=K1([]),this},remove:function(t,e){if(t==null)return this;for(var s,i,r,n,o=this.data,a=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),i=l[l.length-1],s=u.pop(),n=!0),o.leaf&&(r=Lqe(t,o.children,e))!==-1)return o.children.splice(r,1),l.push(o),this._condense(l),this;n||o.leaf||!rO(o,a)?i?(s++,o=i.children[s],n=!1):o=null:(l.push(o),u.push(s),s=0,i=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:gJ,compareMinY:yJ,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var s=[];t;)t.leaf?e.push.apply(e,t.children):s.push.apply(s,t.children),t=s.pop();return e},_build:function(t,e,s,i){var r,n=s-e+1,o=this._maxEntries;if(n<=o)return v1(r=K1(t.slice(e,s+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(n)/Math.log(o)),o=Math.ceil(n/Math.pow(o,i-1))),(r=K1([])).leaf=!1,r.height=i;var a,l,u,c,h=Math.ceil(n/o),m=h*Math.ceil(Math.sqrt(o));for(_J(t,e,s,m,this.compareMinX),a=e;a<=s;a+=m)for(_J(t,a,u=Math.min(a+m-1,s),h,this.compareMinY),l=a;l<=u;l+=h)c=Math.min(l+h-1,u),r.children.push(this._build(t,l,c,i-1));return v1(r,this.toBBox),r},_chooseSubtree:function(t,e,s,i){for(var r,n,o,a,l,u,c,h;i.push(e),!e.leaf&&i.length-1!==s;){for(c=h=1/0,r=0,n=e.children.length;r<n;r++)l=iO(o=e.children[r]),(u=Vqe(t,o)-l)<h?(h=u,c=l<c?l:c,a=o):u===h&&l<c&&(c=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,s){var i=this.toBBox,r=s?t:i(t),n=[],o=this._chooseSubtree(r,this.data,e,n);for(o.children.push(t),oS(o,r);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(r,n,e)},_split:function(t,e){var s=t[e],i=s.children.length,r=this._minEntries;this._chooseSplitAxis(s,r,i);var n=this._chooseSplitIndex(s,r,i),o=K1(s.children.splice(n,s.children.length-n));o.height=s.height,o.leaf=s.leaf,v1(s,this.toBBox),v1(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(s,o)},_splitRoot:function(t,e){this.data=K1([t,e]),this.data.height=t.height+1,this.data.leaf=!1,v1(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,s){var i,r,n,o,a,l,u,c;for(l=u=1/0,i=e;i<=s-e;i++)o=qqe(r=nS(t,0,i,this.toBBox),n=nS(t,i,s,this.toBBox)),a=iO(r)+iO(n),o<l?(l=o,c=i,u=a<u?a:u):o===l&&a<u&&(u=a,c=i);return c},_chooseSplitAxis:function(t,e,s){var i=t.leaf?this.compareMinX:gJ,r=t.leaf?this.compareMinY:yJ;this._allDistMargin(t,e,s,i)<this._allDistMargin(t,e,s,r)&&t.children.sort(i)},_allDistMargin:function(t,e,s,i){t.children.sort(i);var r,n,o=this.toBBox,a=nS(t,0,e,o),l=nS(t,s-e,s,o),u=EI(a)+EI(l);for(r=e;r<s-e;r++)n=t.children[r],oS(a,t.leaf?o(n):n),u+=EI(a);for(r=s-e-1;r>=e;r--)n=t.children[r],oS(l,t.leaf?o(n):n),u+=EI(l);return u},_adjustParentBBoxes:function(t,e,s){for(var i=s;i>=0;i--)oS(e[i],t)},_condense:function(t){for(var e,s=t.length-1;s>=0;s--)t[s].children.length===0?s>0?(e=t[s-1].children).splice(e.indexOf(t[s]),1):this.clear():v1(t[s],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};function Gqe(t,{timeZone:e,timeExtent:s}){return{$view:{scale:t,timeZone:e,timeProperties:{currentStart:s==null?void 0:s.start,currentEnd:s==null?void 0:s.end}}}}let vJ=class Ope{constructor(e,s){this.key=new sg(0,0,0,0),this.bounds=pa(),this.objectIds=new Set,this.key.set(s);const i=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.level=i.level,this.scale=i.scale,this.minScale=e.zoomToScale(i.level-1),this.maxScale=e.zoomToScale(i.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return AIe(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return Gqe(this.scale,e)}createChildTiles(){const e=this.key.getChildKeys(),s=da.acquire();for(let i=0;i<e.length;i++)s[i]=new Ope(this.tileInfoView,e[i]);return s}getQuantizationParameters(){return ade.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const Qg={added:[],removed:[]},nO=new Set,zqe=new sg(0,0,0,0);function Uqe(t,e){const s=ya(e);if(!s)return null;const[i,r]=s.valid;return t[2]>r?[pa([t[0],t[1],r,t[3]]),pa([i,t[1],i+t[2]-r,t[3]])]:t[0]<i?[pa([i,t[1],t[2],t[3]]),pa([r-(i-t[0]),t[1],r,t[3]])]:null}let Bqe=class extends Wl{constructor(e){super(),this._tiles=new Map,this._index=b3(9,ge("esri-csp-restrictions")?s=>({minX:s.bounds[0],minY:s.bounds[1],maxX:s.bounds[2],maxY:s.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||jz(e)===0||Hz(e)===0)return[];const s=Uqe(e,this.tileScheme.spatialReference);return s!=null?[...new Set([...this.boundsIntersections(s[0]),...this.boundsIntersections(s[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const s={added:[],removed:[]};for(const i of e.added)if(!this.has(i)){const r=new vJ(this.tileScheme,i);this._tiles.set(i,r),this._index.insert(r),s.added.push(r)}for(const i of e.removed)if(this.has(i)){const r=this.get(i);this._tiles.delete(i),this._index.remove(r),s.removed.push(r)}this.tiles.length=0,this._tiles.forEach(i=>this.tiles.push(i)),(s.added.length||s.removed.length)&&this.emit("update",s)}setViewState(e){const s=this.tileScheme.getTileCoverage(e,0);if(!s)return;const{spans:i,lodInfo:r}=s,{level:n}=r;if(i.length>0)for(const{row:o,colFrom:a,colTo:l}of i)for(let u=a;u<=l;u++){const c=zqe.set(n,o,r.normalizeCol(u),r.getWorldForColumn(u)).id;if(nO.add(c),!this.has(c)){const h=new vJ(this.tileScheme,c);this._tiles.set(c,h),this._index.insert(h),this.tiles.push(h),Qg.added.push(h)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];nO.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),Qg.removed.push(a))}(Qg.added.length||Qg.removed.length)&&this.emit("update",Qg),qE.pool.release(s),nO.clear(),Qg.added.length=0,Qg.removed.length=0}};const egt=1e-30,bJ=512,PI=16777216,tgt=8,sgt=29,igt=24,rgt=4,ngt=0,ogt=0,agt=0,lgt=1,ugt=2,cgt=3,hgt=4,mgt=5,dgt=6,pgt=12,fgt=13,ggt=5,jqe=6,ygt=5,_gt=6;var xJ;(function(t){t[t.FilterFlags=0]="FilterFlags",t[t.Animation=1]="Animation",t[t.GPGPU=2]="GPGPU",t[t.VV=3]="VV",t[t.DD0=4]="DD0",t[t.DD1=5]="DD1",t[t.DD2=6]="DD2",t[t.LocalTimeOrigin=7]="LocalTimeOrigin"})(xJ||(xJ={}));const Lpe=6,Hqe=1<<Lpe,vgt=Hqe<<1,bgt=1.05,xgt=3,wgt=1,Sgt=3,Egt=3,Cgt=5,Pgt=6,Tgt=1.15,Yqe=4,Igt=128,Xqe=256,Mgt=Xqe-2*Yqe,Agt=2,Ngt=128,Dgt=1,$gt=10,Rgt=1024,kgt=128,Fgt=4,Ogt=1,Lgt=1<<20,Vgt=.75,qgt=10,Ggt=.75,zgt=256,Ugt=32,Bgt=512,jgt=0,Hgt=1,Wqe=1,Ygt=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],Xgt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Qw=256;var wJ,SJ,EJ,CJ,UV,PJ,TJ,Dh,BV,nE,gn,x3,Ru,Mi,at,GE,rd,IJ,MJ,AJ;(function(t){t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t[t.COLOR=16384]="COLOR"})(wJ||(wJ={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(SJ||(SJ={})),function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(EJ||(EJ={})),function(t){t[t.ADD=32774]="ADD",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.SUBTRACT=32778]="SUBTRACT",t[t.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(CJ||(CJ={})),function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER"}(UV||(UV={})),function(t){t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(PJ||(PJ={})),function(t){t[t.CW=2304]="CW",t[t.CCW=2305]="CCW"}(TJ||(TJ={})),function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=5131]="HALF_FLOAT"}(Dh||(Dh={})),function(t){t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS"}(BV||(BV={})),function(t){t[t.ZERO=0]="ZERO",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP"}(nE||(nE={})),function(t){t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(gn||(gn={})),function(t){t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(x3||(x3={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(Ru||(Ru={})),function(t){t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.RED=6403]="RED",t[t.RG=33319]="RG",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER"}(Mi||(Mi={})),function(t){t[t.RGBA4=32854]="RGBA4",t[t.R16F=33325]="R16F",t[t.RG16F=33327]="RG16F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.R32F=33326]="R32F",t[t.RG32F=33328]="RG32F",t[t.RGBA32F=34836]="RGBA32F",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB5_A1=32855]="RGB5_A1",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.RGB16F=34843]="RGB16F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.RGB565=36194]="RGB565",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2=32857]="RGB10_A2",t[t.RGB10_A2UI=36975]="RGB10_A2UI"}(at||(at={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.INT=5124]="INT",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(GE||(GE={})),function(t){t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(rd||(rd={})),function(t){t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_READ=35045]="STATIC_READ",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.STREAM_COPY=35042]="STREAM_COPY"}(IJ||(IJ={})),function(t){t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER"}(MJ||(MJ={})),function(t){t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(AJ||(AJ={}));const Wgt=33984;var w3,NJ,DJ;(function(t){t[t.Texture=0]="Texture",t[t.BufferObject=1]="BufferObject",t[t.VertexArrayObject=2]="VertexArrayObject",t[t.Shader=3]="Shader",t[t.Program=4]="Program",t[t.FramebufferObject=5]="FramebufferObject",t[t.Renderbuffer=6]="Renderbuffer",t[t.TransformFeedback=7]="TransformFeedback",t[t.Sync=8]="Sync",t[t.UNCOUNTED=9]="UNCOUNTED",t[t.LinesOfCode=9]="LinesOfCode",t[t.Uniform=10]="Uniform",t[t.COUNT=11]="COUNT"})(w3||(w3={})),function(t){t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(NJ||(NJ={})),function(t){t[t.NONE=0]="NONE",t[t.BACK=1029]="BACK"}(DJ||(DJ={}));const Zgt=33306;var kn,$J,RJ,kJ,FJ,OJ,LJ;(function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"})(kn||(kn={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT=5124]="INT",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}($J||($J={})),function(t){t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS"}(RJ||(RJ={})),function(t){t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED"}(kJ||(kJ={})),function(t){t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED"}(FJ||(FJ={})),function(t){t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(OJ||(OJ={})),function(t){t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(LJ||(LJ={}));const Zqe=()=>Ne.getLogger("esri.views.webgl.checkWebGLError");function Qqe(t,e){switch(e){case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const Vpe=!!ge("enable-feature:webgl-debug");function qpe(){return Vpe}function Qgt(){return Vpe}function b1(t){if(qpe()){const e=t.getError();if(e){const s=Qqe(t,e),i=new Error().stack;Zqe().error(new ae("webgl-error","WebGL error occurred",{message:s,stack:i}))}}}var jV;(function(t){t[t.Texture=0]="Texture",t[t.RenderBuffer=1]="RenderBuffer"})(jV||(jV={}));function Jqe(t){switch(t){case Dh.BYTE:case Dh.UNSIGNED_BYTE:return 1;case Dh.SHORT:case Dh.UNSIGNED_SHORT:case Dh.HALF_FLOAT:return 2;case Dh.FLOAT:case Dh.INT:case Dh.UNSIGNED_INT:return 4}}function Kqe(t){const e=t.gl;switch(e.getError()){case e.NO_ERROR:return null;case e.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case e.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case e.INVALID_OPERATION:return"The specified command is not allowed for the current state";case e.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case e.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case e.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function Jgt(t,e,s,i,r=0){var o;const n=t.gl;t.bindBuffer(s);for(const a of i){const l=e.get(a.name);if(l==null){console.warn(`There is no location for vertex attribute '${a.name}' defined.`);continue}const u=r*a.stride;if(a.count<=4)n.vertexAttribPointer(l,a.count,a.type,a.normalized,a.stride,a.offset+u),n.enableVertexAttribArray(l),a.divisor>0&&t.gl.vertexAttribDivisor(l,a.divisor);else if(a.count===9)for(let c=0;c<3;c++)n.vertexAttribPointer(l+c,3,a.type,a.normalized,a.stride,a.offset+12*c+u),n.enableVertexAttribArray(l+c),a.divisor>0&&t.gl.vertexAttribDivisor(l+c,a.divisor);else if(a.count===16)for(let c=0;c<4;c++)n.vertexAttribPointer(l+c,4,a.type,a.normalized,a.stride,a.offset+16*c+u),n.enableVertexAttribArray(l+c),a.divisor>0&&((o=t.gl)==null||o.vertexAttribDivisor(l+c,a.divisor));else console.error("Unsupported vertex attribute element count: "+a.count);if(qpe()){const c=Kqe(t),h=Jqe(a.type),m=a.offset,f=Math.round(h/m)!==h/m?`. Offset not a multiple of stride. DataType requires ${h} bytes, but descriptor has an offset of ${m}`:"";c&&console.error(`Unable to bind vertex attribute "${a.name}" with baseInstanceOffset ${u}${f}:`,c,a)}}}function Kgt(t,e,s,i){var n,o,a;const r=t.gl;t.bindBuffer(s);for(const l of i){const u=e.get(l.name);if(l.count<=4)r.disableVertexAttribArray(u),l.divisor&&l.divisor>0&&((n=t.gl)==null||n.vertexAttribDivisor(u,0));else if(l.count===9)for(let c=0;c<3;c++)r.disableVertexAttribArray(u+c),l.divisor&&l.divisor>0&&((o=t.gl)==null||o.vertexAttribDivisor(u+c,0));else if(l.count===16)for(let c=0;c<4;c++)r.disableVertexAttribArray(u+c),l.divisor&&l.divisor>0&&((a=t.gl)==null||a.vertexAttribDivisor(u+c,0));else console.error("Unsupported vertex attribute element count: "+l.count)}t.unbindBuffer(UV.ARRAY_BUFFER)}function e8e(t){switch(t){case Mi.ALPHA:case Mi.LUMINANCE:case Mi.RED:case Mi.RED_INTEGER:case at.R8:case at.R8I:case at.R8UI:case at.R8_SNORM:case rd.STENCIL_INDEX8:return 1;case Mi.LUMINANCE_ALPHA:case Mi.RG:case Mi.RG_INTEGER:case at.RGBA4:case at.R16F:case at.R16I:case at.R16UI:case at.RG8:case at.RG8I:case at.RG8UI:case at.RG8_SNORM:case at.RGB565:case at.RGB5_A1:case rd.DEPTH_COMPONENT16:return 2;case Mi.DEPTH_COMPONENT:case Mi.RGB:case Mi.RGB_INTEGER:case at.RGB8:case at.RGB8I:case at.RGB8UI:case at.RGB8_SNORM:case at.SRGB8:case rd.DEPTH_COMPONENT24:return 3;case Mi.DEPTH_STENCIL:case Mi.DEPTH24_STENCIL8:case Mi.RGBA:case Mi.RGBA_INTEGER:case at.RGBA8:case at.R32F:case at.R11F_G11F_B10F:case at.RG16F:case at.R32I:case at.R32UI:case at.RG16I:case at.RG16UI:case at.RGBA8I:case at.RGBA8UI:case at.RGBA8_SNORM:case at.SRGB8_ALPHA8:case at.RGB9_E5:case at.RGB10_A2UI:case at.RGB10_A2:case rd.DEPTH_STENCIL:case rd.DEPTH_COMPONENT32F:case rd.DEPTH24_STENCIL8:return 4;case rd.DEPTH32F_STENCIL8:return 5;case at.RGB16F:case at.RGB16I:case at.RGB16UI:return 6;case at.RG32F:case at.RG32I:case at.RG32UI:case at.RGBA16F:case at.RGBA16I:case at.RGBA16UI:return 8;case at.RGB32F:case at.RGB32I:case at.RGB32UI:return 12;case at.RGBA32F:case at.RGBA32I:case at.RGBA32UI:return 16;case kn.COMPRESSED_RGB_S3TC_DXT1_EXT:case kn.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case kn.COMPRESSED_RGBA_S3TC_DXT3_EXT:case kn.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case kn.COMPRESSED_R11_EAC:case kn.COMPRESSED_SIGNED_R11_EAC:case kn.COMPRESSED_RGB8_ETC2:case kn.COMPRESSED_SRGB8_ETC2:case kn.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case kn.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case kn.COMPRESSED_RG11_EAC:case kn.COMPRESSED_SIGNED_RG11_EAC:case kn.COMPRESSED_RGBA8_ETC2_EAC:case kn.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let Gpe=class{constructor(e=0,s=e){this.width=e,this.height=s,this.target=Ru.TEXTURE_2D,this.pixelFormat=Mi.RGBA,this.dataType=GE.UNSIGNED_BYTE,this.samplingMode=gn.LINEAR,this.wrapMode=x3.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.shouldCompress=!1,this.depth=1,this.isImmutable=!1}};function t8e(t){return t.width<=0||t.height<=0?0:Math.round(t.width*t.height*t.depth*(t.hasMipmap?4/3:1)*(t.internalFormat==null?4:e8e(t.internalFormat))*(t.target===Ru.TEXTURE_CUBE_MAP?6:1))}const s8e=()=>Ne.getLogger("esri/views/webgl/textureUtils");function TI(t){(t.width!=null&&t.width<0||t.height!=null&&t.height<0||t.depth!=null&&t.depth<0)&&s8e().error("Negative dimension parameters are not allowed!")}function i8e(t){return t in at}function r8e(t){return t in kn}function ev(t){return t!=null&&"type"in t&&t.type==="compressed"}function n8e(t){return t!=null&&"byteLength"in t}function VJ(t){return t!=null&&!ev(t)&&!n8e(t)}function x1(t){return t===Ru.TEXTURE_3D||t===Ru.TEXTURE_2D_ARRAY}function qJ(t,e,s,i=1){let r=Math.max(e,s);return t===Ru.TEXTURE_3D&&(r=Math.max(r,i)),Math.floor(Math.log2(r))+1}function II(t){if(t.internalFormat!=null)return t.internalFormat===Mi.DEPTH_STENCIL?Mi.DEPTH24_STENCIL8:t.internalFormat;switch(t.dataType){case GE.FLOAT:switch(t.pixelFormat){case Mi.RGBA:return at.RGBA32F;case Mi.RGB:return at.RGB32F;default:throw new ae("Unable to derive format")}case GE.UNSIGNED_BYTE:switch(t.pixelFormat){case Mi.RGBA:return at.RGBA8;case Mi.RGB:return at.RGB8}}return t.internalFormat=t.pixelFormat===Mi.DEPTH_STENCIL?Mi.DEPTH24_STENCIL8:t.pixelFormat}function o8e(t){let e="width"in t?t.width:t.codedWidth,s="height"in t?t.height:t.codedHeight;return t instanceof HTMLVideoElement&&(e=t.videoWidth,s=t.videoHeight),{width:e,height:s,depth:1}}let a8e=class zpe extends Gpe{constructor(e,s){switch(super(),this.context=e,Object.assign(this,s),this.internalFormat){case at.R16F:case at.R16I:case at.R16UI:case at.R32F:case at.R32I:case at.R32UI:case at.R8_SNORM:case at.R8:case at.R8I:case at.R8UI:this.pixelFormat=Mi.RED}}static validate(e,s){return new zpe(e,s)}};const Pp=()=>Ne.getLogger("esri/views/webgl/Texture");let HV=class ta{constructor(e,s=null,i=null){if(this.type=jV.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._wasImmutablyAllocated=!1,this._compressionAbortController=Ib(null),"context"in e)this._descriptor=e,i=s;else{const r=a8e.validate(e,s);if(!r)throw new ae("Texture descriptor invalid");this._descriptor=r}this._descriptor.target===Ru.TEXTURE_CUBE_MAP?this._setDataCubeMap(i):this.setData(i)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return t8e(this._descriptor)}get cachedMemory(){return this.usedMemory}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty}get isCompressing(){return this._compressionAbortController.value!==null}dispose(){this.abortCompression(),this._glName&&this._descriptor.context.instanceCounter.decrement(w3.Texture,this),this._descriptor.context.gl&&this._glName&&(this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(e,s){const i=this._descriptor;if(i.width!==e||i.height!==s){if(this._wasImmutablyAllocated)throw new ae("Immutable textures can't be resized!");i.width=e,i.height=s,this._descriptor.target===Ru.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.shouldCompress=e}setData(e){this.abortCompression(),!ev(e)&&this._descriptor.internalFormat&&this._descriptor.internalFormat in kn&&(this._descriptor.internalFormat=void 0),this._setData(e),!ev(e)&&this._descriptor.shouldCompress&&this._compressOnWorker(e)}updateData(e,s,i,r,n,o,a=0){o||Pp().error("An attempt to use uninitialized data!"),this._glName||Pp().error("An attempt to update uninitialized texture!");const l=this._descriptor;l.internalFormat=II(l);const{context:u,pixelFormat:c,dataType:h,target:m,isImmutable:f}=l;if(f&&!this._wasImmutablyAllocated)throw new ae("Cannot update immutable texture before allocation!");const g=u.bindTexture(this,ta.TEXTURE_UNIT_FOR_UPDATES,!0);(s<0||i<0||s+r>l.width||i+n>l.height)&&Pp().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:v}=u;a&&(r&&n||Pp().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),v.pixelStorei(v.UNPACK_SKIP_ROWS,a)),VJ(o)?v.texSubImage2D(m,e,s,i,r,n,c,h,o):ev(o)?v.compressedTexSubImage2D(m,e,s,i,r,n,l.internalFormat,o.levels[e]):v.texSubImage2D(m,e,s,i,r,n,c,h,o),a&&v.pixelStorei(v.UNPACK_SKIP_ROWS,0),u.bindTexture(g,ta.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,s,i,r,n,o,a,l){l||Pp().error("An attempt to use uninitialized data!"),this._glName||Pp().error("An attempt to update an uninitialized texture!");const u=this._descriptor;u.internalFormat=II(u);const{context:c,pixelFormat:h,dataType:m,isImmutable:f,target:g}=u;if(f&&!this._wasImmutablyAllocated)throw new ae("Cannot update immutable texture before allocation!");x1(g)||Pp().warn("Attempting to set 3D texture data on a non-3D texture");const v=c.bindTexture(this,ta.TEXTURE_UNIT_FOR_UPDATES);c.setActiveTexture(ta.TEXTURE_UNIT_FOR_UPDATES),(s<0||i<0||r<0||s+n>u.width||i+o>u.height||r+a>u.depth)&&Pp().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:b}=c;if(ev(l))l=l.levels[e],b.compressedTexSubImage3D(g,e,s,i,r,n,o,a,u.internalFormat,l);else{const w=l;b.texSubImage3D(g,e,s,i,r,n,o,a,h,m,w)}c.bindTexture(v,ta.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(e.width===0||e.height===0)return;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new ae("Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,TI(e)}e.samplingMode===gn.LINEAR?(this._samplingModeDirty=!0,e.samplingMode=gn.LINEAR_MIPMAP_NEAREST):e.samplingMode===gn.NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=gn.NEAREST_MIPMAP_NEAREST);const s=this._descriptor.context.bindTexture(this,ta.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(ta.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(s,ta.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new ae("Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,TI(e)}e.samplingMode===gn.LINEAR_MIPMAP_NEAREST?(this._samplingModeDirty=!0,e.samplingMode=gn.LINEAR):e.samplingMode===gn.NEAREST_MIPMAP_NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=gn.NEAREST)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,TI(this._descriptor),this._wrapModeDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1)}abortCompression(){this.isCompressing&&(this._compressionAbortController.value=Do(this._compressionAbortController.value))}_setData(e,s){var l;const i=this._descriptor,r=(l=i.context)==null?void 0:l.gl;if(!r)return;b1(r),this._glName||(this._glName=r.createTexture(),this._glName&&i.context.instanceCounter.increment(w3.Texture,this)),TI(i);const n=i.context.bindTexture(this,ta.TEXTURE_UNIT_FOR_UPDATES);i.context.setActiveTexture(ta.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),b1(r);const o=s??i.target,a=x1(o);if(VJ(e))this._setDataFromTexImageSource(e,o);else{const{width:u,height:c,depth:h}=i;if(u==null||c==null)throw new ae("Width and height must be specified!");if(a&&h==null)throw new ae("Depth must be specified!");if(i.internalFormat=II(i),i.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,i.internalFormat,i.hasMipmap,u,c,h),ev(e)){if(!r8e(i.internalFormat))throw new ae("Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(e,i.internalFormat,o)}else this._texImage(o,0,i.internalFormat,u,c,h,e),b1(r),i.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),b1(r),i.context.bindTexture(n,ta.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let s=Ru.TEXTURE_CUBE_MAP_POSITIVE_X;s<=Ru.TEXTURE_CUBE_MAP_NEGATIVE_Z;s++)this._setData(e,s)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:s,flipped:i,preMultiplyAlpha:r}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,s),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r?1:0)}_setDataFromTexImageSource(e,s){const{gl:i}=this._descriptor.context,r=this._descriptor;r.internalFormat=II(r);const n=x1(s),{width:o,height:a,depth:l}=o8e(e);r.width&&r.height,r.width||(r.width=o),r.height||(r.height=a),n&&r.depth,n&&(r.depth=l),r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(s,r.internalFormat,r.hasMipmap,o,a,l),this._texImage(s,0,r.internalFormat,o,a,l,e),b1(i),r.hasMipmap&&(this.generateMipmap(),b1(i))}_setDataFromCompressedSource(e,s,i){const r=this._descriptor,{width:n,height:o,depth:a}=r,l=e.levels,u=qJ(i,n,o,a),c=Math.min(u,l.length)-1;this._descriptor.context.gl.texParameteri(r.target,r.context.gl.TEXTURE_MAX_LEVEL,c),this._forEachMipmapLevel((h,m,f,g)=>{const v=l[Math.min(h,l.length-1)];this._compressedTexImage(i,h,s,m,f,g,v)},c)}_texStorage(e,s,i,r,n,o){const{gl:a}=this._descriptor.context;if(!i8e(s))throw new ae("Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const l=i?qJ(e,r,n,o):1;if(x1(e)){if(o==null)throw new ae("Missing depth dimension for 3D texture upload");a.texStorage3D(e,l,s,r,n,o)}else a.texStorage2D(e,l,s,r,n);this._wasImmutablyAllocated=!0}_texImage(e,s,i,r,n,o,a){const l=this._descriptor.context.gl,u=x1(e),{isImmutable:c,pixelFormat:h,dataType:m}=this._descriptor;if(c){if(a!=null){const f=a;if(u){if(o==null)throw new ae("Missing depth dimension for 3D texture upload");l.texSubImage3D(e,s,0,0,0,r,n,o,h,m,f)}else l.texSubImage2D(e,s,0,0,r,n,h,m,f)}}else{const f=a;if(u){if(o==null)throw new ae("Missing depth dimension for 3D texture upload");l.texImage3D(e,s,i,r,n,o,0,h,m,f)}else l.texImage2D(e,s,i,r,n,0,h,m,f)}}_compressedTexImage(e,s,i,r,n,o,a){const l=this._descriptor.context.gl,u=x1(e);if(this._descriptor.isImmutable){if(a!=null)if(u){if(o==null)throw new ae("Missing depth dimension for 3D texture upload");l.compressedTexSubImage3D(e,s,0,0,0,r,n,o,i,a)}else l.compressedTexSubImage2D(e,s,0,0,r,n,i,a)}else if(u){if(o==null)throw new ae("Missing depth dimension for 3D texture upload");l.compressedTexImage3D(e,s,i,r,n,o,0,a)}else l.compressedTexImage2D(e,s,i,r,n,0,a)}async _compressOnWorker(e){var r,n;if(!ta.compressionWorkerHandle||!ta.compressionWorkerHandle.isCompressible(e))return;const s=(r=this._descriptor.context)==null?void 0:r.gl.getExtension("WEBGL_compressed_texture_etc"),i=(n=this._descriptor.context)==null?void 0:n.gl.getExtension("WEBGL_compressed_texture_s3tc");if(s||i){const o=new AbortController;this._compressionAbortController.value=o;const a={data:await createImageBitmap(e),flipped:this.descriptor.flipped,width:e.width,height:e.height,hasMipmap:this._descriptor.hasMipmap,hasETC:!!s,hasS3TC:!!i};ta.compressionWorkerHandle.invoke(a,this._compressionAbortController.value.signal).then(l=>{l&&this.isCompressing&&this.glName&&(this._descriptor.internalFormat=l.internalFormat,this._setData(l.compressedTexture)),o===this._compressionAbortController.value&&(this._compressionAbortController.value=null)}).catch(l=>{Lr(l)||o!==this._compressionAbortController.value||(this._compressionAbortController.value=null)})}}_forEachMipmapLevel(e,s=1/0){let{width:i,height:r,depth:n,hasMipmap:o,target:a}=this._descriptor;const l=a===Ru.TEXTURE_3D;if(i==null||r==null||l&&n==null)throw new ae("Missing texture dimensions for mipmap calculation");for(let u=0;e(u,i,r,n),o&&(i!==1||r!==1||l&&n!==1)&&!(u>=s);++u)i=Math.max(1,i>>1),r=Math.max(1,r>>1),l&&(n=Math.max(1,n>>1))}_applySamplingMode(){var n;const e=this._descriptor,s=(n=e.context)==null?void 0:n.gl;let i=e.samplingMode,r=e.samplingMode;i===gn.LINEAR_MIPMAP_NEAREST||i===gn.LINEAR_MIPMAP_LINEAR?(i=gn.LINEAR,e.hasMipmap||(r=gn.LINEAR)):i!==gn.NEAREST_MIPMAP_NEAREST&&i!==gn.NEAREST_MIPMAP_LINEAR||(i=gn.NEAREST,e.hasMipmap||(r=gn.NEAREST)),s.texParameteri(e.target,s.TEXTURE_MAG_FILTER,i),s.texParameteri(e.target,s.TEXTURE_MIN_FILTER,r)}_applyWrapMode(){var i;const e=this._descriptor,s=(i=e.context)==null?void 0:i.gl;typeof e.wrapMode=="number"?(s.texParameteri(e.target,s.TEXTURE_WRAP_S,e.wrapMode),s.texParameteri(e.target,s.TEXTURE_WRAP_T,e.wrapMode)):(s.texParameteri(e.target,s.TEXTURE_WRAP_S,e.wrapMode.s),s.texParameteri(e.target,s.TEXTURE_WRAP_T,e.wrapMode.t))}_applyAnisotropicFilteringParameters(){const e=this._descriptor,s=e.context.capabilities.textureFilterAnisotropic;s&&e.context.gl.texParameterf(e.target,s.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}};HV.TEXTURE_UNIT_FOR_UPDATES=0,HV.compressionWorkerHandle=null;const oO=()=>Ne.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function l8e(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const u8e=[0,0,0,0];let Upe=class{constructor(){this.type="single",this._highlightOptions=new zf,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*Qw),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,s){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,jqe),s.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){var e;(e=this._shadeTex)==null||e.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<Lpe)-1,activeGradient:this}]}_updateGradientTexture(e){const s=c8e(this._highlightOptions);if(s===this._optionsShadeTexKey)return;this._optionsShadeTexKey=s,l8e(this._highlightOptions,this._convertedHighlightOptions);const i=this._convertedHighlightOptions,r=i.outlinePosition-i.outlineWidth/2-i.outerHaloWidth,n=i.outlinePosition-i.outlineWidth/2,o=i.outlinePosition+i.outlineWidth/2,a=i.outlinePosition+i.outlineWidth/2+i.innerHaloWidth,l=Math.sqrt(Math.PI/2)*Wqe,u=Math.abs(r)>l?Math.round(10*(Math.abs(r)-l))/10:0,c=Math.abs(a)>l?Math.round(10*(Math.abs(a)-l))/10:0;let h;u&&!c?oO().error("The outer rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!u&&c?oO().error("The inner rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):u&&c&&oO().error("The highlight is "+Math.max(u,c)+"px away from the edge of the feature; consider reducing some width values.");const m=[void 0,void 0,void 0,void 0];function f(v,b,w){m[0]=(1-w)*v[0]+w*b[0],m[1]=(1-w)*v[1]+w*b[1],m[2]=(1-w)*v[2]+w*b[2],m[3]=(1-w)*v[3]+w*b[3]}const{_texelData:g}=this;for(let v=0;v<Qw;++v)h=r+v/(Qw-1)*(a-r),h<r?(m[0]=0,m[1]=0,m[2]=0,m[3]=0):h<n?f(u8e,i.outlineColor,(h-r)/(n-r)):h<o?[m[0],m[1],m[2],m[3]]=i.outlineColor:h<a?f(i.outlineColor,i.fillColor,(h-o)/(a-o)):[m[0],m[1],m[2],m[3]]=i.fillColor,g[4*v]=255*m[0],g[4*v+1]=255*m[1],g[4*v+2]=255*m[2],g[4*v+3]=255*m[3];if(this._minMaxDistance[0]=r,this._minMaxDistance[1]=a,!this._shadeTex){const v=new Gpe;v.wrapMode=x3.CLAMP_TO_EDGE,v.width=Qw,v.height=1,this._shadeTex=new HV(e,v)}this._shadeTex.updateData(0,0,0,Qw,1,this._texelData)}};function c8e(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let h8e=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let s=0;s<e.length;s++)this.gradients[s]||(this.gradients[s]=new Upe),this.gradients[s].setHighlightOptions(e[s]);for(let s=e.length+1;s<this.gradients.length;s++)this.gradients[s].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const s=[];for(let i=0;i<this.gradients.length;i++){const r=this.gradients[i];s.push({activeReasons:e,activeGradient:r}),e<<=1}return s}};var GJ,zJ,UJ,BJ,jJ,HJ,S3,YJ,XJ;(function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT",t[t.LABEL=4]="LABEL"})(GJ||(GJ={})),function(t){t[t.NONE=0]="NONE",t[t.MAP=1]="MAP",t[t.LABEL=2]="LABEL",t[t.LABEL_ALPHA=4]="LABEL_ALPHA",t[t.HITTEST=8]="HITTEST",t[t.HIGHLIGHT=16]="HIGHLIGHT",t[t.CLIP=32]="CLIP",t[t.DEBUG=64]="DEBUG",t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(zJ||(zJ={})),function(t){t[t.SIZE=0]="SIZE",t[t.COLOR=1]="COLOR",t[t.OPACITY=2]="OPACITY",t[t.ROTATION=3]="ROTATION"}(UJ||(UJ={})),function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(BJ||(BJ={})),function(t){t[t.SPRITE=0]="SPRITE",t[t.GLYPH=1]="GLYPH"}(jJ||(jJ={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.SIMPLE=1]="SIMPLE",t[t.DOT_DENSITY=2]="DOT_DENSITY",t[t.OUTLINE_FILL=3]="OUTLINE_FILL",t[t.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",t[t.HEATMAP=5]="HEATMAP",t[t.PIE_CHART=6]="PIE_CHART"}(HJ||(HJ={})),function(t){t[t.All=0]="All",t[t.Highlight=1]="Highlight",t[t.InsideEffect=2]="InsideEffect",t[t.OutsideEffect=3]="OutsideEffect"}(S3||(S3={})),function(t){t[t.BATCHING=0]="BATCHING",t[t.STRICT_ORDER=1]="STRICT_ORDER",t[t.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT"}(YJ||(YJ={})),function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT"}(XJ||(XJ={}));const Bpe={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:t=>t.stencilRef,compare:BV.EQUAL,mask:255,op:{fail:nE.KEEP,zFail:nE.KEEP,zPass:nE.REPLACE}}}},m8e={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},d8e={...Bpe,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function p8e({pixelRatio:t,state:e,displayLevel:s,requiredLevel:i},r){const n=1/2**(s-r.key.level),o=1/2**(i-r.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:r.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:r.transforms.tileMat3,displayZoomFactor:n,requiredZoomFactor:o,tileOffset:[r.x,r.y],currentScale:e.scale,currentZoom:s,metersPerSRUnit:Uu(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function jpe(t){var e;return((e=t.passOptions)==null?void 0:e.type)==="highlight"}function Hpe(t){var e;return((e=t.passOptions)==null?void 0:e.type)==="hittest"}function f8e(t){if(!Hpe(t))return null;const{position:e,distance:s,smallSymbolDistance:i,smallSymbolSizeThreshold:r}=t.passOptions;return{position:e,distance:s,smallSymbolDistance:i,smallSymbolSizeThreshold:r}}function g8e(t){if(!jpe(t))return null;const{activeReasons:e,highlightAll:s}=t.passOptions;return{activeReasons:e,highlightAll:s?1:0}}function iyt(t,e,s){const i={};for(const r in s)s[r]instanceof Function?i[r]=s[r](t,e):i[r]=s[r];return i}function ryt(t,e){const{attributeView:s,context:i}=t;return{storage:s.getUniforms(i),view:p8e(t,e),hittestRequest:f8e(t),highlight:g8e(t)}}function nyt(t){return{inside:t.selection===S3.InsideEffect,outside:t.selection===S3.OutsideEffect}}function y8e(t){return Hpe(t)?m8e:jpe(t)&&t.passOptions.stepType==="clear"?d8e:Bpe}function oyt(t){const{row:e,col:s}=t.key,i=s*bJ,r=e*bJ;return{tileOffsetFromLocalOrigin:[i%PI,r%PI],maxIntsToLocalOrigin:[Math.floor(i/PI),Math.floor(r/PI)]}}const _8e=new Jt({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function ayt(t){return _8e.toJSON(t)}function lyt(t){const{bandCount:e,attributeTable:s,colormap:i,pixelType:r}=t.raster.rasterInfo;return e===1&&(s!=null||i!=null||r==="u8"||r==="s8")}function v8e(t,e){return e==null?(t==null||t.destroy(),null):((t==null?void 0:t.type)==="single"&&Array.isArray(e)&&(t.destroy(),t=null),(t==null?void 0:t.type)!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new h8e:new Upe),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function uyt(t,e,s,i){const{painter:r,highlightGradient:n}=t,{highlight:o}=r.effects;if(!n)return;const a=t.passOptions,l=n.getReasonsWithGradients();for(let u=0;u<l.length;u++){const c={...t,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:l[u].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(c),s(c),u<l.length-1){let m=0;for(let f=u+1;f<l.length;f++)m|=l[f].activeReasons;s({...t,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:m,stepType:"clear",highlightAll:e}})}const h={...t,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:l[u].activeReasons,stepType:"draw",highlightAll:e}};r.setPipelineState(y8e(t)),r.updatePipelineState(t.context),o.draw(h),o.unbind()}t.passOptions=a}function cyt(t){if(!t)return[];let e=Fke(t)?[t]:Ge.isCollection(t)?t.toArray():Array.isArray(t)?t:[];return e=e==null?void 0:e.filter(Qa),((e==null?void 0:e.length)??0)===0?[]:e}const MI=t=>parseFloat(t)/100;function b8e(t,e,s){const i=typeof t.left=="string"?MI(t.left)*e:t.left,r=typeof t.right=="string"?MI(t.right)*e:t.right,n=typeof t.top=="string"?MI(t.top)*s:t.top,o=typeof t.bottom=="string"?MI(t.bottom)*s:t.bottom,a=n;return{xmin:i,xmax:Math.max(e-r,i),ymin:a,ymax:Math.max(s-o,n)}}function Ype(t,e,s,i){switch(e.type){case"rect":{const{width:r,height:n}=t,{xmin:o,xmax:a,ymin:l,ymax:u}=b8e(e,r,n),{x:c,y:h}=s;return c>o&&c<a&&h>l&&h<u}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||Bz(e.path,[s.x,s.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?Uz(e.geometry,i):VC(e.geometry,i))}}function x8e(t){if(!t.highlights)return null;const e=t.highlights.findIndex(s=>s.name==="default");return e===-1?null:t.highlights.items[e]}function w8e(t,e){if(!t.highlights){if(!e)return;t.highlights=new Ge([new zf])}const s=t.highlights.findIndex(i=>i.name==="default");e?t.highlights.items[s].assignFrom(e):(t.highlights.removeAt(s),t.highlights.length===0&&(t.highlights=null))}async function S8e(t,e,s){const i=fde(e)?pde(t,e):e;if(!t.ready||isNaN(i.x)||isNaN(i.y))return{screenPoint:i,results:[]};let r=new Set;const n=new Set;let o=!1,a=null,l=null;s!=null&&s.include?ZJ(s.include,WJ(t,m=>{r.add(m),aO(m,f=>n.add(f))},(m,f)=>{n.add(m),r.add(f)},m=>{a||(a=new Set),a.add(m)},m=>r.add(m),()=>o=!0)):(o=!0,r=new Set(t.allLayerViews),r.forEach(m=>{aO(m,f=>n.add(f))})),s!=null&&s.exclude&&ZJ(s.exclude,WJ(t,m=>{r.delete(m),aO(m,f=>n.delete(f))},m=>n.delete(m),m=>{l||(l=new Set),l.add(m)}));const u=t.toMap(i),c=t.allLayerViews.filter(m=>!m.suspended&&r.has(m)&&m.clips.every(f=>Ype(t,f,i,u))).reverse();let h=[...o?t.graphicsView.hitTest(u).map(m=>({type:"graphic",graphic:m,layer:null,mapPoint:u})):[],...await Promise.all(c.map(m=>m.hitTest(u,i)).toArray())].filter(Qa).flat().filter(Qa);return h=h.filter(m=>{var f;return m.type!=="graphic"||((f=m.layer)==null?void 0:f.type)!=="subtype-group"||n.has(m.graphic.layer)}),a&&(h=h.filter(m=>!("graphic"in m)||!m.graphic||(a==null?void 0:a.has(YV(m.graphic))))),l&&(h=h.filter(m=>!("graphic"in m)||!m.graphic||!(l!=null&&l.has(YV(m.graphic))))),{screenPoint:i,results:h}}function WJ(t,e,s,i,r,n){return o=>{if(o instanceof tn){if(o.layer===t)n==null||n();else{const a=t.allLayerViews.find(l=>l.layer===o.layer);a&&(r==null||r(a))}i(YV(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const a=t.allLayerViews.find(l=>l.layer===o.parent);a&&s(o,a)}else{const a=t.allLayerViews.find(l=>l.layer===o);a&&e(a)}}}function ZJ(t,e){if(t)if(PN(t))for(const s of t)if(PN(s))for(const i of s)e(i);else e(s);else e(t)}function YV(t){var s,i;const e=t.getObjectId();return e?`${((s=t.layer)==null?void 0:s.uid)??((i=t.sourceLayer)==null?void 0:i.uid)??"MapView"}/${e}`:`"MapView/${t.uid}`}function aO({layer:t},e){(t==null?void 0:t.type)==="subtype-group"&&t.sublayers.forEach(s=>{e(s)})}let Jw=null,E3=!0;function E8e(t,e,s){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(E3)try{return new ImageData(t,e)}catch{E3=!1}return Xpe(t,e,s)}function hyt(t,e,s,i){if(!e||!s)throw new Error("Cannot construct image data without dimensions");if(E3)try{return new ImageData(t,e,s)}catch{E3=!1}const r=Xpe(e,s,i);return r.data.set(t,0),r}function C8e(){return Jw||(Jw=document.createElement("canvas"),Jw.width=1,Jw.height=1),Jw}function Xpe(t,e,s){return s||(s=C8e()),s.getContext("2d").createImageData(t,e)}async function P8e(t,e){const s=window.URL.createObjectURL(t);try{const{data:i}=await js(s,{...e,responseType:"image"});return i}catch(i){throw Lr(i)?i:new ae("invalid-image",`Could not fetch requested image at ${s}`)}finally{window.URL.revokeObjectURL(s)}}async function myt(t,e){const{arrayBuffer:s,mediaType:i}=await T8e(t,e),r=i==="image/png";if(i==="image/gif"){const{isAnimatedGIF:n,parseGif:o}=await me(()=>import("./gif-C3GGwSDH.js"),[]);if(n(s))return o(s,e)}if(r){const{isAnimatedPNG:n,parseApng:o}=await me(()=>import("./apng-DM2UfQ7c.js"),__vite__mapDeps([238,1]));if(n(s))return o(s,e)}return P8e(new Blob([s],{type:i}),e)}async function T8e(t,e){var r;const s=yb(t);if(s!=null&&s.isBase64)return{arrayBuffer:Vae(s.data),mediaType:s.mediaType};const i=await js(t,{responseType:"array-buffer",...e});return{arrayBuffer:i.data,mediaType:((r=i.getHeader)==null?void 0:r.call(i,"Content-Type"))??""}}function Wpe(t,e,s){const{ctx:i,canvas:r}=Qpe(t,s),n=i.getImageData(0,0,t.width,t.height),o=Kpe(r,e);return Jpe(r),{dataUrl:o,data:n}}function Zpe(t,e){const{ctx:s,canvas:i}=Qpe(t,e),r=s.getImageData(0,0,t.width,t.height);return Jpe(i),r}function Qpe(t,e){const s=I8e();e.premultipliedAlpha&&D8e(t),s.width=t.width,s.height=t.height;const i=s.getContext("2d",{willReadFrequently:!0});return i.putImageData(t,0,0),e.flipY&&N8e(i),{ctx:i,canvas:s}}function Jpe(t){t.width=0,t.height=0}function I8e(){return lO==null&&(lO=document.createElement("canvas")),lO}let lO=null;function Kpe(t,e){const s=$8e[e.format],i=e.quality/100;return t.toDataURL(s,i)}function efe(t,e){const s=A8e(t),i=k8e[s];return{format:s,quality:Ka(e??i,0,100)}}function tfe(t,e){return e/Math.max(t[0],t[1])}function M8e(t,e,s,i=0,r=0,n=t.width-i,o=t.height-r,a=!1){const{data:l}=t,{width:u,height:c,data:h}=e,m=n/u,f=o/c,g=Math.ceil(m/2),v=Math.ceil(f/2),b=t.width;for(let w=0;w<c;w++)for(let S=0;S<u;S++){const T=4*(S+(a?c-w-1:w)*u);let P=0,I=0,A=0,D=0,k=0,R=0;const O=(w+.5)*f;for(let z=Math.floor(w*f);z<(w+1)*f;z++){const q=Math.abs(O-(z+.5))/v,U=(S+.5)*m,V=q*q;for(let B=Math.floor(S*m);B<(S+1)*m;B++){const H=Math.abs(U-(B+.5))/g,W=Math.sqrt(V+H*H);if(W>=1)continue;let ie=2*W*W*W-3*W*W+1;const se=4*(i+B+(r+z)*b);R+=ie*l[se+3],I+=ie,!s&&l[se+3]<255&&(ie=ie*l[se+3]/255),A+=ie*l[se],D+=ie*l[se+1],k+=ie*l[se+2],P+=ie}}h[T]=A/P,h[T+1]=D/P,h[T+2]=k/P,h[T+3]=R/I}return e}function A8e(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return R8e}}function N8e(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function D8e(t){const e=t.data,s=e.length;for(let i=0;i<s;i+=4){const r=e[i+3];if(r!==255&&r>0){const n=255/r;e[i]=e[i]*n,e[i+1]=e[i+1]*n,e[i+2]=e[i+2]*n}}}const $8e={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},QJ=98,R8e="png",k8e={png:100,jpg:QJ,jpeg:QJ},dyt=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:E8e,encode:Wpe,encodeData:Zpe,getFormatAndQuality:efe,getMaximumResolutionScale:tfe,resampleHermite:M8e,toDataUrl:Kpe},Symbol.toStringTag,{value:"Module"})),sfe={flipY:!0,premultipliedAlpha:!0};async function F8e(t,e){const s=await ife(t,e),{format:i,quality:r}=efe(e==null?void 0:e.format,e==null?void 0:e.quality);return Wpe(s,{format:i,quality:r},sfe)}async function O8e(t,e){const s=await ife(t,e);return Zpe(s,sfe)}function ife(t,e){const s=q8e(e||{},V8e(t.stage,t.size),t.size,t.padding),i=L8e(e,t.allLayerViews);return t.stage.takeScreenshot(s,i,t.backgroundColor,e==null?void 0:e.rotation)}function L8e(t={},e){if(!t.layers)return;const s=[];return t.layers.forEach(i=>{const r=e.find(n=>n.layer.id===i.id);r!=null&&r.container&&s.push(r.container)}),s}function V8e(t,e){return Math.min(4,tfe(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function q8e(t,e,s,i){t.ignorePadding&&(i={left:0,right:0,top:0,bottom:0});let r=null;t.width!=null&&t.height!=null?r=[t.width,t.height]:t.width==null&&t.height!=null?r=[t.height,t.height]:t.width!=null&&t.height==null?r=[t.width,t.width]:t.width==null&&t.height==null&&(r=null);const n=s[0]-(i.left+i.right),o=s[1]-(i.top+i.bottom);let a,l,u=t.area||{x:0,y:0,width:n,height:o};if(r){const c=n/o,h=r[0]/r[1];if(h>c){const m=u.width/h;u={x:u.x,y:Math.round(u.y+(u.height-m)/2),width:u.width,height:Math.round(m)}}else{const m=u.height*h;u={x:Math.round(u.x+(u.width-m)/2),y:u.y,width:Math.round(m),height:u.height}}}else r=[u.width,u.height];return r[0]>u.width?(a=Math.min(r[0]/u.width,e),l=r[0]/u.width/a):(a=1,l=r[0]/u.width),{cropArea:{x:Math.round((u.x+i.left)*a),y:Math.round((u.y+i.top)*a),width:Math.round(u.width*a),height:Math.round(u.height*a)},outputScale:l,resolutionScale:a}}const G8e=t=>t.includes("Brush");let rfe=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),G8e(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function z8e(t,e){const s=e.debugRendererInfo&&t.getExtension("WEBGL_debug_renderer_info");return s?{getUnmaskedRendererWebGL:()=>t.getParameter(s.UNMASKED_RENDERER_WEBGL)}:null}let JJ;function U8e(){return JJ??(JJ=H8e()),JJ}let B8e=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}};function j8e(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let s=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(s==null&&(s=e.getContext("webgl2"),s!=null&&(t.majorPerformanceCaveat=!0)),s==null)return s;t.available=!0,t.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const i=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT);return i&&(t.supportsHighPrecisionFragment=i.precision>0),s}function H8e(){var s;const t=new B8e,e=j8e(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null,t.unmaskedRenderer=((s=z8e(e,{debugRendererInfo:!0}))==null?void 0:s.getUnmaskedRendererWebGL())??"unknown"),t}function Y8e(t){const e=U8e();return e.available?t==="3d"&&e.majorPerformanceCaveat?new ae("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new ae("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new ae("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new ae("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function X8e(t){return t&&"nodeType"in t}function W8e(t){return t&&typeof t.render=="function"}const KJ={component:"esri-component"};let My=class extends Ye{constructor(){super(...arguments),this.widget=null}destroy(){var e;this.node=null,(e=this.widget)==null||e.destroy()}get id(){var e,s;return this._get("id")??((e=this.widget)==null?void 0:e.id)??((s=this.node)==null?void 0:s.id)}set id(e){this._set("id",e)}set node(e){const s=this._get("node");e!==s&&(e&&e.classList.add(KJ.component),s&&s.classList.remove(KJ.component),this._set("node",e))}castNode(e){var s;return(s=this.widget)==null||s.destroy(),e?typeof e=="string"||X8e(e)?(this._set("widget",null),_7(e)):(W8e(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};p([_()],My.prototype,"id",null),p([_()],My.prototype,"node",null),p([Ht("node")],My.prototype,"castNode",null),p([_({readOnly:!0})],My.prototype,"widget",void 0),My=p([Q("esri.views.ui.Component")],My);const EA=My,nfe="calcite-mode-";function Z8e(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function ofe(){return Z8e().startsWith("dark")}function Q8e(){return`${nfe}${ofe()?"dark":"light"}`}function J8e(t){K8e(t),t.classList.add(Q8e())}function K8e(t){Array.from(t.classList).forEach(e=>{e.startsWith(nfe)&&t.classList.remove(e)})}const eGe={left:0,top:0,bottom:0,right:0},afe={bottom:30,top:15,right:15,left:15},Pm="esri-ui",Ma={ui:Pm,corner:`${Pm}-corner`,innerContainer:`${Pm}-inner-container`,manualContainer:`${Pm}-manual-container`,cornerContainer:`${Pm}-corner-container`,topLeft:`${Pm}-top-left`,topRight:`${Pm}-top-right`,bottomLeft:`${Pm}-bottom-left`,bottomRight:`${Pm}-bottom-right`};function tGe(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function AI(t){return t===0?"0":`${t}px`}function uO(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function cO(t,{top:e,bottom:s,left:i,right:r}){t.style.top=e,t.style.bottom=s,t.style.left=i,t.style.right=r}let Eh=class extends Wl.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=Lo(),this.view=null,this._applyViewPadding=()=>{const s=this.container;s&&cO(s,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const s=this._innerContainer;s&&cO(s,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([Ee(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,ht),Ee(()=>this.padding,this._applyUIPadding,ht),Ee(()=>[this.container,this._locale],([e,s])=>{e&&e.setAttribute("lang",s)},ht),mue(e=>{this._locale=e})])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const s=this._get("container");e!==s&&(e&&(e.classList.add(Ma.ui),J8e(e),this._attachContainers(e)),s&&(s.classList.remove(Ma.ui),cO(s,{top:"",bottom:"",left:"",right:""}),s.textContent=""),this._set("container",e))}get height(){var n;const e=((n=this.view)==null?void 0:n.height)??0;if(e===0)return e;const s=this._getViewPadding(),{top:i,bottom:r}=s;return Math.max(e-i-r,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...afe,...e}}get width(){var n;const e=((n=this.view)==null?void 0:n.width)??0;if(e===0)return e;const s=this._getViewPadding(),{left:i,right:r}=s;return Math.max(e-i-r,0)}add(e,s){let i,r,n;if(Array.isArray(e))return void e.forEach(a=>this.add(a,s));const o=uO(e);o&&({index:i,position:s,component:e,key:r}=o),s&&typeof s=="object"&&({index:i,key:r,position:s,internal:n}=s),!e||s&&!this._isValidPosition(s)||this._add(e,s,i,r,n)}remove(e,s){var r,n;if(!e)return;if(Array.isArray(e))return e.map(o=>this.remove(o,s));const i=this._find(e);if(i){if(this._componentMap.has(i)&&((r=this._componentMap.get(i))==null?void 0:r.key)!==s)return;const o=this._components.indexOf(i),a=i.node.parentNode;return a==null||a.removeChild(i.node),this._componentMap.delete(i),(n=i.widget)==null||n.removeHandlesReference(this._removeWidgetHandleKey),this._components.splice(o,1)[0]}}empty(e,s={removeInternal:!1}){if(Array.isArray(e)){for(const n of e)this.empty(n,s);return}const i=this._positionNameToContainerLookup[e??"manual"],r=Array.prototype.slice.call(i.children).map(n=>this._findByNode(n)).filter(n=>{var o;return n==null?!1:!(((o=this._componentMap.get(n))==null?void 0:o.internal)??!1)||s.removeInternal});for(const n of r)this.remove(n)}move(e,s){if(Array.isArray(e)&&e.forEach(o=>this.move(o,s)),!e)return;let i;const r=uO(e)||uO(s);if(r&&(i=r.index,s=r.position,e=r.component||e),s&&!this._isValidPosition(s))return;const n=this.remove(e);n&&this.add(n,{position:s,index:i})}find(e){if(!e)return null;const s=this._findById(e);return s&&(s.widget||s.node)}getComponents(e,s={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(i=>this._getComponentsAtPosition(i,s)):this._getComponentsAtPosition(e,s):this._components.filter(i=>{var r;return s.includeInternal||!((r=this._componentMap.get(i))!=null&&r.internal)}).map(({widget:i,node:r})=>i??r)}getPosition(e){for(const s in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[s].contains(e))return s;return null}_add(e,s,i,r,n){e instanceof EA||(e=new EA({node:e}));const{widget:o}=e;o!=null&&o instanceof Ye&&o.addHandles(xs(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey),this._place({component:e,position:s,index:i}),this._components.push(e),this._componentMap.set(e,{key:r,internal:n})}_find(e){return e?e instanceof EA?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){var e;return((e=this.view)==null?void 0:e.padding)??eGe}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Ma.innerContainer,Ma.cornerContainer);const s=document.createElement("div");s.classList.add(Ma.innerContainer,Ma.manualContainer);const i=document.createElement("div");i.classList.add(Ma.topLeft,Ma.corner),e.appendChild(i);const r=document.createElement("div");r.classList.add(Ma.topRight,Ma.corner),e.appendChild(r);const n=document.createElement("div");n.classList.add(Ma.bottomLeft,Ma.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(Ma.bottomRight,Ma.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=s;const a=zh();this._cornerNameToContainerLookup={"top-left":i,"top-right":r,"bottom-left":n,"bottom-right":o,"top-leading":a?r:i,"top-trailing":a?i:r,"bottom-leading":a?o:n,"bottom-trailing":a?n:o},this._positionNameToContainerLookup={manual:s,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){var u,c;const s=e.position??"manual",{component:i,index:r}=e,n=this._positionNameToContainerLookup[s],o=r!=null&&r>-1;if(tGe(i.widget)&&i.widget.startup(),!o)return void n.appendChild(i.node);const a=Array.from(n.children);if(r===0){const{firstChild:h}=n;return void(h?(u=h.parentNode)==null?void 0:u.insertBefore(i.node,h):n.appendChild(i.node))}if(r>=a.length)return void n.appendChild(i.node);const l=a[r];(c=l.parentNode)==null||c.insertBefore(i.node,l)}_toPixelPosition(e){return{top:AI(e.top),left:AI(e.left),right:AI(e.right),bottom:AI(e.bottom)}}_findByComponent(e){return this._components.find(s=>s===e)??null}_findById(e){return this._components.find(({id:s})=>s===e)??null}_findByNode(e){return this._components.find(({node:s})=>s===e)??null}_getComponentsAtPosition(e,s){const i=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(i.children).map(r=>this._findByNode(r)).filter(Qa).filter(r=>{var n;return s.includeInternal||!((n=this._componentMap.get(r))!=null&&n.internal)}).map(({widget:r,node:n})=>r??n)}};p([_()],Eh.prototype,"_locale",void 0),p([_()],Eh.prototype,"container",null),p([_()],Eh.prototype,"height",null),p([_({value:afe})],Eh.prototype,"padding",null),p([Ht("padding")],Eh.prototype,"castPadding",null),p([_()],Eh.prototype,"view",void 0),p([_()],Eh.prototype,"width",null),Eh=p([Q("esri.views.ui.UI")],Eh);const sGe=Eh,iGe="randomUUID"in crypto;function A$(){if(iGe)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=s=>t[s].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function _yt(){return`{${A$().toUpperCase()}}`}function rGe(){return`{${A$()}}`}function nGe(t){const e=t.toUpperCase();return t[0]!=="{"?`{${e}}`:e}const oGe={handleInterceptedEvent:(t,e,s,i)=>(t.scheduleRender(),e.properties[`on${i.type}`].apply(e.properties.bind||s,[i]))},aGe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,s)=>{e.charAt(0)==="-"?t.style.setProperty(e,s):t.style[e]=s}},lGe=t=>({...aGe,...t}),uGe=(t,e)=>{const s=[];for(;t&&t!==e;)s.push(t),t=t.parentNode;return s},cGe=(t,e)=>t.find(e),eK=(t,e,s=!1)=>{let i=t;return e.forEach((r,n)=>{const o=i!=null&&i.children?cGe(i.children,a=>a.domNode===r):void 0;s&&!o&&n!==e.length-1||(i=o)}),i},hGe=t=>{let e;const s={...oGe,...t},i=lGe(s),r=i.performanceLogger;let n,o=!0,a=!1;const l=[],u=[],c=(m,f,g)=>{var w;let v;i.eventHandlerInterceptor=(S,T,P,I)=>function(A){let D;r("domEvent",A);const k=uGe(A.currentTarget,v.domNode),R=k.some(z=>{var q;return customElements.get((q=z==null?void 0:z.tagName)==null?void 0:q.toLowerCase())});if(A.eventPhase===Event.CAPTURING_PHASE||!R)k.reverse(),D=eK(v.getLastRender(),k);else{const z=A.composedPath(),q=z.slice(z.indexOf(A.currentTarget),z.indexOf(v.domNode)).reverse();D=eK(v.getLastRender(),q,!0)}let O;return D&&(O=s.handleInterceptedEvent(e,D,this,A)),r("domEventProcessed",A),O},(w=s.postProcessProjectionOptions)==null||w.call(s,i);const b=g();v=m(f,b,i),i.eventHandlerInterceptor=void 0,l.push(v),u.push(g),s.afterFirstVNodeRendered&&s.afterFirstVNodeRendered(v,b)};let h=()=>{if(n=void 0,o){o=!1,r("renderStart",void 0);for(let m=0;m<l.length;m++){const f=u[m]();r("rendered",void 0);try{l[m].update(f)}catch(g){console.error(g)}r("patched",void 0)}r("renderDone",void 0),o=!0}};return s.modifyDoRenderImplementation&&(h=s.modifyDoRenderImplementation(h,l,u)),e={renderNow:h,scheduleRender:()=>{n||a||(n=requestAnimationFrame(h))},stop:()=>{n&&(cancelAnimationFrame(n),n=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(m,f)=>{c(Af.append,m,f)},insertBefore:(m,f)=>{c(Af.insertBefore,m,f)},merge:(m,f)=>{c(Af.merge,m,f)},replace:(m,f)=>{c(Af.replace,m,f)},detach:m=>{for(let f=0;f<u.length;f++)if(u[f]===m)return u.splice(f,1),l.splice(f,1)[0];throw new Error("renderFunction was not found")}},e};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.1.0 */const mGe="calcite-mode-auto",dGe="calcite-mode-dark",vyt={rtl:"calcite--rtl"},byt={filter:250,nextTick:0,resize:150,reposition:100};function tK(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,s=()=>t.contains(dGe)||t.contains(mGe)&&e?"dark":"light",i=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),r=o=>{n!==o&&i(o),n=o};let n=s();i(n),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>r(o.matches?"dark":"light")),new MutationObserver(()=>r(s())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const wd=globalThis.calciteConfig,xyt=(wd==null?void 0:wd.focusTrapStack)||[],wyt=(wd==null?void 0:wd.logLevel)||"info",sK="3.1.0",pGe="2025-03-26",fGe="d5f75fd64";function gGe(){if(wd&&wd.version)return;console.info(`Using Calcite Components ${sK} [Date: ${pGe}, Revision: ${fGe}]`);const t=wd||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:sK,writable:!1}),globalThis.calciteConfig=t}const yGe=()=>typeof navigator<"u"&&typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;function _Ge(){yGe()&&(document.readyState==="interactive"?tK():document.addEventListener("DOMContentLoaded",()=>tK(),{once:!0})),gGe()}_Ge();const vGe=OSe({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.1.0/",hydratedAttribute:"calcite-hydrated"}),{customElement:Syt,getAssetPath:Eyt,setAssetPath:bGe}=vGe;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.1.0 */let lfe=!1;const xGe=t=>{lfe=!0,bGe(t)};let ufe;function wGe(){lfe||xGe($u(Ii(ufe)))}function sl(t){var s;const e=[];for(const i of Object.keys(t))customElements.get(`calcite-${i}`)||e.push((s=t[i])==null?void 0:s.call(t));return e.length>0?Promise.all(e):null}ufe="components/assets";const cfe=Symbol("widget"),hfe=Symbol("widget-test-data"),SGe=[],EGe={},C3=new WeakMap;function mfe(t,e){let s=e.children;if(s!=null&&s.length)for(let r=0;r<s.length;++r)s[r]=mfe(t,s[r]);else s=SGe;const i=e.vnodeSelector;if(P3(i)){const r=e.properties||EGe,n=r.key||i,o={key:n,afterCreate:CGe,afterUpdate:PGe,afterRemoved:dfe,parentWidget:t,widgetConstructor:i,widgetProperties:{...r,key:n,children:s}};return{vnodeSelector:i.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function CGe(t,e,s,{parentWidget:i,widgetConstructor:r,widgetProperties:n}){var a;const o=new r(n);o.container=t,C3.set(t,o),(a=o.afterCreate)==null||a.call(o,o,t),i.addHandles(xs(()=>dfe(t))),queueMicrotask(()=>{o[hfe].projector.renderNow()})}function PGe(t,e,s,{widgetProperties:i}){var n;const r=C3.get(t);r&&(r.set(i),(n=r.afterUpdate)==null||n.call(r,r,t))}function dfe(t){var s;const e=C3.get(t);e&&((s=e.afterRemoved)==null||s.call(e,e,t),e.destroy(),C3.delete(t))}function P3(t){return typeof t=="function"&&t[cfe]}const iK=new Set;function TGe(t){iK.add(t),t.finally(()=>iK.delete(t))}var pfe;const IGe="esri.widgets.Widget";let MGe=0;function ffe(t,e){const s=Object.prototype.hasOwnProperty;for(const i in e)s.call(e,i)&&s.call(t,i)&&(t[i]!=null&&e[i]!=null&&typeof t[i]=="object"&&typeof e[i]=="object"?ffe(t[i],e[i]):t[i]=e[i]);return t}const AGe=hGe({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,s=/capture$/i;t.eventHandlerInterceptor=(i,r,n,o)=>{const a=e==null?void 0:e(i,r,n,o),l=s.test(i);if(!((i=i.replace(s,"")).toLowerCase()in n)||l){const u=i[2].toLowerCase()+i.slice(3),c=f=>a==null?void 0:a.call(n,f);n.addEventListener(u,c,l);const h=()=>n.removeEventListener(u,c,l),m=o.afterRemoved;o.afterRemoved=f=>{m==null||m(f),h()}}return a}},handleInterceptedEvent(t,e,s,i){const{eventPhase:r,type:n}=i,o=r===Event.CAPTURING_PHASE;let a=`on${n}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${n[0].toUpperCase()}${n.slice(1)}${o?"Capture":""}`,l&&a in l))&&(ahe(),t.scheduleRender(),l[a].call(l.bind||s,i))}});let hO=!1,jr=class extends YC.EsriPromiseMixin(Wl.EventedAccessor){constructor(e,s){super(e,s),this._attached=!1,this._projector=AGe,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=jh(async()=>{var l;if((l=this._messageBundleProps)!=null&&l.length){const u=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:c,propertyName:h})=>{if(this.destroyed)return;let m=await xce(c);this.uiStrings&&Object.keys(this.uiStrings)&&(m=ffe(he(m),this.uiStrings)),this[h]=m}));if(this.destroyed)return;for(const c of u)c.status==="rejected"&&Ne.getLogger(this).error("widget-intl:locale-error",this.declaredClass,c.reason)}await this.loadLocale()}),wGe();const i="esri-widget-uid-"+A$(),r=this.render.bind(this);this._trackingTarget=new kD(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const n=()=>({vnodeSelector:"div",properties:{key:`${i}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{var h,m;if(!this._readyForTrueRender||this.destroyed)return null;const l=r()??n(),u=l.properties??(l.properties={});if(u.key??(u.key=i),P3(l.vnodeSelector)){if(!this.visible)return n()}else this.visible?u.styles||(u.styles={}):(u.class="",u.styles={display:"none"}),(h=u.styles).display??(h.display="");let c=0;return(m=l.children)==null||m.forEach(f=>{var g;P3(f.vnodeSelector)||(f.properties??(f.properties={}),(g=f.properties).key??(g.key=`${this.id}--${c++}`))}),mfe(this,l)};this.render=()=>{if(hO)return o();let l=BDe(this)??null;if(l)return l;this._trackingTarget.clear(),hO=!0;try{l=Cd(this._trackingTarget,o)}catch(u){throw Ne.getLogger(this).error(u),u}finally{hO=!1}return l&&jDe(this,l),l};const a=this.beforeFirstRender();a?this._resourcesFetch=a.then(()=>{this._readyForTrueRender=!0,this._postInitialize()}):(this._resourcesFetch=Promise.resolve().then(()=>{this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),TGe(this._resourcesFetch)}normalizeCtorArgs(e,s){const i={...e};return s&&(i.container=s),i}postInitialize(){}beforeFirstRender(){var s;const e=this.loadDependencies();return(s=this._messageBundleProps)!=null&&s.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(ZL):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(ii(this._trackingTarget),ii(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,M4(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return _7(e)}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){var e;return this._get("id")||((e=this.container)==null?void 0:e.id)||Date.now().toString(16)+"-widget-"+MGe++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(pfe=cfe,hfe)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(M4(this),this._projector.scheduleRender())}classes(...e){return lhe.apply(this,e)}renderNow(){M4(this),this._projector.renderNow()}_postInitialize(){var s;if(this.destroyed)return;this.scheduleRender(),(s=this._delegatedEventNames)!=null&&s.length&&this.addHandles(Ee(()=>this.viewModel,(i,r)=>{r&&this.removeHandles("delegated-events"),i&&RD(i)&&this.addHandles(this._delegatedEventNames.map(n=>RC(i,n,o=>{this.emit(n,o)})),"delegated-events")},Ga)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(ZL),this.scheduleRender()};this.addHandles([mue(e),Ee(()=>this.uiStrings,e),Or(()=>this.container,i=>{this.destroyed||this._attach(i)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){var s;this._attached&&(this._projector.detach(this.render),this._attached=!1),(s=e==null?void 0:e.parentNode)==null||s.removeChild(e)}};jr[pfe]=!0,jr.vnodeSelector="div",p([_()],jr.prototype,"_readyForTrueRender",void 0),p([_({value:null})],jr.prototype,"container",null),p([Ht("container")],jr.prototype,"castContainer",null),p([_()],jr.prototype,"icon",null),p([_()],jr.prototype,"id",null),p([_()],jr.prototype,"label",null),p([_()],jr.prototype,"renderable",null),p([_()],jr.prototype,"uiStrings",void 0),p([_()],jr.prototype,"viewModel",void 0),p([_({value:!0})],jr.prototype,"visible",null),p([_()],jr.prototype,"key",void 0),p([_()],jr.prototype,"children",void 0),p([_()],jr.prototype,"afterCreate",void 0),p([_()],jr.prototype,"afterUpdate",void 0),p([_()],jr.prototype,"afterRemoved",void 0),jr=p([Q(IGe)],jr);const Er=jr,NGe=new Map;function DGe(t){return NGe.get(t)}function rK(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function $Ge(t,e){return t.length!==e.length||t.some((s,i)=>s.text!==e[i].text)}function Kw(t,e,s){!s||!e||t.find(i=>i.layerView===e&&i.text===s)||t.push({text:s,layerView:e})}function RGe(t){return t.type==="bing-maps"}const Tm=[];let tv=class extends Ye{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Ge,this.view=null,this._allLayerViewsChange=s=>{var r;this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const i=(r=this.view)==null?void 0:r.allLayerViews;i&&(this.addHandles(i.map(n=>Ee(()=>{var o;return[n.suspended,(o=n.layer)==null?void 0:o.attributionVisible]},()=>this._updateAttributionItems())).toArray(),"suspension"),i.forEach(n=>{n.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(n.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),s!=null&&s.removed&&s.removed.forEach(n=>{this._pendingAttributions.delete(n),this._fetchedAttributionData.delete(n)}),this._updateAttributionItems()},this.addHandles([Vo(()=>{var s;return(s=this.view)==null?void 0:s.allLayerViews},"change",s=>this._allLayerViewsChange(s),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Or(()=>{var s;return((s=this.view)==null?void 0:s.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){var e;return(e=this.view)!=null&&e.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,s=e==null?void 0:e.allLayerViews;if(Tm.length=0,!e||!s)return void this._clear();s.forEach(r=>{var a,l;if(r.suspended||!((a=r.layer)!=null&&a.attributionVisible))return;const n=r.layer;if(rK(n,"user"))return void Kw(Tm,r,n.copyright);if(n.hasAttributionData){if(this._fetchedAttributionData.has(r)){const u=this._fetchedAttributionData.get(r);return void(u?Kw(Tm,r,this._getDynamicAttribution(u,e,n)):rK(n)&&Kw(Tm,r,n.copyright))}return void this._fetchAttributionData(r)}const o="portalItem"in n?(l=n.portalItem)==null?void 0:l.accessInformation:void 0;Kw(Tm,r,o||n.copyright)});const i=s.find(r=>{var n;return((n=r.layer)==null?void 0:n.type)==="integrated-mesh-3dtiles"});if(this.view&&i){const r=DGe(this.view);if(r){const n=r.getAttributionText();for(let o=0;o<n.length;++o)Kw(Tm,i,n[o])}}$Ge(this.items,Tm)&&(this.items.removeAll(),this.items.addMany(Tm)),Tm.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const s=await XD(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const i=s.ok?this._createContributionIndex(s.value,RGe(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,i)}this._updateAttributionItems()}_createContributionIndex(e,s){const i=e.contributors,r={};if(!i)return r;for(let n=0;n<i.length;n++){const o=i[n],a=o.coverageAreas;if(!a)return;for(const l of a){const u=l.bbox,c=l.zoomMin-(s&&l.zoomMin?1:0),h=l.zoomMax-(s&&l.zoomMax?1:0),m=new Hs({xmin:u[1],ymin:u[0],xmax:u[3],ymax:u[2],spatialReference:St.WGS84}),f={extent:bd(m),attribution:o.attribution||"",score:l.score!=null?l.score:100,id:n};for(let g=c;g<=h;g++)r[g]??(r[g]=[]),r[g].push(f)}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(e,s,i){var c;const{extent:r,scale:n}=s;let o=((c=i.tileInfo)==null?void 0:c.scaleToZoom(n))??0;if(o=Math.min(e.maxKey??0,Math.round(o)),!r||o==null||o<=-1)return"";const a=e[o],l=BD(r.center.clone().normalize(),St.WebMercator),u=new Set;return a?a.filter(h=>{const m=h.id,f=!u.has(m)&&l&&h.extent&&VC(h.extent,l);return f&&u.add(m),f}).sort((h,m)=>m.score-h.score||h.objectId-m.objectId).map(h=>h.attribution).join(", "):""}};p([_({readOnly:!0,type:Ge})],tv.prototype,"items",void 0),p([_({readOnly:!0})],tv.prototype,"state",null),p([_()],tv.prototype,"view",void 0),tv=p([Q("esri.widgets.Attribution.AttributionViewModel")],tv);const gfe=tv,vt={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",heading:"esri-widget__heading",hidden:"esri-hidden",interactive:"esri-interactive",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function kGe(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:OGe(t[e])}}}function FGe(t){const e=t==null?void 0:t.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function OGe(t){return function(e,...s){FGe(e)?WDe(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...s)}}function ur(t){return(e,s)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:s})}}var LGe=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},yfe=function(t,e){for(var s=0,i=t.length;s<i;s++){var r=t[s];Array.isArray(r)?yfe(r,e):r!=null&&r!==!1&&(r.hasOwnProperty("vnodeSelector")||(r=LGe(r)),e.push(r))}},VGe=function(t,e){for(var s=[],i=2;i<arguments.length;i++)s[i-2]=arguments[i];if(s.length===1&&typeof s[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:s[0],domNode:null};var r=[];return yfe(s,r),{vnodeSelector:t,properties:e||void 0,children:r,text:void 0,domNode:null}};function K(t,e,...s){return typeof t!="function"||P3(t)?VGe(t,e??null,...s):t(e,...s)}function qGe(...t){return t}const w1="esri-attribution",S1={base:w1,poweredBy:`${w1}__powered-by`,sources:`${w1}__sources`,open:`${w1}--open`,sourcesOpen:`${w1}__sources--open`,link:`${w1}__link`};let sa=class extends Er{constructor(e,s){super(e,s),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(i=>i.forEach(({target:r})=>this._checkSourceTextOverflow(r))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new gfe}initialize(){this.addHandles(Vo(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,s)=>(e.includes(s.text)||e.push(s.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[S1.open]:this._isOpen};return K("div",{bind:this,class:this.classes(S1.base,vt.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return K("div",{class:S1.poweredBy},"Powered by"," ",K("a",{class:S1.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,s=this._isInteractive,i=s?0:void 0,{attributionText:r}=this,n={[S1.sourcesOpen]:e,[vt.interactive]:s};return K("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(S1.sources,n),innerHTML:r,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let s=!1;const{clientHeight:i,clientWidth:r,scrollWidth:n}=e,o=n>r,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(s=!0),this._isOpen){const l=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,l&&(this._isOpen=!1,s=!0)}s&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};p([_()],sa.prototype,"_isOpen",void 0),p([_()],sa.prototype,"_isInteractive",null),p([_()],sa.prototype,"_attributionTextOverflowed",void 0),p([_()],sa.prototype,"_prevSourceNodeHeight",void 0),p([_({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],sa.prototype,"attributionText",null),p([_()],sa.prototype,"icon",null),p([_()],sa.prototype,"itemDelimiter",void 0),p([_()],sa.prototype,"label",null),p([_(),ur("esri/widgets/Attribution/t9n/Attribution")],sa.prototype,"messages",void 0),p([_()],sa.prototype,"view",null),p([_({type:gfe})],sa.prototype,"viewModel",void 0),p([kGe()],sa.prototype,"_toggleState",null),sa=p([Q("esri.widgets.Attribution")],sa);const GGe=sa;function zGe(){const t=ge("mapview-essential-goto-duration");return t==null?t:t}function UGe(t){var e,s;return((e=t==null?void 0:t.spatialReference)==null?void 0:e.isWebMercator)||((s=t==null?void 0:t.spatialReference)==null?void 0:s.isGeographic)||!1}const _fe=t=>{let e=class extends t{constructor(...s){super(...s),this.goToOverride=null,this.view=null}callGoTo(s){const{view:i}=this;return $C(i),this.goToOverride?this.goToOverride(i,s):i.goTo(s.target,s.options)}};return p([_()],e.prototype,"goToOverride",void 0),p([_()],e.prototype,"view",void 0),e=p([Q("esri.widgets.support.GoTo")],e),e};let Ay=class extends _fe(Ye){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(ht)}destroy(){this.view=null}get canShowNorth(){return UGe(this.view)}get state(){var e;return!((e=this.view)!=null&&e.ready)||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){var e,s;(e=this.view)!=null&&e.ready&&(((s=this.view)==null?void 0:s.type)==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:zGe()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const s=-e.heading;this._set("orientation",{x:0,y:0,z:s})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?Ee(()=>e==null?void 0:e.rotation,this._updateForRotation,ht):Ee(()=>e==null?void 0:e.camera,this._updateForCamera,ht))}_watchForView(e){this.addHandles(Ee(()=>this.view,this._updateRotationWatcher,e))}};p([_({readOnly:!0})],Ay.prototype,"canShowNorth",null),p([_({readOnly:!0})],Ay.prototype,"orientation",void 0),p([_({readOnly:!0})],Ay.prototype,"state",null),p([_()],Ay.prototype,"view",void 0),Ay=p([Q("esri.widgets.Compass.CompassViewModel")],Ay);const vfe=Ay,nK="esri-compass",oK={base:nK,iconContainer:`${nK}__icon-container`};let Bm=class extends Er{constructor(e,s){super(e,s),this.messages=null,this.viewModel=new vfe,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=i=>({transform:`rotateZ(${i.z}deg)`})}loadDependencies(){return sl({button:()=>me(()=>import("./index-CmPXJs7R.js"),__vite__mapDeps([239,240,241,242,243,244,245,246,247,248,249,250,251])),icon:()=>me(()=>import("./index-BhFhNIYS.js").then(e=>e.i),__vite__mapDeps([243,244,241,245]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:s}=this.viewModel,{messages:i}=this;return K("div",{class:this.classes(oK.base,vt.widget)},K("calcite-button",{class:vt.widgetButton,disabled:s==="disabled",kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},K("div",{"aria-hidden":"true",class:oK.iconContainer,title:i.reset},K("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};p([_()],Bm.prototype,"goToOverride",null),p([_()],Bm.prototype,"icon",null),p([_()],Bm.prototype,"label",null),p([_(),ur("esri/widgets/Compass/t9n/Compass")],Bm.prototype,"messages",void 0),p([_()],Bm.prototype,"view",null),p([_({type:vfe})],Bm.prototype,"viewModel",void 0),Bm=p([Q("esri.widgets.Compass")],Bm);const BGe=Bm,aK="esri-navigation-toggle",lK={base:aK,isLayoutHorizontal:`${aK}--horizontal`};let sv=class extends Ye{constructor(e){super(e),this._navigationMode="pan",this.view=null}initialize(){this.addHandles(Or(()=>{var e,s;return(s=(e=this.view)==null?void 0:e.navigation)==null?void 0:s.actionMap},()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){var e,s;return(e=this.view)!=null&&e.ready&&((s=this.view)==null?void 0:s.type)==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){var i,r;const e=(r=(i=this.view)==null?void 0:i.navigation)==null?void 0:r.actionMap;if(!e)return;const s=this._navigationMode==="pan";e.dragPrimary=s?"pan":"rotate",e.dragSecondary=s?"rotate":"pan"}};p([_({readOnly:!0})],sv.prototype,"state",null),p([_()],sv.prototype,"_navigationMode",void 0),p([_()],sv.prototype,"view",void 0),sv=p([Q("esri.widgets.NavigationToggle.NavigationToggleViewModel")],sv);const bfe=sv;let jm=class extends Er{constructor(e,s){super(e,s),this.messages=null,this.viewModel=new bfe,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{var r;const i=((r=this.viewModel)==null?void 0:r.navigationMode)==="pan"?this._rotateButton:this._panButton;tb(i),this.toggle()}}loadDependencies(){return sl({button:()=>me(()=>import("./index-CmPXJs7R.js"),__vite__mapDeps([239,240,241,242,243,244,245,246,247,248,249,250,251]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){var r,n;const e=((r=this.viewModel)==null?void 0:r.state)==="disabled",s=((n=this.viewModel)==null?void 0:n.navigationMode)==="pan",i=this.messages.toggle;return K("div",{class:this.classes(lK.base,vt.widget,{[lK.isLayoutHorizontal]:this.layout==="horizontal"})},K("calcite-button",{afterCreate:o=>{this._panButton=o},appearance:s?"outline-fill":"solid",class:vt.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:s?void 0:-1,title:i}),K("calcite-button",{afterCreate:o=>{this._rotateButton=o},appearance:s?"solid":"outline-fill",class:vt.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:s?-1:void 0,title:i}))}};p([_()],jm.prototype,"icon",null),p([_()],jm.prototype,"label",null),p([_({value:"vertical"})],jm.prototype,"layout",null),p([_(),ur("esri/widgets/NavigationToggle/t9n/NavigationToggle")],jm.prototype,"messages",void 0),p([_()],jm.prototype,"view",null),p([_({type:bfe})],jm.prototype,"viewModel",void 0),jm=p([Q("esri.widgets.NavigationToggle")],jm);const jGe=jm;let Ny=class extends Ye{get canZoomIn(){var i,r,n;if(!((i=this.view)==null?void 0:i.ready))return!1;const s=(n=(r=this.view)==null?void 0:r.constraints)==null?void 0:n.effectiveMaxScale;return s===0||this._scale>s}get canZoomOut(){var r;const{view:e}=this;if(!(e==null?void 0:e.ready))return!1;const i=(r=e.constraints)==null?void 0:r.effectiveMinScale;return i===0||this._scale<i}get _scale(){var s,i,r;const e=(i=(s=this.view)==null?void 0:s.animation)==null?void 0:i.target;return(e&&"then"in e||e==null?void 0:e.scale)??((r=this.view)==null?void 0:r.scale)??0}};p([_({readOnly:!0})],Ny.prototype,"canZoomIn",null),p([_({readOnly:!0})],Ny.prototype,"canZoomOut",null),p([_()],Ny.prototype,"view",void 0),p([_()],Ny.prototype,"_scale",null),Ny=p([Q("esri.widgets.Zoom.ZoomConditions2D")],Ny);const HGe=Ny;let iv=class extends Ye{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};p([_({readOnly:!0})],iv.prototype,"canZoomIn",null),p([_({readOnly:!0})],iv.prototype,"canZoomOut",null),p([_()],iv.prototype,"view",void 0),iv=p([Q("esri.widgets.Zoom.ZoomConditions3D")],iv);const YGe=iv;let Zp=class extends Ye{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return this._zoomConditions!=null&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new HGe({view:e}):e.type==="3d"&&(this._zoomConditions=new YGe({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():zl(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():zl(e.goTo({zoomFactor:.5})))}};p([_()],Zp.prototype,"_zoomConditions",void 0),p([_()],Zp.prototype,"canZoomIn",null),p([_()],Zp.prototype,"canZoomOut",null),p([_({readOnly:!0})],Zp.prototype,"state",null),p([_()],Zp.prototype,"view",null),Zp=p([Q("esri.widgets.Zoom.ZoomViewModel")],Zp);const xfe=Zp,uK={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let Hm=class extends Er{constructor(e,s){super(e,s),this.messages=null,this.viewModel=new xfe,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return sl({button:()=>me(()=>import("./index-CmPXJs7R.js"),__vite__mapDeps([239,240,241,242,243,244,245,246,247,248,249,250,251]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[uK.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:s,canZoomOut:i}=this.viewModel,{zoomIn:r,zoomOut:n}=this.messages;return K("div",{class:this.classes(uK.base,vt.widget,e)},K("calcite-button",{class:vt.widgetButton,disabled:!s,iconStart:"plus",kind:"neutral",label:r,onclick:this.zoomIn,title:r}),K("calcite-button",{class:vt.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:n,onclick:this.zoomOut,title:n}))}};p([_()],Hm.prototype,"icon",null),p([_()],Hm.prototype,"label",null),p([_({value:"vertical"})],Hm.prototype,"layout",null),p([_(),ur("esri/widgets/Zoom/t9n/Zoom")],Hm.prototype,"messages",void 0),p([_()],Hm.prototype,"view",null),p([_({type:xfe})],Hm.prototype,"viewModel",void 0),Hm=p([Q("esri.widgets.Zoom")],Hm);const XGe=Hm;function WGe(t){return(t==null?void 0:t.view)!==void 0}let CA=class extends sGe{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=s=>{this.components.forEach(i=>{const r=this._find(i),n=r==null?void 0:r.widget;WGe(n)&&(n.view=s)})},this._componentsWatcher=(s,i)=>{this._removeComponents(i),this._addComponents(s),this._adjustPadding(s)}}initialize(){this.addHandles([Ee(()=>this.components,this._componentsWatcher,ht),Ee(()=>this.view,this._updateViewAwareWidgets,ht)])}_add(e,s,i,r,n){let o=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;o=this._createComponent(e)}super._add(o,s,i,r,n)}_removeComponents(e){e.forEach(s=>{const i=this._find(s);i&&(this.remove(i),i.destroy())})}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:s}=this.padding;this.padding=s}}_addComponents(e){this.constructed&&e.forEach(s=>this.add(this._createComponent(s),this._defaultPositionLookup[s]))}_createComponent(e){const s=this._createWidget(e);return new EA({id:e,node:s})}_createWidget(e){const s=this.view;switch(e){case"attribution":return new GGe({view:s});case"compass":return new BGe({view:s});case"navigation-toggle":return new jGe({view:s});case"zoom":return new XGe({view:s})}}};p([_()],CA.prototype,"components",void 0),CA=p([Q("esri.views.ui.DefaultUI")],CA);const wfe=CA;let PA=class extends wfe{constructor(e){super(e),this.components=["attribution","zoom"]}};p([_()],PA.prototype,"components",void 0),PA=p([Q("esri.views.ui.2d.DefaultUI2D")],PA);const Sfe=PA;let Efe=class XV{constructor(e,s,i=""){this.major=e,this.minor=s,this._context=i}lessThan(e,s){return this.major<e||e===this.major&&this.minor<s}greaterEqual(e,s){return!this.lessThan(e,s)}validate(e){if(this.major!==e.major){const s=this._context&&this._context+":",i=this._context&&this._context+" ";throw new ae(s+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new XV(this.major,this.minor,this._context)}static parse(e,s=""){const[i,r]=e.split("."),n=/^\s*\d+\s*$/;if(!(i!=null&&i.match)||!n.test(i))throw new ae((s&&s+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!(r!=null&&r.match)||!n.test(r))throw new ae((s&&s+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(i,10),a=parseInt(r,10);return new XV(o,a,s)}},ZGe=class extends Efe{constructor(e,s){super(e,s,"webmap")}};function mO(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}new ZGe(2,33);var WV;let TA=WV=class extends Te{constructor(t){super(t),this.color=new Be([0,0,0,1])}clone(){return new WV(he({color:this.color}))}};p([_({type:Be,json:{write:!0}})],TA.prototype,"color",void 0),TA=WV=p([Q("esri.webmap.background.ColorBackground")],TA);const QGe=TA;let Cfe,Pfe,Tfe,Ife,Mfe,Afe,Nfe;async function JGe(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:s,MapViewNavigation:i,MagnifierView2D:r,GridView2D:n,Stage:o}]=await Promise.all([me(()=>import("./webglDeps-DP6tZZvN.js"),__vite__mapDeps([160,133,161,162,163])),me(()=>import("./mapViewDeps-BisJeTYT.js"),__vite__mapDeps([164,66,165,64,65,67,68,69,70,62,73,166,161,133,162,137,113,63,37,167,61,90,168,169,120,119,77,16,71,79,170,74,75,76,171,4,118,160,163,172,85,173,60,14,10,19,174,126,127,111,135,175,176,78,177,178,72,179,42,82,58,180,181,182,183,129,184]))]);Pfe=t,Tfe=e,Ife=s,Mfe=i,Afe=r,Nfe=n,Cfe=o}let ts=class extends AVe(Q3e(E$e(c$e(GOe)))){constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new ME({getCollections:()=>{var s,i;return[(s=this.basemapView)==null?void 0:s.baseLayerViews,this.layerViews,(i=this.basemapView)==null?void 0:i.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new w$({actionMap:new W7({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.floors=new Ge,this.grid=null,this.map=null,this.spatialReferenceLocked=!1,this.timeline=new rfe,this.type="2d",this.view2dType=null,this.ui=new Sfe,this.test={takeScreenshot:async s=>O8e(this._getScreenshotView(s),s)},this.padding={top:0,right:0,bottom:0,left:0},n3e()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=ii(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new Bqe(this.featuresTilingScheme)}get constraintsInfo(){var i,r;const e=(i=this.defaultsFromMap)==null?void 0:i.tileInfo,s=this.spatialReference;return{lods:(r=e==null?void 0:e.spatialReference)!=null&&r.equals(s)?e.lods:null,spatialReference:s}}get initialExtentRequired(){var a;if(!this.stateManager)return!1;const{scale:e,constraints:s,center:i,viewpoint:r,extent:n}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((a=this.map.initialViewProperties)!=null&&a.viewpoint))&&!n&&(s!=null&&s.effectiveLODs||(o=-1),(!i||e===0&&o===-1)&&((r==null?void 0:r.targetGeometry)==null||r.targetGeometry.type!=="extent"&&!r.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const s=e.targetGeometry,i=this.spatialReference;return Oce(s.spatialReference,i)}get background(){return mO(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){var e;return((e=this.stateManager)==null?void 0:e.center)??null}set center(e){this.stateManager.center=e}get highlightOptions(){return x8e(this)}set highlightOptions(e){w8e(this,e)}get padding(){var e;return(e=this.stateManager)==null?void 0:e.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){var e;return((e=this.stage)==null?void 0:e.renderRequested)??!1}get resolution(){return this.stateManager.resolution??0}get scale(){var e;return((e=this.stateManager)==null?void 0:e.scale)??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get tileInfo(){var e;return(e=this.featuresTilingScheme)==null?void 0:e.tileInfo}get updating(){var i,r,n,o;const e=!(!this.magnifier.visible||this.magnifier.position===null||!((i=this._magnifierView)!=null&&i.updatingHandles.updating)),s=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(a=>!a.destroyed&&!("layerViews"in a)&&a.updating===!0)||e);if(ge("esri-2d-log-updating")){const a=this.allLayerViews.reduce((l,u)=>({...l,[`${u.layer.id}(${u.layer.type})`]:!u.destroyed&&!("layerViews"in u)&&u.updating}),{});console.log(`Updating MapView: ${s}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(r=this.layerViewManager)==null?void 0:r.updating}
-> labelManager.updating: ${(n=this.labelManager)==null?void 0:n.updating}
-> graphicsView.updating: ${(o=this.graphicsView)==null?void 0:o.updating}
-> allLayerViews: ${JSON.stringify(a)}
-> updatingMagnifier: ${e}
`)}return s}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new po({rings:[e.map(s=>[s[0],s[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){var e;return((e=this.mapViewNavigation)==null?void 0:e.interacting)??!1}async hitTest(e,s){return S8e(this,e,s)}async takeScreenshot(e){return F8e(this._getScreenshotView(e),e)}toMap(e){if(!this.ready)return null;const s=fde(e)?pde(this,e):e;return this.stateManager.toMap(s)}toScreen(e,s){return this.stateManager.toScreen(e,s)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e;return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||((e=this.defaultsFromMap)==null?void 0:e.spatialReference)||null}getDefaultTimeZone(){return mO(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return mO(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(e){return dJ.hasLayerViewModule(e)}importLayerView(e){return dJ.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(Ne.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){var u;const s=this.toMap(e),i=await this.hitTest(e),r=this.allLayerViews.toArray().filter(c=>c.clips.every(h=>Ype(this,h,e,s))).reverse(),n=new globalThis.Map(r.map(c=>[c.layer.uid,c])),o=[];let a=0,l=0;for(;a<i.results.length||l<r.length;){const c=i.results.at(a);if(c&&c.type!=="graphic"){++a;continue}const h=n.get((u=(c==null?void 0:c.layer)??(c==null?void 0:c.graphic.layer))==null?void 0:u.uid);if((!c||h)&&l<r.length&&r.at(l)!==h){const m=r.at(l);"fetchPopupFeaturesAtLocation"in m&&o.push({mapPoint:s,layerView:m}),++l}else c&&(o.push({graphic:c.graphic,layerView:h}),++a)}return{hits:o,location:s}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=Y8e(this.type);if(ge("safari")&&ge("safari")<9&&(e=new ae("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ge("safari")})),e!=null)throw Ne.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return JGe()}_getDefaultViewpoint(){var b;const{constraints:e,initialExtent:s,map:i,padding:r,size:n}=this;if(!e)return null;const o=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=o==null?void 0:o.viewpoint,u=((b=l==null?void 0:l.targetGeometry)==null?void 0:b.extent)??s,c=u==null?void 0:u.center,h=(l==null?void 0:l.rotation)??0,m=(l==null?void 0:l.scale)||u&&P$(u,[n[0]-r.left-r.right,n[1]-r.top-r.bottom]),f=a.center??c,g=a.rotation??h,v=a.scale??m;return f&&v?new Lu({targetGeometry:f,scale:v,rotation:g}):null}_startup(){var a;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,(a=this.defaultsFromMap.extent)==null?void 0:a.center),this.graphics.owner=this;const s=new Cfe(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=s,this._magnifierView=new Afe,this._magnifierView.magnifier=this.magnifier,this._gridView=new Nfe;const i=new Ife({view:this});this._set("labelManager",i);const r=new Pqe({view:this});this._set("animationManager",r);const n=new Mfe({view:this,animationManager:r});this._set("mapViewNavigation",n),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),s.on("webgl-error",l=>this.fatalError=l.error),Ee(()=>this.stationary,l=>s.stationary=l,Ga),Ee(()=>this.background,l=>{s.backgroundColor=l==null?void 0:l.color,this._magnifierView.backgroundColor=l==null?void 0:l.color},Ga),Ee(()=>this.magnifier,l=>this._magnifierView.magnifier=l,Ga),Ee(()=>this.grid,l=>this._gridView.grid=l,Ga),Ee(()=>this.renderingOptions,l=>s.renderingOptions=l,Ga),Ee(()=>this.highlights.items.map(l=>({name:l.name,options:{fillColor:l.color,haloColor:l.haloColor,fillOpacity:l.fillOpacity,haloOpacity:l.haloOpacity,haloWidth:l.haloWidth,haloBlur:l.haloBlur}})),()=>{s.highlightGradient=v8e(s.highlightGradient,this.highlights.items)},Ga),Ee(()=>this.state.id,()=>s.state=this.state,Ga)],"map-view"),this._updateStageChildren();const o=this._resolveWhenReady;this._resolveWhenReady=[],o.forEach(l=>l(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(s=>{this.stage.addChild(s.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new Dqe(W3e.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const s=new Pfe({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Tfe(e)});this._set("graphicsView",s)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){var o;const{allLayerViews:s,padding:i,size:r,stage:n}=this;return{allLayerViews:s,backgroundColor:e!=null&&e.ignoreBackground?null:(o=this.background)==null?void 0:o.color,padding:i,size:r,stage:n}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const s of this.allLayerViews)s.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const s of this.allLayerViews)s.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};ts.type="2d",p([_({constructOnly:!0})],ts.prototype,"deactivatedWebGLExtensions",void 0),p([_({constructOnly:!0})],ts.prototype,"debugWebGLExtensions",void 0),p([_({readOnly:!0})],ts.prototype,"featuresTilingScheme",void 0),p([_({readOnly:!0})],ts.prototype,"graphicsTileStore",null),p([_()],ts.prototype,"graphicsView",void 0),p([_()],ts.prototype,"constraintsInfo",null),p([_()],ts.prototype,"initialExtentRequired",null),p([_()],ts.prototype,"labelManager",void 0),p([_({type:w$,nonNullable:!0})],ts.prototype,"navigation",void 0),p([_({constructOnly:!0})],ts.prototype,"renderCanvas",void 0),p([_()],ts.prototype,"renderingOptions",void 0),p([_({constructOnly:!0})],ts.prototype,"supersampleScreenshotsEnabled",void 0),p([_({readOnly:!0})],ts.prototype,"supportsGround",void 0),p([_()],ts.prototype,"defaultsFromMapSettings",null),p([_({readOnly:!0})],ts.prototype,"typeSpecificPreconditionsReady",null),p([_({type:QGe})],ts.prototype,"background",null),p([_()],ts.prototype,"center",null),p([_({type:Ge})],ts.prototype,"floors",void 0),p([_()],ts.prototype,"grid",void 0),p([_({type:zf})],ts.prototype,"highlightOptions",null),p([_()],ts.prototype,"map",void 0),p([_()],ts.prototype,"padding",null),p([_({readOnly:!0})],ts.prototype,"rendering",null),p([_({readOnly:!0})],ts.prototype,"resolution",null),p([_()],ts.prototype,"scale",null),p([_({constructOnly:!0})],ts.prototype,"spatialReferenceLocked",void 0),p([_({readOnly:!0})],ts.prototype,"tileInfo",null),p([_({type:rfe,readOnly:!0})],ts.prototype,"timeline",void 0),p([_({readOnly:!0})],ts.prototype,"type",void 0),p([_({readOnly:!0})],ts.prototype,"updating",null),p([_({readOnly:!0})],ts.prototype,"view2dType",void 0),p([_({readOnly:!0})],ts.prototype,"visibleArea",null),p([_()],ts.prototype,"zoom",null),p([_({readOnly:!0})],ts.prototype,"navigating",null),p([_(),Ht(t=>t instanceof wfe?t:Qb(Sfe,t))],ts.prototype,"ui",void 0),ts=p([Q("esri.views.View2D")],ts);const KGe=ts;let IA=class extends KGe{constructor(e){super(e),this.view2dType="map"}};p([_({readOnly:!0})],IA.prototype,"view2dType",void 0),IA=p([Q("esri.views.MapView")],IA);const eze=IA,bu="esri-layer-list",Im=`${bu}__item`,e2={base:bu,actionMenu:`${bu}__action-menu`,actionGroup:`${bu}__action-group`,filterNoResults:`${bu}__filter-no-results`,item:Im,itemActive:`${Im}--active`,itemContentBottom:`${Im}-content-bottom`,itemMessage:`${Im}-message`,itemActionIcon:`${Im}-action-icon`,itemActionImage:`${Im}-action-image`,itemTemporaryIcon:`${Im}-temporary-icon`,itemTableIcon:`${Im}-table-icon`,itemCatalogIcon:`${Im}-catalog-icon`,statusIndicator:`${bu}__status-indicator`,publishing:`${bu}__publishing`,updating:`${bu}__updating`,connectionStatus:`${bu}__connection-status`,connectionStatusConnected:`${bu}__connection-status--connected`,visibleToggle:`${bu}__visible-toggle`,visibleIcon:`${bu}__visible-icon`};function cK(t){return t.icon?t.icon:"image"in t&&t.image||t.className?void 0:"question"}function Dfe(t){return t?{backgroundImage:`url(${t})`}:{}}function tze({action:t,feature:e}){const s=e==null?void 0:e.attributes,i="image"in t?t.image:void 0;return i&&s?Nu(i,s):i??""}const $fe={hide:"hide",hideChildren:"hide-children"},sze=10,ize=2;function rze({exclusive:t,visible:e,visibilityAppearance:s}){const i=s==="checkbox";return e?t?"circle-f":i?"check-square-f":"view-visible":t?"circle":i?"square":"view-hide"}function nze({connectionStatus:t,publishing:e}){return t?t==="connected"?"beacon":"offline":e?"square":"bullet-point"}function oze(t){return(t==null?void 0:t.listMode)===$fe.hideChildren}function T3(t){return(t==null?void 0:t.listMode)??void 0}function aze(t){return t!=null&&"minScale"in t&&t.minScale!=null?t.minScale:void 0}function lze(t){return t!=null&&"maxScale"in t&&t.maxScale!=null?t.maxScale:void 0}function uze(t){if(!t)return"inherited";const e=gze(pU(t)?t.layer:t);return e!=null?e?"independent":"inherited":"visibilityMode"in t&&t.visibilityMode!=null?t.visibilityMode:"independent"}function cze(t){t==null||t.removeMany(t.filter(e=>e==null?void 0:e.destroyed))}function Rfe(t){if(t&&(!("type"in t)||t.type!=="wmts"))return"sublayers"in t?"sublayers":"layers"in t?"layers":void 0}function hze(t,e){t&&(t.filterPredicate=e?s=>e(Pc(s)):void 0)}function mze(t){const e=(t!=null&&t.layer&&pU(t.layer)?t.layer.layer:void 0)??(t==null?void 0:t.layer);return!!e&&e.type!=="catalog"&&(yze(e)??!0)}function dze(t){return T3(t)!==$fe.hide}function pze(t,e){if(!t||e==null||isNaN(e))return!1;const s=aze(t),i=lze(t),r=s!=null&&!isNaN(s)&&s>0&&e>s,n=i!=null&&!isNaN(i)&&i>0&&e<i;return r||n}function kfe(t,e){t==null||t.sort((s,i)=>{const r="uid"in s?e.indexOf(s.uid):-1,n="uid"in i?e.indexOf(i.uid):-1;return r>n?-1:r<n?1:0})}function fze(t,e){const s=t==null?void 0:t.layer;if(!s)return;const i=Rfe(s);if(!i)return;let r;i==="layers"&&"layers"in s?r=s.layers:i==="sublayers"&&"sublayers"in s&&(r=s.sublayers),kfe(r,e)}function hK(t){const e=t==null?void 0:t.layer;return e&&"layers"in e?e.layers:null}function pU(t){return t!=null&&"layer"in t&&t.layer!=null}function gze(t){const e=Ffe(t);return e!=null&&"supportsSublayerVisibility"in e?e.supportsSublayerVisibility:void 0}function yze(t){const e=Ffe(t);return e!=null&&"supportsDynamicLayers"in e?e.supportsDynamicLayers:void 0}function Ffe(t){return t&&"capabilities"in t&&t.capabilities!=null&&"exportMap"in t.capabilities?t.capabilities.exportMap:void 0}function Pc(t){return t==null?void 0:t["data-item"]}function mK(t){return t==null?void 0:t.getAttribute("data-layer-type")}function _ze(t){const{children:e,error:s}=t,i="incompatible"in t&&t.incompatible;return!!(e!=null&&e.filter(r=>!r.hidden).length)&&!s&&!i}function vze(t){for(const e of t)for(const s of e)if(s.type==="button"||s.type==="toggle")return s}var ZV;let Ft=ZV=class extends Er{constructor(t){super(t),this.dragEnabled=!1,this.listModeDisabled=!1,this.parent=null,this.parentTitles=null,this.viewModel=null,this._onActionMenuOpen=e=>{this.item.actionsOpen=e.currentTarget.open},this._setTooltipReference=e=>{var s,i;(i=this.onTooltipReferenceChange)==null||i.call(this,(s=this.item.layer)==null?void 0:s.uid,e)},this._removeTooltipReference=()=>{var e,s;(s=this.onTooltipReferenceChange)==null||s.call(this,(e=this.item.layer)==null?void 0:e.uid,null)}}loadDependencies(){return sl({"action-group":()=>me(()=>import("./index-mCYGoQ2c.js").then(t=>t.i),__vite__mapDeps([252,240,241,242,243,244,245,253,254,246,249,251,255,256,257,258,247,259,260,261,262,263])),"action-menu":()=>me(()=>import("./index-BPjQMfUj.js").then(t=>t.i),__vite__mapDeps([262,240,241,242,243,244,245,253,254,246,249,251,255,256,257,258,247,259,260,261,263])),action:()=>me(()=>import("./index-9hW8Ud6V.js"),__vite__mapDeps([253,240,241,242,243,244,245,254,246,249,251])),icon:()=>me(()=>import("./index-BhFhNIYS.js").then(t=>t.i),__vite__mapDeps([243,244,241,245])),"list-item":()=>me(()=>import("./index-B_oefgqS.js"),__vite__mapDeps([264,243,244,241,245,265,246,256,257,249,261,251,258,266,240,242,253,254,267,268,269,270,271])),list:()=>me(()=>import("./index-kzOfcToX.js"),__vite__mapDeps([272,240,241,242,273,246,245,244,254,243,274,275,276,247,248,249,261,250,251,257,270])),notice:()=>me(()=>import("./index-DW-iT0Or.js"),__vite__mapDeps([277,243,244,241,245,246,251,258,242]))})}render(){var f,g;const t=this.parentTitles??[],{_title:e,item:s,activeItem:i,selectionMode:r,selectedItems:n,messages:o,parent:a,css:l}=this,u="visibleAtCurrentTimeExtent"in s&&"layerInvisibleAtTime"in o&&!s.visibleAtCurrentTimeExtent?`${e} (${o.layerInvisibleAtTime})`:"visibleAtCurrentScale"in s&&"layerInvisibleAtScale"in o&&!s.visibleAtCurrentScale?`${e} (${o.layerInvisibleAtScale})`:e,c="parent"in s&&((g=(f=s.parent)==null?void 0:f.layer)==null?void 0:g.type)==="catalog",{layer:h}=s,m="visibleAtCurrentScale"in s&&!s.visibleAtCurrentScale||"visibleAtCurrentTimeExtent"in s&&!s.visibleAtCurrentTimeExtent;return K("calcite-list-item",{afterCreate:v=>this._focusSelectedDragEl(v,s),afterUpdate:v=>this._focusSelectedDragEl(v,s),class:this.classes(l.item,"itemActive"in l&&{[l.itemActive]:i===s}),"data-item":s,"data-layer-id":h==null?void 0:h.id,dragDisabled:!s.sortable||c,id:h==null?void 0:h.uid,key:`list-item-${h==null?void 0:h.uid}`,label:e,metadata:{parentTitles:t,_title:e},open:"open"in s&&s.open,selected:r!=="none"&&n.includes(s),title:u,unavailable:m,value:h==null?void 0:h.uid,onCalciteListItemSelect:v=>"visible"in s&&this._handleCalciteListItemSelect(v,s,a),onCalciteListItemToggle:v=>"open"in s&&this._handleCalciteListItemToggle(v,s)},this._renderedCatalogFootprintIcon,this._renderedCatalogDynamicIcon,this._renderedItemStatus,this._renderedItemToggle,this._renderedCatalogSelectNode,this._renderedItemTemporaryIcon,this._renderedChildList,this._renderedItemMessage,this._renderedPanel,this._renderedPanelAction,this._renderedActions)}get _title(){const{messages:t}=this;return this.item.title||("untitledTable"in t?t.untitledTable:t.untitledLayer)}get _renderedItemStatus(){const{item:t,parent:e,visibleElements:s,css:i}=this;if(!s.statusIndicators)return null;const{publishing:r}=t,n="updating"in t&&t.updating&&!e,o="connectionStatus"in t?t.connectionStatus:void 0,a=!!o;return K("calcite-icon",{class:this.classes(i.statusIndicator,{[i.publishing]:r},"updating"in i&&{[i.updating]:n},"connectionStatus"in i&&{[i.connectionStatus]:a},"connectionStatusConnected"in i&&{[i.connectionStatusConnected]:a&&o==="connected"}),icon:nze({connectionStatus:o,publishing:r}),key:"layer-item-status",scale:"s",slot:"content-end"})}get _renderedItemTemporaryIcon(){const{item:t,visibleElements:e,css:s}=this,{layer:i}=t,r="temporaryLayerIndicators"in e&&e.temporaryLayerIndicators,n="temporaryTableIndicators"in e&&e.temporaryTableIndicators,o=i&&"persistenceEnabled"in i&&(P7(i)||!i.persistenceEnabled);return(r||n)&&o?K("calcite-icon",{class:s.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"content-start",title:this.messages.temporary}):null}get _renderedItemToggle(){const{item:t,parent:e,messages:s,visibilityAppearance:i,css:r}=this;if(!("visible"in t&&"layerVisibility"in s&&"visibleToggle"in r&&i))return null;const{visible:n}=t,o=this._getParentVisibilityMode(e);if(o==="inherited")return null;const a=rze({visible:n,exclusive:o==="exclusive",visibilityAppearance:i}),l=i==="checkbox",u=s.layerVisibility;return K("calcite-action",{appearance:"transparent",class:r.visibleToggle,icon:l?a:void 0,key:"visibility-toggle",onclick:()=>this._toggleVisibility(t,e),scale:"s",slot:l?"actions-start":"actions-end",text:u,title:u},l?null:K("calcite-icon",{class:this.classes({[r.visibleIcon]:o!=="exclusive"&&n}),icon:a,scale:"s"}))}get _renderedPanel(){const{panel:t}=this.item;return!(t!=null&&t.open)||t.disabled||t.flowEnabled?null:K("div",{class:this.css.itemContentBottom,key:`content-panel-${t.uid}`,slot:"content-bottom"},t.render())}get _renderedPanelAction(){const{panel:t}=this.item;if(!(t!=null&&t.visible))return null;const{open:e,title:s,disabled:i}=t;return K("calcite-action",{active:e,appearance:"transparent",disabled:i,icon:cK(t),key:`action-${t.uid}`,onclick:()=>this._togglePanel(t),scale:"s",slot:"actions-end",text:s??"",title:s??void 0},this._renderFallbackIcon(t))}get _renderedActions(){switch(this._actionsCount){case 0:return null;case 1:return this._singleAction;default:return this._renderedActionMenu}}get _renderedActionMenu(){const{item:t,messagesCommon:e}=this,s=e.options;return K("calcite-action-menu",{appearance:"transparent",key:"item-action-menu",label:e.menu,open:t.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:this._onActionMenuOpen},K("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:s,title:s}),this._renderedActionMenuContent)}get _renderedActionMenuContent(){return this._filteredSections.toArray().map(t=>K("calcite-action-group",{key:`action-section-${t.uid}`},t.toArray().map(e=>this._renderAction({action:e,textEnabled:!0}))))}get _renderedCatalogFootprintIcon(){const{css:t}=this,e=this.item.layer,s=(e==null?void 0:e.type)==="catalog-footprint",i=(e==null?void 0:e.type)==="sublayer"&&aQ(e,"footprints");return"itemCatalogIcon"in t&&(s||i)?K("calcite-icon",{class:t.itemCatalogIcon,icon:"footprint",key:"footprint",scale:"s",slot:"content-start"}):null}get _renderedCatalogDynamicIcon(){const{css:t}=this,e=this.item.layer,s=(e==null?void 0:e.type)==="catalog-dynamic-group",i=(e==null?void 0:e.type)==="sublayer"&&aQ(e,"layers-in-view");return"itemCatalogIcon"in t&&(s||i)?K("calcite-icon",{class:t.itemCatalogIcon,icon:"catalog-dataset",key:"catalog-dataset",scale:"s",slot:"content-start"}):null}get _renderedCatalogSelectNode(){const{_title:t,item:e,visibleElements:s}=this;if(!("visible"in e))return;const{layer:i}=e,r=(i==null?void 0:i.type)==="catalog-dynamic-group";return"catalogLayerList"in s&&s.catalogLayerList&&r?K("calcite-action",{appearance:"transparent",disabled:!i.visible,icon:"chevron-right",iconFlipRtl:!0,onclick:()=>this._triggerOnCatalogOpen(e),scale:"s",slot:"actions-end",text:t}):null}get _renderedChildList(){const{dragEnabled:t,item:e,rootGroupUid:s,listModeDisabled:i,selectionMode:r,displayMode:n}=this;if(!("children"in e))return;const o=[...this.parentTitles??[],e.title],{children:a,layer:l}=e,u=(l==null?void 0:l.type)!=="catalog-dynamic-group"&&_ze(e),c=!i&&oze(l),h=(l==null?void 0:l.type)==="group",m=!c&&!u&&t&&h,f=!!t&&"childrenSortable"in e&&e.childrenSortable&&mze(e);return u||m?K("calcite-list",{canPull:g=>!!this.canMove&&this.canMove(g,"pull"),canPut:g=>!!this.canMove&&this.canMove(g,"put"),"data-item":e,"data-layer-type":s,displayMode:n,dragEnabled:f,group:h?s:`${s}-${l==null?void 0:l.uid}`,key:`child-list-${l==null?void 0:l.uid}`,label:e.title,selectionAppearance:"border",selectionMode:r},a==null?void 0:a.filter(g=>!g.hidden&&(this.visibleElements.errors||!g.error)).toArray().map(g=>this._renderItem(g,e,o)),this._renderedTablesItem):null}get _hasTables(){var s,i;const{layerTablesEnabled:t}=this,e=this.item.layer;if(!t||!e)return!1;switch(e.type){case"knowledge-graph":return t.includes(e.type)&&"tables"in e&&!!((s=e.tables)!=null&&s.length);case"map-image":case"tile":return t.includes(e.type)&&"subtables"in e&&!!((i=e.subtables)!=null&&i.length);default:return!1}}get _renderedTablesItem(){const{item:t,messages:e,css:s}=this,{layer:i}=t;return"itemTableIcon"in s&&"visible"in t&&"tables"in e&&this._hasTables?K("calcite-list-item",{class:s.item,"data-layer-id":i==null?void 0:i.id,dragDisabled:!0,key:`list-item-table-list-tables-${i==null?void 0:i.uid}`,label:e.tables,title:e.tables,onCalciteListItemSelect:()=>this._triggerOnTablesOpen(t)},K("calcite-icon",{class:s.itemTableIcon,icon:"table",scale:"s",slot:"content-start"}),K("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"})):null}get _renderedItemMessage(){const{item:t,messages:e,css:s}=this;return t.error?K("div",{class:s.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},K("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},K("div",{slot:"message"},"tableError"in e?e.tableError:e.layerError))):"incompatible"in t&&t.incompatible&&"layerIncompatible"in e?K("div",{class:s.itemMessage,key:"esri-layer-list__incompatible",slot:"content-bottom"},K("calcite-notice",{afterCreate:this._setTooltipReference,afterRemoved:this._removeTooltipReference,bind:this,icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},K("div",{slot:"message"},e.layerIncompatible))):null}get _singleAction(){return this._renderAction({action:vze(this._filteredSections),textEnabled:!1})}get _filteredSections(){return this.item.actionsSections.map(t=>t.filter(e=>e.visible))}get _actionsCount(){return this.item.actionsSections.reduce((t,e)=>t+e.length,0)}_renderAction(t){const{item:e}=this,{action:s,textEnabled:i}=t;if(!s)return null;const{active:r,disabled:n,title:o,type:a,indicator:l}=s;return K("calcite-action",{active:a==="toggle"&&s.value,appearance:"transparent","data-action-id":s.id,disabled:n,icon:cK(s),indicator:l,key:`action-${s.uid}`,loading:r,onclick:()=>this._triggerAction(e,s),scale:"s",slot:i?void 0:"actions-end",text:o??"",textEnabled:i,title:o??void 0},this._renderFallbackIcon(s))}_renderFallbackIcon(t){const{css:e}=this,{className:s,icon:i}=t;if(i)return null;const r="image"in t?t.image:void 0,n={[e.itemActionIcon]:!!s,[e.itemActionImage]:!!r};return s&&(n[s]=!0),r||s?K("span",{"aria-hidden":"true",class:this.classes(e.itemActionIcon,n),key:"icon",styles:Dfe(r)}):null}_renderItem(t,e,s=[]){var i;return K(ZV,{activeItem:this.activeItem,canMove:this.canMove,css:this.css,displayMode:this.displayMode,dragEnabled:this.dragEnabled,item:t,key:`layerListItem-${(i=t.layer)==null?void 0:i.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:e,parentTitles:s,rootGroupUid:this.rootGroupUid,selectedDragItemLayerUid:this.selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this.onAction,onCatalogOpen:this.onCatalogOpen,onPanelOpen:this.onPanelOpen,onSelectedDragItemLayerUidChange:this.onSelectedDragItemLayerUidChange,onTablesOpen:this.onTablesOpen,onTooltipReferenceChange:this.onTooltipReferenceChange})}_triggerAction(t,e){e&&t&&(e.type==="toggle"&&(e.value=!e.value),this.onAction(e,t))}_triggerOnTablesOpen(t){t&&this.onTablesOpen&&this.onTablesOpen(t)}_triggerOnCatalogOpen(t){var e;t&&((e=this.onCatalogOpen)==null||e.call(this,t))}_focusSelectedDragEl(t,e){var s,i;this.selectedDragItemLayerUid===((s=e.layer)==null?void 0:s.uid)&&(tb(t),(i=this.onSelectedDragItemLayerUidChange)==null||i.call(this,null))}_handleCalciteListItemToggle(t,e){t.stopPropagation(),e.open=t.target.open}_getParentVisibilityMode(t){return t&&"visibilityMode"in t?t.visibilityMode:null}_handleCalciteListItemSelect(t,e,s){if(Pc(t.target)!==e)return;const i=this._getParentVisibilityMode(s);this.selectionMode==="none"&&i!=="inherited"&&this._toggleVisibility(e,s)}_togglePanel(t){t.open=!t.open,t.open&&this.onPanelOpen()}_toggleVisibility(t,e){!t||!("visible"in t)||this._getParentVisibilityMode(e)==="exclusive"&&t.visible||(t.visible=!t.visible)}};Ft.vnodeSelector="calcite-list-item",p([_()],Ft.prototype,"activeItem",void 0),p([_()],Ft.prototype,"canMove",void 0),p([_()],Ft.prototype,"css",void 0),p([_()],Ft.prototype,"displayMode",void 0),p([_()],Ft.prototype,"dragEnabled",void 0),p([_()],Ft.prototype,"item",void 0),p([_()],Ft.prototype,"layerTablesEnabled",void 0),p([_()],Ft.prototype,"listModeDisabled",void 0),p([_()],Ft.prototype,"messages",void 0),p([_()],Ft.prototype,"messagesCommon",void 0),p([_()],Ft.prototype,"onAction",void 0),p([_()],Ft.prototype,"onPanelOpen",void 0),p([_()],Ft.prototype,"onCatalogOpen",void 0),p([_()],Ft.prototype,"onTablesOpen",void 0),p([_()],Ft.prototype,"onSelectedDragItemLayerUidChange",void 0),p([_()],Ft.prototype,"onTooltipReferenceChange",void 0),p([_()],Ft.prototype,"parent",void 0),p([_()],Ft.prototype,"parentTitles",void 0),p([_()],Ft.prototype,"rootGroupUid",void 0),p([_()],Ft.prototype,"selectionMode",void 0),p([_()],Ft.prototype,"selectedItems",void 0),p([_()],Ft.prototype,"selectedDragItemLayerUid",void 0),p([_()],Ft.prototype,"visibleElements",void 0),p([_()],Ft.prototype,"visibilityAppearance",void 0),p([_()],Ft.prototype,"_title",null),p([_()],Ft.prototype,"_renderedItemStatus",null),p([_()],Ft.prototype,"_renderedItemTemporaryIcon",null),p([_()],Ft.prototype,"_renderedItemToggle",null),p([_()],Ft.prototype,"_renderedPanel",null),p([_()],Ft.prototype,"_renderedPanelAction",null),p([_()],Ft.prototype,"_renderedActions",null),p([_()],Ft.prototype,"_renderedActionMenu",null),p([_()],Ft.prototype,"_renderedActionMenuContent",null),p([_()],Ft.prototype,"_renderedCatalogFootprintIcon",null),p([_()],Ft.prototype,"_renderedCatalogDynamicIcon",null),p([_()],Ft.prototype,"_renderedCatalogSelectNode",null),p([_()],Ft.prototype,"_renderedChildList",null),p([_()],Ft.prototype,"_hasTables",null),p([_()],Ft.prototype,"_renderedTablesItem",null),p([_()],Ft.prototype,"_renderedItemMessage",null),p([_()],Ft.prototype,"_singleAction",null),p([_()],Ft.prototype,"_filteredSections",null),p([_()],Ft.prototype,"_actionsCount",null),Ft=ZV=p([Q("esri.widgets.LayerList.LayerListItem")],Ft);const bze=Ft;function dK(t){return t!=null&&typeof t=="object"&&t.type==="2d"&&t.view2dType==="linkchart"}function fU(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const s=e._delegatedEventNames,i=Array.isArray(t)?t:xze(t);s.push(...i)}}function xze(t){return t.split(",").map(e=>e.trim())}function P_(t){return t&&typeof t.render=="function"}function Ofe(t){return t&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}let io=class extends sh.IdentifiableMixin(Er){constructor(e,s){super(e,s),this._legend=null,this.className=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([Ee(()=>this._canCreateLegend,()=>this._createLegend(),ht),Ee(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),ht)])}destroy(){this._legend=ii(this._legend)}get _canCreateLegend(){const{content:e,listItem:s}=this;if(!s)return!1;const i="legend";return e===i||e!=null&&!!Array.isArray(e)&&e.includes(i)}get _legendOptions(){const{listItem:e,_legendLayerInfo:s}=this,i=e==null?void 0:e.view;return s&&i?{view:i,layerInfos:[s]}:{}}get _legendLayerInfo(){var o;const e=(o=this.listItem)==null?void 0:o.layer;if(!e||e.type==="subtype-sublayer")return null;const s=pU(e)?e:null,i=e==null?void 0:e.parent,r=i!=null&&"type"in i&&i.type==="map-image"?s==null?void 0:s.source:null,n="";return r&&i?{layer:i,title:n,sublayerIds:[r.mapLayerId]}:{layer:e,title:n}}get disabled(){var r;const{listItem:e,_legend:s,content:i}=this;return!e||!(Array.isArray(i)&&i.length>1)&&!!s&&(!((r=s.activeLayerInfos)!=null&&r.length)||!e.visibleAtCurrentScale||!e.visible)}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){const{image:e}=this,s=this._getFirstWidget();return this._get("icon")??(!e&&s?s.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){var e;return this._get("title")||(((e=this._getFirstWidget())==null?void 0:e.label)??"")}set title(e){this._override("title",e)}render(){return K("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){const{_legend:s,disabled:i,open:r}=this;return e&&!i&&r?e==="legend"&&s?K("div",{key:"legend-widget"},s.render()):typeof e=="string"?K("div",{innerHTML:e,key:e}):P_(e)?K("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?K("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){const{content:e,open:s}=this;return s?Array.isArray(e)?e.map(i=>this._renderContent(i)):this._renderContent(e):null}async _createLegend(){if(ii(this._legend),this._legend=null,!this._canCreateLegend)return;const{default:e}=await me(()=>import("./Legend-D9KzgpQS.js"),__vite__mapDeps([278,200,169,221,192,194,97,279])),s=new e(this._legendOptions);this._legend=s}_attachToNode(e){e.appendChild(this)}_updateLegend(){const e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return e==="legend"?this._legend:P_(e)?e:null}_getFirstWidget(){const{content:e}=this;return Array.isArray(e)?e.map(s=>this._getWidget(s)).find(s=>s):this._getWidget(e)}};p([_()],io.prototype,"_legend",void 0),p([_()],io.prototype,"_canCreateLegend",null),p([_()],io.prototype,"_legendOptions",null),p([_()],io.prototype,"_legendLayerInfo",null),p([_()],io.prototype,"className",void 0),p([_()],io.prototype,"content",void 0),p([_()],io.prototype,"disabled",null),p([_()],io.prototype,"flowEnabled",void 0),p([_()],io.prototype,"icon",null),p([_()],io.prototype,"image",void 0),p([_()],io.prototype,"listItem",void 0),p([_()],io.prototype,"open",void 0),p([_()],io.prototype,"title",null),p([_()],io.prototype,"visible",void 0),io=p([Q("esri.widgets.LayerList.ListItemPanel")],io);const Lfe=io;var aS;const wze=Ge.ofType({key:"type",defaultKeyValue:"button",base:JC,typeMap:{button:_0,toggle:f$}}),Vfe=Ge.ofType(wze),dO="layer",NI="child-list-mode",Sze="hide";let Xs=aS=class extends sh.IdentifiableMixin(Ye){constructor(t){super(t),this.actionsSections=new Vfe,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(Ge.ofType(aS)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.panel=null,this.parent=null,this.view=null}initialize(){if(this.addHandles([Ee(()=>{var t;return[this.layer,(t=this.layer)==null?void 0:t.listMode,this.listModeDisabled]},()=>this._watchLayerProperties(this.layer),ht),Ee(()=>this.checkPublishStatusEnabled,t=>this._updateChildrenPublishing(t),ht),Ee(()=>this.view,t=>this._updateChildrenView(t),ht),Ee(()=>this.panel,t=>this._setListItemOnPanel(t),ht)]),typeof this.listItemCreatedFunction=="function"){const t={item:this};this.listItemCreatedFunction.call(null,t)}}destroy(){var t;(t=this.panel)==null||t.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){const{layerView:t,publishing:e}=this;if(!e&&t&&"connectionStatus"in t)return t.connectionStatus}get error(){var t;return(t=this.layer)==null?void 0:t.loadError}get incompatible(){const{layerView:t}=this;return!(!t||!("spatialReferenceSupported"in t))&&!t.spatialReferenceSupported}get layerView(){const{layer:t,view:e}=this;if(!t||!e||t.type==="sublayer")return null;const s=t.type==="subtype-sublayer"?t.parent:t;return e.allLayerViews.find(i=>i.layer===s)??null}castPanel(t){var e;return(e=this.panel)!=null&&e.open&&!t.hasOwnProperty("open")&&(t.open=!0),t?new Lfe(t):null}get sortable(){var t;return((t=this.layer)==null?void 0:t.type)!=="knowledge-graph-sublayer"&&this._get("sortable")}set sortable(t){this._set("sortable",t)}get title(){const t=Xa(this,"layer.layer");return(!t||t&&Xa(this,"layer.layer.loaded"))&&Xa(this,"layer.title")||Xa(this,"layer.attributes.title")||""}set title(t){this._override("title",t)}get publishing(){var s;const{layer:t,checkPublishStatusEnabled:e}=this;return!!(e&&t&&"publishingInfo"in t&&((s=t.publishingInfo)==null?void 0:s.status)==="publishing")}get updating(){const{layerView:t,connectionStatus:e,layer:s,publishing:i}=this;return!i&&!e&&(t?t.updating:(s==null?void 0:s.loadStatus)==="loading"||!1)}get visible(){var t;return!!((t=this.layer)!=null&&t.visible)}set visible(t){const e=this.layer;e&&(e.visible=t)}get visibleAtCurrentScale(){var t,e;return((t=this.layerView)==null?void 0:t.visibleAtCurrentScale)??!pze(this.layer,(e=this.view)==null?void 0:e.scale)}get visibleAtCurrentTimeExtent(){var t;return((t=this.layerView)==null?void 0:t.visibleAtCurrentTimeExtent)??!0}get visibilityMode(){return uze(this.layer)}clone(){return new aS({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(t){t&&(t.listItem=this)}_updateChildrenPublishing(t){var e;(e=this.children)==null||e.forEach(s=>s.checkPublishStatusEnabled=t)}_updateChildrenView(t){const e=this.children;e&&e.forEach(s=>s.view=t)}_createChildren(t){const{listModeDisabled:e,children:s}=this,i=t.filter(r=>!s.some(n=>n.layer===r));s.addMany(this._createChildItems(i,e))}_destroyChildren(t){const{children:e}=this,s=e.filter(i=>!!i.layer&&!t.includes(i.layer));e.destroyMany(s)}_sortChildren(t){this.children.sort((e,s)=>t.indexOf(s.layer)-t.indexOf(e.layer))}_destroyAllChildren(){this.removeHandles(NI),this.children.destroyAll()}_watchChildLayerListMode(t){this.removeHandles(NI),this.listModeDisabled||this.addHandles(t.toArray().map(e=>Ee(()=>e.listMode,()=>this._compileChildren(t))),NI)}_compileChildren(t){const e=this.listModeDisabled?t:t==null?void 0:t.filter(s=>T3(s)!==Sze);t!=null&&t.length?(this._createChildren(e),this._destroyChildren(e),this._sortChildren(e),this._watchChildLayerListMode(t)):this._destroyAllChildren()}_watchSublayerChanges(t){t&&this.addHandles(t.on("change",()=>this._compileChildren(t)),dO)}_initializeChildLayers(t){this._compileChildren(t),this._watchSublayerChanges(t)}_createChildItems(t,e){return t.reverse().map(s=>e||dze(s)?new aS({layer:s,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(Qa)}_watchLayerProperties(t){if(this.removeHandles(dO),this.removeHandles(NI),!t)return;if((!this.listModeDisabled&&T3(t))==="hide-children")return void this.children.destroyAll();const e=Rfe(t);e&&this.addHandles(Ee(()=>t[e],s=>{t.hasOwnProperty(e)&&this._initializeChildLayers(s)},ht),dO)}};p([_({type:Vfe})],Xs.prototype,"actionsSections",void 0),p([_()],Xs.prototype,"actionsOpen",void 0),p([_()],Xs.prototype,"checkPublishStatusEnabled",void 0),p([_({type:Ge.ofType(Xs)})],Xs.prototype,"children",void 0),p([_()],Xs.prototype,"childrenSortable",void 0),p([_({readOnly:!0})],Xs.prototype,"connectionStatus",null),p([_({readOnly:!0})],Xs.prototype,"error",null),p([_()],Xs.prototype,"hidden",void 0),p([_({readOnly:!0})],Xs.prototype,"incompatible",null),p([_()],Xs.prototype,"layer",void 0),p([_({readOnly:!0})],Xs.prototype,"layerView",null),p([_()],Xs.prototype,"listItemCreatedFunction",void 0),p([_({nonNullable:!0})],Xs.prototype,"listModeDisabled",void 0),p([_()],Xs.prototype,"open",void 0),p([_({type:Lfe})],Xs.prototype,"panel",void 0),p([Ht("panel")],Xs.prototype,"castPanel",null),p([_()],Xs.prototype,"parent",void 0),p([_({value:!0})],Xs.prototype,"sortable",null),p([_()],Xs.prototype,"title",null),p([_({readOnly:!0})],Xs.prototype,"publishing",null),p([_({readOnly:!0})],Xs.prototype,"updating",null),p([_()],Xs.prototype,"view",void 0),p([_()],Xs.prototype,"visible",null),p([_({readOnly:!0})],Xs.prototype,"visibleAtCurrentScale",null),p([_({readOnly:!0})],Xs.prototype,"visibleAtCurrentTimeExtent",null),p([_({readOnly:!0})],Xs.prototype,"visibilityMode",null),Xs=aS=p([Q("esri.widgets.LayerList.ListItem")],Xs);const gU=Xs,oc={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},Eze="hide",qfe=Ge.ofType(gU);let Ch=class extends Wl.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new qfe,this.view=null}initialize(){this.addHandles([Ee(()=>{var e;return((e=this.view)==null?void 0:e.ready)===!0},()=>this._viewHandles(),ht),Ee(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList()),Ee(()=>dK(this.view)?this.view.inGeographicLayout:null,()=>this._compileList())],oc.view)}destroy(){this._removeAllItems(),this.view=null}get state(){const{view:e}=this;return e!=null&&e.ready?"ready":e?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(e=>e.children).length}triggerAction(e,s){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:s})}moveListItem(e,s,i,r){var f,g;const n=e==null?void 0:e.layer;if(!n||n.type==="subtype-sublayer"||n.type==="sublayer")return;const o=(g=(f=this.view)==null?void 0:f.map)==null?void 0:g.layers,a=s?hK(s):o,l=i?hK(i):o;if(!a||!l)return;const{operationalItems:u}=this,c=(s==null?void 0:s.children)||u,h=(i==null?void 0:i.children)||u,m=l.length-r;e.parent=i||null,c.remove(e),a.remove(n),h.includes(e)||h.add(e,m),l.includes(n)||l.add(n,m),this._compileList()}_createLayerViewHandles(e){this.removeHandles(oc.layerViews),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),oc.layerViews)}_createMapLayerHandles(e){this.removeHandles(oc.mapLayers),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),oc.mapLayers)}_createListItem(e){const{view:s,listItemCreatedFunction:i,checkPublishStatusEnabled:r,listModeDisabled:n}=this;return new gU({checkPublishStatusEnabled:r,listModeDisabled:n,layer:e,listItemCreatedFunction:i,view:s})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(s=>T3(s)!==Eze):void 0}_watchLayersListMode(e){this.removeHandles(oc.layerListMode),e&&!this.listModeDisabled&&this.addHandles(Ee(()=>e.filter(s=>"listMode"in s).map(s=>s.listMode).toArray(),()=>this._compileList()),oc.layerListMode)}_compileList(){var r,n;const e=(n=(r=this.view)==null?void 0:r.map)==null?void 0:n.layers,s=dK(this.view)&&!this.view.inGeographicLayout?e==null?void 0:e.filter(({type:o})=>o==="link-chart"):e;this._watchLayersListMode(s);const i=this._getViewableLayers(s);i!=null&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createNewItems(e){const{operationalItems:s}=this;e.forEach(i=>{s.some(r=>r.layer===i)||s.add(this._createListItem(i))})}_removeItems(e){const{operationalItems:s}=this,i=[];s.forEach(r=>{r&&e&&e.includes(r.layer)||i.push(r)}),s.destroyMany(i)}_sortItems(e){const{operationalItems:s}=this;s.sort((i,r)=>{const n=e.indexOf(i.layer),o=e.indexOf(r.layer);return n>o?-1:n<o?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([oc.mapLayers,oc.layerViews,oc.viewLayers]),e!=null&&e.ready?this.addHandles([Ee(()=>{var s,i;return(i=(s=this.view)==null?void 0:s.map)==null?void 0:i.allLayers},s=>this._createMapLayerHandles(s),ht),Ee(()=>{var s;return(s=this.view)==null?void 0:s.allLayerViews},s=>this._createLayerViewHandles(s),ht)],oc.viewLayers):this._removeAllItems()}};p([_()],Ch.prototype,"checkPublishStatusEnabled",void 0),p([_()],Ch.prototype,"listItemCreatedFunction",void 0),p([_({nonNullable:!0})],Ch.prototype,"listModeDisabled",void 0),p([_({type:qfe})],Ch.prototype,"operationalItems",void 0),p([_({readOnly:!0})],Ch.prototype,"state",null),p([_()],Ch.prototype,"totalItems",null),p([_()],Ch.prototype,"view",void 0),Ch=p([Q("esri.widgets.LayerList.LayerListViewModel")],Ch);const Gfe=Ch;let xu=class extends Ye{constructor(){super(...arguments),this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};p([_({type:Boolean,nonNullable:!0})],xu.prototype,"catalogLayerList",void 0),p([_({type:Boolean,nonNullable:!0})],xu.prototype,"closeButton",void 0),p([_({type:Boolean,nonNullable:!0})],xu.prototype,"collapseButton",void 0),p([_({type:Boolean,nonNullable:!0})],xu.prototype,"errors",void 0),p([_({type:Boolean,nonNullable:!0})],xu.prototype,"filter",void 0),p([_({type:Boolean,nonNullable:!0})],xu.prototype,"flow",void 0),p([_({type:Boolean,nonNullable:!0})],xu.prototype,"heading",void 0),p([_({type:Boolean,nonNullable:!0})],xu.prototype,"statusIndicators",void 0),p([_({type:Boolean,nonNullable:!0})],xu.prototype,"temporaryLayerIndicators",void 0),xu=p([Q("esri.widgets.LayerList.LayerListVisibleElements")],xu);const zfe=xu,Cze=["label","description","metadata"],Pze=Ge.ofType(gU),pK="nested";let Ot=class extends sh.IdentifiableMixin(Er){constructor(e,s){super(e,s),this._rootListEl=null,this._activeItem=null,this._tooltipReferenceMap=new E_,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusLayerFlowItem=null,this._layerListMap=new E_,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid=`operational-${this.uid}`,this._openedLayersController=null,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterPredicate=null,this.filterText="",this.headingLevel=2,this.knowledgeGraphOptions=null,this.layerTablesEnabled=new Ge(["knowledge-graph"]),this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.mapImageOptions=null,this.messages=null,this.messagesCommon=null,this.minDragEnabledItems=ize,this.minFilterItems=sze,this.openedLayers=new Ge,this.openedLayerLists=new Ge,this.selectedItems=new Pze,this.selectionMode="none",this.tableList=null,this.tileOptions=null,this.viewModel=new Gfe,this.visibilityAppearance="default",this.visibleElements=new zfe,this._canMove=({dragEl:i,fromEl:r,toEl:n},o)=>{var I,A,D;const a=o==="pull"?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,l=Pc(i);if(!(l!=null&&l.sortable))return!1;const u=Pc(r),c=mK(r),h=Pc(n),m=mK(n),f=!!c&&!!m&&c===m,g={selected:l,from:u,to:h},v=r.group,b=n.group,w=((I=u==null?void 0:u.layer)==null?void 0:I.type)??"",S=((A=h==null?void 0:h.layer)==null?void 0:A.type)??"",T=new Set(["map-image","catalog","knowledge-graph"]);return v&&b&&typeof a=="function"?a.call(null,g):f&&!T.has(w)&&!T.has(S)&&((D=l==null?void 0:l.layer)==null?void 0:D.type)!=="sublayer"},this._onCatalogOpen=i=>{var r,n;this.openedLayers.push((r=i.layer)==null?void 0:r.parent),this._focusLayerFlowItem=(n=i.layer)==null?void 0:n.uid},this._onTablesOpen=i=>{var r;this.openedLayers.push(i.layer),this._focusLayerFlowItem=(r=i.layer)==null?void 0:r.uid},this._onPanelOpen=()=>{this._focusPanelFlowItem=!0},this._onTooltipReferenceChange=(i,r)=>{r?this._tooltipReferenceMap.set(i,r):this._tooltipReferenceMap.delete(i)},this._onSelectedDragItemLayerUidChange=i=>{this._selectedDragItemLayerUid=i},this._onTriggerAction=(i,r)=>{this.triggerAction(i,r)},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=i=>{if(this.visibilityAppearance!=="default")return;const r=Array.from(i.composedPath()).find(n=>{var o;return(o=n.classList)==null?void 0:o.contains(e2.item)});this._activeItem=Pc(r)},this._onCalciteListOrderChange=i=>{const{_lastDragDetail:r}=this,{toEl:n,fromEl:o,dragEl:a,newIndex:l}=i;if(o&&n&&!((r==null?void 0:r.newIndex)===l&&(r==null?void 0:r.dragEl)===a&&(r==null?void 0:r.toEl)===n&&(r==null?void 0:r.fromEl)===o))if(this._lastDragDetail=i,this._selectedDragItemLayerUid=a.value,o!==n)this._moveLayerFromChildList({toEl:n,fromEl:o,dragEl:a,newIndex:l});else{const u=Array.from(o.children).filter(c=>c==null?void 0:c.matches("calcite-list-item")).map(c=>c.value);this._sortLayers(o,u)}}}initialize(){this.addHandles([Vo(()=>this.openedLayers,"change",()=>this._handleOpenedLayersChange(),ht),Vo(()=>this.viewModel.operationalItems,"change",()=>cze(this.selectedItems),ht),Ee(()=>[this.filterPredicate,this._rootListEl],()=>hze(this._rootListEl,this.filterPredicate))])}loadDependencies(){return sl({button:()=>me(()=>import("./index-CmPXJs7R.js"),__vite__mapDeps([239,240,241,242,243,244,245,246,247,248,249,250,251])),flow:()=>me(()=>import("./index-5r6cdDcQ.js"),__vite__mapDeps([280,246,245,251,244,241])),"flow-item":()=>me(()=>import("./index-BcyHfZZl.js"),__vite__mapDeps([281,240,241,242,243,244,245,253,254,246,249,251,255,256,257,258,247,259,260,261,262,263,273,282])),list:()=>me(()=>import("./index-kzOfcToX.js"),__vite__mapDeps([272,240,241,242,273,246,245,244,254,243,274,275,276,247,248,249,261,250,251,257,270])),notice:()=>me(()=>import("./index-DW-iT0Or.js"),__vite__mapDeps([277,243,244,241,245,246,251,258,242])),tooltip:()=>me(()=>import("./index-B2sPZsbm.js"),__vite__mapDeps([283,246,256,244,241,257,258,259,254]))})}destroy(){this._destroyOpenedLayerLists(),this._tooltipReferenceMap.clear()}get _totalItems(){return this.viewModel.operationalItems.flatten(e=>e.children.filter(s=>{var i;return((i=s.layer)==null?void 0:i.type)!=="catalog-dynamic-group"})).length}get _visibleItems(){var e;return(e=this.operationalItems)==null?void 0:e.filter(s=>!s.hidden&&(this.visibleElements.errors||!s.error))}get _openedPanelItems(){return this._visibleItems.flatten(e=>e.children).filter(({hidden:e,panel:s})=>!e&&(s==null?void 0:s.open)&&!s.disabled&&s.flowEnabled)}get _dragEnabled(){return this._totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this._totalItems>=this.minFilterItems&&this.visibleElements.filter}get _renderedOpenLayerFlowItems(){const{openedLayers:e}=this;return e.toArray().map((s,i)=>this._renderLayerFlowItem(s,i===e.length-1))}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,s){return this.viewModel.triggerAction(e,s)}render(){var r;const e=(r=this.viewModel)==null?void 0:r.state,{_visibleItems:s}=this,i={[vt.hidden]:e==="loading",[vt.disabled]:e==="disabled"};return K("div",{class:this.classes(e2.base,vt.widget,vt.panel,i)},s!=null&&s.length?[this._renderItemTooltips(),this._renderItems()]:this._renderNoItems())}async _createFlowList(e,s){const{_layerListMap:i}=this,r=i.get(e);if(r)return r;const n=e.type==="catalog"?await this._createCatalogLayerList(e):await this._createTableList(e);return s.aborted||i.set(e,n),n}async _handleOpenedLayersChange(){var l;const{_layerListMap:e,openedLayers:s,openedLayerLists:i}=this;(l=this._openedLayersController)==null||l.abort();const r=new AbortController,{signal:n}=r;this._openedLayersController=r,e.forEach((u,c)=>{s.includes(c)||(u.destroy(),e.delete(c))});const o=await Promise.all(s.map(u=>this._createFlowList(u,n)));if(n.aborted)return;i.removeAll(),i.addMany(o);const a=i.at(-1);a?"catalogLayer"in a?(this._set("catalogLayerList",a),this._set("tableList",null)):(this._set("catalogLayerList",null),this._set("tableList",a)):(this._set("catalogLayerList",null),this._set("tableList",null))}_destroyOpenedLayerLists(){this.openedLayerLists.destroyAll(),this.openedLayers.removeAll(),this._layerListMap.clear()}_renderItemTooltip(e){var r,n;const{_tooltipReferenceMap:s,messages:i}=this;return e?K("calcite-tooltip",{key:`tooltip-${(r=e.layer)==null?void 0:r.uid}`,overlayPositioning:"fixed",referenceElement:s.get((n=e.layer)==null?void 0:n.uid)},i.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){var s;return e.incompatible?this._renderItemTooltip(e):(s=e.children)==null?void 0:s.filter(i=>!i.hidden).toArray().map(i=>this._renderItemTooltipNodes(i))}_renderItemTooltips(){var e;return(e=this._visibleItems)==null?void 0:e.toArray().map(s=>this._renderItemTooltipNodes(s))}_renderNoItemsMessage(){return K("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return K("div",{class:e2.itemMessage,key:"esri-layer-list__no-items"},K("calcite-notice",{icon:"information",kind:"info",open:!0,width:"full"},this._renderNoItemsMessage()))}async _createCatalogLayerList(e){const{default:s}=await me(()=>import("./CatalogLayerList-pM-V8Eie.js"),[]),{headingLevel:i,catalogOptions:r,view:n,filterPlaceholder:o,listItemCreatedFunction:a,minFilterItems:l,selectionMode:u,visibilityAppearance:c,_onCatalogOpen:h,_onTablesOpen:m,layerTablesEnabled:f}=this;return new s({headingLevel:i,view:n,filterPlaceholder:o,listItemCreatedFunction:a,minFilterItems:l,selectionMode:u,visibilityAppearance:c,...r,catalogLayer:e,layerTablesEnabled:f,onCatalogOpen:h,onTablesOpen:m})}_getTableListParams(e){switch(e.type){case"knowledge-graph":return{...this.knowledgeGraphOptions,tables:e.tables};case"map-image":return{...this.mapImageOptions,tables:e.subtables};case"tile":return{...this.tileOptions,tables:e.subtables};default:return null}}async _createTableList(e){const{default:s}=await me(()=>import("./TableList-DyM68_Tk.js"),[]),{headingLevel:i,selectionMode:r,dragEnabled:n}=this;return new s({headingLevel:i,selectionMode:r,dragEnabled:n,...this._getTableListParams(e)})}_renderLayerFlowItem(e,s){var o;const{messages:i,openedLayers:r}=this,n=e.title||this.messages.untitledLayer;return K("calcite-flow-item",{afterCreate:this._focusLayerFlowItemNode,afterUpdate:this._focusLayerFlowItemNode,bind:this,"data-layer-uid":e.uid,description:n,heading:i[e.type==="catalog"?"catalogLayers":"tables"],headingLevel:this.headingLevel,key:`flow-layer-list-${e.uid}`,selected:s,onCalciteFlowItemBack:a=>{a.preventDefault(),r.pop();const l=r.at(-1);l?this._focusLayerFlowItem=l.uid:this._focusRootFlowItem=!0}},(o=this._layerListMap.get(e))==null?void 0:o.render())}_renderPanelFlowItems(){const{_openedPanelItems:e,openedLayers:s}=this;return e.toArray().map(({title:i,panel:r},n)=>{const o=()=>this._handlePanelFlowItemBack(r);return K("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:i,heading:r.title,headingLevel:this.headingLevel,key:`flow-panel-${r.uid}`,selected:!s.length&&n===e.length-1,onCalciteFlowItemBack:a=>{a.preventDefault(),o()}},r.render(),K("calcite-button",{appearance:"transparent",onclick:o,slot:"footer-actions",width:"full"},this.messagesCommon.back))})}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,tb(e))}_focusLayerFlowItemNode(e){this._focusLayerFlowItem===e.dataset.layerUid&&(this._focusLayerFlowItem=null,tb(e))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,tb(e))}_renderItems(){const{visible:e,collapsed:s,_visibleItems:i,_openedPanelItems:r,_filterEnabled:n,_rootGroupUid:o,visibleElements:{closeButton:a,collapseButton:l,heading:u,flow:c},_dragEnabled:h,selectionMode:m,filterText:f,openedLayers:g,filterPlaceholder:v,messages:b}=this,w=[K("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:a,closed:!e,collapsed:s,collapsible:l,heading:u?b.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",selected:!g.length&&!r.length,onCalciteFlowItemClose:()=>this.visible=!1},K("calcite-list",{afterCreate:S=>{this._rootListEl=S,S.addEventListener("focusin",this._setActiveItem),S.addEventListener("focusout",this._clearActiveItem)},afterRemoved:S=>{this._rootListEl=null,S.removeEventListener("focusin",this._setActiveItem),S.removeEventListener("focusout",this._clearActiveItem)},canPull:S=>this._canMove(S,"pull"),canPut:S=>this._canMove(S,"put"),"data-layer-type":o,displayMode:pK,dragEnabled:h,filterEnabled:n,filterPlaceholder:v,filterProps:Cze,filterText:n?f:"",group:o,key:"root-list",label:b.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:m,onCalciteListChange:S=>this._handleCalciteListChange(S),onCalciteListDragEnd:S=>this._handleCalciteListDragEnd(S.detail),onCalciteListFilter:S=>{var T;return this.filterText=((T=S.currentTarget)==null?void 0:T.filterText)??""},onCalciteListOrderChange:S=>this._onCalciteListOrderChange(S.detail)},i==null?void 0:i.toArray().map(S=>this._renderItem(S)),i!=null&&i.length&&n?K("div",{class:e2.filterNoResults,slot:"filter-no-results"},K("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(),this._renderedOpenLayerFlowItems];return e?c?K("calcite-flow",{key:"root-flow"},w):w:null}_renderItem(e,s,i){var r;return K(bze,{activeItem:this._activeItem,canMove:this._canMove,css:e2,displayMode:pK,dragEnabled:this.dragEnabled,item:e,key:`layerListItem-${(r=e.layer)==null?void 0:r.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.viewModel.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:s,parentTitles:i,rootGroupUid:this._rootGroupUid,selectedDragItemLayerUid:this._selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onCatalogOpen:this._onCatalogOpen,onPanelOpen:this._onPanelOpen,onSelectedDragItemLayerUidChange:this._onSelectedDragItemLayerUidChange,onTablesOpen:this._onTablesOpen,onTooltipReferenceChange:this._onTooltipReferenceChange})}_moveLayerFromChildList({toEl:e,fromEl:s,dragEl:i,newIndex:r}){const n=Pc(i),o=Pc(e),a=Pc(s);this.viewModel.moveListItem(n,a,o,r)}_handleCalciteListDragEnd(e){const{fromEl:s,dragEl:i,oldIndex:r}=e;s.insertBefore(i,s.children[r])}_sortLayers(e,s){var i,r;if(e)if(e===this._rootListEl)kfe((r=(i=this.view)==null?void 0:i.map)==null?void 0:r.layers,s);else{const n=Pc(e);if(!n)return;fze(n,s)}}_handleCalciteListChange(e){const{selectionMode:s,selectedItems:i}=this;if(s==="none")return;const r=e.target.selectedItems.map(n=>Pc(n)).filter(Boolean);i.removeAll(),i.addMany(r)}};p([_()],Ot.prototype,"_rootListEl",void 0),p([_()],Ot.prototype,"_activeItem",void 0),p([_()],Ot.prototype,"_tooltipReferenceMap",void 0),p([_()],Ot.prototype,"_focusRootFlowItem",void 0),p([_()],Ot.prototype,"_focusPanelFlowItem",void 0),p([_()],Ot.prototype,"_focusLayerFlowItem",void 0),p([_()],Ot.prototype,"_layerListMap",void 0),p([_()],Ot.prototype,"_totalItems",null),p([_()],Ot.prototype,"_visibleItems",null),p([_()],Ot.prototype,"_openedPanelItems",null),p([_()],Ot.prototype,"_dragEnabled",null),p([_()],Ot.prototype,"_filterEnabled",null),p([_()],Ot.prototype,"_renderedOpenLayerFlowItems",null),p([_({readOnly:!0})],Ot.prototype,"catalogLayerList",void 0),p([_()],Ot.prototype,"catalogOptions",void 0),p([_()],Ot.prototype,"collapsed",void 0),p([_()],Ot.prototype,"dragEnabled",void 0),p([_()],Ot.prototype,"filterPlaceholder",void 0),p([_()],Ot.prototype,"filterPredicate",void 0),p([_()],Ot.prototype,"filterText",void 0),p([_()],Ot.prototype,"headingLevel",void 0),p([_()],Ot.prototype,"icon",null),p([_()],Ot.prototype,"knowledgeGraphOptions",void 0),p([_()],Ot.prototype,"label",null),p([_()],Ot.prototype,"layerTablesEnabled",void 0),p([_()],Ot.prototype,"listItemCanGiveFunction",void 0),p([_()],Ot.prototype,"listItemCanReceiveFunction",void 0),p([_()],Ot.prototype,"listItemCreatedFunction",null),p([_()],Ot.prototype,"mapImageOptions",void 0),p([_(),ur("esri/widgets/LayerList/t9n/LayerList")],Ot.prototype,"messages",void 0),p([_(),ur("esri/t9n/common")],Ot.prototype,"messagesCommon",void 0),p([_()],Ot.prototype,"minDragEnabledItems",void 0),p([_()],Ot.prototype,"minFilterItems",void 0),p([_({readOnly:!0})],Ot.prototype,"openedLayers",void 0),p([_({readOnly:!0})],Ot.prototype,"openedLayerLists",void 0),p([_()],Ot.prototype,"operationalItems",null),p([_()],Ot.prototype,"selectedItems",void 0),p([_()],Ot.prototype,"selectionMode",void 0),p([_({readOnly:!0})],Ot.prototype,"tableList",void 0),p([_()],Ot.prototype,"tileOptions",void 0),p([_()],Ot.prototype,"view",null),p([fU("trigger-action"),_({type:Gfe})],Ot.prototype,"viewModel",void 0),p([_()],Ot.prototype,"visibilityAppearance",void 0),p([_({type:zfe,nonNullable:!0})],Ot.prototype,"visibleElements",void 0),Ot=p([Q("esri.widgets.LayerList")],Ot);const Tze=Ot;let Ize=class Ufe{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(XL),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const s=new Ufe,i=this._originStores[Xt.DEFAULTS];i&&i.forEach((r,n)=>{s.set(n,he(r),Xt.DEFAULTS)});for(let r=Xt.SERVICE;r<XL;r++){const n=this._originStores[r];n&&n.forEach((o,a)=>{e&&e.has(a)||s.set(a,he(o),r)})}return s}get(e,s){const i=s===void 0?this._values:this._originStores[s];return i?i.get(e):void 0}keys(e){const s=e==null?this._values:this._originStores[e];return s?[...s.keys()]:[]}set(e,s,i=Xt.USER){let r=this._originStores[i];if(r||(r=new Map,this._originStores[i]=r),r.set(e,s),!this._values.has(e)||this._propertyOriginMap.get(e)<=i){const n=this._values.get(e);return this._values.set(e,s),this._propertyOriginMap.set(e,i),n!==s}return!1}delete(e,s=Xt.USER){const i=this._originStores[s];if(!i)return;const r=i.get(e);if(i.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===s){this._values.delete(e);for(let n=s-1;n>=0;n--){const o=this._originStores[n];if(o&&o.has(e)){this._values.set(e,o.get(e)),this._propertyOriginMap.set(e,n);break}}}return r}has(e,s){const i=s===void 0?this._values:this._originStores[s];return!!i&&i.has(e)}revert(e,s){for(;s>0&&!this.has(e,s);)--s;const i=this._originStores[s],r=i==null?void 0:i.get(e),n=this._values.get(e);return this._values.set(e,r),this._propertyOriginMap.set(e,s),n!==r}originOf(e){return this._propertyOriginMap.get(e)||Xt.DEFAULTS}forEach(e){this._values.forEach(e)}};const Bfe=t=>{let e=class extends t{constructor(...s){super(...s);const i=Ja(this),r=i.store,n=new Ize;i.store=n,Dae(i,r,n)}read(s,i){Rae(this,s,i)}getAtOrigin(s,i){const r=pO(this),n=Tf(i);if(typeof s=="string")return r.get(s,n);const o={};return s.forEach(a=>{o[a]=r.get(a,n)}),o}originOf(s){return TN(this.originIdOf(s))}originIdOf(s){return pO(this).originOf(s)}revert(s,i){const r=pO(this),n=Tf(i),o=Ja(this);let a;a=typeof s=="string"?s==="*"?r.keys(n):[s]:s,a.forEach(l=>{o.invalidate(l),r.revert(l,n),o.commit(l)})}};return e=p([Q("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function pO(t){return Ja(t).store}let fK=class extends Bfe(Ye){};fK=p([Q("esri.core.ReadOnlyMultiOriginJSONSupport")],fK);const Mze=t=>{let e=class extends t{constructor(...s){super(...s)}clear(s,i="user"){return fO(this).delete(s,Tf(i))}write(s,i){return Fae(this,s=s||{},i),s}setAtOrigin(s,i,r){Ja(this).setAtOrigin(s,i,Tf(r))}removeOrigin(s){const i=fO(this),r=Tf(s),n=i.keys(r);for(const o of n)i.originOf(o)===r&&i.set(o,i.get(o,r),Xt.USER)}updateOrigin(s,i){const r=fO(this),n=Tf(i),o=Xa(this,s);for(let a=n+1;a<XL;++a)r.delete(s,a);r.set(s,o,n)}toJSON(s){return this.write({},s)}};return e=p([Q("esri.core.MultiOriginJSONSupport.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function fO(t){return Ja(t).store}const yU=t=>{let e=class extends Mze(Bfe(t)){constructor(...s){super(...s)}};return e=p([Q("esri.core.MultiOriginJSONSupport")],e),e};let gK=class extends yU(Ye){};gK=p([Q("esri.core.MultiOriginJSONSupport")],gK);const Aze={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsCurrentUser:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsReturnMesh:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0,supportsTrueCurve:!1},Nze={supportsDate:!0,supportsFixedInterval:!0,supportsAutoInterval:!0,supportsFixedBoundaries:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsSnapToData:!1,supportsReturnFullIntervalBin:!1,supportsFirstDayOfWeek:!1,supportsNormalization:!0,supportedStatistics:{count:!0,sum:!0,avg:!0,var:!0,stddev:!0,min:!0,max:!0,percentileContinuous:!0,percentileDiscrete:!0,envelope:!0,centroid:!0,convexHull:!0},supportedNormalizationTypes:{field:!0,log:!0,naturalLog:!0,percentOfTotal:!0,squareRoot:!0}},_U=[252,146,31,255],Dze=[153,153,153,255],jfe={type:"esriSMS",style:"esriSMSCircle",size:6,color:_U,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},Hfe={type:"esriSLS",style:"esriSLSSolid",width:.75,color:_U},Yfe={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},$ze={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},Rze={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},kze={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},Fze={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};function Yyt(t){return{renderer:{type:"simple",symbol:t==="esriGeometryPoint"||t==="esriGeometryMultipoint"?jfe:t==="esriGeometryPolyline"?Hfe:Yfe}}}const Oze=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let Lze=1;function Xyt(t,e){if(ge("esri-csp-restrictions"))return()=>({[e]:null,...t});try{let s=`this${yK(e)} = null;`;for(const r in t)s+=`this${yK(r)} = ${JSON.stringify(t[r])};`;const i=new Function(`
      return class AttributesClass$${Lze++} {
        constructor() {
          ${s};
        }
      }
    `)();return()=>new i}catch{return()=>({[e]:null,...t})}}function yK(t){return Oze.test(t)?`.${t}`:`["${t}"]`}function Wyt(t={}){return[{name:"New Feature",description:"",prototype:{attributes:he(t)}}]}function Vze(t,e){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:t},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:e,supportsDelete:e,supportsEditing:e,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:e,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:Aze,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:Nze,editing:{supportsGeometryUpdate:e,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}var QV;const JV=new Jt({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let Nn=QV=class extends Te{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){return this.readFeaturesWithClass(t,e,tn)}writeGeometryType(t,e,s,i){if(t)return void JV.write(t,e,s,i);const{features:r}=this;if(r){for(const n of r)if((n==null?void 0:n.geometry)!=null)return void JV.write(n.geometry.type,e,s,i)}}readQueryGeometry(t,e){if(!t)return null;const s=!!t.spatialReference,i=Y_(t);return i&&!s&&e.spatialReference&&(i.spatialReference=St.fromJSON(e.spatialReference)),i}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:s}=this;if(s){for(const i of s)if(i&&i.geometry!=null&&i.geometry.spatialReference)return void(e.spatialReference=i.geometry.spatialReference.toJSON())}}clone(){return new QV(this.cloneProperties())}cloneProperties(){return he({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let s=0;s<e.features.length;s++){const i=e.features[s];if(i.geometry){const r=t==null?void 0:t[s];i.geometry=(r==null?void 0:r.toJSON())||i.geometry}}return e}quantize(t){const{scale:[e,s],translate:[i,r]}=t,n=u=>Math.round((u-i)/e),o=u=>Math.round((r-u)/s),a=this.features,l=this._getQuantizationFunction(this.geometryType,n,o);for(let u=0,c=a.length;u<c;u++)l!=null&&l(a[u].geometry)||(a.splice(u,1),u--,c--);return this.transform=t,this}unquantize(){var m,f;const{geometryType:t,features:e,transform:s}=this;if(!s)return this;const{translate:[i,r],scale:[n,o]}=s,a=g=>g*n+i,l=g=>r-g*o;let u=null,c=null;if(this.hasZ&&((m=s==null?void 0:s.scale)==null?void 0:m[2])!=null){const{translate:[,,g],scale:[,,v]}=s;u=b=>b*v+g}if(this.hasM&&((f=s==null?void 0:s.scale)==null?void 0:f[3])!=null){const{translate:[,,,g],scale:[,,,v]}=s;c=b=>b==null?b:b*v+g}const h=this._getHydrationFunction(t,a,l,u,c);for(const{geometry:g}of e)g!=null&&h&&h(g);return this.transform=null,this}readFeaturesWithClass(t,e,s){var n;const i=St.fromJSON(e.spatialReference),r=[];for(let o=0;o<t.length;o++){const a=t[o],l=s.fromJSON(a),u=(n=a.geometry)==null?void 0:n.spatialReference;l.geometry==null||u||(l.geometry.spatialReference=i);const c=a.aggregateGeometries,h=l.aggregateGeometries;if(c&&h!=null)for(const m in h){const f=h[m],g=c[m],v=g==null?void 0:g.spatialReference;f==null||v||(f.spatialReference=i)}r.push(l)}return r}_quantizePoints(t,e,s){let i,r;const n=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];if(o>0){const u=e(l[0]),c=s(l[1]);u===i&&c===r||(n.push([u-i,c-r]),i=u,r=c)}else i=e(l[0]),r=s(l[1]),n.push([i,r])}return n.length>0?n:null}_getQuantizationFunction(t,e,s){return t==="point"?i=>(i.x=e(i.x),i.y=s(i.y),i):t==="polyline"||t==="polygon"?i=>{const r=v_(i)?i.rings:i.paths,n=[];for(let o=0,a=r.length;o<a;o++){const l=r[o],u=this._quantizePoints(l,e,s);u&&n.push(u)}return n.length>0?(v_(i)?i.rings=n:i.paths=n,i):null}:t==="multipoint"?i=>{const r=this._quantizePoints(i.points,e,s);return r&&r.length>0?(i.points=r,i):null}:t==="extent"?i=>i:null}_getHydrationFunction(t,e,s,i,r){return t==="point"?n=>{n.x=e(n.x),n.y=s(n.y),i&&(n.z=i(n.z))}:t==="polyline"||t==="polygon"?n=>{const o=v_(n)?n.rings:n.paths;let a,l;for(let u=0,c=o.length;u<c;u++){const h=o[u];for(let m=0,f=h.length;m<f;m++){const g=h[m];m>0?(a+=g[0],l+=g[1]):(a=g[0],l=g[1]),g[0]=e(a),g[1]=s(l)}}if(i&&r)for(let u=0,c=o.length;u<c;u++){const h=o[u];for(let m=0,f=h.length;m<f;m++){const g=h[m];g[2]=i(g[2]),g[3]=r(g[3])}}else if(i)for(let u=0,c=o.length;u<c;u++){const h=o[u];for(let m=0,f=h.length;m<f;m++){const g=h[m];g[2]=i(g[2])}}else if(r)for(let u=0,c=o.length;u<c;u++){const h=o[u];for(let m=0,f=h.length;m<f;m++){const g=h[m];g[2]=r(g[2])}}}:t==="extent"?n=>{n.xmin=e(n.xmin),n.ymin=s(n.ymin),n.xmax=e(n.xmax),n.ymax=s(n.ymax),i&&n.zmax!=null&&n.zmin!=null&&(n.zmax=i(n.zmax),n.zmin=i(n.zmin)),r&&n.mmax!=null&&n.mmin!=null&&(n.mmax=r(n.mmax),n.mmin=r(n.mmin))}:t==="multipoint"?n=>{const o=n.points;let a,l;for(let u=0,c=o.length;u<c;u++){const h=o[u];u>0?(a+=h[0],l+=h[1]):(a=h[0],l=h[1]),h[0]=e(a),h[1]=s(l)}if(i&&r)for(let u=0,c=o.length;u<c;u++){const h=o[u];h[2]=i(h[2]),h[3]=r(h[3])}else if(i)for(let u=0,c=o.length;u<c;u++){const h=o[u];h[2]=i(h[2])}else if(r)for(let u=0,c=o.length;u<c;u++){const h=o[u];h[2]=r(h[2])}}:null}};p([_({type:String,json:{write:!0}})],Nn.prototype,"displayFieldName",void 0),p([_({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Nn.prototype,"exceededTransferLimit",void 0),p([_({type:[tn],json:{write:!0}})],Nn.prototype,"features",void 0),p([qe("features")],Nn.prototype,"readFeatures",null),p([_({type:[oP],json:{write:!0}})],Nn.prototype,"fields",void 0),p([_({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:JV.read}}})],Nn.prototype,"geometryType",void 0),p([Ue("geometryType")],Nn.prototype,"writeGeometryType",null),p([_({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Nn.prototype,"hasM",void 0),p([_({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Nn.prototype,"hasZ",void 0),p([_({types:GC,json:{write:!0}})],Nn.prototype,"queryGeometry",void 0),p([qe("queryGeometry")],Nn.prototype,"readQueryGeometry",null),p([_({type:St,json:{write:!0}})],Nn.prototype,"spatialReference",void 0),p([Ue("spatialReference")],Nn.prototype,"writeSpatialReference",null),p([_({json:{write:!0}})],Nn.prototype,"transform",void 0),Nn=QV=p([Q("esri.rest.support.FeatureSet")],Nn),Nn.prototype.toJSON.isDefaultToJSON=!0;const N$=Nn;let Dy=class extends Jh{constructor(){super(...arguments),this.type="geojson",this.refresh=jh(async e=>{await this.load();const{extent:s,timeExtent:i}=await this._connection.invoke("refresh",e);return this.sourceJSON.extent=s,i&&(this.sourceJSON.timeInfo.timeExtent=[i.start,i.end]),{dataChanged:!0,updates:{extent:this.sourceJSON.extent,timeInfo:this.sourceJSON.timeInfo}}})}load(e){const s=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(s)),Promise.resolve(this)}destroy(){var e;(e=this._connection)==null||e.close(),this._connection=null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}queryFeatures(e,s={}){return this.load(s).then(()=>this._connection.invoke("queryFeatures",e?e.toJSON():null,s)).then(i=>N$.fromJSON(i))}queryFeaturesJSON(e,s={}){return this.load(s).then(()=>this._connection.invoke("queryFeatures",e?e.toJSON():null,s))}queryFeatureCount(e,s={}){return this.load(s).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,s))}queryObjectIds(e,s={}){return this.load(s).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,s))}queryExtent(e,s={}){return this.load(s).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,s)).then(i=>({count:i.count,extent:Hs.fromJSON(i.extent)}))}querySnapping(e,s={}){return this.load(s).then(()=>this._connection.invoke("querySnapping",e,s))}async queryAttributeBins(e,s={}){return await this.load(),this._connection.invoke("queryAttributeBins",e==null?void 0:e.toJSON(),s)}_applyEdits(e){if(!this._connection)throw new ae("geojson-layer-source:edit-failure","Memory source not loaded");const s=this.layer.objectIdField,i=[],r=[],n=[];if(e.addFeatures)for(const o of e.addFeatures)i.push(this._serializeFeature(o));if(e.deleteFeatures)for(const o of e.deleteFeatures)"objectId"in o&&o.objectId!=null?r.push(o.objectId):"attributes"in o&&o.attributes[s]!=null&&r.push(o.attributes[s]);if(e.updateFeatures)for(const o of e.updateFeatures)n.push(this._serializeFeature(o));return this._connection.invoke("applyEdits",{adds:i,updates:n,deletes:r}).then(({extent:o,timeExtent:a,featureEditResults:l})=>(this.sourceJSON.extent=o,a&&(this.sourceJSON.timeInfo.timeExtent=[a.start,a.end]),this._createEditsResult(l)))}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const s=e.success===!0?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:s?new ae("geojson-layer-source:edit-failure",s.description,{code:s.code}):null}}_serializeFeature(e){const{attributes:s}=e,i=this._geometryForSerialization(e);return i?{geometry:i.toJSON(),attributes:s}:{attributes:s}}_geometryForSerialization(e){const{geometry:s}=e;return s==null?null:s.type==="mesh"||s.type==="extent"?po.fromExtent(s.extent):s}async _startWorker(e){this._connection=await Cce("GeoJSONSourceWorker",{strategy:ge("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:s,spatialReference:i,hasZ:r,geometryType:n,objectIdField:o,url:a,timeInfo:l,customParameters:u}=this.layer,c=this.layer.originOf("spatialReference")==="defaults",h={url:a,customParameters:u,fields:s&&s.map(f=>f.toJSON()),geometryType:Qz.toJSON(n),hasZ:r,objectIdField:o,timeInfo:l?l.toJSON():null,spatialReference:c?null:i&&i.toJSON()},m=await this._connection.invoke("load",h,{signal:e});for(const f of m.warnings)Ne.getLogger(this.layer).warn("#load()",`${f.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:f});m.featureErrors.length&&Ne.getLogger(this.layer).warn("#load()",`Encountered ${m.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:m.featureErrors}),this.sourceJSON=m.layerDefinition,this.capabilities=Vze(this.sourceJSON.hasZ,!0)}};p([_()],Dy.prototype,"capabilities",void 0),p([_()],Dy.prototype,"type",void 0),p([_({constructOnly:!0})],Dy.prototype,"layer",void 0),p([_()],Dy.prototype,"sourceJSON",void 0),Dy=p([Q("esri.layers.graphics.sources.GeoJSONSource")],Dy);const Gi=(t=>t)(["operational-layers","basemap","ground"]);function qze(t,e){function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s}function rb(t,e,s,i){var r=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(r,rb.prototype),r.expected=e,r.found=s,r.location=i,r.name="SyntaxError",r}function gO(t,e,s){return s=s||" ",t.length>e?t:(e-=t.length,t+(s+=s.repeat(e)).slice(0,e))}function Gze(t,e){var s,i={},r=(e=e!==void 0?e:{}).grammarSource,n={start:Ir},o=Ir,a="none",l=")",u=",",c="(",h="%",m="px",f="cm",g="mm",v="in",b="pt",w="pc",S="deg",T="rad",P="grad",I="turn",A="#",D=".",k="e",R=/^[ \t\n\r]/,O=/^[a-z\-]/,z=/^[0-9a-fA-F]/,q=/^[+\-]/,U=/^[0-9]/,V=ll("none"),B=qr("none",!1),H=qr(")",!1),W=qr(",",!1),ie=ll("whitespace"),se=Hd([" ","	",`
`,"\r"],!1,!1),Z=ll("function"),te=qr("(",!1),ve=ll("identifier"),ke=Hd([["a","z"],"-"],!1,!1),Fe=ll("percentage"),Pe=qr("%",!1),Ve=ll("length"),Ke=qr("px",!1),He=qr("cm",!1),Rs=qr("mm",!1),Cr=qr("in",!1),Js=qr("pt",!1),as=qr("pc",!1),er=ll("angle"),fi=qr("deg",!1),Ks=qr("rad",!1),dt=qr("grad",!1),De=qr("turn",!1),ks=ll("number"),Pr=ll("color"),Ui=qr("#",!1),tr=Hd([["0","9"],["a","f"],["A","F"]],!1,!1),Ho=Hd(["+","-"],!1,!1),Ai=Hd([["0","9"]],!1,!1),Wn=qr(".",!1),an=qr("e",!1),mr=function(){return[]},Si=function(re,Ie){return{type:"function",name:re,parameters:Ie||[]}},Ei=function(re,Ie){return Ie.length>0?Fx(re,Ie,3):[re]},Cs=function(re){return{type:"quantity",value:re.value,unit:re.unit}},ln=function(re){return{type:"color",colorType:re.type,value:re.value}},Yo=function(re){return re},Tr=function(){return T0()},su=function(re){return{value:re,unit:"%"}},Vr=function(re){return{value:re,unit:"px"}},Pn=function(re){return{value:re,unit:"cm"}},Xo=function(re){return{value:re,unit:"mm"}},yo=function(re){return{value:re,unit:"in"}},Hu=function(re){return{value:re,unit:"pt"}},jd=function(re){return{value:re,unit:"pc"}},IP=function(re){return{value:re,unit:"deg"}},Ax=function(re){return{value:re,unit:"rad"}},Pg=function(re){return{value:re,unit:"grad"}},LR=function(re){return{value:re,unit:"turn"}},MP=function(re){return{value:re,unit:null}},AP=function(){return{type:"hex",value:T0()}},Nx=function(re){return{type:"function",value:re}},Dx=function(){return{type:"named",value:T0()}},NP=function(){return parseFloat(T0())},Se=0|e.peg$currPos,ws=Se,sr=[{line:1,column:1}],Ci=Se,Yu=e.peg$maxFailExpected||[],ot=0|e.peg$silentFails;if(e.startRule){if(!(e.startRule in n))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');o=n[e.startRule]}function T0(){return t.substring(ws,Se)}function qr(re,Ie){return{type:"literal",text:re,ignoreCase:Ie}}function Hd(re,Ie,Le){return{type:"class",parts:re,inverted:Ie,ignoreCase:Le}}function Tg(){return{type:"end"}}function ll(re){return{type:"other",description:re}}function am(re){var Ie,Le=sr[re];if(Le)return Le;if(re>=sr.length)Ie=sr.length-1;else for(Ie=re;!sr[--Ie];);for(Le={line:(Le=sr[Ie]).line,column:Le.column};Ie<re;)t.charCodeAt(Ie)===10?(Le.line++,Le.column=1):Le.column++,Ie++;return sr[re]=Le,Le}function lm(re,Ie,Le){var Ct=am(re),ei=am(Ie);return{source:r,start:{offset:re,line:Ct.line,column:Ct.column},end:{offset:Ie,line:ei.line,column:ei.column}}}function Tt(re){Se<Ci||(Se>Ci&&(Ci=Se,Yu=[]),Yu.push(re))}function Yd(re,Ie,Le){return new rb(rb.buildMessage(re,Ie),re,Ie,Le)}function Ir(){var re;return(re=DP())===i&&(re=$P()),re}function DP(){var re,Ie;return ot++,re=Se,Mr(),t.substr(Se,4)===a?(Ie=a,Se+=4):(Ie=i,ot===0&&Tt(B)),Ie!==i?(Mr(),ws=re,re=mr()):(Se=re,re=i),ot--,re===i&&ot===0&&Tt(V),re}function $P(){var re,Ie;if(re=[],(Ie=Xu())!==i)for(;Ie!==i;)re.push(Ie),Ie=Xu();else re=i;return re}function Xu(){var re,Ie,Le,Ct;return re=Se,Mr(),(Ie=RP())!==i?(Mr(),(Le=Xd())===i&&(Le=null),Mr(),t.charCodeAt(Se)===41?(Ct=l,Se++):(Ct=i,ot===0&&Tt(H)),Ct!==i?(Mr(),ws=re,re=Si(Ie,Le)):(Se=re,re=i)):(Se=re,re=i),re}function Xd(){var re,Ie,Le,Ct,ei,gi,dr,cn;if(re=Se,(Ie=$x())!==i){for(Le=[],Ct=Se,ei=Mr(),t.charCodeAt(Se)===44?(gi=u,Se++):(gi=i,ot===0&&Tt(W)),gi===i&&(gi=null),dr=Mr(),(cn=$x())!==i?Ct=ei=[ei,gi,dr,cn]:(Se=Ct,Ct=i);Ct!==i;)Le.push(Ct),Ct=Se,ei=Mr(),t.charCodeAt(Se)===44?(gi=u,Se++):(gi=i,ot===0&&Tt(W)),gi===i&&(gi=null),dr=Mr(),(cn=$x())!==i?Ct=ei=[ei,gi,dr,cn]:(Se=Ct,Ct=i);ws=re,re=Ei(Ie,Le)}else Se=re,re=i;return re}function $x(){var re,Ie;return re=Se,(Ie=I0())===i&&(Ie=M0())===i&&(Ie=Wu())===i&&(Ie=Rx()),Ie!==i&&(ws=re,Ie=Cs(Ie)),(re=Ie)===i&&(re=Se,(Ie=FP())!==i&&(ws=re,Ie=ln(Ie)),re=Ie),re}function Mr(){var re,Ie;for(ot++,re=[],Ie=t.charAt(Se),R.test(Ie)?Se++:(Ie=i,ot===0&&Tt(se));Ie!==i;)re.push(Ie),Ie=t.charAt(Se),R.test(Ie)?Se++:(Ie=i,ot===0&&Tt(se));return ot--,Ie=i,ot===0&&Tt(ie),re}function RP(){var re,Ie,Le;return ot++,re=Se,(Ie=kP())!==i?(t.charCodeAt(Se)===40?(Le=c,Se++):(Le=i,ot===0&&Tt(te)),Le!==i?(ws=re,re=Yo(Ie)):(Se=re,re=i)):(Se=re,re=i),ot--,re===i&&(Ie=i,ot===0&&Tt(Z)),re}function kP(){var re,Ie,Le;if(ot++,re=Se,Ie=[],Le=t.charAt(Se),O.test(Le)?Se++:(Le=i,ot===0&&Tt(ke)),Le!==i)for(;Le!==i;)Ie.push(Le),Le=t.charAt(Se),O.test(Le)?Se++:(Le=i,ot===0&&Tt(ke));else Ie=i;return Ie!==i&&(ws=re,Ie=Tr()),ot--,(re=Ie)===i&&(Ie=i,ot===0&&Tt(ve)),re}function I0(){var re,Ie,Le;return ot++,re=Se,Mr(),(Ie=un())!==i?(t.charCodeAt(Se)===37?(Le=h,Se++):(Le=i,ot===0&&Tt(Pe)),Le!==i?(ws=re,re=su(Ie)):(Se=re,re=i)):(Se=re,re=i),ot--,re===i&&ot===0&&Tt(Fe),re}function M0(){var re,Ie,Le;return ot++,re=Se,Mr(),(Ie=un())!==i?(t.substr(Se,2)===m?(Le=m,Se+=2):(Le=i,ot===0&&Tt(Ke)),Le!==i?(ws=re,re=Vr(Ie)):(Se=re,re=i)):(Se=re,re=i),re===i&&(re=Se,Mr(),(Ie=un())!==i?(t.substr(Se,2)===f?(Le=f,Se+=2):(Le=i,ot===0&&Tt(He)),Le!==i?(ws=re,re=Pn(Ie)):(Se=re,re=i)):(Se=re,re=i),re===i&&(re=Se,Mr(),(Ie=un())!==i?(t.substr(Se,2)===g?(Le=g,Se+=2):(Le=i,ot===0&&Tt(Rs)),Le!==i?(ws=re,re=Xo(Ie)):(Se=re,re=i)):(Se=re,re=i),re===i&&(re=Se,Mr(),(Ie=un())!==i?(t.substr(Se,2)===v?(Le=v,Se+=2):(Le=i,ot===0&&Tt(Cr)),Le!==i?(ws=re,re=yo(Ie)):(Se=re,re=i)):(Se=re,re=i),re===i&&(re=Se,Mr(),(Ie=un())!==i?(t.substr(Se,2)===b?(Le=b,Se+=2):(Le=i,ot===0&&Tt(Js)),Le!==i?(ws=re,re=Hu(Ie)):(Se=re,re=i)):(Se=re,re=i),re===i&&(re=Se,Mr(),(Ie=un())!==i?(t.substr(Se,2)===w?(Le=w,Se+=2):(Le=i,ot===0&&Tt(as)),Le!==i?(ws=re,re=jd(Ie)):(Se=re,re=i)):(Se=re,re=i)))))),ot--,re===i&&ot===0&&Tt(Ve),re}function Wu(){var re,Ie,Le;return ot++,re=Se,(Ie=un())!==i?(t.substr(Se,3)===S?(Le=S,Se+=3):(Le=i,ot===0&&Tt(fi)),Le!==i?(ws=re,re=IP(Ie)):(Se=re,re=i)):(Se=re,re=i),re===i&&(re=Se,(Ie=un())!==i?(t.substr(Se,3)===T?(Le=T,Se+=3):(Le=i,ot===0&&Tt(Ks)),Le!==i?(ws=re,re=Ax(Ie)):(Se=re,re=i)):(Se=re,re=i),re===i&&(re=Se,(Ie=un())!==i?(t.substr(Se,4)===P?(Le=P,Se+=4):(Le=i,ot===0&&Tt(dt)),Le!==i?(ws=re,re=Pg(Ie)):(Se=re,re=i)):(Se=re,re=i),re===i&&(re=Se,(Ie=un())!==i?(t.substr(Se,4)===I?(Le=I,Se+=4):(Le=i,ot===0&&Tt(De)),Le!==i?(ws=re,re=LR(Ie)):(Se=re,re=i)):(Se=re,re=i)))),ot--,re===i&&(Ie=i,ot===0&&Tt(er)),re}function Rx(){var re,Ie;return ot++,re=Se,Mr(),(Ie=un())!==i?(ws=re,re=MP(Ie)):(Se=re,re=i),ot--,re===i&&ot===0&&Tt(ks),re}function FP(){var re,Ie,Le,Ct;if(ot++,re=Se,t.charCodeAt(Se)===35?(Ie=A,Se++):(Ie=i,ot===0&&Tt(Ui)),Ie!==i){if(Le=[],Ct=t.charAt(Se),z.test(Ct)?Se++:(Ct=i,ot===0&&Tt(tr)),Ct!==i)for(;Ct!==i;)Le.push(Ct),Ct=t.charAt(Se),z.test(Ct)?Se++:(Ct=i,ot===0&&Tt(tr));else Le=i;Le!==i?(ws=re,re=AP()):(Se=re,re=i)}else Se=re,re=i;return re===i&&(re=Se,(Ie=Xu())!==i&&(ws=re,Ie=Nx(Ie)),(re=Ie)===i&&(re=Se,(Ie=kP())!==i&&(ws=re,Ie=Dx()),re=Ie)),ot--,re===i&&(Ie=i,ot===0&&Tt(Pr)),re}function un(){var re,Ie,Le,Ct,ei,gi,dr,cn;for(re=Se,Ie=t.charAt(Se),q.test(Ie)?Se++:(Ie=i,ot===0&&Tt(Ho)),Ie===i&&(Ie=null),Le=Se,Ct=[],ei=t.charAt(Se),U.test(ei)?Se++:(ei=i,ot===0&&Tt(Ai));ei!==i;)Ct.push(ei),ei=t.charAt(Se),U.test(ei)?Se++:(ei=i,ot===0&&Tt(Ai));if(t.charCodeAt(Se)===46?(ei=D,Se++):(ei=i,ot===0&&Tt(Wn)),ei!==i){if(gi=[],dr=t.charAt(Se),U.test(dr)?Se++:(dr=i,ot===0&&Tt(Ai)),dr!==i)for(;dr!==i;)gi.push(dr),dr=t.charAt(Se),U.test(dr)?Se++:(dr=i,ot===0&&Tt(Ai));else gi=i;gi!==i?Le=Ct=[Ct,ei,gi]:(Se=Le,Le=i)}else Se=Le,Le=i;if(Le===i)if(Le=[],Ct=t.charAt(Se),U.test(Ct)?Se++:(Ct=i,ot===0&&Tt(Ai)),Ct!==i)for(;Ct!==i;)Le.push(Ct),Ct=t.charAt(Se),U.test(Ct)?Se++:(Ct=i,ot===0&&Tt(Ai));else Le=i;if(Le!==i){if(Ct=Se,t.charCodeAt(Se)===101?(ei=k,Se++):(ei=i,ot===0&&Tt(an)),ei!==i){if(gi=t.charAt(Se),q.test(gi)?Se++:(gi=i,ot===0&&Tt(Ho)),gi===i&&(gi=null),dr=[],cn=t.charAt(Se),U.test(cn)?Se++:(cn=i,ot===0&&Tt(Ai)),cn!==i)for(;cn!==i;)dr.push(cn),cn=t.charAt(Se),U.test(cn)?Se++:(cn=i,ot===0&&Tt(Ai));else dr=i;dr!==i?Ct=ei=[ei,gi,dr]:(Se=Ct,Ct=i)}else Se=Ct,Ct=i;Ct===i&&(Ct=null),ws=re,re=NP()}else Se=re,re=i;return re}function kx(re,Ie){return re.map(function(Le){return Le[Ie]})}function Fx(re,Ie,Le){return[re].concat(kx(Ie,Le))}if(s=o(),e.peg$library)return{peg$result:s,peg$currPos:Se,peg$FAILED:i,peg$maxFailExpected:Yu,peg$maxFailPos:Ci};if(s!==i&&Se===t.length)return s;throw s!==i&&Se<t.length&&Tt(Tg()),Yd(Yu,Ci<t.length?t.charAt(Ci):null,Ci<t.length?lm(Ci,Ci+1):lm(Ci,Ci))}function Xfe(t){if(!t||t.length===0)return null;if(typeof t=="string"){const s=_K(t);return s&&s.length!==0?s:null}const e=t.map(s=>{if(!Number.isFinite(s.scale)||s.scale<=0)throw new ae("effect:invalid-scale","scale must be finite and greater than 0",{stop:s});return{scale:s.scale,effects:_K(s.value)}});e.sort((s,i)=>i.effects.length-s.effects.length);for(let s=0;s<e.length-1;s++){if(!pke(e[s].effects,e[s+1].effects))throw new ae("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[s].effects,b:e[s+1].effects});fke(e[s].effects,e[s+1].effects)}return e.sort((s,i)=>i.scale-s.scale),e}function _K(t){let e;if(!t)return[];try{e=Gze(t)}catch(s){throw new ae("effect:invalid-syntax","Invalid effect syntax",{value:t,error:s})}return e.map(s=>zze(s))}function zze(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return Uze(t);case"opacity":return Bze(t);case"hue-rotate":return jze(t);case"blur":return Hze(t);case"drop-shadow":return Yze(t);case"bloom":return Xze(t)}}catch(e){throw e.details.filter=t,e}throw new ae("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function Uze(t){let e=1;return dx(t.parameters,1),t.parameters.length===1&&(e=Mc(t.parameters[0])),new s6(t.name,e)}function Bze(t){let e=1;return dx(t.parameters,1),t.parameters.length===1&&(e=Mc(t.parameters[0])),new zhe(e)}function jze(t){let e=0;return dx(t.parameters,1),t.parameters.length===1&&(e=e7e(t.parameters[0])),new qhe(e)}function Hze(t){let e=0;return dx(t.parameters,1),t.parameters.length===1&&(e=xU(t.parameters[0]),hP(e,t.parameters[0])),new khe(e)}function Yze(t){const e=[];let s=null;for(const i of t.parameters)if(i.type==="color"){if(e.length&&Object.freeze(e),s)throw new ae("effect:type-error","Accepts only one color",{});s=t7e(i)}else{const r=xU(i);if(Object.isFrozen(e))throw new ae("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(r),e.length===3&&hP(r,i)}if(e.length<2||e.length>3)throw new ae("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new Lhe(e[0],e[1],e[2]||0,s||Wfe("black"))}function Xze(t){let e=1,s=0,i=0;return dx(t.parameters,3),t.parameters[0]&&(e=Mc(t.parameters[0])),t.parameters[1]&&(s=xU(t.parameters[1]),hP(s,t.parameters[1])),t.parameters[2]&&(i=Mc(t.parameters[2])),new $he(e,s,i)}function dx(t,e){if(t.length>e)throw new ae("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function D$(t){if(t.type==="color")return"<color>";if(t.unit){if(t.unit in bU)return"<length>";if(t.unit in vU)return"<angle>";if(t.unit==="%")return"<percentage>"}return"<double>"}function hP(t,e){if(t<0)throw new ae("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function Wze(t){if(t.type!=="quantity"||t.unit!==null)throw new ae("effect:type-error",`Expected <double>, Actual: ${D$(t)}`,{term:t})}function Zze(t){if(t.type!=="quantity"||t.unit!==null&&t.unit!=="%")throw new ae("effect:type-error",`Expected <double> or <percentage>, Actual: ${D$(t)}`,{term:t})}qze(rb,Error),rb.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var s,i=null;for(s=0;s<t.length;s++)if(t[s].source===this.location.source){i=t[s].text.split(/\r\n|\n|\r/g);break}var r=this.location.start,n=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(r):r,o=this.location.source+":"+n.line+":"+n.column;if(i){var a=this.location.end,l=gO("",n.line.toString().length," "),u=i[r.line-1],c=(r.line===a.line?a.column:u.length+1)-r.column||1;e+=`
 --> `+o+`
`+l+` |
`+n.line+" | "+u+`
`+l+" | "+gO("",r.column-1," ")+gO("",c,"^")}else e+=`
 at `+o}return e},rb.buildMessage=function(t,e){var s={literal:function(u){return'"'+r(u.text)+'"'},class:function(u){var c=u.parts.map(function(h){return Array.isArray(h)?n(h[0])+"-"+n(h[1]):n(h)});return"["+(u.inverted?"^":"")+c.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(u){return u.description}};function i(u){return u.charCodeAt(0).toString(16).toUpperCase()}function r(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(c){return"\\x0"+i(c)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(c){return"\\x"+i(c)})}function n(u){return u.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(c){return"\\x0"+i(c)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(c){return"\\x"+i(c)})}function o(u){return s[u.type](u)}function a(u){var c,h,m=u.map(o);if(m.sort(),m.length>0){for(c=1,h=1;c<m.length;c++)m[c-1]!==m[c]&&(m[h]=m[c],h++);m.length=h}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function l(u){return u?'"'+r(u)+'"':"end of input"}return"Expected "+a(t)+" but "+l(e)+" found."};const vU={deg:1,grad:.9,rad:180/Math.PI,turn:360};function Qze(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&vU[t.unit]!=null))throw new ae("effect:type-error",`Expected <angle>, Actual: ${D$(t)}`,{term:t})}const bU={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function Jze(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&bU[t.unit]!=null))throw new ae("effect:type-error",`Expected <length>, Actual: ${D$(t)}`,{term:t})}function Mc(t){Zze(t);const e=t.value;return hP(e,t),t.unit==="%"?.01*e:e}function Kze(t){return Wze(t),hP(t.value,t),t.value}function e7e(t){return Qze(t),t.value*vU[t.unit]||0}function xU(t){return Jze(t),t.value*bU[t.unit]||0}function t7e(t){switch(t.colorType){case"hex":return rRe(t.value);case"named":return Wfe(t.value);case"function":return r7e(t.value)}}function Wfe(t){if(!Ehe(t))throw new ae("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return iRe(t)}const s7e=/^rgba?/i,i7e=/^hsla?/i;function r7e(t){if(dx(t.parameters,4),s7e.test(t.name))return[Mc(t.parameters[0]),Mc(t.parameters[1]),Mc(t.parameters[2]),t.parameters[3]?Mc(t.parameters[3]):1];if(i7e.test(t.name))return Che(Kze(t.parameters[0]),Mc(t.parameters[1]),Mc(t.parameters[2]),t.parameters[3]?Mc(t.parameters[3]):1);throw new ae("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function zE(t,e,s){var i;try{return o7e(t)}catch(r){(i=s==null?void 0:s.messages)==null||i.push(r)}return null}function UE(t,e,s,i){try{const r=n7e(t);Hn(s,r,e)}catch(r){i.messages&&i.messages.push(r)}}function n7e(t){const e=Xfe(t);return e?gke(e)?e.map(s=>s.toJSON()):e.map(({scale:s,effects:i})=>({scale:s,value:i.map(r=>r.toJSON())})):null}function o7e(t){if(!t||t.length===0)return null;if(a7e(t)){const e=[];for(const s of t)e.push({scale:s.scale,value:KV(s.value)});return e}return KV(t)}function a7e(t){const e=t[0];return!!e&&"scale"in e}function KV(t){if(!(t!=null&&t.length))return"";const e=[];for(const s of t){let i=[];switch(s.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":i=[Mm(s,"amount")];break;case"blur":i=[Mm(s,"radius","pt")];break;case"hue-rotate":i=[Mm(s,"angle","deg")];break;case"drop-shadow":i=[Mm(s,"xoffset","pt"),Mm(s,"yoffset","pt"),Mm(s,"blurRadius","pt"),l7e(s,"color")];break;case"bloom":i=[Mm(s,"strength"),Mm(s,"radius","pt"),Mm(s,"threshold")]}const r=`${s.type}(${i.filter(Boolean).join(" ")})`;Xfe(r),e.push(r)}return e.join(" ")}function Mm(t,e,s){if(t[e]==null)throw new ae("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return s?t[e]+s:""+t[e]}function l7e(t,e){if(t[e]==null)throw new ae("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const s=t[e];return`rgba(${s[0]||0}, ${s[1]||0}, ${s[2]||0}, ${s[3]/255||0})`}const u7e={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:{layerContainerTypes:Gi}},"portal-item":{read:!0,write:{layerContainerTypes:Gi}}}}},vK={read:{reader:zE},write:{allowNull:!0,writer:UE,layerContainerTypes:Gi}},c7e={json:{read:!1,write:!1,origins:{"web-map":vK,"portal-item":vK}}},wU=t=>{let e=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return p([_(u7e)],e.prototype,"blendMode",void 0),p([_(c7e)],e.prototype,"effect",void 0),e=p([Q("esri.layers.mixins.BlendLayer")],e),e},Zfe=t=>{let e=class extends t{constructor(){super(...arguments),this.customParameters=null}};return p([_({type:Object,json:{write:{overridePolicy:s=>({enabled:!!(s&&Object.keys(s).length>0)})}}})],e.prototype,"customParameters",void 0),e=p([Q("esri.layers.mixins.CustomParametersMixin")],e),e},Qfe=96;function Qyt(t,e){const s=t.extent,i=t.width,r=Uu(s==null?void 0:s.spatialReference);return s&&i?s.width/i*r*yle*Qfe:0}function Jyt(t,e){return t/(Uu(e)*yle*Qfe)}function Kyt(t,e,s){return h7e(t,e)&&m7e(t,s)}function h7e(t,e){return e===0||qc(t,e)||t<e}function m7e(t,e){return e===0||qc(t,e)||t>e}function d7e(t,e){return qc(t,e)?0:(t||Number.POSITIVE_INFINITY)>(e||Number.POSITIVE_INFINITY)?1:-1}const bK={write:{overridePolicy:(t,e,s)=>({enabled:!s||s.filterMode==="scale"})}};let Qp=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.id=A$(),this.maxScale=0,this.minScale=0,this.title="",this.where=null}};p([_({type:String,json:{write:!0}})],Qp.prototype,"id",void 0),p([_({type:Number,json:bK})],Qp.prototype,"maxScale",void 0),p([_({type:Number,json:bK})],Qp.prototype,"minScale",void 0),p([_({type:String,json:{write:!0}})],Qp.prototype,"title",void 0),p([_({type:String,json:{write:!0}})],Qp.prototype,"where",void 0),Qp=p([Q("esri.layers.support.DisplayFilter")],Qp);const Jfe=Qp;function p7e(t,e){return{...e,filterMode:t.mode}}function t_t(t,e){return Kfe(t,e).next().value??null}function s_t(t,e,s){const i=f7e(t);if(i&&(Tae(e,i[0])||i5(s,i[1])))return"";const r=Array.from(Kfe(t,e,s)),n=g7e(r,e,s)?"1=1":r.map(o=>o.where||"1=1").reduce((o,a)=>Dke(o,a),"");return n&&n!=="1=1"?n:""}function f7e(t){if(ege(t)==="manual")return null;const e=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:s,maxScale:i}of t.filters)e[0]=Math.max(e[0],BE(s)),e[1]=Math.min(e[1],I3(i));return e}function*Kfe(t,e,s){if(ege(t)==="manual"){const i=t.filters.find(r=>r.id===t.activeFilterId);i&&(yield i)}else{typeof e=="object"&&(e=e.scale);for(const i of t.filters)y7e(i.minScale,i.maxScale,e,s)&&(yield i)}}function g7e(t,e,s){var n,o;if(t.length===0)return!0;const i=BE((n=t.at(0))==null?void 0:n.minScale),r=I3((o=t.at(-1))==null?void 0:o.maxScale);if(i5(i,e)||Tae(r,s))return!0;for(let a=0;a<t.length-1;a++){const l=t[a],u=t[a+1];if(i5(BE(u.minScale),I3(l.maxScale)))return!0}return!1}function y7e(t,e,s,i){return t=BE(t),s=BE(s),e=I3(e),!(!qc(s,t)&&(i??s)>t)&&!ZCe(e,s)&&(i===void 0||!qc(i,t))}function ege(t){return"mode"in t?t.mode:t.filterMode}function BE(t){return t||Number.POSITIVE_INFINITY}function I3(t){return t||0}let $y=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.activeFilterId=null,this.filters=new(Ge.ofType(Jfe)),this.mode="manual"}writeFilters(e,s,i,r){const n=e.toArray();this.mode==="scale"&&n.sort((o,a)=>{const l=d7e(a.minScale,o.minScale),u=o.maxScale-a.maxScale;return l===0?u:l}),s[i]=n.map(o=>o.toJSON(r))}write(e,s){return super.write(e,p7e(this,s))}};p([_({type:String,json:{write:{overridePolicy:(t,e,s)=>({enabled:s.filterMode==="manual",isRequired:!0})}}})],$y.prototype,"activeFilterId",void 0),p([_({type:Ge.ofType(Jfe),nonNullable:!0,json:{write:!0}})],$y.prototype,"filters",void 0),p([Ue("filters")],$y.prototype,"writeFilters",null),p([_({type:["manual","scale"],nonNullable:!0,json:{name:"filterMode",write:!0}})],$y.prototype,"mode",void 0),$y=p([Q("esri.layers.support.DisplayFilterInfo")],$y);const _7e=$y,tge=t=>{let e=class extends t{constructor(){super(...arguments),this.displayFilterEnabled=!0,this.displayFilterInfo=null}};return p([_(v7e)],e.prototype,"displayFilterEnabled",void 0),p([_(b7e)],e.prototype,"displayFilterInfo",void 0),e=p([Q("esri.layers.mixins.DisplayFilteredLayer")],e),e},v7e={type:Boolean,json:{name:"layerDefinition.disableDisplayFilter",read:{reader:t=>!t},write:{layerContainerTypes:Gi,writer(t,e,s){Hn(s,!t,e)}},origins:{"web-scene":{write:!1,read:!1}}}},b7e={type:_7e,json:{name:"layerDefinition.displayFilterInfo",write:{enabled:!0,allowNull:!0,layerContainerTypes:Gi},origins:{"web-scene":{write:!1,read:!1}}}};var eq;const yO=new Jt({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),_O=new Jt({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Ph=eq=class extends Te{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:s,spatialRelationship:i,timeExtent:r,objectIds:n,units:o,distance:a}=this;return new xn({geometry:he(s),objectIds:he(n),spatialRelationship:i,timeExtent:he(r),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:s,timeExtent:i,objectIds:r,units:n,distance:o}=this;return new eq({geometry:he(e),objectIds:he(r),spatialRelationship:s,timeExtent:he(i),where:t,units:n,distance:o})}};p([_({type:String,json:{write:!0}})],Ph.prototype,"where",void 0),p([_({types:GC,json:{write:!0}})],Ph.prototype,"geometry",void 0),p([_({type:yO.apiValues,json:{name:"spatialRel",read:{reader:yO.read},write:{allowNull:!1,writer:yO.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],Ph.prototype,"spatialRelationship",void 0),p([_({type:Number,json:{write:{overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],Ph.prototype,"distance",void 0),p([_({type:[Number],json:{write:!0}})],Ph.prototype,"objectIds",void 0),p([_({type:_O.apiValues,json:{read:_O.read,write:{writer:_O.write,overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],Ph.prototype,"units",void 0),p([_({type:Ad,json:{write:!0}})],Ph.prototype,"timeExtent",void 0),Ph=eq=p([Q("esri.layers.support.FeatureFilter")],Ph);const x7e=Ph;var tq;const xK={read:{reader:zE},write:{writer:UE,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},wK={read:{reader:zE},write:{writer:UE,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},SK={name:"showExcludedLabels",default:!0};let Ry=tq=class extends Te{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){var i,r;const s=super.write(t,e);if(e!=null&&e.origin){if(s.filter){const n=Object.keys(s.filter);if(n.length>1||n[0]!=="where")return(i=e.messages)==null||i.push(new ae("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in s)return(r=e.messages)==null||r.push(new ae("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return s}clone(){return new tq({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};p([_({type:x7e,json:{write:{allowNull:!0,writer(t,e,s,i){const r=t==null?void 0:t.write({},i);r&&Object.keys(r).length!==0?Hn(s,r,e):Hn(s,null,e)}}}})],Ry.prototype,"filter",void 0),p([_({json:{read:zE,write:{writer:UE,allowNull:!0},origins:{"web-map":xK,"portal-item":xK}}})],Ry.prototype,"includedEffect",void 0),p([_({json:{read:zE,write:{writer:UE,allowNull:!0},origins:{"web-map":wK,"portal-item":wK}}})],Ry.prototype,"excludedEffect",void 0),p([_({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":SK,"portal-item":SK}}})],Ry.prototype,"excludedLabelsVisible",void 0),Ry=tq=p([Q("esri.layers.support.FeatureEffect")],Ry);const w7e=Ry,EK={write:{allowNull:!0}},S7e={type:w7e,json:{origins:{"web-map":EK,"portal-item":EK}}},sge=t=>{let e=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return p([_(S7e)],e.prototype,"featureEffect",void 0),e=p([Q("esri.layers.mixins.FeatureEffectLayer")],e),e};let rv=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};p([_({type:String,json:{write:!0}})],rv.prototype,"expression",void 0),p([_({type:String,json:{write:!0}})],rv.prototype,"title",void 0),p([_({type:String,json:{write:!0}})],rv.prototype,"returnType",void 0),rv=p([Q("esri.layers.support.ExpressionInfo")],rv);const SU=rv;var sq;let Ym=sq=class extends Te{constructor(t){super(t),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new sq({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:he(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};p([_({type:Boolean,json:{write:!0}})],Ym.prototype,"isAutoGenerated",void 0),p([_({type:String,json:{write:!0}})],Ym.prototype,"name",void 0),p([_({type:String,json:{write:!0}})],Ym.prototype,"alias",void 0),p([_({type:String,json:{write:!0}})],Ym.prototype,"onStatisticField",void 0),p([_({type:SU,json:{write:!0}})],Ym.prototype,"onStatisticExpression",void 0),p([_({type:String,json:{write:!0}})],Ym.prototype,"statisticType",void 0),Ym=sq=p([Q("esri.layers.support.AggregateField")],Ym);const ig=Ym;let Uf=class extends Te{constructor(){super(...arguments),this.type=null}};p([_({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],Uf.prototype,"type",void 0),Uf=p([Q("esri.layers.support.FeatureReduction")],Uf);var iq;let lS=iq=class extends Te{constructor(t){super(t)}async collectRequiredFields(t,e){return Go(t,e,this.expression)}clone(){return new iq({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};p([_({type:String,json:{write:{isRequired:!0}}})],lS.prototype,"expression",void 0),p([_({type:String,json:{write:!0}})],lS.prototype,"title",void 0),lS=iq=p([Q("esri.symbols.support.FeatureExpressionInfo")],lS);const CK=lS,$$={unknown:1,inches:os(1,"meters","inches"),feet:os(1,"meters","feet"),"us-feet":os(1,"meters","us-feet"),yards:os(1,"meters","yards"),miles:os(1,"meters","miles"),"nautical-miles":os(1,"meters","nautical-miles"),millimeters:os(1,"meters","millimeters"),centimeters:os(1,"meters","centimeters"),decimeters:os(1,"meters","decimeters"),meters:os(1,"meters","meters"),kilometers:os(1,"meters","kilometers"),"decimal-degrees":1/Ple(1,"meters",lr.radius)};function o_t(t){return!!t&&$$[t]!=null}function a_t(t){return 1/($$[t]||1)}function E7e(){const t=Object.keys($$);return woe(t,"decimal-degrees"),t.sort(),t}const C7e=E7e();var rq;const DI=Xn()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),PK=new Jt({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let Xm=rq=class extends Te{constructor(t){super(t),this.featureExpressionInfo=void 0,this.offset=null}readFeatureExpressionInfo(t,e){return t??(e.featureExpression&&e.featureExpression.value===0?{expression:"0"}:void 0)}writeFeatureExpressionInfo(t,e,s,i){e[s]=t.write({},i),t.expression==="0"&&(e.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:e}=this;return this._isOverridden("mode")?this._get("mode"):t!=null||e?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,e){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,e):null}clone(){return new rq({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(t){return this.mode===t.mode&&this.offset===t.offset&&this.unit===t.unit&&eCe(this.featureExpressionInfo,t.featureExpressionInfo)}};p([_({type:CK,json:{write:!0}})],Xm.prototype,"featureExpressionInfo",void 0),p([qe("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],Xm.prototype,"readFeatureExpressionInfo",null),p([Ue("featureExpressionInfo",{featureExpressionInfo:{type:CK},"featureExpression.value":{type:[0]}})],Xm.prototype,"writeFeatureExpressionInfo",null),p([_({type:DI.apiValues,nonNullable:!0,json:{type:DI.jsonValues,read:DI.read,write:{writer:DI.write,isRequired:!0}}})],Xm.prototype,"mode",null),p([_({type:Number,json:{write:!0}})],Xm.prototype,"offset",void 0),p([_({type:C7e,json:{type:String,read:PK.read,write:PK.write}})],Xm.prototype,"unit",null),Xm=rq=p([Q("esri.symbols.support.ElevationInfo")],Xm);const ige=Xm;let nv=class extends Te{constructor(e){super(e),this.description=null,this.label=null,this.type=null}};p([_({type:String,json:{write:!0}})],nv.prototype,"description",void 0),p([_({type:String,json:{write:!0}})],nv.prototype,"label",void 0),p([_()],nv.prototype,"type",void 0),nv=p([Q("esri.tables.elements.AttributeTableElement")],nv);const $b=nv;var nq;let uS=nq=class extends $b{constructor(t){super(t),this.displayType="auto",this.type="attachment"}clone(){return new nq({description:this.description,displayType:this.displayType,label:this.label})}};p([_({type:["auto"],json:{write:!0}})],uS.prototype,"displayType",void 0),p([_({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],uS.prototype,"type",void 0),uS=nq=p([Q("esri.tables.elements.AttributeTableAttachmentElement")],uS);const TK=uS;var oq;let cS=oq=class extends $b{constructor(t){super(t),this.fieldName=null,this.type="field"}clone(){return new oq({description:this.description,fieldName:this.fieldName,label:this.label})}};p([_({type:String,json:{write:!0}})],cS.prototype,"fieldName",void 0),p([_({type:String,json:{read:!1,write:!0}})],cS.prototype,"type",void 0),cS=oq=p([Q("esri.tables.elements.AttributeTableFieldElement")],cS);const IK=cS;var aq;let hS=aq=class extends $b{constructor(t){super(t),this.relationshipId=null,this.type="relationship"}clone(){return new aq({description:this.description,label:this.label,relationshipId:this.relationshipId})}};p([_({type:Number,json:{write:!0}})],hS.prototype,"relationshipId",void 0),p([_({type:["relationship"],json:{read:!1,write:!0}})],hS.prototype,"type",void 0),hS=aq=p([Q("esri.tables.elements.AttributeTableRelationshipElement")],hS);const MK=hS;function rge(t){return{typesWithGroup:{base:$b,key:"type",typeMap:{attachment:TK,field:IK,group:t,relationship:MK}},typesWithoutGroup:{base:$b,key:"type",typeMap:{attachment:TK,field:IK,relationship:MK}}}}function nge(t,e,s=!0){if(!t)return null;const i=s?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(r=>i[r.type]).map(r=>i[r.type].fromJSON(r))}function oge(t,e,s=!0){if(!t)return null;const i=s?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(r=>i[r.type]).map(r=>r.toJSON())}function age(t,e,s=!0){return t?t.map(i=>Hc(s?e.typesWithGroup:e.typesWithoutGroup,i)):null}var lq;let nd=lq=class extends $b{constructor(t){super(t),this.elements=null,this.type="group"}castElements(t){return age(t,vO,!1)}readElements(t,e){return nge(e.attributeTableElements,vO,!1)}writeElements(t,e){e.attributeTableElements=oge(t,vO,!1)}clone(){return new lq({description:this.description,elements:he(this.elements),label:this.label})}};p([_({json:{write:!0}})],nd.prototype,"elements",void 0),p([Ht("elements")],nd.prototype,"castElements",null),p([qe("elements",["attributeTableElements"])],nd.prototype,"readElements",null),p([Ue("elements")],nd.prototype,"writeElements",null),p([_({type:String,json:{read:!1,write:!0}})],nd.prototype,"type",void 0),nd=lq=p([Q("esri.tables.elements.AttributeTableGroupElement")],nd);const vO=rge(nd),P7e=nd;var uq;const bO=rge(P7e);let Jp=uq=class extends Te{constructor(t){super(t),this.elements=null,this.orderByFields=null}castElements(t){return age(t,bO)}readElements(t,e){return nge(e.attributeTableElements,bO)}writeElements(t,e){e.attributeTableElements=oge(t,bO)}clone(){return new uq({elements:he(this.elements),orderByFields:this.orderByFields})}};p([_({json:{write:!0}})],Jp.prototype,"elements",void 0),p([Ht("elements")],Jp.prototype,"castElements",null),p([qe("elements",["attributeTableElements"])],Jp.prototype,"readElements",null),p([Ue("elements")],Jp.prototype,"writeElements",null),p([_({type:[Object],json:{write:!0}})],Jp.prototype,"orderByFields",void 0),Jp=uq=p([Q("esri.tables.AttributeTableTemplate")],Jp);const T7e=Jp,lge={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:Gi}}},mP={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,s){e[s]=!t}}}},dP={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:Gi}}},uge={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:V_}}},cge={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:Gi}}},hge={value:null,type:ige,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:Gi}}};function u_t(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const mge={write:{enabled:!0,layerContainerTypes:Gi},read:!0},M3={type:Number,json:{origins:{"web-document":mge,"portal-item":{write:{layerContainerTypes:Gi}}}}},I7e={...M3,json:{...M3.json,origins:{"web-document":{...mge,write:{enabled:!0,layerContainerTypes:Gi,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,s)=>{var i;return s&&s.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?(i=e.layerDefinition)!=null&&i.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?kE(e.layerDefinition.drawingInfo.transparency):void 0:kE(e.drawingInfo.transparency)}}}},c_t={type:Hs,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const s=Hs.fromJSON(t);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(s.spatialReference=St.fromJSON(e.spatialReference)),s}}}},read:!1}},dge={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},M7e={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.minScale",write:{layerContainerTypes:Gi}}},A7e={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.maxScale",write:{layerContainerTypes:Gi}}},pge={json:{write:{ignoreOrigin:!0,layerContainerTypes:Gi},origins:{"web-map":{read:!1,write:!1}}}},fge={type:T7e,json:{name:"attributeTableInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}};async function N7e(t,e,s){e=e.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=gge(t));const i=D7e(t),r=t.capabilities.query.supportsPagination;e.start=0,e.num=i;let n=null;for(;;){const o=await t.source.queryFeaturesJSON(e,s);if(n==null?n=o:n.features=n.features.concat(o.features),n.exceededTransferLimit=o.exceededTransferLimit,!r||!o.exceededTransferLimit)break;e.start+=i}return n}function D7e(t){return gge(t)*$7e(t)}function $7e(t){return t.capabilities.query.maxRecordCount||2e3}function gge(t){return t.capabilities.query.supportsMaxRecordCountFactor?xn.MAX_MAX_RECORD_COUNT_FACTOR:1}var cq;let mS=cq=class extends Te{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new cq({minValue:this.minValue,maxValue:this.maxValue})}};p([_({type:Number,json:{write:!0}})],mS.prototype,"minValue",void 0),p([_({type:Number,json:{write:!0}})],mS.prototype,"maxValue",void 0),mS=cq=p([Q("esri.renderers.support.AuthoringInfoClassBreakInfo")],mS);var hq;let yf=hq=class extends Te{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new hq({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:he(this.classBreakInfos)})}};p([_({type:String,json:{write:!0}})],yf.prototype,"field",void 0),p([_({type:String,json:{write:!0}})],yf.prototype,"normalizationField",void 0),p([_({type:String,json:{write:!0}})],yf.prototype,"label",void 0),p([_({type:[mS],json:{write:!0}})],yf.prototype,"classBreakInfos",void 0),yf=hq=p([Q("esri.renderers.support.AuthoringInfoFieldInfo")],yf);var mq;let ov=mq=class extends Te{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new mq({label:this.label,value:this.value,size:this.size})}};p([_({type:String,json:{write:!0}})],ov.prototype,"label",void 0),p([_({type:Number,json:{write:!0}})],ov.prototype,"size",void 0),p([_({type:Number,json:{write:!0}})],ov.prototype,"value",void 0),ov=mq=p([Q("esri.renderers.support.AuthoringInfoSizeStop")],ov);const R7e=ov;var dq;const $I=new Jt({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),RI=new Jt({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),AK={key:t=>typeof t=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},NK=["high-to-low","above-and-below","centered-on","extremes"],DK=[...new Set(["high-to-low","above-and-below","centered-on","extremes","above","below","high-to-low","above-and-below","above","below","reference-size"])],$K=["seconds","minutes","hours","days","months","years"],k7e=["circle","diamond","hexagon-flat","hexagon-pointy","square"];let Dn=dq=class extends Te{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return typeof t=="string"||typeof t=="number"?t:null}get normalizationField(){return this.theme==="reference-size"?this._get("normalizationField"):null}set normalizationField(t){this._set("normalizationField",t)}get referenceSizeScale(){return this.theme==="reference-size"?this._get("referenceSizeScale"):null}set referenceSizeScale(t){this._set("referenceSizeScale",t)}get referenceSizeSymbolStyle(){return this.theme==="reference-size"?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(t){this._set("referenceSizeSymbolStyle",t)}castStartTime(t){return typeof t=="string"||typeof t=="number"?t:null}get sizeStops(){return this.theme==="reference-size"?this._get("sizeStops"):null}set sizeStops(t){this._set("sizeStops",t)}get style(){return this.type==="color"?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new dq({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,sizeStops:he(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};p([_({types:AK,json:{write:!0}})],Dn.prototype,"endTime",void 0),p([Ht("endTime")],Dn.prototype,"castEndTime",null),p([_({type:String,json:{write:!0}})],Dn.prototype,"field",void 0),p([_({type:Number,json:{write:!0}})],Dn.prototype,"maxSliderValue",void 0),p([_({type:Number,json:{write:!0}})],Dn.prototype,"minSliderValue",void 0),p([_({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],Dn.prototype,"normalizationField",null),p([_({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Dn.prototype,"referenceSizeScale",null),p([_({type:k7e,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Dn.prototype,"referenceSizeSymbolStyle",null),p([_({types:AK,json:{write:!0}})],Dn.prototype,"startTime",void 0),p([Ht("startTime")],Dn.prototype,"castStartTime",null),p([_({type:[R7e],json:{origins:{"web-scene":{write:!1}},write:!0}})],Dn.prototype,"sizeStops",null),p([_({type:$I.apiValues,value:null,json:{type:$I.jsonValues,read:$I.read,write:$I.write}})],Dn.prototype,"style",null),p([_({type:DK,value:null,json:{type:DK,origins:{"web-scene":{type:NK,write:{writer:(t,e)=>{NK.includes(t)&&(e.theme=t)}}}},write:!0}})],Dn.prototype,"theme",null),p([_({type:RI.apiValues,json:{type:RI.jsonValues,read:RI.read,write:RI.write}})],Dn.prototype,"type",void 0),p([_({type:$K,json:{type:$K,write:!0}})],Dn.prototype,"units",void 0),Dn=dq=p([Q("esri.renderers.support.AuthoringInfoVisualVariable")],Dn);const F7e=Dn;let MA=class extends Te{constructor(e){super(e),this.type=null}};p([_({readOnly:!0,json:{read:!1,write:!0}})],MA.prototype,"type",void 0),MA=p([Q("esri.rest.support.ColorRamp")],MA);const EU=MA;var pq;let ky=pq=class extends EU{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new pq({fromColor:he(this.fromColor),toColor:he(this.toColor),algorithm:this.algorithm})}};p([mt({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],ky.prototype,"algorithm",void 0),p([_({type:Be,json:{type:[fs],write:!0}})],ky.prototype,"fromColor",void 0),p([_({type:Be,json:{type:[fs],write:!0}})],ky.prototype,"toColor",void 0),p([_({type:["algorithmic"]})],ky.prototype,"type",void 0),ky=pq=p([Q("esri.rest.support.AlgorithmicColorRamp")],ky);const CU=ky;var fq;let dS=fq=class extends EU{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new fq({colorRamps:he(this.colorRamps)})}};p([_({type:[CU],json:{write:!0}})],dS.prototype,"colorRamps",void 0),p([_({type:["multipart"]})],dS.prototype,"type",void 0),dS=fq=p([Q("esri.rest.support.MultipartColorRamp")],dS);const yge=dS,O7e={key:"type",base:EU,typeMap:{algorithmic:CU,multipart:yge}};function L7e(t){return t!=null&&t.type?t.type==="algorithmic"?CU.fromJSON(t):t.type==="multipart"?yge.fromJSON(t):null:null}var gq;const Jg=new Jt({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),kI=new Jt({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),RK=new Jt({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),kK=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers"],V7e=["high-to-low","above-and-below","above","below"],q7e=["flow-line","wave-front"],G7e=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let rr=gq=class extends Te{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&e!=="relationship"?e==="class-breaks-size"||e==="class-breaks-color"?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?L7e(t):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&t!=="relationship"&&t!=="class-breaks-size"&&t!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;t==="classed-size"?e="class-breaks-size":t==="classed-color"&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){var t;return new gq({classificationMethod:this.classificationMethod,colorRamp:he(this.colorRamp),fadeRatio:he(this.fadeRatio),fields:(t=this.fields)==null?void 0:t.slice(),field1:he(this.field1),field2:he(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(e=>e.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};p([_({type:Jg.apiValues,value:null,json:{type:Jg.jsonValues,read:Jg.read,write:Jg.write,origins:{"web-document":{default:"manual",type:Jg.jsonValues,read:Jg.read,write:Jg.write}}}})],rr.prototype,"classificationMethod",null),p([_({types:O7e,json:{write:!0}})],rr.prototype,"colorRamp",void 0),p([qe("colorRamp")],rr.prototype,"readColorRamp",null),p([_({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],rr.prototype,"fadeRatio",void 0),p([_({type:[String],value:null,json:{write:!0}})],rr.prototype,"fields",null),p([_({type:yf,value:null,json:{write:!0}})],rr.prototype,"field1",null),p([_({type:yf,value:null,json:{write:!0}})],rr.prototype,"field2",null),p([_({type:q7e,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],rr.prototype,"flowTheme",null),p([_({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],rr.prototype,"focus",null),p([_({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],rr.prototype,"isAutoGenerated",void 0),p([_({type:Number,value:null,json:{type:fs,write:!0}})],rr.prototype,"numClasses",null),p([_({type:kK,json:{type:kK,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],rr.prototype,"lengthUnit",void 0),p([_({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],rr.prototype,"maxSliderValue",void 0),p([_({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],rr.prototype,"minSliderValue",void 0),p([_({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],rr.prototype,"statistics",null),p([_({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],rr.prototype,"standardDeviationInterval",null),p([_({type:kI.apiValues,value:null,json:{type:kI.jsonValues,read:kI.read,write:kI.write,origins:{"web-scene":{type:RK.jsonValues,write:{writer:RK.write,overridePolicy:t=>({enabled:t!=="flow"})}}}}})],rr.prototype,"type",null),p([_({type:[F7e],json:{write:!0}})],rr.prototype,"visualVariables",void 0),p([_({type:G7e,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],rr.prototype,"univariateSymbolStyle",null),p([_({type:V7e,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],rr.prototype,"univariateTheme",null),rr=gq=p([Q("esri.renderers.support.AuthoringInfo")],rr);const PU=rr,xO=new Jt({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let pS=class extends Te{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const s=new Set;return await this.collectRequiredFields(s,e),Array.from(s).sort()}getSymbol(e,s){}async getSymbolAsync(e,s){}get symbols(){return[]}get arcadeRequired(){return!1}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};p([_({type:PU,json:{write:!0}})],pS.prototype,"authoringInfo",void 0),p([_({type:xO.apiValues,readOnly:!0,json:{type:xO.jsonValues,read:!1,write:{writer:xO.write,ignoreOrigin:!0,isRequired:!0}}})],pS.prototype,"type",void 0),pS=p([Q("esri.renderers.Renderer")],pS);const Gd=pS;let fS=class extends Wt.ClonableMixin(Te){constructor(){super(...arguments),this.showLegend=null,this.title=null}};p([_({type:Boolean,json:{write:!0}})],fS.prototype,"showLegend",void 0),p([_({type:String,json:{write:!0}})],fS.prototype,"title",void 0),fS=p([Q("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],fS);const _ge=fS,wO=new Jt({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let yc=class extends Te{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(Ne.getLogger(this).error(".field: field must be a string value"),null):MC(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};p([_()],yc.prototype,"index",void 0),p([_({type:wO.apiValues,readOnly:!0,json:{read:wO.read,write:{writer:wO.write,isRequired:!0}}})],yc.prototype,"type",void 0),p([_({type:String,json:{write:!0}})],yc.prototype,"field",void 0),p([Ht("field")],yc.prototype,"castField",null),p([_({type:String,json:{write:!0}})],yc.prototype,"valueExpression",void 0),p([_({type:String,json:{write:!0}})],yc.prototype,"valueExpressionTitle",void 0),p([_({readOnly:!0})],yc.prototype,"arcadeRequired",null),p([_({type:_ge,json:{write:!0}})],yc.prototype,"legendOptions",void 0),yc=p([Q("esri.renderers.visualVariables.VisualVariable")],yc);const px=yc;var yq;let Fy=yq=class extends Te{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,s){e[s]=t??0}clone(){return new yq({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};p([_({type:Be,json:{type:[fs],write:{isRequired:!0}}})],Fy.prototype,"color",void 0),p([_({type:String,json:{write:!0}})],Fy.prototype,"label",void 0),p([_({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],Fy.prototype,"value",void 0),p([Ue("value")],Fy.prototype,"writeValue",null),Fy=yq=p([Q("esri.renderers.visualVariables.support.ColorStop")],Fy);const z7e=Fy;var _q;let Oy=_q=class extends px{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,s)=>e.value-s.value),this._set("stops",t)}clone(){var t;return new _q({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(e=>e.clone()),legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};p([_({readOnly:!0})],Oy.prototype,"cache",null),p([_({type:["color"],json:{type:["colorInfo"]}})],Oy.prototype,"type",void 0),p([_({type:String,json:{write:!0}})],Oy.prototype,"normalizationField",void 0),p([_({type:[z7e],json:{write:!0}})],Oy.prototype,"stops",null),Oy=_q=p([Q("esri.renderers.visualVariables.ColorVariable")],Oy);const vge=Oy;var vq;let Kp=vq=class extends Te{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return kE(e.transparency)}writeOpacity(t,e,s){e[s]=a$(t)}clone(){return new vq({label:this.label,opacity:this.opacity,value:this.value})}};p([_({type:String,json:{write:!0}})],Kp.prototype,"label",void 0),p([_({type:Number,json:{type:fs,write:{target:"transparency",isRequired:!0}}})],Kp.prototype,"opacity",void 0),p([qe("opacity",["transparency"])],Kp.prototype,"readOpacity",null),p([Ue("opacity")],Kp.prototype,"writeOpacity",null),p([_({type:Number,json:{write:{isRequired:!0}}})],Kp.prototype,"value",void 0),Kp=vq=p([Q("esri.renderers.visualVariables.support.OpacityStop")],Kp);const U7e=Kp;var bq;let Ly=bq=class extends px{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,s)=>e.value-s.value),this._set("stops",t)}clone(){var t;return new bq({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(e=>e.clone()),legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};p([_({readOnly:!0})],Ly.prototype,"cache",null),p([_({type:["opacity"],json:{type:["transparencyInfo"]}})],Ly.prototype,"type",void 0),p([_({type:String,json:{write:!0}})],Ly.prototype,"normalizationField",void 0),p([_({type:[U7e],json:{write:!0}})],Ly.prototype,"stops",null),Ly=bq=p([Q("esri.renderers.visualVariables.OpacityVariable")],Ly);const TU=Ly;var xq;let Vy=xq=class extends px{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic"}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}clone(){var t;return new xq({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}};p([_({readOnly:!0})],Vy.prototype,"cache",null),p([_({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],Vy.prototype,"axis",void 0),p([_({type:["rotation"],json:{type:["rotationInfo"]}})],Vy.prototype,"type",void 0),p([_({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],Vy.prototype,"rotationType",void 0),Vy=xq=p([Q("esri.renderers.visualVariables.RotationVariable")],Vy);const bge=Vy;function B7e(t){return ms(t)}var wq;let ef=wq=class extends Te{constructor(t){super(t),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new wq({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};p([_({type:String,json:{write:!0}})],ef.prototype,"label",void 0),p([_({type:Number,cast:ms,json:{write:{isRequired:!0}}})],ef.prototype,"size",void 0),p([_({type:Number,json:{write:{isRequired:!0}}})],ef.prototype,"value",void 0),p([_({type:Boolean,json:{write:!1}})],ef.prototype,"useMinValue",void 0),p([_({type:Boolean,json:{write:!1}})],ef.prototype,"useMaxValue",void 0),ef=wq=p([Q("esri.renderers.visualVariables.support.SizeStop")],ef);const AA=ef;let NA=class extends _ge{constructor(){super(...arguments),this.customValues=null}};p([_({type:[Number],json:{write:!0}})],NA.prototype,"customValues",void 0),NA=p([Q("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],NA);const j7e=NA;var Sd,_n;function Dv(t){return t&&t.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function jE(t){return t!=null&&!isNaN(t)&&isFinite(t)}function xge(t){return t.valueExpression?Sd.Expression:t.field&&typeof t.field=="string"?Sd.Field:Sd.Unknown}function H7e(t,e){const s=e||xge(t),i=t.valueUnit||"unknown";return s===Sd.Unknown?_n.Constant:t.stops?_n.Stops:t.minSize!=null&&t.maxSize!=null&&t.minDataValue!=null&&t.maxDataValue!=null?_n.ClampedLinear:i==="unknown"?t.minSize!=null&&t.minDataValue!=null?t.minSize&&t.minDataValue?_n.Proportional:_n.Additive:_n.Identity:_n.RealWorldSize}(function(t){t.Unknown="unknown",t.Expression="expression",t.Field="field"})(Sd||(Sd={})),function(t){t.Unknown="unknown",t.Stops="stops",t.ClampedLinear="clamped-linear",t.Proportional="proportional",t.Additive="additive",t.Constant="constant",t.Identity="identity",t.RealWorldSize="real-world-size"}(_n||(_n={}));const wge=()=>Ne.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),R$=t=>wge().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${t}`),k$=()=>wge().error("Use of arcade expressions requires an arcade context"),FK=new tn,DA=Math.PI,Sge=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function Ege(t,e,s){const i="visualVariables"in t&&t.visualVariables?t.visualVariables.find(g=>g.type==="color"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void R$("ColorVariable");const r=typeof e=="number",n=r?null:e,o=n==null?void 0:n.attributes;let a=r?e:null;const l=i.field,{ipData:u,hasExpression:c}=i.cache;let h=i.cache.compiledFunc;if(!l&&!c){const g=i.stops;return g&&g[0]&&g[0].color}if(typeof a!="number")if(c){if((s==null?void 0:s.arcade)==null)return void k$();const g={viewingMode:s.viewingMode,scale:s.scale,spatialReference:s.spatialReference},v=s.arcade.arcadeUtils,b=v.getViewInfo(g),w=v.createExecContext(n,b,s.timeZone);if(!h){const S=v.createSyntaxTree(i.valueExpression);h=v.createFunction(S),i.cache.compiledFunc=h}a=v.executeFunction(h,w)}else o&&(a=o[l]);const m=i.normalizationField,f=o!=null&&m!=null?parseFloat(o[m]):void 0;if(a!=null&&(!m||r||!isNaN(f)&&f!==0)){isNaN(f)||r||(a/=f);const g=IU(a,u);if(g){const v=g[0],b=g[1],w=v===b?i.stops[v].color:Be.blendColors(i.stops[v].color,i.stops[b].color,g[2],s!=null?s.color:void 0);return new Be(w)}}}function Cge(t,e,s){const i="visualVariables"in t&&t.visualVariables?t.visualVariables.find(g=>g.type==="opacity"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void R$("OpacityVariable");const r=typeof e=="number",n=r?null:e,o=n==null?void 0:n.attributes;let a=r?e:null;const l=i.field,{ipData:u,hasExpression:c}=i.cache;let h=i.cache.compiledFunc;if(!l&&!c){const g=i.stops;return g&&g[0]&&g[0].opacity}if(typeof a!="number")if(c){if((s==null?void 0:s.arcade)==null)return void k$();const g={viewingMode:s.viewingMode,scale:s.scale,spatialReference:s.spatialReference},v=s.arcade.arcadeUtils,b=v.getViewInfo(g),w=v.createExecContext(n,b,s.timeZone);if(!h){const S=v.createSyntaxTree(i.valueExpression);h=v.createFunction(S),i.cache.compiledFunc=h}a=v.executeFunction(h,w)}else o&&(a=o[l]);const m=i.normalizationField,f=o!=null&&m!=null?parseFloat(o[m]):void 0;if(a!=null&&(!m||r||!isNaN(f)&&f!==0)){isNaN(f)||r||(a/=f);const g=IU(a,u);if(g){const v=g[0],b=g[1];if(v===b)return i.stops[v].opacity;{const w=i.stops[v].opacity;return w+(i.stops[b].opacity-w)*g[2]}}}}function Pge(t,e,s){const i="visualVariables"in t&&t.visualVariables?t.visualVariables.find(f=>f.type==="rotation"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void R$("RotationVariable");const r=i.axis||"heading",n=r==="heading"&&i.rotationType==="arithmetic"?90:0,o=r==="heading"&&i.rotationType==="arithmetic"?-1:1,a=typeof e=="number"?null:e,l=a==null?void 0:a.attributes,u=i.field,{hasExpression:c}=i.cache;let h=i.cache.compiledFunc,m=0;if(!u&&!c)return m;if(c){if((s==null?void 0:s.arcade)==null)return void k$();const f={viewingMode:s.viewingMode,scale:s.scale,spatialReference:s.spatialReference},g=s.arcade.arcadeUtils,v=g.getViewInfo(f),b=g.createExecContext(a,v,s.timeZone);if(!h){const w=g.createSyntaxTree(i.valueExpression);h=g.createFunction(w),i.cache.compiledFunc=h}m=g.executeFunction(h,b)}else l&&(m=l[u]||0);return m=typeof m!="number"||isNaN(m)?null:n+o*m,m}function Y7e(t,e,s){const i=typeof e=="number",r=i?null:e,n=r==null?void 0:r.attributes;let o=i?e:null;const{isScaleDriven:a}=t.cache;let l=t.cache.compiledFunc;if(a){const c=s!=null?s.scale:void 0,h=s!=null?s.view:void 0;o=c==null||h==="3d"?X7e(t):c}else if(!i)switch(t.inputValueType){case Sd.Expression:{if((s==null?void 0:s.arcade)==null)return void k$();const c={viewingMode:s.viewingMode,scale:s.scale,spatialReference:s.spatialReference},h=s.arcade.arcadeUtils,m=h.getViewInfo(c),f=h.createExecContext(r,m,s.timeZone);if(!l){const g=h.createSyntaxTree(t.valueExpression);l=h.createFunction(g),t.cache.compiledFunc=l}o=h.executeFunction(l,f);break}case Sd.Field:n&&(o=n[t.field]);break;case Sd.Unknown:o=null}if(!jE(o))return null;if(i||!t.normalizationField)return o;const u=n?parseFloat(n[t.normalizationField]):null;return jE(u)&&u!==0?o/u:null}function X7e(t){let e=null,s=null;const i=t.stops;return i?(e=i[0].value,s=i[i.length-1].value):(e=t.minDataValue||0,s=t.maxDataValue||0),(e+s)/2}function F$(t,e,s){const i="visualVariables"in t&&t.visualVariables?t.visualVariables.find(n=>n.type==="size"):t;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void R$("SizeVariable");const r=Ige(Y7e(i,e,s),i,e,s,i.cache.ipData);return r==null||isNaN(r)?0:r}function Za(t,e,s){return t==null?null:Dv(t)?F$(t,e,s):jE(t)?t:null}function Tge(t,e,s){return jE(s)&&t>s?s:jE(e)&&t<e?e:t}function W7e(t,e,s,i){return t+((Za(e.minSize,s,i)||e.minDataValue)??0)}function Z7e(t,e,s){const i=t.stops;let r=(i==null?void 0:i.length)&&i[0].size;return r==null&&(r=t.minSize),Za(r,e,s)}function Q7e(t,e,s,i){const r=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),n=Za(e.minSize,s,i),o=Za(e.maxSize,s,i),a=i!=null?i.shape:void 0;if(t<=e.minDataValue)return n;if(t>=e.maxDataValue)return o;if(n==null||o==null)return null;if(e.scaleBy==="area"&&a){const l=a==="circle",u=l?DA*(n/2)**2:n*n,c=u+r*((l?DA*(o/2)**2:o*o)-u);return l?2*Math.sqrt(c/DA):Math.sqrt(c)}return n+r*(o-n)}function J7e(t,e,s,i){const r=i!=null?i.shape:void 0,n=t/e.minDataValue,o=Za(e.minSize,s,i),a=Za(e.maxSize,s,i);let l=null;return l=r==="circle"?2*Math.sqrt(n*(o/2)**2):r==="square"||r==="diamond"||r==="image"?Math.sqrt(n*o**2):n*o,Tge(l,o,a)}function K7e(t,e,s,i,r){var l,u,c;const[n,o,a]=IU(t,r);if(n===o)return Za((l=e.stops)==null?void 0:l[n].size,s,i);{const h=Za((u=e.stops)==null?void 0:u[n].size,s,i);return h+(Za((c=e.stops)==null?void 0:c[o].size,s,i)-h)*a}}function eUe(t,e,s,i){const r=((i==null?void 0:i.resolution)??1)*$$[e.valueUnit],n=Za(e.minSize,s,i),o=Za(e.maxSize,s,i),{valueRepresentation:a}=e;let l=null;return l=a==="area"?2*Math.sqrt(t/DA)/r:a==="radius"||a==="distance"?2*t/r:t/r,Tge(l,n,o)}function Ige(t,e,s,i,r){switch(e.transformationType){case _n.Additive:return W7e(t,e,s,i);case _n.Constant:return Z7e(e,s,i);case _n.ClampedLinear:return Q7e(t,e,s,i);case _n.Proportional:return J7e(t,e,s,i);case _n.Stops:return K7e(t,e,s,i,r);case _n.RealWorldSize:return eUe(t,e,s,i);case _n.Identity:return t;case _n.Unknown:return null}}function tUe(t,e,s){const{isScaleDriven:i}=t.cache;if(!(i&&s==="3d"||e))return null;const r={scale:e,view:s};let n=Za(t.minSize,FK,r),o=Za(t.maxSize,FK,r);if(n!=null||o!=null){if(n>o){const a=o;o=n,n=a}return{minSize:n,maxSize:o}}}function sUe(t,e,s){if(!t.visualVariables)return;const i=[],r=[],n=[],o=[],a=[];for(const l of t.visualVariables)switch(l.type){case"color":r.push(l);break;case"opacity":n.push(l);break;case"rotation":a.push(l);break;case"size":o.push(l)}return r.forEach(l=>{const u=Ege(l,e,s);i.push({variable:l,value:u})}),n.forEach(l=>{const u=Cge(l,e,s);i.push({variable:l,value:u})}),a.forEach(l=>{const u=Pge(l,e,s);i.push({variable:l,value:u})}),o.forEach(l=>{const u=F$(l,e,s);i.push({variable:l,value:u})}),i.filter(l=>l.value!=null)}function IU(t,e){if(!e)return;let s=0,i=e.length-1;return e.some((r,n)=>t<r?(i=n,!0):(s=n,!1)),[s,i,(t-e[s])/(e[i]-e[s])]}function iUe(t,e,s){const i=["proportional","proportional","proportional"];for(const r of t){const n=r.useSymbolValue?"symbol-value":F$(r,e,s);switch(r.axis){case"width":i[0]=n;break;case"depth":i[1]=n;break;case"height":i[2]=n;break;case"width-and-depth":i[0]=n,i[1]=n;break;case"all":case void 0:case null:i[0]=n,i[1]=n,i[2]=n;break;default:r.axis}}return i}const O$=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:iUe,getColor:Ege,getOpacity:Cge,getRotationAngle:Pge,getSize:F$,getSizeForValue:Ige,getSizeFromNumberOrVariable:Za,getSizeRangeAtScale:tUe,getVisualVariableValues:sUe,viewScaleRE:Sge},Symbol.toStringTag,{value:"Module"}));var Sq;const FI=new Jt({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),Eq=new Jt({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function OK(t){if(t!=null)return typeof t=="string"||typeof t=="number"?B7e(t):t.type==="size"?Dv(t)?t:(delete(t={...t}).type,new As(t)):void 0}function LK(t,e,s){if(typeof t!="object")return t;const i=new As;return i.read(t,s),i}let As=Sq=class extends px{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&Sge.test(this.valueExpression)}}set index(t){Dv(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),Dv(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return xge(this)}set maxDataValue(t){t&&this.stops&&(Ne.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(Ne.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return OK(t)}readMaxSize(t,e,s){return LK(t,e,s)}set minDataValue(t){t&&this.stops&&(Ne.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(Ne.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return OK(t)}readMinSize(t,e,s){return LK(t,e,s)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(t){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,s)=>e.value-s.value):t&&(Ne.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return H7e(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,s,i){if(t==="$view.scale"){if(i!=null&&i.messages){const r=this.index,n=typeof r=="string"?r:`visualVariables[${r}]`;i.messages.push(new ae("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpression",context:i}))}}else e[s]=t}readValueUnit(t){return t?Eq.read(t):null}clone(){var t,e;return new Sq({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Dv(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Dv(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:(t=this.stops)==null?void 0:t.map(s=>s.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:(e=this.legendOptions)==null?void 0:e.clone()})}flipSizes(){if(this.transformationType===_n.ClampedLinear){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType===_n.Stops){const t=this.stops;if(!t)return this;const e=t.map(i=>i.size).reverse(),s=t.length;for(let i=0;i<s;i++)t[i].size=e[i];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){var t;return(t=this.stops)==null?void 0:t.map(e=>e.value||0)}};p([_({readOnly:!0})],As.prototype,"cache",null),p([_({type:FI.apiValues,json:{type:FI.jsonValues,origins:{"web-map":{read:!1}},read:FI.read,write:FI.write}})],As.prototype,"axis",void 0),p([_()],As.prototype,"index",null),p([_({type:String,readOnly:!0})],As.prototype,"inputValueType",null),p([_({type:j7e,json:{write:!0}})],As.prototype,"legendOptions",void 0),p([_({type:Number,value:null,json:{write:!0}})],As.prototype,"maxDataValue",null),p([_({type:Number,value:null,json:{write:!0}})],As.prototype,"maxSize",null),p([Ht("maxSize")],As.prototype,"castMaxSize",null),p([qe("maxSize")],As.prototype,"readMaxSize",null),p([_({type:Number,value:null,json:{write:!0}})],As.prototype,"minDataValue",null),p([_({type:Number,value:null,json:{write:!0}})],As.prototype,"minSize",null),p([Ht("minSize")],As.prototype,"castMinSize",null),p([qe("minSize")],As.prototype,"readMinSize",null),p([_({type:String,json:{write:!0}})],As.prototype,"normalizationField",void 0),p([_({readOnly:!0})],As.prototype,"arcadeRequired",null),p([_({type:String})],As.prototype,"scaleBy",void 0),p([_({type:[AA],value:null,json:{write:!0}})],As.prototype,"stops",null),p([_({type:["outline"],json:{write:!0}})],As.prototype,"target",void 0),p([_({type:String,readOnly:!0})],As.prototype,"transformationType",null),p([_({type:["size"],json:{type:["sizeInfo"]}})],As.prototype,"type",void 0),p([_({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],As.prototype,"useSymbolValue",void 0),p([_({type:String,json:{write:!0}})],As.prototype,"valueExpression",void 0),p([qe("valueExpression",["valueExpression","expression"])],As.prototype,"readValueExpression",null),p([Ue("web-scene","valueExpression")],As.prototype,"writeValueExpressionWebScene",null),p([_({type:["radius","diameter","area","width","distance"],json:{write:!0}})],As.prototype,"valueRepresentation",void 0),p([_({type:Eq.apiValues,json:{write:Eq.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],As.prototype,"valueUnit",void 0),p([qe("valueUnit")],As.prototype,"readValueUnit",null),As=Sq=p([Q("esri.renderers.visualVariables.SizeVariable")],As);const L$=As,rUe={color:vge,size:L$,opacity:TU,rotation:bge},nUe=new Jt({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),oUe=/^\[([^\]]+)\]$/i;let $A=class extends Ye{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e==null?void 0:e.filter(s=>!!s),e==null?void 0:e.length){for(const s of e)switch(s.type){case"color":this.colorVariables.push(s);break;case"opacity":this.opacityVariables.push(s);break;case"rotation":this.rotationVariables.push(s);break;case"size":this.sizeVariables.push(s)}this.sizeVariables.length&&this.sizeVariables.some(s=>!!s.target)&&e.sort((s,i)=>{let r=null;return r=s.target===i.target?0:s.target?1:-1,r});for(let s=0;s<e.length;s++)e[s].index=s;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,s,i){const{rotationExpression:r,rotationType:n}=s,o=r==null?void 0:r.match(oUe),a=o==null?void 0:o[1];if(a&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:n,field:a})),e)return e.map(l=>{const u=nUe.read(l.type),c=rUe[u];c||(Ne.getLogger(this).warn(`Unknown variable type: ${u}`),i!=null&&i.messages&&i.messages.push(new qu("visual-variable:unsupported",`visualVariable of type '${u}' is not supported`,{definition:l,context:i})));const h=new c;return h.read(l,i),h})}writeVariables(e,s){const i=[];for(const r of e){const n=r.toJSON(s);n&&i.push(n)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};p([_()],$A.prototype,"visualVariables",null),$A=p([Q("esri.renderers.visualVariables.VisualVariableFactory")],$A);const aUe=$A,lUe={base:px,key:"type",typeMap:{opacity:TU,color:vge,rotation:bge,size:L$}},fx=t=>{let e=class extends t{constructor(){super(...arguments),this._vvFactory=new aUe}set visualVariables(s){this._vvFactory.visualVariables=s,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(s,i,r){return this._vvFactory.readVariables(s,i,r)}writeVisualVariables(s,i,r,n){i[r]=this._vvFactory.writeVariables(s,n)}get arcadeRequiredForVisualVariables(){var s;return((s=this.visualVariables)==null?void 0:s.some(({arcadeRequired:i})=>i))??!1}hasVisualVariables(s,i){return s?this.getVisualVariablesForType(s,i).length>0:this.getVisualVariablesForType("size",i).length>0||this.getVisualVariablesForType("color",i).length>0||this.getVisualVariablesForType("opacity",i).length>0||this.getVisualVariablesForType("rotation",i).length>0}getVisualVariablesForType(s,i){var r;return((r=this.visualVariables)==null?void 0:r.filter(n=>n.type===s&&(typeof i=="string"?n.target===i:i!==!1||!n.target)))??[]}async collectVVRequiredFields(s,i){let r=[];this.visualVariables&&(r=r.concat(this.visualVariables));for(const n of r)n&&(n.field&&va(s,i,n.field),n.normalizationField&&va(s,i,n.normalizationField),n.valueExpression&&(uUe(n.valueExpression,s,i)||await Go(s,i,n.valueExpression)))}};return p([_({types:[lUe],value:null,json:{write:!0}})],e.prototype,"visualVariables",null),p([qe("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null),p([Ue("visualVariables")],e.prototype,"writeVisualVariables",null),e=p([Q("esri.renderers.mixins.VisualVariablesMixin")],e),e};function uUe(t,e,s){const i=Yke(t);return i!=null&&(va(e,s,i),!0)}const A3=rm.fromJSON(jfe),MU=tl.fromJSON(Hfe),Mge=bg.fromJSON(Yfe),cUe=hx.fromJSON($ze);function y_t(t){if(t==null)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return A3;case"polyline":return MU;case"polygon":case"extent":return Mge}return null}const __t=rm.fromJSON(Rze),v_t=tl.fromJSON(kze),b_t=bg.fromJSON(Fze),hUe=yd.fromSimpleMarkerSymbol(A3),mUe=x0.fromSimpleLineSymbol(MU),dUe=vg.fromSimpleFillSymbol(Mge),pUe=new rP({symbolLayers:new Ge([new b0({material:{color:_U},edges:new Cme({size:Zl(1),color:new Be(Dze)})})])}),fUe=new x0({symbolLayers:new Ge([new ux({material:{color:new Be([0,0,0])},size:Zl(1)})])}),gUe=new vg({symbolLayers:new Ge([new b0({outline:{color:new Be([0,0,0]),size:Zl(1)}})])});function x_t(t){if(t==null)return null;switch(t.type){case"mesh":return pUe;case"point":case"multipoint":return hUe;case"polyline":return mUe;case"polygon":case"extent":return dUe}return null}const VK="#useCIMFallbackSymbology()",E1={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function yUe(t,e=E1){var l,u,c,h;if(!t)return{symbol:null};const{retainId:s=E1.retainId,ignoreDrivers:i=E1.ignoreDrivers,hasLabelingContext:r=E1.hasLabelingContext,retainCIM:n=E1.retainCIM,cimFallbackEnabled:o=E1.cimFallbackEnabled}=e;let a=null;if(xg(t)||t instanceof tg)a=t.clone();else if(t.type==="cim"){const m=(u=(l=t.data)==null?void 0:l.symbol)==null?void 0:u.type;switch(m){case"CIMPointSymbol":a=n?t.clone():yd.fromCIMSymbol(t);break;case"CIMLineSymbol":o&&(a=fUe.clone(),(c=e==null?void 0:e.logWarning)==null||c.call(e,VK,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":o&&(a=gUe.clone(),(h=e==null?void 0:e.logWarning)==null||h.call(e,VK,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!a)return{error:new ae("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${m||"unknown"}' is unsupported in 3D`,{symbol:t})}}else if(t instanceof tl)a=x0.fromSimpleLineSymbol(t);else if(t instanceof rm)a=yd.fromSimpleMarkerSymbol(t);else if(t instanceof nP)a=yd.fromPictureMarkerSymbol(t);else if(t instanceof bg)a=e.geometryType&&e.geometryType==="mesh"?rP.fromSimpleFillSymbol(t):vg.fromSimpleFillSymbol(t);else{if(!(t instanceof hx))return{error:new ae("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};a=r?y$.fromTextSymbol(t):yd.fromTextSymbol(t)}return s&&a&&a.type!=="cim"&&(a.id=t.id),!i||a.type==="cim"||a instanceof tg||a.symbolLayers.forEach(m=>m.ignoreDrivers=!0),{symbol:a}}function N3(t,e,s,i){const r=Age(t,{},{context:i,isLabelSymbol:!1});r!=null&&(e[s]=r)}function qK(t,e,s,i){const r=Age(t,{},{context:i,isLabelSymbol:!0});r!=null&&(e[s]=r)}function GK(t){return xg(t)||t instanceof tg}function _Ue(t){return(t==null?void 0:t.type)==="polygon-3d"||(t==null?void 0:t.type)==="line-3d"}function Age(t,e,s){var a;if(t==null)return null;const{context:i,isLabelSymbol:r}=s,n=i==null?void 0:i.origin,o=i==null?void 0:i.messages;if(n==="web-scene"&&!GK(t)){const l=yUe(t,{retainCIM:!0,hasLabelingContext:r});return l.symbol!=null?l.symbol.write(e,i):(o==null||o.push(new ae("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:i,error:l.error})),null)}return K5(i==null?void 0:i.layer)&&_Ue(t)?(o==null||o.push(new ae("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported on layers of type '${(a=i==null?void 0:i.layer)==null?void 0:a.declaredClass}'.`,{symbol:t,context:i})),null):(n==="web-map"||n==="portal-item"&&!K5(i==null?void 0:i.layer))&&GK(t)?(o==null||o.push(new ae("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:i})),null):t.write(e,i)}function Nge(t,e){return R4e(t,null,e)}const V$={types:tde,json:{write:{writer:N3},origins:{"web-scene":{types:CQ,write:{writer:N3},read:{reader:Jb({types:CQ})}}}}},AU=hz({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},V$),NU={types:{base:go,key:"type",typeMap:{"simple-fill":Nf.typeMap["simple-fill"],"picture-fill":Nf.typeMap["picture-fill"],"polygon-3d":Nf.typeMap["polygon-3d"],cim:Nf.typeMap.cim}},json:{write:{writer:N3},origins:{"web-scene":{type:vg,write:{writer:N3}}}}},RA={cast:t=>t==null||typeof t=="string"||typeof t=="number"?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t==null?void 0:t.toString()}}}};var Cq;let qy=Cq=class extends fx(Gd){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.symbols.map(s=>s.collectRequiredFields(t,e)))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}get symbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,s)=>e+s.getAttributeHash(),""))??""}getMeshHash(){return this.symbols.reduce((t,e)=>t+JSON.stringify(e),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new Cq({description:this.description,label:this.label,symbol:he(this.symbol),visualVariables:he(this.visualVariables),authoringInfo:he(this.authoringInfo)})}};p([_({type:String,json:{write:!0}})],qy.prototype,"description",void 0),p([_({type:String,json:{write:!0}})],qy.prototype,"label",void 0),p([_(AU)],qy.prototype,"symbol",void 0),p([mt({simple:"simple"})],qy.prototype,"type",void 0),qy=Cq=p([Q("esri.renderers.SimpleRenderer")],qy);const Yh=qy,vUe=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function Pq(t){return t instanceof Ye}function zK(t){return t instanceof Ge?Object.keys(t.items):Pq(t)?Ja(t).keys():t?Object.keys(t):[]}function OI(t,e){return t instanceof Ge?t.items[e]:t[e]}function bUe(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function oE(t){return t?t.declaredClass:null}function Dge(t,e){var h;const s=t.diff;if(s&&typeof s=="function")return s(t,e);const i=zK(t),r=zK(e);if(i.length===0&&r.length===0)return;if(!i.length||!r.length||bUe(t,e))return{type:"complete",oldValue:t,newValue:e};const n=r.filter(m=>!i.includes(m)),o=i.filter(m=>!r.includes(m)),a=i.filter(m=>r.includes(m)&&OI(t,m)!==OI(e,m)).concat(n,o).sort(),l=oE(t);if(l&&vUe.has(l)&&a.length)return{type:"complete",oldValue:t,newValue:e};let u;const c=Pq(t)&&Pq(e);for(const m of a){const f=OI(t,m),g=OI(e,m);let v;if((c||typeof f!="function"&&typeof g!="function")&&f!==g&&(f!=null||g!=null)){if(s&&s[m]&&typeof s[m]=="function")v=(h=s[m])==null?void 0:h.call(s,f,g);else if(f instanceof Date&&g instanceof Date){if(f.getTime()===g.getTime())continue;v={type:"complete",oldValue:f,newValue:g}}else v=typeof f=="object"&&typeof g=="object"&&oE(f)===oE(g)?Dge(f,g):{type:"complete",oldValue:f,newValue:g};v!=null&&(u!=null?u.diff[m]=v:u={type:"partial",diff:{[m]:v}})}}return u}function w_t(t,e){return xUe(t,e)}function xUe(t,e){if(t==null)return!1;const s=e.split(".");let i=t;for(const r of s){if(i.type==="complete")return!0;if(i.type!=="partial")return!1;{const n=i.diff[r];if(!n)return!1;i=n}}return!0}function S_t(t,e){if(!t)return!1;if(t.type==="partial"){const s=Object.keys(t.diff);return s.length===1&&s[0]===e}return!1}function wUe(t,e){if(typeof t!="function"&&typeof e!="function"&&(t!=null||e!=null))return t==null||e==null||typeof t=="object"&&typeof e=="object"&&oE(t)!==oE(e)?{type:"complete",oldValue:t,newValue:e}:Dge(t,e)}function LI(t){if(t==null)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const s of e.added)if(!LI(s))return!1;for(const s of e.removed)if(!LI(s))return!1;for(const s of e.changed)if(!LI(s))return!1;return!0}case"partial":for(const e in t.diff)if(!LI(t.diff[e]))return!1;return!0}}var Tq;const SUe=Xn()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let gS=Tq=class extends Wt.ClonableMixin(Te){static from(t){return Qb(Tq,t)}constructor(t){super(t),this.title=null,this.order=null}};p([_({type:String,json:{write:!0}})],gS.prototype,"title",void 0),p([mt(SUe)],gS.prototype,"order",void 0),gS=Tq=p([Q("esri.renderers.support.RendererLegendOptions")],gS);const DU=gS;let av=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};p([_(RA)],av.prototype,"value",void 0),p([_(RA)],av.prototype,"value2",void 0),p([_(RA)],av.prototype,"value3",void 0),av=p([Q("esri.renderers.support.UniqueValue")],av);const nb=av;let tf=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const s=typeof(e=Array.isArray(e)?e:[e])[0];return s==="string"||s==="number"?e.map(i=>new nb({value:i})):s==="object"?e[0]instanceof nb?e:e.map(i=>new nb(i)):null}};p([_({type:String,json:{write:!0}})],tf.prototype,"description",void 0),p([_({type:String,json:{write:!0}})],tf.prototype,"label",void 0),p([_(V$)],tf.prototype,"symbol",void 0),p([_({type:[nb],json:{type:[[String]],read:{reader:t=>t?t.map(e=>new nb({value:e[0],value2:e[1],value3:e[2]})):null},write:{writer:(t,e)=>{const s=[];for(const i of t){const r=[i.value,i.value2,i.value3].filter(Qa).map(n=>n.toString());s.push(r)}e.values=s}}}})],tf.prototype,"values",void 0),p([Ht("values")],tf.prototype,"castValues",null),tf=p([Q("esri.renderers.support.UniqueValueClass")],tf);const $ge=tf;let yS=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.heading=null,this.classes=null}};p([_({type:String,json:{write:!0}})],yS.prototype,"heading",void 0),p([_({type:[$ge],json:{write:{isRequired:!0}}})],yS.prototype,"classes",void 0),yS=p([Q("esri.renderers.support.UniqueValueGroup")],yS);const Iq=yS;var Mq;let Gy=Mq=class extends Te{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new Mq({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){var e;const t=JSON.stringify((e=this.symbol)==null?void 0:e.toJSON());return`${this.value}.${t}`}};p([_({type:String,json:{write:!0}})],Gy.prototype,"description",void 0),p([_({type:String,json:{write:!0}})],Gy.prototype,"label",void 0),p([_(AU)],Gy.prototype,"symbol",void 0),p([_(RA)],Gy.prototype,"value",void 0),Gy=Mq=p([Q("esri.renderers.support.UniqueValueInfo")],Gy);const aE=Gy,UK=new Map;async function EUe(t,e){try{return{data:(await $U(t,e)).data,baseUrl:Dz(t),styleUrl:t}}catch(s){return Nc(s),null}}function CUe(t,e,s){var l;const i=e.portal!=null?e.portal:qo.getDefault();let r;const n=`${i.url} - ${(l=i.user)==null?void 0:l.username} - ${t}`,o=UK.get(n);if(o)return o;const a=PUe(t,i,s).then(u=>(r=u,u.fetchData())).then(u=>({data:u,baseUrl:r.itemUrl??"",styleName:t}));return UK.set(n,a),a}function PUe(t,e,s){return e.load(s).then(()=>{const i=new Rc({disableExtraQuery:!0,query:`owner:${BK} AND type:${jK} AND typekeywords:"${t}"`});return e.queryItems(i,s)}).then(({results:i})=>{var o;let r=null;const n=t.toLowerCase();if(i&&Array.isArray(i)){for(const a of i)if(((o=a.typeKeywords)==null?void 0:o.some(u=>u.toLowerCase()===n))&&a.type===jK&&a.owner===BK){r=a;break}}if(!r)throw new ae("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return r.load(s)})}function Rge(t,e,s){return(t==null?void 0:t.styleUrl)!=null?EUe(t.styleUrl,s):(t==null?void 0:t.styleName)!=null?CUe(t.styleName,e,s):Promise.reject(new ae("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function kge(t){return t===null||t.type==="CIMSymbolReference"?t:{type:"CIMSymbolReference",symbol:t}}function TUe(t,e){for(const s of e)switch(s){case"cim":if(t.cimRef)return{format:s,url:encodeURI(t.cimRef)};break;case"web-gltf-basisu":{const i=SO(t,"gltf_basisu");if(i)return{format:s,url:i};break}case"web-gltf":{const i=SO(t,"gltf");if(i)return{format:s,url:i};break}case"web":{const i=SO(t,"gltf");if(i)return{format:"web-gltf",url:i};if(t.webRef)return{format:s,url:encodeURI(t.webRef)};break}}}function SO(t,e){var s,i;if(!ge("enable-feature:force-wosr"))return(i=(s=t.formatInfos)==null?void 0:s.find(r=>r.type===e))==null?void 0:i.href}function $U(t,e){const s={responseType:"json",query:{f:"json"},...e};return js(Gc(t),s)}const BK="esri_en",jK="Style",IUe="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var _S;const Fge="esri.renderers.UniqueValueRenderer",Tp=()=>Ne.getLogger(Fge),HK="uvInfos-watcher",YK="uvGroups-watcher",MUe=",",AUe=nn(aE);function NUe(t){const{field1:e,field2:s,field3:i,fieldDelimiter:r,uniqueValueInfos:n,valueExpression:o}=t,a=!(!e||!s);return[{classes:(n??[]).map(l=>{var w;const{symbol:u,label:c,value:h,description:m}=l,[f,g,v]=a?((w=h==null?void 0:h.toString())==null?void 0:w.split(r||""))||[]:[h],b=[];return(e||o)&&b.push(f),s&&b.push(g),i&&b.push(v),{symbol:u,label:c,values:[b],description:m}})}]}function C1(t){return t!=null&&t!==""&&(typeof t!="string"||t.trim()!==""&&t.toLowerCase()!=="<null>")||(t=null),t+""}let Ri=_S=class extends fx(Gd){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,s){if(!e&&!s)return;if(!e||!s)return{type:"complete",oldValue:e,newValue:s};let i=!1;const r={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let n=0;n<s.length;n++){const o=e.find(a=>a.value===s[n].value);o?wUe(o,s[n])?(r.changed.push({type:"complete",oldValue:o,newValue:s[n]}),i=!0):r.unchanged.push({oldValue:o,newValue:s[n]}):(r.added.push(s[n]),i=!0)}for(let n=0;n<e.length;n++)s.find(o=>o.value===e[n].value)||(r.removed.push(e[n]),i=!0);return i?r:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return t==null||typeof t=="function"?t:MC(t)}writeField(t,e,s,i){typeof t=="string"?e[s]=t:i!=null&&i.messages?i.messages.push(new ae("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):Tp().error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,s){return s.portal||qo.getDefault()}readStyleOrigin(t,e,s){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const i=Zf(e.styleUrl,s);return Object.freeze({styleUrl:i})}}writeStyleOrigin(t,e,s,i){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=LC(t.styleUrl,i))}set uniqueValueGroups(t){this.styleOrigin?Tp().error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?Tp().error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){var i;if(this.styleOrigin)return void Tp().error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let s;s=typeof t=="object"?AUe(t):new aE({value:t,symbol:sde(e)}),(i=this.uniqueValueInfos)==null||i.push(s),this._valueInfoMap[C1(s.value)]=s,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void Tp().error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e)for(let s=0;s<e.length;s++){const i=e[s];if(String(i.value)===String(t)){delete this._valueInfoMap[C1(t)],e.splice(s,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let s=e;return this.valueExpression&&(e==null?void 0:e.arcade)==null&&(s={...s,arcade:await Zc()}),this._getUniqueValueInfo(t,s)}getSymbol(t,e){if(this.valueExpression&&(e==null?void 0:e.arcade)==null)return void Tp().error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const s=this._getUniqueValueInfo(t,e);return(s==null?void 0:s.symbol)||this.defaultSymbol}async getSymbolAsync(t,e){let s=e;if(this.valueExpression&&(s==null?void 0:s.arcade)==null){const r=await Zc(),{arcadeUtils:n}=r;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),s={...s,arcade:r}}const i=this._getUniqueValueInfo(t,s);return(i==null?void 0:i.symbol)||this.defaultSymbol}get symbols(){const t=[];for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,s)=>e+s.getAttributeHash(),""))??""}getMeshHash(){var i;const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),s=(i=this.uniqueValueInfos)==null?void 0:i.reduce((r,n)=>r+n.getMeshHash(),"");return`${t}.${e}.${s}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new _S({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:he(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:he(this.visualVariables),legendOptions:he(this.legendOptions),authoringInfo:he(this.authoringInfo),backgroundFillSymbol:he(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=he(this.uniqueValueInfos),s=he(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(he(this.styleOrigin))),Object.freeze(e),Object.freeze(s)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",s),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const s=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(s)}async collectSymbolFields(t,e){const s=[...this.symbols.map(i=>i.collectRequiredFields(t,e)),Go(t,e,this.valueExpression)];va(t,e,this.field),va(t,e,this.field2),va(t,e,this.field3),await Promise.all(s)}populateFromStyle(){return Rge(this.styleOrigin,{portal:this.portal}).then(t=>{var s;const e=[];return this._valueInfoMap={},t!=null&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach(i=>{const r=new tg({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==t.data.defaultItem||(this.defaultSymbol=r,this._isDefaultSymbolDerived=!0);const n=new aE({value:i.name,symbol:r});e.push(n),this._valueInfoMap[C1(i.name)]=n}),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&((s=this.uniqueValueInfos)!=null&&s.length)&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",MUe)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[C1(e.value)]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(HK);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const s of t)e.push(Ee(()=>({symbol:s.symbol,value:s.value,label:s.label,description:s.description}),(i,r)=>{i!==r&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(e,HK)}}_watchUniqueValueGroups(){this.removeHandles(YK);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const s of t){e.push(Ee(()=>({classes:s.classes}),(i,r)=>{i!==r&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const i of s.classes??[])e.push(Ee(()=>({symbol:i.symbol,values:i.values,label:i.label,description:i.description}),(r,n)=>{r!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(e,YK)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:s,field3:i,fieldDelimiter:r,uniqueValueGroups:n,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!e||!s);for(const l of n)for(const u of l.classes??[]){const{symbol:c,label:h,values:m,description:f}=u;for(const g of m??[]){const{value:v,value2:b,value3:w}=g,S=[v];s&&S.push(b),i&&S.push(w);const T=a?S.join(r||""):S[0]??void 0;t.push(new aE({symbol:c,label:h,value:T,description:f}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:s,valueExpression:i,fieldDelimiter:r,uniqueValueInfos:n}=this;if(!e&&!i||!n.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!s),a=n.map(u=>{var w;const{symbol:c,label:h,value:m,description:f}=u,[g,v,b]=o?((w=m==null?void 0:m.toString())==null?void 0:w.split(r||""))||[]:[m];return new $ge({symbol:c,label:h,description:f,values:[new nb({value:g,value2:v,value3:b})]})}),l=[new Iq({classes:a})];t&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:s,scale:i,spatialReference:r,arcade:n,timeZone:o}=e??{};let a=this._cache.compiledFunc;const l=n.arcadeUtils;if(!a){const c=l.createSyntaxTree(this.valueExpression);a=l.createFunction(c),this._cache.compiledFunc=a}const u=l.executeFunction(a,l.createExecContext(t,l.getViewInfo({viewingMode:s,scale:i,spatialReference:r}),o));return this._valueInfoMap[C1(u)]}_getUnqiueValueInfoForFields(t){const e=this.field,s=t.attributes;let i;if(this.field2){const r=this.field2,n=this.field3,o=[];e&&o.push(s[e]),r&&o.push(s[r]),n&&o.push(s[n]),i=o.join(this.fieldDelimiter||"")}else e&&(i=s[e]);return this._valueInfoMap[C1(i)]}static fromPortalStyle(t,e){const s=new _S(e==null?void 0:e.properties);s._set("styleOrigin",Object.freeze({styleName:t})),s._set("portal",(e==null?void 0:e.portal)||qo.getDefault());const i=s.populateFromStyle();return i.catch(r=>{Tp().error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",r)}),i}static fromStyleUrl(t,e){const s=new _S(e==null?void 0:e.properties);s._set("styleOrigin",Object.freeze({styleUrl:t}));const i=s.populateFromStyle();return i.catch(r=>{Tp().error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",r)}),i}};p([_({readOnly:!0})],Ri.prototype,"_cache",null),p([mt({uniqueValue:"unique-value"})],Ri.prototype,"type",void 0),p([_(NU)],Ri.prototype,"backgroundFillSymbol",void 0),p([_({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],Ri.prototype,"field",null),p([Ht("field")],Ri.prototype,"castField",null),p([Ue("field")],Ri.prototype,"writeField",null),p([_({type:String,value:null,json:{write:!0}})],Ri.prototype,"field2",null),p([_({type:String,value:null,json:{write:!0}})],Ri.prototype,"field3",null),p([_({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],Ri.prototype,"orderByClassesEnabled",void 0),p([_({type:String,value:null,json:{write:!0}})],Ri.prototype,"valueExpression",null),p([_({type:String,json:{write:!0}})],Ri.prototype,"valueExpressionTitle",void 0),p([_({type:DU,json:{write:!0}})],Ri.prototype,"legendOptions",void 0),p([_({type:String,json:{write:!0}})],Ri.prototype,"defaultLabel",void 0),p([_(hz({...V$},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],Ri.prototype,"defaultSymbol",null),p([_({type:String,value:null,json:{write:!0}})],Ri.prototype,"fieldDelimiter",null),p([_({type:qo,readOnly:!0})],Ri.prototype,"portal",void 0),p([qe("portal",["styleName"])],Ri.prototype,"readPortal",null),p([_({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],Ri.prototype,"styleOrigin",void 0),p([qe("styleOrigin",["styleName","styleUrl"])],Ri.prototype,"readStyleOrigin",null),p([Ue("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],Ri.prototype,"writeStyleOrigin",null),p([_({type:[Iq],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,s)=>(e.uniqueValueGroups||NUe(e)).map(i=>Iq.fromJSON(i,s))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],Ri.prototype,"uniqueValueGroups",null),p([_({type:[aE],json:{read:!1,write:{isRequired:!0,overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0,isRequired:!0}}}}})],Ri.prototype,"uniqueValueInfos",null),Ri=_S=p([Q(Fge)],Ri);const RU=Ri;var Aq;let fn=Aq=class extends Te{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.orderByFields=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new Aq(he({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};p([_({type:[String],json:{write:!0}})],fn.prototype,"attachmentTypes",void 0),p([_({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],fn.prototype,"attachmentsWhere",void 0),p([_({type:Boolean,json:{write:!0}})],fn.prototype,"cacheHint",void 0),p([_({type:[String],json:{write:!0}})],fn.prototype,"keywords",void 0),p([_({type:[String],json:{write:!0}})],fn.prototype,"globalIds",void 0),p([_({json:{write:!0}})],fn.prototype,"name",void 0),p([_({type:Number,json:{read:{source:"resultRecordCount"}}})],fn.prototype,"num",void 0),p([_({type:[Number],json:{write:!0}})],fn.prototype,"objectIds",void 0),p([_({type:[String],json:{write:!0}})],fn.prototype,"orderByFields",void 0),p([_({type:Boolean,json:{default:!1,write:!0}})],fn.prototype,"returnMetadata",void 0),p([_({type:[Number],json:{write:!0}})],fn.prototype,"size",void 0),p([_({type:Number,json:{read:{source:"resultOffset"}}})],fn.prototype,"start",void 0),p([Ue("start"),Ue("num")],fn.prototype,"writeStart",null),p([_({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],fn.prototype,"where",void 0),fn=Aq=p([Q("esri.rest.support.AttachmentQuery")],fn),fn.from=nn(fn);const Nq=fn,Oge=Xn()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),XK="percent-of-total",WK="field",T_t=t=>{let e=class extends t{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let s=this._get("normalizationType");const i=!!this.normalizationField,r=this.normalizationTotal!=null;return i||r?(s=i&&WK||r&&XK||null,i&&r&&Ne.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):s!==WK&&s!==XK||(s=null),s}set normalizationType(s){this._set("normalizationType",s)}};return p([_({type:String,json:{name:"parameters.normalizationField",write:!0}})],e.prototype,"normalizationField",void 0),p([_({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],e.prototype,"normalizationMaxValue",void 0),p([_({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],e.prototype,"normalizationMinValue",void 0),p([_({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],e.prototype,"normalizationTotal",void 0),p([mt(Oge,{name:"parameters.normalizationType"})],e.prototype,"normalizationType",null),e=p([Q("esri.rest.support.NormalizationBinParametersMixin")],e),e};var Dq;let ji=Dq=class extends Te{constructor(t){super(t),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(e.definitionExpression="1=1")}clone(){return new Dq(he({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};p([_({type:Boolean,json:{write:!0}})],ji.prototype,"cacheHint",void 0),p([_({type:Ic,json:{write:!0}})],ji.prototype,"dynamicDataSource",void 0),p([_({type:String,json:{write:!0}})],ji.prototype,"gdbVersion",void 0),p([_({type:Number,json:{write:!0}})],ji.prototype,"geometryPrecision",void 0),p([_({type:Date})],ji.prototype,"historicMoment",void 0),p([Ue("historicMoment")],ji.prototype,"_writeHistoricMoment",null),p([_({type:Number,json:{write:!0}})],ji.prototype,"maxAllowableOffset",void 0),p([_({json:{write:!0}})],ji.prototype,"objectIds",void 0),p([_({type:[String],json:{write:!0}})],ji.prototype,"orderByFields",void 0),p([_({type:[String],json:{write:!0}})],ji.prototype,"outFields",void 0),p([_({type:St,json:{read:{source:"outSR"},write:{target:"outSR"}}})],ji.prototype,"outSpatialReference",void 0),p([_({json:{write:!0}})],ji.prototype,"relationshipId",void 0),p([_({type:Number,json:{read:{source:"resultOffset"}}})],ji.prototype,"start",void 0),p([Ue("start"),Ue("num")],ji.prototype,"writeStart",null),p([_({type:Number,json:{read:{source:"resultRecordCount"}}})],ji.prototype,"num",void 0),p([_({json:{write:!0}})],ji.prototype,"returnGeometry",void 0),p([_({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],ji.prototype,"returnM",void 0),p([_({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],ji.prototype,"returnZ",void 0),p([_({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],ji.prototype,"where",void 0),ji=Dq=p([Q("esri.rest.support.RelationshipQuery")],ji),ji.from=nn(ji);const Rb=ji,I_t=Object.freeze(Object.defineProperty({__proto__:null,default:Rb},Symbol.toStringTag,{value:"Module"})),$q=new Jt({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function DUe(t,e,s,i){const r=await wg(t);if(await kU(t,e,i),!r.addAttachment)throw new ae(i,"Layer source does not support addAttachment capability");return r.addAttachment(e,s)}function kU(t,e,s){var n,o;const{attributes:i}=e,{objectIdField:r}=t;return(o=(n=t.capabilities)==null?void 0:n.data)!=null&&o.supportsAttachment?e?i?r&&i[r]?Promise.resolve():Promise.reject(new ae(s,`feature is missing the identifying attribute ${r}`)):Promise.reject(new ae(s,"'attributes' are required on a feature to query attachments")):Promise.reject(new ae(s,"A feature is required to add/delete/update attachments")):Promise.reject(new ae(s,"this layer doesn't support attachments"))}async function $Ue(t,e,s,i,r){const n=await wg(t);if(await kU(t,e,r),!n.updateAttachment)throw new ae(r,"Layer source does not support updateAttachment capability");return n.updateAttachment(e,s,i)}async function RUe(t,e,s){const{applyEdits:i}=await me(()=>import("./editingSupport-LSxn7lAP.js"),[]),r=await t.load();let n=s;return r.type==="feature"&&r.infoFor3D&&e.deleteFeatures!=null&&r.globalIdField!=null&&(n={...n,globalIdToObjectId:await s9e(r,e.deleteFeatures,r.globalIdField)}),i(r,r.source,e,s)}async function kUe(t,e,s){const{uploadAssets:i}=await me(()=>import("./editingSupport-LSxn7lAP.js"),[]),r=await t.load();return i(r,r.source,e,s)}async function FUe(t,e,s,i){const r=await wg(t);if(await kU(t,e,i),!r.deleteAttachments)throw new ae(i,"Layer source does not support deleteAttachments capability");return r.deleteAttachments(e,s)}async function OUe(t,e,s){const i=(await t.load({signal:e==null?void 0:e.signal})).source;if(!i.fetchRecomputedExtents)throw new ae(s,"Layer source does not support fetchUpdates capability");return i.fetchRecomputedExtents(e)}async function LUe(t,e,s,i){var f,g,v,b;e=Nq.from(e),await t.load();const r=t.source,n=t.capabilities;if(!((f=n==null?void 0:n.data)!=null&&f.supportsAttachment))throw new ae(i,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:a,globalIds:l,num:u,size:c,start:h,where:m}=e;if(!((g=n==null?void 0:n.operations)!=null&&g.supportsQueryAttachments)&&((o==null?void 0:o.length)>0||(l==null?void 0:l.length)>0||(c==null?void 0:c.length)>0||u||h||m))throw new ae(i,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(a!=null&&a.length||l!=null&&l.length||m))throw new ae(i,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!r.queryAttachments)throw new ae(i,"Layer source does not support queryAttachments capability",e);return!((v=n==null?void 0:n.attachment)!=null&&v.supportsOrderByFields)&&((b=e.orderByFields)!=null&&b.length)&&((e=e.clone()).orderByFields=null),r.queryAttachments(e)}async function VUe(t,e,s,i){const r=await wg(t);if(!r.queryObjectIds)throw new ae(i,"Layer source does not support queryObjectIds capability");return r.queryObjectIds(xn.from(e)??t.createQuery(),s)}async function qUe(t,e,s,i){const r=await wg(t);if(!r.queryFeatureCount)throw new ae(i,"Layer source does not support queryFeatureCount capability");return r.queryFeatureCount(xn.from(e)??t.createQuery(),s)}async function GUe(t,e,s,i){const r=await wg(t);if(!r.queryExtent)throw new ae(i,"Layer source does not support queryExtent capability");return r.queryExtent(xn.from(e)??t.createQuery(),s)}async function zUe(t,e,s,i){const r=await wg(t);if(!r.queryRelatedFeatures)throw new ae(i,"Layer source does not support queryRelatedFeatures capability");return r.queryRelatedFeatures(Rb.from(e),s)}async function UUe(t,e,s,i){const r=await wg(t);if(!r.queryRelatedFeaturesCount)throw new ae(i,"Layer source does not support queryRelatedFeaturesCount capability");return r.queryRelatedFeaturesCount(Rb.from(e),s)}async function BUe(t){const e=t.source;if(e!=null&&e.refresh)try{const{dataChanged:s,updates:i}=await e.refresh();if(i!=null&&(t.sourceJSON={...t.sourceJSON,...i},t.read(i,{origin:"service",url:t.parsedUrl})),s)return!0}catch{}if(t.definitionExpression)try{return(await Zhe(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function jUe(t){var o,a;const e=new xn,s=(o=t.capabilities)==null?void 0:o.data,i=(a=t.capabilities)==null?void 0:a.query;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,i&&(e.compactGeometryEnabled=i.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=i.supportsDefaultSpatialReference),s&&(s.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),s.supportsM&&t.returnM!=null&&(e.returnM=t.returnM)),e.outFields=["*"];const{timeOffset:r,timeExtent:n}=t;return e.timeExtent=r!=null&&n!=null?n.offset(-r.value,r.unit):n||null,e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null,e}function Lge(t){const{globalIdField:e,fields:s}=t;if(e)return e;if(s){for(const i of s)if(i.type==="esriFieldTypeGlobalID")return i.name}}function Vge(t){const{objectIdField:e,fields:s}=t;if(e)return e;if(s){for(const i of s)if(i.type==="esriFieldTypeOID")return i.name}}function HUe(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function YUe(t,e,s,i){var l,u;const r=s==null?void 0:s.feature,n=!!((l=t.subtypes)!=null&&l.length);if(n&&!(s!=null&&s.excludeImpliedDomains)){const c=WUe(t,e);if(c)return c}const o=n&&XUe(t,r);if(o){const c=(u=o==null?void 0:o.domains)==null?void 0:u[e];return(c==null?void 0:c.type)==="inherited"?i:c}const a=zge(t.types,t.typeIdField,r);if(a){const c=a.domains&&a.domains[e];if(c&&(c==null?void 0:c.type)!=="inherited")return c}if(i)return i;if(!(s!=null&&s.excludeImpliedDomains)){const c=ZUe(t,e);if(c)return c}return null}function XUe(t,e){const{subtypes:s,subtypeField:i}=t;if(!(e!=null&&e.attributes)||!(s!=null&&s.length)||!i)return null;const r=e.attributes[i];return r==null?null:s.find(n=>n.code===r)}function WUe(t,e){var o,a;const{fieldsIndex:s,subtypeField:i}=t,{name:r,type:n}=s.get(e)??{};if(!r)return null;if((i&&((o=s.get(i))==null?void 0:o.name))===r&&((a=t.subtypes)!=null&&a.length)){const l=t.subtypes.map(u=>new h_({code:qge(u.code,n),name:u.name}));if(l!=null&&l.length)return new b$({codedValues:l})}return null}function ZUe(t,e){var n,o;const{fieldsIndex:s}=t,{name:i,type:r}=s.get(e)??{};if(!i)return null;if(("typeIdField"in t?(n=s.get(t.typeIdField))==null?void 0:n.name:null)===i&&"types"in t&&((o=t.types)!=null&&o.length)){const a=t.types.map(l=>new h_({code:qge(l.id,r),name:l.name}));return new b$({codedValues:a})}return null}function qge(t,e){return e?hme({type:e})&&typeof t=="number"?`${t}`:TFe({type:e})&&typeof t=="string"?Number.parseInt(t,10):t:t}async function wg(t){return(await t.load()).source}async function M_t(t,e){if(!Mt)return;const s=Mt.findCredential(t);if(s)return s.userId;let i;try{const r=await E7(t,e);r&&(i=await Mt.checkSignInStatus(`${r}/sharing`))}catch{}return i?i.userId:null}async function Gge(t,e){if(!Mt||Mt.findCredential(t))return;let s;try{const i=await E7(t,e);i&&(s=await Mt.checkSignInStatus(`${i}/sharing`))}catch{}if(s)try{const i=e!=null?e.signal:null;await Mt.getCredential(t,{signal:i})}catch{}}async function QUe(t,e,s){var r;const i=(r=t.parsedUrl)==null?void 0:r.path;i&&t.authenticationTriggerEvent===e&&await Gge(i,s)}async function A_t(t){var s;const e=(s=t.parsedUrl)==null?void 0:s.path;e&&JUe(t)&&await Gge(e)}function JUe(t){return KUe(t)&&("serviceDefinitionExpression"in t&&D3(t.serviceDefinitionExpression)||"definitionExpression"in t&&D3(t.definitionExpression))}function KUe(t){var e;return!(!xhe(t)||!((e=t.capabilities)!=null&&e.query.supportsCurrentUser))}function D3(t){return!!(t!=null&&t.toLowerCase().includes("current_user"))}function e9e(t){return!kA(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const EO=Jb({types:tde});function FU(t,e){var s;if(t.defaultSymbol)return(s=t.types)!=null&&s.length?new RU({defaultSymbol:EO(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(i=>({id:i.id,symbol:EO(i.symbol,i,e)}))}):new Yh({symbol:EO(t.defaultSymbol,t,e)})}function t9e(t){var i,r,n;let e=(i=t.sourceJSON)==null?void 0:i.cacheMaxAge;if(!e)return!1;const s=(n=(r=t.editingInfo)==null?void 0:r.lastEditDate)==null?void 0:n.getTime();return s==null||(e*=1e3,Date.now()-s<e)}async function s9e(t,e,s){if(e==null)return null;const i=[],{objectIdField:r}=t;if(e.forEach(u=>{let c=null;if("attributes"in u){const{attributes:h}=u;c={globalId:h[s],objectId:h[r]!=null&&h[r]!==-1?h[r]:null}}else c={globalId:u.globalId,objectId:u.objectId!=null&&u.objectId!==-1?u.objectId:null};c.globalId!=null&&(c.objectId!=null&&c.objectId!==-1||i.push(c.globalId))}),i.length===0)return null;const n=t.createQuery();n.where=i.map(u=>`${s}='${u}'`).join(" OR "),n.returnGeometry=!1,n.outFields=[r,s],n.cacheHint=!1;const o=await iMe(N7e(t,n));if(!o.ok)return null;const a=new Map,l=o.value.features;for(const u of l){const c=u.attributes[s],h=u.attributes[r];c!=null&&h!=null&&h!==-1&&a.set(nGe(c),h)}return a}function zge(t,e,s){if(!e||!s||!t)return null;const i=s.getAttribute(e);return i==null?null:t.find(r=>{const{id:n}=r;return n!=null&&n.toString()===i.toString()})??null}function kA(t){var e;return((e=t.sourceJSON)==null?void 0:e.isMultiServicesView)||i9e(t)}function i9e(t){var e,s;return!!((s=(e=t.sourceJSON)==null?void 0:e.capabilities)!=null&&s.toLowerCase().split(",").map(i=>i.trim()).includes("map"))}function r9e(t,e,s){const i=e==null?void 0:e.queryAttributeBins;if(!i)throw new ae(s,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!i.supportsAutoInterval)throw new ae(s,"Layer source does not support auto-interval binning");if(t.binParameters.normalizationType&&(!i.supportsNormalization||!ZK(t.binParameters.normalizationType,i.supportedNormalizationTypes)))throw new ae(s,"Layer source does not support normalization binning");break;case"date":if(!i.supportsDate)throw new ae(s,"Layer source does not support date binning");if(t.binParameters.snapToData&&!i.supportsSnapToData)throw new ae(s,"Layer source does not support snapToData binning");if(t.binParameters.returnFullIntervalBin&&!i.supportsReturnFullIntervalBin)throw new ae(s,"Layer source does not support returnFullIntervalBin binning");break;case"fixed-boundaries":if(!i.supportsFixedBoundaries)throw new ae(s,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!i.supportsFixedInterval)throw new ae(s,"Layer source does not support fixed-interval binning");if(t.binParameters.normalizationType&&(!i.supportsNormalization||!ZK(t.binParameters.normalizationType,i.supportedNormalizationTypes)))throw new ae(s,"Layer source does not support normalization binning")}if(t.binParameters.stackBy&&!i.supportsStackBy)throw new ae(s,"Layer source does not support stackBy binning");if(t.binParameters.splitBy&&!i.supportsSplitBy)throw new ae(s,"Layer source does not support splitBy binning");if(t.binParameters.firstDayOfWeek&&!i.supportsFirstDayOfWeek)throw new ae(s,"Layer source does not support firstDayOfWeek binning");const r=i==null?void 0:i.supportedStatistics;if(t.outStatistics&&r){const n=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:o}of t.outStatistics){const a=n.get(o);if(a&&!r[a])throw new ae(s,`Layer source does not support ${o} statistic type`)}}}function ZK(t,e){return t!=null&&!!(e!=null&&e[Oge.toJSON(t)])}const OU="__begin__",LU="__end__",n9e=new RegExp(OU,"ig"),o9e=new RegExp(LU,"ig"),QK=new RegExp("^"+OU,"i"),JK=new RegExp(LU+"$","i"),$3='"',a9e=$3+" + ",l9e=" + "+$3;function u9e(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function c9e(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function VU(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):t.labelExpression!=null&&(e.expression=u9e(t.labelExpression),e.type="conventional"),e}function h9e(t){const e=VU(t);switch(e.type){case"conventional":return Rq(e.expression);case"arcade":return e.expression}return null}function m9e(t){const e=VU(t);switch(e.type){case"conventional":return p9e(e.expression);case"arcade":return Uge(e.expression)}return null}function Rq(t){let e;return t?(e=jc(t,s=>OU+'$feature["'+s+'"]'+LU),e=QK.test(e)?e.replace(QK,""):$3+e,e=JK.test(e)?e.replace(JK,""):e+$3,e=e.replaceAll(n9e,a9e).replaceAll(o9e,l9e)):e='""',e}const d9e=/^\s*\{([^}]+)\}\s*$/i;function p9e(t){const e=t==null?void 0:t.match(d9e);return(e==null?void 0:e[1].trim())||null}const f9e=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,g9e=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,y9e=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function Uge(t){if(!t)return null;let e=f9e.exec(t)||g9e.exec(t);return e?e[1]||e[3]:(e=y9e.exec(t),e?e[2]:null)}var kq;let sf=kq=class extends Te{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(t,e){return e.value?Rq(e.value):t}writeExpression(t,e,s){this.value!=null&&(t=Rq(this.value)),t!=null&&(e[s]=t)}clone(){return new kq({expression:this.expression,title:this.title,value:this.value})}};p([_({type:String,json:{write:{writerEnsuresNonNull:!0}}})],sf.prototype,"expression",void 0),p([qe("expression",["expression","value"])],sf.prototype,"readExpression",null),p([Ue("expression")],sf.prototype,"writeExpression",null),p([_({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],sf.prototype,"title",void 0),p([_({json:{read:!1,write:!1}})],sf.prototype,"value",void 0),sf=kq=p([Q("esri.layers.support.LabelExpressionInfo")],sf);const Bge=sf;var Fq;const VI=new Jt({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function qI(t,e,s){return{enabled:!K5(s==null?void 0:s.layer)}}function jge(t){var e;return!t||t.origin!=="service"&&((e=t.layer)==null?void 0:e.type)!=="map-image"}function _9e(t){return(t==null?void 0:t.type)==="map-image"}function Hge(t){var e,s;return!!_9e(t)&&!!((s=(e=t.capabilities)==null?void 0:e.exportMap)!=null&&s.supportsArcadeExpressionForLabeling)}function v9e(t){return jge(t)||Hge(t==null?void 0:t.layer)}let _r=Fq=class extends Te{static evaluateWhere(t,e){const s=(i,r,n)=>{switch(r){case"=":return i==n;case"<>":return i!=n;case">":return i>n;case">=":return i>=n;case"<":return i<n;case"<=":return i<=n}return!1};try{if(t==null)return!0;const i=t.split(" ");if(i.length===3)return s(e[i[0]],i[1],i[2]);if(i.length===7){const r=s(e[i[0]],i[1],i[2]),n=i[3],o=s(e[i[4]],i[5],i[6]);switch(n){case"AND":return r&&o;case"OR":return r||o}}return!1}catch{}}constructor(t){super(t),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=cUe,this.useCodedValues=void 0,this.where=null}readLabelExpression(t,e){const s=e.labelExpressionInfo;if(!s||!s.value&&!s.expression)return t}writeLabelExpression(t,e,s){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)t=c9e(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const i=Uge(this.labelExpressionInfo.expression);i&&(t="["+i+"]")}}t!=null&&(e[s]=t)}writeLabelExpressionInfo(t,e,s,i){if(t==null&&this.labelExpression!=null&&jge(i))t=new Bge({expression:this.getLabelExpressionArcade()});else if(!t)return;const r=t.toJSON(i);r.expression&&(e[s]=r)}writeMaxScale(t,e){(t||this.minScale)&&(e.maxScale=t)}writeMinScale(t,e){(t||this.maxScale)&&(e.minScale=t)}getLabelExpression(){return VU(this)}getLabelExpressionArcade(){return h9e(this)}getLabelExpressionSingleField(){return m9e(this)}hash(){return JSON.stringify(this)}clone(){return new Fq({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:he(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:he(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};p([_({type:String,json:{write:!0}})],_r.prototype,"name",void 0),p([_({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:qI}}}}})],_r.prototype,"allowOverrun",void 0),p([_({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:qI}}}}})],_r.prototype,"deconflictionStrategy",void 0),p([_({type:String,json:{write:{overridePolicy(t,e,s){return this.labelExpressionInfo&&(s==null?void 0:s.origin)==="service"&&Hge(s.layer)?{enabled:!1}:{allowNull:!0}}}}})],_r.prototype,"labelExpression",void 0),p([qe("labelExpression")],_r.prototype,"readLabelExpression",null),p([Ue("labelExpression")],_r.prototype,"writeLabelExpression",null),p([_({type:Bge,json:{write:{overridePolicy:(t,e,s)=>v9e(s)?{allowNull:!0}:{enabled:!1}}}})],_r.prototype,"labelExpressionInfo",void 0),p([Ue("labelExpressionInfo")],_r.prototype,"writeLabelExpressionInfo",null),p([_({type:VI.apiValues,json:{type:VI.jsonValues,read:VI.read,write:VI.write}})],_r.prototype,"labelPlacement",void 0),p([_({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],_r.prototype,"labelPosition",void 0),p([_({type:Number})],_r.prototype,"maxScale",void 0),p([Ue("maxScale")],_r.prototype,"writeMaxScale",null),p([_({type:Number})],_r.prototype,"minScale",void 0),p([Ue("minScale")],_r.prototype,"writeMinScale",null),p([_({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:qI}}}}})],_r.prototype,"repeatLabel",void 0),p([_({type:Number,cast:ms,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:qI}}}}})],_r.prototype,"repeatLabelDistance",void 0),p([_({types:k4e,json:{origins:{"web-scene":{types:F4e,write:qK,default:null}},write:qK,default:null}})],_r.prototype,"symbol",void 0),p([_({type:Boolean,json:{write:!0}})],_r.prototype,"useCodedValues",void 0),p([_({type:String,json:{write:!0}})],_r.prototype,"where",void 0),_r=Fq=p([Q("esri.layers.support.LabelClass")],_r);const gx=_r;var Oq;let rf=Oq=class extends Te{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){var t;return new Oq({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:((t=this.symbol)==null?void 0:t.clone())??null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};p([_({type:String,json:{write:!0}})],rf.prototype,"description",void 0),p([_({type:String,json:{write:!0}})],rf.prototype,"label",void 0),p([_({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],rf.prototype,"minValue",void 0),p([_({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],rf.prototype,"maxValue",void 0),p([_(AU)],rf.prototype,"symbol",void 0),rf=Oq=p([Q("esri.renderers.support.ClassBreakInfo")],rf);const R3=rf;var Lq;const Yge="log",FA="percent-of-total",OA="field",GI=new Jt({esriNormalizeByLog:Yge,esriNormalizeByPercentOfTotal:FA,esriNormalizeByField:OA}),b9e=nn(R3);let Hr=Lq=class extends fx(Gd){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,s){if(!Array.isArray(t))return;let i=e.minValue;return t.map(r=>{const n=new R3;return n.read(r,s),n.minValue==null&&(n.minValue=i),n.maxValue==null&&(n.maxValue=n.minValue),i=n.maxValue,n})}writeClassBreakInfos(t,e,s,i){const r=t.map(n=>n.write({},i));this._areClassBreaksConsecutive()&&r.forEach(n=>delete n.classMinValue),e[s]=r}castField(t){return t==null?t:typeof t=="function"?(Ne.getLogger(this).error(".field: field must be a string value"),null):MC(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,s=this.normalizationTotal!=null;return e||s?(t=e&&OA||s&&FA||null,e&&s&&Ne.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==OA&&t!==FA||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,s){let i=null;i=typeof t=="number"?new R3({minValue:t,maxValue:e,symbol:sde(s)}):b9e(he(t)),this.classBreakInfos.push(i),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const s=this.classBreakInfos.length;for(let i=0;i<s;i++){const r=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(r[0]===t&&r[1]===e){this.classBreakInfos.splice(i,1);break}}}getBreakIndex(t,e){return this.valueExpression&&(e==null?void 0:e.arcade)==null&&Ne.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let s=e;this.valueExpression&&(e==null?void 0:e.arcade)==null&&(s={...s,arcade:await Zc()});const i=this.getBreakIndex(t,s);return i!==-1?this.classBreakInfos[i]:null}getSymbol(t,e){if(this.valueExpression&&(e==null?void 0:e.arcade)==null)return void Ne.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const s=this.getBreakIndex(t,e);return s>-1?this.classBreakInfos[s].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let s=e;if(this.valueExpression&&(e==null?void 0:e.arcade)==null){const r=await Zc(),{arcadeUtils:n}=r;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),s={...s,arcade:r}}const i=this.getBreakIndex(t,s);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}get symbols(){const t=[];return this.classBreakInfos.forEach(e=>{e.symbol&&t.push(e.symbol)}),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,s)=>e+s.getAttributeHash(),""))??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),s=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce((i,r)=>i+r.getMeshHash(),"")}.${s}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){var t,e;return new Lq({field:this.field,backgroundFillSymbol:(t=this.backgroundFillSymbol)==null?void 0:t.clone(),defaultLabel:this.defaultLabel,defaultSymbol:(e=this.defaultSymbol)==null?void 0:e.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:he(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:he(this.visualVariables),legendOptions:he(this.legendOptions),authoringInfo:he(this.authoringInfo)})}async collectRequiredFields(t,e){const s=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(s)}async collectSymbolFields(t,e){const s=[...this.symbols.map(i=>i.collectRequiredFields(t,e)),Go(t,e,this.valueExpression)];va(t,e,this.field),va(t,e,this.normalizationField),await Promise.all(s)}_getBreakIndexForExpression(t,e){const{viewingMode:s,scale:i,spatialReference:r,arcade:n,timeZone:o}=e??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const u=n.arcadeUtils;if(!l){const h=u.createSyntaxTree(a);l=u.createFunction(h),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const c=u.executeFunction(l,u.createExecContext(t,u.getViewInfo({viewingMode:s,scale:i,spatialReference:r}),o));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(t){const e=this.field,s=t.attributes,i=this.normalizationType;let r=parseFloat(s[e]);if(i){const n=this.normalizationTotal,o=parseFloat(this.normalizationField?s[this.normalizationField]:void 0);if(i===Yge)r=Math.log(r)*Math.LOG10E;else if(i!==FA||n==null||isNaN(n)){if(i===OA&&!isNaN(o)){if(isNaN(r)||isNaN(o))return-1;r/=o}}else r=r/n*100}return this._getBreakIndexfromInfos(r)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(t!=null&&typeof t=="number"&&!isNaN(t))for(let s=0;s<this.classBreakInfos.length;s++){const i=[this.classBreakInfos[s].minValue,this.classBreakInfos[s].maxValue];if(i[0]<=t&&(e?t<=i[1]:t<i[1]))return s}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let s=1;s<e;s++)if(t[s-1].maxValue!==t[s].minValue)return!1;return!0}};p([_(NU)],Hr.prototype,"backgroundFillSymbol",void 0),p([_({type:[R3],json:{write:{isRequired:!0}}})],Hr.prototype,"classBreakInfos",void 0),p([qe("classBreakInfos")],Hr.prototype,"readClassBreakInfos",null),p([Ue("classBreakInfos")],Hr.prototype,"writeClassBreakInfos",null),p([_({type:String,json:{write:!0}})],Hr.prototype,"defaultLabel",void 0),p([_(V$)],Hr.prototype,"defaultSymbol",void 0),p([_({type:String,json:{write:!0}})],Hr.prototype,"field",void 0),p([Ht("field")],Hr.prototype,"castField",null),p([_({type:Boolean})],Hr.prototype,"isMaxInclusive",void 0),p([_({type:DU,json:{write:!0}})],Hr.prototype,"legendOptions",void 0),p([_({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],Hr.prototype,"minValue",null),p([_({type:String,json:{write:!0}})],Hr.prototype,"normalizationField",void 0),p([_({type:Number,json:{write:!0}})],Hr.prototype,"normalizationTotal",void 0),p([_({type:GI.apiValues,value:null,json:{type:GI.jsonValues,read:GI.read,write:GI.write}})],Hr.prototype,"normalizationType",null),p([mt({classBreaks:"class-breaks"})],Hr.prototype,"type",void 0),p([_({type:String,json:{write:!0}})],Hr.prototype,"valueExpression",void 0),p([_({type:String,json:{write:!0}})],Hr.prototype,"valueExpressionTitle",void 0),Hr=Lq=p([Q("esri.renderers.ClassBreaksRenderer")],Hr);const Xge=Hr,Vq=-3,x9e=Vq-1;var od;(function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"})(od||(od={}));let w9e=class{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new y_,this._users=new y_}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear()}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,s){this._removeFuncs.push([e,s])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace(s=>s[0]!==e)}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,s){const i=this._db.get(e.id+s);return(i==null?void 0:i.size)??0}put(e,s,i,r,n){s=e.id+s;const o=this._db.get(s);if(o&&(this._size-=o.size,e.size-=o.size,this._db.delete(s),o.entry!==i&&this._notifyRemove(s,o.entry,o.size,od.ALL)),r>this._maxSize)return void this._notifyRemove(s,i,r,od.ALL);if(i===void 0)return void console.warn("Refusing to cache undefined entry ");if(!r||r<0)return console.warn(`Refusing to cache entry with size ${r} for key ${s}`),void this._notifyRemove(s,i,0,od.ALL);const a=1+Math.max(n,x9e)-Vq;this._db.set(s,new S9e(i,r,a)),this._size+=r,e.size+=r,this._checkSize()}updateSize(e,s,i,r){s=e.id+s;const n=this._db.get(s);if(n&&n.entry===i){for(this._size-=n.size,e.size-=n.size;r>this._maxSize;){const o=this._notifyRemove(s,i,r,od.SOME);if(!(o!=null&&o>0))return void this._db.delete(s);r=o}n.size=r,this._size+=r,e.size+=r,this._checkSize()}}pop(e,s){s=e.id+s;const i=this._db.get(s);if(i)return this._size-=i.size,e.size-=i.size,this._db.delete(s),++this._hit,i.entry;++this._miss}get(e,s){s=e.id+s;const i=this._db.get(s);if(i!==void 0)return this._db.delete(s),i.lives=i.lifetime,this._db.set(s,i),++this._hit,i.entry;++this._miss}peek(e,s){const i=this._db.get(e.id+s);return i?++this._hit:++this._miss,i==null?void 0:i.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},s={},i=new Array;this._db.forEach((o,a)=>{const l=o.lifetime;i[l]=(i[l]||0)+o.size,this._users.forAll(u=>{const{id:c,name:h}=u;if(a.startsWith(c)){const m=s[h]||0;s[h]=m+o.size}})});const r={};this._users.forAll(o=>{const a=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const l=s[a]||0;s[a]=l,r[a]=Math.round(100*o.hitRate)+"%"}else r[a]="0%"});const n=Object.keys(s);n.sort((o,a)=>s[a]-s[o]),n.forEach(o=>e[o]=Math.round(s[o]/2**20)+"MB / "+r[o]);for(let o=i.length-1;o>=0;--o){const a=i[o];a&&(e["Priority "+(o+Vq-1)]=Math.round(a/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll(e=>e.resetHitRate())}clear(e){const s=e.id;this._db.forEach((i,r)=>{r.startsWith(s)&&(this._size-=i.size,this._db.delete(r),this._notifyRemove(r,i.entry,i.size,od.ALL))}),e.size=0}clearAll(){this._db.forEach((e,s)=>this._notifyRemove(s,e.entry,e.size,od.ALL)),this._users.forAll(e=>e.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,s,i,r){let n;return this._removeFuncs.some(o=>{if(e.startsWith(o[0])){const a=o[1](s,r,i);return typeof a=="number"&&(n=a),!0}return!1}),n}_checkSize(){this._users.forAll(e=>this._checkSizeLimits(e)),this._checkSizeLimits()}_checkSizeLimits(e){const s=e??this;if(s.maxSize<0||s.size<=s.maxSize)return;const i=e==null?void 0:e.id;let r=!0;for(;r;){r=!1;for(const[n,o]of this._db)if(o.lifetime===0&&(!i||n.startsWith(i))){if(this._purgeItem(n,o,e),s.size<=.9*s.maxSize)return;r||(r=this._db.has(n))}}for(const[n,o]of this._db)if((!i||n.startsWith(i))&&(this._purgeItem(n,o,e),s.size<=.9*s.maxSize))return}_purgeItem(e,s,i=this._users.find(r=>e.startsWith(r.id))){if(this._db.delete(e),s.lives<=1){this._size-=s.size,i&&(i.size-=s.size);const r=this._notifyRemove(e,s.entry,s.size,od.SOME);r!=null&&r>0&&(this._size+=r,i&&(i.size+=r),s.lives=s.lifetime,s.size=r,this._db.set(e,s))}else--s.lives,this._db.set(e,s)}},S9e=class{constructor(e,s,i){this.entry=e,this.size=s,this.lifetime=i,this.lives=i}},Wge=class{constructor(e,s){this._storage=new w9e,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),s&&this._storage.registerRemoveFunc("",s)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,s,i=1){this._storage.put(this,e,s,i,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}};function E9e(t){return"timeZone"in t}function C9e(t){return"timeZone"in t}function P9e(t){return"dateFieldsTimeZone"in t}const T9e=new Map;let Zge=class LA{static fromJSON(e){return new LA(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new LA(e.fields??[],eee(e))}static fromLayerJSON(e){return new LA(e.fields??[],eee(e))}constructor(e=[],s){var r;this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=s?new Map(s):null;const i=[];for(const n of this.fields){const o=n==null?void 0:n.name,a=KK(o);if(o&&a){const l=Jy(o);this._fieldsMap.set(o,n),this._fieldsMap.set(l,n),this._normalizedFieldsMap.set(a,n),i.push(`${l}:${n.type}:${(r=this._timeZoneByFieldName)==null?void 0:r.get(o)}`),D7(n)?(this.dateFields.push(n),this._dateFieldsSet.add(n)):N7(n)&&(this._numericFieldsSet.add(n),this.numericFields.push(n)),yQ(n)||_Q(n)||(n.editable=n.editable==null||!!n.editable,n.nullable=n.nullable==null||!!n.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)yQ(e)||_Q(e)||e.nullable||yFe(e)!==void 0||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===(e==null?void 0:e.uid)}has(e){return this.get(e)!=null}get(e){if(!e)return;let s=this._fieldsMap.get(e);return s||(s=this._fieldsMap.get(Jy(e))??this._normalizedFieldsMap.get(KK(e)),s&&this._fieldsMap.set(e,s),s)}getTimeZone(e){const s=this.get(e&&typeof e!="string"?e.name:e);return s?this._timeZoneByFieldName?this._timeZoneByFieldName.get(s.name):s.type==="date"||s.type==="esriFieldTypeDate"?(Ne.getLogger("esri.layers.support.FieldsIndex").errorOnce(new ae("getTimeZone:no-timezone-information",`no time zone information for field '${s.name}'`)),Zh):Qge.has(s.type)?X_:null:null}getLuxonTimeZone(e){const s=this.getTimeZone(e);return s?s===X_?Dc.instance:s===Zh?en.utcInstance:Zb(T9e,s,()=>el.create(s)):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return $7(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){var s;return((s=this.get(e))==null?void 0:s.name)??void 0}toJSON(){return{fields:this.fields.map(e=>Te.isSerializable(e)?e.toJSON():e),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}};function Jy(t){return t.trim().toLowerCase()}function KK(t){var e;return((e=iFe(t))==null?void 0:e.toLowerCase())??""}const Qge=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function eee(t){const e=new Map;if(!t.fields)return e;const s=t.datesInUnknownTimezone===!0,{timeInfo:i,editFieldsInfo:r}=t,n=(i?"startField"in i?i.startField:i.startTimeField:"")??"",o=(i?"endField"in i?i.endField:i.endTimeField:"")??"",a=P9e(t)?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?jM(t.dateFieldsTimeReference):null,l=r?E9e(r)?r.timeZone??a:r.dateFieldsTimeReference?jM(r.dateFieldsTimeReference):a??Zh:null,u=i?C9e(i)?i.timeZone??a:i.timeReference?jM(i.timeReference):a:null,c=new Map([[Jy((r==null?void 0:r.creationDateField)??""),l],[Jy((r==null?void 0:r.editDateField)??""),l],[Jy(n),u],[Jy(o),u]]);for(const{name:h,type:m}of t.fields)if(Qge.has(m))e.set(h,X_);else if(m!=="date"&&m!=="esriFieldTypeDate")e.set(h,null);else if(s)e.set(h,X_);else{const f=c.get(Jy(h??""))??a;e.set(h,f)}return e}var tee,see,iee,ree,nee,oee,aee,lee,uee,cee,qq,Gq,hee,mee,dee,pee,fee,gee,yee,_ee,vee,bee,xee,wee,See,Eee,Cee,Pee,Tee,Iee,Mee,Aee,Nee,Dee,$ee,Ree,kee,Fee,Oee,Lee,Vee,qee,Gee,zee,Uee,Bee,jee,Hee,Yee,Xee,Wee,Zee,Qee,Jee,Kee,k3,ete,tte,ste,ite,rte,nte,ote;(function(t){t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t[t.UNKNOWN=4]="UNKNOWN"})(tee||(tee={})),function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER",t[t.UNKNOWN=4]="UNKNOWN"}(see||(see={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.MAP=1]="MAP"}(iee||(iee={})),function(t){t[t.Tint=0]="Tint",t[t.Ignore=1]="Ignore",t[t.Multiply=99]="Multiply"}(ree||(ree={})),function(t){t.Both="Both",t.JustBegin="JustBegin",t.JustEnd="JustEnd",t.None="None"}(nee||(nee={})),function(t){t[t.Mosaic=0]="Mosaic",t[t.Centered=1]="Centered"}(oee||(oee={})),function(t){t[t.Normal=0]="Normal",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(aee||(aee={})),function(t){t[t.MSSymbol=0]="MSSymbol",t[t.Unicode=1]="Unicode"}(lee||(lee={})),function(t){t[t.Unspecified=0]="Unspecified",t[t.TrueType=1]="TrueType",t[t.PSOpenType=2]="PSOpenType",t[t.TTOpenType=3]="TTOpenType",t[t.Type1=4]="Type1"}(uee||(uee={})),function(t){t[t.Display=0]="Display",t[t.Map=1]="Map"}(cee||(cee={})),function(t){t.None="None",t.Loop="Loop",t.Oscillate="Oscillate"}(qq||(qq={})),function(t){t.Linear="Linear",t.EaseIn="EaseIn",t.EaseOut="EaseOut",t.EaseInOut="EaseInOut"}(Gq||(Gq={})),function(t){t[t.Z=0]="Z",t[t.X=1]="X",t[t.Y=2]="Y"}(hee||(hee={})),function(t){t[t.XYZ=0]="XYZ",t[t.ZXY=1]="ZXY",t[t.YXZ=2]="YXZ"}(mee||(mee={})),function(t){t[t.Rectangle=0]="Rectangle",t[t.RoundedRectangle=1]="RoundedRectangle",t[t.Oval=2]="Oval"}(dee||(dee={})),function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Screen=2]="Screen",t[t.Multiply=3]="Multiply",t[t.Add=4]="Add"}(pee||(pee={})),function(t){t[t.TTB=0]="TTB",t[t.RTL=1]="RTL",t[t.BTT=2]="BTT"}(fee||(fee={})),function(t){t[t.None=0]="None",t[t.SignPost=1]="SignPost",t[t.FaceNearPlane=2]="FaceNearPlane"}(gee||(gee={})),function(t){t[t.Float=0]="Float",t[t.String=1]="String",t[t.Boolean=2]="Boolean"}(yee||(yee={})),function(t){t[t.Intersect=0]="Intersect",t[t.Subtract=1]="Subtract"}(_ee||(_ee={})),function(t){t.OpenEnded="OpenEnded",t.Block="Block",t.Crossed="Crossed"}(vee||(vee={})),function(t){t.FullGeometry="FullGeometry",t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",t.ReversedFirstSegment="ReversedFirstSegment",t.PerpendicularToSecondSegment="PerpendicularToSecondSegment",t.SecondSegmentWithTicks="SecondSegmentWithTicks",t.DoublePerpendicular="DoublePerpendicular",t.OppositeToFirstSegment="OppositeToFirstSegment",t.TriplePerpendicular="TriplePerpendicular",t.HalfCircleFirstSegment="HalfCircleFirstSegment",t.HalfCircleSecondSegment="HalfCircleSecondSegment",t.HalfCircleExtended="HalfCircleExtended",t.OpenCircle="OpenCircle",t.CoverageEdgesWithTicks="CoverageEdgesWithTicks",t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",t.GapExtentMidline="GapExtentMidline",t.Chevron="Chevron",t.PerpendicularWithArc="PerpendicularWithArc",t.ClosedHalfCircle="ClosedHalfCircle",t.TripleParallelExtended="TripleParallelExtended",t.ParallelWithTicks="ParallelWithTicks",t.Parallel="Parallel",t.PerpendicularToFirstSegment="PerpendicularToFirstSegment",t.ParallelOffset="ParallelOffset",t.OffsetOpposite="OffsetOpposite",t.OffsetSame="OffsetSame",t.CircleWithArc="CircleWithArc",t.DoubleJog="DoubleJog",t.PerpendicularOffset="PerpendicularOffset",t.LineExcludingLastSegment="LineExcludingLastSegment",t.MultivertexArrow="MultivertexArrow",t.CrossedArrow="CrossedArrow",t.ChevronArrow="ChevronArrow",t.ChevronArrowOffset="ChevronArrowOffset",t.PartialFirstSegment="PartialFirstSegment",t.Arch="Arch",t.CurvedParallelTicks="CurvedParallelTicks",t.Arc90Degrees="Arc90Degrees",t.TipWithPerpendicularAndTicks="TipWithPerpendicularAndTicks",t.ConcentricCircles="ConcentricCircles",t.DoubleJogArrow="DoubleJogArrow",t.LinkedChevrons="LinkedChevrons",t.SegmentThenHalfCircle="SegmentThenHalfCircle",t.LineWithStraightTicks="LineWithStraightTicks",t.DoubleCurve="DoubleCurve",t.ParallelWithTicksByWidth="ParallelWithTicksByWidth",t.EnclosingRoundedRectangle="EnclosingRoundedRectangle"}(bee||(bee={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square",t.TrueBuffer="TrueBuffer"}(xee||(xee={})),function(t){t.ClosePath="ClosePath",t.ConvexHull="ConvexHull",t.RectangularBox="RectangularBox"}(wee||(wee={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(See||(See={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square"}(Eee||(Eee={})),function(t){t.Fast="Fast",t.Accurate="Accurate"}(Cee||(Cee={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(Pee||(Pee={})),function(t){t.Sinus="Sinus",t.Square="Square",t.Triangle="Triangle",t.Random="Random"}(Tee||(Tee={})),function(t){t[t.None=0]="None",t[t.Default=1]="Default",t[t.Force=2]="Force"}(Iee||(Iee={})),function(t){t[t.Buffered=0]="Buffered",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.AlongLine=3]="AlongLine"}(Mee||(Mee={})),function(t){t[t.Linear=0]="Linear",t[t.Rectangular=1]="Rectangular",t[t.Circular=2]="Circular",t[t.Buffered=3]="Buffered"}(Aee||(Aee={})),function(t){t[t.Discrete=0]="Discrete",t[t.Continuous=1]="Continuous"}(Nee||(Nee={})),function(t){t[t.AcrossLine=0]="AcrossLine",t[t.AlongLine=1]="AlongLine"}(Dee||(Dee={})),function(t){t[t.Auto=0]="Auto",t[t.Clockwise=1]="Clockwise",t[t.Counterclockwise=2]="Counterclockwise"}($ee||($ee={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"}(Ree||(Ree={})),function(t){t[t.Base=0]="Base",t[t.MidPoint=1]="MidPoint",t[t.ThreePoint=2]="ThreePoint",t[t.FourPoint=3]="FourPoint",t[t.Underline=4]="Underline",t[t.CircularCW=5]="CircularCW",t[t.CircularCCW=6]="CircularCCW"}(kee||(kee={})),function(t){t.Butt="Butt",t.Round="Round",t.Square="Square"}(Fee||(Fee={})),function(t){t.NoConstraint="NoConstraint",t.HalfPattern="HalfPattern",t.HalfGap="HalfGap",t.FullPattern="FullPattern",t.FullGap="FullGap",t.Custom="Custom"}(Oee||(Oee={})),function(t){t[t.None=-1]="None",t[t.Custom=0]="Custom",t[t.Circle=1]="Circle",t[t.OpenArrow=2]="OpenArrow",t[t.ClosedArrow=3]="ClosedArrow",t[t.Diamond=4]="Diamond"}(Lee||(Lee={})),function(t){t[t.ExtraLeading=0]="ExtraLeading",t[t.Multiple=1]="Multiple",t[t.Exact=2]="Exact"}(Vee||(Vee={})),function(t){t.Bevel="Bevel",t.Round="Round",t.Miter="Miter"}(qee||(qee={})),function(t){t[t.Default=0]="Default",t[t.String=1]="String",t[t.Numeric=2]="Numeric"}(Gee||(Gee={})),function(t){t[t.InsidePolygon=0]="InsidePolygon",t[t.PolygonCenter=1]="PolygonCenter",t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(zee||(zee={})),function(t){t[t.Tint=0]="Tint",t[t.Replace=1]="Replace",t[t.Multiply=2]="Multiply"}(Uee||(Uee={})),function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary",t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary",t[t.DoNotClip=3]="DoNotClip"}(Bee||(Bee={})),function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"}(jee||(jee={})),function(t){t.Fixed="Fixed",t.Random="Random",t.RandomFixedQuantity="RandomFixedQuantity"}(Hee||(Hee={})),function(t){t.LineMiddle="LineMiddle",t.LineBeginning="LineBeginning",t.LineEnd="LineEnd",t.SegmentMidpoint="SegmentMidpoint"}(Yee||(Yee={})),function(t){t.OnPolygon="OnPolygon",t.CenterOfMass="CenterOfMass",t.BoundingBoxCenter="BoundingBoxCenter"}(Xee||(Xee={})),function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"}(Wee||(Wee={})),function(t){t[t.MarkerCenter=0]="MarkerCenter",t[t.MarkerBounds=1]="MarkerBounds"}(Zee||(Zee={})),function(t){t[t.None=0]="None",t[t.PropUniform=1]="PropUniform",t[t.PropNonuniform=2]="PropNonuniform",t[t.DifUniform=3]="DifUniform",t[t.DifNonuniform=4]="DifNonuniform"}(Qee||(Qee={})),function(t){t.Tube="Tube",t.Strip="Strip",t.Wall="Wall"}(Jee||(Jee={})),function(t){t[t.Random=0]="Random",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(Kee||(Kee={})),function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"}(k3||(k3={})),function(t){t[t.Normal=0]="Normal",t[t.LowerCase=1]="LowerCase",t[t.Allcaps=2]="Allcaps"}(ete||(ete={})),function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(tte||(tte={})),function(t){t.Draft="Draft",t.Picture="Picture",t.Text="Text"}(ste||(ste={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Baseline=2]="Baseline",t[t.Bottom=3]="Bottom"}(ite||(ite={})),function(t){t[t.Right=0]="Right",t[t.Upright=1]="Upright"}(rte||(rte={})),function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"}(nte||(nte={})),function(t){t[t.Calm=0]="Calm",t[t.Rippled=1]="Rippled",t[t.Slight=2]="Slight",t[t.Moderate=3]="Moderate"}(ote||(ote={}));const I9e={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},zq={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1,gradientMethod:"AcrossLine",gradientSize:75,gradientSizeUnits:k3.Relative,gradientType:"Discrete",interval:5},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGradientFill:{enable:!0,angle:90,gradientMethod:"Linear",gradientSize:75,gradientSizeUnits:k3.Relative,gradientType:"Discrete",interval:5},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:qq.Loop,repeatdelay:0,easing:Gq.Linear},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0,rotateclockwise:!1},CIMSymbolAnimationOffset:{offsetx:0,offsety:0}};function M9e(t){return typeof t=="function"}function R_t(t,e,s,i){return M9e(t)?t(e,s,i):t}function k_t(t){return[t.r,t.g,t.b,t.a]}const A9e=` /-,
`;function ate(t){let e=t.length;for(;e--;)if(!A9e.includes(t.charAt(e)))return!1;return!0}function F_t(t,e){const s=[];let i=0,r=-1;do if(r=t.indexOf("[",i),r>=i){if(r>i){const n=t.slice(i,r);s.push([n,null,ate(n)])}if(i=r+1,r=t.indexOf("]",i),r>=i){if(r>i){const n=e[t.slice(i,r)];n&&s.push([null,n,!1])}i=r+1}}while(r!==-1);if(i<t.length){const n=t.slice(i);s.push([n,null,ate(n)])}return s}function O_t(t,e,s,i){let r="",n=null;for(const o of e){const[a,l,u]=o;if(a)u?n=a:(n&&(r+=n,n=null),r+=a);else{let c=l;s!=null&&(c=sye(l,s));const h=t.attributes[c];h&&(n&&(r+=n,n=null),r+=h)}}return N9e(r,i)}function N9e(t,e){switch(typeof t!="string"&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function L_t(t,e,s,i,r,n,o=!0){const a=e/r,l=s/n,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let h=0;h<n;h++)for(let m=0;m<r;m++){const f=4*(m+(o?n-h-1:h)*r);let g=0,v=0,b=0,w=0,S=0,T=0,P=0;const I=(h+.5)*l;for(let A=Math.floor(h*l);A<(h+1)*l;A++){const D=Math.abs(I-(A+.5))/c,k=(m+.5)*a,R=D*D;for(let O=Math.floor(m*a);O<(m+1)*a;O++){let z=Math.abs(k-(O+.5))/u;const q=Math.sqrt(R+z*z);q>=-1&&q<=1&&(g=2*q*q*q-3*q*q+1,g>0&&(z=4*(O+A*e),P+=g*t[z+3],b+=g,t[z+3]<255&&(g=g*t[z+3]/250),w+=g*t[z],S+=g*t[z+1],T+=g*t[z+2],v+=g))}}i[f]=w/v,i[f+1]=S/v,i[f+2]=T/v,i[f+3]=P/b}}function Jge(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function Kge(t){var e;return((e=t.data)==null?void 0:e.symbol)??null}function eye(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function tye(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function V_t(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function q$(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const q_t=(t,e=0)=>t==null||isNaN(t)?e:t,G_t=(t,e)=>t??e,z_t=(t,e)=>t??e,U_t=t=>t.tintColor?Jge(t.tintColor):[255,255,255,1],B_t=t=>{if(!t)return!1;for(const e of t)switch(e.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function j_t(){return me(()=>import("./geometryEngineJSON-Bvf5zUh7.js").then(t=>t.g),__vite__mapDeps([8,9,1,10]))}function H_t(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function Y_t(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function X_t(t){let e="normal",s="normal";if(t){const i=t.toLowerCase();i.includes("italic")?e="italic":i.includes("oblique")&&(e="oblique"),i.includes("bold")?s="bold":i.includes("light")&&(s="lighter")}return{style:e,weight:s}}function W_t(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function lte(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const s=lte(e);if(s!=null)return s}break;case"CIMTextSymbol":return lte(t.symbol);case"CIMSolidFill":return t.color}return null}function ute(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const s of e){const i=ute(s);if(i!=null)return i}break}case"CIMTextSymbol":return ute(t.symbol);case"CIMSolidStroke":return t.color}}function cte(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const s=cte(e);if(s!==void 0)return s}break;case"CIMTextSymbol":return cte(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function Z_t(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function Q_t(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function J_t(t){return(t?Object.keys(t):[]).map(e=>({name:e,alias:e,type:typeof t[e]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const K_t=t=>t.includes("data:image/svg+xml");function e0t(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function qU(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function t0t(t,e,s,i,r,n,o=!0){const{infos:a}=n;let l=1,u=0,c=0,h=0,m=1;for(const{absoluteAnchorPoint:v,offsetX:b,offsetY:w,rotation:S,size:T,frameHeight:P,rotateClockWise:I,scaleSymbolsProportionally:A}of a)m=v?1:l,c=mte(b,w,u,m,c),h=hte(b,w,u,m,h),P&&(A||o)&&(l*=T/P),u=dte(S,I,u);const f=mte(i,r,u,m,c),g=hte(i,r,u,m,h);return{size:t*l,rotation:dte(e,s,u),offsetX:f,offsetY:g}}function D9e(t){if(t==null)return!1;if(Array.isArray(t))return t.every(e=>D9e(e));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function $9e(t,e){if(e==="color"||e==="outlinecolor"||e==="backgroundcolor"||e==="borderlinecolor"||e==="tintcolor")return[...I9e[e]];const s=zq[t];if(!s)throw new Error(`InternalError: default value for type ${t}.`);return s[e]}function R9e(t){return t.split(" ").map(e=>Number(e))}function k9e(t){return typeof t=="string"?R9e(t):t}function s0t(t){return t!=null&&t.dashTemplate&&(t.dashTemplate=k9e(t.dashTemplate)),t}function Uq(t){if(t==null)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const s of e)if(s.type==="CIMVectorMarker")return Uq(s)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const s of e)if(s.symbol)return Uq(s.symbol)}}return"Normal"}function i0t(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers){for(const s of t.symbolLayers)if(s)switch(s.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const i=s.size??zq.CIMVectorMarker.size;i>e&&(e=i);break}}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers){for(const s of t.symbolLayers)if(s)switch(s.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const i=s.width;i!=null&&i>e&&(e=i);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(s.markerPlacement&&q$(s.markerPlacement)){const i=s.size??zq.CIMVectorMarker.size;i>e&&(e=i)}break;case"CIMPictureFill":{const i=s.height;i!=null&&i>e&&(e=i)}}}return e}}}function sye(t,e){if(e!==null){const s=e.get(t);return s?s.name:t}return t}function r0t(t){return t.map(e=>({...e,propertyName:qU(e.propertyName)}))}function n0t(t){const e={};for(const s in t){const i=t[s];e[qU(s)]=i}return e}function hte(t,e,s,i,r){const n=s*Math.PI/180;if(n){const o=Math.cos(n);return(Math.sin(n)*t+o*e)*i+r}return e*i+r}function mte(t,e,s,i,r){const n=s*Math.PI/180;return n?(Math.cos(n)*t-Math.sin(n)*e)*i+r:t*i+r}function dte(t,e,s){return e?s-t:s+t}function o0t(t,e,s){const i=s==="Color"||s==="TintColor"||s==="ToColor",r=s==="Rotation"||s==="Angle"||s==="ToRotation";let n=e[qU(s)];if(n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:r&&(n*=Math.PI/180)),n==null&&(n=$9e(e.type,s.toLowerCase()),n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]]:r&&(n*=Math.PI/180))),e.primitiveName!=null){const o=t[e.primitiveName];if(o!=null){const a=o[s];a==null||(typeof a=="string"||typeof a=="number"||Array.isArray(a)?(n=a,n!=null&&(i?n=[n[0]/255,n[1]/255,n[2]/255,n[3]/255]:r&&(n*=Math.PI/180))):(n={valueExpressionInfo:a,defaultValue:n},n!=null&&(i?n={type:"Process",op:"ArcadeColor",value:n}:r&&(n={type:"Process",op:"Divide",left:n,right:180/Math.PI}))))}}if(n==null)throw new Error(`Failed to derive a value or an expression for "${s}".`);return n}function a0t(t,e){return Math.max(Math.min((t??e)/100,1),0)}const pte="esri.renderers.support.DictionaryLoader",F9e={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let iye=class{constructor(e,s,i){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new Wge(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=e,this.config=s,this.fieldMap=i}getSymbolFields(){return this._symbolFields}async getSymbolAsync(e,s){var h;let i;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(s));try{i=await this._dictionaryPromise}catch(m){if(Lr(m))return this._dictionaryPromise=null,null}const r=(h=this._dictionaryVersion)==null?void 0:h.greaterEqual(4,0),n={};if(this.fieldMap)for(const m of this._symbolFields){const f=sye(this.fieldMap[m],this._fieldIndex);if(f){const g=e.attributes[f];n[m]=r?g:g!=null?""+e.attributes[f]:""}else n[m]=""}let o=null;try{o=i==null?void 0:i(n,s)}catch{return null}if(!o||typeof o!="string"||o==="invalid")return null;const a=o.split(";"),l=[],u=[];for(let m=0;m<a.length;m++){const f=a[m];if(f){if(f.includes("po:")){const g=f.slice(3).split("|");if(g.length===3){const v=g[0],b=g[1];let w=g[2];const S="countrylabel";if(v===S&&b==="TextString"){if(this.fieldMap!=null){let T=this.fieldMap[S];T==null&&(T=S,this.fieldMap[T]=T),e.attributes[T]=w}continue}if(b==="DashTemplate")w=w.split(" ").map(T=>Number(T));else if(b==="Color"){const T=new Be(w).toRgba();w=[T[0],T[1],T[2],255*T[3]]}else w=Number(w);u.push({primitiveName:v,propertyName:b,value:w,defaultValue:null})}}else if(f.includes("|")){for(const g of f.split("|"))if(this._itemNames.has(g)){l.push(g);break}}else if(this._itemNames.has(f))l.push(f);else if(m===0){l.length=0;let g="Invalid_P";e.geometry!=null&&(v_(e.geometry)?g="Invalid_A":Zz(e.geometry)&&(g="Invalid_L")),l.push(g);break}}}const c=e.geometry==null||!e.geometry.hasZ&&e.geometry.type==="point";return this._cimPartsToCIMSymbol(e,l,u,c,s)}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void Ne.getLogger(pte).error("no valid URL!");const s=js(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:e!=null?e.signal:null}),[{data:i}]=await Promise.all([s,Zc()]);if(!i)throw this._dictionaryPromise=null,new ae("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:r,dictionary_version:n,expression:o,itemsNames:a}=i,l=o;let u=!1;n&&(this._dictionaryVersion=Efe.parse(n),u=this._dictionaryVersion.greaterEqual(4,0)),this._refSymbolUrlTemplate=this.url+"/"+i.cimRefTemplateUrl,this._itemNames=new Set(a),this._symbolFields=r.symbol;const c={};if(this.config){const f=this.config;for(const g in f)c[g]=f[g]}if(r.configuration)for(const f of r.configuration)c.hasOwnProperty(f.name)||(c[f.name]=f.value);const h=[];if(e!=null&&e.fields&&this.fieldMap)for(const f in this.fieldMap){const g=this.fieldMap[f],v=e.fields.filter(b=>b.name.toLowerCase()===(g==null?void 0:g.toLowerCase()));v.length>0&&h.push({...v[0],type:u?v[0].type:"esriFieldTypeString"})}h.length>0&&(this._fieldIndex=new Zge(h));const m=eFe(l,e!=null?e.spatialReference:null,h,c).then(f=>{const g={scale:0};return(v,b)=>{if(f==null)return null;const w=f.repurposeFeature({geometry:null,attributes:v});return g.scale=b!=null?b.scale??void 0:void 0,f.evaluate({$feature:w,$view:g},f.services)}}).catch(f=>(Ne.getLogger(pte).error("Creating dictionary expression failed:",f),null));return this._dictionaryPromise=m,m}async _cimPartsToCIMSymbol(e,s,i,r,n){const o=new Array(s.length);for(let u=0;u<s.length;u++)o[u]=this._getSymbolPart(s[u],n);let a=await Promise.all(o);const l=this.fieldMap;if(l&&a.length>0){const{OverrideHelper:u}=await me(()=>import("./OverrideHelper-CIwXcBSI.js").then(c=>c.O),__vite__mapDeps([171,4]));a=he(a);for(const c of a)u.applyDictionaryTextOverrides(c,e,l,this._fieldIndex,Uq(c))}return new yg({data:O9e(a,i,r)})}async _getSymbolPart(e,s){const i=this._symbolCache.get(e);if(i)return i;if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then(o=>o.data);const r=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,e),n=js(r,{responseType:"json",query:{f:"json"},...s});this._ongoingRequests.set(e,n),n.finally(()=>this._ongoingRequests.delete(e));try{const o=await n;return this._symbolCache.put(e,o.data),o.data}catch(o){throw o}}};function O9e(t,e,s){if(!t||t.length===0)return null;const i={...t[0]};if(t.length>1){i.effects=null,i.symbolLayers=[];for(const r of t){const n=r;if(n.effects!=null)for(const o of n.symbolLayers)o.effects==null?o.effects=n.effects:o.effects.unshift(...n.effects);i.symbolLayers.unshift(...n.symbolLayers)}}return s&&(i.callout=F9e),{type:"CIMSymbolReference",symbol:i,primitiveOverrides:e}}var Bq;let _c=Bq=class extends fx(Gd){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new iye(this.url,this.config,this.fieldMap)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,s,i){i!=null&&i.origin||super.writeVisualVariables(t,e,s,i)}clone(){return new Bq({config:he(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:he(this.fieldMap),url:he(this.url),visualVariables:he(this.visualVariables)})}async getSymbolAsync(t,e){return this._loader.getSymbolAsync(t,e)}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await Go(t,e,this.scaleExpression);for(const s in this.fieldMap){const i=this.fieldMap[s];e.has(i)&&t.add(i)}}get arcadeRequired(){return!0}getSymbol(){return null}get symbols(){return[]}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,s)=>e+s.getAttributeHash(),""))??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};p([_({type:iye})],_c.prototype,"_loader",null),p([_({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],_c.prototype,"config",void 0),p([_({type:Object,json:{write:!0}})],_c.prototype,"fieldMap",void 0),p([_({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],_c.prototype,"scaleExpression",void 0),p([Ue("scaleExpression")],_c.prototype,"writeData",null),p([_({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],_c.prototype,"scaleExpressionTitle",void 0),p([_({type:String,json:{write:!0}})],_c.prototype,"url",void 0),p([Ue("visualVariables")],_c.prototype,"writeVisualVariables",null),_c=Bq=p([Q("esri.renderers.DictionaryRenderer")],_c);const L9e=_c;var jq;let Wm=jq=class extends Te{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return t==null?t:typeof t=="function"?(Ne.getLogger(this).error(".field: field must be a string value"),null):MC(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){var t;return new jq({color:(t=this.color)==null?void 0:t.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};p([_({type:Be,json:{type:[Number],write:!0}})],Wm.prototype,"color",void 0),p([_({type:String,json:{write:!0}})],Wm.prototype,"field",void 0),p([Ht("field")],Wm.prototype,"castField",null),p([_({type:String,json:{write:!0}})],Wm.prototype,"label",void 0),p([_({type:String,json:{write:!0}})],Wm.prototype,"valueExpression",void 0),p([_({type:String,json:{write:!0}})],Wm.prototype,"valueExpressionTitle",void 0),Wm=jq=p([Q("esri.renderers.support.AttributeColorInfo")],Wm);const rye=Wm;var Hq;let VA=Hq=class extends Te{constructor(){super(...arguments),this.unit=null}clone(){return new Hq({unit:this.unit})}};p([_({type:String,json:{write:!0}})],VA.prototype,"unit",void 0),VA=Hq=p([Q("esri.renderers.support.DotDensityLegendOptions")],VA);const V9e=VA;var Yq;let Ra=Yq=class extends fx(Gd){constructor(t){super(t),this.attributes=null,this.backgroundColor=new Be([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new tl,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(this.referenceScale==null)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new bg({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}getAttributeHash(){var t;return((t=this.attributes)==null?void 0:t.reduce((e,s)=>e+s.getAttributeHash(),""))??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new Yq({attributes:he(this.attributes),backgroundColor:he(this.backgroundColor),dotBlendingEnabled:he(this.dotBlendingEnabled),dotShape:he(this.dotShape),dotSize:he(this.dotSize),dotValue:he(this.dotValue),legendOptions:he(this.legendOptions),outline:he(this.outline),referenceScale:he(this.referenceScale),seed:he(this.seed),visualVariables:he(this.visualVariables),authoringInfo:he(this.authoringInfo)})}getControllerHash(){var e;return`${(e=this.attributes)==null?void 0:e.map(s=>s.field||s.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const s of this.attributes??[])s.valueExpression&&await Go(t,e,s.valueExpression),s.field&&t.add(s.field)}};p([_({type:[rye],json:{write:!0}})],Ra.prototype,"attributes",void 0),p([_({type:Be,json:{write:!0}})],Ra.prototype,"backgroundColor",void 0),p([_({type:Boolean,json:{write:!0}})],Ra.prototype,"dotBlendingEnabled",void 0),p([_({type:String,json:{write:!1}})],Ra.prototype,"dotShape",void 0),p([_({type:Number,json:{write:!0}})],Ra.prototype,"dotSize",void 0),p([_({type:V9e,json:{write:!0}})],Ra.prototype,"legendOptions",void 0),p([_({type:tl,json:{default:null,write:!0}})],Ra.prototype,"outline",void 0),p([_({type:Number,json:{write:!0}})],Ra.prototype,"dotValue",void 0),p([_({type:Number,json:{write:!0}})],Ra.prototype,"referenceScale",void 0),p([_({type:Number,json:{write:!0}})],Ra.prototype,"seed",void 0),p([mt({dotDensity:"dot-density"})],Ra.prototype,"type",void 0),Ra=Yq=p([Q("esri.renderers.DotDensityRenderer")],Ra);const q9e=Ra;var Xq;let vS=Xq=class extends Te{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new Xq({color:this.color&&this.color.clone(),ratio:this.ratio})}};p([_({type:Be,json:{type:[fs],default:null,write:{isRequired:!0}}})],vS.prototype,"color",void 0),p([_({type:Number,json:{write:{isRequired:!0}}})],vS.prototype,"ratio",void 0),vS=Xq=p([Q("esri.renderers.support.HeatmapColorStop")],vS);const lE=vS;let lv=class extends Wt.ClonableMixin(Te){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};p([_({type:String,json:{write:!0}})],lv.prototype,"minLabel",void 0),p([_({type:String,json:{write:!0}})],lv.prototype,"maxLabel",void 0),p([_({type:String,json:{write:!0}})],lv.prototype,"title",void 0),lv=p([Q("esri.renderers.support.HeatmapLegendOptions")],lv);function G9e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function z9e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function U9e(t,e,s,i,r){return t[0]=e,t[1]=s,t[2]=i,t[3]=r,t}function B9e(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t[3]=e[3]+s[3],t}function nye(t,e,s){return t[0]=e[0]-s[0],t[1]=e[1]-s[1],t[2]=e[2]-s[2],t[3]=e[3]-s[3],t}function oye(t,e,s){return t[0]=e[0]*s[0],t[1]=e[1]*s[1],t[2]=e[2]*s[2],t[3]=e[3]*s[3],t}function aye(t,e,s){return t[0]=e[0]/s[0],t[1]=e[1]/s[1],t[2]=e[2]/s[2],t[3]=e[3]/s[3],t}function j9e(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function H9e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Y9e(t,e,s){return t[0]=Math.min(e[0],s[0]),t[1]=Math.min(e[1],s[1]),t[2]=Math.min(e[2],s[2]),t[3]=Math.min(e[3],s[3]),t}function X9e(t,e,s){return t[0]=Math.max(e[0],s[0]),t[1]=Math.max(e[1],s[1]),t[2]=Math.max(e[2],s[2]),t[3]=Math.max(e[3],s[3]),t}function W9e(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Z9e(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t}function Q9e(t,e,s,i){return t[0]=e[0]+s[0]*i,t[1]=e[1]+s[1]*i,t[2]=e[2]+s[2]*i,t[3]=e[3]+s[3]*i,t}function lye(t,e){const s=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],n=e[3]-t[3];return Math.sqrt(s*s+i*i+r*r+n*n)}function uye(t,e){const s=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],n=e[3]-t[3];return s*s+i*i+r*r+n*n}function cye(t){const e=t[0],s=t[1],i=t[2],r=t[3];return Math.sqrt(e*e+s*s+i*i+r*r)}function hye(t){const e=t[0],s=t[1],i=t[2],r=t[3];return e*e+s*s+i*i+r*r}function J9e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function K9e(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function eBe(t,e){const s=e[0],i=e[1],r=e[2],n=e[3];let o=s*s+i*i+r*r+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=s*o,t[1]=i*o,t[2]=r*o,t[3]=n*o),t}function tBe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function mye(t,e,s,i){const r=e[0],n=e[1],o=e[2],a=e[3];return t[0]=r+i*(s[0]-r),t[1]=n+i*(s[1]-n),t[2]=o+i*(s[2]-o),t[3]=a+i*(s[3]-a),t}function sBe(t,e=1){const s=u$;let i,r,n,o,a,l;do i=2*s()-1,r=2*s()-1,a=i*i+r*r;while(a>=1);do n=2*s()-1,o=2*s()-1,l=n*n+o*o;while(l>=1);const u=Math.sqrt((1-a)/l);return t[0]=e*i,t[1]=e*r,t[2]=e*n*u,t[3]=e*o*u,t}function iBe(t,e,s){const i=e[0],r=e[1],n=e[2],o=e[3];return t[0]=s[0]*i+s[4]*r+s[8]*n+s[12]*o,t[1]=s[1]*i+s[5]*r+s[9]*n+s[13]*o,t[2]=s[2]*i+s[6]*r+s[10]*n+s[14]*o,t[3]=s[3]*i+s[7]*r+s[11]*n+s[15]*o,t}function rBe(t,e,s){const i=e[0],r=e[1],n=e[2],o=s[0],a=s[1],l=s[2],u=s[3],c=u*i+a*n-l*r,h=u*r+l*i-o*n,m=u*n+o*r-a*i,f=-o*i-a*r-l*n;return t[0]=c*u+f*-o+h*-l-m*-a,t[1]=h*u+f*-a+m*-o-c*-l,t[2]=m*u+f*-l+c*-a-h*-o,t[3]=e[3],t}function nBe(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function oBe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function aBe(t,e){const s=t[0],i=t[1],r=t[2],n=t[3],o=e[0],a=e[1],l=e[2],u=e[3],c=_a();return Math.abs(s-o)<=c*Math.max(1,Math.abs(s),Math.abs(o))&&Math.abs(i-a)<=c*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-l)<=c*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-u)<=c*Math.max(1,Math.abs(n),Math.abs(u))}const lBe=nye,uBe=oye,cBe=aye,hBe=lye,mBe=uye,dBe=cye,pBe=hye;Object.freeze(Object.defineProperty({__proto__:null,add:B9e,ceil:j9e,copy:G9e,copyVec3:z9e,dist:hBe,distance:lye,div:cBe,divide:aye,dot:tBe,equals:aBe,exactEquals:oBe,floor:H9e,inverse:K9e,len:dBe,length:cye,lerp:mye,max:X9e,min:Y9e,mul:uBe,multiply:oye,negate:J9e,normalize:eBe,random:sBe,round:W9e,scale:Z9e,scaleAndAdd:Q9e,set:U9e,sqrDist:mBe,sqrLen:pBe,squaredDistance:uye,squaredLength:hye,str:nBe,sub:lBe,subtract:nye,transformMat4:iBe,transformQuat:rBe},Symbol.toStringTag,{value:"Module"}));function G$(){return[0,0,0,0]}function fBe(t){return[t[0],t[1],t[2],t[3]]}function w0(t,e,s,i){return[t,e,s,i]}function gBe(t,e,s,i){return[t,e,s,i]}function yBe(t,e=G$()){const s=Math.min(4,t.length);for(let i=0;i<s;++i)e[i]=t[i];return e}function _Be(t,e){return new Float64Array(t,e,4)}function dye(){return G$()}function pye(){return w0(1,1,1,1)}function fye(){return w0(1,0,0,0)}function gye(){return w0(0,1,0,0)}function yye(){return w0(0,0,1,0)}function _ye(){return w0(0,0,0,1)}const vBe=dye(),bBe=pye(),xBe=fye(),wBe=gye(),SBe=yye(),EBe=_ye();Object.freeze(Object.defineProperty({__proto__:null,ONES:bBe,UNIT_W:EBe,UNIT_X:xBe,UNIT_Y:wBe,UNIT_Z:SBe,ZEROS:vBe,clone:fBe,create:G$,createView:_Be,freeze:gBe,fromArray:yBe,fromValues:w0,ones:pye,unitW:_ye,unitX:fye,unitY:gye,unitZ:yye,zeros:dye},Symbol.toStringTag,{value:"Module"}));const GU=2.4;function CBe(t){return Zl(t*GU)}function PBe(t){return ko(t)/GU}function TBe(t,e,s,i){let{color:r,ratio:n}=e,{color:o,ratio:a}=s;a===n&&(a===1?n-=1e-6:a+=1e-6);const l=Ka((i-n)/(a-n),0,1);mye(t,r.toArray(),o.toArray(),l)}function c0t(t){const s=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:a})=>a>=0&&a<=1).sort((a,l)=>a.ratio-l.ratio).map(({color:a,ratio:l})=>({color:a,ratio:Math.max(l,.001)})),t.length<1)return s;let i=t[0],r=t[0],n=1;const o=G$();for(let a=0;a<512;a++){const l=(a+.5)/512;for(;l>r.ratio&&n<t.length;)i=r,r=t[n++];TBe(o,i,r,l),s.set(o,4*a)}return s}function h0t(t,e,s){const i=Math.sqrt(t**2+e**2)/s;return i>1?0:3/(Math.PI*s**2)*(1-i**2)**2}function m0t(t){return typeof t=="function"?t:t?e=>+e[t]:()=>1}var Wq;function fte(t){if(t!=null){const{maxDensity:e,minDensity:s,radius:i}=t;if(e!=null||s!=null||i!=null){const{blurRadius:r,maxPixelIntensity:n,minPixelIntensity:o,...a}=t;return a}}return t}let $n=Wq=class extends Gd{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new lE({ratio:0,color:new Be("rgba(255, 140, 0, 0)")}),new lE({ratio:.75,color:new Be("rgba(255, 140, 0, 1)")}),new lE({ratio:.9,color:new Be("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(t){return fte(t)}get blurRadius(){return PBe(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,s=this.minPixelIntensity;this._set("radius",CBe(t)),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",s*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(GU**2*this.blurRadius**4)}read(t,e){t=fte(t),super.read(t,e)}getSymbol(){return new rm}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const s=this.field,i=this.valueExpression;s&&typeof s=="string"&&va(t,e,s),i&&typeof i=="string"&&await Go(t,e,i)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new Wq({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:he(this.colorStops),field:this.field,legendOptions:he(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};p([_({type:PU,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],$n.prototype,"authoringInfo",void 0),p([_({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],$n.prototype,"blurRadius",null),p([_({type:[lE],json:{write:{isRequired:!0}}})],$n.prototype,"colorStops",void 0),p([_({type:String,json:{write:!0}})],$n.prototype,"field",void 0),p([_({type:lv,json:{write:!0}})],$n.prototype,"legendOptions",void 0),p([_({type:Number,json:{write:!0}})],$n.prototype,"maxDensity",void 0),p([_({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],$n.prototype,"maxPixelIntensity",null),p([_({type:Number,json:{write:!0}})],$n.prototype,"minDensity",void 0),p([_({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],$n.prototype,"minPixelIntensity",null),p([_({type:Number,cast:ms,json:{write:!0}})],$n.prototype,"radius",void 0),p([_({type:Number,range:{min:0},json:{default:0,write:!0}})],$n.prototype,"referenceScale",void 0),p([mt({heatmap:"heatmap"})],$n.prototype,"type",void 0),p([_({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],$n.prototype,"valueExpression",void 0),p([_({type:String})],$n.prototype,"valueExpressionTitle",void 0),p([_({readOnly:!0})],$n.prototype,"_pixelIntensityToDensity",null),$n=Wq=p([Q("esri.renderers.HeatmapRenderer")],$n);const vye=$n;let Ky=class extends Wt.ClonableMixin(Te){constructor(){super(...arguments),this.color=new Be([0,0,0,0]),this.label=null,this.threshold=0}};p([_({type:Be,json:{write:!0}})],Ky.prototype,"color",void 0),p([_({type:String,json:{write:!0}})],Ky.prototype,"label",void 0),p([_({type:Number,range:{min:0,max:1},json:{write:!0}})],Ky.prototype,"threshold",void 0),Ky=p([Q("esri.renderers.support.OthersCategory")],Ky);const IBe={base:px,key:"type",typeMap:{size:L$,opacity:TU}};let ka=class extends fx(Wt.ClonableMixin(Gd)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new Be([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new Ky,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){var e;return new rm({size:this.size?this.size/2+(((e=this.outline)==null?void 0:e.width)||0):0})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(Qa)}getAttributeHash(){var e;return((e=this.visualVariables)==null?void 0:e.reduce((s,i)=>s+i.getAttributeHash(),""))??""}getMeshHash(){return this.symbols.reduce((e,s)=>e+JSON.stringify(s),"")}async collectRequiredFields(e,s){await this.collectVVRequiredFields(e,s);for(const i of this.attributes)i.valueExpression&&await Go(e,s,i.valueExpression),i.field&&e.add(i.field)}};p([_({type:[rye],json:{write:!0}})],ka.prototype,"attributes",void 0),p([_(NU)],ka.prototype,"backgroundFillSymbol",void 0),p([_({type:Be,json:{write:!0}})],ka.prototype,"defaultColor",void 0),p([_({type:String,json:{write:!0}})],ka.prototype,"defaultLabel",void 0),p([_({type:Number,range:{min:0,max:1},json:{write:!0}})],ka.prototype,"holePercentage",void 0),p([_({type:Ky,json:{write:!0}})],ka.prototype,"othersCategory",void 0),p([_({type:DU,json:{write:!0}})],ka.prototype,"legendOptions",void 0),p([_({type:tl,json:{default:null,write:!0}})],ka.prototype,"outline",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],ka.prototype,"size",void 0),p([mt({pieChart:"pie-chart"})],ka.prototype,"type",void 0),p([_({types:[IBe]})],ka.prototype,"visualVariables",void 0),ka=p([Q("esri.renderers.PieChartRenderer")],ka);const MBe=ka,yx={key:"type",base:Gd,typeMap:{heatmap:vye,simple:Yh,"unique-value":RU,"class-breaks":Xge,"dot-density":q9e,dictionary:L9e,"pie-chart":MBe},errorContext:"renderer"},bye={key:"type",base:Gd,typeMap:{simple:Yh,"unique-value":RU,"class-breaks":Xge,heatmap:vye},errorContext:"renderer",validate:ABe};function ABe(t){switch(t.type){case"simple":return NBe(t);case"unique-value":return DBe(t);case"class-breaks":return $Be(t);case"heatmap":return t}}function NBe(t){if(t.symbol)return t;Ne.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function DBe(t){const e=t.uniqueValueInfos,s=e==null?void 0:e.filter(({symbol:i,label:r},n)=>(i||Ne.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${n}] ${r}) without a symbol from web scene.`),!!i));return(s==null?void 0:s.length)!==(e==null?void 0:e.length)&&(t.uniqueValueInfos=s),t}function $Be(t){const e=t.classBreakInfos,s=e==null?void 0:e.filter(({symbol:i,label:r},n)=>(i||Ne.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${n}] ${r}) without a symbol from web scene.`),!!i));return(s==null?void 0:s.length)!==(e==null?void 0:e.length)&&(t.classBreakInfos=s),t}function f0t(t,e){return HE(t,null,e)}const RBe=Jb({types:yx});function HE(t,e,s){return t?t&&(t.styleName||t.styleUrl)&&t.type!=="uniqueValue"?(s!=null&&s.messages&&s.messages.push(new qu("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:s})),null):RBe(t,e,s):null}var Zq;let To=Zq=class extends Uf{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=null,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.size=ms("12px"),this.fields=[],this.renderer=null}writeFields(t,e,s){const i=t.filter(r=>r.statisticType!=="avg_angle").map(r=>r.toJSON());Hn(s,i,e)}readRenderer(t,e,s){var r;const i=(r=e.drawingInfo)==null?void 0:r.renderer;return i?HE(i,e,s)??void 0:FU(e,s)}clone(){return new Zq({fields:he(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:he(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:he(this.popupTemplate),renderer:he(this.renderer),binType:he(this.binType),size:this.size})}};p([mt({binning:"binning"})],To.prototype,"type",void 0),p([mt({geohash:"geohash",square:"square"}),_({type:["geohash","square"]})],To.prototype,"binType",void 0),p([_({type:Number,json:{write:!0}})],To.prototype,"fixedBinLevel",void 0),p([_({type:[gx],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],To.prototype,"labelingInfo",void 0),p([_(dP)],To.prototype,"labelsVisible",void 0),p([_({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],To.prototype,"maxScale",void 0),p([_(mP)],To.prototype,"popupEnabled",void 0),p([_({type:v0,json:{name:"popupInfo",write:!0}})],To.prototype,"popupTemplate",void 0),p([_({cast:t=>t==="auto"?t:ma(ms(t))})],To.prototype,"size",void 0),p([_({type:[ig],json:{write:!0}})],To.prototype,"fields",void 0),p([Ue("fields")],To.prototype,"writeFields",null),p([_({types:yx,json:{write:{target:"drawingInfo.renderer"}}})],To.prototype,"renderer",void 0),p([qe("renderer",["drawingInfo.renderer"])],To.prototype,"readRenderer",null),To=Zq=p([Q("esri.layers.support.FeatureReductionBinning")],To);const xye=To;var Qq;function gte(t){var e;return t.type==="simple"&&!((e=t.visualVariables)!=null&&e.length)}let Yr=Qq=class extends Te{constructor(t){super(t),this.type="cluster",this.clusterRadius=ms("80px"),this.clusterMinSize=ms("12px"),this.clusterMaxSize=ms("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(t,e,s){var r,n;const i=(r=e.drawingInfo)==null?void 0:r.renderer;return(n=i==null?void 0:i.authoringInfo)!=null&&n.isAutoGenerated?null:i?gte(i)?null:HE(i,e,s)??void 0:FU(e,s)}readSymbol(t,e,s){var r,n;const i=(r=e.drawingInfo)==null?void 0:r.renderer;if((n=i==null?void 0:i.authoringInfo)!=null&&n.isAutoGenerated)return null;if(i&&gte(i)){const o=HE(i,e,s);return o==null?void 0:o.symbol}return null}writeSymbol(t,e,s,i){var n,o;const r=(o=(n=this.renderer)==null?void 0:n.authoringInfo)==null?void 0:o.isAutoGenerated;if(!this.renderer||r){const a=new Yh({symbol:t});e.drawingInfo={renderer:a.write({},i)}}}writeFields(t,e,s){const i=t.filter(r=>r.statisticType!=="avg_angle").map(r=>r.toJSON());Hn(s,i,e)}readFields(t,e,s){return t.filter(i=>!i.isAutoGenerated).map(i=>ig.fromJSON(i))}clone(){return new Qq({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:he(this.labelingInfo),labelsVisible:this.labelsVisible,fields:he(this.fields),maxScale:this.maxScale,renderer:he(this.renderer),symbol:he(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:he(this.popupTemplate)})}};p([_({type:["cluster"],readOnly:!0,json:{write:!0}})],Yr.prototype,"type",void 0),p([_({cast:t=>t==="auto"?t:ma(ms(t)),json:{write:!0}})],Yr.prototype,"clusterRadius",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],Yr.prototype,"clusterMinSize",void 0),p([_({type:Number,cast:ms,json:{write:!0}})],Yr.prototype,"clusterMaxSize",void 0),p([_({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Yr.prototype,"maxScale",void 0),p([_(mP)],Yr.prototype,"popupEnabled",void 0),p([_({type:v0,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],Yr.prototype,"popupTemplate",void 0),p([_({types:yx,json:{write:{target:"drawingInfo.renderer"}}})],Yr.prototype,"renderer",void 0),p([qe("renderer",["drawingInfo.renderer"])],Yr.prototype,"readRenderer",null),p([_({types:$4e})],Yr.prototype,"symbol",void 0),p([qe("symbol",["drawingInfo.renderer"])],Yr.prototype,"readSymbol",null),p([Ue("symbol")],Yr.prototype,"writeSymbol",null),p([_({type:[gx],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Yr.prototype,"labelingInfo",void 0),p([_(dP)],Yr.prototype,"labelsVisible",void 0),p([_({type:[ig],json:{write:!0}})],Yr.prototype,"fields",void 0),p([Ue("fields")],Yr.prototype,"writeFields",null),p([qe("fields")],Yr.prototype,"readFields",null),Yr=Qq=p([Q("esri.layers.support.FeatureReductionCluster")],Yr);const wye=Yr;var Jq;let qA=Jq=class extends Uf{constructor(t){super(t),this.type="selection"}clone(){return new Jq}};p([_({type:["selection"]})],qA.prototype,"type",void 0),qA=Jq=p([Q("esri.layers.support.FeatureReductionSelection")],qA);const yte=qA,_te={key:"type",base:Uf,typeMap:{cluster:wye,binning:xye}},kBe={types:{key:"type",base:Uf,typeMap:{selection:yte,cluster:wye,binning:xye}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:_te},"portal-item":{types:_te},"web-scene":{types:{key:"type",base:Uf,typeMap:{selection:yte}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:Gi}}}}},P1={Base64:0,Hex:1,String:2,Raw:3},ob=8,Sye=(1<<ob)-1;function Df(t,e){const s=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(s>>16)<<16|65535&s}function FBe(t){const e=[];for(let s=0,i=t.length*ob;s<i;s+=ob)e[s>>5]|=(t.charCodeAt(s/ob)&Sye)<<s%32;return e}function OBe(t){const e=[];for(let s=0,i=32*t.length;s<i;s+=ob)e.push(String.fromCharCode(t[s>>5]>>>s%32&Sye));return e.join("")}function LBe(t){const e="0123456789abcdef",s=[];for(let i=0,r=4*t.length;i<r;i++)s.push(e.charAt(t[i>>2]>>i%4*8+4&15)+e.charAt(t[i>>2]>>i%4*8&15));return s.join("")}function VBe(t){const e="=",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[];for(let r=0,n=4*t.length;r<n;r+=3){const o=(t[r>>2]>>r%4*8&255)<<16|(t[r+1>>2]>>(r+1)%4*8&255)<<8|t[r+2>>2]>>(r+2)%4*8&255;for(let a=0;a<4;a++)8*r+6*a>32*t.length?i.push(e):i.push(s.charAt(o>>6*(3-a)&63))}return i.join("")}function qBe(t,e){return t<<e|t>>>32-e}function z$(t,e,s,i,r,n){return Df(qBe(Df(Df(e,t),Df(i,n)),r),s)}function bo(t,e,s,i,r,n,o){return z$(e&s|~e&i,t,e,r,n,o)}function xo(t,e,s,i,r,n,o){return z$(e&i|s&~i,t,e,r,n,o)}function wo(t,e,s,i,r,n,o){return z$(e^s^i,t,e,r,n,o)}function So(t,e,s,i,r,n,o){return z$(s^(e|~i),t,e,r,n,o)}function GBe(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let s=1732584193,i=-271733879,r=-1732584194,n=271733878;for(let o=0;o<t.length;o+=16){const a=s,l=i,u=r,c=n;s=bo(s,i,r,n,t[o],7,-680876936),n=bo(n,s,i,r,t[o+1],12,-389564586),r=bo(r,n,s,i,t[o+2],17,606105819),i=bo(i,r,n,s,t[o+3],22,-1044525330),s=bo(s,i,r,n,t[o+4],7,-176418897),n=bo(n,s,i,r,t[o+5],12,1200080426),r=bo(r,n,s,i,t[o+6],17,-1473231341),i=bo(i,r,n,s,t[o+7],22,-45705983),s=bo(s,i,r,n,t[o+8],7,1770035416),n=bo(n,s,i,r,t[o+9],12,-1958414417),r=bo(r,n,s,i,t[o+10],17,-42063),i=bo(i,r,n,s,t[o+11],22,-1990404162),s=bo(s,i,r,n,t[o+12],7,1804603682),n=bo(n,s,i,r,t[o+13],12,-40341101),r=bo(r,n,s,i,t[o+14],17,-1502002290),i=bo(i,r,n,s,t[o+15],22,1236535329),s=xo(s,i,r,n,t[o+1],5,-165796510),n=xo(n,s,i,r,t[o+6],9,-1069501632),r=xo(r,n,s,i,t[o+11],14,643717713),i=xo(i,r,n,s,t[o],20,-373897302),s=xo(s,i,r,n,t[o+5],5,-701558691),n=xo(n,s,i,r,t[o+10],9,38016083),r=xo(r,n,s,i,t[o+15],14,-660478335),i=xo(i,r,n,s,t[o+4],20,-405537848),s=xo(s,i,r,n,t[o+9],5,568446438),n=xo(n,s,i,r,t[o+14],9,-1019803690),r=xo(r,n,s,i,t[o+3],14,-187363961),i=xo(i,r,n,s,t[o+8],20,1163531501),s=xo(s,i,r,n,t[o+13],5,-1444681467),n=xo(n,s,i,r,t[o+2],9,-51403784),r=xo(r,n,s,i,t[o+7],14,1735328473),i=xo(i,r,n,s,t[o+12],20,-1926607734),s=wo(s,i,r,n,t[o+5],4,-378558),n=wo(n,s,i,r,t[o+8],11,-2022574463),r=wo(r,n,s,i,t[o+11],16,1839030562),i=wo(i,r,n,s,t[o+14],23,-35309556),s=wo(s,i,r,n,t[o+1],4,-1530992060),n=wo(n,s,i,r,t[o+4],11,1272893353),r=wo(r,n,s,i,t[o+7],16,-155497632),i=wo(i,r,n,s,t[o+10],23,-1094730640),s=wo(s,i,r,n,t[o+13],4,681279174),n=wo(n,s,i,r,t[o],11,-358537222),r=wo(r,n,s,i,t[o+3],16,-722521979),i=wo(i,r,n,s,t[o+6],23,76029189),s=wo(s,i,r,n,t[o+9],4,-640364487),n=wo(n,s,i,r,t[o+12],11,-421815835),r=wo(r,n,s,i,t[o+15],16,530742520),i=wo(i,r,n,s,t[o+2],23,-995338651),s=So(s,i,r,n,t[o],6,-198630844),n=So(n,s,i,r,t[o+7],10,1126891415),r=So(r,n,s,i,t[o+14],15,-1416354905),i=So(i,r,n,s,t[o+5],21,-57434055),s=So(s,i,r,n,t[o+12],6,1700485571),n=So(n,s,i,r,t[o+3],10,-1894986606),r=So(r,n,s,i,t[o+10],15,-1051523),i=So(i,r,n,s,t[o+1],21,-2054922799),s=So(s,i,r,n,t[o+8],6,1873313359),n=So(n,s,i,r,t[o+15],10,-30611744),r=So(r,n,s,i,t[o+6],15,-1560198380),i=So(i,r,n,s,t[o+13],21,1309151649),s=So(s,i,r,n,t[o+4],6,-145523070),n=So(n,s,i,r,t[o+11],10,-1120210379),r=So(r,n,s,i,t[o+2],15,718787259),i=So(i,r,n,s,t[o+9],21,-343485551),s=Df(s,a),i=Df(i,l),r=Df(r,u),n=Df(n,c)}return[s,i,r,n]}function Eye(t,e=P1.Hex){const s=e||P1.Base64,i=GBe(FBe(t),t.length*ob);switch(s){case P1.Raw:return i;case P1.Hex:return LBe(i);case P1.String:return OBe(i);case P1.Base64:return VBe(i)}}const zBe=()=>Ne.getLogger("esri.views.2d.layers.support.clusterUtils");ge.add("esri-cluster-arcade-enabled",!0);const UBe=ge("esri-cluster-arcade-enabled"),BBe=new Set(["simple-line","simple-fill","picture-fill"]);function vte(t,e){let s=e.clone();if(!jBe(s))return s;if(e.symbols.some(i=>BBe.has(i.type))&&(s=new Yh({symbol:new rm})),s.authoringInfo||(s.authoringInfo=new PU),s.authoringInfo.isAutoGenerated=!0,"visualVariables"in s){const i=(s.visualVariables||[]).filter(r=>r.valueExpression!=="$view.scale");i.forEach(r=>{r.type==="rotation"?r.field?r.field=Kg(t,r.field,"avg_angle","number"):r.valueExpression&&(r.field=t2(t,r.valueExpression,"avg_angle","number"),r.valueExpression=null):r.normalizationField?(r.field=Kg(t,r.field,"avg_norm","number",r.normalizationField),r.normalizationField=null):r.field?r.field=Kg(t,r.field,"avg","number"):r.valueExpression&&(r.field=t2(t,r.valueExpression,"avg","number"),r.valueExpression=null)}),s.visualVariables=i}switch(s.type){case"simple":break;case"pie-chart":for(const i of s.attributes)i.field?i.field=Kg(t,i.field,"sum","number"):i.valueExpression&&(i.field=t2(t,i.valueExpression,"sum","number"),i.valueExpression=null);break;case"unique-value":s.field?s.field=Kg(t,s.field,"mode","string"):s.valueExpression&&(s.field=t2(t,s.valueExpression,"mode","string"),s.valueExpression=null);break;case"class-breaks":s.normalizationField?(s.field=Kg(t,s.field,"avg_norm","number",s.normalizationField),s.normalizationField=null):s.field?s.field=Kg(t,s.field,"avg","number"):s.valueExpression&&(s.field=t2(t,s.valueExpression,"avg","number"),s.valueExpression=null)}return s}const jBe=t=>{const e=s=>zBe().error(new ae("Unsupported-renderer",s,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const s=t.normalizationType;if(s!=="field")return e(`FeatureReductionCluster does not support a normalizationType of ${s}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!UBe){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some(s=>!(!("valueExpression"in s)||!s.valueExpression)))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function HBe(t,e,s){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const i=s,r="field",n=e.toLowerCase()+",norm:"+r+","+i.toLowerCase();return"cluster_avg_"+Eye(n)}}}function t2(t,e,s,i){const r=Eye(e),n=s==="mode"?`cluster_type_${r}`:s==="sum"?`cluster_sum_${r}`:`cluster_avg_${r}`;return t.some(o=>o.name===n)||t.push(new ig({name:n,isAutoGenerated:!0,onStatisticExpression:new SU({expression:e,returnType:i}),statisticType:s})),n}function Kg(t,e,s,i,r){if(e==="cluster_count"||t.some(o=>o.name===e))return e;const n=HBe(s,e,r);return t.some(o=>o.name===n)||(s==="avg_norm"?t.push(new ig({name:n,isAutoGenerated:!0,onStatisticExpression:new SU({expression:`$feature.${e} / $feature.${r}`,returnType:i}),statisticType:"avg"})):t.push(new ig({name:n,isAutoGenerated:!0,onStatisticField:e,statisticType:s}))),n}const Cye=t=>{let e=class extends t{constructor(...s){super(...s),this.addHandles(Ee(()=>this.renderer,()=>{if(this.featureReduction){const i=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",i)}},Xc))}set featureReduction(s){const i=this._normalizeFeatureReduction(s);this._set("featureReduction",i)}set renderer(s){}_withClusterVariable(s,i,r){const n=s.clone();return"visualVariables"in n&&(n.visualVariables||(n.visualVariables=[]),n.visualVariables.some(o=>o.type==="size")||n.visualVariables.push(new L$({field:"cluster_count",stops:[new AA({value:1}),new AA({useMinValue:!0,size:i}),new AA({useMaxValue:!0,size:r})]}))),n}_normalizeFeatureReduction(s){var h;if((s==null?void 0:s.type)!=="cluster")return s;const i=s.clone(),r=[new ig({name:"cluster_count",alias:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],n=(i.fields??[]).filter(m=>!m.isAutoGenerated),o=s.renderer&&!((h=s.renderer.authoringInfo)!=null&&h.isAutoGenerated),{clusterMinSize:a,clusterMaxSize:l}=i;if(o){i.fields=[...r,...n];const m=this._withClusterVariable(i.renderer,a,l);return i.effectiveFeatureRenderer=m,i.effectiveClusterRenderer=m,i}if(s.symbol){if(i.fields=[...r,...n],i.renderer=null,!this.renderer)return i.effectiveFeatureRenderer=null,i.effectiveClusterRenderer=null,i;const m=vte(r,this.renderer),f=this._withClusterVariable(m,a,l),g="visualVariables"in f&&f.visualVariables?f.visualVariables:[],v=new Yh({symbol:s.symbol,visualVariables:g});return i.fields=[...r,...n],i.effectiveFeatureRenderer=f,i.effectiveClusterRenderer=v,i}if(!this.renderer)return s;const u=vte(r,this.renderer);i.fields=[...r,...n],i.renderer=u;const c=this._withClusterVariable(u,a,l);return i.effectiveFeatureRenderer=c,i.effectiveClusterRenderer=c,i}};return p([_(kBe)],e.prototype,"featureReduction",null),e=p([Q("esri.layers.mixins.FeatureReductionLayer")],e),e},bte={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},xte={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},wte={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},YBe={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,Object3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":bte,"web-map/basemap":xte,"web-map/tables":wte,"link-chart/operational-layers":{...bte,LinkChartLayer:!0},"link-chart/basemap":xte,"link-chart/tables":wte,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0,WCS:!0},"portal-item/tables":{ArcGISFeatureLayer:!0,SubtypeGroupTable:!0}},Pye=t=>{let e=class extends t{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(s,i,r){var n;return((n=r==null?void 0:r.portalItem)==null?void 0:n.type)==="Group Layer"?void 0:s}writeListMode(s,i,r,n){(n&&n.layerContainerType==="ground"||s&&lPe(this,r,{},n))&&(i[r]=s)}writeOperationalLayerType(s,i,r){s&&(i[r]=s)}writeTitle(s,i){i.title=s??"Layer"}readVisibilityTimeExtent(s){return s?Ad.fromArray(s):null}writeVisibilityTimeExtent(s,i,r,n){s&&n.layerContainerType!=="tables"&&(s.isEmpty?n!=null&&n.messages&&n.messages.push(new ae("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):i[r]=s.toArray())}read(s,i){i&&(i.layer=this),nPe(this,s,r=>super.read(s,r),i)}write(s,i){var o,a;if(!this.persistenceEnabled&&!(i!=null&&i.ignorePersistenceEnabled))return null;if(i!=null&&i.origin){const l=`${i.origin}/${i.layerContainerType||"operational-layers"}`,u=YBe[l];let c=!!(u!=null&&u[this.operationalLayerType]);if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&l==="web-scene/operational-layers"&&(c=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&l==="web-map/operational-layers"&&(c=!1),!c)return(o=i.messages)==null||o.push(new ae("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${l}'`,{layer:this})),null}const r=super.write(s,{...i,layer:this}),n=!!i&&!!i.messages&&!!i.messages.filter(l=>l instanceof ae&&l.name==="web-document-write:property-required").length;return LD(r==null?void 0:r.url)?((a=i==null?void 0:i.messages)==null||a.push(new ae("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&n?null:r}beforeSave(){}};return p([_({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],e.prototype,"id",void 0),p([qe("id",["id"])],e.prototype,"readId",null),p([_(pge)],e.prototype,"listMode",void 0),p([Ue("listMode")],e.prototype,"writeListMode",null),p([_({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:Gi,isRequired:!0}}}}})],e.prototype,"operationalLayerType",void 0),p([Ue("operationalLayerType")],e.prototype,"writeOperationalLayerType",null),p([_(M3)],e.prototype,"opacity",void 0),p([_({type:Boolean,readOnly:!1})],e.prototype,"persistenceEnabled",void 0),p([_({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],e.prototype,"title",void 0),p([Ue("title"),Ue(["web-scene"],"title")],e.prototype,"writeTitle",null),p([_({type:Ad,json:{origins:{"web-scene":{write:{layerContainerTypes:Gi}}}}})],e.prototype,"visibilityTimeExtent",void 0),p([qe("visibilityTimeExtent")],e.prototype,"readVisibilityTimeExtent",null),p([Ue(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[fs,ND]]}})],e.prototype,"writeVisibilityTimeExtent",null),p([_({type:Boolean,json:{name:"visibility",write:{layerContainerTypes:Gi}}})],e.prototype,"visible",void 0),e=p([Q("esri.layers.mixins.OperationalLayer")],e),e};var Kq;const zI=new Jt({asc:"ascending",desc:"descending"});let uv=Kq=class extends Te{constructor(t){super(t),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new Kq({field:this.field,valueExpression:this.valueExpression,order:this.order})}};p([_({type:String,json:{write:!0}})],uv.prototype,"field",void 0),p([_({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],uv.prototype,"valueExpression",void 0),p([_({type:zI.apiValues,json:{type:zI.jsonValues,read:zI.read,write:zI.write}})],uv.prototype,"order",void 0),uv=Kq=p([Q("esri.layers.support.OrderByInfo")],uv);const Tye=uv;function XBe(t,e,s){if(!t)return null;const i=t.find(n=>!!n.field);if(!i)return null;const r=new Tye;return r.read(i,s),[r]}function WBe(t,e,s,i){const r=t.find(n=>!!n.field);r&&Hn(s,[r.toJSON()],e)}const ZBe={type:[Tye],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:XBe},write:{writer:WBe}}},Iye=t=>{let e=class extends t{constructor(){super(...arguments),this.orderBy=null}};return p([_(ZBe)],e.prototype,"orderBy",void 0),e=p([Q("esri.layers.mixins.OrderedLayer")],e),e};async function QBe(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return o_(t);const s=St.WGS84;return await s$(e,s),Vd(t,s)}function JBe(t,e){if(!Mye(t,e)){const s=t.typeKeywords;s?s.push(e):t.typeKeywords=[e]}}function Mye(t,e){var s;return!!((s=t.typeKeywords)!=null&&s.includes(e))}function g0t(t){return Mye(t,eje.HOSTED_SERVICE)}function KBe(t,e){const s=t.typeKeywords;if(s){const i=s.indexOf(e);i>-1&&s.splice(i,1)}}function y0t(t,e,s){s?JBe(t,e):KBe(t,e)}async function _0t(t){const e=t.clone().normalize();let s;if(e.length>1)for(const i of e)s?i.width>s.width&&(s=i):s=i;else s=e[0];return QBe(s)}const eje={GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function tje(t){var l;const{portal:e,isOrgItem:s,itemControl:i}=t,r=(l=e.user)==null?void 0:l.privileges;let n=!r||r.includes("features:user:edit"),o=!!s&&!!(r!=null&&r.includes("features:user:fullEdit"));const a=i==="update"||i==="admin";return a?o=n=!0:o&&(n=!0),{features:{edit:n,fullEdit:o},content:{updateItem:a}}}const Aye=t=>{let e=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=ii(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(s){s!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",s))}readPortalItem(s,i,r){if(i.itemId)return new sb({id:i.itemId,portal:r==null?void 0:r.portal})}writePortalItem(s,i){s!=null&&s.id&&(i.itemId=s.id)}async loadFromPortal(s,i){var r;if((r=this.portalItem)!=null&&r.id)try{const{load:n}=await me(()=>import("./layersLoader-Cj0zxjyL.js"),__vite__mapDeps([284,149,148,150,285]));return ni(i),await n({instance:this,supportedTypes:s.supportedTypes,validateItem:s.validateItem,supportsData:s.supportsData,layerModuleTypeMap:s.layerModuleTypeMap,populateGroupLayer:s.populateGroupLayer},i)}catch(n){throw Lr(n)||Ne.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${n}`),n}}async finishLoadEditablePortalLayer(s){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(s).catch(i=>(Nc(i),!0)))}async setUserPrivileges(s,i){if(!Ds.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(i);if(this.url)try{const{features:{edit:r,fullEdit:n},content:{updateItem:o}}=await this._fetchUserPrivileges(s,i);this._set("userHasEditingPrivileges",r),this._set("userHasFullEditingPrivileges",n),this._set("userHasUpdateItemPrivileges",o)}catch(r){Nc(r)}}async _fetchUserPrivileges(s,i){let r=this.portalItem;if(!s||!r||!r.loaded||r.sourceUrl)return this._fetchFallbackUserPrivileges(i);const n=!(Mt!=null&&Mt.findCredential(this.url)),o=s===r.id;if(o&&r.portal.user)return this._getUserPrivileges(r,n);let a,l;if(o)a=r.portal.url;else try{a=await E7(this.url,i)}catch(m){Nc(m)}if(!a||!APe(a,r.portal.url))return this._fetchFallbackUserPrivileges(i);try{const m=i!=null?i.signal:null;l=await(Mt==null?void 0:Mt.getCredential(`${a}/sharing`,{prompt:!1,signal:m}))}catch(m){Nc(m)}const u=!0,c=!1,h=!1;if(!l)return{features:{edit:u,fullEdit:c},content:{updateItem:h}};try{if(o?await r.reload():(r=new sb({id:s,portal:{url:a}}),await r.load(i)),r.portal.user)return this._getUserPrivileges(r,n)}catch(m){Nc(m)}return{features:{edit:u,fullEdit:c},content:{updateItem:h}}}_getUserPrivileges(s,i){const r=tje(s);return i&&(r.features.edit=!0),r}async _fetchFallbackUserPrivileges(s){let i=!0;try{i=await this._fetchUserHasEditingPrivileges(s)}catch(r){Nc(r)}return{features:{edit:i,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(s){const i=this.url?Mt==null?void 0:Mt.findCredential(this.url):null;if(!i)return!0;const r=UI.credential===i?UI.user:await this._fetchEditingUser(s);return UI.credential=i,UI.user=r,(r==null?void 0:r.privileges)==null||r.privileges.includes("features:user:edit")}async _fetchEditingUser(s){var c,h;const i=(h=(c=this.portalItem)==null?void 0:c.portal)==null?void 0:h.user;if(i)return i;const r=Mt==null?void 0:Mt.findServerInfo(this.url??"");if(!(r!=null&&r.owningSystemUrl))return null;const n=`${r.owningSystemUrl}/sharing/rest`,o=qo.getDefault();if(o&&o.loaded&&Gc(o.restUrl)===Gc(n))return o.user;const a=`${n}/community/self`,l=s!=null?s.signal:null,u=await XD(js(a,{authMode:"no-prompt",query:{f:"json"},signal:l}));return u.ok?S7.fromJSON(u.value.data):null}read(s,i){i&&(i.layer=this),super.read(s,i)}write(s,i){var o;const r=i==null?void 0:i.portal,n=((o=this.portalItem)==null?void 0:o.id)&&(this.portalItem.portal||qo.getDefault());return r&&n&&!Bae(n.restUrl,r.restUrl)?(i.messages&&i.messages.push(new ae("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(s,{...i,layer:this})}};return p([_({type:sb})],e.prototype,"portalItem",null),p([qe("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),p([Ue("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),p([_({clonable:!1})],e.prototype,"resourceReferences",void 0),p([_({type:Boolean,readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),p([_({type:Boolean,readOnly:!0})],e.prototype,"userHasFullEditingPrivileges",void 0),p([_({type:Boolean,readOnly:!0})],e.prototype,"userHasUpdateItemPrivileges",void 0),e=p([Q("esri.layers.mixins.PortalLayer")],e),e},UI={credential:null,user:null},$f=new Ge,uE=new WeakMap;function sje(t){rje(t)&&$f.push(new WeakRef(t))}function ije(t){const e=$f.find(s=>s.deref()===t);e&&$f.remove(e)}function rje(t){return t!=null&&typeof t=="object"&&"refreshInterval"in t&&"refresh"in t}function Nye(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:Nye(e,t%e):0}let CO=0,BI=0;function nje(){const t=Date.now();let e=!1;for(const s of $f){const i=s.deref();i?i.refreshInterval&&t-(uE.get(i)??0)+5>=6e4*i.refreshInterval&&(uE.set(i,t),i.refresh(t)):e=!0}if(e)for(let s=$f.length-1;s>=0;s--)$f.at(s).deref()||$f.removeAt(s)}vae(()=>{const t=Date.now();let e=0;for(const s of $f){const i=s.deref();i&&(e=Nye(Math.round(6e4*i.refreshInterval),e),i.refreshInterval?uE.get(i)||uE.set(i,t):uE.delete(i))}if(e!==BI){if(BI=e,clearInterval(CO),BI===0)return void(CO=0);CO=setInterval(nje,BI)}},Xc);const Ste=.1,Dye=t=>{let e=class extends t{constructor(...s){super(...s),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=jh(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||sje(this)},()=>{})}destroy(){ije(this)}castRefreshInterval(s){return s>=Ste?s:s<=0?0:Ste}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(s=Date.now()){zl(this._debounceHasDataChanged()).then(i=>{i&&this._set("refreshTimestamp",s),this.emit("refresh",{dataChanged:i})},i=>{Ne.getLogger(this).error(i),this.emit("refresh",{dataChanged:!1,error:i})})}async hasDataChanged(){return!0}get test(){}};return p([_({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:Gi}}}}})],e.prototype,"refreshInterval",void 0),p([Ht("refreshInterval")],e.prototype,"castRefreshInterval",null),p([_({readOnly:!0})],e.prototype,"refreshTimestamp",void 0),p([_({readOnly:!0})],e.prototype,"refreshParameters",null),e=p([Q("esri.layers.mixins.RefreshableLayer")],e),e},zU=t=>{let e=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const s={minScale:this.minScale,maxScale:this.maxScale},i=this.parent;i&&"effectiveScaleRange"in i&&oje(s,i.effectiveScaleRange);const r=this._get("effectiveScaleRange");return r&&r.minScale===s.minScale&&r.maxScale===s.maxScale?r:s}};return p([_({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"minScale",void 0),p([_({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"maxScale",void 0),p([_({readOnly:!0})],e.prototype,"effectiveScaleRange",null),e=p([Q("esri.layers.mixins.ScaleRangeLayer")],e),e};function oje(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}const $ye=Xn()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let bS=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return Hhe(this.value,this.unit,"milliseconds")}};p([mt($ye,{nonNullable:!0})],bS.prototype,"unit",void 0),p([_({type:Number,json:{write:!0},nonNullable:!0})],bS.prototype,"value",void 0),bS=p([Q("esri.time.TimeInterval")],bS);const YE=bS;function Ete(t,e){return YE.fromJSON({value:t,unit:e})}let ro=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,s){return s.timeExtent&&Array.isArray(s.timeExtent)&&s.timeExtent.length===2?Ad.fromArray(s.timeExtent):null}writeFullTimeExtent(e,s){(e==null?void 0:e.start)!=null&&e.end!=null?s.timeExtent=e.toArray():s.timeExtent=null}readInterval(e,s){return s.timeInterval&&s.timeIntervalUnits?Ete(s.timeInterval,s.timeIntervalUnits):s.defaultTimeInterval&&s.defaultTimeIntervalUnits?Ete(s.defaultTimeInterval,s.defaultTimeIntervalUnits):null}writeInterval(e,s){s.timeInterval=(e==null?void 0:e.toJSON().value)??null,s.timeIntervalUnits=(e==null?void 0:e.toJSON().unit)??null}};p([_({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],ro.prototype,"cumulative",void 0),p([_({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],ro.prototype,"endField",void 0),p([_({type:Ad,json:{write:{enabled:!0,allowNull:!0}}})],ro.prototype,"fullTimeExtent",void 0),p([qe("fullTimeExtent",["timeExtent"])],ro.prototype,"readFullTimeExtent",null),p([Ue("fullTimeExtent")],ro.prototype,"writeFullTimeExtent",null),p([_({type:Boolean,json:{write:!0}})],ro.prototype,"hasLiveData",void 0),p([_({type:YE,json:{write:{enabled:!0,allowNull:!0}}})],ro.prototype,"interval",void 0),p([qe("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],ro.prototype,"readInterval",null),p([Ue("interval")],ro.prototype,"writeInterval",null),p([_({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],ro.prototype,"startField",void 0),p([_($E("timeReference",!0))],ro.prototype,"timeZone",void 0),p([_({type:String,json:{write:{enabled:!0,allowNull:!0}}})],ro.prototype,"trackIdField",void 0),p([_({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],ro.prototype,"useTime",void 0),p([_({type:[Date],json:{read:!1}})],ro.prototype,"stops",void 0),ro=p([Q("esri.layers.support.TimeInfo")],ro);const Rye=ro,aje={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:Gi}}},kye=t=>{let e=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(s,i){const r=i.timeInfo.exportOptions;if(!r)return null;const n=r.timeOffset,o=$ye.fromJSON(r.timeOffsetUnits);return n&&o?new YE({value:n,unit:o}):null}set timeInfo(s){M7(s,this.fieldsIndex),this._set("timeInfo",s)}};return p([_({type:Ad,json:{write:!1}})],e.prototype,"timeExtent",void 0),p([_({type:YE})],e.prototype,"timeOffset",void 0),p([qe("service","timeOffset",["timeInfo.exportOptions"])],e.prototype,"readOffset",null),p([_({value:null,type:Rye,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"timeInfo",null),p([_(aje)],e.prototype,"useViewTime",void 0),e=p([Q("esri.layers.mixins.TemporalLayer")],e),e};let zy=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.labelingInfo=null,this.labelsVisible=!0,this.renderer=null,this.visible=!0}};p([_({type:[gx],json:{write:!0}})],zy.prototype,"labelingInfo",void 0),p([_(dP)],zy.prototype,"labelsVisible",void 0),p([_({types:yx,json:{write:!0}})],zy.prototype,"renderer",void 0),p([_({type:Boolean,json:{write:!0}})],zy.prototype,"visible",void 0),zy=p([Q("esri.layers.support.TrackPartInfo")],zy);const ab=zy;let Fa=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.enabled=!0,this.fields=[],this.latestObservations=new ab({renderer:new Yh({symbol:A3.clone()})}),this.maxDisplayDuration=null,this.maxDisplayObservationsPerTrack=0,this.popupEnabled=!0,this.popupTemplate=null,this.previousObservations=new ab({renderer:new Yh({symbol:A3.clone()})}),this.trackLines=new ab({renderer:new Yh({symbol:MU.clone()})}),this.timeField="startTimeField"}writeFields(e,s,i){const r=e.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());Hn(i,r,s)}};p([_({type:Boolean,json:{write:!0}})],Fa.prototype,"enabled",void 0),p([_({type:[ig],json:{write:!0}})],Fa.prototype,"fields",void 0),p([Ue("fields")],Fa.prototype,"writeFields",null),p([_({type:ab,json:{write:!0}})],Fa.prototype,"latestObservations",void 0),p([_({type:YE,json:{write:!0}})],Fa.prototype,"maxDisplayDuration",void 0),p([_({type:Number,json:{write:!0}})],Fa.prototype,"maxDisplayObservationsPerTrack",void 0),p([_(mP)],Fa.prototype,"popupEnabled",void 0),p([_({type:v0,json:{name:"popupInfo",write:!0}})],Fa.prototype,"popupTemplate",void 0),p([_({type:ab,json:{write:!0}})],Fa.prototype,"previousObservations",void 0),p([_({type:ab,json:{write:!0}})],Fa.prototype,"trackLines",void 0),p([_({type:["timeReceived","startTimeField","endTimeField"],json:{read:!0,write:!0}})],Fa.prototype,"timeField",void 0),Fa=p([Q("esri.layers.support.TrackInfo")],Fa);const lje=Fa,Fye=t=>{let e=class extends t{constructor(){super(...arguments),this.trackInfo=null}};return p([_({type:lje})],e.prototype,"trackInfo",void 0),e=p([Q("esri.layers.mixins.TrackableLayer")],e),e},Cte=new Jt({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let nf=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};p([_({json:{write:!0}})],nf.prototype,"name",void 0),p([_({json:{write:!0}})],nf.prototype,"description",void 0),p([_({json:{read:Cte.read,write:Cte.write}})],nf.prototype,"drawingTool",void 0),p([_({json:{write:!0}})],nf.prototype,"prototype",void 0),p([_({json:{write:!0}})],nf.prototype,"thumbnail",void 0),nf=p([Q("esri.layers.support.FeatureTemplate")],nf);const U$=nf;function Oye(){return{fields:{type:[oP],value:null,set:function(t){if(t&&ge("big-integer-warning-enabled")){const e=t.filter(s=>s.type==="big-integer"||s.type==="oid"&&(s.length||0)>=8);if(e.length){const s=e.map(i=>`'${i.name}'`).join(", ");Ne.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${s}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",t)}},fieldsIndex:{readOnly:!0,get(){return Zge.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){var e;const t=this._userOutFields;if(!(t!=null&&t.length))return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const s of t)((e=this.fieldsIndex)==null?void 0:e.has(s))||Ne.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${s} found in outFields`,{layer:this,outFields:t});return h$(this.fieldsIndex,t)}}}}const PO=()=>Ne.getLogger("esri.layers.support.labelingInfo"),uje=/\[([^[\]]+)\]/gi;function GA(t,e,s){return t?t.map(i=>{var n;const r=new gx;if(r.read(i,s),r.labelExpression){const o=e.fields||((n=e.layerDefinition)==null?void 0:n.fields)||this.fields;r.labelExpression=r.labelExpression.replaceAll(uje,(a,l)=>`[${cje(l,o)}]`)}return r}):null}function cje(t,e){if(!e)return t;const s=t.toLowerCase();for(let i=0;i<e.length;i++){const r=e[i].name;if(r.toLowerCase()===s)return r}return t}const hje={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryMultiPatch:["always-horizontal"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};function E0t(t,e){const s=[];for(const i of t){const r=i.labelPlacement,n=hje[e];if(!i.symbol)return PO().warn("No ILabelClass symbol specified."),[];if(!n)return PO().error(new ae("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),[];if(n.includes(r))s.push(i);else{const o=n[0];r&&PO().warn(`Found invalid label placement type ${r} for ${e}. Defaulting to ${o}`);const a=i.clone();a.labelPlacement=o,s.push(a)}}return s}function Lye({displayField:t,editFieldsInfo:e,fields:s,objectIdField:i,title:r},n){if(!s)return null;const o=fje({editFieldsInfo:e,fields:s,objectIdField:i},n);if(!o.length)return null;const a=_je({titleBase:r,fields:s,displayField:t}),l=yje();return new v0({title:a,content:l,fieldInfos:o})}function Pte(t){var u;const{title:e,graphic:s}=t??{},{attributes:i,sourceLayer:r}=s??{},n=r&&"displayField"in r?r.displayField:null,o=n?i==null?void 0:i[n]:null,a=o!=null?JSON.stringify(o):null,l=(u=s==null?void 0:s.getObjectId())==null?void 0:u.toString();return e||a||l||""}const mje=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):gFe(t,e);function dje({fields:t,ignoreFieldTypes:e,sortDisabled:s}){const i=t;return e&&(t=t.filter(r=>!e.includes(r.type))),t===i&&(t=t.slice()),s!==!0&&t.sort(pje),t}function pje(t,e){return t.type==="oid"?-1:e.type==="oid"?1:Tte(t)?-1:Tte(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function fje(t,e){const s=e==null?void 0:e.visibleFieldNames;return dje({fields:t.fields??[],ignoreFieldTypes:(e==null?void 0:e.ignoreFieldTypes)||vje,sortDisabled:e==null?void 0:e.sortDisabled}).map(i=>new QC({fieldName:i.name,isEditable:fFe(i,t),label:i.alias,format:gje(i),visible:mje(i,{...t,visibleFieldNames:s})}))}function gje(t){switch(t.type){case"small-integer":case"integer":case"single":return new tA({digitSeparator:!0,places:0});case"double":return new tA({digitSeparator:!0,places:2});case"string":return a6(t.name)?new tA({digitSeparator:!0,places:0}):void 0;default:return}}function yje(){return[new Z_,new Mb]}function _je(t){const e=oFe(t),{titleBase:s}=t;return e?`${s}: {${e.trim()}}`:s??""}function Tte(t){var s;return(t.name&&t.name.toLowerCase())==="name"?!0:((s=t.alias)==null?void 0:s.toLowerCase())==="name"}const vje=["geometry","blob","raster","guid","xml"],Ite=Oye();let ss=class extends Iye(tge(Zfe(Cye(sge(wU(kye(Fye(zU(Dye(Pye(Aye(yU(XC))))))))))))){constructor(e){super(e),this.attributeTableTemplate=null,this.copyright=null,this.dateFieldsTimeZone=null,this.definitionExpression=null,this.displayField=null,this.editingEnabled=!1,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="GeoJSON",this.outFields=null,this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new Dy({layer:this}),this.spatialReference=St.WGS84,this.templates=null,this.title="GeoJSON",this.type="geojson"}destroy(){var e;(e=this.source)==null||e.destroy()}load(e){const s=this.loadFromPortal({supportedTypes:["GeoJson"],supportsData:!1},e).catch(Nc).then(()=>this.source.load(e)).then(()=>{this.read(this.source.sourceJSON,{origin:"service",url:this.parsedUrl}),this.revert(["objectIdField","fields","timeInfo"],"service"),c3(this.renderer,this.fieldsIndex),M7(this.timeInfo,this.fieldsIndex)});return this.addResolvingPromise(s),Promise.resolve(this)}get capabilities(){return this.source?this.source.capabilities:null}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("capabilities"),(this._get("createQueryVersion")||0)+1}get defaultPopupTemplate(){return this.createPopupTemplate()}get isTable(){return this.loaded&&this.geometryType==null}get parsedUrl(){return this.url?Sr(this.url):null}set renderer(e){c3(e,this.fieldsIndex),this._set("renderer",e)}set url(e){if(!e)return void this._set("url",e);const s=Sr(e);this._set("url",s.path),s.query&&(this.customParameters={...this.customParameters,...s.query})}async applyEdits(e,s){const{applyEdits:i}=await me(()=>import("./editingSupport-LSxn7lAP.js"),[]);await this.load();const r=await i(this,this.source,e,s);return this.read({extent:this.source.sourceJSON.extent,timeInfo:this.source.sourceJSON.timeInfo},{origin:"service",ignoreDefaults:!0}),r}on(e,s){return super.on(e,s)}createPopupTemplate(e){return Lye(this,e)}createQuery(){var n;const e=new xn,s=(n=this.capabilities)==null?void 0:n.data;e.returnGeometry=!0,s&&s.supportsZ&&(e.returnZ=!0),e.outFields=["*"],e.where=this.definitionExpression||"1=1";const{timeOffset:i,timeExtent:r}=this;return e.timeExtent=i!=null&&r!=null?r.offset(-i.value,i.unit):r||null,e}getFieldDomain(e,s){var i;return(i=this.getField(e))==null?void 0:i.domain}getField(e){return this.fieldsIndex.get(e)}queryFeatures(e,s){return this.load().then(()=>this.source.queryFeatures(xn.from(e)||this.createQuery(),s)).then(i=>{if(i!=null&&i.features)for(const r of i.features)r.layer=r.sourceLayer=this;return i})}queryObjectIds(e,s){return this.load().then(()=>this.source.queryObjectIds(xn.from(e)||this.createQuery(),s))}queryFeatureCount(e,s){return this.load().then(()=>this.source.queryFeatureCount(xn.from(e)||this.createQuery(),s))}queryExtent(e,s){return this.load().then(()=>this.source.queryExtent(xn.from(e)||this.createQuery(),s))}async hasDataChanged(){try{const{dataChanged:e,updates:s}=await this.source.refresh(this.customParameters);return s!=null&&this.read(s,{origin:"service",url:this.parsedUrl,ignoreDefaults:!0}),e}catch{}return!1}};p([_(fge)],ss.prototype,"attributeTableTemplate",void 0),p([_({readOnly:!0,json:{read:!1,write:!1}})],ss.prototype,"capabilities",null),p([_({type:String})],ss.prototype,"copyright",void 0),p([_({readOnly:!0})],ss.prototype,"createQueryVersion",null),p([_($E("dateFieldsTimeReference"))],ss.prototype,"dateFieldsTimeZone",void 0),p([_({readOnly:!0})],ss.prototype,"defaultPopupTemplate",null),p([_({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],ss.prototype,"definitionExpression",void 0),p([_({type:String})],ss.prototype,"displayField",void 0),p([_({type:Boolean})],ss.prototype,"editingEnabled",void 0),p([_(hge)],ss.prototype,"elevationInfo",void 0),p([_({type:[oP],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],ss.prototype,"fields",void 0),p([_(Ite.fieldsIndex)],ss.prototype,"fieldsIndex",void 0),p([_({type:Hs,json:{name:"extent"}})],ss.prototype,"fullExtent",void 0),p([_({type:["point","polygon","polyline","multipoint"],json:{read:{reader:Qz.read}}})],ss.prototype,"geometryType",void 0),p([_({type:Boolean})],ss.prototype,"hasZ",void 0),p([_(dge)],ss.prototype,"id",void 0),p([_({type:Boolean,readOnly:!0})],ss.prototype,"isTable",null),p([_(dP)],ss.prototype,"labelsVisible",void 0),p([_({type:[gx],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:GA},write:!0}})],ss.prototype,"labelingInfo",void 0),p([_(cge)],ss.prototype,"legendEnabled",void 0),p([_({type:["show","hide"]})],ss.prototype,"listMode",void 0),p([_({type:String,json:{name:"layerDefinition.objectIdField",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"objectIdField"}}}})],ss.prototype,"objectIdField",void 0),p([_(M3)],ss.prototype,"opacity",void 0),p([_({type:["GeoJSON"]})],ss.prototype,"operationalLayerType",void 0),p([_(Ite.outFields)],ss.prototype,"outFields",void 0),p([_({readOnly:!0})],ss.prototype,"parsedUrl",null),p([_(mP)],ss.prototype,"popupEnabled",void 0),p([_({type:v0,json:{name:"popupInfo",write:!0}})],ss.prototype,"popupTemplate",void 0),p([_({types:yx,json:{name:"layerDefinition.drawingInfo.renderer",write:!0,origins:{service:{name:"drawingInfo.renderer"},"web-scene":{types:bye}}}})],ss.prototype,"renderer",null),p([_(lge)],ss.prototype,"screenSizePerspectiveEnabled",void 0),p([_({readOnly:!0})],ss.prototype,"source",void 0),p([_({type:St})],ss.prototype,"spatialReference",void 0),p([_({type:[U$]})],ss.prototype,"templates",void 0),p([_()],ss.prototype,"title",void 0),p([_({json:{read:!1},readOnly:!0})],ss.prototype,"type",void 0),p([_(uge)],ss.prototype,"url",null),ss=p([Q("esri.layers.GeoJSONLayer")],ss);const e8=ss,P0t=Object.freeze(Object.defineProperty({__proto__:null,default:e8},Symbol.toStringTag,{value:"Module"}));let Zm=class extends wU(zU(XC)){constructor(e){super(e),this.elevationInfo=null,this.graphics=new S_,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,s){return super.on(e,s)}graphicChanged(e){this.emit("graphic-update",e)}};p([_({type:ige})],Zm.prototype,"elevationInfo",void 0),p([_(o6(S_,"graphics"))],Zm.prototype,"graphics",void 0),p([_({type:["show","hide"]})],Zm.prototype,"listMode",void 0),p([_()],Zm.prototype,"screenSizePerspectiveEnabled",void 0),p([_({readOnly:!0})],Zm.prototype,"type",void 0),p([_({constructOnly:!0})],Zm.prototype,"internal",void 0),Zm=p([Q("esri.layers.GraphicsLayer")],Zm);const I0t=Zm,bje="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20transform='rotate(90,%2012,%2012)'%3e%3cpath%20d='M20%2012H4M4%2012L10%2018M4%2012L10%206'%20stroke='red'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3ccircle%20cx='20'%20cy='12'%20r='3'%20fill='red'%20/%3e%3c/g%3e%3c/svg%3e",xje="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20transform='rotate(90,%2012,%2012)'%3e%3cpath%20d='M20%2012H4M4%2012L10%2018M4%2012L10%206'%20stroke='blue'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3ccircle%20cx='20'%20cy='12'%20r='3'%20fill='blue'%20/%3e%3c/g%3e%3c/svg%3e";function XE(t,e,s,i){let r=null,n=1e3;typeof e=="number"?(n=e,i=s):(r=e??null,n=s);let o,a=0;const l=()=>{a=0,t.apply(i,o)},u=(...c)=>{r&&r.apply(i,c),o=c,n?a||(a=setTimeout(l,n)):l()};return u.remove=()=>{a&&(clearTimeout(a),a=0)},u.forceUpdate=()=>{a&&(clearTimeout(a),l())},u.hasPendingUpdates=()=>!!a,u}function t8(t){var e;switch(t==null?void 0:t.type){case"point":return t;case"extent":return t.center;case"polygon":return t.centroid;case"multipoint":case"polyline":return(e=t.extent)==null?void 0:e.center;default:return null}}var F3;(function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"})(F3||(F3={}));function wje(t,e){return{type:z_(e),value:t,unit:e}}function M0t(t){return{value:t}}function Sje(t,e){return{type:z_(e),value:t,unit:e}}function Eje(t,e){return{type:z_(e),value:t,unit:e}}function B$(t,e,s="arithmetic"){return{type:z_(e),value:t,unit:e,rotationType:s}}function A0t(t,e){const s=Cje(t,e);return t.type==="angle"?B$(s,e,t.rotationType):wje(s,e)}function Cje(t,e){return os(t.value,t.unit,e)}function N0t(t,e){return t==null?e:e==null||t.value>os(e.value,e.unit,t.unit)?t:e}function D0t(t,e){return t==null?null:{...t,value:t.value*e}}function Pje(t,e,s){if(e===s)return t;switch(s){case"arithmetic":case"geographic":return 90-t}}const $0t=Sje(0,"meters"),R0t=Eje(0,"square-meters");B$(0,"radians");const k0t=B$(0,"degrees"),F0t=B$(0,"degrees","geographic");function Vye(t,e,s){return t.units[e][s]}function _x(t,e,s,i=2,r="abbr"){return`${Un(e,{minimumFractionDigits:i,maximumFractionDigits:i,signDisplay:e>0?"never":"exceptZero"})} ${Vye(t,s,r)}`}function j$(t,e,s,i=2,r="abbr"){return`${Un(e,{minimumFractionDigits:i,maximumFractionDigits:i,signDisplay:"exceptZero"})} ${Vye(t,s,r)}`}function O0t(t,e,s,i=2,r="abbr"){const n=wle(e,s);return _x(t,os(e,s,n),n,i,r)}function L0t(t,e,s,i=2,r="abbr"){const n=wle(e,s);return j$(t,os(e,s,n),n,i,r)}function V0t(t,e,s,i=2,r="abbr"){const n=Sle(e,s);return _x(t,os(e,s,n),n,i,r)}function q0t(t,e,s,i=2,r="abbr"){const n=Sle(e,s);return j$(t,os(e,s,n),n,i,r)}function G0t(t,e,s,i=2,r="abbr"){const n=Ele(e,s);return _x(t,os(e,s,n),n,i,r)}function z0t(t,e,s,i=2,r="abbr"){const n=Ele(e,s);return j$(t,os(e,s,n),n,i,r)}function U0t(t,e,s,i=2,r="abbr"){const n=Cle(e,s);return _x(t,os(e,s,n),n,i,r)}function B0t(t,e,s,i=2,r="abbr"){const n=Cle(e,s);return j$(t,os(e,s,n),n,i,r)}function j0t(t,e,s,i=2,r="abbr"){const n=VTe(e,s);return _x(t,os(e,s,n),n,i,r)}function H0t(t,e,s,i=2,r="abbr"){const n=qTe(e,s);return _x(t,os(e,s,n),n,i,r)}const Tje=(t,e)=>({style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:e,minimumFractionDigits:e,signDisplay:t>0?"never":"exceptZero"});function Y0t(t,e,s,i,r,n=Aae,o=!0){let a=n.normalize(Pje(os(t,e,"degrees"),s,i),0,o);const l=Tje(a,r??2);return a=Ije(a,l),Un(a,l)}const Mte=new Map;function Ije(t,e){const s=JSON.stringify(e);let i=Mte.get(s);return i||(i=new Intl.NumberFormat("en-US",e),Mte.set(s,i)),/^[-+]?360\.?0*°?$/.test(i.format(t))?0:t}const Ate=["B","kB","MB","GB","TB"];function Mje(t,e){let s=(e=Math.round(e))===0?0:Math.floor(Math.log(e)/Math.log(F3.KILOBYTES));s=Ka(s,0,Ate.length-1);const i=Un(e/F3.KILOBYTES**s,{maximumFractionDigits:2});return jc(t.units.bytes[Ate[s]],{fileSize:i})}function Aje(t){const{exifInfo:e,exifName:s,tagName:i}=t;if(!e)return null;const r=e.find(n=>n.name===s);return r?Nje({tagName:i,tags:r.tags}):null}function Nje(t){const{tagName:e,tags:s}=t;if(!s)return null;const i=s.find(r=>r.name===e);return(i==null?void 0:i.value)||null}var s8;const Dje={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let Oa=s8=class extends Te{constructor(t){super(t),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:t}=this,e=Aje({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:t});return Dje[e]||null}clone(){return new s8({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};p([_({type:String})],Oa.prototype,"contentType",void 0),p([_()],Oa.prototype,"exifInfo",void 0),p([_({readOnly:!0})],Oa.prototype,"orientationInfo",null),p([_({type:fs})],Oa.prototype,"id",void 0),p([_({type:String})],Oa.prototype,"globalId",void 0),p([_({type:String})],Oa.prototype,"keywords",void 0),p([_({type:String})],Oa.prototype,"name",void 0),p([_({json:{read:!1}})],Oa.prototype,"parentGlobalId",void 0),p([_({json:{read:!1}})],Oa.prototype,"parentObjectId",void 0),p([_({type:fs})],Oa.prototype,"size",void 0),p([_({json:{read:!1}})],Oa.prototype,"url",void 0),Oa=s8=p([Q("esri.rest.query.support.AttachmentInfo")],Oa);const $je=Oa,X0t=",",Rje={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},kje=new Set(["integer","small-integer"]);let TO=null;function qye(t){return D7(t)||IFe(t)||MFe(t)}async function W0t(t){const{field:e,field2:s,field3:i,normalizationField:r,valueExpression:n}=t;let o=[];if(n){if(!TO){const{arcadeUtils:a}=await Zc();TO=a}o=TO.extractFieldNames(n)}return e&&o.push(e),s&&o.push(s),i&&o.push(i),r&&o.push(r),o}function s2(t){return String(t).padStart(2,"0")}function Nte(t,e,s){let i;return e==="date"||e==="number"?(e==="number"&&(t=new Date(t)),i=`TIMESTAMP'${s?t.getFullYear():t.getUTCFullYear()}-${s2((s?t.getMonth():t.getUTCMonth())+1)}-${s2(s?t.getDate():t.getUTCDate())} ${s2(s?t.getHours():t.getUTCHours())}:${s2(s?t.getMinutes():t.getUTCMinutes())}:${s2(s?t.getSeconds():t.getUTCSeconds())}'`):i=t,i}function Z0t(t,e,s,i){const{hasQueryEngine:r}=t,n=`(${Nte(s,Dte(t,s),r)} - ${Nte(e,Dte(t,e),r)})`;let o=Rje[i],a="/";return o<1&&(o=1/o,a="*"),{sqlExpression:o===1?n:`(${n} ${a} ${o})`,sqlWhere:null}}function Dte(t,e){if(e instanceof Date)return"date";if(typeof e=="number")return"number";if(typeof e=="string"){const s=t.getField(e);if(e.toLowerCase()==="<now>")return;if(D7(s))return"field"}}function Q0t(t,e){const s=e&&t.getField(e);return!!s&&kje.has(s.type)}function J0t(t){return`cast(${t} as float)`}function UU(t,e){const{format:s,timeZoneOptions:i,fieldType:r}=e??{};let n,o;if(i&&({timeZone:n,timeZoneName:o}=dce(i.layerTimeZone,i.datesInUnknownTimezone,i.viewTimeZone,L1(s||"short-date-short-time"),r)),typeof t=="string"&&isNaN(Date.parse(r==="time-only"?`1970-01-01T${t}Z`:t)))return t;switch(r){case"date-only":{const a=L1(s||"short-date");return typeof t=="string"?RNe(t,{...a}):ql(t,{...a,timeZone:Zh})}case"time-only":{const a=L1(s||"short-time");return typeof t=="string"?kNe(t,a):ql(t,{...a,timeZone:Zh})}case"timestamp-offset":{if(!n&&typeof t=="string"&&new Date(t).toISOString()!==t)return t;const a=s||i?L1(s||"short-date-short-time"):void 0,l=a?{...a,timeZone:n,timeZoneName:o}:void 0;return typeof t=="string"?FNe(t,l):ql(t,l)}default:{const a=s||i?L1(s||"short-date-short-time"):void 0;return ql(typeof t=="string"?new Date(t):t,a?{...a,timeZone:n,timeZoneName:o}:void 0)}}}const Fje="esri.widgets.Feature.support.featureUtils",i8=()=>Ne.getLogger(Fje),Oje=/href=(""|'')/gi,Lje=/(\{([^{\r\n]+)\})/g,Vje=/'/g,Gye=/^\s*expression\//i,qje=/(\n)/gi,Gje=/[\u00A0-\u9999<>&]/gim,zje=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,Uje=/^(?:mailto:|tel:)/,zye="relationships/",$te=L1("short-date-short-time");function BU(t){if(t!=null)return(t.sourceLayer||t.layer)??void 0}async function WE({type:t,value:e,event:s}){try{return typeof e=="function"?e(s):await e}catch(i){return void i8().error("error",`An error occurred when calling the "${t}" function`,{error:i,graphic:s.graphic,value:e})}}function jU(t=""){if(t)return!Uje.test(t.trim().toLowerCase())}function H$(t){return!!t&&Gye.test(t)}function Bje(t,e){if(!e||!H$(e)||!t)return;const s=e.replace(Gye,"").toLowerCase();return t.find(({name:i})=>i.toLowerCase()===s)}function HU(t,e){const s=Bje(e,t==null?void 0:t.fieldName);return s?s.title||null:t?t.label||t.fieldName:null}function jje(t,e){const s=e.get(t.toLowerCase());return`{${(s==null?void 0:s.fieldName)||t}}`}function Hje(t){return t.replaceAll(Oje,"")}function kb(t,e){const s=YU(e,t);return s?s.name:t}function Uye(t,e){return t&&t.map(s=>kb(s,e))}function YU(t,e){return t&&typeof t.getField=="function"&&e?t.getField(e)??null:null}function Bye(t){return`${t}`.trim()}function Rf({attributes:t,globalAttributes:e,layer:s,text:i,expressionAttributes:r,fieldInfoMap:n}){return i?O3({formattedAttributes:e,template:Zje(i,{...e,...r,...t},s),fieldInfoMap:n}):""}function O3({formattedAttributes:t,template:e,fieldInfoMap:s}){return Bye(Hje(jc(jc(e,i=>jje(i,s)),t)))}function Yje(t,e,s=!1){const i=e[t];if(typeof i=="string"){const r="%27",n=(s?encodeURIComponent(i):i).replaceAll(Vje,r);e[t]=n}}function Xje(t,e=!1){const s={...t};return Object.keys(s).forEach(i=>Yje(i,s,e)),s}function Wje(t,e,s){const i=(e=Bye(e))&&e[0]!=="{";return jc(t,Xje(s,i||!1))}function L3(t,e){return t.replaceAll(Lje,(s,i,r)=>{const n=YU(e,r);return n?`{${n.name}}`:i})}function Zje(t,e,s){const i=L3(t,s);return i&&i.replaceAll(zje,(r,n,o)=>Wje(r,n||o,e))}function Qje(t,e){if(typeof t=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const s=Number(t);if(!isNaN(s))return s}return t}function jye(t){return t!=null&&typeof t=="object"&&"fieldsIndex"in t&&"geometryType"in t&&"getField"in t&&"load"in t&&"loaded"in t&&"objectIdField"in t&&"spatialReference"in t&&"type"in t&&(t.type==="feature"||t.type==="scene"||t.type==="subtype-group"||t.type==="subtype-sublayer"||t.type==="sublayer")&&"when"in t}function Hye(t){return t!=null&&typeof t=="object"&&"createQuery"in t&&"queryFeatureCount"in t&&"queryObjectIds"in t&&"queryRelatedFeatures"in t&&"queryRelatedFeaturesCount"in t&&"relationships"in t}function pP(t){return jye(t)&&Hye(t)}function Yye(t){return!(!(t&&typeof t=="object"&&"createQuery"in t&&"getField"in t&&"queryFeatureCount"in t&&"queryFeatures"in t&&"queryObjectIds"in t&&"capabilities"in t&&"fields"in t&&"fieldsIndex"in t&&"type"in t)||t.type!=="feature"&&t.type!=="subtype-group"&&t.type!=="subtype-sublayer"&&t.type!=="sublayer"||!("when"in t))&&(t.type==="subtype-sublayer"&&"parent"in t&&t.parent&&typeof t.parent=="object"?"globalIdField"in t.parent:"globalIdField"in t)}function Jje(t){return!!t&&typeof t=="object"&&"sourceLayer"in t&&pP(t.sourceLayer)}function Xye(t,e){var c;const{fieldInfos:s,fieldName:i,preventPlacesFormatting:r,layer:n,timeZone:o}=e,a=XU(s,i),l=YU(n,i);if(a&&!a6(i)){const h=l==null?void 0:l.type,m=(c=a.format)==null?void 0:c.dateFormat;if(h==="date"||h==="date-only"||h==="time-only"||h==="timestamp-offset"||m)return UU(t,{format:m,fieldType:h,timeZoneOptions:{layerTimeZone:n&&"preferredTimeZone"in n?n.preferredTimeZone:null,viewTimeZone:o,datesInUnknownTimezone:!(!n||!("datesInUnknownTimezone"in n))&&!!n.datesInUnknownTimezone}})}const u=a==null?void 0:a.format;return typeof t=="string"&&a6(i)&&u?Kje(t,u):typeof(t=Qje(t,u))=="string"||t==null||u==null?vx(t):Un(t,r?{...KN(u),minimumFractionDigits:0,maximumFractionDigits:20}:KN(u))}function Kje(t,e){return t=t.trim(),/\d{2}-\d{2}/.test(t)?t:t.includes(",")?IO(t,",",", ",e):t.includes(";")?IO(t,";","; ",e):t.includes(" ")?IO(t," "," ",e):Un(Number(t),KN(e))}function IO(t,e,s,i){return t.trim().split(e).map(r=>Un(Number(r),KN(i))).join(s)}function XU(t,e){if(t!=null&&t.length&&e)return t.find(s=>{var i;return((i=s.fieldName)==null?void 0:i.toLowerCase())===e.toLowerCase()})}function eHe({fieldName:t,graphic:e,layer:s}){if(Uh(t)||!s||typeof s.getFeatureType!="function")return null;const{typeIdField:i}=s;if(!i||t!==i)return null;const r=s.getFeatureType(e);return r?r.name:null}function tHe({fieldName:t,value:e,graphic:s,layer:i}){if(Uh(t)||!i||typeof i.getFieldDomain!="function")return null;const r=s&&i.getFieldDomain(t,{feature:s,excludeImpliedDomains:ge("esri-widget-legacy-field-domain-calculation")});return r&&r.type==="coded-value"?r.getName(e):null}function Wye(t,e,s,i){const{creatorField:r,creationDateField:n,editorField:o,editDateField:a}=t;if(!e)return;const l=dce(i&&"preferredTimeZone"in i?i.preferredTimeZone:null,!(!i||!("datesInUnknownTimezone"in i))&&!!i.datesInUnknownTimezone,s,$te,"date"),u={...$te,...l},c=e[a];if(typeof c=="number"){const m=e[o];return{type:"edit",date:ql(c,u),user:m}}const h=e[n];if(typeof h=="number"){const m=e[r];return{type:"create",date:ql(h,u),user:m}}return null}function Zye(t,e){const s=new Map;if(!t)return s;for(const i of t){if(!i.fieldName)continue;const r=kb(i.fieldName,e);i.fieldName=r,s.set(r.toLowerCase(),i)}return s}function r8(t){const e=[];if(!t)return e;const{fieldInfos:s,content:i}=t;return s&&e.push(...s),i&&Array.isArray(i)&&i.forEach(r=>{if(r.type==="fields"){const n=r==null?void 0:r.fieldInfos;n&&e.push(...n)}}),e}function Y$(t){return t.replaceAll(Gje,e=>`&#${e.charCodeAt(0)};`)}function vx(t){return typeof t=="string"?t.replaceAll(qje,'<br class="esri-text-new-line" />'):t}function Qye(t){var h;const{value:e,fieldName:s,fieldInfos:i,fieldInfoMap:r,layer:n,graphic:o,timeZone:a}=t;if(e==null)return"";const l=tHe({fieldName:s,value:e,graphic:o,layer:n});if(l)return l;const u=eHe({fieldName:s,graphic:o,layer:n});if(u)return u;if(r.get(s.toLowerCase()))return Xye(e,{fieldInfos:i||Array.from(r.values()),fieldName:s,layer:n,timeZone:a});const c=(h=n==null?void 0:n.fieldsIndex)==null?void 0:h.get(s);return c&&(qye(c)||$7(c))?UU(e,{fieldType:c.type,timeZoneOptions:{layerTimeZone:n&&"preferredTimeZone"in n?n.preferredTimeZone:null,viewTimeZone:a,datesInUnknownTimezone:!(!n||!("datesInUnknownTimezone"in n))&&!!n.datesInUnknownTimezone}}):vx(e)}function zA({fieldInfos:t,attributes:e,layer:s,graphic:i,fieldInfoMap:r,relatedInfos:n,timeZone:o}){const a={};return n==null||n.forEach(l=>rHe({attributes:a,relatedInfo:l,fieldInfoMap:r,fieldInfos:t,layer:s,timeZone:o})),e&&Object.keys(e).forEach(l=>{const u=e[l];a[l]=Qye({fieldName:l,fieldInfos:t,fieldInfoMap:r,layer:s,value:u,graphic:i,timeZone:o})}),a}async function WU(t,e){var c,h;const{layer:s,graphic:i,outFields:r,objectIds:n,returnGeometry:o,spatialReference:a}=t,l=n[0];if(typeof l!="number"&&typeof l!="string"){const m="Could not query required fields for the specified feature. The feature's ID is invalid.",f={layer:s,graphic:i,objectId:l,requiredFields:r};return i8().warn(m,f),null}if(!((h=(c=whe(s))==null?void 0:c.operations)!=null&&h.supportsQuery)){const m="The specified layer cannot be queried. The following fields will not be available.",f={layer:s,graphic:i,requiredFields:r,returnGeometry:o};return i8().warn(m,f),null}const u=s.createQuery();return u.objectIds=n,u.outFields=r!=null&&r.length?r:[s.objectIdField],u.returnGeometry=!!o,u.returnZ=!!o,u.returnM=!!o,u.outSpatialReference=a,(await s.queryFeatures(u,e)).features[0]}async function sHe(t){var i;if(!((i=t.expressionInfos)!=null&&i.length))return!1;const e=await Zc(),{arcadeUtils:{hasGeometryFunctions:s}}=e;return s(t)}async function Jye({graphic:t,popupTemplate:e,layer:s,spatialReference:i},r){if(!s||!e||(typeof s.load=="function"&&await s.load(r),!t.attributes))return;const n=s.objectIdField,o=t.attributes[n];if(o==null)return;const a=[o],l=await e.getRequiredFields(s.fieldsIndex),u=dme(l,t),c=u?[]:l.includes(n)?l:[...l,n],h=e.returnGeometry||await sHe(e);if(u&&!h)return;const m=await WU({layer:s,graphic:t,outFields:c,objectIds:a,returnGeometry:h,spatialReference:i},r);m&&(m.geometry&&(t.geometry=m.geometry),m.attributes&&(t.attributes={...t.attributes,...m.attributes}))}function Uh(t=""){return!!t&&t.includes(zye)}function iHe(t){return`${zye}${t.layerId}/${t.fieldName}`}function Rte({attributes:t,graphic:e,relatedInfo:s,fieldInfos:i,fieldInfoMap:r,layer:n,timeZone:o}){t&&e&&s&&Object.keys(e.attributes).forEach(a=>{const l=iHe({layerId:s.relation.id.toString(),fieldName:a}),u=e.attributes[a];t[l]=Qye({fieldName:l,fieldInfos:i,fieldInfoMap:r,layer:n,value:u,graphic:e,timeZone:o})})}function rHe({attributes:t,relatedInfo:e,fieldInfoMap:s,fieldInfos:i,layer:r,timeZone:n}){var o,a;t&&e&&((o=e.relatedFeatures)==null||o.forEach(l=>Rte({attributes:t,graphic:l,relatedInfo:e,fieldInfoMap:s,fieldInfos:i,layer:r,timeZone:n})),(a=e.relatedStatsFeatures)==null||a.forEach(l=>Rte({attributes:t,graphic:l,relatedInfo:e,fieldInfoMap:s,fieldInfos:i,layer:r,timeZone:n})))}const kte=t=>{if(!t)return!1;const e=t.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},Kye=({layer:t,method:e,query:s,definitionExpression:i})=>{var o,a;if(!((a=(o=t.capabilities)==null?void 0:o.query)!=null&&a.supportsCacheHint)||e==="attachments")return;const r=s.where!=null?s.where:null,n=s.geometry!=null?s.geometry:null;kte(i)||kte(r)||(n==null?void 0:n.type)==="extent"||s.resultType==="tile"||(s.cacheHint=!0)},e_e=({query:t,layer:e,method:s})=>{Kye({layer:e,method:s,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression??""}`})},t_e=({queryPayload:t,layer:e,method:s})=>{Kye({layer:e,method:s,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression??""}`})};function s_e(t,e,s){var i,r;return t&&e&&s?e.type==="sublayer"?$v({layers:(i=e.layer)==null?void 0:i.sublayers,map:t,relatedLayer:e,relationship:s})||$v({layers:(r=e.layer)==null?void 0:r.subtables,map:t,relatedLayer:e,relationship:s}):$v({layers:t.allLayers,map:t,relatedLayer:e,relationship:s})||$v({layers:t.allTables,map:t,relatedLayer:e,relationship:s}):null}function i_e(t,e){var s;return t&&"utilityNetworks"in t&&e?(s=t.utilityNetworks)==null?void 0:s.find(i=>i.isUtilityLayer(e)):null}function Fte(t,e){return t==null?void 0:t.allTables.find(s=>{var i;return s.type==="feature"&&s.layerId===e.id&&s.url===((i=e.layer)==null?void 0:i.url)})}function $v({map:t,relationship:e,relationship:{relatedTableId:s},relatedLayer:i,layers:r}){var n;if(!r)return null;for(const o of r){if(o.type==="map-image"){const l=$v({layers:o.sublayers,map:t,relatedLayer:i,relationship:e})||$v({layers:o.subtables,map:t,relatedLayer:i,relationship:e});if(l)return l;continue}if(!pP(o))continue;if(i.type==="sublayer"){if(o!==i&&o.id===s)return o.isTable?Fte(t,o):o;continue}const a=i.type==="scene"&&i.associatedLayer?i.associatedLayer.url:i.url;if(!a)return null;if(o.type!=="sublayer"){if(o!==i&&o.url===a&&o.layerId===s)return o}else if(o!==i&&((n=o.layer)==null?void 0:n.url)===a&&o.id===s)return o.isTable?Fte(t,o):o}return null}function nHe(t){const e=t.getObjectId();return e!=null?`oid:${e}`:`uid:${t.uid}`}const oHe=Object.freeze(Object.defineProperty({__proto__:null,applyTextFormattingHTML:vx,createFieldInfoMap:Zye,findRelatedLayer:s_e,findUtilityNetwork:i_e,fixTokens:L3,formatAttributes:zA,formatEditInfo:Wye,formatValueToFieldInfo:Xye,getAllFieldInfos:r8,getFieldInfo:XU,getFieldInfoLabel:HU,getFixedFieldName:kb,getFixedFieldNames:Uye,getHighlightKeyForFeature:nHe,getSourceLayer:BU,graphicCallback:WE,htmlEntities:Y$,isAssociatedFeatureSupportedLayer:Yye,isExpressionField:H$,isFeatureSupportedLayer:jye,isGraphicForRelatableFeatureSupportedLayer:Jje,isRelatableFeatureSupportedLayer:pP,isRelatableLayer:Hye,isRelatedField:Uh,preLayerQueryCallback:e_e,preRequestCallback:t_e,querySourceLayer:WU,queryUpdatedFeature:Jye,shouldOpenInNewTab:jU,substituteAttributes:O3,substituteFieldsInLinksAndAttributes:Rf},Symbol.toStringTag,{value:"Module"})),Ote={editing:!1,operations:{add:!0,update:!0,delete:!0}},r_e=Ge.ofType($je);let ia=class extends Ye{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.capabilities={...Ote},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new r_e,this.fileInfos=new Ge,this.graphic=null,this.mode="view",this.orderByFields=null,this.filesEnabled=!1,this.addHandles(Ee(()=>this.graphic,()=>this._graphicChanged(),ht))}destroy(){this._attachmentLayer=null,this.graphic=null}castCapabilities(e){return{...Ote,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const s=e.layer||e.sourceLayer;return(s==null?void 0:s.loaded)&&"capabilities"in s&&s.capabilities&&"attachment"in s.capabilities&&s.capabilities.attachment&&"supportsResize"in s.capabilities.attachment&&s.capabilities.attachment.supportsResize||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:s,orderByFields:i}=this;if(!e||typeof e.queryAttachments!="function")throw new ae("invalid-layer","getAttachments(): A valid layer is required.");const r=this._getObjectId();if(typeof r!="number")throw new ae("invalid-object-id","getAttachments(): Numeric object id is required");const n=i==null?void 0:i.map(c=>`${c.field} ${c.order==="descending"?"DESC":"ASC"}`),o=new Nq({objectIds:[r],returnMetadata:!0,orderByFields:n}),a=[],l=e.queryAttachments(o).then(c=>c[r]||a).catch(()=>a);this._getAttachmentsPromise=l,this.notifyChange("state");const u=await l;return s.destroyAll(),u.length&&s.addMany(u),this._getAttachmentsPromise=null,this.notifyChange("state"),u}async addAttachment(e,s=this.graphic){var l;const{_attachmentLayer:i,attachmentInfos:r,capabilities:n}=this;if(!s)throw new ae("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:s});if(!e)throw new ae("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!((l=n.operations)!=null&&l.add))throw new ae("invalid-capabilities","addAttachment(): add capabilities are required.");if(!i||typeof i.addAttachment!="function")throw new ae("invalid-layer","addAttachment(): A valid layer is required.");const o=i.addAttachment(s,e).then(u=>this._queryAttachment(u.objectId,s)),a=await o;return r.add(a),a}async deleteAttachment(e){var l;const{_attachmentLayer:s,attachmentInfos:i,graphic:r,capabilities:n}=this;if(!e)throw new ae("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!((l=n.operations)!=null&&l.delete))throw new ae("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!s||typeof s.deleteAttachments!="function")throw new ae("invalid-layer","deleteAttachment(): A valid layer is required.");if(!r)throw new ae("invalid-graphic","deleteAttachment(): A graphic is required.");const o=s.deleteAttachments(r,[e.id]).then(()=>e),a=await o;return i.remove(a),a.destroy(),a}async updateAttachment(e,s=this.activeAttachmentInfo){var c;const{_attachmentLayer:i,attachmentInfos:r,graphic:n,capabilities:o}=this;if(!e)throw new ae("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!s)throw new ae("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:s});if(!((c=o.operations)!=null&&c.update))throw new ae("invalid-capabilities","updateAttachment(): Update capabilities are required.");const a=r.indexOf(s);if(!i||typeof i.updateAttachment!="function")throw new ae("invalid-layer","updateAttachment(): A valid layer is required.");if(!n)throw new ae("invalid-graphic","updateAttachment(): A graphic is required.");const l=i.updateAttachment(n,s.id,e).then(h=>this._queryAttachment(h.objectId)),u=await l;return r.splice(a,1,u),u}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,s){if(!e||!s)return null;const i={file:e,form:s};return this.fileInfos.add(i),i}updateFile(e,s,i=this.activeFileInfo){if(!e||!s||!i)return null;const r=this.fileInfos.indexOf(i);return r>-1&&this.fileInfos.splice(r,1,{file:e,form:s}),this.fileInfos.items[r]}deleteFile(e){const s=this.fileInfos.find(i=>i.file===e);return s?(this.fileInfos.remove(s),s):null}async _queryAttachment(e,s){const{_attachmentLayer:i}=this;if(!e||!(i!=null&&i.queryAttachments))throw new ae("invalid-attachment-id","Could not query attachment.");const r=this._getObjectId(s);if(typeof r!="number")throw new ae("invalid-object-id","getAttachments(): Numeric object id is required");const n=new Nq({objectIds:[r],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return i.queryAttachments(n).then(o=>o[r][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>this.attachmentInfos.destroyAll()))}_setAttachmentLayer(){const{graphic:e}=this,s=BU(e);this._attachmentLayer=s?s.type==="scene"&&s.associatedLayer!=null?s.associatedLayer:s:null}};p([_()],ia.prototype,"capabilities",void 0),p([Ht("capabilities")],ia.prototype,"castCapabilities",null),p([_()],ia.prototype,"activeAttachmentInfo",void 0),p([_()],ia.prototype,"activeFileInfo",void 0),p([_({readOnly:!0,type:r_e})],ia.prototype,"attachmentInfos",void 0),p([_()],ia.prototype,"fileInfos",void 0),p([_({type:tn})],ia.prototype,"graphic",void 0),p([_()],ia.prototype,"mode",void 0),p([_({type:[pme]})],ia.prototype,"orderByFields",void 0),p([_({readOnly:!0})],ia.prototype,"state",null),p([_()],ia.prototype,"filesEnabled",void 0),p([_({readOnly:!0})],ia.prototype,"supportsResizeAttachments",null),ia=p([Q("esri.widgets.Attachments.AttachmentsViewModel")],ia);const ZU=ia;function Lte(t){const e=t.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function aHe(t){const e=Ii("esri/themes/base/images/files/");return t?t==="text/plain"?`${e}text-32.svg`:t==="application/pdf"?`${e}pdf-32.svg`:t==="text/csv"?`${e}csv-32.svg`:t==="application/gpx+xml"?`${e}gpx-32.svg`:t==="application/x-dwf"?`${e}cad-32.svg`:t==="application/postscript"||t==="application/json"||t==="text/xml"||t==="model/vrml"?`${e}code-32.svg`:t==="application/x-zip-compressed"||t==="application/x-7z-compressed"||t==="application/x-gzip"||t==="application/x-tar"||t==="application/x-gtar"||t==="application/x-bzip2"||t==="application/gzip"||t==="application/x-compress"||t==="application/x-apple-diskimage"||t==="application/x-rar-compressed"||t==="application/zip"?`${e}zip-32.svg`:t.includes("image/")?`${e}image-32.svg`:t.includes("audio/")?`${e}sound-32.svg`:t.includes("video/")?`${e}video-32.svg`:t.includes("msexcel")||t.includes("ms-excel")||t.includes("spreadsheetml")?`${e}excel-32.svg`:t.includes("msword")||t.includes("ms-word")||t.includes("wordprocessingml")?`${e}word-32.svg`:t.includes("powerpoint")||t.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const fd={left:"esri-icon-left",plus:"esri-icon-plus",right:"esri-icon-right",table:"esri-icon-table",trash:"esri-icon-trash",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass"},Vte={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},Ts="esri-attachments",$t={base:Ts,loaderContainer:`${Ts}__loader-container`,loader:`${Ts}__loader`,container:`${Ts}__container`,containerList:`${Ts}__container--list`,containerPreview:`${Ts}__container--preview`,actions:`${Ts}__actions`,deleteButton:`${Ts}__delete-button`,addAttachmentButton:`${Ts}__add-attachment-button`,errorMessage:`${Ts}__error-message`,items:`${Ts}__items`,item:`${Ts}__item`,itemButton:`${Ts}__item-button`,itemMask:`${Ts}__item-mask`,itemMaskIcon:`${Ts}__item-mask--icon`,itemImage:`${Ts}__image`,itemImageResizable:`${Ts}__image--resizable`,itemLabel:`${Ts}__label`,itemFilename:`${Ts}__filename`,itemChevronIcon:`${Ts}__item-chevron-icon`,itemLink:`${Ts}__item-link`,itemLinkOverlay:`${Ts}__item-link-overlay`,itemLinkOverlayIcon:`${Ts}__item-link-overlay-icon`,itemAddIcon:`${Ts}__item-add-icon`,formNode:`${Ts}__form-node`,fileFieldset:`${Ts}__file-fieldset`,fileLabel:`${Ts}__file-label`,fileName:`${Ts}__file-name`,fileInput:`${Ts}__file-input`,metadata:`${Ts}__metadata`,metadataFieldset:`${Ts}__metadata-fieldset`,progressBar:`${Ts}__progress-bar`},MO=window.CSS;let no=class extends Er{constructor(e,s){super(e,s),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=null,this.visibleElements={...Vte},this._supportsImageOrientation=MO&&MO.supports&&MO.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}normalizeCtorArgs(e){return e!=null&&e.viewModel||(e={viewModel:new ZU,...e}),e}initialize(){this.addHandles([Vo(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),Vo(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),Ee(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),ht)])}loadDependencies(){return sl({icon:()=>me(()=>import("./index-BhFhNIYS.js").then(e=>e.i),__vite__mapDeps([243,244,241,245]))})}get capabilities(){return this.viewModel.capabilities}set capabilities(e){this.viewModel.capabilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get icon(){return"attachment"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...Vte,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:s}=this;return this._set("submitting",!0),this._set("error",null),s.addAttachment(e).then(i=>(this._set("submitting",!1),this._set("error",null),s.mode="view",i)).catch(i=>{throw this._set("submitting",!1),this._set("error",new ae("attachments:add-attachment",this.messages.addErrorMessage,i)),i})}deleteAttachment(e){const{viewModel:s}=this;return this._set("submitting",!0),this._set("error",null),s.deleteAttachment(e).then(i=>(this._set("submitting",!1),this._set("error",null),s.mode="view",i)).catch(i=>{throw this._set("submitting",!1),this._set("error",new ae("attachments:delete-attachment",this.messages.deleteErrorMessage,i)),i})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:s}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(s).then(i=>(this._set("submitting",!1),this._set("error",null),e.mode="view",i)).catch(i=>{throw this._set("submitting",!1),this._set("error",new ae("attachments:update-attachment",this.messages.updateErrorMessage,i)),i})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,s=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",s}deleteFile(e){var i;const s=this.viewModel.deleteFile(e||((i=this.viewModel.activeFileInfo)==null?void 0:i.file));return this.viewModel.mode="view",s}render(){const{submitting:e,viewModel:s}=this,{state:i}=s;return K("div",{class:this.classes($t.base,vt.widget)},e?this._renderProgressBar():null,i==="loading"?this._renderLoading():this._renderAttachments(),this._renderErrorMessage())}_renderErrorMessage(){const{error:e,visibleElements:s}=this;return e&&s.errorMessage?K("div",{class:$t.errorMessage,key:"error-message"},e.message):null}_renderAttachments(){const{activeFileInfo:e,mode:s,activeAttachmentInfo:i}=this.viewModel;return s==="add"?this._renderAddForm():s==="edit"?this._renderDetailsForm(i||e):this._renderAttachmentContainer()}_renderLoading(){return K("div",{class:$t.loaderContainer,key:"loader"},K("div",{class:$t.loader}))}_renderProgressBar(){return this.visibleElements.progressBar?K("div",{class:$t.progressBar,key:"progress-bar"}):null}_renderAddForm(){const{submitting:e,selectedFile:s}=this,i=e||!s,r=this.visibleElements.cancelAddButton?K("button",{bind:this,class:this.classes(vt.button,vt.buttonTertiary,vt.buttonSmall,vt.buttonHalf,e&&vt.buttonDisabled),disabled:e,onclick:this._cancelForm,type:"button"},this.messages.cancel):null,n=this.visibleElements.addSubmitButton?K("button",{class:this.classes(vt.button,vt.buttonSecondary,vt.buttonSmall,vt.buttonHalf,{[vt.buttonDisabled]:i}),disabled:i,type:"submit"},this.messages.add):null,o=s?K("span",{class:$t.fileName,key:"file-name"},s.name):null,a=K("form",{afterCreate:HZ,afterRemoved:jZ,bind:this,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},K("fieldset",{class:$t.fileFieldset},o,K("label",{class:this.classes($t.fileLabel,vt.button,vt.buttonSecondary)},s?this.messages.changeFile:this.messages.selectFile,K("input",{bind:this,class:$t.fileInput,name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),n,r);return K("div",{class:$t.formNode,key:"add-form-container"},a)}_renderDetailsForm(e){var P,I,A;const{visibleElements:s,viewModel:i,selectedFile:r,submitting:n}=this,{capabilities:o}=i,a=n||!r;let l,u,c,h;r?(l=r.type,u=r.name,c=r.size):e&&"file"in e?(l=e.file.type,u=e.file.name,c=e.file.size):e&&"contentType"in e&&(l=e.contentType,u=e.name,c=e.size,h=e.url);const m=o.editing&&((P=o.operations)!=null&&P.delete)&&s.deleteButton?K("button",{bind:this,class:this.classes(vt.button,vt.buttonSmall,vt.buttonTertiary,$t.deleteButton,{[vt.buttonDisabled]:n}),disabled:n,key:"delete-button",onclick:D=>this._submitDeleteAttachment(D,e),type:"button"},this.messages.delete):void 0,f=o.editing&&((I=o.operations)!=null&&I.update)&&s.updateButton?K("button",{class:this.classes(vt.button,vt.buttonSmall,vt.buttonThird,{[vt.buttonDisabled]:a}),disabled:a,key:"update-button",type:"submit"},this.messages.update):void 0,g=this.visibleElements.cancelUpdateButton?K("button",{bind:this,class:this.classes(vt.button,vt.buttonSmall,vt.buttonTertiary,vt.buttonThird,{[vt.buttonDisabled]:n}),disabled:n,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0,v=o.editing&&((A=o.operations)!=null&&A.update)?K("fieldset",{class:$t.fileFieldset,key:"file"},K("span",{class:$t.fileName,key:"file-name"},u),K("label",{class:this.classes($t.fileLabel,vt.button,vt.buttonSecondary)},this.messages.changeFile,K("input",{bind:this,class:$t.fileInput,name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0,b=K("fieldset",{class:$t.metadataFieldset,key:"size"},K("label",null,Mje(this.messagesUnits,c??0))),w=K("fieldset",{class:$t.metadataFieldset,key:"content-type"},K("label",null,l)),S=h!=null?K("a",{class:$t.itemLink,href:h,rel:"noreferrer",target:"_blank"},this._renderImageMask(e,400),K("div",{class:$t.itemLinkOverlay},K("span",{class:$t.itemLinkOverlayIcon},K("calcite-icon",{icon:"launch"})))):this._renderImageMask(e,400),T=K("form",{afterCreate:HZ,afterRemoved:jZ,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:D=>this._submitUpdateAttachment(D,e)},K("div",{class:$t.metadata},b,w),v,K("div",{class:$t.actions},m,g,f));return K("div",{class:$t.formNode,key:"edit-form-container"},S,T)}_renderImageMask(e,s){return e?"file"in e?this._renderGenericImageMask(e.file.name,e.file.type):this._renderImageMaskForAttachment(e,s):null}_renderGenericImageMask(e,s){const{supportsResizeAttachments:i}=this.viewModel,r=aHe(s),n={[$t.itemImageResizable]:i};return K("div",{class:this.classes($t.itemMaskIcon,$t.itemMask),key:r},K("img",{alt:e,class:this.classes(n,$t.itemImage),src:r,title:e}))}_renderImageMaskForAttachment(e,s){const{supportsResizeAttachments:i}=this.viewModel;if(!e)return null;const{contentType:r,name:n,url:o}=e;if(!i||!Lte(r))return this._renderGenericImageMask(n,r);const a=this._getCSSTransform(e),l=a?{transform:a,"image-orientation":"none"}:{},u=`${o}${o!=null&&o.includes("?")?"&":"?"}w=${s}`,c={[$t.itemImageResizable]:i};return K("div",{class:this.classes($t.itemMask),key:u},K("img",{alt:n,class:this.classes(c,$t.itemImage),src:u,styles:l,title:n}))}_renderFile(e){const{file:s}=e;return K("li",{class:$t.item,key:s},K("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:$t.itemButton,key:"details-button",onclick:()=>this._startEditFile(e),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(e),K("label",{class:$t.itemLabel},K("span",{class:$t.itemFilename},s.name||this.messages.noTitle),K("span",{"aria-hidden":"true",class:this.classes($t.itemChevronIcon,zh(this.container)?fd.left:fd.right)}))))}_renderAttachmentInfo({attachmentInfo:e,displayType:s}){const{viewModel:i,effectiveDisplayType:r}=this,{capabilities:n,supportsResizeAttachments:o}=i,{contentType:a,name:l,url:u}=e,c=this._renderImageMask(e,s==="list"?48:400),h=n.editing?K("span",{"aria-hidden":"true",class:this.classes($t.itemChevronIcon,zh(this.container)?fd.left:fd.right)}):null,m=[c,r==="preview"&&o&&Lte(a)?null:K("label",{class:$t.itemLabel},K("span",{class:$t.itemFilename},l||this.messages.noTitle),h)],f=n.editing?K("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:$t.itemButton,"data-attachment-info-id":e.id,key:"details-button",onclick:()=>this._startEditAttachment(e),title:this.messages.attachmentDetails,type:"button"},m):K("a",{class:$t.itemButton,href:u??void 0,key:"details-link",rel:"noreferrer",target:"_blank"},m);return K("li",{class:$t.item,key:e},f)}_renderAttachmentContainer(){var g;const{effectiveDisplayType:e,viewModel:s,visibleElements:i}=this,{attachmentInfos:r,capabilities:n,fileInfos:o}=s,a=!!(r!=null&&r.length),l=!!(o!=null&&o.length),u={[$t.containerList]:e!=="preview",[$t.containerPreview]:e==="preview"},c=n.editing&&((g=n.operations)!=null&&g.add)&&i.addButton?K("button",{bind:this,class:this.classes(vt.button,vt.buttonTertiary,$t.addAttachmentButton),onclick:()=>this._startAddAttachment(),type:"button"},K("span",{"aria-hidden":"true",class:this.classes($t.itemAddIcon,fd.plus)}),this.messages.add):void 0,h=a?K("ul",{class:$t.items,key:"attachments-list"},r.toArray().map(v=>this._renderAttachmentInfo({attachmentInfo:v,displayType:e}))):void 0,m=l?K("ul",{class:$t.items,key:"file-list"},o.toArray().map(v=>this._renderFile(v))):void 0,f=l||a?void 0:K("div",{class:vt.empty},this.messages.noAttachments);return K("div",{class:this.classes($t.container,u),key:"attachments-container"},h,m,f,c)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){var r;const s=e.target,i=(r=s.files)==null?void 0:r.item(0);this._set("selectedFile",i)}_submitDeleteAttachment(e,s){e.preventDefault(),s&&("file"in s?this.deleteFile(s.file):s&&this.deleteAttachment(s))}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,s){e.preventDefault(),s&&"file"in s?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:s}=this;s.activeFileInfo=null,s.activeAttachmentInfo=e,s.mode="edit"}_startEditFile(e){const{viewModel:s}=this;s.activeAttachmentInfo=null,s.activeFileInfo=e,s.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:s}=e;return!this._supportsImageOrientation&&s?[s.rotation?`rotate(${s.rotation}deg)`:"",s.mirrored?"scaleX(-1)":""].join(" "):""}};p([_()],no.prototype,"capabilities",null),p([_()],no.prototype,"displayType",void 0),p([_({readOnly:!0})],no.prototype,"effectiveDisplayType",null),p([_()],no.prototype,"graphic",null),p([_()],no.prototype,"icon",null),p([_()],no.prototype,"label",null),p([_(),ur("esri/widgets/Attachments/t9n/Attachments")],no.prototype,"messages",void 0),p([_(),ur("esri/core/t9n/Units")],no.prototype,"messagesUnits",void 0),p([_({readOnly:!0})],no.prototype,"selectedFile",void 0),p([_({readOnly:!0})],no.prototype,"submitting",void 0),p([_({readOnly:!0})],no.prototype,"error",void 0),p([_({type:ZU})],no.prototype,"viewModel",void 0),p([_()],no.prototype,"visibleElements",void 0),p([Ht("visibleElements")],no.prototype,"castVisibleElements",null),no=p([Q("esri.widgets.Attachments")],no);const lHe=no;let xS=class extends ZU{constructor(e){super(e),this.description=null,this.title=null}};p([_()],xS.prototype,"description",void 0),p([_()],xS.prototype,"title",void 0),xS=p([Q("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],xS);const QU=xS;function JU({level:t,class:e,...s},i){const r=n_e(t);return K(`h${r}`,{...s,"aria-level":String(r),class:lhe(vt.heading,e),role:"heading"},i)}function n_e(t){return Ka(Math.ceil(t),1,6)}function s1t(t,e=1){return n_e(t+e)}const AO="esri-feature-element-info",NO={base:AO,title:`${AO}__title`,description:`${AO}__description`};let cv=class extends Er{constructor(e,s){super(e,s),this.description=null,this.headingLevel=2,this.title=null}render(){return K("div",{class:NO.base},this._renderTitle(),this._renderDescription())}_renderTitle(){const{title:e}=this;return e?K(JU,{class:NO.title,innerHTML:e,level:this.headingLevel}):null}_renderDescription(){const{description:e}=this;return e?K("div",{class:NO.description,innerHTML:e,key:"description"}):null}};p([_()],cv.prototype,"description",void 0),p([_()],cv.prototype,"headingLevel",void 0),p([_()],cv.prototype,"title",void 0),cv=p([Q("esri.widgets.Feature.support.FeatureElementInfo")],cv);const fP=cv,uHe={base:"esri-feature-attachments"};let Th=class extends Er{constructor(e,s){super(e,s),this._featureElementInfo=null,this.attachmentsWidget=new lHe,this.headingLevel=2,this.viewModel=new QU}initialize(){this._featureElementInfo=new fP,this.addHandles([Ee(()=>{var e,s;return[(e=this.viewModel)==null?void 0:e.description,(s=this.viewModel)==null?void 0:s.title,this.headingLevel]},()=>this._setupFeatureElementInfo(),ht),Ee(()=>this.viewModel,e=>this.attachmentsWidget.viewModel=e,ht)])}destroy(){var e;this.attachmentsWidget.viewModel=null,this.attachmentsWidget.destroy(),(e=this._featureElementInfo)==null||e.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var s;const{attachmentsWidget:e}=this;return K("div",{class:uHe.base},(s=this._featureElementInfo)==null?void 0:s.render(),e==null?void 0:e.render())}_setupFeatureElementInfo(){var r;const{description:e,title:s,headingLevel:i}=this;(r=this._featureElementInfo)==null||r.set({description:e,title:s,headingLevel:i})}};p([_({readOnly:!0})],Th.prototype,"attachmentsWidget",void 0),p([_()],Th.prototype,"description",null),p([_()],Th.prototype,"displayType",null),p([_()],Th.prototype,"graphic",null),p([_()],Th.prototype,"headingLevel",void 0),p([_()],Th.prototype,"title",null),p([_({type:QU})],Th.prototype,"viewModel",void 0),Th=p([Q("esri.widgets.Feature.FeatureAttachments")],Th);const cHe=Th;let of=class extends Ye{constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.addHandles(Ee(()=>this.creator,s=>{this._destroyContent(),this._createContent(s)},ht))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:s,destroyer:i}=this;e&&s&&(WE({type:"content",value:i,event:{graphic:s}}),this._set("created",null))}async _createContent(e){const s=this.graphic;if(!s||!e)return;const i=WE({type:"content",value:e,event:{graphic:s}});this._loadingPromise=i,this.notifyChange("state");const r=await i;i===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",r))}};p([_({readOnly:!0})],of.prototype,"created",void 0),p([_()],of.prototype,"creator",void 0),p([_()],of.prototype,"destroyer",void 0),p([_({type:tn})],of.prototype,"graphic",void 0),p([_({readOnly:!0})],of.prototype,"state",null),of=p([Q("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],of);const V3=of,DO="esri-feature-content",$O={base:DO,loaderContainer:`${DO}__loader-container`,loader:`${DO}__loader`};let hv=class extends Er{constructor(e,s){super(e,s),this.viewModel=null,this._addTargetToAnchors=i=>{Array.from(i.querySelectorAll("a")).forEach(r=>{jU(r.href)&&!r.hasAttribute("target")&&r.setAttribute("target","_blank")})}}get creator(){var e;return(e=this.viewModel)==null?void 0:e.creator}set creator(e){this.viewModel&&(this.viewModel.creator=e)}get graphic(){var e;return(e=this.viewModel)==null?void 0:e.graphic}set graphic(e){this.viewModel&&(this.viewModel.graphic=e)}render(){var s;const e=(s=this.viewModel)==null?void 0:s.state;return K("div",{class:$O.base},e==="loading"?this._renderLoading():this._renderCreated())}_renderLoading(){return K("div",{class:$O.loaderContainer,key:"loader"},K("div",{class:$O.loader}))}_renderCreated(){var s;const e=(s=this.viewModel)==null?void 0:s.created;return e?e instanceof HTMLElement?K("div",{afterCreate:this._attachToNode,bind:e,key:e}):P_(e)?K("div",{key:e},!e.destroyed&&e.render()):K("div",{afterCreate:this._addTargetToAnchors,innerHTML:e,key:e}):null}_attachToNode(e){const s=this;e.appendChild(s)}};p([_()],hv.prototype,"creator",null),p([_()],hv.prototype,"graphic",null),p([_({type:V3})],hv.prototype,"viewModel",void 0),hv=p([Q("esri.widgets.Feature.FeatureContent")],hv);const UA=hv;let Qm=class extends Ye{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:s}=this,i=[];return s==null||s.forEach(r=>{if(!(!r.hasOwnProperty("visible")||r.visible))return;const n=r.clone();n.label=HU(n,e),i.push(n)}),i}};p([_()],Qm.prototype,"attributes",void 0),p([_({type:[Sme]})],Qm.prototype,"expressionInfos",void 0),p([_()],Qm.prototype,"description",void 0),p([_({type:[QC]})],Qm.prototype,"fieldInfos",void 0),p([_({readOnly:!0})],Qm.prototype,"formattedFieldInfos",null),p([_()],Qm.prototype,"title",void 0),Qm=p([Q("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],Qm);const X$=Qm,hHe=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function mHe(t,e){if(typeof e!="string"||!e)return e;const s=hHe.find(l=>l.pattern.test(e));if(!s)return e;const i=e.match(s.pattern),r=i==null?void 0:i[2],n=jc(jc(s.label,{messages:t,hierPart:r}),{appName:s.appName}),o=s.target?` target="${s.target}"`:"",a=s.target==="_blank"?' rel="noreferrer"':"";return e.replace(s.pattern,`<a${o} href="$1"${a}>${n}</a>`)}const jI="esri-feature-fields",HI={base:jI,fieldHeader:`${jI}__field-header`,fieldData:`${jI}__field-data`,fieldDataDate:`${jI}__field-data--date`};let vc=class extends Er{constructor(e,s){super(e,s),this._featureElementInfo=null,this.viewModel=new X$,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new fP,this.addHandles(Ee(()=>{var e,s;return[(e=this.viewModel)==null?void 0:e.description,(s=this.viewModel)==null?void 0:s.title]},()=>this._setupFeatureElementInfo(),ht))}destroy(){var e;(e=this._featureElementInfo)==null||e.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return K("div",{class:HI.base},(e=this._featureElementInfo)==null?void 0:e.render(),this._renderFields())}_renderFieldInfo(e,s){var c;const{attributes:i}=this.viewModel,r=e.fieldName||"",n=e.label||r,o=i?i[r]==null?"":i[r]:"",a=!!((c=e.format)!=null&&c.dateFormat),l=typeof o=="number"&&!a?this._forceLTR(o):mHe(this.messagesURIUtils,o),u={[HI.fieldDataDate]:a};return K("tr",{key:`fields-element-info-row-${r}-${s}`},K("th",{class:HI.fieldHeader,innerHTML:n,key:`fields-element-info-row-header-${r}-${s}`}),K("td",{class:this.classes(HI.fieldData,u),innerHTML:l,key:`fields-element-info-row-data-${r}-${s}`}))}_renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e!=null&&e.length?K("table",{class:vt.table,summary:this.messages.fieldsSummary},K("tbody",null,e.map((s,i)=>this._renderFieldInfo(s,i)))):null}_setupFeatureElementInfo(){var i;const{description:e,title:s}=this;(i=this._featureElementInfo)==null||i.set({description:e,title:s})}_forceLTR(e){return`&lrm;${e}`}};p([_()],vc.prototype,"attributes",null),p([_()],vc.prototype,"description",null),p([_()],vc.prototype,"expressionInfos",null),p([_()],vc.prototype,"fieldInfos",null),p([_()],vc.prototype,"title",null),p([_({type:X$,nonNullable:!0})],vc.prototype,"viewModel",void 0),p([_(),ur("esri/widgets/Feature/t9n/Feature")],vc.prototype,"messages",void 0),p([_(),ur("esri/widgets/support/t9n/uriUtils")],vc.prototype,"messagesURIUtils",void 0),vc=p([Q("esri.widgets.Feature.FeatureFields")],vc);const o_e=vc,dHe=/^-?(\d+)(\.(\d+))?$/i;function pHe(t,e){return t-e}function fHe(t,e){let s,i;return s=Number(t.toFixed(e)),s<t?i=s+1/10**e:(i=s,s-=1/10**e),s=Number(s.toFixed(e)),i=Number(i.toFixed(e)),[s,i]}function gHe(t,e,s,i,r){const n=yHe(t,e,s,i),o=n.previous==null||n.previous<=r,a=n.next==null||n.next<=r;return o&&a||n.previous+n.next<=2*r}function a_e(t){const e=String(t),s=e.match(dHe);if(s!=null&&s[1])return{integer:s[1].split("").length,fractional:s[3]?s[3].split("").length:0};if(e.toLowerCase().includes("e")){const i=e.split("e"),r=i[0],n=i[1];if(r&&n){const o=Number(r);let a=Number(n);const l=a>0;l||(a=Math.abs(a));const u=a_e(o);return l?(u.integer+=a,a>u.fractional?u.fractional=0:u.fractional-=a):(u.fractional+=a,a>u.integer?u.integer=1:u.integer-=a),u}}return{integer:0,fractional:0}}function yHe(t,e,s,i){const r={previous:null,next:null};if(s!=null){const n=t-s,o=e-s-n;r.previous=Math.floor(Math.abs(100*o/n))}if(i!=null){const n=i-t,o=i-e-n;r.next=Math.floor(Math.abs(100*o/n))}return r}function u1t(t,e={}){const s=t.slice(),{tolerance:i=2,strictBounds:r=!1,indexes:n=s.map((o,a)=>a)}=e;n.sort(pHe);for(let o=0;o<n.length;o++){const a=n[o],l=s[a],u=a===0?null:s[a-1],c=a===s.length-1?null:s[a+1],h=a_e(l).fractional;if(h){let m,f=0,g=!1;for(;f<=h&&!g;){const v=fHe(l,f);m=r&&o===0?v[1]:v[0],g=gHe(l,m,u,c,i),f++}g&&(s[a]=m)}}return s}const _He={maximumFractionDigits:20};function vHe(t){return Un(t,_He)}function l_e(t,e,s,i){if(t)if(t.type!=="CIMTextSymbol"){if(t.effects)for(const r of t.effects)qte(r,e);if(t.symbolLayers)for(const r of t.symbolLayers){switch(r.type){case"CIMPictureMarker":case"CIMVectorMarker":bHe(r,e,i);break;case"CIMPictureStroke":case"CIMSolidStroke":case"CIMGradientStroke":!(i!=null&&i.preserveOutlineWidth)&&r.width&&(r.width*=e);break;case"CIMPictureFill":r.height&&(r.height*=e),r.offsetX&&(r.offsetX*=e),r.offsetY&&(r.offsetY*=e);break;case"CIMHatchFill":l_e(r.lineSymbol,e,!0,{...i,preserveOutlineWidth:!1}),r.offsetX&&(r.offsetX*=e),r.offsetY&&(r.offsetY*=e),r.separation&&(r.separation*=e)}if(r.effects)for(const n of r.effects)qte(n,e)}}else t.height!=null&&(t.height*=e)}function bHe(t,e,s){if(t&&(t.markerPlacement&&xHe(t.markerPlacement,e),t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.anchorPoint&&t.anchorPointUnits==="Absolute"&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size=t.size!=null?t.size*e:0,t.type==="CIMVectorMarker"&&t.markerGraphics))for(const i of t.markerGraphics)t.scaleSymbolsProportionally||l_e(i.symbol,e,!0,s)}function xHe(t,e){switch(q$(t)&&t.offset&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.placementTemplate&&t.placementTemplate.length){const s=t.placementTemplate.map(i=>i*e);t.placementTemplate=s}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset&&(t.maxRandomOffset*=e),t.placementTemplate&&t.placementTemplate.length){const s=t.placementTemplate.map(i=>i*e);t.placementTemplate=s}break;case"CIMMarkerPlacementOnLine":t.startPointOffset&&(t.startPointOffset*=e);break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine&&(t.offsetAlongLine*=e);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition&&(t.beginPosition*=e),t.endPosition&&(t.endPosition*=e);break;case"CIMMarkerPlacementPolygonCenter":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMMarkerPlacementInsidePolygon":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.stepX&&(t.stepX*=e),t.stepY&&(t.stepY*=e)}}function qte(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width&&(t.width*=e);break;case"CIMGeometricEffectBuffer":t.size&&(t.size*=e);break;case"CIMGeometricEffectCut":t.beginCut&&(t.beginCut*=e),t.endCut&&(t.endCut*=e),t.middleCut&&(t.middleCut*=e);break;case"CIMGeometricEffectDashes":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.dashTemplate&&t.dashTemplate.length){const s=t.dashTemplate.map(i=>i*e);t.dashTemplate=s}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length&&(t.length*=e);break;case"CIMGeometricEffectMove":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset&&(t.offset*=e);break;case"CIMGeometricEffectRegularPolygon":t.radius&&(t.radius*=e);break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth&&(t.fromWidth*=e),t.length&&(t.length*=e),t.toWidth&&(t.toWidth*=e);break;case"CIMGeometricEffectWave":t.amplitude&&(t.amplitude*=e),t.period&&(t.period*=e)}}function u_e(t){const e=[];return n8(Kge(t),e),e.length?new Be(Jge(e[0])):null}function n8(t,e){var r;if(!t)return;let s;s=t.type==="CIMTextSymbol"?t.symbol:t;const i=t.type==="CIMPolygonSymbol";if(s!=null&&s.symbolLayers){for(const n of s.symbolLayers)if(!(n.colorLocked||i&&(tye(n)||eye(n)&&n.markerPlacement&&q$(n.markerPlacement))))switch(n.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":n.tintColor&&Gte(e,n.tintColor);break;case"CIMVectorMarker":(r=n.markerGraphics)==null||r.forEach(o=>{n8(o.symbol,e)});break;case"CIMSolidStroke":case"CIMSolidFill":Gte(e,n.color);break;case"CIMHatchFill":n8(n.lineSymbol,e)}}}function Gte(t,e){for(const s of t)if(s.join(".")===e.join("."))return;t.push(e)}function c1t(t,e,s){e instanceof Be||(e=new Be(e));const i=Kge(t);i&&o8(i,e)}function o8(t,e,s){var n;if(!t)return;let i;i=t.type==="CIMTextSymbol"?t.symbol:t;const r=(i==null?void 0:i.type)==="CIMPolygonSymbol";if(i!=null&&i.symbolLayers)for(const o of i.symbolLayers){if(o.colorLocked||r&&(tye(o)||eye(o)&&o.markerPlacement&&q$(o.markerPlacement)))continue;const a=e.toArray();switch(o.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":o.tintColor=a;break;case"CIMVectorMarker":(n=o.markerGraphics)==null||n.forEach(l=>{o8(l.symbol,e)});break;case"CIMSolidStroke":case"CIMSolidFill":o.color=a;break;case"CIMHatchFill":o8(o.lineSymbol,e)}}}const c_e="picture-fill",h_e="simple-fill",wHe="simple-line",m_e="simple-marker",SHe="text",EHe="cim",zte=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),RO=new Wge(1e3);function h1t(t){const e=t.style;let s=null;if(t)switch(t.type){case m_e:e!=="cross"&&e!=="x"&&(s=t.color);break;case h_e:e&&e!=="solid"?e!=="none"&&(s={type:"pattern",x:0,y:0,src:Ii(`esri/symbols/patterns/${e}.png`),width:5,height:5}):s=t.color;break;case c_e:s={type:"pattern",src:t.url,width:ko(t.width)*t.xscale,height:ko(t.height)*t.yscale,x:ko(t.xoffset),y:ko(t.yoffset)};break;case SHe:s=t.color;break;case EHe:s=u_e(t)}return s}function CHe(t,e){const s=t+"-"+e;return RO.get(s)!==void 0?Promise.resolve(RO.get(s)):js(t,{responseType:"image"}).then(i=>{const r=i.data,n=r.naturalWidth,o=r.naturalHeight,a=document.createElement("canvas");a.width=n,a.height=o;const l=a.getContext("2d");l.fillStyle=e,l.fillRect(0,0,n,o),l.globalCompositeOperation="destination-in",l.drawImage(r,0,0);const u=a.toDataURL();return RO.put(s,u),u})}function KU(t){if(!t)return null;let e=null;switch(t.type){case h_e:case c_e:case m_e:e=KU(t.outline);break;case wHe:{const s=ko(t.width);t.style!=null&&t.style!=="none"&&s!==0&&(e={color:t.color,style:e9(t.style),width:s,cap:t.cap,join:t.join==="miter"?ko(t.miterLimit):t.join},e.dashArray=d_e(e).join(",")||"none");break}default:e=null}return e}function d_e(t){if(!(t!=null&&t.style))return[];const{dashArray:e,style:s,width:i}=t;if(typeof e=="string"&&e!=="none")return e.split(",").map(o=>Number(o));const r=i??0,n=zte.has(s)?zte.get(s).map(o=>o*r):[];if(t.cap!=="butt")for(const[o,a]of n.entries())n[o]=o%2==1?a+r:Math.max(a-r,1);return n}const e9=(()=>{const t={};return e=>{if(t[e])return t[e];const s=e.replaceAll("-","");return t[e]=s,s}})(),PHe=new Be([128,128,128]),THe=new Be("white");function IHe(t){var s,i;const e=(s=t.symbolLayers)==null?void 0:s.at(-1);if(e&&"outline"in e)return(i=e==null?void 0:e.outline)==null?void 0:i.size}function m1t(t){var e;if(!t)return 0;if(xg(t)){const s=IHe(t);return s??0}return Zl((e=KU(t))==null?void 0:e.width)}function MHe(t){if(t==null||!("symbolLayers"in t)||t.symbolLayers==null)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some(e=>e.type==="object");case"line-3d":return t.symbolLayers.some(e=>e.type==="path");case"polygon-3d":return t.symbolLayers.some(e=>e.type==="object"||e.type==="extrude");default:return!1}}function AHe(t){var e;return((e=t.resource)==null?void 0:e.href)??""}function T1(t,e){if(!t)return null;let s=null;return xg(t)?s=NHe(t):_$(t)&&(s=t.type==="cim"?u_e(t):t.color?new Be(t.color):null),s?ZE(s,e):null}function NHe(t){const e=t.symbolLayers;if(!e)return null;let s=null;return e.forEach(i=>{var r;i.type==="object"&&((r=i.resource)!=null&&r.href)||(s=i.type==="water"?i.color:i.material?i.material.color:null)}),s?new Be(s):null}function ZE(t,e){if(e==null||t==null)return t;const s=t.toRgba();return s[3]=s[3]*e,new Be(s)}function DHe(t,e,s){const i=t.symbolLayers;if(!i)return;const r=n=>ZE(e=e??n??(s!=null?THe:null),s);i.forEach(n=>{var o,a;if(n.type!=="object"||!((o=n.resource)!=null&&o.href)||e)if(n.type==="water")n.color=r(n.color);else{const l=n.material!=null?n.material.color:null,u=r(l);n.material==null?n.material=new Wa({color:u}):n.material.color=u,s!=null&&"outline"in n&&((a=n.outline)==null?void 0:a.color)!=null&&(n.outline.color=ZE(n.outline.color,s))}})}function $He(t,e,s){var i;(e=e??t.color)&&(t.color=ZE(e,s)),s!=null&&"outline"in t&&((i=t.outline)!=null&&i.color)&&(t.outline.color=ZE(t.outline.color,s))}function kO(t,e,s){t&&(e||s!=null)&&(e&&(e=new Be(e)),xg(t)?DHe(t,e,s):_$(t)&&$He(t,e,s))}async function RHe(t,e){const s=t.symbolLayers;s&&await KIe(s,async i=>kHe(i,e))}async function kHe(t,e){switch(t.type){case"extrude":OHe(t,e);break;case"icon":case"line":case"text":FHe(t,e);break;case"path":VHe(t,e);break;case"object":await LHe(t,e)}}function FHe(t,e){const s=p_e(e);s!=null&&(t.size=s)}function p_e(t){for(const e of t)if(typeof e=="number")return e;return null}function OHe(t,e){t.size=typeof e[2]=="number"?e[2]:0}async function LHe(t,e){const{resourceSize:s,symbolSize:i}=await qHe(t),r=f_e(e,s,i);t.width=cE(e[0],i[0],s[0],r),t.depth=cE(e[1],i[1],s[1],r),t.height=cE(e[2],i[2],s[2],r)}function VHe(t,e){const s=f_e(e,Dce,[t.width,void 0,t.height]);t.width=cE(e[0],t.width,1,s),t.height=cE(e[2],t.height,1,s)}function f_e(t,e,s){for(let i=0;i<3;i++){const r=t[i];switch(r){case"symbol-value":{const n=s[i];return n!=null?n/e[i]:1}case"proportional":break;default:if(r&&e[i])return r/e[i]}}return 1}async function qHe(t){const{computeObjectLayerResourceSize:e}=await me(()=>import("./symbolLayerUtils-B1nldNcF.js"),[]),s=await e(t,10),{width:i,height:r,depth:n}=t,o=[i,n,r];let a=1;for(let l=0;l<3;l++){const u=o[l];if(u!=null){a=u/s[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=s[l]*a);return{resourceSize:s,symbolSize:o}}function cE(t,e,s,i){switch(t){case"proportional":return s*i;case"symbol-value":return e??s;default:return t}}function GHe(t,e){const s=p_e(e);if(s!=null)switch(t.type){case"simple-marker":t.size=s;break;case"picture-marker":{const i=t.width/t.height;i>1?(t.width=s,t.height=s*i):(t.width=s*i,t.height=s);break}case"simple-line":t.width=s;break;case"text":t.font.size=s}}async function zHe(t,e){if(t&&e)return xg(t)?RHe(t,e):void(_$(t)&&GHe(t,e))}function UHe(t,e,s){if(t&&e!=null)if(xg(t)){const i=t.symbolLayers;i&&i.forEach(r=>{if(r.type==="object")switch(s){case"tilt":r.tilt=(r.tilt??0)+e;break;case"roll":r.roll=(r.roll??0)+e;break;default:r.heading=(r.heading??0)+e}r.type==="icon"&&(r.angle+=e)})}else _$(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle+=e))}function g_e(t){if(!t)return null;const e=t.effects.filter(s=>s.type!=="bloom").map(s=>s.toJSON());return KV(e)}function d1t(t){return t!=null&&t.type==="polygon-3d"&&t.symbolLayers.some(e=>e.type==="extrude")}const BHe="<",jHe=">";function HHe(t,e,s,i){let r="";return e===0?r=`${BHe} `:e===s&&(r=`${jHe} `),r+(i?UU(t,i):vHe(t))}const p1t=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function YHe(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find(o=>o.type==="color");if(!e)return null;let s=null,i=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;s=e.stops[0].value,i=e.stops[e.stops.length-1].value}const r=s!=null&&i!=null?s+(i-s)/2:0,{getColor:n}=await me(async()=>{const{getColor:o}=await Promise.resolve().then(()=>O$);return{getColor:o}},void 0);return n(e,r)??null}async function f1t(t,e){const s=t.trailCap,i=t.trailWidth||1,r=e||await YHe(t)||t.color;return new tl({cap:s,color:r,width:i})}function XHe(t,e){var s,i;if(!e.field)return null;if("featureReduction"in t)switch((s=t.featureReduction)==null?void 0:s.type){case"cluster":case"binning":{const r=t.featureReduction.fields.find(({name:n})=>n.toLowerCase()===e.field.toLowerCase());return r&&"getField"in t?t.getField(r.onStatisticField):null}}return"getField"in t?(i=t.getField)==null?void 0:i.call(t,e.field):null}function WHe(t,e){var i,r,n;const s="popupTemplate"in t?(i=t.popupTemplate)==null?void 0:i.fieldInfos:null;if(s!=null&&s.length&&e)return(n=(r=s.find(o=>{var a;return((a=o.fieldName)==null?void 0:a.toLowerCase())===e.toLowerCase()}))==null?void 0:r.format)==null?void 0:n.dateFormat}function g1t(t,e,s){var n,o,a,l;const i=XHe(t,e);if(!i||!qye(i)&&!$7(i))return null;let r=WHe(t,i.name);if(!r&&i.type==="date"){let u=0,c=0;e.stops?(u=((o=(n=e.stops)==null?void 0:n.at(0))==null?void 0:o.value)??u,c=((l=(a=e.stops)==null?void 0:a.at(-1))==null?void 0:l.value)??c):"minDataValue"in e&&"maxDataValue"in e&&(u=e.minDataValue??u,c=e.maxDataValue??c),r=c-u>2*i6.days?"short-date":"short-date-short-time"}return{fieldType:i.type,format:r,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:s,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}}}function y1t(t){var e,s;if("authoringInfo"in t)return(s=(e=t.authoringInfo)==null?void 0:e.visualVariables)==null?void 0:s.find(({theme:i})=>i==="reference-size")}const ZHe=new Be([64,64,64]);function y_e(t,e){const s=[],i=t.length-1;return t.length===5?s.push(0,2,4):s.push(0,i),t.map((r,n)=>s.includes(n)?HHe(r,n,i,e):null)}async function QHe(t,e,s){let i=!1,r=[],n=[];if(t.stops){const u=t.stops;r=u.map(c=>c.value),i=u.some(c=>!!c.label),i&&(n=u.map(c=>c.label))}const o=r[0],a=r[r.length-1];if(o==null&&a==null)return null;const l=i?null:y_e(r,s);return(await Promise.all(r.map(async(u,c)=>({value:u,color:t.type==="opacity"?await JHe(u,t,e):(await me(async()=>{const{getColor:h}=await Promise.resolve().then(()=>O$);return{getColor:h}},void 0)).getColor(t,u),label:i?n[c]:(l==null?void 0:l[c])??""})))).reverse()}async function JHe(t,e,s){const i=new Be(s??ZHe),r=(await me(async()=>{const{getOpacity:n}=await Promise.resolve().then(()=>O$);return{getOpacity:n}},void 0)).getOpacity(e,t);return r!=null&&(i.a=r),i}function _1t(t){let e=!1,s=[],i=[];s=t.map(a=>a.value),e=t.some(a=>!!a.label),e&&(i=t.map(a=>a.label??""));const r=s[0],n=s[s.length-1];if(r==null&&n==null)return null;const o=e?null:y_e(s);return s.map((a,l)=>({value:a,color:KHe(a,t),label:e?i[l]:(o==null?void 0:o[l])??""})).reverse()}function KHe(t,e){const{startIndex:s,endIndex:i,weight:r}=eYe(t,e);if(s===i)return e[s].color;const n=Be.blendColors(e[s].color,e[i].color,r);return new Be(n)}function eYe(t,e){let s=0,i=e.length-1;return e.some((r,n)=>t<r.value?(i=n,!0):(s=n,!1)),{startIndex:s,endIndex:i,weight:(t-e[s].value)/(e[i].value-e[s].value)}}function v1t(t,e){let s=[];if(t&&t.type==="multipart")t.colorRamps.reverse().forEach((i,r)=>{r===0?s.push({value:e.max,color:new Be(i.toColor),label:"high"}):s.push({value:null,color:new Be(i.toColor),label:""}),r===t.colorRamps.length-1?s.push({value:e.min,color:new Be(i.fromColor),label:"low"}):s.push({value:null,color:new Be(i.fromColor),label:""})});else{let i,r;t&&t.type==="algorithmic"?(i=t.fromColor,r=t.toColor):(i=[0,0,0,1],r=[255,255,255,1]),s=[{value:e.max,color:new Be(r),label:"high"},{value:e.min,color:new Be(i),label:"low"}]}return s}function tYe(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter(i=>{var r;return((r=i.color)==null?void 0:r.a)>0});let s=e.length-1;if(e[0]){const i=e[s];i&&i.ratio!==1&&(e.push(new lE({ratio:1,color:i.color})),s++)}return e.map((i,r)=>{var o,a;let n="";return r===0?n=((o=t.legendOptions)==null?void 0:o.minLabel)||"low":r===s&&(n=((a=t.legendOptions)==null?void 0:a.maxLabel)||"high"),{color:i.color,label:n,ratio:i.ratio}}).reverse()}async function yl(t,e,s){Zb(t,e,()=>[]).push(...s)}async function sYe(t){var s,i;const e=new Map;if(!t)return e;if("visualVariables"in t&&t.visualVariables){for(const r of t.visualVariables)if(iYe(r)){const n=(await QHe(r)??[]).map(o=>o.color);await yl(e,r.field||r.valueExpression,n)}}if(t.type==="heatmap"){const r=tYe(t).map(n=>n.color);await yl(e,t.field||t.valueExpression,r)}else if(t.type==="pie-chart"){for(const r of t.attributes)await yl(e,r.field||r.valueExpression,[r.color]);await yl(e,"default",[(s=t==null?void 0:t.othersCategory)==null?void 0:s.color,T1(t.backgroundFillSymbol,null)])}else if(t.type==="dot-density"){for(const r of t.attributes)await yl(e,r.field||r.valueExpression,[r.color]);await yl(e,"default",[t.backgroundColor])}else if(t.type==="unique-value")if(((i=t.authoringInfo)==null?void 0:i.type)==="predominance")for(const r of t.uniqueValueInfos??[])await yl(e,r.value.toString(),[T1(r.symbol,null)]);else{const r=(t.uniqueValueInfos??[]).map(u=>T1(u.symbol,null)),{field:n,field2:o,field3:a,valueExpression:l}=t;(n||l)&&await yl(e,n||l,r),o&&await yl(e,o,r),a&&await yl(e,a,r)}else if(t.type==="class-breaks"){const r=t.classBreakInfos.map(a=>T1(a.symbol,null)),{field:n,valueExpression:o}=t;await yl(e,n??o,r)}else t.type==="simple"&&await yl(e,"default",[T1(t.symbol,null)]);return"defaultSymbol"in t&&t.defaultSymbol&&await yl(e,"default",[T1(t.defaultSymbol,null)]),e.forEach((r,n)=>{const o=nz(r.filter(Boolean),(a,l)=>JSON.stringify(a)===JSON.stringify(l));e.set(n,o)}),e}function iYe(t){return t.type==="color"}function __e(t){const e={};for(const s in t){if(s==="declaredClass")continue;const i=t[s];if(i!=null&&typeof i!="function")if(Array.isArray(i)){e[s]=[];for(let r=0;r<i.length;r++)e[s][r]=__e(i[r])}else typeof i=="object"?i.toJSON&&(e[s]=JSON.stringify(i)):e[s]=i}return e}function rYe(t){return 32+t.length}const v_e=16;function nYe(t){if(!t)return 0;let e=i9;for(const s in t)t.hasOwnProperty(s)&&(e+=t9(t[s],!1));return e}function oYe(t){if(!t)return 0;if(typeof t[0]=="number")return s9(t);if(Array.isArray(t))return aYe(t);let e=i9;for(const s in t)t.hasOwnProperty(s)&&(e+=t9(t[s]));return e}function aYe(t){const e=t.length;if(e===0||typeof t[0]=="number")return b_e(t,8);let s=x_e;for(let i=0;i<e;i++)s+=t9(t[i]);return s}function t9(t,e=!0){switch(typeof t){case"object":return e?oYe(t):i9;case"string":return rYe(t);case"number":return v_e;case"boolean":return 4;default:return 8}}function s9(...t){return t.reduce((e,s)=>e+(s?Toe(s)?s.byteLength+lYe:Array.isArray(s)?b_e(s,v_e):0:0),0)}function b_e(t,e){return x_e+t.length*e}const i9=32,x_e=16,lYe=145;var _f;(function(t){t[t.varint=0]="varint",t[t.fixed64=1]="fixed64",t[t.delimited=2]="delimited",t[t.fixed32=5]="fixed32",t[t.unknown=99]="unknown"})(_f||(_f={}));const Ute=4294967296,uYe=new TextDecoder("utf-8"),cYe=ge("safari")||ge("ios")?6:ge("ff")?12:32;let a8=class BA{constructor(e,s,i=0,r=e?e.byteLength:0){this._tag=0,this._dataType=_f.unknown,this._init(e,s,i,r)}_init(e,s,i,r){this._data=e,this._dataView=s,this._pos=i,this._end=r}get usedMemory(){return 64+s9(this._data)}asUnsafe(){return this}clone(){return new BA(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(e){this._pos=e}nextTag(e){for(;;){if(this._pos===this._end)return!1;const s=this._decodeVarint();if(this._tag=s>>3,this._dataType=7&s,!e||e===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let e=4294967295;if(e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128||(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128)||(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128)||(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128)||(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128))return e;throw new Error("Varint overflow")}getUInt64(){return this._decodeVarint()}getSInt32(){const e=this.getUInt32();return e>>>1^-(1&e)}getSInt64(){return this._decodeSVarint()}getBool(){const e=this._data[this._pos]!==0;return this._skip(1),e}getEnum(){return this._decodeVarint()}getFixed64(){const e=this._dataView,s=this._pos,i=e.getUint32(s,!0)+e.getUint32(s+4,!0)*Ute;return this._skip(8),i}getSFixed64(){const e=this._dataView,s=this._pos,i=e.getUint32(s,!0)+e.getInt32(s+4,!0)*Ute;return this._skip(8),i}getDouble(){const e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}getFixed32(){const e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}getSFixed32(){const e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}getFloat(){const e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}getString(){const e=this._getLength(),s=this._pos,i=this._toString(this._data,s,s+e);return this._skip(e),i}getBytes(){const e=this._getLength(),s=this._pos,i=this._toBytes(this._data,s,s+e);return this._skip(e),i}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(e,s,i,r){const n=this.getMessage(),o=e(n,s,i,r);return n.release(),o}processMessage(e){const s=this.getMessage(),i=e(s);return s.release(),i}getMessage(){const e=this._getLength(),s=BA.pool.acquire();return s._init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),s}release(){BA.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case _f.varint:this._decodeVarint();break;case _f.fixed64:this._skip(8);break;case _f.delimited:this._skip(this._getLength());break;case _f.fixed32:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(e){this._skip(e)}_skip(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e}_decodeVarint(){const e=this._data;let s=this._pos,i=0,r=0;if(this._end-s>=10)do{if(r=e[s++],i|=127&r,!(128&r)||(r=e[s++],i|=(127&r)<<7,!(128&r))||(r=e[s++],i|=(127&r)<<14,!(128&r))||(r=e[s++],i|=(127&r)<<21,!(128&r))||(r=e[s++],i+=268435456*(127&r),!(128&r))||(r=e[s++],i+=34359738368*(127&r),!(128&r))||(r=e[s++],i+=4398046511104*(127&r),!(128&r))||(r=e[s++],i+=562949953421312*(127&r),!(128&r))||(r=e[s++],i+=72057594037927940*(127&r),!(128&r))||(r=e[s++],i+=9223372036854776e3*(127&r),!(128&r)))break;throw new Error("Varint too long!")}while(!1);else{let n=1;for(;s!==this._end&&(r=e[s],128&r);)++s,i+=(127&r)*n,n*=128;if(s===this._end)throw new Error("Varint overrun!");++s,i+=r*n}return this._pos=s,i}_decodeSVarint(){const e=this._data;let s,i=0,r=0;const n=1&e[this._pos];if(r=e[this._pos++],i|=127&r,!(128&r)||(r=e[this._pos++],i|=(127&r)<<7,!(128&r))||(r=e[this._pos++],i|=(127&r)<<14,!(128&r))||(r=e[this._pos++],i|=(127&r)<<21,!(128&r))||(r=e[this._pos++],i+=268435456*(127&r),!(128&r))||(r=e[this._pos++],i+=34359738368*(127&r),!(128&r))||(r=e[this._pos++],i+=4398046511104*(127&r),!(128&r)))return n?-(i+1)/2:i/2;if(s=BigInt(i),r=e[this._pos++],s+=0x2000000000000n*BigInt(127&r),!(128&r)||(r=e[this._pos++],s+=0x100000000000000n*BigInt(127&r),!(128&r))||(r=e[this._pos++],s+=0x8000000000000000n*BigInt(127&r),!(128&r)))return Number(n?-(s+1n)/2n:s/2n);throw new Error("Varint too long!")}_getLength(){if(this._dataType!==_f.delimited)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(e,s,i){if((i=Math.min(this._end,i))-s>cYe){const o=e.subarray(s,i);return uYe.decode(o)}let r="",n="";for(let o=s;o<i;++o){const a=e[o];128&a?n+="%"+a.toString(16):(r+=decodeURIComponent(n)+String.fromCharCode(a),n="")}return n.length&&(r+=decodeURIComponent(n)),r}_toBytes(e,s,i){return i=Math.min(this._end,i),new Uint8Array(e.buffer,s,i-s)}};a8.pool=new mg(a8,void 0,t=>{t._data=null,t._dataView=null});const ey=2;let lb=class mv{constructor(e=[],s=[]){this.lengths=e??[],this.coords=s??[]}static fromJSON(e){return new mv(e.lengths,e.coords)}static fromRect(e){const[s,i,r,n]=e,o=r-s,a=n-i;return new mv([5],[s,i,o,0,0,a,-o,0,0,-a])}get isPoint(){return this.lengths.length===0&&this.coords.length>=2}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((e,s)=>e+s)}get usedMemory(){return 64+s9(this.lengths,this.coords)}area(){let e=0,s=0;if(!this.lengths.length)return 0;for(let i=0;i<this.lengths.length;i++){const r=this.lengths[i];if(r<3)continue;let n=this.coords[ey*s],o=this.coords[ey*s+1];for(let a=1;a<r;a+=1){const l=this.coords[ey*(a+s)],u=this.coords[ey*(a+s)+1];e+=-.5*(l-n)*(u+o),n=l,o=u}s+=r}return e}forEachVertex(e){let s=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let i=0;i<this.lengths.length;i++){const r=this.lengths[i];for(let n=0;n<r;n++)e(this.coords[ey*(n+s)],this.coords[ey*(n+s)+1]);s+=r}}deltaDecode(){const e=this.clone(),{coords:s,lengths:i}=e;let r=0;for(const n of i){for(let o=1;o<n;o++)s[2*(r+o)]+=s[2*(r+o)-2],s[2*(r+o)+1]+=s[2*(r+o)-1];r+=n}return e}clone(e){if(this.lengths.length===0)return new mv([],[this.coords[0],this.coords[1]]);const s=(this.lengths.length===0?1:this.lengths.reduce((r,n)=>r+n))*ey,i=this.coords.slice(0,s);return e?(e.set(i),new mv(this.lengths,e)):new mv(Array.from(this.lengths),Array.from(i))}};function r9(t,e){return t?e?4:3:e?3:2}function hYe(t,e,s,i){if(!(e!=null&&e.lengths.length))return null;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const r=t.coords,n=[],o=s?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:a,coords:l}=e,u=r9(s,i);let c=0;for(const h of a){const m=mYe(o,l,c,h,s,i);m&&n.push(m),c+=h*u}if(n.sort((h,m)=>{let f=h[2]-m[2];return f===0&&s&&(f=h[4]-m[4]),f}),n.length){let h=6*n[0][2];r[0]=n[0][0]/h,r[1]=n[0][1]/h,s&&(h=6*n[0][4],r[2]=h!==0?n[0][3]/h:0),(r[0]<o[0]||r[0]>o[1]||r[1]<o[2]||r[1]>o[3]||s&&(r[2]<o[4]||r[2]>o[5]))&&(r.length=0)}if(!r.length){const h=e.lengths[0]?dYe(l,0,a[0],s,i):null;if(!h)return null;r[0]=h[0],r[1]=h[1],s&&h.length>2&&(r[2]=h[2])}return t}function mYe(t,e,s,i,r,n){const o=r9(r,n);let a=s,l=s+o,u=0,c=0,h=0,m=0,f=0;for(let v=0,b=i-1;v<b;v++,a+=o,l+=o){const w=e[a],S=e[a+1],T=e[a+2],P=e[l],I=e[l+1],A=e[l+2];let D=w*I-P*S;m+=D,u+=(w+P)*D,c+=(S+I)*D,r&&(D=w*A-P*T,h+=(T+A)*D,f+=D),w<t[0]&&(t[0]=w),w>t[1]&&(t[1]=w),S<t[2]&&(t[2]=S),S>t[3]&&(t[3]=S),r&&(T<t[4]&&(t[4]=T),T>t[5]&&(t[5]=T))}if(m>0&&(m*=-1),f>0&&(f*=-1),!m)return null;const g=[u,c,.5*m];return r&&(g[3]=h,g[4]=.5*f),g}function dYe(t,e,s,i,r){const n=r9(i,r);let o=e,a=e+n,l=0,u=0,c=0,h=0;for(let m=0,f=s-1;m<f;m++,o+=n,a+=n){const g=t[o],v=t[o+1],b=t[o+2],w=t[a],S=t[a+1],T=t[a+2],P=i?fYe(g,v,b,w,S,T):pYe(g,v,w,S);if(P)if(l+=P,i){const I=yYe(g,v,b,w,S,T);u+=P*I[0],c+=P*I[1],h+=P*I[2]}else{const I=gYe(g,v,w,S);u+=P*I[0],c+=P*I[1]}}return l>0?i?[u/l,c/l,h/l]:[u/l,c/l]:s>0?i?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function pYe(t,e,s,i){const r=s-t,n=i-e;return Math.sqrt(r*r+n*n)}function fYe(t,e,s,i,r,n){const o=i-t,a=r-e,l=n-s;return Math.sqrt(o*o+a*a+l*l)}function gYe(t,e,s,i){return[t+.5*(s-t),e+.5*(i-e)]}function yYe(t,e,s,i,r,n){return[t+.5*(i-t),e+.5*(r-e),s+.5*(n-s)]}let _Ye=class jA{constructor(e=null,s={},i,r,n=0){this.geometry=e,this.attributes=s,this.centroid=i,this.objectId=r,this.displayId=n}static fromJSON(e){const s=e.geometry?lb.fromJSON(e.geometry):null,i=e.centroid?lb.fromJSON(e.centroid):null,r=e.objectId;return new jA(s,e.attributes,i,r)}weakClone(){const e=new jA(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e}clone(){var i,r;const e=(i=this.geometry)==null?void 0:i.clone(),s=new jA(e,{...this.attributes},(r=this.centroid)==null?void 0:r.clone(),this.objectId);return s.displayId=this.displayId,s}ensureCentroid(e){return this.centroid??(this.centroid=hYe(new lb,this.geometry,e.hasZ,e.hasM)),this.centroid}get usedMemory(){var e;return 128+nYe(this.attributes)+(((e=this.geometry)==null?void 0:e.usedMemory)??0)}};function vYe(t){var e,s;return!!((s=(e=t.geometry)==null?void 0:e.coords)!=null&&s.length)}let bYe=class w_e{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new w_e;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}};const S_e=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];let b1t=class{constructor(e){this._options=e,this.geometryTypes=S_e,this._coordinatePtr=0,this._vertexDimension=0}createFeatureResult(){return new bYe}prepareFeatures(e){this._vertexDimension=2,e.hasZ&&this._vertexDimension++,e.hasM&&this._vertexDimension++}finishFeatureResult(e){if(!(e!=null&&e.features)||!e.hasZ||!this._options.sourceSpatialReference||!e.spatialReference||on(e.spatialReference,this._options.sourceSpatialReference)||e.spatialReference.vcsWkid)return;const s=bb(this._options.sourceSpatialReference)/bb(e.spatialReference);if(s!==1)for(const i of e.features){if(!vYe(i))continue;const r=i.geometry.coords;for(let n=2;n<r.length;n+=3)r[n]*=s}}addFeature(e,s){e.features.push(s)}createFeature(){return new _Ye(null,{},null,0)}createSpatialReference(){return{wkid:0}}createGeometry(){return new lb}addField(e,s){e.fields.push(s)}allocateCoordinates(e){e.coords.length=e.lengths.reduce((s,i)=>s+i,0)*this._vertexDimension,this._coordinatePtr=0}addCoordinate(e,s){e.coords[this._coordinatePtr++]=s}addCoordinatePoint(e,s){e.coords.push(s)}addLength(e,s){e.lengths.push(s)}addQueryGeometry(e,s){e.queryGeometry=s.queryGeometry,e.queryGeometryType=s.queryGeometryType}createPointGeometry(){return new lb}};const Bte=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML","esriFieldTypeBigInteger","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"],jte=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],Hte=["upperLeft","lowerLeft"];function Yte(t){return t>=Bte.length?null:Bte[t]}function xYe(t){return t>=jte.length?null:jte[t]}function Xte(t){return t>=Hte.length?null:Hte[t]}function Wte(t,e){return e>=t.geometryTypes.length?null:t.geometryTypes[e]}function wYe(t,e,s){const r=t.asUnsafe(),n=e.createPointGeometry(s);for(;r.next();)switch(r.tag()){case 3:{const o=r.getUInt32(),a=r.pos()+o;let l=0;for(;r.pos()<a;)e.addCoordinatePoint(n,r.getSInt64(),l++);break}default:r.skip()}return n}function SYe(t,e,s){const n=t.asUnsafe(),o=e.createGeometry(s),a=2+(s.hasZ?1:0)+(s.hasM?1:0);for(;n.next();)switch(n.tag()){case 2:{const l=n.getUInt32(),u=n.pos()+l;let c=0;for(;n.pos()<u;)e.addLength(o,n.getUInt32(),c++);break}case 3:{const l=n.getUInt32(),u=n.pos()+l;let c=0;for(e.allocateCoordinates(o);n.pos()<u;)e.addCoordinate(o,n.getSInt64(),c),c++,c===a&&(c=0);break}default:n.skip()}return o}function EYe(t){const r=t.asUnsafe(),n=new lb;let o="esriGeometryPoint";for(;r.next();)switch(r.tag()){case 2:{const a=r.getUInt32(),l=r.pos()+a;for(;r.pos()<l;)n.lengths.push(r.getUInt32());break}case 3:{const a=r.getUInt32(),l=r.pos()+a;for(;r.pos()<l;)n.coords.push(r.getSInt64());break}case 1:o=S_e[r.getEnum()];break;default:r.skip()}return{queryGeometry:n,queryGeometryType:o}}function CYe(t){const c=t.asUnsafe();for(;c.next();)switch(c.tag()){case 1:return c.getString();case 2:return c.getFloat();case 3:return c.getDouble();case 4:return c.getSInt32();case 5:return c.getUInt32();case 6:return c.getInt64();case 7:return c.getUInt64();case 8:return c.getSInt64();case 9:return c.getBool();default:return c.skip(),null}return null}function PYe(t){const a=t.asUnsafe(),l={type:Yte(0)};for(;a.next();)switch(a.tag()){case 1:l.name=a.getString();break;case 2:l.type=Yte(a.getEnum());break;case 3:l.alias=a.getString();break;case 4:l.sqlType=xYe(a.getEnum());break;case 5:a.skip();break;case 6:l.defaultValue=a.getString();break;default:a.skip()}return l}function TYe(t){const i={},r=t.asUnsafe();for(;r.next();)switch(r.tag()){case 1:i.name=r.getString();break;case 2:i.isSystemMaintained=r.getBool();break;default:r.skip()}return i}function IYe(t,e,s,i){const a=e.createFeature(s);let l=0;for(;t.next();)switch(t.tag()){case 1:{const u=i[l++].name;a.attributes[u]=t.processMessage(CYe);break}case 2:a.geometry=t.processMessageWithArgs(SYe,e,s);break;case 4:a.centroid=t.processMessageWithArgs(wYe,e,s);break;default:t.skip()}return a}function MYe(t){const n=[1,1,1,1],o=t.asUnsafe();for(;o.next();)switch(o.tag()){case 1:n[0]=o.getDouble();break;case 2:n[1]=o.getDouble();break;case 4:n[2]=o.getDouble();break;case 3:n[3]=o.getDouble();break;default:o.skip()}return n}function AYe(t){const n=[0,0,0,0],o=t.asUnsafe();for(;o.next();)switch(o.tag()){case 1:n[0]=o.getDouble();break;case 2:n[1]=o.getDouble();break;case 4:n[2]=o.getDouble();break;case 3:n[3]=o.getDouble();break;default:o.skip()}return n}function NYe(t){const r={originPosition:Xte(0)},n=t.asUnsafe();for(;n.next();)switch(n.tag()){case 1:r.originPosition=Xte(n.getEnum());break;case 2:r.scale=n.processMessage(MYe);break;case 3:r.translate=n.processMessage(AYe);break;default:n.skip()}return r}function DYe(t){const r={},n=t.asUnsafe();for(;n.next();)switch(n.tag()){case 1:r.shapeAreaFieldName=n.getString();break;case 2:r.shapeLengthFieldName=n.getString();break;case 3:r.units=n.getString();break;default:n.skip()}return r}function $Ye(t,e){const a=e.createSpatialReference();for(;t.next();)switch(t.tag()){case 1:a.wkid=t.getUInt32();break;case 5:a.wkt=t.getString();break;case 2:a.latestWkid=t.getUInt32();break;case 3:a.vcsWkid=t.getUInt32();break;case 4:a.latestVcsWkid=t.getUInt32();break;default:t.skip()}return a}function RYe(t,e){const v=e.createFeatureResult(),b=t.asUnsafe();v.geometryType=Wte(e,0);let w=!1;for(;b.next();)switch(b.tag()){case 1:v.objectIdFieldName=b.getString();break;case 3:v.globalIdFieldName=b.getString();break;case 4:v.geohashFieldName=b.getString();break;case 5:v.geometryProperties=b.processMessage(DYe);break;case 7:v.geometryType=Wte(e,b.getEnum());break;case 8:v.spatialReference=b.processMessageWithArgs($Ye,e);break;case 10:v.hasZ=b.getBool();break;case 11:v.hasM=b.getBool();break;case 12:v.transform=b.processMessage(NYe);break;case 9:v.exceededTransferLimit=b.getBool();break;case 13:e.addField(v,b.processMessage(PYe));break;case 15:w||(e.prepareFeatures(v),w=!0),e.addFeature(v,b.processMessageWithArgs(IYe,e,v,v.fields));break;case 2:v.uniqueIdField=b.processMessage(TYe);break;default:b.skip()}return e.finishFeatureResult(v),v}function kYe(t,e){const r={};let n=null;for(;t.next();)switch(t.tag()){case 4:n=t.processMessageWithArgs(EYe);break;case 1:r.featureResult=t.processMessageWithArgs(RYe,e);break;default:t.skip()}return n!=null&&r.featureResult&&e.addQueryGeometry(r,n),r}function FYe(t,e){try{const i=new a8(new Uint8Array(t),new DataView(t)),r={};for(;i.next();)i.tag()===2?r.queryResult=i.processMessageWithArgs(kYe,e):i.skip();return r}catch(s){throw new ae("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:s})}}function OYe(t,e){const s=FYe(t,e),i=s.queryResult.featureResult,r=s.queryResult.queryGeometry,n=s.queryResult.queryGeometryType;if(i&&i.features&&i.features.length&&i.objectIdFieldName){const o=i.objectIdFieldName;for(const a of i.features)a.attributes&&(a.objectId=a.attributes[o])}return i&&(i.queryGeometry=r,i.queryGeometryType=n),i}function l8(t,e,s){if(!(s!=null&&s.features)||!s.hasZ)return;const i=kce(s.geometryType,e,t.outSpatialReference);if(i!=null)for(const r of s.features)i(r.geometry)}const Zte="Layer does not support extent calculation.";function LYe(t,e){if(e&&t.type==="extent")return`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`;if(e&&t.type==="point")return`${t.x},${t.y}`;const s=t.toJSON();return delete s.spatialReference,JSON.stringify(s)}function VYe(t,e){var l;const s=t.geometry,i=t.toJSON();delete i.compactGeometryEnabled,delete i.defaultSpatialReferenceEnabled;const r=i;let n,o,a;if(s!=null&&(o=s.spatialReference,a=BN(o),r.geometryType=YD(s),r.geometry=LYe(s,t.compactGeometryEnabled),r.inSR=a),i.groupByFieldsForStatistics&&(r.groupByFieldsForStatistics=i.groupByFieldsForStatistics.join(",")),i.objectIds&&(r.objectIds=i.objectIds.join(",")),i.orderByFields&&(r.orderByFields=i.orderByFields.join(",")),!i.outFields||!i.returnDistinctValues&&(e!=null&&e.returnCountOnly||e!=null&&e.returnExtentOnly||e!=null&&e.returnIdsOnly)?delete r.outFields:i.outFields.includes("*")?r.outFields="*":r.outFields=i.outFields.join(","),i.outSR?(r.outSR=BN(i.outSR),n=t.outSpatialReference):s&&(i.returnGeometry||i.returnCentroid)&&(r.outSR=r.inSR,n=o),i.returnGeometry&&delete i.returnGeometry,i.outStatistics&&(r.outStatistics=JSON.stringify(i.outStatistics)),i.fullText&&(r.fullText=JSON.stringify(i.fullText)),i.pixelSize&&(r.pixelSize=JSON.stringify(i.pixelSize)),i.quantizationParameters&&(t.defaultSpatialReferenceEnabled&&o!=null&&((l=t.quantizationParameters)==null?void 0:l.extent)!=null&&o.equals(t.quantizationParameters.extent.spatialReference)&&delete i.quantizationParameters.extent.spatialReference,r.quantizationParameters=JSON.stringify(i.quantizationParameters)),i.parameterValues&&(r.parameterValues=JSON.stringify(i.parameterValues)),i.rangeValues&&(r.rangeValues=JSON.stringify(i.rangeValues)),i.dynamicDataSource&&(r.layer=JSON.stringify({source:i.dynamicDataSource}),delete i.dynamicDataSource),i.timeExtent){const u=i.timeExtent,{start:c,end:h}=u;c==null&&h==null||(r.time=c===h?c:`${c??"null"},${h??"null"}`),delete i.timeExtent}return t.defaultSpatialReferenceEnabled&&o!=null&&n!=null&&o.equals(n)&&(r.defaultSR=r.inSR,delete r.inSR,delete r.outSR),r}async function qYe(t,e,s,i){const r=e.timeExtent!=null&&e.timeExtent.isEmpty?{data:{features:[]}}:await gP(t,e,"json",i);return l8(e,s,r.data),r}async function w1t(t,e,s,i){if(e.timeExtent!=null&&e.timeExtent.isEmpty)return{data:s.createFeatureResult()};const r=await GYe(t,e,i),n=r;return n.data=OYe(r.data,s),n}function GYe(t,e,s){return gP(t,e,"pbf",s)}function S1t(t,e,s){return e.timeExtent!=null&&e.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):gP(t,e,"json",s,{returnIdsOnly:!0})}function E1t(t,e,s){return e.timeExtent!=null&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):gP(t,e,"json",s,{returnIdsOnly:!0,returnCountOnly:!0})}async function C1t(t,e,s){if(e.timeExtent!=null&&e.timeExtent.isEmpty)return{data:{count:0,extent:null}};const i=await gP(t,e,"json",s,{returnExtentOnly:!0,returnCountOnly:!0}),r=i.data;if(r.hasOwnProperty("extent"))return i;if(r.features)throw new Error(Zte);if(r.hasOwnProperty("count"))throw new Error(Zte);return i}async function gP(t,e,s,i={},r={}){const n=typeof t=="string"?Sr(t):t,o=e.geometry?[e.geometry]:[],a=await Gde(o,null,{signal:i.signal}),l=a==null?void 0:a[0];l!=null&&((e=e.clone()).geometry=l);const u=__e({...n.query,f:s,...r,...VYe(e,r)});return js(L_(n.path,zYe(e,r)?"query3d":"query"),{...i,responseType:s==="pbf"?"array-buffer":"json",query:{...u,...i.query}})}function zYe(t,e){return t.formatOf3DObjects!=null&&!(e.returnCountOnly||e.returnExtentOnly||e.returnIdsOnly)}async function FO(t,e,s){const i=await UYe(t,e,s);return N$.fromJSON(i)}async function UYe(t,e,s){const i=Vde(t),r={...s},n=xn.from(e),{data:o}=await qYe(i,n,n.sourceSpatialReference,r);return o}const BYe="esri.widgets.Feature.support.relatedFeatureUtils",Qte=()=>Ne.getLogger(BYe),Jte=new Map;function HA(t){if(!Uh(t))return null;const[e,s]=t.split("/").slice(1);return{layerId:e,fieldName:s}}function jYe(t,e){if(!e.relationships)return null;let s=null;const{relationships:i}=e;return i.some(r=>r.id===parseInt(t,10)&&(s=r,!0)),s}function HYe({originRelationship:t,relationships:e,layerId:s}){return e.find(({relatedTableId:i,id:r})=>`${i}`===s&&r===(t==null?void 0:t.id))??null}function YYe(t,e){const s=e.toLowerCase();for(const i in t)if(i.toLowerCase()===s)return t[i];return null}function XYe(t,e){const s=jYe(t,e);if(s)return{url:`${e.url}/${s.relatedTableId}`,sourceSpatialReference:e.spatialReference,relation:s,relatedFields:[],outStatistics:[]}}function WYe(t,e){if(!e||!t)return;const{features:s,statsFeatures:i}=t,r=s==null?void 0:s.value;e.relatedFeatures=r?r.features:[];const n=i==null?void 0:i.value;e.relatedStatsFeatures=n?n.features:[]}function ZYe(t,e,s,i){var n;const r=new Rb;return r.outFields=["*"],r.relationshipId=typeof e.id=="number"?e.id:parseInt(e.id,10),r.objectIds=[t.attributes[s.objectIdField]],r.gdbVersion=s.gdbVersion??null,r.historicMoment=s.historicMoment??null,((n=s.queryRelatedFeatures)==null?void 0:n.call(s,r,i))??Promise.resolve({})}function QYe(t,e,s){let i=0;const r=[];for(;i<e.length;)r.push(`${t} IN (${e.slice(i,s+i)})`),i+=s;return r.join(" OR ")}function JYe(t){return t?nz(t):void 0}function KYe(t){return t?nz(t,(e,s)=>JSON.stringify(e.toJSON())===JSON.stringify(s.toJSON())):void 0}async function eXe(t,e,s,i){const r=s.layerId.toString(),{layerInfo:n,relation:o,relatedFields:a,outStatistics:l,url:u,sourceSpatialReference:c}=e,h=JYe(a),m=KYe(l);if(!n||!o)return null;const f=HYe({originRelationship:o,relationships:n.relationships,layerId:r});if(f!=null&&f.relationshipTableId&&f.keyFieldInRelationshipTable){const v=(await ZYe(t,f,s,i))[t.attributes[s.objectIdField]];if(!v)return null;const b=v.features.map(w=>w.attributes[n.objectIdField]);if(m!=null&&m.length&&n.supportsStatistics){const w=new xn;w.where=QYe(n.objectIdField,b,1e3),w.outFields=h,w.outStatistics=m,w.sourceSpatialReference=c;const S={features:Promise.resolve(v),statsFeatures:FO(u,w)};return Pd(S)}}const g=f==null?void 0:f.keyField;if(g){const v=N7(nXe(n.fields,g)),b=YYe(t.attributes,o.keyField),w=v?`${g}=${b}`:`${g}='${b}'`,S=s.historicMoment,T=s.gdbVersion,P=FO(u,new xn({where:w,outFields:h,sourceSpatialReference:c,historicMoment:S,gdbVersion:T}),i),I=m!=null&&m.length&&n.supportsStatistics?FO(u,new xn({where:w,outFields:h,outStatistics:m,sourceSpatialReference:c}),i):null,A={features:P};return I&&(A.statsFeatures=I),Pd(A)}return null}function tXe(t,e){return js(t,{query:{f:"json"},signal:e==null?void 0:e.signal})}function sXe({relatedInfos:t,layer:e},s){const i={};return t.forEach((r,n)=>{const{relation:o}=r;if(!o){const h=new ae("relation-required","A relation is required on a layer to retrieve related records.");throw Qte().error(h),h}const{relatedTableId:a}=o;if(typeof a!="number"){const h=new ae("A related table ID is required on a layer to retrieve related records.");throw Qte().error(h),h}const l=`${e.url}/${a}`,u=Jte.get(l),c=u??tXe(l);u||Jte.set(l,c),i[n]=c}),_z(Pd(i),s)}function iXe({graphic:t,relatedInfos:e,layer:s},i){const r={};return e.forEach((n,o)=>{n.layerInfo&&(r[o]=eXe(t,n,s,i))}),Pd(r)}function rXe({relatedInfo:t,fieldName:e,fieldInfo:s}){var i,r;if((i=t.relatedFields)==null||i.push(e),s.statisticType){const n=new lde({statisticType:s.statisticType,onStatisticField:e,outStatisticFieldName:e});(r=t.outStatistics)==null||r.push(n)}}function nXe(t,e){if(t!=null){e=e.toLowerCase();for(const s of t)if(s&&s.name.toLowerCase()===e)return s}return null}const Kte={chartAnimation:!0};let Xr=class extends Ye{constructor(e){super(e),this.abilities={...Kte},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.isAggregate=!1,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...Kte,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:s}=this,i=(e+s)%s;this.activeMediaInfoIndex=i}_pageContentElementMedia(e){const{activeMediaInfoIndex:s}=this,i=s+e;this._setContentElementMedia(i)}_formatMediaInfos(){const{mediaInfos:e,layer:s}=this,i=this.attributes??{},r=this.formattedAttributes??{},n=this.expressionAttributes??{},o=this.fieldInfoMap??new Map;return(e==null?void 0:e.map(a=>{const l=a==null?void 0:a.clone();return l?(l.title=Rf({attributes:i,fieldInfoMap:o,globalAttributes:r,expressionAttributes:n,layer:s,text:l.title}),l.caption=Rf({attributes:i,fieldInfoMap:o,globalAttributes:r,expressionAttributes:n,layer:s,text:l.caption}),l.altText=Rf({attributes:i,fieldInfoMap:o,globalAttributes:r,expressionAttributes:n,layer:s,text:l.altText}),l.type==="image"?l.value?(this._setImageValue({value:l.value,formattedAttributes:r,layer:s}),l.value.sourceURL?l:void 0):void 0:l.type==="pie-chart"||l.type==="line-chart"||l.type==="column-chart"||l.type==="bar-chart"?l.value?(this._setChartValue({value:l.value,chartType:l.type,attributes:i,formattedAttributes:r,layer:s,expressionAttributes:n}),l):void 0:null):null}).filter(Qa))??[]}_setImageValue(e){const s=this.fieldInfoMap??new Map,{value:i,formattedAttributes:r,layer:n}=e,{linkURL:o,sourceURL:a}=i;if(a){const l=L3(a,n);i.sourceURL=O3({formattedAttributes:r,template:l,fieldInfoMap:s})}if(o){const l=L3(o,n);i.linkURL=O3({formattedAttributes:r,template:l,fieldInfoMap:s})}}_setChartValue(e){const{value:s,attributes:i,formattedAttributes:r,chartType:n,layer:o,expressionAttributes:a}=e,{popupTemplate:l,relatedInfos:u}=this,{fields:c,normalizeField:h}=s,m=o;if(s.fields=Uye(c,m),h&&(s.normalizeField=kb(h,m)),!c.some(g=>!!(r[g]!=null||Uh(g)&&(u!=null&&u.size))))return;const f=(l==null?void 0:l.fieldInfos)??[];c.forEach((g,v)=>{var S;const b=(S=s.colors)==null?void 0:S[v];if(Uh(g))return void(s.series=[...s.series,...this._getRelatedChartInfos({fieldInfos:f,fieldName:g,formattedAttributes:r,chartType:n,value:s,color:b})]);const w=this._getChartOption({value:s,attributes:i,chartType:n,formattedAttributes:r,expressionAttributes:a,fieldName:g,fieldInfos:f,color:b});s.series.push(w)})}_getRelatedChartInfos(e){var g;const{fieldInfos:s,fieldName:i,formattedAttributes:r,chartType:n,value:o,color:a}=e,l=[],u=HA(i),c=u&&((g=this.relatedInfos)==null?void 0:g.get(u.layerId.toString()));if(!c)return l;const{relatedFeatures:h,relation:m}=c;if(!m||!h)return l;const{cardinality:f}=m;return h.forEach(v=>{const{attributes:b}=v;b&&Object.keys(b).forEach(w=>{w===u.fieldName&&l.push(this._getChartOption({value:o,attributes:b,formattedAttributes:r,fieldName:i,chartType:n,relatedFieldName:w,hasMultipleRelatedFeatures:(h==null?void 0:h.length)>1,fieldInfos:s,color:a}))})}),f==="one-to-many"||f==="many-to-many"?l:[l[0]]}_getTooltip({label:e,value:s,chartType:i}){return i==="pie-chart"?`${e}`:`${e}: ${s}`}_getChartOption(e){var D;const{value:s,attributes:i,formattedAttributes:r,expressionAttributes:n,fieldName:o,relatedFieldName:a,fieldInfos:l,chartType:u,hasMultipleRelatedFeatures:c,color:h}=e,m=this.layer,f=this.fieldInfoMap??new Map,{normalizeField:g,tooltipField:v}=s,b=g?Uh(g)?i[HA(g).fieldName]:i[g]:null,w=H$(o)&&n&&n[o]!==void 0?n[o]:a&&i[a]!==void 0?i[a]:i[o]!==void 0?i[o]:r[o],S=new gme({fieldName:o,color:h,value:w===void 0?null:w&&b?w/b:w});if(Uh(o)){const k=f.get(o.toLowerCase()),R=v&&f.get(v.toLowerCase()),O=(k==null?void 0:k.fieldName)??o,z=c&&v?HA(v).fieldName:(R==null?void 0:R.fieldName)??v,q=c&&z?i[z]:r[z]??(k==null?void 0:k.label)??(k==null?void 0:k.fieldName)??a,U=c&&a?i[a]:r[O];return S.tooltip=this._getTooltip({label:q,value:U,chartType:u}),S}const T=XU(l,o),P=kb(o,m),I=v&&r[v]!==void 0?r[v]:HU(T||new QC({fieldName:P}),(D=this.popupTemplate)==null?void 0:D.expressionInfos),A=r[P];return S.tooltip=this._getTooltip({label:I,value:A,chartType:u}),S}};p([_()],Xr.prototype,"abilities",void 0),p([Ht("abilities")],Xr.prototype,"castAbilities",null),p([_()],Xr.prototype,"activeMediaInfoIndex",void 0),p([_({readOnly:!0})],Xr.prototype,"activeMediaInfo",null),p([_()],Xr.prototype,"attributes",void 0),p([_()],Xr.prototype,"description",void 0),p([_()],Xr.prototype,"fieldInfoMap",void 0),p([_()],Xr.prototype,"formattedAttributes",void 0),p([_()],Xr.prototype,"expressionAttributes",void 0),p([_({readOnly:!0})],Xr.prototype,"formattedMediaInfos",null),p([_()],Xr.prototype,"isAggregate",void 0),p([_()],Xr.prototype,"layer",void 0),p([_({readOnly:!0})],Xr.prototype,"formattedMediaInfoCount",null),p([_()],Xr.prototype,"mediaInfos",void 0),p([_()],Xr.prototype,"popupTemplate",void 0),p([_()],Xr.prototype,"relatedInfos",void 0),p([_()],Xr.prototype,"title",void 0),Xr=p([Q("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],Xr);const d_=Xr,Aa="esri-feature-media",Zo={base:Aa,mediaContainer:`${Aa}__container`,mediaItemContainer:`${Aa}__item-container`,mediaItem:`${Aa}__item`,mediaItemText:`${Aa}__item-text`,mediaItemTitle:`${Aa}__item-title`,mediaItemCaption:`${Aa}__item-caption`,mediaNavigation:`${Aa}__item-navigation`,mediaPagination:`${Aa}__pagination`,mediaPaginationText:`${Aa}__pagination-text`,mediaChart:`${Aa}__chart`,mediaPaginationButton:`${Aa}__pagination-button`,mediaPaginationIcon:`${Aa}__pagination-icon`,mediaChartRendered:`${Aa}__chart--rendered`},OO=15,Ip="category",i2="value",oXe="rgba(50, 50, 50, 1)",aXe=250,lXe=500,uXe=200;let ra=class extends Er{constructor(e,s){super(e,s),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this._chartRootMap=new WeakMap,this.viewModel=new d_,this.messages=null,this._disposeChart=i=>{var r;(r=this._chartRootMap.get(i))==null||r.dispose(),this._chartRootMap.delete(i)},this._createChart=async i=>{const{destroyed:r,viewModel:n}=this;if(r||!n||!i)return;const{createRoot:o}=await me(()=>import("./chartUtilsAm5-C2Mcp1lS.js"),__vite__mapDeps([286,287,288,289])),a=await o(i);this._chartRootMap.set(i,a),this._renderChart({mediaInfo:n.activeMediaInfo,root:a})}}initialize(){this._featureElementInfo=new fP,this.addHandles([Ee(()=>{var e,s;return[(e=this.viewModel)==null?void 0:e.activeMediaInfo,(s=this.viewModel)==null?void 0:s.activeMediaInfoIndex]},()=>this._setupMediaRefreshTimer(),ht),Ee(()=>{var e,s;return[(e=this.viewModel)==null?void 0:e.description,(s=this.viewModel)==null?void 0:s.title]},()=>this._setupFeatureElementInfo(),ht)])}loadDependencies(){return sl({icon:()=>me(()=>import("./index-BhFhNIYS.js").then(e=>e.i),__vite__mapDeps([243,244,241,245]))})}destroy(){var e;this._clearMediaRefreshTimer(),(e=this._featureElementInfo)==null||e.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return K("div",{bind:this,class:Zo.base,onkeyup:this._handleMediaKeyup},(e=this._featureElementInfo)==null?void 0:e.render(),this._renderMedia())}_renderMedia(){const{formattedMediaInfoCount:e,activeMediaInfoIndex:s}=this.viewModel,i=this._renderMediaText();return e?K("div",{class:Zo.mediaContainer,key:"media-element-container"},this._renderMediaInfo(),K("div",{class:Zo.mediaNavigation},i,e>1?K("div",{class:Zo.mediaPagination},this._renderMediaPageButton("previous"),K("span",{class:Zo.mediaPaginationText},Nu(this.messages.pageText,{index:s+1,total:e})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const s=e&&e.title?K("div",{class:Zo.mediaItemTitle,innerHTML:e.title,key:"media-title"}):null,i=e&&e.caption?K("div",{class:Zo.mediaItemCaption,innerHTML:e.caption,key:"media-caption"}):null;return s||i?K("div",{class:Zo.mediaItemText,key:"media-text"},s,i):null}_renderImageMediaInfo(e){if(!e.value)return null;const{_refreshIntervalInfo:s}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:r}=this.viewModel,{value:n,refreshInterval:o,altText:a,title:l,type:u}=e,{sourceURL:c,linkURL:h}=n,m=jU(h??void 0)?"_blank":"_self",f=m==="_blank"?"noreferrer":"",g=o?s:null,v=g?g.timestamp:0,b=g?g.sourceURL:c,w=K("img",{alt:a||l,key:`media-${u}-${i}-${r}-${v}`,src:b??void 0});return(h?K("a",{href:h,rel:f,target:m,title:l},w):null)??w}_renderChartMediaInfo(e){const{activeMediaInfoIndex:s,formattedMediaInfoCount:i}=this.viewModel;return K("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:Zo.mediaChart,key:`media-${e.type}-${s}-${i}`})}_renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?e.type==="image"?this._renderImageMediaInfo(e):e.type.includes("chart")?this._renderChartMediaInfo(e):null:null}_renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;return e?K("div",{class:Zo.mediaItemContainer,key:"media-container"},K("div",{class:Zo.mediaItem,key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const s=e==="previous",i=s?this.messages.previous:this.messages.next,r=s?"chevron-left":"chevron-right",n=s?"media-previous":"media-next",o=s?this._previous:this._next;return K("button",{"aria-label":i,bind:this,class:Zo.mediaPaginationButton,key:n,onclick:o,tabIndex:0,title:i,type:"button"},K("calcite-icon",{class:Zo.mediaPaginationIcon,icon:r,scale:"s"}))}_setupFeatureElementInfo(){var i;const{description:e,title:s}=this;(i=this._featureElementInfo)==null||i.set({description:e,title:s})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(!this.viewModel)return;const{isAggregate:e,layer:s}=this.viewModel;return e&&(s!=null&&s.featureReduction)&&"renderer"in s.featureReduction?s.featureReduction.renderer:s==null?void 0:s.renderer}async _getSeriesColors(e){const{colorAm5:s}=await me(()=>import("./chartCommon-JC0g-oLb.js"),__vite__mapDeps([290,287,291,288,292])),i=new Map;return e.forEach(r=>{r.color&&i.set(r,s(r.color.toCss(!0)))}),i}async _getRendererColors(){const{colorAm5:e}=await me(()=>import("./chartCommon-JC0g-oLb.js"),__vite__mapDeps([290,287,291,288,292])),s=new Map,i=this._getRenderer(),r="default";if(!i)return s;const n=await sYe(i);return n.delete(r),Array.from(n.values()).every(o=>(o==null?void 0:o.length)===1)&&Array.from(n.keys()).forEach(o=>{var l,u;const a=(u=(l=n.get(o))==null?void 0:l[0])==null?void 0:u.toCss(!0);a&&s.set(o,e(a))}),s}_handleMediaKeyup(e){const{key:s}=e;s==="ArrowLeft"&&(e.stopPropagation(),this.viewModel.previous()),s==="ArrowRight"&&(e.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return!!this.viewModel&&!!this.viewModel.abilities.chartAnimation&&!X7()}_getChartAnimationMS(){return this._canAnimateChart()?aXe:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?lXe:0}async _renderChart(e){const{root:s,mediaInfo:i}=e,{value:r,type:n}=i,{ResponsiveThemeAm5:o,DarkThemeAm5:a,AnimatedThemeAm5:l,ColorSetAm5:u,ThemeAm5:c,esriChartColorSet:h}=await me(async()=>{const{ResponsiveThemeAm5:P,DarkThemeAm5:I,AnimatedThemeAm5:A,ColorSetAm5:D,ThemeAm5:k,esriChartColorSet:R}=await import("./chartCommon-JC0g-oLb.js");return{ResponsiveThemeAm5:P,DarkThemeAm5:I,AnimatedThemeAm5:A,ColorSetAm5:D,ThemeAm5:k,esriChartColorSet:R}},__vite__mapDeps([290,287,291,288,292])),m=c.new(s);m.rule("ColorSet").set("colors",h),m.rule("ColorSet").set("reuse",!0);const f=[o.new(s),m];ofe()&&f.push(a.new(s)),this._canAnimateChart()&&f.push(l.new(s)),s.setThemes(f);const g=await this._getRendererColors(),v=await this._getSeriesColors(r.series),b=u.new(s,{}),w=v.get(r.series[0]),S=w?{lineSettings:{stroke:w}}:void 0,T=r.series.map((P,I)=>{const A=v.get(P)||g.get(P.fieldName)||b.getIndex(I);return{[Ip]:P.tooltip,[i2]:P.value,columnSettings:{fill:A,stroke:A},...S}}).filter(P=>n!=="pie-chart"||P.value!=null&&P.value>0);n==="pie-chart"?this._createPieChart(e,T):this._createXYChart(e,T)}_getDirection(){return zh(this.container)?"rtl":"ltr"}async _customizeChartTooltip(e,s="horizontal"){var r;const{colorAm5:i}=await me(()=>import("./chartCommon-JC0g-oLb.js"),__vite__mapDeps([290,287,291,288,292]));e.setAll({pointerOrientation:s}),(r=e.get("background"))==null||r.setAll({stroke:i(oXe)}),e.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:uXe})}async _createPieChart(e,s){const{TooltipAm5:i}=await me(()=>import("./chartCommon-JC0g-oLb.js"),__vite__mapDeps([290,287,291,288,292])),{PieChartAm5:r,PieSeriesAm5:n}=await me(async()=>{const{PieChartAm5:v,PieSeriesAm5:b}=await import("./pieChart-B2qSgNYE.js");return{PieChartAm5:v,PieSeriesAm5:b}},__vite__mapDeps([293,294,287,292,289])),{mediaInfo:o,root:a}=e,{title:l}=o,u=5,c=(o==null?void 0:o.altText)||(o==null?void 0:o.title)||"",h=a.container.children.push(r.new(a,{ariaLabel:c,focusable:!0,paddingBottom:u,paddingTop:u,paddingLeft:u,paddingRight:u})),m=`{category}: {valuePercentTotal.formatNumber('0.00')}%
 ({value})`,f=i.new(a,{labelText:m}),g=h.series.push(n.new(a,{name:l,valueField:i2,categoryField:Ip,tooltip:f}));g.ticks.template.set("forceHidden",!0),g.labels.template.set("forceHidden",!0),g.slices.template.states.create("active",{shiftRadius:u}),this._customizeChartTooltip(f),g.slices.template.setAll({ariaLabel:m,focusable:!0,templateField:"columnSettings"}),g.data.setAll(s),g.appear(this._getChartSeriesAnimationMS()),h.appear(this._getChartAnimationMS()),h.root.dom.classList.toggle(Zo.mediaChartRendered,!0)}_getMinSeriesValue(e){let s=0;return e.forEach(i=>s=Math.min(i.value,s)),s}async _createColumnChart(e,s,i){const{TooltipAm5:r,ScrollbarAm5:n}=await me(()=>import("./chartCommon-JC0g-oLb.js"),__vite__mapDeps([290,287,291,288,292])),{CategoryAxisAm5:o,AxisRendererXAm5:a,ValueAxisAm5:l,AxisRendererYAm5:u,ColumnSeriesAm5:c}=await me(async()=>{const{CategoryAxisAm5:P,AxisRendererXAm5:I,ValueAxisAm5:A,AxisRendererYAm5:D,ColumnSeriesAm5:k}=await import("./xyChart-FeZuWO7X.js");return{CategoryAxisAm5:P,AxisRendererXAm5:I,ValueAxisAm5:A,AxisRendererYAm5:D,ColumnSeriesAm5:k}},__vite__mapDeps([295,287,292,289,294,291])),{mediaInfo:h,root:m}=s,{value:f,title:g}=h;e.setAll({wheelX:"panX",wheelY:"zoomX"});const v=e.xAxes.push(o.new(m,{renderer:a.new(m,{inversed:zh(this.container)}),categoryField:Ip}));v.get("renderer").labels.template.setAll({forceHidden:!0});const b=e.yAxes.push(l.new(m,{renderer:u.new(m,{inside:!1}),min:this._getMinSeriesValue(f.series)}));b.get("renderer").labels.template.setAll({direction:this._getDirection()});const w="{categoryX}",S=r.new(m,{labelText:w}),T=e.series.push(c.new(m,{name:g,xAxis:v,yAxis:b,valueYField:i2,categoryXField:Ip,tooltip:S}));this._customizeChartTooltip(S),T.columns.template.setAll({ariaLabel:w,focusable:!0,templateField:"columnSettings"}),f.series.length>OO&&e.set("scrollbarX",n.new(m,{orientation:"horizontal"})),v.data.setAll(i),T.data.setAll(i),T.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createBarChart(e,s,i){const{TooltipAm5:r,ScrollbarAm5:n}=await me(()=>import("./chartCommon-JC0g-oLb.js"),__vite__mapDeps([290,287,291,288,292])),{CategoryAxisAm5:o,AxisRendererXAm5:a,ValueAxisAm5:l,AxisRendererYAm5:u,ColumnSeriesAm5:c}=await me(async()=>{const{CategoryAxisAm5:P,AxisRendererXAm5:I,ValueAxisAm5:A,AxisRendererYAm5:D,ColumnSeriesAm5:k}=await import("./xyChart-FeZuWO7X.js");return{CategoryAxisAm5:P,AxisRendererXAm5:I,ValueAxisAm5:A,AxisRendererYAm5:D,ColumnSeriesAm5:k}},__vite__mapDeps([295,287,292,289,294,291])),{mediaInfo:h,root:m}=s,{value:f,title:g}=h;e.setAll({wheelX:"panY",wheelY:"zoomY"});const v=e.yAxes.push(o.new(m,{renderer:u.new(m,{inversed:!0}),categoryField:Ip}));v.get("renderer").labels.template.setAll({forceHidden:!0});const b=e.xAxes.push(l.new(m,{renderer:a.new(m,{inside:!1,inversed:zh(this.container)}),min:this._getMinSeriesValue(f.series)}));b.get("renderer").labels.template.setAll({direction:this._getDirection()});const w="{categoryY}",S=r.new(m,{labelText:w}),T=e.series.push(c.new(m,{name:g,xAxis:b,yAxis:v,valueXField:i2,categoryYField:Ip,tooltip:S}));this._customizeChartTooltip(S,"vertical"),T.columns.template.setAll({ariaLabel:w,focusable:!0,templateField:"columnSettings"}),f.series.length>OO&&e.set("scrollbarY",n.new(m,{orientation:"vertical"})),v.data.setAll(i),T.data.setAll(i),T.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createLineChart(e,s,i){var I,A,D;const{TooltipAm5:r,ScrollbarAm5:n}=await me(()=>import("./chartCommon-JC0g-oLb.js"),__vite__mapDeps([290,287,291,288,292])),{CategoryAxisAm5:o,AxisRendererXAm5:a,ValueAxisAm5:l,AxisRendererYAm5:u,LineSeriesAm5:c}=await me(async()=>{const{CategoryAxisAm5:k,AxisRendererXAm5:R,ValueAxisAm5:O,AxisRendererYAm5:z,LineSeriesAm5:q}=await import("./xyChart-FeZuWO7X.js");return{CategoryAxisAm5:k,AxisRendererXAm5:R,ValueAxisAm5:O,AxisRendererYAm5:z,LineSeriesAm5:q}},__vite__mapDeps([295,287,292,289,294,291])),{root:h,mediaInfo:m}=s,{value:f,title:g}=m;e.setAll({wheelX:"panX",wheelY:"zoomX"});const v=e.xAxes.push(o.new(h,{renderer:a.new(h,{inversed:zh(this.container)}),categoryField:Ip}));v.get("renderer").labels.template.setAll({forceHidden:!0});const b=e.yAxes.push(l.new(h,{renderer:u.new(h,{inside:!1}),min:this._getMinSeriesValue(f.series)}));b.get("renderer").labels.template.setAll({direction:this._getDirection()});const w="{categoryX}",S=(A=(I=i[0])==null?void 0:I.lineSettings)==null?void 0:A.stroke,T=r.new(h,{getFillFromSprite:!S,labelText:w});S&&((D=T.get("background"))==null||D.setAll({fill:S}));const P=e.series.push(c.new(h,{name:g,xAxis:v,yAxis:b,valueYField:i2,categoryXField:Ip,tooltip:T}));P.strokes.template.setAll({templateField:"lineSettings"}),this._customizeChartTooltip(T,"vertical"),f.series.length>OO&&e.set("scrollbarX",n.new(h,{orientation:"horizontal"})),v.data.setAll(i),P.data.setAll(i),P.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createXYChart(e,s){const{XYChartAm5:i,XYCursorAm5:r}=await me(()=>import("./xyChart-FeZuWO7X.js"),__vite__mapDeps([295,287,292,289,294,291])),{root:n,mediaInfo:o}=e,{type:a}=o,l=(o==null?void 0:o.altText)||(o==null?void 0:o.title)||"",u=n.container.children.push(i.new(n,{ariaLabel:l,focusable:!0,panX:!0,panY:!0}));u.set("cursor",r.new(n,{})),a==="column-chart"&&await this._createColumnChart(u,e,s),a==="bar-chart"&&await this._createBarChart(u,e,s),a==="line-chart"&&await this._createLineChart(u,e,s),u.root.dom.classList.toggle(Zo.mediaChartRendered,!0)}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const s=Date.now();this._refreshIntervalInfo={timestamp:s,sourceURL:e&&this._getImageSource(e,s)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;(e==null?void 0:e.type)==="image"&&(e==null?void 0:e.refreshInterval)>0&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:s,value:i}=e,r=6e4*s;this._updateMediaInfoTimestamp(i.sourceURL);const n=setInterval(()=>{this._updateMediaInfoTimestamp(i.sourceURL)},r);this._refreshTimer=n}_getImageSource(e,s){const i=e.includes("?")?"&":"?",[r,n=""]=e.split("#");return`${r}${i}timestamp=${s}${n?"#":""}${n}`}};p([_()],ra.prototype,"_refreshIntervalInfo",void 0),p([_()],ra.prototype,"attributes",null),p([_()],ra.prototype,"activeMediaInfoIndex",null),p([_()],ra.prototype,"description",null),p([_()],ra.prototype,"fieldInfoMap",null),p([_()],ra.prototype,"layer",null),p([_()],ra.prototype,"mediaInfos",null),p([_()],ra.prototype,"popupTemplate",null),p([_()],ra.prototype,"relatedInfos",null),p([_()],ra.prototype,"title",null),p([_({type:d_})],ra.prototype,"viewModel",void 0),p([_(),ur("esri/widgets/Feature/t9n/Feature")],ra.prototype,"messages",void 0),ra=p([Q("esri.widgets.Feature.FeatureMedia")],ra);const E_e=ra;function ese(t){t=t.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let e="";const s=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const i of t.match(s)||[])switch(i){case"D":e+="d";break;case"DD":e+="dd";break;case"DDD":e+="o";break;case"d":e+="c";break;case"ddd":e+="ccc";break;case"dddd":e+="cccc";break;case"M":e+="L";break;case"MM":e+="LL";break;case"MMM":e+="LLL";break;case"MMMM":e+="LLLL";break;case"YY":e+="yy";break;case"Y":case"YYYY":e+="yyyy";break;case"Q":e+="q";break;case"X":case"x":e+=i;break;default:i.length>=2&&i.slice(0,1)==="["&&i.slice(-1)==="]"?e+=`'${i.slice(1,-1)}'`:e+=`'${i}'`}return e}const tse="esri.core.sql.dateonly";let cXe=class Cl{constructor(e,s,i){this._year=e,this._month=s,this._day=i,this.declaredRootClass=tse}static isDateOnly(e){return typeof e=="object"&&e!=null&&"declaredRootClass"in e&&e.declaredRootClass===tse}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return Cl.isDateOnly(e)&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new Cl(this._year,this._month,this._day)}toDateTime(e){return Je.fromObject({day:this.day,month:this.month,year:this.year},{zone:Fh(e)})}toDateTimeLuxon(e){return Je.fromObject({day:this.day,month:this.month,year:this.year},{zone:Fh(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=null,s=!0){if(e===null||e==="")return this.toString();if(s&&(e=ese(e)),!e)return"";const i=this.toDateTime("unknown");return u_.dateTimeToArcadeDate(i).toFormat(e,{locale:Lo(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return u_.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(e,s){return Cl.fromDateTime(this.toUTCDateTime().plus({[e]:s}))}toUTCDateTime(){return Je.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,s){switch(s.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return s==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}static fromMilliseconds(e){const s=Je.fromMillis(e,{zone:en.utcInstance});return s.isValid?Cl.fromParts(s.year,s.month,s.day):null}static fromSeconds(e){const s=Je.fromSeconds(e,{zone:en.utcInstance});return s.isValid?Cl.fromParts(s.year,s.month,s.day):null}static fromReader(e){if(!e)return null;const s=e.split("-");return s.length!==3?null:new Cl(parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10))}static fromParts(e,s,i){const r=new Cl(e,s,i);return r.isValid===!1?null:r}static fromDateJS(e){return Cl.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return Cl.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,s=null){if(e===""||e===null)return null;const i=[];if(s)(s=ese(s))&&i.push(s);else if(s===null||s===""){const r=Je.fromISO(e,{setZone:!0});return r.isValid?Cl.fromParts(r.year,r.month,r.day):null}for(const r of i){const n=Je.fromFormat(e,s??r);if(n.isValid)return new Cl(n.year,n.month,n.day)}return null}static fromNow(e="system"){const s=Je.fromJSDate(new Date).setZone(Fh(e));return new Cl(s.year,s.month,s.day)}};function I1t(t){if(t==null)return null;switch(t.type){case"polygon":case"multipoint":case"polyline":return t.extent;case"point":return new Hs({xmin:t.x,ymin:t.y,xmax:t.x,ymax:t.y,spatialReference:t.spatialReference});case"extent":return t}return null}function M1t(t){if(t==null)return null;const e=t.clone();return t.cache._geVersion!==void 0&&(e.cache._geVersion=t.cache._geVersion),e}function YI(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function sse(t){if(!t)return"";const e=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let s="";for(const i of t.match(e)||[])switch(i){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":s+=i;break;case"A":case"a":s+="a";break;default:s+=`'${i}'`}return s}const ise="esri.core.sql.timeonly";let hXe=class Ih{constructor(e,s,i,r){this._hour=e,this._minute=s,this._second=i,this._millisecond=r,this.declaredRootClass=ise}static isTimeOnly(e){return typeof e=="object"&&e!=null&&"declaredRootClass"in e&&e.declaredRootClass===ise}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return Ih.isTimeOnly(e)&&e.hour===this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new Ih(this.hour,this.minute,this.second,this.millisecond)}isValid(){return YI(this.hour)&&YI(this.minute)&&YI(this.second)&&YI(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(e=null){return e===null||e===""?this.toString():(e=sse(e))?Je.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:Lo(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(e,s,i,r){const n=new Ih(e,s,i,r);return n.isValid()?n:null}static fromReader(e){if(!e)return null;const s=e.split(":");return s.length!==3?null:new Ih(parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10),0)}static fromMilliseconds(e){if(e>864e5||e<0)return null;const s=Math.floor(e/1e3%60),i=Math.floor(e/6e4%60),r=Math.floor(e/36e5%24),n=Math.floor(e%1e3);return new Ih(r,i,s,n)}static fromDateJS(e){return new Ih(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new Ih(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,s=null){if(e===""||e===null)return null;const i=[];s?(s=sse(s))&&i.push(s):s!==null&&s!==""||(i.push("HH:mm:ss"),i.push("HH:mm:ss.SSS"),i.push("hh:mm:ss a"),i.push("hh:mm:ss.SSS a"),i.push("HH:mm"),i.push("hh:mm a"),i.push("H:mm"),i.push("h:mm a"),i.push("H:mm:ss"),i.push("h:mm:ss a"),i.push("H:mm:ss.SSS"),i.push("h:mm:ss.SSS a"));for(const r of i){const n=Je.fromFormat(e,r);if(n.isValid)return new Ih(n.hour,n.minute,n.second,n.millisecond)}return null}plus(e,s){switch(e){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return Ih.fromDateTime(this.toUTCDateTime().plus({[e]:s}))}return null}toUTCDateTime(){return Je.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,s){switch(s.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return s==="M"?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}};var rse,nse;function A1t(t){return oP.fromJSON(t.toJSON())}function N1t(t){return t.toJSON?t.toJSON():t}function D1t(t){return t instanceof Date}function $1t(t){return t instanceof Je}function R1t(t){return t instanceof u_}function k1t(t){return t instanceof cXe}function F1t(t){return t instanceof hXe}(function(t){t[t.Standardised=0]="Standardised",t[t.StandardisedNoInterval=1]="StandardisedNoInterval",t[t.SqlServer=2]="SqlServer",t[t.Oracle=3]="Oracle",t[t.Postgres=4]="Postgres",t[t.PGDB=5]="PGDB",t[t.FILEGDB=6]="FILEGDB",t[t.NotEvaluated=7]="NotEvaluated"})(rse||(rse={})),function(t){t[t.InFeatureSet=0]="InFeatureSet",t[t.NotInFeatureSet=1]="NotInFeatureSet",t[t.Unknown=2]="Unknown"}(nse||(nse={}));const O1t=1e3,L1t={point:"point"},V1t={point:"esriGeometryPoint",polygon:"esriGeometryPolygon",polyline:"esriGeometryPolyline",multipoint:"esriGeometryMultipoint",extent:"esriGeometryEnvelope",esriGeometryPoint:"esriGeometryPoint",esriGeometryPolygon:"esriGeometryPolygon",esriGeometryPolyline:"esriGeometryPolyline",esriGeometryMultipoint:"esriGeometryMultipoint",esriGeometryEnvelope:"esriGeometryEnvelope",envelope:"esriGeometryEnvelope"},q1t={"small-integer":"esriFieldTypeSmallInteger",integer:"esriFieldTypeInteger",long:"esriFieldTypeLong",single:"esriFieldTypeSingle",double:"esriFieldTypeDouble",string:"esriFieldTypeString",date:"esriFieldTypeDate","date-only":"esriFieldTypeDateOnly","time-only":"esriFieldTypeTimeOnly","timestamp-offset":"esriFieldTypeTimestampOffset",oid:"esriFieldTypeOID",geometry:"esriFieldTypeGeometry",blob:"esriFieldTypeBlob",raster:"esriFieldTypeRaster",guid:"esriFieldTypeGUID","global-id":"esriFieldTypeGlobalID",xml:"esriFieldTypeXML","big-integer":"esriFieldTypeBigInteger",esriFieldTypeSmallInteger:"esriFieldTypeSmallInteger",esriFieldTypeInteger:"esriFieldTypeInteger",esriFieldTypeLong:"esriFieldTypeLong",esriFieldTypeSingle:"esriFieldTypeSingle",esriFieldTypeDouble:"esriFieldTypeDouble",esriFieldTypeString:"esriFieldTypeString",esriFieldTypeDate:"esriFieldTypeDate",esriFieldTypeDateOnly:"esriFieldTypeDateOnly",esriFieldTypeTimeOnly:"esriFieldTypeTimeOnly",esriFieldTypeTimestampOffset:"esriFieldTypeTimestampOffset",esriFieldTypeOID:"esriFieldTypeOID",esriFieldTypeGeometry:"esriFieldTypeGeometry",esriFieldTypeBlob:"esriFieldTypeBlob",esriFieldTypeRaster:"esriFieldTypeRaster",esriFieldTypeGUID:"esriFieldTypeGUID",esriFieldTypeGlobalID:"esriFieldTypeGlobalID",esriFieldTypeXML:"esriFieldTypeXML",esriFieldTypeBigInteger:"esriFieldTypeBigInteger"};function G1t(t){return t===void 0?"":t=(t=(t=t.replace(/\/featureserver\/[0-9]*/i,"/FeatureServer")).replace(/\/mapserver\/[0-9]*/i,"/MapServer")).split("?")[0]}function z1t(t,e){e||(e={}),typeof e=="function"&&(e={cmp:e});const s=typeof e.cycles=="boolean"&&e.cycles,i=e.cmp&&(r=e.cmp,function(o){return function(a,l){const u={key:a,value:o[a]},c={key:l,value:o[l]};return r(u,c)}});var r;const n=[];return function o(a){if(a!=null&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a===void 0)return;if(typeof a=="number")return isFinite(a)?""+a:"null";if(typeof a!="object")return JSON.stringify(a);let l,u;if(Array.isArray(a)){for(u="[",l=0;l<a.length;l++)l&&(u+=","),u+=o(a[l])||"null";return u+"]"}if(a===null)return"null";if(n.includes(a)){if(s)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}const c=n.push(a)-1,h=Object.keys(a).sort(i==null?void 0:i(a));for(u="",l=0;l<h.length;l++){const m=h[l],f=o(a[m]);f&&(u&&(u+=","),u+=JSON.stringify(m)+":"+f)}return n.splice(c,1),"{"+u+"}"}(t)}function mXe(t){switch(t.type){case"catalog":case"csv":case"feature":case"geojson":case"knowledge-graph-sublayer":case"oriented-imagery":case"subtype-group":case"wfs":return!0;default:return!1}}function dXe(t){switch(t.type){case"catalog-footprint":case"subtype-sublayer":return!0;default:return mXe(t)}}var u8;let Uy=u8=class extends Te{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new u8({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};p([_({type:String,json:{write:!0}})],Uy.prototype,"expression",void 0),p([_({type:String,json:{write:!0}})],Uy.prototype,"name",void 0),p([_({type:["boolean","date","number","string"],json:{write:!0}})],Uy.prototype,"returnType",void 0),p([_({type:String,json:{write:!0}})],Uy.prototype,"title",void 0),Uy=u8=p([Q("esri.form.ExpressionInfo")],Uy);const pXe=Uy;let By=class extends Te{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};p([_({type:String,json:{write:!0}})],By.prototype,"description",void 0),p([_({type:String,json:{write:!0}})],By.prototype,"label",void 0),p([_()],By.prototype,"type",void 0),p([_({type:String,json:{write:!0}})],By.prototype,"visibilityExpression",void 0),By=p([Q("esri.form.elements.Element")],By);const rg=By;let YA=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.type=null}};p([_()],YA.prototype,"type",void 0),YA=p([Q("esri.form.elements.inputs.attachments.Input")],YA);const ng=YA,W$=["any","capture","upload"];let dv=class extends ng{constructor(e){super(e),this.type="audio",this.inputMethod="any",this.maxDuration=null}};p([_({type:["audio"],readOnly:!0,json:{write:!0}})],dv.prototype,"type",void 0),p([_({type:W$,json:{write:!0}})],dv.prototype,"inputMethod",void 0),p([_({type:Number,json:{write:!0}})],dv.prototype,"maxDuration",void 0),dv=p([Q("esri.form.elements.inputs.attachments.AudioInput")],dv);const ose=dv;let wS=class extends ng{constructor(e){super(e),this.type="document",this.maxFileSize=null}};p([_({type:["document"],readOnly:!0,json:{write:!0}})],wS.prototype,"type",void 0),p([_({type:Number,json:{write:!0}})],wS.prototype,"maxFileSize",void 0),wS=p([Q("esri.form.elements.inputs.attachments.DocumentInput")],wS);const ase=wS;let pv=class extends ng{constructor(e){super(e),this.type="image",this.inputMethod="any",this.maxImageSize=null}};p([_({type:["image"],readOnly:!0,json:{write:!0}})],pv.prototype,"type",void 0),p([_({type:W$,json:{write:!0}})],pv.prototype,"inputMethod",void 0),p([_({type:Number,json:{write:!0}})],pv.prototype,"maxImageSize",void 0),pv=p([Q("esri.form.elements.inputs.attachments.ImageInput")],pv);const lse=pv;let SS=class extends ng{constructor(e){super(e),this.type="signature",this.inputMethod="any"}};p([_({type:["signature"],readOnly:!0,json:{write:!0}})],SS.prototype,"type",void 0),p([_({type:W$,json:{write:!0}})],SS.prototype,"inputMethod",void 0),SS=p([Q("esri.form.elements.inputs.attachments.SignatureInput")],SS);const use=SS;let fv=class extends ng{constructor(e){super(e),this.type="video",this.inputMethod="any",this.maxDuration=null}};p([_({type:["video"],readOnly:!0,json:{write:!0}})],fv.prototype,"type",void 0),p([_({type:W$,json:{write:!0}})],fv.prototype,"inputMethod",void 0),p([_({type:Number,json:{write:!0}})],fv.prototype,"maxDuration",void 0),fv=p([Q("esri.form.elements.inputs.attachments.VideoInput")],fv);const cse=fv;function C_e(t){return{nestableTypes:{base:ng,key:"type",typeMap:{audio:ose,document:ase,image:lse,signature:use,video:cse}},allTypes:{base:ng,key:"type",typeMap:{attachment:t,audio:ose,document:ase,image:lse,signature:use,video:cse}}}}function fXe(t,e,s){return t?t.map(i=>Hc(e.nestableTypes,i)):null}function gXe(t,e,s){if(!t)return null;const i=e.nestableTypes.typeMap;return t.filter(r=>i[r.type]).map(r=>i[r.type].fromJSON(r))}function yXe(t,e,s){if(!t)return null;const i=e.nestableTypes.typeMap;return t.filter(r=>i[r.type]).map(r=>r.toJSON())}let $h=class extends ng{constructor(e){super(e),this.type="attachment",this.attachmentAssociationType="exact",this.inputTypes=null}castInputs(e){return fXe(e,LO)}readInputs(e,s){return gXe(s.inputTypes,LO)}writeInputs(e,s){s.inputTypes=yXe(e,LO)}};p([_({type:["attachment"],readOnly:!0,json:{write:!0}})],$h.prototype,"type",void 0),p([_({type:["any","exact","exactOrNone"],json:{write:!0}})],$h.prototype,"attachmentAssociationType",void 0),p([_({json:{write:{isRequired:!0}}})],$h.prototype,"inputTypes",void 0),p([Ht("inputTypes")],$h.prototype,"castInputs",null),p([qe("inputTypes")],$h.prototype,"readInputs",null),p([Ue("inputTypes")],$h.prototype,"writeInputs",null),$h=p([Q("esri.form.elements.inputs.attachments.AttachmentInput")],$h);const LO=C_e($h),_Xe=$h;var c8;const vXe=C_e(_Xe);let Pl=c8=class extends rg{constructor(t){super(t),this.allowUserRename=!0,this.attachmentKeyword=null,this.displayFilename=!1,this.editableExpression=null,this.filenameExpression="{attachmentKeyword}_{now}",this.input=null,this.maxAttachmentCount=null,this.minAttachmentCount=null,this.type="attachment",this.useOriginalFilename=!0}clone(){var t;return new c8({allowUserRename:this.allowUserRename,attachmentKeyword:this.attachmentKeyword,description:this.description,displayFilename:this.displayFilename,editableExpression:this.editableExpression,filenameExpression:this.filenameExpression,input:(t=this.input)==null?void 0:t.clone(),label:this.label,maxAttachmentCount:this.maxAttachmentCount,minAttachmentCount:this.minAttachmentCount,useOriginalFilename:this.useOriginalFilename,visibilityExpression:this.visibilityExpression})}};p([_({type:Boolean,json:{write:!0}})],Pl.prototype,"allowUserRename",void 0),p([_({type:String,json:{write:{isRequired:!0}}})],Pl.prototype,"attachmentKeyword",void 0),p([_({type:Boolean,json:{write:!0}})],Pl.prototype,"displayFilename",void 0),p([_({type:String,json:{write:!0}})],Pl.prototype,"editableExpression",void 0),p([_({type:String,json:{write:!0}})],Pl.prototype,"filenameExpression",void 0),p([_({types:vXe.allTypes,json:{read:{source:"inputType"},write:{target:"inputType",isRequired:!0}}})],Pl.prototype,"input",void 0),p([_({type:Number,json:{write:!0}})],Pl.prototype,"maxAttachmentCount",void 0),p([_({type:Number,json:{write:!0}})],Pl.prototype,"minAttachmentCount",void 0),p([_({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],Pl.prototype,"type",void 0),p([_({type:Boolean,json:{write:!0}})],Pl.prototype,"useOriginalFilename",void 0),Pl=c8=p([Q("esri.form.elements.AttachmentElement")],Pl);const hse=Pl;let XA=class extends Te{constructor(e){super(e),this.type=null}};p([_()],XA.prototype,"type",void 0),XA=p([Q("esri.form.elements.inputs.Input")],XA);const zd=XA;let ES=class extends zd{constructor(e){super(e),this.maxLength=null,this.minLength=0}};p([_({type:Number,json:{write:!0}})],ES.prototype,"maxLength",void 0),p([_({type:Number,json:{write:!0}})],ES.prototype,"minLength",void 0),ES=p([Q("esri.form.elements.inputs.TextInput")],ES);const n9=ES;var h8;let WA=h8=class extends n9{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new h8({maxLength:this.maxLength,minLength:this.minLength})}};p([_({type:["barcode-scanner"],json:{read:!1,write:!0}})],WA.prototype,"type",void 0),WA=h8=p([Q("esri.form.elements.inputs.BarcodeScannerInput")],WA);const bXe=WA;var m8;let gv=m8=class extends zd{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new m8({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};p([_({type:String,json:{write:!0}})],gv.prototype,"noValueOptionLabel",void 0),p([_({type:Boolean,json:{write:!0}})],gv.prototype,"showNoValueOption",void 0),p([_({type:["combo-box"],json:{read:!1,write:!0}})],gv.prototype,"type",void 0),gv=m8=p([Q("esri.form.elements.inputs.ComboBoxInput")],gv);const xXe=gv;var d8;function mse(t){return t??null}function dse(t){return t??null}let Mh=d8=class extends zd{constructor(t){super(t),this.max=null,this.min=null,this.type="date-picker"}readMax(t,e){return mse(e.max)}writeMax(t,e){e.max=dse(t)}readMin(t,e){return mse(e.min)}writeMin(t,e){e.min=dse(t)}clone(){return new d8({max:this.max,min:this.min})}};p([_({type:String,json:{type:String,write:!0}})],Mh.prototype,"max",void 0),p([qe("max")],Mh.prototype,"readMax",null),p([Ue("max")],Mh.prototype,"writeMax",null),p([_({type:String,json:{type:String,write:!0}})],Mh.prototype,"min",void 0),p([qe("min")],Mh.prototype,"readMin",null),p([Ue("min")],Mh.prototype,"writeMin",null),p([_({type:["date-picker"],json:{read:!1,write:!0}})],Mh.prototype,"type",void 0),Mh=d8=p([Q("esri.form.elements.inputs.DatePickerInput")],Mh);const wXe=Mh;var p8;function VO(t){return t??null}function qO(t){return t??null}let La=p8=class extends zd{constructor(t){super(t),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(t,e){return VO(e.max)}writeMax(t,e){e.max=qO(t)}readMin(t,e){return VO(e.min)}writeMin(t,e){e.min=qO(t)}readTimeResolution(t,e){return VO(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=qO(t)}clone(){return new p8({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};p([_({type:Boolean,json:{write:!0}})],La.prototype,"includeTimeOffset",void 0),p([_({type:String,json:{type:String,write:!0}})],La.prototype,"max",void 0),p([qe("max")],La.prototype,"readMax",null),p([Ue("max")],La.prototype,"writeMax",null),p([_({type:String,json:{type:String,write:!0}})],La.prototype,"min",void 0),p([qe("min")],La.prototype,"readMin",null),p([Ue("min")],La.prototype,"writeMin",null),p([_({type:String,json:{type:String,write:!0}})],La.prototype,"timeResolution",void 0),p([qe("timeResolution")],La.prototype,"readTimeResolution",null),p([Ue("timeResolution")],La.prototype,"writeTimeResolution",null),p([_({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],La.prototype,"type",void 0),La=p8=p([Q("esri.form.elements.inputs.DateTimeOffsetPickerInput")],La);const SXe=La;var f8;function pse(t){return t!=null?new Date(t):null}function fse(t){return t?t.getTime():null}let bc=f8=class extends zd{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return pse(e.max)}writeMax(t,e){e.max=fse(t)}readMin(t,e){return pse(e.min)}writeMin(t,e){e.min=fse(t)}clone(){return new f8({includeTime:this.includeTime,max:this.max,min:this.min})}};p([_({type:Boolean,json:{write:!0}})],bc.prototype,"includeTime",void 0),p([_({type:Date,json:{type:Number,write:!0}})],bc.prototype,"max",void 0),p([qe("max")],bc.prototype,"readMax",null),p([Ue("max")],bc.prototype,"writeMax",null),p([_({type:Date,json:{type:Number,write:!0}})],bc.prototype,"min",void 0),p([qe("min")],bc.prototype,"readMin",null),p([Ue("min")],bc.prototype,"writeMin",null),p([_({type:["datetime-picker"],json:{read:!1,write:!0}})],bc.prototype,"type",void 0),bc=f8=p([Q("esri.form.elements.inputs.DateTimePickerInput")],bc);const EXe=bc;var g8;let yv=g8=class extends zd{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new g8({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};p([_({type:String,json:{write:!0}})],yv.prototype,"noValueOptionLabel",void 0),p([_({type:Boolean,json:{write:!0}})],yv.prototype,"showNoValueOption",void 0),p([_({type:["radio-buttons"],json:{read:!1,write:!0}})],yv.prototype,"type",void 0),yv=g8=p([Q("esri.form.elements.inputs.RadioButtonsInput")],yv);const CXe=yv;var y8;let _v=y8=class extends zd{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new y8({offValue:this.offValue,onValue:this.onValue})}};p([_({type:[String,Number],json:{write:!0}})],_v.prototype,"offValue",void 0),p([_({type:[String,Number],json:{write:!0}})],_v.prototype,"onValue",void 0),p([_({type:["switch"],json:{read:!1,write:!0}})],_v.prototype,"type",void 0),_v=y8=p([Q("esri.form.elements.inputs.SwitchInput")],_v);const PXe=_v;var _8;let ZA=_8=class extends n9{constructor(t){super(t),this.type="text-area"}clone(){return new _8({maxLength:this.maxLength,minLength:this.minLength})}};p([_({type:["text-area"],json:{read:!1,write:!0}})],ZA.prototype,"type",void 0),ZA=_8=p([Q("esri.form.elements.inputs.TextAreaInput")],ZA);const TXe=ZA;var v8;let QA=v8=class extends n9{constructor(t){super(t),this.type="text-box"}clone(){return new v8({maxLength:this.maxLength,minLength:this.minLength})}};p([_({type:["text-box"],json:{read:!1,write:!0}})],QA.prototype,"type",void 0),QA=v8=p([Q("esri.form.elements.inputs.TextBoxInput")],QA);const IXe=QA;var b8;function GO(t){return t??null}function zO(t){return t??null}let Tl=b8=class extends zd{constructor(t){super(t),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(t,e){return GO(e.max)}writeMax(t,e){e.max=zO(t)}readMin(t,e){return GO(e.min)}writeMin(t,e){e.min=zO(t)}readTimeResolution(t,e){return GO(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=zO(t)}clone(){return new b8({max:this.max,min:this.min,timeResolution:this.timeResolution})}};p([_({type:String,json:{type:String,write:!0}})],Tl.prototype,"max",void 0),p([qe("max")],Tl.prototype,"readMax",null),p([Ue("max")],Tl.prototype,"writeMax",null),p([_({type:String,json:{type:String,write:!0}})],Tl.prototype,"min",void 0),p([qe("min")],Tl.prototype,"readMin",null),p([Ue("min")],Tl.prototype,"writeMin",null),p([_({type:String,json:{type:String,write:!0}})],Tl.prototype,"timeResolution",void 0),p([qe("timeResolution")],Tl.prototype,"readTimeResolution",null),p([Ue("timeResolution")],Tl.prototype,"writeTimeResolution",null),p([_({type:["time-picker"],json:{read:!1,write:!0}})],Tl.prototype,"type",void 0),Tl=b8=p([Q("esri.form.elements.inputs.TimePickerInput")],Tl);const MXe=Tl,AXe={base:zd,key:"type",typeMap:{"barcode-scanner":bXe,"combo-box":xXe,"date-picker":wXe,"datetime-picker":EXe,"datetimeoffset-picker":SXe,"radio-buttons":CXe,switch:PXe,"text-area":TXe,"text-box":IXe,"time-picker":MXe}};var x8;let wu=x8=class extends rg{constructor(t){super(t),this.domain=null,this.editable=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}clone(){return new x8({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};p([_({types:ode,json:{read:{reader:x$},write:!0}})],wu.prototype,"domain",void 0),p([_({type:Boolean,json:{write:!0}})],wu.prototype,"editable",void 0),p([_({type:String,json:{write:!0}})],wu.prototype,"editableExpression",void 0),p([_({type:String,json:{write:!0}})],wu.prototype,"fieldName",void 0),p([_({type:String,json:{write:!0}})],wu.prototype,"hint",void 0),p([_({types:AXe,json:{read:{source:"inputType"},write:{target:"inputType"}}})],wu.prototype,"input",void 0),p([_({type:String,json:{write:!0}})],wu.prototype,"requiredExpression",void 0),p([_({type:String,json:{read:!1,write:!0}})],wu.prototype,"type",void 0),p([_({type:String,json:{write:!0}})],wu.prototype,"valueExpression",void 0),wu=x8=p([Q("esri.form.elements.FieldElement")],wu);const gse=wu;var w8;let Jm=w8=class extends rg{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new w8({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:he(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};p([_({type:Number,json:{write:!0}})],Jm.prototype,"displayCount",void 0),p([_({type:["list"],json:{write:!0}})],Jm.prototype,"displayType",void 0),p([_({type:String,json:{write:!0}})],Jm.prototype,"editableExpression",void 0),p([_({type:[F7],json:{write:!0}})],Jm.prototype,"orderByFields",void 0),p([_({type:Number,json:{write:!0}})],Jm.prototype,"relationshipId",void 0),p([_({type:["relationship"],json:{read:!1,write:!0}})],Jm.prototype,"type",void 0),Jm=w8=p([Q("esri.form.elements.RelationshipElement")],Jm);const yse=Jm;var S8;let vv=S8=class extends rg{constructor(t){super(t),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new S8({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};p([_({type:String,json:{write:!0}})],vv.prototype,"text",void 0),p([_({type:String,json:{write:!0}})],vv.prototype,"textFormat",void 0),p([_({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],vv.prototype,"type",void 0),vv=S8=p([Q("esri.form.elements.TextElement")],vv);const _se=vv;let bv=class extends Wt.ClonableMixin(rg){constructor(e){super(e),this.associationTypes=null,this.editableExpression=null,this.type="utilityNetworkAssociations"}};p([_({type:[wme],json:{write:{isRequired:!0}}})],bv.prototype,"associationTypes",void 0),p([_({type:String,json:{write:!0}})],bv.prototype,"editableExpression",void 0),p([_({type:["utilityNetworkAssociations"],json:{read:!1,write:!0}})],bv.prototype,"type",void 0),bv=p([Q("esri.form.elements.UtilityNetworkAssociationsElement")],bv);const vse=bv,NXe=t=>t.type==="field",DXe=t=>t.type==="group",$Xe=t=>t.type==="text";function P_e(t){return{typesWithGroup:{base:rg,key:"type",typeMap:{attachment:hse,field:gse,group:t,relationship:yse,text:_se,utilityNetworkAssociations:vse}},typesWithoutGroup:{base:rg,key:"type",typeMap:{attachment:hse,field:gse,relationship:yse,text:_se,utilityNetworkAssociations:vse}}}}function T_e(t,e,s=!0){if(!t)return null;const i=s?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(r=>i[r.type]).map(r=>i[r.type].fromJSON(r))}function I_e(t,e,s=!0){if(!t)return null;const i=s?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(r=>i[r.type]).map(r=>r.toJSON())}function M_e(t,e,s=!0){return t?t.map(i=>Hc(s?e.typesWithGroup:e.typesWithoutGroup,i)):null}var E8;let Rh=E8=class extends rg{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return M_e(t,UO,!1)}readElements(t,e){return T_e(e.formElements,UO,!1)}writeElements(t,e){e.formElements=I_e(t,UO,!1)}clone(){return new E8({description:this.description,elements:he(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};p([_({json:{write:!0}})],Rh.prototype,"elements",void 0),p([Ht("elements")],Rh.prototype,"castElements",null),p([qe("elements",["formElements"])],Rh.prototype,"readElements",null),p([Ue("elements")],Rh.prototype,"writeElements",null),p([_({type:["collapsed","expanded"],json:{write:!0}})],Rh.prototype,"initialState",void 0),p([_({type:String,json:{read:!1,write:!0}})],Rh.prototype,"type",void 0),Rh=E8=p([Q("esri.form.elements.GroupElement")],Rh);const UO=P_e(Rh),RXe=Rh;var C8;const BO=P_e(RXe);let xc=C8=class extends Te{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return M_e(t,BO)}readElements(t,e){return T_e(e.formElements,BO)}writeElements(t,e){e.formElements=I_e(t,BO)}clone(){return new C8({description:this.description,expressionInfos:he(this.expressionInfos),elements:he(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}async getFieldsUsed(t,e){const s=new Set,{description:i,elements:r,expressionInfos:n,title:o}=this;if(hE(s,t,i),hE(s,t,o),!r)return[];const a=kXe(r,n).map(l=>Go(s,t,l));await Promise.all(a);for(const l of r)A_e(s,{fieldsIndex:t,relationships:e},l);return Array.from(s).sort()}};function A_e(t,e,s){var r;const{fieldsIndex:i}=e;if(!i||i.fields.length!==t.size)switch(hE(t,i,s.label),hE(t,i,s.description),s.type){case"field":va(t,i,s.fieldName);break;case"group":s.elements.forEach(n=>A_e(t,e,n));break;case"relationship":if(e.relationships){const n=e.relationships.find(o=>o.id===s.relationshipId);n&&va(t,i,n.keyField)}W_(t,i,(r=s.orderByFields)==null?void 0:r.map(n=>n.field));break;case"text":hE(t,i,s.text)}}function kXe(t,e){if(!e||e.length===0)return[];const s=N_e(t),i=[];for(const r of e)s.has(r.name)&&i.push(r.expression);return i}function N_e(t){const e=new Set;for(const s of t)if(cW(e,s.visibilityExpression),!$Xe(s)){if(DXe(s))AN(e,N_e(s.elements));else if(cW(e,s.editableExpression),NXe(s)){const{requiredExpression:i,valueExpression:r}=s;AN(e,[i,r])}}return e}function hE(t,e,s){W_(t,e,R7(s))}p([_({type:String,json:{write:!0}})],xc.prototype,"description",void 0),p([_({json:{write:!0}})],xc.prototype,"elements",void 0),p([Ht("elements")],xc.prototype,"castElements",null),p([qe("elements",["formElements"])],xc.prototype,"readElements",null),p([Ue("elements")],xc.prototype,"writeElements",null),p([_({type:[pXe],json:{write:!0}})],xc.prototype,"expressionInfos",void 0),p([_({type:Boolean,json:{default:!1,write:!0}})],xc.prototype,"preserveFieldValuesWhenHidden",void 0),p([_({type:String,json:{write:!0}})],xc.prototype,"title",void 0),xc=C8=p([Q("esri.form.FormTemplate")],xc);const FXe=xc;function bse(t,e,s){if(t.hasM==null||t.hasZ)for(const i of e)for(const r of i)r.length>2&&(r[2]*=s)}function OXe(t,e,s){if(!t&&!e||!s)return;const i=bb(s);xse(t,s,i),xse(e,s,i)}function xse(t,e,s){if(t)for(const i of t)LXe(i.geometry,e,s)}function LXe(t,e,s){if(!(t!=null&&t.spatialReference)||on(t.spatialReference,e))return;const i=bb(t.spatialReference)/s;if(i!==1){if("x"in t)t.z!=null&&(t.z*=i);else if("rings"in t)bse(t,t.rings,i);else if("paths"in t)bse(t,t.paths,i);else if("points"in t&&(t.hasM==null||t.hasZ))for(const r of t.points)r.length>2&&(r[2]*=i)}}let VXe=0,ad=class extends Jh.LoadableMixin(YC.EsriPromiseMixin(Ge)){constructor(e){super(e),this._idToClientGraphic=null,this.type="memory"}load(e){const s=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(s)),Promise.resolve(this)}destroy(){var e;(e=this._connection)==null||e.close(),this._connection=null}get _workerGeometryType(){var s;const e=(s=this.layer)==null?void 0:s.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}async queryFeatures(e,s={}){await this.load(s);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,s);l8(e,this.layer.spatialReference,i);const r=N$.fromJSON(i);if(!this._requiresClientGraphicMapping())return r;const n=this.layer.objectIdField;for(const o of r.features){const a=o.attributes[n],l=this._idToClientGraphic.get(a);l&&(o.geometry=l.geometry)}return r.geometryType=this.layer.geometryType,r}async queryFeaturesJSON(e,s={}){if(this._requiresClientGraphicMapping())throw new ae("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(s);const i=await this._connection.invoke("queryFeatures",e?e.toJSON():null,s);return l8(e,this.layer.spatialReference,i),i}queryFeatureCount(e,s={}){return this.load(s).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,s))}queryObjectIds(e,s={}){return this.load(s).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,s))}queryExtent(e,s={}){return this.load(s).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,s)).then(i=>({count:i.count,extent:Hs.fromJSON(i.extent)}))}querySnapping(e,s={}){return this.load(s).then(()=>this._connection.invoke("querySnapping",e,s))}async queryAttributeBins(e,s={}){return await this.load(),this._connection.invoke("queryAttributeBins",e==null?void 0:e.toJSON(),s)}async _applyEdits(e){if(!this._connection)throw new ae("feature-layer-source:edit-failure","Memory source not loaded");const s=this.layer.objectIdField;let i=null;const r=[],n=[];await Promise.all([this._prepareClientMapping(e.addFeatures,null),this._prepareClientMapping(e.updateFeatures,null)]);const o=c=>"objectId"in c&&c.objectId!=null?c.objectId:"attributes"in c&&c.attributes[s]!=null?c.attributes[s]:null;if(e.addFeatures&&(i=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(const c of e.deleteFeatures){const h=o(c);h!=null&&r.push(h)}const a=e.updateFeatures&&this._idToClientGraphic?new Map:null;if(e.updateFeatures){for(const c of e.updateFeatures)if(n.push(this._serializeFeature(c)),a){const h=o(c);h!=null&&a.set(h,c)}}OXe(i?i.features:null,n,this.layer.spatialReference);const{fullExtent:l,featureEditResults:u}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:n,deletes:r});return this.fullExtent=l,i&&i.finish(u.uidToObjectId),this._updateClientGraphicIds(a,u),this._createEditsResult(u)}async _prepareClientMapping(e,s){if(this._layerOrSourceGeometryType!=="mesh"||e==null)return;const i=[];for(const{geometry:r}of e)r==null||r.type!=="mesh"||r.hasExtent||r.loaded||i.push(r.load({signal:s}));i.length&&await Promise.all(i)}_updateClientGraphicIds(e,s){if(this._idToClientGraphic){if(e)for(const i of s.updateResults){if(!i.success)continue;const r=e.get(i.objectId);r!=null&&this._addIdToClientGraphic(r)}for(const i of s.deleteResults)i.success&&this._idToClientGraphic.delete(i.objectId)}}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const s=e.success===!0?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:s?new ae("feature-layer-source:edit-failure",s.description,{code:s.code}):null}}_prepareAddFeatures(e){const s=new Map,i=new Array(e.length);let r=null;for(let o=0;o<e.length;o++){const a=e[o],l=this._serializeFeature(a);r||a.geometry==null||(r=a.geometry.type),i[o]=l,s.set(`${l.uid}`,a)}const n=this;return{features:i,inferredGeometryType:r,finish(o){const a=n.sourceJSON.objectIdField;for(const l in o){const u=o[l],c=s.get(l);c&&(c.attributes||(c.attributes={}),u===-1?delete c.attributes[a]:c.attributes[a]=u,n._addIdToClientGraphic(c))}}}}_addIdToClientGraphic(e){var r;if(!this._idToClientGraphic)return;const s=this.sourceJSON.objectIdField,i=(r=e.attributes)==null?void 0:r[s];i!=null&&this._idToClientGraphic.set(i,e)}get _layerOrSourceGeometryType(){var e,s;return((e=this.layer)==null?void 0:e.geometryType)??((s=this.sourceJSON)==null?void 0:s.geometryType)}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return e==="mesh"||e==="multipatch"||e==="extent"}_serializeFeature(e){const{attributes:s}=e,i=this._geometryForSerialization(e),r=(VXe++).toString();return i?{uid:r,geometry:i.toJSON(),attributes:s}:{uid:r,attributes:s}}_geometryForSerialization(e){const{geometry:s}=e;return s==null?null:this._geometryRequiresClientGraphicMapping(s)?s.extent?po.fromExtent(s.extent):null:s}async _startWorker(e){this._connection=await Cce("MemorySourceWorker",{strategy:ge("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:s,spatialReference:i,objectIdField:r,hasM:n,hasZ:o,timeInfo:a,dateFieldsTimeZone:l}=this.layer,u=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,e);const c=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",g=>{Ne.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),g.preventDefault()}));const h={features:c.features,fields:s==null?void 0:s.map(g=>g.toJSON()),geometryType:kW.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&n,hasZ:this._layerOrSourceGeometryType==="mesh"||o,objectIdField:r,spatialReference:u?null:i&&i.toJSON(),timeInfo:(a==null?void 0:a.toJSON())??null,dateFieldsTimeZone:l},m=await this._connection.invoke("load",h,{signal:e});for(const g of m.warnings)Ne.getLogger(this.layer).warn("#load()",`${g.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:g});m.featureErrors.length&&Ne.getLogger(this.layer).warn("#load()",`Encountered ${m.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:m.featureErrors});const f=m.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(c.inferredGeometryType)&&(f.geometryType=kW.toJSON(c.inferredGeometryType)),this.sourceJSON=f,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),c.finish(m.assignedObjectIds)}};p([Jz({Type:tn,ensureType:nn(tn)})],ad.prototype,"itemType",void 0),p([_()],ad.prototype,"type",void 0),p([_({constructOnly:!0})],ad.prototype,"layer",void 0),p([_({readOnly:!0})],ad.prototype,"_workerGeometryType",null),p([_()],ad.prototype,"sourceJSON",void 0),ad=p([Q("esri.layers.graphics.sources.MemorySource")],ad);function qXe(t){return"portalItem"in t}const GXe=t=>{let e=class extends t{get apiKey(){var s;return this._isOverridden("apiKey")?this._get("apiKey"):qXe(this)?(s=this.portalItem)==null?void 0:s.apiKey:null}set apiKey(s){s!=null?this._override("apiKey",s):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return p([_({type:String})],e.prototype,"apiKey",null),e=p([Q("esri.layers.mixins.APIKeyMixin")],e),e},zXe=t=>{let e=class extends t{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const s=sx(this.url);if(s!=null&&s.title)return s.title}return this._get("title")||""}set title(s){this._set("title",s)}set url(s){this._set("url",KPe(s,Ne.getLogger(this)))}};return p([_()],e.prototype,"title",null),p([_({type:String})],e.prototype,"url",null),e=p([Q("esri.layers.mixins.ArcGISService")],e),e},UXe=rGe(),D_e=new Map,$_e=new Map;async function tvt(t,e,s){if(!t||!s)return!1;if(!e)return!0;const i=new URL(t).host;let r=D_e.get(i);if(!r){const n=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");r=(await js(n,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return r===e}async function svt(t,e,s=!1){var n,o,a;if(!t||!e)return!0;const i=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),r=(n=$_e.get(i))==null?void 0:n.entries();if(r){for(const[l,u]of r)if(u.name===e){const c=!((o=u.stack)!=null&&o.hasForwardEdits());if(!c&&s){const[{deleteForwardEdits:h},{default:m}]=await Promise.all([me(()=>import("./deleteForwardEdits-uPq_-k6I.js"),[]),me(()=>import("./DeleteForwardEditsParameters-D8kw3_g9.js"),[])]),f=await h(i,l,new m({sessionId:UXe,moment:u.moment}));return f.success&&((a=u.stack)==null||a.clearForwardEdits()),f.success}return c}}return!0}function BXe(t,e){var r;if(!t)return!1;const s=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),i=(r=$_e.get(s))==null?void 0:r.entries();if(i){for(const[n,o]of i)if(o.name===e)return o.lockType==="edit"}return!1}const o9=new Wl.EventEmitter;function jXe(t){return o9.on("apply-edits",new WeakRef(t))}function HXe(t){return o9.on("update-moment",new WeakRef(t))}function ivt(t,e,s=null,i=!1){const r=Xl();return i=e==null||i,o9.emit("apply-edits",{serviceUrl:t,layerId:e,gdbVersion:s,mayReceiveServiceEdits:i,result:r.promise}),r}const R_e=Symbol();function rvt(t){return t!=null&&typeof t=="object"&&R_e in t}function r2(t){return t!=null&&typeof t=="object"&&"gdbVersion"in t}function jO(t,e,s){const i=new URL(t).host,r=D_e.get(i),n=o=>!o||o===r;return n(e)&&n(s)||e===s}const YXe=t=>{var e;let s=class extends t{constructor(...i){super(...i),this[e]=!0,this._applyEditsHandler=r=>{const{serviceUrl:n,layerId:o,gdbVersion:a,mayReceiveServiceEdits:l,result:u}=r,c=n===this.url,h=o!=null&&this.layerId!=null&&o===this.layerId,m=r2(this),f=r2(this)&&jO(n,a,this.gdbVersion);if(!c||m&&!f||!h&&!l)return;const g=u.then(v=>{var S;if(this.lastEditsEventDate=new Date,h&&(v.addedFeatures.length||v.updatedFeatures.length||v.deletedFeatures.length||v.addedAttachments.length||v.updatedAttachments.length||v.deletedAttachments.length))return this.emit("edits",he(v)),v;const b=(S=v.editedFeatures)==null?void 0:S.find(({layerId:T})=>T===this.layerId);if(b){const{adds:T,updates:P,deletes:I}=b.editedFeatures,A={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:T?T.map(({attributes:D})=>({objectId:this.objectIdField&&D[this.objectIdField],globalId:this.globalIdField&&D[this.globalIdField]})):[],deletedFeatures:I?I.map(({attributes:D})=>({objectId:this.objectIdField&&D[this.objectIdField],globalId:this.globalIdField&&D[this.globalIdField]})):[],updatedFeatures:P?P.map(({current:{attributes:D}})=>({objectId:this.objectIdField&&D[this.objectIdField],globalId:this.globalIdField&&D[this.globalIdField]})):[],editedFeatures:he(v.editedFeatures),exceededTransferLimit:!1,historicMoment:he(v.historicMoment)};return this.emit("edits",A),A}const w={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:he(v.editedFeatures),exceededTransferLimit:!1,historicMoment:he(v.historicMoment)};return"historicMoment"in this&&this._shouldUpdateHistoricMoment(n,a,w.historicMoment)&&this.emit("edits",w),w}).then(v=>("historicMoment"in this&&this._shouldUpdateHistoricMoment(n,a,v.historicMoment)&&(this.historicMoment=v.historicMoment),v));this.emit("apply-edits",{result:g})},this._updateMomentHandler=r=>{const{serviceUrl:n,gdbVersion:o,moment:a}=r,l=n===this.url,u=r2(this),c=r2(this)&&jO(n,o,this.gdbVersion),h=r2(this)&&!jO(n,this.gdbVersion,null);l&&u&&c&&h&&"historicMoment"in this&&this.historicMoment!==a&&(this.historicMoment=a)},this.when().then(()=>{this.addHandles(jXe(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(HXe(this._updateMomentHandler))},()=>{})}_shouldUpdateHistoricMoment(i,r,n){return"historicMoment"in this&&this.historicMoment!==n&&BXe(i,r)}};return e=R_e,p([_()],s.prototype,"lastEditsEventDate",void 0),s=p([Q("esri.layers.mixins.EditBusLayer")],s),s};let Km=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};p([_()],Km.prototype,"creatorField",void 0),p([_()],Km.prototype,"creationDateField",void 0),p([_()],Km.prototype,"editorField",void 0),p([_()],Km.prototype,"editDateField",void 0),p([_()],Km.prototype,"realm",void 0),p([_($E("dateFieldsTimeReference",!0))],Km.prototype,"timeZone",void 0),Km=p([Q("esri.layers.support.EditFieldsInfo")],Km);const XXe=Km;let kh=class extends Wt.ClonableMixin(Te){constructor(e){super(e)}};p([_({constructOnly:!0,json:{write:!0}})],kh.prototype,"name",void 0),p([_({constructOnly:!0,json:{write:!0}})],kh.prototype,"fields",void 0),p([_({constructOnly:!0,json:{write:!0}})],kh.prototype,"isAscending",void 0),p([_({constructOnly:!0,json:{write:!0}})],kh.prototype,"indexType",void 0),p([_({constructOnly:!0,json:{write:!0}})],kh.prototype,"isUnique",void 0),p([_({constructOnly:!0,json:{write:!0}})],kh.prototype,"description",void 0),kh=p([Q("esri.layers.support.FeatureIndex")],kh);let xv=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};p([_({type:String,json:{read:{source:"shapeAreaFieldName"}}})],xv.prototype,"shapeAreaField",void 0),p([_({type:String,json:{read:{source:"shapeLengthFieldName"}}})],xv.prototype,"shapeLengthField",void 0),p([_({type:String,json:{read:t=>HTe.read(t)||YTe.read(t)}})],xv.prototype,"units",void 0),xv=p([Q("esri.layers.support.GeometryFieldsInfo")],xv);const WXe=xv;var P8;let wv=P8=class extends Te{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new Ge}clone(){return new P8({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};p([_({type:String,json:{write:{isRequired:!0}}})],wv.prototype,"floorField",void 0),p([_({json:{read:!1,write:!1}})],wv.prototype,"viewAllMode",void 0),p([_({json:{read:!1,write:!1}})],wv.prototype,"viewAllLevelIds",void 0),wv=P8=p([Q("esri.layers.support.LayerFloorInfo")],wv);const ZXe=wv,wse=new Jt({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),Sse=new Jt({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let Il=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.cardinality=null,this.catalogId=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};p([_({json:{read:wse.read,write:wse.write}})],Il.prototype,"cardinality",void 0),p([_({json:{name:"catalogID"}})],Il.prototype,"catalogId",void 0),p([_({json:{read:!0,write:!0}})],Il.prototype,"composite",void 0),p([_({json:{read:!0,write:!0}})],Il.prototype,"id",void 0),p([_({json:{read:!0,write:!0}})],Il.prototype,"keyField",void 0),p([_({json:{read:!0,write:!0}})],Il.prototype,"keyFieldInRelationshipTable",void 0),p([_({json:{read:!0,write:!0}})],Il.prototype,"name",void 0),p([_({json:{read:!0,write:!0}})],Il.prototype,"relatedTableId",void 0),p([_({json:{read:!0,write:!0}})],Il.prototype,"relationshipTableId",void 0),p([_({json:{read:Sse.read,write:Sse.write}})],Il.prototype,"role",void 0),Il=p([Q("esri.layers.support.Relationship")],Il);const QXe=Il,JXe=[["binary","application/octet-stream","bin",""]];function uvt(t,e){return L_e(e.name,(t==null?void 0:t.supportedFormats)??[])!=null}function cvt(t,e){if(!t)return!1;const s=KXe(e,t.supportedFormats??[]);return s!=null&&t.editFormats.includes(s)}function k_e(t,e){return l9(iWe(t,e))}function F_e(t,e){return l9(L_e(t,e))}function hvt(t,e){return V_e(sWe(t,e))}function KXe(t,e){return F_e(t.name,e)??k_e(t.type,e)}function Z$(t,e,s){return k_e(t,s)??F_e(e,s)}function O_e({supportedFormats:t}){return Z$("model/gltf-binary","glb",t)}function mvt(t){const e=O_e(t);return e!=null&&t.editFormats.includes(e)}function eWe({supportedFormats:t}){return Z$("model/gltf+json","gltf",t)}function tWe(t){if(!t)return null;const e=O_e(t),s=eWe(t);let i=null;for(const r of t.queryFormats){if(r===e)return r;r===s&&(i=r)}return i}function dvt({supportedFormats:t}){return Z$("application/esri3do-SR_world","wld",t)}function pvt({supportedFormats:t}){return Z$("application/esri3do-SR_prj","prj",t)}function a9(t){return[...JXe,...t]}function sWe(t,e){return a9(e).find(s=>l9(s)===t)}function iWe(t,e){const s=t.toLowerCase();return a9(e).find(i=>V_e(i)===s)}function L_e(t,e){const s=t.toLowerCase();return a9(e).find(i=>rWe(i).some(r=>s.endsWith(r)))}function l9(t){return t==null?void 0:t[0]}function V_e(t){return t==null?void 0:t[1].toLowerCase()}function rWe(t){return(t==null?void 0:t[2].split(",").map(e=>e.toLowerCase()))??[]}function fvt(t){var e;return(e=t.tables)==null?void 0:e.find(s=>s.role==="assetMaps")}function Qe(t,e,s){return!!q_e(t,e,s)}function CS(t,e,s){return q_e(t,e,s)}function q_e(t,e,s){return t&&t.hasOwnProperty(e)?t[e]:s}const nWe={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function oWe(t){var s;const e=(s=t==null?void 0:t.supportedSpatialAggregationStatistics)==null?void 0:s.map(i=>i.toLowerCase());return{envelope:!!(e!=null&&e.includes("envelopeaggregate")),centroid:!!(e!=null&&e.includes("centroidaggregate")),convexHull:!!(e!=null&&e.includes("convexhullaggregate"))}}function yP(t,e){var i;const s=(i=t==null?void 0:t.supportedOperationsWithCacheHint)==null?void 0:i.map(r=>r.toLowerCase());return!!(s!=null&&s.includes(e.toLowerCase()))}function aWe(t){var s;const e=(s=t==null?void 0:t.supportedStatisticTypes)==null?void 0:s.map(i=>i.toLowerCase());return{count:!!(e!=null&&e.includes("count")),sum:!!(e!=null&&e.includes("sum")),min:!!(e!=null&&e.includes("min")),max:!!(e!=null&&e.includes("max")),avg:!!(e!=null&&e.includes("avg")),var:!!(e!=null&&e.includes("var")),stddev:!!(e!=null&&e.includes("stddev")),percentileContinuous:!!(e!=null&&e.includes("percentile_continuous")),percentileDiscrete:!!(e!=null&&e.includes("percentile_discrete")),envelope:!!(e!=null&&e.includes("envelopeaggregate")),centroid:!!(e!=null&&e.includes("centroidaggregate")),convexHull:!!(e!=null&&e.includes("convexhullaggregate"))}}function lWe(t){var s;const e=(s=t==null?void 0:t.supportedNormalizationTypes)==null?void 0:s.map(i=>i.toLowerCase());return{field:!!(e!=null&&e.includes("field")),log:!!(e!=null&&e.includes("log")),naturalLog:!!(e!=null&&e.includes("naturallog")),percentOfTotal:!!(e!=null&&e.includes("percentoftotal")),squareRoot:!!(e!=null&&e.includes("squareroot"))}}function G_e(t,e){return{analytics:uWe(t),attachment:cWe(t),data:hWe(t),metadata:mWe(t),operations:dWe(t.capabilities,t,e),query:pWe(t,e),queryAttributeBins:yWe(t),queryRelated:fWe(t),queryTopFeatures:gWe(t),editing:_We(t)}}function uWe(t){return{supportsCacheHint:yP(t.advancedQueryCapabilities,"queryAnalytics")}}function cWe(t){const e=t.attachmentProperties,s={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:yP(t.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:Qe(t.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:Qe(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach(i=>{const r=nWe[i.name];r&&(s[r]=!!i.isEnabled)}),s}function hWe(t){return{isVersioned:Qe(t,"isDataVersioned",!1),isBranchVersioned:Qe(t,"isDataBranchVersioned",!1),supportsAttachment:Qe(t,"hasAttachments",!1),supportsM:Qe(t,"hasM",!1),supportsZ:Qe(t,"hasZ",!1)}}function mWe(t){return{supportsAdvancedFieldProperties:Qe(t,"supportsFieldDescriptionProperty",!1)}}function dWe(t,e,s){const i=t?t.toLowerCase().split(",").map(m=>m.trim()):[],r=s?sx(s):null,n=i.includes(r!=null&&r.serverType==="MapServer"?"data":"query"),o=i.includes("editing")&&!e.datesInUnknownTimezone;let a=o&&i.includes("create"),l=o&&i.includes("delete"),u=o&&i.includes("update");const c=i.includes("changetracking"),h=e.advancedQueryCapabilities;return o&&!(a||l||u)&&(a=l=u=!0),{supportsCalculate:Qe(e,"supportsCalculate",!1),supportsTruncate:Qe(e,"supportsTruncate",!1),supportsValidateSql:Qe(e,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:l,supportsEditing:o,supportsChangeTracking:c,supportsQuery:n,supportsQueryAnalytics:Qe(h,"supportsQueryAnalytic",!1),supportsQueryAttachments:Qe(h,"supportsQueryAttachments",!1),supportsQueryBins:Qe(h,"supportsQueryBins",!1),supportsQueryTopFeatures:Qe(h,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:Qe(e,"supportsAttachmentsResizing",!1),supportsSync:i.includes("sync"),supportsUpdate:u,supportsExceedsLimitStatistics:Qe(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:Qe(e,"supportsAsyncConvert3D",!1)}}function pWe(t,e){const s=t.advancedQueryCapabilities,i=t.ownershipBasedAccessControlForFeatures,r=t.archivingInfo,n=t.currentVersion,o=e==null?void 0:e.includes("MapServer"),a=!o||n>=ge("mapserver-pbf-version-support"),l=ON(e),u=new Set((t.supportedQueryFormats??"").split(",").map(c=>c.toLowerCase().trim()));return{maxRecordCount:CS(t,"maxRecordCount",void 0),maxRecordCountFactor:CS(t,"maxRecordCountFactor",void 0),standardMaxRecordCount:CS(t,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:oWe(s),supportsCacheHint:Qe(s,"supportsQueryWithCacheHint",!1)||yP(s,"query"),supportsCentroid:Qe(s,"supportsReturningGeometryCentroid",!1),supportsCompactGeometry:l,supportsCurrentUser:Qe(s,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:Qe(s,"supportsDefaultSR",!1),supportsDisjointSpatialRelationship:Qe(s,"supportsDisjointSpatialRel",!1),supportsDistance:Qe(s,"supportsQueryWithDistance",!1),supportsDistinct:Qe(s,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:Qe(s,"supportsReturningQueryExtent",!1),supportsFormatPBF:a&&u.has("pbf"),supportsFullTextSearch:Qe(s,"supportsFullTextSearch",!1),supportsGeometryProperties:Qe(s,"supportsReturningGeometryProperties",!1),supportsHavingClause:Qe(s,"supportsHavingClause",!1),supportsHistoricMoment:Qe(r,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:Qe(s,"supportsMaxRecordCountFactor",!1),supportsOrderBy:Qe(s,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:Qe(s,"supportsPagination",!1),supportsPercentileStatistics:Qe(s,"supportsPercentileStatistics",!1),supportsQuantization:Qe(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:Qe(t,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:Qe(i,"allowAnonymousToQuery",!0),supportsQueryByOthers:Qe(i,"allowOthersToQuery",!0),supportsQueryGeometry:Qe(t,"supportsReturningQueryGeometry",!1),supportsResultType:Qe(s,"supportsQueryWithResultType",!1),supportsReturnMesh:!!tWe(t.infoFor3D),supportsSpatialAggregationStatistics:Qe(s,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:Qe(s,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:Qe(t,"useStandardizedQueries",!1),supportsStatistics:Qe(s,"supportsStatistics",t.supportsStatistics),supportsTopFeaturesQuery:Qe(s,"supportsTopFeaturesQuery",!1),supportsTrueCurve:Qe(s,"supportsTrueCurve",!1),tileMaxRecordCount:CS(t,"tileMaxRecordCount",void 0)}}function fWe(t){const e=t.advancedQueryCapabilities,s=Qe(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:Qe(e,"supportsQueryRelatedPagination",!1),supportsCount:s,supportsOrderBy:s,supportsCacheHint:yP(e,"queryRelated")}}function gWe(t){return{supportsCacheHint:yP(t.advancedQueryCapabilities,"queryTopFilter")}}function yWe(t){const e=t?t.queryBinsCapabilities:void 0;return{supportsDate:Qe(e,"supportsDateBin",!1),supportsFixedInterval:Qe(e,"supportsFixedIntervalBin",!1),supportsAutoInterval:Qe(e,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:Qe(e,"supportsFixedBoundariesBin",!1),supportsStackBy:Qe(e,"supportsStackBy",!1),supportsSplitBy:Qe(e,"supportsSplitBy",!1),supportsSnapToData:Qe(e,"supportsSnapToData",!1),supportsReturnFullIntervalBin:Qe(e,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:Qe(e,"supportsFirstDayOfWeek",!1),supportsNormalization:Qe(e,"supportsNormalization",!1),supportedStatistics:aWe(e),supportedNormalizationTypes:lWe(e)}}function _We(t){const e=t.ownershipBasedAccessControlForFeatures,s=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:Qe(t,"allowGeometryUpdates",!0),supportsGlobalId:Qe(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:Qe(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:Qe(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:Qe(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:Qe(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:Qe(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:Qe(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:Qe(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:Qe(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:Qe(s,"supportsAsyncApplyEdits",!1),zDefault:CS(t,"zDefault",void 0)}}function gvt(t){var e;return{operations:{supportsAppend:Qe(t,"supportsAppend",!1),supportsCoverageQuery:((e=t==null?void 0:t.playbackInfo)==null?void 0:e.klv["0601"])??!1,supportsExportClip:Qe(t,"supportsExportClip",!1),supportsExportFrameset:Qe(t,"supportsExportFrameset",!1),supportsMensuration:Qe(t,"supportsMensuration",!1),supportsUpdate:Qe(t,"supportsUpdate",!1)}}}let ed=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(e){if(!e)return null;const s={};for(const i of Object.keys(e))s[i]=x$(e[i]);return s}writeDomains(e,s){var r;if(!e)return;const i={};for(const n of Object.keys(e))e[n]&&(i[n]=(r=e[n])==null?void 0:r.toJSON());s.domains=i}};p([_({type:Number,json:{write:!0}})],ed.prototype,"code",void 0),p([_({type:Object,json:{write:!0}})],ed.prototype,"defaultValues",void 0),p([_({json:{write:!0}})],ed.prototype,"domains",void 0),p([qe("domains")],ed.prototype,"readDomains",null),p([Ue("domains")],ed.prototype,"writeDomains",null),p([_({type:String,json:{write:!0}})],ed.prototype,"name",void 0),ed=p([Q("esri.layers.support.Subtype")],ed);const vWe=ed,bWe=t=>{let e=class extends t{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.fieldsIndex=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(Ge.ofType(kh)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=St.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.version=void 0}getFieldDomain(){throw new Error("Not implemented")}getField(s){return this.fieldsIndex.get(s)}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:s}=this;if(s){const{query:r,operations:n,editing:o}=s;if(!r.supportsQueryByOthers||!r.supportsQueryByAnonymous||n.supportsEditing&&!(o.supportsUpdateByOthers&&o.supportsUpdateByAnonymous&&o.supportsDeleteByOthers&&o.supportsDeleteByAnonymous))return"load"}if(D3(this.serviceDefinitionExpression)||D3(this.definitionExpression))return"load";if(this.userHasUpdateItemPrivileges){if(t9e(this))return"load";if(this.hasUpdateItemRestrictions)return s.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const i=this.editFieldsInfo;return(i!=null&&i.creatorField||i!=null&&i.editorField)&&(s!=null&&s.operations.supportsEditing)?"editing":null}readCapabilitiesFromService(s,i){return G_e(i,this.url)}readEditingInfo(s,i){const{editingInfo:r}=i;return r?{lastEditDate:r.lastEditDate!=null?new Date(r.lastEditDate):null}:null}get effectiveCapabilities(){const s=this.capabilities;if(!s)return null;const i=he(s),{operations:r,editing:n}=i;return kA(this)?(this.userHasUpdateItemPrivileges&&(r.supportsQuery=!0),i):this.userHasUpdateItemPrivileges?(r.supportsAdd=r.supportsDelete=r.supportsEditing=r.supportsQuery=r.supportsUpdate=n.supportsDeleteByOthers=n.supportsGeometryUpdate=n.supportsUpdateByOthers=!0,i):(this.userHasFullEditingPrivileges&&r.supportsEditing&&(r.supportsAdd=r.supportsDelete=r.supportsUpdate=n.supportsGeometryUpdate=!0),i)}get effectiveEditingEnabled(){return!1}readGlobalIdFieldFromService(s,i){return Lge(i)}get hasFullEditingRestrictions(){const s=this.capabilities;if(!s||kA(this))return!1;const{operations:i,editing:r}=s;return i.supportsEditing&&!(i.supportsAdd&&i.supportsDelete&&i.supportsUpdate&&r.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const s=this.capabilities;if(!s)return!1;const{operations:i,editing:r}=s;return kA(this)?!i.supportsQuery:!(i.supportsAdd&&i.supportsDelete&&i.supportsEditing&&i.supportsQuery&&i.supportsUpdate&&r.supportsDeleteByOthers&&r.supportsGeometryUpdate&&r.supportsUpdateByOthers)}readIsTableFromService(s,i){return i.type==="Table"}readMaxScale(s,i){return i.effectiveMaxScale||s||0}readMinScale(s,i){return i.effectiveMinScale||s||0}readObjectIdFieldFromService(s,i){return Vge(i)}readServiceDefinitionExpression(s,i){return i.definitionQuery||i.definitionExpression}set url(s){if(s==null)return void this._set("url",s);const i=eTe({layer:this,url:s,nonStandardUrlAllowed:!0,logger:Ne.getLogger(this)});this._set("url",i.url),i.layerId!=null&&this._set("layerId",i.layerId)}writeUrl(s,i,r,n){tTe(this,s,null,i,n)}readVersion(s,i){return HUe(i)}};return p([_({readOnly:!0})],e.prototype,"authenticationTriggerEvent",null),p([_({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],e.prototype,"copyright",void 0),p([_({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","isDataBranchVersioned","isDataVersioned","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],e.prototype,"capabilities",void 0),p([qe("service","capabilities")],e.prototype,"readCapabilitiesFromService",null),p([_($E("dateFieldsTimeReference"))],e.prototype,"dateFieldsTimeZone",void 0),p([_({type:Boolean})],e.prototype,"datesInUnknownTimezone",void 0),p([_({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],e.prototype,"definitionExpression",void 0),p([_({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],e.prototype,"displayField",void 0),p([_({readOnly:!0,type:XXe})],e.prototype,"editFieldsInfo",void 0),p([_({readOnly:!0})],e.prototype,"editingInfo",void 0),p([qe("editingInfo")],e.prototype,"readEditingInfo",null),p([_({readOnly:!0})],e.prototype,"effectiveCapabilities",null),p([_()],e.prototype,"effectiveEditingEnabled",null),p([_((()=>{const s=he(hge),i=s.json.origins;return i["web-map"]={read:!1,write:!1},i["portal-item"]={read:!1,write:!1},s})())],e.prototype,"elevationInfo",void 0),p([_()],e.prototype,"fieldsIndex",void 0),p([_({type:ZXe,json:{name:"layerDefinition.floorInfo",write:{layerContainerTypes:Gi}}})],e.prototype,"floorInfo",void 0),p([_({type:Hs,json:{origins:{service:{read:{source:"extent"}}}}})],e.prototype,"fullExtent",void 0),p([_()],e.prototype,"gdbVersion",void 0),p([_({readOnly:!0,type:WXe,json:{read:{source:"geometryProperties"}}})],e.prototype,"geometryFieldsInfo",void 0),p([_({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:$q.read}}}})],e.prototype,"geometryType",void 0),p([_({type:String})],e.prototype,"globalIdField",void 0),p([qe("service","globalIdField",["globalIdField","fields"])],e.prototype,"readGlobalIdFieldFromService",null),p([_({readOnly:!0})],e.prototype,"hasFullEditingRestrictions",null),p([_({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasM",void 0),p([_({readOnly:!0})],e.prototype,"hasUpdateItemRestrictions",null),p([_({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasZ",void 0),p([_({readOnly:!0,type:WC})],e.prototype,"heightModelInfo",void 0),p([_({type:Date})],e.prototype,"historicMoment",void 0),p([_({type:Ge.ofType(kh),readOnly:!0})],e.prototype,"indexes",void 0),p([_({readOnly:!0})],e.prototype,"isTable",void 0),p([qe("service","isTable",["type"])],e.prototype,"readIsTableFromService",null),p([_({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],e.prototype,"layerId",void 0),p([_(A7e)],e.prototype,"maxScale",void 0),p([qe("service","maxScale",["maxScale","effectiveMaxScale"])],e.prototype,"readMaxScale",null),p([_(M7e)],e.prototype,"minScale",void 0),p([qe("service","minScale",["minScale","effectiveMinScale"])],e.prototype,"readMinScale",null),p([_({type:String})],e.prototype,"objectIdField",void 0),p([qe("service","objectIdField",["objectIdField","fields"])],e.prototype,"readObjectIdFieldFromService",null),p([_($E("preferredTimeReference"))],e.prototype,"preferredTimeZone",void 0),p([_({type:[QXe],readOnly:!0})],e.prototype,"relationships",void 0),p([_({type:Boolean})],e.prototype,"returnM",void 0),p([_({type:Boolean})],e.prototype,"returnZ",void 0),p([_({readOnly:!0,json:{write:!1}})],e.prototype,"serverGens",void 0),p([_({readOnly:!0})],e.prototype,"serviceDefinitionExpression",void 0),p([qe("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],e.prototype,"readServiceDefinitionExpression",null),p([_({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"serviceItemId",void 0),p([_()],e.prototype,"sourceJSON",void 0),p([_({type:St,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],e.prototype,"spatialReference",void 0),p([_({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],e.prototype,"subtypeField",void 0),p([_({type:[vWe],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"subtypes",void 0),p([_({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],e.prototype,"trackIdField",void 0),p([_(uge)],e.prototype,"url",null),p([Ue("url")],e.prototype,"writeUrl",null),p([_({json:{origins:{service:{read:!0}},read:!1}})],e.prototype,"version",void 0),p([qe("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],e.prototype,"readVersion",null),e=p([Q("esri.layers.mixins.FeatureLayerBase")],e),e};let PS=class extends Ye{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};p([_()],PS.prototype,"updating",void 0),p([_()],PS.prototype,"status",void 0),PS=p([Q("esri.layers.support.PublishingInfo")],PS);const xWe=PS,wWe=Symbol(),SWe=t=>{var e;let s=class extends t{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const i=this._get("publishingInfo");if(i)return i;const r=new xWe;return this._checkPublishingStatus(r),r}_checkPublishingStatus(i){let o=0;const a=async u=>{let c;i.updating=!0;try{c=await this.fetchPublishingStatus()}catch{c="unavailable"}c!=="published"&&c!=="unavailable"||(i.status==="publishing"&&this.refresh(),l.remove()),i.status=c,i.updating=!1,l.removed||(o=setTimeout(a,u,u+125))},l={removed:!1,remove(){this.removed=!0,clearTimeout(o)}};this.when().catch(()=>l.remove()),a(250),this.addHandles(l)}};return e=wWe,p([_({readOnly:!0,clonable:!1})],s.prototype,"publishingInfo",null),s=p([Q("esri.layers.mixins.PublishableLayer")],s),s};let td=class extends Wt.ClonableMixin(Te){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const s={};for(const i of Object.keys(e))s[i]=x$(e[i]);return s}writeDomains(e,s){var r;const i={};for(const n of Object.keys(e))e[n]&&(i[n]=(r=e[n])==null?void 0:r.toJSON());s.domains=i}};p([_({json:{write:!0}})],td.prototype,"id",void 0),p([_({json:{write:!0}})],td.prototype,"name",void 0),p([_({json:{write:!0}})],td.prototype,"domains",void 0),p([qe("domains")],td.prototype,"readDomains",null),p([Ue("domains")],td.prototype,"writeDomains",null),p([_({type:[U$],json:{write:!0}})],td.prototype,"templates",void 0),td=p([Q("esri.layers.support.FeatureType")],td);const z_e=td,EWe="relationships/",CWe="expression/";let na=class extends Ye{constructor(e){super(e),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||Id(()=>Zc()):null}get featureUtilsPromise(){return this._get("featureUtilsPromise")??me(()=>Promise.resolve().then(()=>oHe),void 0).then(e=>this._featureUtils=e)}get calculatedExpressions(){var s;const e=new Ge;if(!this.expressionsUsedInTitle.length)return e;if(!((s=this._arcadeTask)!=null&&s.value)){for(const i of this.expressionsUsedInTitle??[])e.push({name:i.name,invalid:!0});return e}for(const i of this.expressionsUsedInTitle)try{const r=this._arcadeTask.value.arcade.parseScript(i.expression,["$layer","$map","$datastore"]);if(r.isAsync){e.push({name:i.name,invalid:!0});break}e.push({name:i.name,syntax:r,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(r,{vars:{$feature:"any"}})})}catch{e.push({name:i.name,invalid:!0});break}return e}get expressionsUsedInTitle(){var s,i,r;let e=((s=this.effectivePopupTemplate)==null?void 0:s.title)??"";return typeof e!="string"?[]:(e=e.toLowerCase(),((r=(i=this.effectivePopupTemplate)==null?void 0:i.expressionInfos)==null?void 0:r.filter(n=>e.includes(`{expression/${n.name.toLowerCase()}}`)))??[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some(e=>e.invalid===!0)}get requiredFields(){var i,r;const e=new Set;if((i=this._arcadeTask)!=null&&i.value&&!this.hasBadExpressions)for(const n of((r=this.calculatedExpressions)==null?void 0:r.toArray())??[])try{const o=this._arcadeTask.value.arcade.extractFieldLiterals(n.syntax);for(const a of o){const l=a.split("."),u=this.fieldsIndex.get(l.at(-1)??"");u&&e.add(u.name)}}catch{}const s=this._extractFieldNames(this.workingTitle);for(const n of s){const o=this.fieldsIndex.get(n);o&&e.add(o.name)}return e}get titleFromDisplayField(){var s,i;let e="";return this.displayField&&(e=((s=this.fieldsIndex.get(this.displayField))==null?void 0:s.name)??""),e||(e=((i=this.fieldsIndex.get(this.objectIdField))==null?void 0:i.name)??""),e?`{${e}}`:""}get workingTitle(){const e=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return e===""||e==null||this.hasBadExpressions||typeof e!="string"?this.titleFromDisplayField:e}async getTitle(e,s,i){var r;try{const{attributes:n}=s,o=(i==null?void 0:i.timeZone)??"system",[{substituteFieldsInLinksAndAttributes:a}]=await Promise.all([this.featureUtilsPromise,(r=this._arcadeTask)==null?void 0:r.promise]);if(i.fetchMissingFields&&(s=await this._checkAndReQueryGraphic(e,s)),this.workingTitle&&this.fieldInfoMap){const l=this._createFormattedAttributes(e,s,o).global;return a({attributes:n,expressionAttributes:null,fieldInfoMap:this.fieldInfoMap,globalAttributes:l,layer:e,text:this.workingTitle})}return""}catch{}return""}async _checkAndReQueryGraphic(e,s){const i=s.getObjectId();if(i==null)return s;if(!dme(this.requiredFields,s)){const r=e.createQuery();r.where="1=1",r.outFields=[...this.requiredFields],r.objectIds=[i];const n=await e.queryFeatures(r);if((n==null?void 0:n.features.length)===1)return n.features[0]}return s}_createFieldInfoMap(e){const s=new Map;if(!e)return s;for(const i of e){if(!i.fieldName)continue;const r=this.fieldsIndex.get(i.fieldName),n=(r==null?void 0:r.name)??i.fieldName;i.fieldName=n,s.set(n.toLowerCase(),i)}return s}_createFormattedAttributes(e,s,i="system"){var a,l;const r=((a=this.effectivePopupTemplate)==null?void 0:a.fieldInfos)??[],n={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&((l=this._arcadeTask)!=null&&l.value)){const u=this._arcadeTask.value.Feature.createFromGraphicLikeObject(s.geometry,s.attributes,e,null);for(const c of this.calculatedExpressions)try{n[`expression/${c.name}`]=c.func({vars:{$feature:u}})}catch{}}const o={...s.attributes,...n};return{global:this._featureUtils.formatAttributes({fieldInfos:r,attributes:o,graphic:s,timeZone:i,layer:e,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(e){return R7(e).filter(s=>!(s.indexOf(EWe)===0||s.indexOf(CWe)===0))}};p([_({readOnly:!0})],na.prototype,"_arcadeTask",null),p([_()],na.prototype,"_featureUtils",void 0),p([_({readOnly:!0})],na.prototype,"featureUtilsPromise",null),p([_({readOnly:!0})],na.prototype,"calculatedExpressions",null),p([_()],na.prototype,"displayField",void 0),p([_()],na.prototype,"effectivePopupTemplate",void 0),p([_()],na.prototype,"expressionsUsedInTitle",null),p([_()],na.prototype,"fieldsIndex",void 0),p([_()],na.prototype,"fieldInfoMap",null),p([_()],na.prototype,"fields",void 0),p([_()],na.prototype,"objectIdField",void 0),p([_()],na.prototype,"requiredFields",null),na=p([Q("esri.layers.support.TitleCreator")],na);const PWe=na,Sv=[];function TWe(t,e){if(ON(t.url??""))return!0;const{wkid:s}=e;for(const i of Sv){if((t.version??0)>=i[0])return!0;if(typeof i[1]=="function"&&(i[1]=i[1]()),i[1].has(s))return!1}return!0}Sv.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=23301;e<=23333;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102934;e<=102955;e++)t.add(e);return t}]),Sv.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),Sv.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),Sv.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),Sv.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]);async function IWe(t,e,s){const i=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(i&&i.type==="unique-value"&&i.styleOrigin){const r=await XD(i.populateFromStyle());if(ni(s),r.ok===!1){const n=r.error;e!=null&&e.messages&&e.messages.push(new qu("renderer:style-reference",`Failed to create unique value renderer from style reference: ${n.message}`,{error:n,context:e})),t.clear("renderer",e==null?void 0:e.origin)}}}var Rv;(function(t){t[t.SAVE=0]="SAVE",t[t.SAVE_AS=1]="SAVE_AS"})(Rv||(Rv={}));const Kn="FeatureLayer";function XI(t,e){return new ae("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function Ese(t){return t&&t instanceof Ge}const HO=Oye();function YO(t,e,s){const i=!!(s!=null&&s.writeLayerSchema);return{enabled:i,ignoreOrigin:i}}let st=class extends bWe(Cye(sge(SWe(YXe(tge(wU(Iye(kye(Fye(zU(Dye(zXe(Pye(Aye(yU(Zfe(GXe(Wt.ClonableMixin(XC))))))))))))))))))){constructor(...e){super(...e),this.attributeTableTemplate=null,this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="ArcGISFeatureLayer",this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=St.WGS84,this.subtypeCode=null,this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=jh(async(s,i,r)=>{const{save:n,saveAs:o}=await me(()=>import("./featureLayerUtils-WJXLv3j-.js"),__vite__mapDeps([296,297,298,299,285,300,149]));switch(s){case Rv.SAVE:return n(this,i);case Rv.SAVE_AS:return o(this,r,i)}})}destroy(){var e;(e=this.source)==null||e.destroy()}normalizeCtorArgs(e,s){return typeof e=="string"?{url:e,...s}:e}load(e){var r;const s=e!=null?e.signal:null;if((r=this.portalItem)!=null&&r.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(s).then(n=>this.initLayerProperties(n))),Promise.resolve(this);const i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},e).catch(Nc).then(async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const n=await this._fetchFirstValidLayerId(s);n!=null&&(this.layerId=n)}if(!this.url&&!this._hasMemorySource())throw new ae("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(s))}).then(()=>QUe(this,"load",e));return this.addResolvingPromise(i),Promise.resolve(this)}get _titleCreator(){const e=this._get("_titleCreator");return ii(e),new PWe({fieldsIndex:this.fieldsIndex,objectIdField:this.objectIdField,fields:this.fields,displayField:this.displayField,effectivePopupTemplate:this.popupTemplate??this.defaultPopupTemplate})}readCapabilities(e,s){return s=s.layerDefinition||s,G_e(s,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){var e;return!(this.loaded&&!((e=this.capabilities)!=null&&e.operations.supportsEditing))&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}readEditingEnabled(e,s){return this._readEditingEnabled(s,!1)}readEditingEnabledFromWebMap(e,s,i){return this._readEditingEnabled(s,!0,i)}writeEditingEnabled(e,s){this._writeEditingEnabled(e,s,!1)}writeEditingEnabledToWebMap(e,s,i,r){this._writeEditingEnabled(e,s,!0,r)}get effectiveEditingEnabled(){return e9e(this)}get featureTitleFields(){return[...this._titleCreator.requiredFields]}readIsTable(e,s){return(s=(s==null?void 0:s.layerDefinition)??s).type==="Table"||!s.geometryType}writeIsTable(e,s,i,r){r!=null&&r.writeLayerSchema&&Hn(i,e?"Table":"Feature Layer",s)}readGlobalIdField(e,s){return Lge(s.layerDefinition||s)}readObjectIdField(e,s){return Vge(s.layerDefinition||s)}get parsedUrl(){const e=Sr(this.url);return e!=null&&(this.dynamicDataSource!=null?e.path=L_(e.path,"dynamicLayer"):this.layerId!=null&&(e.path=L_(e.path,this.layerId.toString()))),e}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){c3(e,this.fieldsIndex),this._set("renderer",e)}readRenderer(e,s,i){var n;s=s.layerDefinition||s;const r=(n=s.drawingInfo)==null?void 0:n.renderer;if(r){const o=HE(r,s,i)??void 0;return o||Ne.getLogger(this).error("Failed to create renderer",{rendererDefinition:s.drawingInfo.renderer,layer:this,context:i}),o}return FU(s,i)}set source(e){const s=this._get("source");s!==e&&(Ese(s)&&this._resetMemorySource(s),Ese(e)&&this._initMemorySource(e),this._set("source",e))}castSource(e){return e?Array.isArray(e)||e instanceof Ge?new ad({layer:this,items:e}):e:null}readSource(e,s){const i=N$.fromJSON(s.featureSet);return new ad({layer:this,items:(i==null?void 0:i.features)??[]})}readTemplates(e,s){const i=s.editFieldsInfo,r=i==null?void 0:i.creatorField,n=i==null?void 0:i.editorField;return e=e==null?void 0:e.map(o=>U$.fromJSON(o)),this._fixTemplates(e,r),this._fixTemplates(e,n),e}readTitle(e,s){var n,o,a;const i=((n=s.layerDefinition)==null?void 0:n.name)??s.name,r=s.title||((o=s.layerDefinition)==null?void 0:o.title);if(i){const l=(a=this.portalItem)==null?void 0:a.title;if(this.sublayerTitleMode==="item-title")return this.url?JPe(this.url,i):i;let u=i;if(!u&&this.url){const c=sx(this.url);c!=null&&(u=c.title)}return u?(this.sublayerTitleMode==="item-title-and-service-name"&&l&&l!==u&&(u=l+" - "+u),Fz(u)):void 0}if(this.sublayerTitleMode==="item-title"&&r)return r}readTitleFromWebMap(e,s){var i;return s.title||((i=s.layerDefinition)==null?void 0:i.name)}readTypeIdField(e,s){let i=(s=s.layerDefinition||s).typeIdField;if(i&&s.fields){i=i.toLowerCase();const r=s.fields.find(n=>n.name.toLowerCase()===i);r&&(i=r.name)}return i}readTypes(e,s){e=(s=s.layerDefinition||s).types;const i=s.editFieldsInfo,r=i==null?void 0:i.creatorField,n=i==null?void 0:i.editorField;return e==null?void 0:e.map(o=>(o=z_e.fromJSON(o),this._fixTemplates(o.templates,r),this._fixTemplates(o.templates,n),o))}readVisible(e,s){var i;return((i=s.layerDefinition)==null?void 0:i.defaultVisibility)!=null?!!s.layerDefinition.defaultVisibility:s.visibility!=null?!!s.visibility:void 0}async addAttachment(e,s){const i=await DUe(this,e,s,Kn);return this.lastEditsEventDate=new Date,i}async updateAttachment(e,s,i){const r=await $Ue(this,e,s,i,Kn);return this.lastEditsEventDate=new Date,r}async applyEdits(e,s){return RUe(this,e,s)}async uploadAssets(e,s){return kUe(this,e,s)}on(e,s){return super.on(e,s)}createPopupTemplate(e){return Lye(this,e)}async createGraphicsSource(e){if(this._hasMemorySource()&&this.source)return this.source.load({signal:e});const{default:s}=await _z(me(()=>import("./FeatureLayerSource-B1OI02jh.js"),__vite__mapDeps([301,40,47,302,303,43,88,42,89,304,305,306,307,16])),e);return new s({layer:this,supportedSourceTypes:this.supportedSourceTypes}).load({signal:e})}createQuery(){const e=jUe(this);e.dynamicDataSource=this.dynamicDataSource;const s=this.subtypeCode!=null?`${this.subtypeField} = ${this.subtypeCode}`:null,i=Nke(this.definitionExpression,s);return e.where=i||"1=1",e}async deleteAttachments(e,s){const i=await FUe(this,e,s,Kn);return this.lastEditsEventDate=new Date,i}async fetchRecomputedExtents(e){return OUe(this,e,Kn)}getFeatureTitle(e,s={timeZone:"system",fetchMissingFields:!1}){return this._titleCreator.getTitle(this,e,s)}getFeatureType(e){return zge(this.types,this.typeIdField,e)}getFieldDomain(e,s){var i;return YUe(this,e,s,((i=this.getField(e))==null?void 0:i.domain)??null)}async queryAttachments(e,s){return LUe(this,e,s,Kn)}async queryFeatures(e,s){const i=await this.load(),r=await i.source.queryFeatures(xn.from(e)??i.createQuery(),s);if(r!=null&&r.features)for(const n of r.features)n.layer=n.sourceLayer=i;return r}async queryObjectIds(e,s){return(await VUe(this,e,s,Kn)).filter(mQ)}async queryFeatureCount(e,s){return qUe(this,e,s,Kn)}async queryExtent(e,s){return GUe(this,e,s,Kn)}async queryRelatedFeatures(e,s){return zUe(this,e,s,Kn)}async queryRelatedFeaturesCount(e,s){return UUe(this,e,s,Kn)}async queryTopFeatures(e,s){var a;const{source:i,capabilities:r}=await this.load();if(!i.queryTopFeatures||!((a=r==null?void 0:r.query)!=null&&a.supportsTopFeaturesQuery))throw new ae(Kn,"Layer source does not support queryTopFeatures capability");const n=await me(()=>import("./TopFeaturesQuery-BaGDRDxn.js"),[]),o=await i.queryTopFeatures(n.default.from(e),s);if(o!=null&&o.features)for(const l of o.features)l.layer=l.sourceLayer=this;return o}async queryAttributeBins(e,s){var a;const{source:i,capabilities:r}=await this.load();if(!i.queryAttributeBins||!((a=r==null?void 0:r.operations)!=null&&a.supportsQueryBins))throw new ae(Kn,"Layer source does not support queryAttributeBins capability");r9e(e,r,Kn);const n=await me(()=>import("./AttributeBinsQuery-LRW-v05N.js"),__vite__mapDeps([199,14,10,21])),o=await i.queryAttributeBins(n.default.from(e),s);if(o.features)for(const l of o.features)l.layer=l.sourceLayer=this;return o}async queryTopObjectIds(e,s){const{source:i,capabilities:r}=await this.load();if(!i.queryTopObjectIds||!(r!=null&&r.query.supportsTopFeaturesQuery))throw new ae(Kn,"Layer source does not support queryTopObjectIds capability");const n=await me(()=>import("./TopFeaturesQuery-BaGDRDxn.js"),[]);return(await i.queryTopObjectIds(n.default.from(e),s)).filter(mQ)}async queryTopFeaturesExtent(e,s){var o;const{source:i,capabilities:r}=await this.load();if(!i.queryTopExtents||!((o=r==null?void 0:r.query)!=null&&o.supportsTopFeaturesQuery))throw new ae(Kn,"Layer source does not support queryTopExtents capability");const n=await me(()=>import("./TopFeaturesQuery-BaGDRDxn.js"),[]);return i.queryTopExtents(n.default.from(e),s)}async queryTopFeatureCount(e,s){var o;const{source:i,capabilities:r}=await this.load();if(!i.queryTopCount||!((o=r==null?void 0:r.query)!=null&&o.supportsTopFeaturesQuery))throw new ae(Kn,"Layer source does not support queryFeatureCount capability");const n=await me(()=>import("./TopFeaturesQuery-BaGDRDxn.js"),[]);return i.queryTopCount(n.default.from(e),s)}read(e,s){const i=e.featureCollection;if((i||e.type==="Feature Collection")&&(this.resourceInfo=e),i){const r=i.layers;r&&r.length===1&&(super.read(r[0],s),i.showLegend!=null&&super.read({showLegend:i.showLegend},s))}super.read(e,s),s&&s.origin==="service"&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(e,s){s={...s,origin:(s==null?void 0:s.origin)??void 0,writeLayerSchema:(s==null?void 0:s.writeLayerSchema)??this._hasMemorySource()};const{origin:i,layerContainerType:r,messages:n}=s;if(this.dynamicDataSource)return n==null||n.push(XI(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if((i==="web-map"||i==="web-scene")&&r!=="tables")return n==null||n.push(XI(this,`a table source can only be written to tables, not ${r}`)),null;if(this._hasMemorySource())return n==null||n.push(XI(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&(i==="web-map"||i==="web-scene")&&r==="tables")return n==null||n.push(XI(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(e,s)}clone(){if(this._hasMemorySource())throw new ae(Kn,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(e){var s;return!!this.loaded&&(((s=this.source)==null?void 0:s.type)==="memory"||TWe(this,e))}async save(e){return this._debouncedSaveOperations(Rv.SAVE,e)}async saveAs(e,s){return this._debouncedSaveOperations(Rv.SAVE_AS,s,e)}_readEditingEnabled(e,s,i){var n;let r=(n=e.layerDefinition)==null?void 0:n.capabilities;return r?this._hasEditingCapability(r):(r=e.capabilities,s&&(i==null?void 0:i.origin)==="web-map"&&!this._hasMemorySource()&&r?this._hasEditingCapability(r):void 0)}_hasEditingCapability(e){return e.toLowerCase().split(",").map(s=>s.trim()).includes("editing")}_writeEditingEnabled(e,s,i,r){var n,o;if(!e){const a=(o=(n=this.capabilities)==null?void 0:n.operations)!=null&&o.supportsSync?"Query,Sync":"Query";Hn("layerDefinition.capabilities",a,s),i&&!(r!=null&&r.writeLayerSchema)&&(s.capabilities=a)}}_fetchFirstValidLayerId(e){return js(this.url??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e}).then(s=>{const i=s.data;if(i)return this.findFirstValidLayerId(i)})}async initLayerProperties(e){var s;return this._set("source",e),e.sourceJSON&&(this.sourceJSON=e.sourceJSON,this.read(e.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:(s=this.portalItem)==null?void 0:s.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),c3(this.renderer,this.fieldsIndex),M7(this.timeInfo,this.fieldsIndex),this._hasMemorySource()&&this.geometryType==="mesh"&&(this.capabilities.query.supportsReturnMesh=!0),IWe(this,{origin:"service"})}async hasDataChanged(){return BUe(this)}async fetchPublishingStatus(){const e=this.source;return e!=null&&e.fetchPublishingStatus?e.fetchPublishingStatus():"unavailable"}_verifyFields(){var s,i;const e=((s=this.parsedUrl)==null?void 0:s.path)??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||e.search(/\/FeatureServer\//i)!==-1||(i=this.fields)!=null&&i.some(r=>r.type==="geometry")||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")}_fixTemplates(e,s){e&&e.forEach(i=>{var n;const r=(n=i.prototype)==null?void 0:n.attributes;r&&s&&delete r[s]})}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new ae("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new ae("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(e){e.forEach(s=>{s.layer=this,s.sourceLayer=this}),this.addHandles([e.on("after-add",s=>{s.item.layer=this,s.item.sourceLayer=this}),e.on("after-remove",s=>{s.item.layer=null,s.item.sourceLayer=null})],"fl-source")}_resetMemorySource(e){e.forEach(s=>{s.layer=null,s.sourceLayer=null}),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(e){return Array.isArray(e.layers)&&e.layers.length>0?e.layers[0].id:Array.isArray(e.tables)&&e.tables.length>0?e.tables[0].id:void 0}};p([_({clonable:!1,readOnly:!0})],st.prototype,"_titleCreator",null),p([_(fge)],st.prototype,"attributeTableTemplate",void 0),p([qe("service","capabilities")],st.prototype,"readCapabilities",null),p([_({json:{origins:{"web-scene":{write:!1}},write:!0}})],st.prototype,"charts",void 0),p([_({readOnly:!0})],st.prototype,"createQueryVersion",null),p([_({json:{read:{source:"layerDefinition.copyrightText"}}})],st.prototype,"copyright",void 0),p([_({json:{read:{source:"layerDefinition.displayField"}}})],st.prototype,"displayField",void 0),p([_({types:Nf,readOnly:!0})],st.prototype,"defaultSymbol",void 0),p([_({type:Ic})],st.prototype,"dynamicDataSource",void 0),p([_({type:Boolean})],st.prototype,"editingEnabled",null),p([qe(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],st.prototype,"readEditingEnabled",null),p([qe("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],st.prototype,"readEditingEnabledFromWebMap",null),p([Ue(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],st.prototype,"writeEditingEnabled",null),p([Ue("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],st.prototype,"writeEditingEnabledToWebMap",null),p([_({readOnly:!0})],st.prototype,"effectiveEditingEnabled",null),p([_({clonable:!1,readOnly:!0})],st.prototype,"featureTitleFields",null),p([_({...HO.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:YO}}}}})],st.prototype,"fields",void 0),p([_(HO.fieldsIndex)],st.prototype,"fieldsIndex",void 0),p([_({type:FXe,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],st.prototype,"formTemplate",void 0),p([_({json:{read:{source:"layerDefinition.extent"}}})],st.prototype,"fullExtent",void 0),p([_({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:YO,writer(t,e,s){const i=t?$q.toJSON(t):null;i&&Hn(s,i,e)}}}},read:{source:"layerDefinition.geometryType",reader:$q.read}}})],st.prototype,"geometryType",void 0),p([_({json:{read:{source:"layerDefinition.hasM"}}})],st.prototype,"hasM",void 0),p([_({json:{read:{source:"layerDefinition.hasZ"}}})],st.prototype,"hasZ",void 0),p([_(dge)],st.prototype,"id",void 0),p([_({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],st.prototype,"infoFor3D",void 0),p([_({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],st.prototype,"isTable",void 0),p([qe("service","isTable",["type","geometryType"]),qe("isTable",["layerDefinition.type","layerDefinition.geometryType"])],st.prototype,"readIsTable",null),p([Ue("web-map","isTable")],st.prototype,"writeIsTable",null),p([_(dP)],st.prototype,"labelsVisible",void 0),p([_({type:[gx],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:GA,write:!1},"web-scene":{name:"layerDefinition.drawingInfo.labelingInfo",read:GA,write:{enabled:!0,layerContainerTypes:Gi}}},name:"layerDefinition.drawingInfo.labelingInfo",read:GA,write:!0}})],st.prototype,"labelingInfo",void 0),p([_((()=>{const t=he(I7e);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(e,s,i){Hn(i,a$(e),s)}}},t})())],st.prototype,"opacity",void 0),p([_(cge)],st.prototype,"legendEnabled",void 0),p([_({type:["show","hide"],json:(()=>{const t=he(pge.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],st.prototype,"listMode",void 0),p([qe("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],st.prototype,"readGlobalIdField",null),p([_({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:YO}}}}})],st.prototype,"objectIdField",void 0),p([qe("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],st.prototype,"readObjectIdField",null),p([_({type:["ArcGISFeatureLayer"],json:{write:{target:"layerType",ignoreOrigin:!0,layerContainerTypes:Gi}}})],st.prototype,"operationalLayerType",void 0),p([_(HO.outFields)],st.prototype,"outFields",void 0),p([_({readOnly:!0})],st.prototype,"parsedUrl",null),p([_({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],st.prototype,"path",void 0),p([_(mP)],st.prototype,"popupEnabled",void 0),p([_({type:v0,json:{name:"popupInfo",write:!0}})],st.prototype,"popupTemplate",void 0),p([_({readOnly:!0})],st.prototype,"defaultPopupTemplate",null),p([_({types:yx,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:bye,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:Gi,overridePolicy:(t,e,s)=>({ignoreOrigin:s==null?void 0:s.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,s)=>({ignoreOrigin:s==null?void 0:s.writeLayerSchema})}}})],st.prototype,"renderer",null),p([qe("service","renderer",["drawingInfo.renderer","defaultSymbol"]),qe("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],st.prototype,"readRenderer",null),p([_()],st.prototype,"resourceInfo",void 0),p([_((()=>{const t=he(lge);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],st.prototype,"screenSizePerspectiveEnabled",void 0),p([_({clonable:!1})],st.prototype,"source",null),p([Ht("source")],st.prototype,"castSource",null),p([qe("portal-item","source",["featureSet"]),qe("web-map","source",["featureSet"])],st.prototype,"readSource",null),p([_({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],st.prototype,"spatialReference",void 0),p([_({type:Number})],st.prototype,"subtypeCode",void 0),p([_({type:[U$]})],st.prototype,"templates",void 0),p([qe("templates",["editFieldsInfo","creatorField","editorField","templates"])],st.prototype,"readTemplates",null),p([_({type:Rye})],st.prototype,"timeInfo",void 0),p([_()],st.prototype,"title",void 0),p([qe("service","title",["name"]),qe("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],st.prototype,"readTitle",null),p([qe("web-map","title",["layerDefinition.name","title"])],st.prototype,"readTitleFromWebMap",null),p([_({type:String})],st.prototype,"sublayerTitleMode",void 0),p([_({json:{read:!1}})],st.prototype,"type",void 0),p([_({type:String})],st.prototype,"typeIdField",void 0),p([qe("service","typeIdField"),qe("typeIdField",["layerDefinition.typeIdField"])],st.prototype,"readTypeIdField",null),p([_({type:[z_e]})],st.prototype,"types",void 0),p([qe("service","types",["types"]),qe("types",["layerDefinition.types"])],st.prototype,"readTypes",null),p([_({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],st.prototype,"visible",void 0),p([qe("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],st.prototype,"readVisible",null),st=p([Q("esri.layers.FeatureLayer")],st);const U_e=st,wvt=Object.freeze(Object.defineProperty({__proto__:null,default:U_e},Symbol.toStringTag,{value:"Module"})),MWe="esri.widgets.Feature.support.arcadeFeatureUtils",XO=()=>Ne.getLogger(MWe);function AWe(t){return typeof t=="string"?vx(Y$(t)):Array.isArray(t)?NWe(t):(t==null?void 0:t.declaredClass)==="esri.arcade.Dictionary"?DWe(t):t}function NWe(t){return`<ul class="esri-widget__list">${t.map(e=>`<li>${typeof e=="string"?vx(Y$(e)):e}</li>`).join("")}</ul>`}function DWe(t){const e=t.keys().map(s=>{const i=t.field(s);return`<tr><th>${s}</th><td>${typeof i=="string"?vx(Y$(i)):i}</td></tr>`}).join("");return`<table class="${vt.table}">${e}</table>`}async function B_e(){const[t,e]=await Promise.all([me(()=>import("./arcade-Co0NP8Rl.js"),__vite__mapDeps([308,157])),me(()=>import("./arcade-BCBvbQ55.js").then(s=>s.aw),__vite__mapDeps([155,156,157,26,16,18]))]);return{executor:t,syntaxUtils:e}}function $We(t){return"createQuery"in t&&"queryFeatures"in t}async function RWe({graphic:t,view:e,options:s}){const{isAggregate:i,layer:r}=t;if(!i||!r||(e==null?void 0:e.type)!=="2d")return[];const n=await e.whenLayerView(r);if(!$We(n))return[];const o=n.createQuery(),a=t.getObjectId();o.aggregateIds=a!=null?[a]:[];const{features:l}=await n.queryFeatures(o,s);return l}function kWe({layer:t,aggregatedFeatures:e,interceptor:s}){const{fields:i,objectIdField:r,geometryType:n,spatialReference:o,displayField:a}=t;return new U_e({fields:i,objectIdField:r,geometryType:n,spatialReference:o,displayField:a,interceptor:s,...t.type==="feature"?{templates:t.templates,typeIdField:t.typeIdField,types:t.types}:null,source:e})}function FWe(t){const e=t.declaredClass==="esri.views.3d.layers.VoxelGraphic";return t.isAggregate?"popup-feature-reduction":e?"popup-voxel":"popup"}function j_e(t){var e,s;return{scale:t==null?void 0:t.scale,timeProperties:{currentStart:(e=t==null?void 0:t.timeExtent)==null?void 0:e.start,currentEnd:(s=t==null?void 0:t.timeExtent)==null?void 0:s.end,startIncluded:!0,endIncluded:!0}}}function OWe(t){return{$voxel:t}}async function LWe(t,e,s,i,r){let n=null;if(r.has("$aggregatedfeatures")){const o=await RWe({graphic:t,view:e,options:s}),a=t.sourceLayer||t.layer;n=kWe({layer:a,aggregatedFeatures:o,interceptor:i})}return{vars:{$feature:t,$aggregatedFeatures:n,$view:j_e(e)},[Symbol.dispose]:()=>n==null?void 0:n[Symbol.dispose]()}}function VWe(t,e,s,i){var n;const r=(t.sourceLayer||t.layer)??void 0;return{$feature:t,$layer:r!=null&&dXe(r)?r:(r==null?void 0:r.type)==="scene"&&r.associatedLayer!=null?r.associatedLayer:void 0,$map:e,$datastore:r==null?void 0:r.url,$userInput:s,$graph:(r==null?void 0:r.type)==="knowledge-graph-sublayer"?(n=r==null?void 0:r.parentCompositeLayer)==null?void 0:n.knowledgeGraph:void 0,$view:j_e(i)}}async function qWe(t,{graphic:e,map:s,location:i,view:r,options:n,interceptor:o,arcadeExecutor:a}){switch(t){case"popup":return{vars:VWe(e,s,i,r),[Symbol.dispose](){}};case"popup-feature-reduction":{const l=new Set(a.variablesUsed);return await LWe(e,r,n,o,l)}case"popup-voxel":return{vars:OWe(e),[Symbol.dispose](){}};default:throw new Error(`Unexpected profile name ${t}`)}}async function H_e({expressionInfo:t,arcade:{executor:e,syntaxUtils:s},graphic:i}){const r=t==null?void 0:t.expression;if(!r)return null;const n=FWe(i),o=e.createArcadeProfile(n);let a;try{a=await e.createArcadeExecutor(r,o)}catch(u){return XO().error("arcade-executor-error",{error:u,expressionInfo:t}),null}const l=new Set;return a.variablesUsed.includes("$view")&&(s.scriptUsesViewProperties(a.syntaxTree,["scale"])&&l.add("view-scale"),s.scriptUsesViewProperties(a.syntaxTree,["timeProperties"])&&l.add("view-time-extent")),{dependencies:l,async evaluate({graphic:u,interceptor:c,location:h,map:m,options:f,spatialReference:g,view:v}){const b=await qWe(n,{graphic:u,map:m,location:h,view:v,options:f,interceptor:c,arcadeExecutor:a}),w={abortSignal:(f==null?void 0:f.signal)??void 0,interceptor:c??void 0,rawOutput:!0,spatialReference:g??void 0,timeZone:v==null?void 0:v.timeZone,console(...S){XO().info(...S)}};try{return await a.executeAsync(b.vars,w)}catch(S){return void XO().error("arcade-execution-error",{error:S,graphic:u,expressionInfo:t})}finally{b[Symbol.dispose]()}}}}async function GWe(t,e){if(!(t!=null&&t.length))return{dependencies:new Set,expressions:new Map};const s=await B_e(),i=new Set,r=new Map;for(const n of t){const o=await H_e({expressionInfo:n,arcade:s,graphic:e});r.set(`expression/${n.name}`,o),o==null||o.dependencies.forEach(a=>i.add(a))}return{dependencies:i,expressions:r}}const Cse=1;let oa=class extends Ye{constructor(e){super(e),this._compileTask=null,this._evaluateTask=null,this.expressionInfo=null,this.graphic=null,this.contentElementViewModel=null,this.interceptor=null,this.location=null,this.view=null,this._createVM=()=>{var r,n;const s=(r=this.contentElement)==null?void 0:r.type;(n=this.contentElementViewModel)==null||n.destroy();const i=s==="fields"?new X$:s==="media"?new d_:s==="text"?new V3:null;this._set("contentElementViewModel",i)},this._compileThrottled=XE(this._startCompile,()=>this.notifyChange("state"),Cse,this),this._evaluateThrottled=XE(this._startEvaluate,()=>this.notifyChange("state"),Cse,this),this.addHandles([Ee(()=>[this.expressionInfo,this.graphic],()=>this._compileThrottled(),ht),Ee(()=>[this.contentElement],()=>this._createVM(),ht),Or(()=>{var r,n,o,a,l,u;if(!((r=this._compileTask)!=null&&r.finished))return null;const s=this._compileTask.value,i=s==null?void 0:s.dependencies;return[s,this.spatialReference,this.map,this.view,i!=null&&i.has("view-scale")?(n=this.view)==null?void 0:n.scale:null,i!=null&&i.has("view-time-extent")?(a=(o=this.view)==null?void 0:o.timeExtent)==null?void 0:a.start:null,i!=null&&i.has("view-time-extent")?(u=(l=this.view)==null?void 0:l.timeExtent)==null?void 0:u.end:null]},([s])=>this._evaluateThrottled(s))])}initialize(){this.addHandles([this._compileThrottled,this._evaluateThrottled])}destroy(){var e;this._compileTask=Do(this._compileTask),this._evaluateTask=Do(this._evaluateTask),(e=this.contentElementViewModel)==null||e.destroy(),this._set("contentElementViewModel",null)}get contentElement(){var e;return(e=this._evaluateTask)==null?void 0:e.value}get spatialReference(){var e;return((e=this.view)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){var i,r;const{contentElement:e,contentElementViewModel:s}=this;return this._compileThrottled.hasPendingUpdates()||this._evaluateThrottled.hasPendingUpdates()||!((i=this._compileTask)!=null&&i.finished)||!((r=this._evaluateTask)!=null&&r.finished)?"loading":e||s?"ready":"disabled"}get map(){var e;return((e=this.view)==null?void 0:e.map)??null}set map(e){this._override("map",e)}_startCompile(){this._evaluateTask=Do(this._evaluateTask),this._compileTask=Do(this._compileTask),this._compileTask=Id(async e=>{const{expressionInfo:s,graphic:i}=this;if(!s||!i)return null;const r=await B_e();ni(e);const n=await H_e({expressionInfo:s,arcade:r,graphic:i});return ni(e),n})}_startEvaluate(e){this._evaluateTask=Do(this._evaluateTask),this._evaluateTask=Id(async s=>{const{graphic:i}=this;if(!e||!i)return null;const{interceptor:r,spatialReference:n,map:o,location:a,view:l}=this,u=await e.evaluate({graphic:i,interceptor:r,location:a,map:o,options:{signal:s},spatialReference:n,view:l});ni(s);const c=u;if(!c||c.declaredClass!=="esri.arcade.Dictionary")return null;const h=await c.castAsJsonAsync(s);ni(s);const m=h==null?void 0:h.type,f=m==="media"?Ab.fromJSON(h):m==="text"?Q_.fromJSON(h):m==="fields"?Z_.fromJSON(h):null;return f.type==="media"&&!f.mediaInfos||f.type==="fields"&&!f.fieldInfos||f.type==="text"&&!f.text?null:f})}};p([_()],oa.prototype,"_compileTask",void 0),p([_()],oa.prototype,"_evaluateTask",void 0),p([_({type:fme})],oa.prototype,"expressionInfo",void 0),p([_({type:tn})],oa.prototype,"graphic",void 0),p([_({readOnly:!0})],oa.prototype,"contentElement",null),p([_({readOnly:!0})],oa.prototype,"contentElementViewModel",void 0),p([_()],oa.prototype,"interceptor",void 0),p([_({type:Et})],oa.prototype,"location",void 0),p([_()],oa.prototype,"spatialReference",null),p([_({readOnly:!0})],oa.prototype,"state",null),p([_()],oa.prototype,"map",null),p([_()],oa.prototype,"view",void 0),oa=p([Q("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],oa);const u9=oa,Pse="esri-feature",Tse={base:`${Pse}-expression`,loadingSpinnerContainer:`${Pse}__loading-container`};let JA=class extends Er{constructor(e,s){super(e,s),this._contentWidget=null,this.viewModel=new u9}initialize(){this.addHandles(Ee(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentElementViewModel},()=>this._setupExpressionWidget(),ht))}loadDependencies(){return sl({loader:()=>me(()=>import("./index-B0fAt0SM.js"),__vite__mapDeps([240,241,242]))})}destroy(){this._destroyContentWidget()}render(){var s;const{state:e}=this.viewModel;return K("div",{class:Tse.base},e==="loading"?this._renderLoading():e==="disabled"?null:(s=this._contentWidget)==null?void 0:s.render())}_renderLoading(){return K("div",{class:Tse.loadingSpinnerContainer,key:"loading-container"},K("calcite-loader",{inline:!0,label:""}))}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:s}=this.viewModel,i=s==null?void 0:s.type;this._destroyContentWidget();const r=e?i==="fields"?new o_e({viewModel:e}):i==="media"?new E_e({viewModel:e}):i==="text"?new UA({viewModel:e}):null:null;this._contentWidget=r,this.scheduleRender()}};p([_({type:u9})],JA.prototype,"viewModel",void 0),JA=p([Q("esri.widgets.Feature.FeatureExpression")],JA);const zWe=JA;var Ise,Mse;(function(t){t.Text="text",t.Number="number",t.Date="date",t.Unsupported="unsupported"})(Ise||(Ise={})),function(t){t.CANNOT_BE_EMPTY="input-validation-error::cannot-be-empty",t.TOO_SHORT="length-validation-error::too-short",t.TOO_LONG="length-validation-error::too-long"}(Mse||(Mse={}));const UWe=t=>{var s;const e=[];if(t.formTemplate){const{description:i,title:r}=t.formTemplate;(s=t.fields)==null||s.forEach(n=>{const o=r&&GX(r,n.name),a=i&&GX(i,n.name);(o||a)&&e.push(n.name)})}return e},WO=100;let is=class extends Wt.ClonableMixin(sh.IdentifiableMixin(Ye)){constructor(e){super(e),this._loaded=!1,this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.activeCategory=null,this.allCategories=null,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:s}=this;s&&s.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:s}=this;s&&s.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:s}=this;s&&s.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const s=new AbortController;this._queryAbortController=s,await zl(this._query()),this._queryAbortController===s&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._loaded=!1,this._cancelQueryFeatureCount();const s=new AbortController;this._queryFeatureCountAbortController=s,await zl(this._queryFeatureCount()),this._queryFeatureCountAbortController===s&&(this._queryFeatureCountAbortController=null),this._loaded=!0},this._queryPageController=async()=>{const s=new AbortController;this._queryPageAbortController=s,await zl(this._queryPage()),this._queryPageAbortController===s&&(this._queryPageAbortController=null)},this._queryDebounced=jh(this._queryController,WO),this._queryFeatureCountDebounced=jh(this._queryFeatureCountController,WO),this._queryPageDebounced=jh(this._queryPageController,WO),this._query=async()=>{var r;const{_queryAbortController:s,relatedFeatures:i}=this;this.featureCount&&(((r=this.relatedLayer)==null?void 0:r.type)!=="subtype-group"||this.activeCategory)&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,i.destroyAll(),this.destroyed||i.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:s==null?void 0:s.signal}))))},this.addHandles([Ee(()=>{var s;return[this.displayCount,this.graphic,this.layer,(s=this.layer)==null?void 0:s.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount,this.activeCategory]},()=>this._queryDebounced(),ht),Ee(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),Ee(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery,this.activeCategory],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.destroyAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:s,featureCount:i}=this,r=1,n=Math.ceil(i/s)||1;this._set("featurePage",Math.min(Math.max(e,r),n))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:s}=this;return e&&(s!=null&&s.loaded)?e.map(i=>{const r=i.clone();return r.field=kb(i.field,s),r}):e??[]}get supportsCacheHint(){var e,s,i;return!!((i=(s=(e=this.layer)==null?void 0:e.capabilities)==null?void 0:s.queryRelated)!=null&&i.supportsCacheHint)}get canLoad(){return!!this.map&&this.relationshipId!=null&&typeof this.objectId=="number"}get canQuery(){var s,i;const e=(i=(s=this.layer)==null?void 0:s.capabilities)==null?void 0:i.queryRelated;return!!(this.relatedLayer&&this.relationship&&this.relationshipId!=null&&this.objectId!=null&&(e!=null&&e.supportsCount)&&(e!=null&&e.supportsPagination))}get allCategoriesCount(){var e;return((e=this.allCategories)==null?void 0:e.length)??0}get categories(){const{allCategories:e}=this;return this.showAllEnabled?e:(e==null?void 0:e.slice(0,this.displayCount))??null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e??3,0),10))}get displayCount(){return this._get("displayCount")}get itemDescriptionFieldName(){var e;return((e=this.orderByFieldsFixedCasing[0])==null?void 0:e.field)||null}get objectId(){var e,s;return(this.objectIdField&&((s=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:s[this.objectIdField]))??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new Ge}get relatedLayer(){const{layer:e,map:s,relationship:i}=this;if(!(e!=null&&e.loaded)||!s||!i)return null;const r=e.type==="subtype-sublayer"&&e.parent&&pP(e.parent)?e.parent:e;return s_e(s,r,i)??null}get relatedLayerKeyField(){var i,r;const{relatedLayer:e,relationshipId:s}=this;return e!=null&&e.loaded&&s!=null?(r=(i=e.relationships)==null?void 0:i.find(n=>n.id===s))==null?void 0:r.keyField:null}get relatedLayerKeyFields(){var s;const{relatedLayer:e}=this;return e!=null&&e.loaded?((s=e.relationships)==null?void 0:s.map(i=>i.keyField).filter(Qa))??[]:[]}get relationship(){var i;const{relationshipId:e,layer:s}=this;return e!=null&&(s!=null&&s.loaded)?((i=s.relationships)==null?void 0:i.find(({id:r})=>r===e))??null:null}get relationshipKey(){var s,i;const{relationshipKeyField:e}=this;return(e&&((i=(s=this.graphic)==null?void 0:s.attributes)==null?void 0:i[e]))??null}get relationshipKeyField(){var e;return((e=this.relationship)==null?void 0:e.keyField)||null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new Ge}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:s,_queryPageAbortController:i,canQuery:r,_loaded:n,canLoad:o}=this;return s||o&&!n?"loading":e||i?"querying":r?"ready":"disabled"}getRelatedFeatureByObjectId(e){return this.relatedFeatures.find(s=>s.getObjectId()===e)}refresh(){this._queryFeatureCountDebounced()}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.destroyAll()}async _queryFeatureCount(){const{layer:e,relatedLayer:s}=this;await(e==null?void 0:e.load()),await(s==null?void 0:s.load());const{_queryFeatureCountAbortController:i,activeCategory:r,canQuery:n,objectId:o,relatedLayerKeyField:a,relationshipId:l,relationshipKey:u,supportsCacheHint:c}=this;if(!n||!e||!s||o==null)return this._set("featureCount",0),void this._set("allCategories",null);if((s==null?void 0:s.type)==="subtype-group"&&!r){if(this._set("featureCount",0),this._destroyRelatedFeatureViewModels(),this.featurePage=1,this.relatedFeatures.destroyAll(),a&&u!=null){const{default:v}=await me(()=>import("./uniqueValues-KV5n-DWx.js"),__vite__mapDeps([309,3,4,5,6,2,199,14,10,21])),{uniqueValueInfos:b}=await v({layer:s,sqlWhere:`${a} = '${u}'`,field:s.subtypeField,signal:i==null?void 0:i.signal}),w=b.map(({count:S,value:T})=>{var I,A;const P=(A=(I=s.subtypes)==null?void 0:I.find(D=>D.code===T))==null?void 0:A.name;return T!=null&&P?{count:S,value:T,name:P}:void 0}).filter(Qa);this._set("allCategories",w)}return}const{historicMoment:h,gdbVersion:m}=e,f=new Rb({cacheHint:c,gdbVersion:m,historicMoment:h,relationshipId:l,returnGeometry:!1,objectIds:[o],where:this._getRelationshipWhereClause(s)}),g=await e.queryRelatedFeaturesCount(f,{signal:i==null?void 0:i.signal});this._set("allCategories",null),this._set("featureCount",g[o]||0)}_getRelationshipWhereClause(e){const{activeCategory:s}=this,i=e.createQuery(),r="subtypeField"in e?e.subtypeField:void 0,n=s&&r?`${r} = ${s.value}`:void 0,o=i.where;return o&&n?`(${o}) AND (${n})`:o??n}_sliceFeatures(e){const{showAllEnabled:s,displayCount:i}=this;return s?e:i?e.slice(0,i):[]}async _queryPage(){var o;const{relatedFeatures:e,featurePage:s,showAllEnabled:i,_queryPageAbortController:r,featureCount:n}=this;!i||s<2||!n||((o=this.relatedLayer)==null?void 0:o.type)==="subtype-group"&&!this.activeCategory||e.addMany(await this._queryRelatedFeatures({signal:r==null?void 0:r.signal}))}async _queryRelatedFeatures(e){var O;const{displayCount:s,featureCount:i,featurePage:r,featuresPerPage:n,layer:o,orderByFieldsFixedCasing:a,relatedLayer:l,relatedLayerKeyFields:u,relationshipId:c,showAllEnabled:h,supportsCacheHint:m}=this,{canQuery:f,objectId:g}=this;if(!f||!o||!l||g==null)return[];const v=h?((r-1)*n+i)%i:0,b=h?n:s,w=l.objectIdField,S="subtypeField"in l?l.subtypeField:void 0,T=[...a.map(z=>z.field),...UWe(l),...u,w,S].filter(BWe),P=a.map(z=>`${z.field} ${z.order}`),{historicMoment:I,gdbVersion:A}=o,D=new Rb({orderByFields:P,start:v,num:b,outFields:T,cacheHint:m,historicMoment:I,gdbVersion:A,relationshipId:c,returnGeometry:!1,objectIds:[g],where:this._getRelationshipWhereClause(l)}),k=await o.queryRelatedFeatures(D,{signal:e==null?void 0:e.signal}),R=((O=k[g])==null?void 0:O.features)||[];return l.type==="subtype-group"&&S?R.forEach(z=>{var V;const q=z.attributes[S],U=(V=l.findSublayerForSubtypeCode)==null?void 0:V.call(l,q);z.sourceLayer=U,z.layer=U}):R.forEach(z=>{z.sourceLayer=l,z.layer=l}),R}};function BWe(t){return t!=null&&t!==""}p([_()],is.prototype,"_loaded",void 0),p([_()],is.prototype,"_queryAbortController",void 0),p([_()],is.prototype,"_queryPageAbortController",void 0),p([_()],is.prototype,"_queryFeatureCountAbortController",void 0),p([_({value:1})],is.prototype,"featurePage",null),p([_()],is.prototype,"featuresPerPage",void 0),p([_({readOnly:!0})],is.prototype,"orderByFieldsFixedCasing",null),p([_({readOnly:!0})],is.prototype,"supportsCacheHint",null),p([_({readOnly:!0})],is.prototype,"canLoad",null),p([_({readOnly:!0})],is.prototype,"canQuery",null),p([_()],is.prototype,"activeCategory",void 0),p([_({readOnly:!0})],is.prototype,"allCategories",void 0),p([_({readOnly:!0})],is.prototype,"allCategoriesCount",null),p([_({readOnly:!0})],is.prototype,"categories",null),p([_()],is.prototype,"description",void 0),p([_({value:3})],is.prototype,"displayCount",null),p([_({type:tn})],is.prototype,"graphic",void 0),p([_({readOnly:!0})],is.prototype,"itemDescriptionFieldName",null),p([_()],is.prototype,"layer",void 0),p([_()],is.prototype,"map",void 0),p([_({readOnly:!0})],is.prototype,"objectId",null),p([_({readOnly:!0})],is.prototype,"objectIdField",null),p([_()],is.prototype,"orderByFields",void 0),p([_({readOnly:!0})],is.prototype,"relatedFeatures",null),p([_({readOnly:!0})],is.prototype,"relatedLayer",null),p([_({readOnly:!0})],is.prototype,"relatedLayerKeyField",null),p([_({readOnly:!0})],is.prototype,"relatedLayerKeyFields",null),p([_({readOnly:!0})],is.prototype,"relationship",null),p([_({readOnly:!0})],is.prototype,"relationshipKey",null),p([_({readOnly:!0})],is.prototype,"relationshipKeyField",null),p([_({readOnly:!0})],is.prototype,"featureCount",void 0),p([_({readOnly:!0})],is.prototype,"relatedFeatureViewModels",null),p([_()],is.prototype,"relationshipId",void 0),p([_()],is.prototype,"showAllEnabled",void 0),p([_()],is.prototype,"state",null),p([_()],is.prototype,"title",void 0),is=p([Q("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],is);const c9=is;var KA;const eN="esri-feature",n2=`${eN}-relationship`,Am={base:n2,listContainer:`${n2}__list`,listItem:`${n2}__list-item`,listItemHidden:`${n2}__list-item--hidden`,listContainerQuerying:`${n2}__list--querying`,featureObserver:`${eN}__feature-observer`,stickySpinnerContainer:`${eN}__sticky-loading-container`,loadingSpinnerContainer:`${eN}__loading-container`},Ase={title:!0,description:!0};let Rn=KA=class extends Er{constructor(t,e){super(t,e),this._featureElementInfo=null,this._relatedFeatureIntersectionObserverNode=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver(([s])=>{s!=null&&s.isIntersecting&&this._increaseFeaturePage()},{root:window.document}),this.flowItems=null,this.flowType="feature-relationship",this.headingLevel=2,this.viewModel=new c9,this.messages=null,this.messagesCommon=null,this.visibleElements={...Ase},this._increaseFeaturePage=()=>{const{state:s,showAllEnabled:i,relatedFeatures:r,featuresPerPage:n,featurePage:o}=this.viewModel;s==="ready"&&i&&r.length>=n*o&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new fP,this.addHandles([Ee(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),ht),Ee(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),Vo(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return sl({chip:()=>me(()=>import("./index-or2Je7JW.js"),__vite__mapDeps([310,243,244,241,245,246,251,249,261,242])),icon:()=>me(()=>import("./index-BhFhNIYS.js").then(t=>t.i),__vite__mapDeps([243,244,241,245])),list:()=>me(()=>import("./index-kzOfcToX.js"),__vite__mapDeps([272,240,241,242,273,246,245,244,254,243,274,275,276,247,248,249,261,250,251,257,270])),"list-item":()=>me(()=>import("./index-B_oefgqS.js"),__vite__mapDeps([264,243,244,241,245,265,246,256,257,249,261,251,258,266,240,242,253,254,267,268,269,270,271])),loader:()=>me(()=>import("./index-B0fAt0SM.js"),__vite__mapDeps([240,241,242])),notice:()=>me(()=>import("./index-DW-iT0Or.js"),__vite__mapDeps([277,243,244,241,245,246,251,258,242]))})}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=ii(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:t,featureCount:e,displayCount:s,state:i,allCategoriesCount:r}=this.viewModel;return!t&&i==="ready"&&(!!r&&(r>s||s===0)||!!e&&(e>s||s===0))}get displayListItems(){const{relatedFeatureViewModels:t,allCategoriesCount:e}=this.viewModel;return this.displayShowAllButton||!!t.length||!!e}get allItemsDescription(){const{messages:t}=this,{featureCount:e,allCategories:s,allCategoriesCount:i}=this.viewModel;return Nu(t==null?void 0:t.numberRecords,{number:Un(s?i:e)})}get description(){return this.viewModel.description}set description(t){this.viewModel.description=t}get title(){const{activeCategory:t,title:e}=this.viewModel;return(t==null?void 0:t.name)??e}set title(t){this.viewModel.title=t}castVisibleElements(t){return{...Ase,...t}}render(){var e;const{state:t}=this.viewModel;return K("div",{class:this.classes(Am.base,vt.widget)},(e=this._featureElementInfo)==null?void 0:e.render(),t==="loading"?this._renderLoading():t==="disabled"?this._renderRelationshipNotFound():this._renderRelatedFeatures())}async _selectCategory(t){const{flowItems:e,featureVisibleElements:s,viewModel:i}=this;e&&(i.activeCategory=t,i.showAllEnabled=!0,e.push(new KA({flowItems:e,featureVisibleElements:s,visibleElements:{title:!1,description:!1},viewModel:i})))}async _selectRecord(t){const{flowItems:e,featureVisibleElements:s}=this;if(!e)return;t.abilities={relationshipContent:!0};const{default:i}=await me(()=>Promise.resolve().then(()=>ZWe),void 0);e.push(new i({flowItems:e,flowType:this.flowType,viewModel:t,visibleElements:s}))}_showAllRecords(){const{flowItems:t}=this;if(!t)return;const{viewModel:e,featureVisibleElements:s}=this;e.showAllEnabled=!0;const i=new KA({flowItems:t,featureVisibleElements:s,visibleElements:{title:!1,description:!1},viewModel:e});t.push(i)}_renderStickyLoading(){return this.viewModel.state==="querying"?K("div",{class:Am.stickySpinnerContainer,key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return K("calcite-loader",{inline:!0,label:""})}_renderLoading(){return K("div",{class:Am.loadingSpinnerContainer,key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return K("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const t=zh(this.container)?"chevron-left":"chevron-right";return K("calcite-icon",{icon:t,scale:"s",slot:"content-end"})}_renderCategory(t){const{count:e,name:s,value:i}=t,r=Un(e);return K("calcite-list-item",{class:Am.listItem,disabled:!e,key:i,label:s,onCalciteListItemSelect:()=>this._selectCategory(t)},K("calcite-chip",{label:r,scale:"s",slot:"content-end"},r),this._renderChevronIconNode())}_renderRelatedFeature(t){var r;const{itemDescriptionFieldName:e}=this.viewModel,s=t.title;t.description=e&&((r=t.formattedAttributes)==null?void 0:r.global[e]);const i=t.state==="loading";return K("calcite-list-item",{class:this.classes(Am.listItem,{[Am.listItemHidden]:i}),description:F_(t.description??""),key:t.uid,label:F_(s),onCalciteListItemSelect:()=>this._selectRecord(t)},this._renderChevronIconNode())}_renderShowAllListItem(){var t;return this.displayShowAllButton?K("calcite-list-item",{description:this.allItemsDescription,key:"show-all-item",label:(t=this.messages)==null?void 0:t.showAll,onCalciteListItemSelect:()=>this._showAllRecords()},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){var t;return K("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},K("div",{slot:"message"},(t=this.messages)==null?void 0:t.noRelatedFeatures))}_renderFeatureObserver(){return K("div",{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:Am.featureObserver,key:"feature-observer"})}_renderList(){var s;const{relatedFeatureViewModels:t,categories:e}=this.viewModel;return K("calcite-list",{displayMode:"flat",label:(s=this.messages)==null?void 0:s.relatedFeaturesList},(e==null?void 0:e.map(i=>this._renderCategory(i)))??t.toArray().map(i=>this._renderRelatedFeature(i)),this._renderShowAllListItem())}_renderRelatedFeatures(){const{displayListItems:t}=this,{state:e}=this.viewModel;return K("div",{class:this.classes(Am.listContainer,{[Am.listContainerQuerying]:e==="querying"}),key:"list-container"},t?this._renderList():e==="ready"?this._renderNoRelatedFeaturesMessage():null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){var t;return K("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},K("div",{slot:"message"},(t=this.messages)==null?void 0:t.relationshipNotFound))}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:t}=this.viewModel,e="related-feature-viewmodels";this.removeHandles(e),t==null||t.forEach(s=>{this.addHandles(Ee(()=>[s.title,s.state],()=>this.scheduleRender(),ht),e)}),this.scheduleRender()}_setupFeatureElementInfo(){var r;const{headingLevel:t,visibleElements:e}=this,s=e.description&&this.description,i=e.title&&this.title;(r=this._featureElementInfo)==null||r.set({description:s,title:i,headingLevel:t})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:t,showAllEnabled:e}=this.viewModel;await FC(0),this._relatedFeatureIntersectionObserverNode&&t==="ready"&&e&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(t){this._relatedFeatureIntersectionObserverNode=t}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};p([_()],Rn.prototype,"_relatedFeatureIntersectionObserverNode",void 0),p([_({readOnly:!0})],Rn.prototype,"displayShowAllButton",null),p([_({readOnly:!0})],Rn.prototype,"displayListItems",null),p([_({readOnly:!0})],Rn.prototype,"allItemsDescription",null),p([_()],Rn.prototype,"description",null),p([_()],Rn.prototype,"featureVisibleElements",void 0),p([_()],Rn.prototype,"flowItems",void 0),p([_()],Rn.prototype,"flowType",void 0),p([_()],Rn.prototype,"headingLevel",void 0),p([_()],Rn.prototype,"title",null),p([_({type:c9})],Rn.prototype,"viewModel",void 0),p([_(),ur("esri/widgets/Feature/t9n/Feature")],Rn.prototype,"messages",void 0),p([_(),ur("esri/t9n/common")],Rn.prototype,"messagesCommon",void 0),p([_()],Rn.prototype,"visibleElements",void 0),p([Ht("visibleElements")],Rn.prototype,"castVisibleElements",null),Rn=KA=p([Q("esri.widgets.Feature.FeatureRelationship")],Rn);const jWe=Rn;let TS=class extends Ye{constructor(e){super(e),this.title=!0,this.description=!0}};p([_({type:Boolean,nonNullable:!0})],TS.prototype,"title",void 0),p([_({type:Boolean,nonNullable:!0})],TS.prototype,"description",void 0),TS=p([Q("esri.widgets.Feature.FeatureUtilityNetworkAssociations.VisibleElements")],TS);const Y_e=TS;let wc=class extends Te{constructor(e){super(e),this.assetGroupCode=null,this.assetTypeCode=null,this.globalId=null,this.networkSourceId=null,this.objectId=null,this.positionFrom=null,this.positionTo=null,this.terminalId=null}};p([_({type:Number,json:{write:!0}})],wc.prototype,"assetGroupCode",void 0),p([_({type:Number,json:{write:!0}})],wc.prototype,"assetTypeCode",void 0),p([_({type:String,json:{write:!0}})],wc.prototype,"globalId",void 0),p([_({type:Number,json:{write:!0}})],wc.prototype,"networkSourceId",void 0),p([_({type:Number,json:{write:!0}})],wc.prototype,"objectId",void 0),p([_({type:Number,json:{write:!0}})],wc.prototype,"positionFrom",void 0),p([_({type:Number,json:{write:!0}})],wc.prototype,"positionTo",void 0),p([_({type:Number,json:{write:!0}})],wc.prototype,"terminalId",void 0),wc=p([Q("esri.rest.networks.support.NetworkElement")],wc);const HWe=wc,WI={assetGroup:"assetgroup",assetType:"assettype"},Nse=100;let Qt=class extends Wt.ClonableMixin(sh.IdentifiableMixin(Ye)){constructor(e){super(e),this._loaded=!1,this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.networkSourceIdsInUse=new Set,this.source="popup",this.description=null,this.graphic=null,this.layer=null,this.map=null,this.featureCount=0,this.associationTypes=null,this.showAllEnabled=!1,this.title=null,this.attachmentsFeatureCount=0,this.structureFeatureCount=0,this.contentFeatureCount=0,this.containerFeatureCount=0,this.connectivityFeatureCount=0,this._queryOpenAssociationType=async()=>{this.activeAssociationType&&await this._queryDebounced(this.activeAssociationType)},this._cancelQuery=()=>{const{_queryAbortController:s}=this;s&&s.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:s}=this;s&&s.abort(),this._queryFeatureCountAbortController=null},this._queryController=async s=>{this._cancelQuery();const i=new AbortController;this._queryAbortController=i,await zl(this._query(s)),this._queryAbortController===i&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._loaded=!1,this._cancelQueryFeatureCount();const s=new AbortController;this._queryFeatureCountAbortController=s,await zl(this._queryFeatureCount()),this._queryFeatureCountAbortController===s&&(this._queryFeatureCountAbortController=null),this._loaded=!0},this._queryDebounced=jh(this._queryController,Nse),this._queryFeatureCountDebounced=jh(this._queryFeatureCountController,Nse)}initialize(){this.addHandles([Ee(()=>[this.graphic,this.layer,this.map,this.associationTypes,this.objectId,this.globalId,this.canQuery],()=>this.refresh(),ht),Ee(()=>this.activeAssociationType,e=>this._queryDebounced(e),ht)])}destroy(){this._cancelQuery(),this._cancelQueryFeatureCount(),this._destroyAssociatedFeatureViewModels()}get supportsCacheHint(){var e,s,i;return!!((i=(s=(e=this.layer)==null?void 0:e.capabilities)==null?void 0:s.query)!=null&&i.supportsCacheHint)}get canLoad(){return!!this.map&&!!this.associationTypes&&typeof this.globalId=="string"}get canQuery(){var s,i;const e=(i=(s=this.layer)==null?void 0:s.capabilities)==null?void 0:i.query;return!!this.associationTypes&&typeof this.globalId=="string"&&!!(e!=null&&e.supportsPagination)}set displayCount(e){this._set("displayCount",Math.max(e??3,0))}get displayCount(){return this._get("displayCount")}get objectId(){var e,s;return(this.objectIdField&&((s=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:s[this.objectIdField]))??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get globalId(){var e,s;return(this.globalIdField&&((s=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:s[this.globalIdField]))??null}get globalIdField(){const{layer:e}=this;return e==null?void 0:e.globalIdField}get activeAssociationType(){return this._get("activeAssociationType")}set activeAssociationType(e){e&&!this.associationTypes.includes(e)||this._set("activeAssociationType",e)}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:s,_queryPageAbortController:i,canQuery:r,_loaded:n,canLoad:o,source:a}=this;return s||o&&!n?"loading":e||i?"querying":!r||a==="popup"&&this.featureCount===0?"disabled":"ready"}get utilityNetwork(){const{layer:e,map:s}=this;if(!(e!=null&&e.loaded)||!s)return null;const i=cd(e)?e.parent:e;return i_e(s,i)}get attachmentsAssociations(){return this._get("attachmentsAssociations")||new Ge}get structureAssociations(){return this._get("structureAssociations")||new Ge}get contentAssociations(){return this._get("contentAssociations")||new Ge}get containerAssociations(){return this._get("containerAssociations")||new Ge}get connectivityAssociations(){return this._get("connectivityAssociations")||new Ge}get associationFeatures(){return this._get("associationFeatures")||new E_}get associationViewModels(){return this._get("associationViewModels")||new Map}async refresh(){await this._queryFeatureCountDebounced(),await this._queryOpenAssociationType()}getFeatureCountForAssociationType(e){switch(e){case"attachment":return this.attachmentsFeatureCount;case"structure":return this.structureFeatureCount;case"content":return this.contentFeatureCount;case"container":return this.containerFeatureCount;case"connectivity":return this.connectivityFeatureCount}}_destroyAssociatedFeatureViewModels(){this.associationViewModels.forEach(e=>e.destroyAll())}async _loadUtiltyNetworks(){var i;const e=this.map;if(!e)return;await Promise.allSettled(((i=e.utilityNetworks)==null?void 0:i.map(async r=>{await r.load()}))??[]);const s=this.utilityNetwork;if(s){const r=n=>{if("layerId"in n&&s.isUtilityLayer(n)){const o=s.getSourceIdByLayerId(n.layerId);o!==null&&this.networkSourceIdsInUse.add(o)}};this._set("networkSourceIdsInUse",new Set),e.allLayers.forEach(r),e.allTables.forEach(r)}}async _findLayersBySourceId(e){const{utilityNetwork:s,map:i}=this,r=u=>{const c=u;return u.url&&c.layerId===n?u.url.replace(/\/\d+$/,"")===(s==null?void 0:s.featureServiceUrl):!1};await(s==null?void 0:s.load());const n=s.getLayerIdBySourceId(e),o=i.allLayers.filter(r),a=i.allTables.filter(r),l=o.concat(a).toArray();return await Promise.allSettled(l.map(u=>u.load())),l}_clearAssociations(){this.attachmentsAssociations.removeAll(),this.structureAssociations.removeAll(),this.contentAssociations.removeAll(),this.containerAssociations.removeAll(),this.connectivityAssociations.removeAll()}_clearFeatures(){this.associationFeatures.forEach(e=>e.removeAll()),this.associationFeatures.clear()}_getAssociationsByType(e){switch(e){case"attachment":return this.attachmentsAssociations;case"structure":return this.structureAssociations;case"connectivity":return this.connectivityAssociations;case"container":return this.containerAssociations;case"content":return this.contentAssociations}}async _queryLayer(e,s,i,r,n){const o=e.fieldsIndex.get(WI.assetGroup),a=e.fieldsIndex.get(WI.assetType),l=i!=null,u=r!=null,c="("+s.map(v=>`'${v}'`).join(", ")+")",h=l?` AND ${o==null?void 0:o.name} = ${i}`:"",m=l&&u?` AND ${a==null?void 0:a.name} = ${r}`:"",f=`${e.globalIdField} IN ${c}`+h+m,g=new xn({outFields:["*"],cacheHint:this.supportsCacheHint,where:f});return await this._queryAll(g,e,{signal:n==null?void 0:n.signal})}async _createAssociationFeatureObjects(e,s,i,r,n,o){if(e.length===0)return[];const a=new Map;for(const[u,c]of s){const h=await this._findLayersBySourceId(u);for(const m of h)(await this._queryLayer(m,c,r,n,o)).forEach(f=>{if(this.source==="popup"?f.layer&&f.getEffectivePopupTemplate():f.layer){const g=a.get(f.attributes[m.globalIdField])??[];g.push(f),a.set(f.attributes[m.globalIdField],g)}})}const l=[];return await Promise.all(e.toArray().map(async u=>{const{fromNetworkElement:c,toNetworkElement:h}=u,m=c.globalId===i?h:c,f=a.get(m.globalId)??[];await Promise.all(f.map(async g=>{var b,w;const v=(w=(b=this.utilityNetwork)==null?void 0:b.getTerminalById(m==null?void 0:m.terminalId))==null?void 0:w.name;if(g.layer&&"getFeatureTitle"in g.layer){const S=await g.layer.getFeatureTitle(g);l.push({title:S,association:u,feature:g,terminalName:v})}else l.push({association:u,feature:g,terminalName:v})}))})),l}_parseFeatureObjects(e,s){e.forEach(i=>{const r=i==null?void 0:i.feature,n=r.layer,o=s.get(n)??new Ge;o.add(i),s.set(n,o)})}async _queryAll(e,s,i){var a;const r=[];let n=0,o=!1;e.num=((a=s.sourceJSON)==null?void 0:a.maxRecordCount)??2e3;do{e.start=n;const l=await s.queryFeatures(e,i);r.push(...l.features),o=l.exceededTransferLimit,o&&(n+=l.features.length)}while(o);return r}async _queryAssociations(e){const{layer:s,globalId:i,associationTypes:r,utilityNetwork:n,canQuery:o}=this;if(await Promise.allSettled([s==null?void 0:s.load(),n==null?void 0:n.load()]),this._clearAssociations(),!(o&&s&&r&&n&&i))return;const a=cd(s)?s.parent:s,l=new HWe({globalId:i,networkSourceId:n.getSourceIdByLayerId(a.layerId)}),u=new Set;r.forEach(g=>{switch(g.type){case"attachment":case"structure":u.add("attachment");break;case"container":case"content":u.add("containment");break;case"connectivity":u.add("connectivity"),u.add("junction-junction-connectivity"),u.add("junction-edge-from-connectivity"),u.add("junction-edge-midspan-connectivity"),u.add("junction-edge-to-connectivity")}});const c=await(n==null?void 0:n.queryAssociations({elements:[l],types:Array.from(u)},{signal:e==null?void 0:e.signal})),h=new Map,m=new Map;r.forEach(g=>{m.set(g.type,g),h.set(g.type,[])}),c.forEach(g=>{var w,S,T,P,I,A;const{toNetworkElement:v,fromNetworkElement:b}=g;switch(g.associationType){case"connectivity":case"junction-junction-connectivity":case"junction-edge-from-connectivity":case"junction-edge-midspan-connectivity":case"junction-edge-to-connectivity":if((b==null?void 0:b.globalId)===i){if(this._shouldDiscardNetworkElement(v,"connectivity",m))break;(w=h.get("connectivity"))==null||w.push(v.globalId)}else{if(this._shouldDiscardNetworkElement(b,"connectivity",m))break;(S=h.get("connectivity"))==null||S.push(b.globalId)}this.connectivityAssociations.add(g);break;case"containment":if((b==null?void 0:b.globalId)===i){if(this._shouldDiscardNetworkElement(v,"content",m))break;(T=h.get("content"))==null||T.push(v.globalId),this.contentAssociations.add(g)}else{if(this._shouldDiscardNetworkElement(b,"container",m))break;(P=h.get("container"))==null||P.push(b.globalId),this.containerAssociations.add(g)}break;case"attachment":if((b==null?void 0:b.globalId)===i){if(this._shouldDiscardNetworkElement(v,"attachment",m))break;(I=h.get("attachment"))==null||I.push(v.globalId),this.attachmentsAssociations.add(g)}else{if(this._shouldDiscardNetworkElement(b,"structure",m))break;(A=h.get("structure"))==null||A.push(b.globalId),this.structureAssociations.add(g)}}});const f=r.map(async g=>{const{associatedNetworkSourceId:v,associatedAssetGroup:b,associatedAssetType:w}=g,S=h.get(g.type),T=b!=null?await this._countAssociatedFeatures(v,S,b,w,e):S.length;switch(g.type){case"attachment":this._set("attachmentsFeatureCount",T);break;case"structure":this._set("structureFeatureCount",T);break;case"content":this._set("contentFeatureCount",T);break;case"container":this._set("containerFeatureCount",T);break;case"connectivity":this._set("connectivityFeatureCount",T)}});await Promise.allSettled(f)}async _countAssociatedFeatureCount(e,s,i,r,n){const o=e.fieldsIndex.get(WI.assetGroup),a=e.fieldsIndex.get(WI.assetType),l=r!=null,u="("+s.map(f=>`'${f}'`).join(", ")+")",c=` AND ${o==null?void 0:o.name} = ${i}`,h=l?` AND ${a==null?void 0:a.name} = ${r}`:"",m=`${e.globalIdField} IN ${u}`+c+h;return e.queryFeatureCount({where:m,outFields:["*"],returnGeometry:!1},{signal:n==null?void 0:n.signal})}async _countAssociatedFeatures(e,s,i,r,n){if(s.length===0)return 0;const o=(await this._findLayersBySourceId(e)).map(async a=>this._countAssociatedFeatureCount(a,s,i,r,n));return(await Promise.all(o)).reduce((a,l)=>a+l,0)}async _queryAssociatedFeatures(e,s){const{layer:i,globalId:r,associationTypes:n,utilityNetwork:o,canQuery:a,associationFeatures:l}=this;if(await Promise.allSettled([i==null?void 0:i.load(),o==null?void 0:o.load()]),!(a&&i&&n&&o))return;const u=this._getAssociationsByType(e.type),{associatedAssetGroup:c,associatedAssetType:h}=e,m=new Map;u.forEach(g=>{const{fromNetworkElement:v,toNetworkElement:b}=g,{networkSourceId:w,elementGlobalId:S}=v.globalId===r?{networkSourceId:b.networkSourceId,elementGlobalId:b.globalId}:{networkSourceId:v.networkSourceId,elementGlobalId:v.globalId},T=m.get(w)||[];T.push(S),m.set(w,T)});const f=await this._createAssociationFeatureObjects(u,m,r,c,h,s);this._parseFeatureObjects(f,l)}async _queryFeatureCount(){await this._loadUtiltyNetworks();const{_queryFeatureCountAbortController:e,canQuery:s}=this;s?(await this._queryAssociations(e),this._set("featureCount",this.attachmentsFeatureCount+this.structureFeatureCount+this.contentFeatureCount+this.containerFeatureCount+this.connectivityFeatureCount)):this._set("featureCount",0)}async _query(e){if(!e)return;await this._loadUtiltyNetworks();const{_queryAbortController:s}=this;this._destroyAssociatedFeatureViewModels(),this._clearFeatures(),this.featureCount!==0&&(this.destroyed||await this._queryAssociatedFeatures(e,{signal:s==null?void 0:s.signal}))}_shouldDiscardNetworkElement(e,s,i){var l;if(!e)return!1;const{networkSourceIdsInUse:r}=this,{networkSourceId:n}=e,o=(l=i.get(s))==null?void 0:l.associatedNetworkSourceId,a=r.has(n);return o!=null&&o!==n||!a}};p([_()],Qt.prototype,"_loaded",void 0),p([_()],Qt.prototype,"_queryAbortController",void 0),p([_()],Qt.prototype,"_queryPageAbortController",void 0),p([_()],Qt.prototype,"_queryFeatureCountAbortController",void 0),p([_({readOnly:!0})],Qt.prototype,"supportsCacheHint",null),p([_({readOnly:!0})],Qt.prototype,"canLoad",null),p([_({readOnly:!0})],Qt.prototype,"canQuery",null),p([_()],Qt.prototype,"networkSourceIdsInUse",void 0),p([_({constructOnly:!0})],Qt.prototype,"source",void 0),p([_()],Qt.prototype,"description",void 0),p([_({value:3})],Qt.prototype,"displayCount",null),p([_({type:tn})],Qt.prototype,"graphic",void 0),p([_()],Qt.prototype,"layer",void 0),p([_()],Qt.prototype,"map",void 0),p([_({readOnly:!0})],Qt.prototype,"objectId",null),p([_({readOnly:!0})],Qt.prototype,"objectIdField",null),p([_({readOnly:!0})],Qt.prototype,"globalId",null),p([_({readOnly:!0})],Qt.prototype,"globalIdField",null),p([_()],Qt.prototype,"featureCount",void 0),p([_()],Qt.prototype,"associationTypes",void 0),p([_()],Qt.prototype,"activeAssociationType",null),p([_()],Qt.prototype,"showAllEnabled",void 0),p([_()],Qt.prototype,"state",null),p([_()],Qt.prototype,"title",void 0),p([_({readOnly:!0})],Qt.prototype,"utilityNetwork",null),p([_({readOnly:!0})],Qt.prototype,"attachmentsFeatureCount",void 0),p([_({readOnly:!0})],Qt.prototype,"structureFeatureCount",void 0),p([_({readOnly:!0})],Qt.prototype,"attachmentsAssociations",null),p([_({readOnly:!0})],Qt.prototype,"structureAssociations",null),p([_({readOnly:!0})],Qt.prototype,"contentFeatureCount",void 0),p([_({readOnly:!0})],Qt.prototype,"containerFeatureCount",void 0),p([_({readOnly:!0})],Qt.prototype,"contentAssociations",null),p([_({readOnly:!0})],Qt.prototype,"containerAssociations",null),p([_({readOnly:!0})],Qt.prototype,"connectivityFeatureCount",void 0),p([_({readOnly:!0})],Qt.prototype,"connectivityAssociations",null),p([_({readOnly:!0})],Qt.prototype,"associationFeatures",null),p([_({readOnly:!0})],Qt.prototype,"associationViewModels",null),Qt=p([Q("esri.widgets.support.UtilityNetworkAssociations.FeatureUtilityNetworkAssociationsViewModel")],Qt);const h9=Qt,T8="esri-feature-utility-network-associations",Dse=`${T8}__loading-container`,ZI={base:T8,listContainer:`${T8}__list`,loadingContainer:Dse,loadingContainerSticky:`${Dse}--sticky`};let aa=class extends Er{constructor(e,s){super(e,s),this._featureElementInfo=null,this.onSelectAssociationType=()=>{},this.flowType="feature-utility-network-associations",this.flowItems=null,this.parentFeatureViewModel=null,this.headingLevel=5,this.viewModel=new h9,this.messages=null,this.messagesCommon=null,this.visibleElements=new Y_e}initialize(){this._featureElementInfo=new fP,this.addHandles([Ee(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),ht)])}loadDependencies(){return sl({icon:()=>me(()=>import("./index-BhFhNIYS.js").then(e=>e.i),__vite__mapDeps([243,244,241,245])),list:()=>me(()=>import("./index-kzOfcToX.js"),__vite__mapDeps([272,240,241,242,273,246,245,244,254,243,274,275,276,247,248,249,261,250,251,257,270])),"list-item":()=>me(()=>import("./index-B_oefgqS.js"),__vite__mapDeps([264,243,244,241,245,265,246,256,257,249,261,251,258,266,240,242,253,254,267,268,269,270,271])),loader:()=>me(()=>import("./index-B0fAt0SM.js"),__vite__mapDeps([240,241,242])),notice:()=>me(()=>import("./index-DW-iT0Or.js"),__vite__mapDeps([277,243,244,241,245,246,251,258,242]))})}destroy(){this._featureElementInfo=ii(this._featureElementInfo)}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var s;const{state:e}=this.viewModel;return K("div",{class:this.classes(ZI.base,vt.widget)},(s=this._featureElementInfo)==null?void 0:s.render(),e==="loading"?this._renderLoading():e==="disabled"?this._renderAssociationNotFound():this._renderContent())}_renderStickyLoading(){return this.viewModel.state==="querying"?K("div",{class:ZI.loadingContainerSticky,key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return K("calcite-loader",{inline:!0,label:this.messagesCommon.loading})}_renderLoading(){return K("div",{class:ZI.loadingContainer,key:"loading-container"},this._renderLoadingIcon())}_renderAssociationNotFound(){var e;return K("calcite-notice",{icon:"exclamation-mark-triangle",key:"association-not-found",kind:"danger",open:!0,scale:"s",width:"full"},K("div",{slot:"message"},(e=this.messages)==null?void 0:e.noAssociations))}_renderAssociationType(e){const{viewModel:s}=this,i=this._getAssociationTypeTitle(e);return K("calcite-list-item",{description:F_(e.description),key:`association-type-${e.type}`,label:F_(i),value:e.type,onCalciteListItemSelect:()=>this.onSelectAssociationType({viewModel:s,listType:e,title:i})},K("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderAssociations(e){const{viewModel:s}=this;return s.source==="featureForm"||s.getFeatureCountForAssociationType(e.type)>0?this._renderAssociationType(e):void 0}_renderContent(){const{messages:e,viewModel:s}=this,{state:i,associationTypes:r}=s;return K("div",{class:ZI.listContainer,key:"list-container"},i==="ready"?K("div",null,K("calcite-list",{displayMode:"flat",label:e==null?void 0:e.associationsList},r.map(n=>this._renderAssociations(n)))):null,this._renderStickyLoading())}_getAssociationTypeTitle(e){const{messages:s}=this;if(e.title)return e.title;switch(e.type){case"attachment":return s.associationsAttachments;case"connectivity":return s.associationsConnectivity;case"structure":return s.associationsStructure;case"content":return s.associationsContents;case"container":return s.associationsContainer}}_setupFeatureElementInfo(){var n;const{headingLevel:e,visibleElements:s}=this,i=s.description&&this.description,r=s.title&&this.title;(n=this._featureElementInfo)==null||n.set({description:i,title:r,headingLevel:e})}};p([_({constructOnly:!0})],aa.prototype,"onSelectAssociationType",void 0),p([_()],aa.prototype,"flowType",void 0),p([_()],aa.prototype,"flowItems",void 0),p([_()],aa.prototype,"parentFeatureViewModel",void 0),p([_()],aa.prototype,"featureVisibleElements",void 0),p([_()],aa.prototype,"description",null),p([_()],aa.prototype,"headingLevel",void 0),p([_()],aa.prototype,"title",null),p([_({type:h9})],aa.prototype,"viewModel",void 0),p([_(),ur("esri/widgets/Feature/t9n/Feature")],aa.prototype,"messages",void 0),p([_(),ur("esri/t9n/common")],aa.prototype,"messagesCommon",void 0),p([_({type:Y_e,nonNullable:!0})],aa.prototype,"visibleElements",void 0),aa=p([Q("esri.widgets.Feature.FeatureUtilityNetworkAssociations")],aa);const YWe=aa;let XWe=class{constructor(e,s){this.preLayerQueryCallback=e,this.preRequestCallback=s,this.preLayerQueryCallback||(this.preLayerQueryCallback=i=>{}),this.preRequestCallback||(this.preLayerQueryCallback=i=>{})}};var Ev;const $se=1,Rse="content-view-models",kse="relationship-view-models",WWe="association-view-models",Fse={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0,utilityNetworkAssociationsContent:!0};let Ws=Ev=class extends sh.IdentifiableMixin(Ye){constructor(t){super(t),this._error=null,this._graphicChangedTask=null,this._evaluateExpressionAttributesTask=null,this._associationVMAbortController=null,this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...Fse},this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.location=null,this.relatedInfos=new Map,this.title="",this.view=null,this._graphicChangedThrottled=XE(this._graphicChanged,()=>this.notifyChange("waitingForContent"),$se,this),this._isAllowedContentType=e=>{const{abilities:s}=this;return e.type==="attachments"&&!!s.attachmentsContent||e.type==="custom"&&!!s.customContent||e.type==="fields"&&!!s.fieldsContent||e.type==="media"&&!!s.mediaContent||e.type==="text"&&!!s.textContent||e.type==="expression"&&!!s.expressionContent||e.type==="relationship"&&!!s.relationshipContent||e.type==="utility-network-associations"&&!!s.utilityNetworkAssociationsContent},this._evaluateExpressionAttributesThrottled=XE(this._evaluateExpressionAttributes,()=>this.notifyChange("waitingForContent"),$se,this),this.addHandles([Ee(()=>[this.graphic,this._effectivePopupTemplate,this.abilities,this.timeZone],()=>this._graphicChangedThrottled(),ht),Or(()=>{var i,r,n,o,a,l,u;if(!((i=this._graphicChangedTask)!=null&&i.finished)||this._graphicChangedTask.value==null)return null;const e=this._graphicChangedTask.value,s=(r=e==null?void 0:e.expressionInfos)==null?void 0:r.dependencies;return[e,s!=null&&s.has("view-scale")?(n=this.view)==null?void 0:n.scale:null,s!=null&&s.has("view-time-extent")?(a=(o=this.view)==null?void 0:o.timeExtent)==null?void 0:a.start:null,s!=null&&s.has("view-time-extent")?(u=(l=this.view)==null?void 0:l.timeExtent)==null?void 0:u.end:null]},([e])=>this._evaluateExpressionAttributesThrottled(e))])}initialize(){this.addHandles([this._graphicChangedThrottled,this._evaluateExpressionAttributesThrottled])}destroy(){this._clear(),this._graphicChangedTask=Do(this._graphicChangedTask),this._evaluateExpressionAttributesTask=Do(this._evaluateExpressionAttributesTask),this._error=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return this.graphic!=null?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return Zye(r8(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return BU(this.graphic)}castAbilities(t){return{...Fse,...t}}get isTable(){var t;return((t=this._sourceLayer)==null?void 0:t.isTable)||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(t){this._set("graphic",(t==null?void 0:t.clone())??null)}get spatialReference(){var t;return((t=this.view)==null?void 0:t.spatialReference)??null}set spatialReference(t){this._override("spatialReference",t)}get timeZone(){var t;return((t=this.view)==null?void 0:t.timeZone)??Gu}set timeZone(t){this._overrideIfSome("timeZone",t)}get map(){var t;return((t=this.view)==null?void 0:t.map)||null}set map(t){this._override("map",t)}get waitingForContent(){const{_graphicChangedThrottled:t,_evaluateExpressionAttributesThrottled:e,_graphicChangedTask:s,_evaluateExpressionAttributesTask:i,_associationVMAbortController:r}=this;return t.hasPendingUpdates()||e.hasPendingUpdates()||s!=null&&!s.finished||i!=null&&!i.finished||!!r}setActiveMedia(t,e){const s=this.contentViewModels[t];s instanceof d_&&s.setActiveMedia(e)}nextMedia(t){const e=this.contentViewModels[t];e instanceof d_&&e.next()}previousMedia(t){const e=this.contentViewModels[t];e instanceof d_&&e.previous()}async updateGeometry(){var o;const{graphic:t,spatialReference:e,_sourceLayer:s}=this;await(s==null?void 0:s.load());const i=s==null?void 0:s.objectIdField;if(!i||!t||!s)return;const r=(o=t==null?void 0:t.attributes)==null?void 0:o[i];if(r==null)return;const n=[r];if(!t.geometry){const a=await WU({layer:s,graphic:t,outFields:[],objectIds:n,returnGeometry:!0,spatialReference:e}),l=a==null?void 0:a.geometry;l&&(t.geometry=l)}}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}_graphicChanged(){this._evaluateExpressionAttributesTask=Do(this._evaluateExpressionAttributesTask),this._graphicChangedTask=Do(this._graphicChangedTask),this._graphicChangedTask=Id(async t=>{this._error=null,this._clear();const{graphic:e}=this;try{if(!e)return null;const{_sourceLayer:s,_effectivePopupTemplate:i}=this,r=this.spatialReference;await Jye({graphic:e,popupTemplate:i,layer:s,spatialReference:r},{signal:t});const[{value:n},{value:o}]=await Pd([this._getContent(),this._getTitle()]),[,{value:a}]=await Pd([this._checkForRelatedFeatures({signal:t}),GWe(i==null?void 0:i.expressionInfos,e)]);return{expressionInfos:a,content:n,title:o}}catch(s){throw Lr(s)||(this._error=s,Ne.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:s,graphic:e,popupTemplate:this._effectivePopupTemplate})),s}})}_compileContentElement(t,e){return t.type==="attachments"?this._compileAttachments(t,e):t.type==="custom"?this._compileCustom(t,e):t.type==="fields"?this._compileFields(t,e):t.type==="media"?this._compileMedia(t,e):t.type==="text"?this._compileText(t,e):t.type==="expression"?this._compileExpression(t,e):t.type==="relationship"?this._compileRelationship(t,e):t.type==="utility-network-associations"?this._compileUtilityNetworkAssociation(t,e):void 0}_compileContent(t){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(t)?t.filter(this._isAllowedContentType).map((e,s)=>this._compileContentElement(e,s)).filter(Qa):typeof t=="string"?this._compileText(new Q_({text:t}),0).text:t}_destroyContentViewModels(){this.removeHandles(kse),this.removeHandles(Rse),this.contentViewModels.forEach(t=>t&&!t.destroyed&&t.destroy()),this._set("contentViewModels",[])}_matchesFeature(t,e){var r;const s=(r=t==null?void 0:t.graphic)==null?void 0:r.getObjectId(),i=e==null?void 0:e.getObjectId();return s!=null&&i!=null&&s===i}_setRelatedFeaturesViewModels({relatedFeatureViewModels:t,relatedFeatures:e,map:s}){const{view:i,spatialReference:r,timeZone:n}=this;e==null||e.filter(Boolean).forEach(o=>{t.some(a=>this._matchesFeature(a,o))||t.add(new Ev({abilities:{relationshipContent:!1},map:s,view:i,spatialReference:r,timeZone:n,graphic:o}))}),t.forEach(o=>{(e==null?void 0:e.find(l=>this._matchesFeature(o,l)))||t.remove(o)})}_setExpressionContentVM(t,e){const s=this.formattedAttributes,{contentElement:i,contentElementViewModel:r}=t,n=i==null?void 0:i.type;r&&n&&(n==="fields"&&(this._createFieldsFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:s}),r.set(this._createFieldsVMParams(i,e))),n==="media"&&(this._createMediaFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:s}),r.set(this._createMediaVMParams(i,e))),n==="text"&&r.set(this._createTextVMParams(i)))}_compileRelationship(t,e){const{displayCount:s,orderByFields:i,relationshipId:r,title:n,description:o}=t,{_sourceLayer:a,graphic:l,map:u}=this;if(!pP(a))return;const c=new c9({displayCount:s,graphic:l,orderByFields:i,relationshipId:r,layer:a,map:u,...this._compileTitleAndDesc({title:n,description:o})});return this.contentViewModels[e]=c,this.addHandles(Vo(()=>c.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(c)),kse),t}_matchesGlobalFeature(t,e){const s=t==null?void 0:t.association.globalId,i=e==null?void 0:e.association.globalId;return s!=null&&i!=null&&s===i}async _setUpUtilityNetworkAssociationsViewModels(t,e,s){const{view:i,spatialReference:r,timeZone:n}=this;t.forEach((a,l)=>{const u=e.get(l);u?a.forEach(c=>{u.find(h=>this._matchesGlobalFeature(c,h))||(a.remove(c),a.length===0&&t.delete(l))}):(a.removeAll(),t.delete(l))}),e.forEach((a,l)=>{const u=t.get(l)||new Ge;a==null||a.filter(Boolean).forEach(c=>{u.some(h=>this._matchesGlobalFeature(h,c))||u.add({association:c.association,featureViewModel:new Ev({abilities:{utilityNetworkAssociationsContent:!1},map:s,view:i,spatialReference:r,timeZone:n,graphic:c.feature}),terminalName:c.terminalName})}),t.set(l,u)});const o=new AbortController;this._associationVMAbortController=o,await this._sortListObjectsByTitle(t,{signal:o.signal}),this._associationVMAbortController===o&&(this._associationVMAbortController=null)}async _sortListObjectsByTitle(t,e){for(const s of t.values()){const i=s.map(r=>zC(()=>r.featureViewModel.state==="ready",e==null?void 0:e.signal));await Promise.all(i),s.sort(this._compareByFeatureTitle)}}_compareByFeatureTitle(t,e){const s=Pte(t.featureViewModel),i=Pte(e.featureViewModel);return s.localeCompare(i,void 0,{numeric:!0})}_compileUtilityNetworkAssociation(t,e){const{displayCount:s,title:i,description:r,associationTypes:n}=t,{_sourceLayer:o,graphic:a,map:l}=this;if(!Yye(o))return;const u=new h9({graphic:a,displayCount:s,associationTypes:n,layer:o,map:l,...this._compileTitleAndDesc({title:i,description:r})});return this.contentViewModels[e]=u,this.addHandles([Ee(()=>u.associationFeatures.values(),()=>this._setUpUtilityNetworkAssociationsViewModels(u.associationViewModels,u.associationFeatures,u.map))],WWe),t}_compileExpression(t,e){const{expressionInfo:s}=t,{graphic:i,map:r,spatialReference:n,view:o,location:a}=this,l=new u9({expressionInfo:s,graphic:i,interceptor:Ev.interceptor,map:r,spatialReference:n,view:o,location:a});return this.contentViewModels[e]=l,this.addHandles(Ee(()=>l.contentElementViewModel,()=>this._setExpressionContentVM(l,e),ht),Rse),t}_compileAttachments(t,e){const{graphic:s}=this,{description:i,title:r,orderByFields:n}=t;return this.contentViewModels[e]=new QU({graphic:s,orderByFields:n,...this._compileTitleAndDesc({title:r,description:i})}),t}_compileCustom(t,e){const{graphic:s}=this,{creator:i,destroyer:r}=t;return this.contentViewModels[e]=new V3({graphic:s,creator:i,destroyer:r}),t}_compileTitleAndDesc({title:t,description:e}){const{_fieldInfoMap:s,_sourceLayer:i,graphic:r,formattedAttributes:n}=this,o=r==null?void 0:r.attributes,a=this._expressionAttributes,l=n.global;return{title:Rf({attributes:o,fieldInfoMap:s,globalAttributes:l,expressionAttributes:a,layer:i,text:t}),description:Rf({attributes:o,fieldInfoMap:s,globalAttributes:l,expressionAttributes:a,layer:i,text:e})}}_createFieldsVMParams(t,e){const s=this._effectivePopupTemplate,i=this.formattedAttributes,r={...i==null?void 0:i.global,...i==null?void 0:i.content[e]},n=(t==null?void 0:t.fieldInfos)||(s==null?void 0:s.fieldInfos),o=n==null?void 0:n.filter(({fieldName:c})=>!!c&&(H$(c)||Uh(c)||r.hasOwnProperty(c))),a=s==null?void 0:s.expressionInfos,{description:l,title:u}=t;return{attributes:r,expressionInfos:a,fieldInfos:o,...this._compileTitleAndDesc({title:u,description:l})}}_compileFields(t,e){const s=t.clone(),i=new X$(this._createFieldsVMParams(t,e));return this.contentViewModels[e]=i,s.fieldInfos=i.formattedFieldInfos.slice(),s}_createMediaVMParams(t,e){const{abilities:s,graphic:i,_fieldInfoMap:r,_effectivePopupTemplate:n,relatedInfos:o,_sourceLayer:a,_expressionAttributes:l}=this,u=this.formattedAttributes,c=(i==null?void 0:i.attributes)??{},{description:h,mediaInfos:m,title:f}=t;return{abilities:{chartAnimation:s.chartAnimation},activeMediaInfoIndex:t.activeMediaInfoIndex||0,attributes:c,isAggregate:i==null?void 0:i.isAggregate,layer:a,fieldInfoMap:r,formattedAttributes:{...u==null?void 0:u.global,...u==null?void 0:u.content[e]},expressionAttributes:l,mediaInfos:m,popupTemplate:n,relatedInfos:o,...this._compileTitleAndDesc({title:f,description:h})}}_compileMedia(t,e){const s=t.clone(),i=new d_(this._createMediaVMParams(t,e));return s.mediaInfos=i.formattedMediaInfos.slice(),this.contentViewModels[e]=i,s}_createTextVMParams(t){var n;const{graphic:e,_fieldInfoMap:s,_sourceLayer:i,_expressionAttributes:r}=this;if(t&&t.text){const o=(e==null?void 0:e.attributes)??{},a=((n=this.formattedAttributes)==null?void 0:n.global)??{};t.text=Rf({attributes:o,fieldInfoMap:s,globalAttributes:a,expressionAttributes:r,layer:i,text:t.text})}return{graphic:e,creator:t.text}}_compileText(t,e){const s=t.clone();return this.contentViewModels[e]=new V3(this._createTextVMParams(s)),s}_compileLastEditInfo(){const{_effectivePopupTemplate:t,_sourceLayer:e,graphic:s,timeZone:i}=this;if(!t)return;const{lastEditInfoEnabled:r}=t,n=e==null?void 0:e.editFieldsInfo;return r&&n?Wye(n,s==null?void 0:s.attributes,i,e):void 0}_compileTitle(t){var a;const{_fieldInfoMap:e,_sourceLayer:s,graphic:i,_expressionAttributes:r}=this,n=(i==null?void 0:i.attributes)??{},o=((a=this.formattedAttributes)==null?void 0:a.global)??{};return Rf({attributes:n,fieldInfoMap:e,globalAttributes:o,expressionAttributes:r,layer:s,text:t})}async _getTitle(){const{_effectivePopupTemplate:t,graphic:e}=this;return e?WE({type:"title",value:t==null?void 0:t.title,event:{graphic:e}}):null}async _getContent(){const{_effectivePopupTemplate:t,graphic:e}=this;return e?WE({type:"content",value:t==null?void 0:t.content,event:{graphic:e}}):null}_evaluateExpressionAttributes({title:t,content:e,expressionInfos:s}){this._evaluateExpressionAttributesTask=Do(this._evaluateExpressionAttributesTask),this._evaluateExpressionAttributesTask=Id(async i=>{const{graphic:r,map:n,view:o,spatialReference:a,location:l}=this;try{if(!r)return;let u;if(s!=null){const c=[];for(const[h,m]of s.expressions.entries())m!=null?c.push(m.evaluate({graphic:r,interceptor:Ev.interceptor,location:l,map:n,options:{signal:i},spatialReference:a,view:o}).then(f=>[h,AWe(f)]).catch(()=>[h,void 0])):c.push(Promise.resolve([h,void 0]));u=Object.fromEntries(await Promise.all(c)),ni(i)}this._expressionAttributes=u,this._graphicExpressionAttributes={...r.attributes,...u},this._set("formattedAttributes",this._createFormattedAttributes(e)),this._set("title",this._compileTitle(t)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(e)||null)}catch(u){Lr(u)||(this._error=u,Ne.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:u,graphic:r,popupTemplate:this._effectivePopupTemplate}))}})}_createMediaFormattedAttributes({contentElement:t,contentElementIndex:e,formattedAttributes:s}){const{_effectivePopupTemplate:i,graphic:r,relatedInfos:n,_sourceLayer:o,_fieldInfoMap:a,_graphicExpressionAttributes:l,timeZone:u}=this;s.content[e]=zA({fieldInfos:i==null?void 0:i.fieldInfos,graphic:r,attributes:{...l,...t.attributes},layer:o,fieldInfoMap:a,relatedInfos:n,timeZone:u})}_createFieldsFormattedAttributes({contentElement:t,contentElementIndex:e,formattedAttributes:s}){if(t.fieldInfos){const{graphic:i,relatedInfos:r,_sourceLayer:n,_fieldInfoMap:o,_graphicExpressionAttributes:a,timeZone:l}=this;s.content[e]=zA({fieldInfos:t.fieldInfos,graphic:i,attributes:{...a,...t.attributes},layer:n,fieldInfoMap:o,relatedInfos:r,timeZone:l})}}_createFormattedAttributes(t){const{_effectivePopupTemplate:e,graphic:s,relatedInfos:i,_sourceLayer:r,_fieldInfoMap:n,_graphicExpressionAttributes:o,timeZone:a}=this,l=e==null?void 0:e.fieldInfos,u={global:zA({fieldInfos:l,graphic:s,attributes:o,layer:r,fieldInfoMap:n,relatedInfos:i,timeZone:a}),content:[]};return Array.isArray(t)&&t.forEach((c,h)=>{c.type==="fields"&&this._createFieldsFormattedAttributes({contentElement:c,contentElementIndex:h,formattedAttributes:u}),c.type==="media"&&this._createMediaFormattedAttributes({contentElement:c,contentElementIndex:h,formattedAttributes:u})}),u}_checkForRelatedFeatures(t){const{graphic:e,_effectivePopupTemplate:s}=this;return this._queryRelatedInfos(e,r8(s),t)}async _queryRelatedInfos(t,e,s){const{relatedInfos:i,_sourceLayer:r}=this;i.clear();const n=(r==null?void 0:r.associatedLayer)!=null?await(r==null?void 0:r.associatedLayer.load(s)):r;if(!n||!t)return;const o=e.filter(u=>!!u.fieldName&&Uh(u.fieldName));if(!(o!=null&&o.length))return;e.forEach(u=>this._configureRelatedInfo(u,n));const a=await sXe({relatedInfos:i,layer:n},s);Object.keys(a).forEach(u=>{var m;const c=i.get(u.toString()),h=(m=a[u])==null?void 0:m.value;c&&h&&(c.layerInfo=h.data)});const l=await iXe({graphic:t,relatedInfos:i,layer:n},s);Object.keys(l).forEach(u=>{var c;WYe((c=l[u])==null?void 0:c.value,i.get(u.toString()))})}_configureRelatedInfo(t,e){const{relatedInfos:s}=this,i=HA(t.fieldName||"");if(!i)return;const{layerId:r,fieldName:n}=i;if(!r)return;const o=s.get(r.toString())||XYe(r,e);o&&(rXe({relatedInfo:o,fieldName:n,fieldInfo:t}),this.relatedInfos.set(r,o))}};Ws.interceptor=new XWe(e_e,t_e),p([_()],Ws.prototype,"_error",void 0),p([_()],Ws.prototype,"_graphicChangedTask",void 0),p([_()],Ws.prototype,"_evaluateExpressionAttributesTask",void 0),p([_()],Ws.prototype,"_associationVMAbortController",void 0),p([_({readOnly:!0})],Ws.prototype,"_effectivePopupTemplate",null),p([_({readOnly:!0})],Ws.prototype,"_fieldInfoMap",null),p([_({readOnly:!0})],Ws.prototype,"_sourceLayer",null),p([_()],Ws.prototype,"abilities",void 0),p([Ht("abilities")],Ws.prototype,"castAbilities",null),p([_({readOnly:!0})],Ws.prototype,"content",void 0),p([_({readOnly:!0})],Ws.prototype,"contentViewModels",void 0),p([_()],Ws.prototype,"description",void 0),p([_({type:Boolean})],Ws.prototype,"defaultPopupTemplateEnabled",void 0),p([_({readOnly:!0})],Ws.prototype,"isTable",null),p([_({readOnly:!0})],Ws.prototype,"state",null),p([_({readOnly:!0})],Ws.prototype,"formattedAttributes",void 0),p([_({type:tn,value:null})],Ws.prototype,"graphic",null),p([_({readOnly:!0})],Ws.prototype,"lastEditInfo",void 0),p([_({type:Et})],Ws.prototype,"location",void 0),p([_({readOnly:!0})],Ws.prototype,"relatedInfos",void 0),p([_({type:St})],Ws.prototype,"spatialReference",null),p([_()],Ws.prototype,"timeZone",null),p([_({readOnly:!0})],Ws.prototype,"title",void 0),p([_()],Ws.prototype,"map",null),p([_({readOnly:!0})],Ws.prototype,"waitingForContent",null),p([_()],Ws.prototype,"view",void 0),Ws=Ev=p([Q("esri.widgets.Feature.FeatureViewModel")],Ws);const m9=Ws,ch="esri-feature",nr={base:ch,container:`${ch}__size-container`,title:`${ch}__title`,main:`${ch}__main-container`,contentNode:`${ch}__content-node`,contentNodeText:`${ch}__content-node--text`,contentElement:`${ch}__content-element`,text:`${ch}__text`,lastEditedInfo:`${ch}__last-edited-info`,loadingSpinnerContainer:`${ch}__loading-container`},X_e=t=>{let e=class extends t{constructor(){super(...arguments),this.renderNodeContent=s=>P_(s)&&!s.destroyed?K("div",{class:nr.contentNode,key:s},s.render()):s instanceof HTMLElement?K("div",{afterCreate:this._attachToNode,bind:s,class:nr.contentNode,key:s}):Ofe(s)?K("div",{afterCreate:this._attachToNode,bind:s.domNode,class:nr.contentNode,key:s}):null}_attachToNode(s){const i=this;s.appendChild(i)}};return e=p([Q("esri.widgets.Feature.support.FeatureContentMixin")],e),e},Ose={title:!0,content:!0,lastEditedInfo:!0};let vr=class extends X_e(Er){constructor(e,s){super(e,s),this._contentWidgets=[],this.flowType="feature",this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.visibleElements={...Ose},this.viewModel=new m9}initialize(){this.addHandles(Ee(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentViewModels},()=>this._setupContentWidgets(),ht))}loadDependencies(){return sl({notice:()=>me(()=>import("./index-DW-iT0Or.js"),__vite__mapDeps([277,243,244,241,245,246,251,258,242])),loader:()=>me(()=>import("./index-B0fAt0SM.js"),__vite__mapDeps([240,241,242]))})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get isTable(){return this.viewModel.isTable}get icon(){return"polygon"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get timeZone(){return this.viewModel.timeZone}set timeZone(e){this.viewModel.timeZone=e}get title(){return this.viewModel.title}castVisibleElements(e){return{...Ose,...e}}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}setActiveMedia(e,s){return this.viewModel.setActiveMedia(e,s)}nextMedia(e){return this.viewModel.nextMedia(e)}previousMedia(e){return this.viewModel.previousMedia(e)}render(){const{state:e}=this.viewModel,s=K("div",{class:nr.container,key:"container"},this._renderTitle(),e==="error"?this._renderError():e==="loading"?this._renderLoading():this._renderContentContainer());return K("div",{class:this.classes(nr.base,vt.widget)},s)}_renderError(){const{messagesCommon:e,messages:s,visibleElements:i}=this;return K("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},i.title?K("div",{key:"error-title",slot:"title"},e.errorMessage):null,K("div",{key:"error-message",slot:"message"},s.loadingError))}_renderLoading(){return K("div",{class:nr.loadingSpinnerContainer,key:"loading-container"},K("calcite-loader",{inline:!0,label:""}))}_renderContentContainer(){const{visibleElements:e}=this;return e.content?K("div",{class:nr.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const{visibleElements:e,title:s}=this;return e.title?K(JU,{class:nr.title,innerHTML:s,level:this.headingLevel}):null}_renderContent(){const e=this.viewModel.content,s="content";if(!e)return null;if(Array.isArray(e))return e.length?K("div",{class:nr.contentNode,key:`${s}-content-elements`},e.map(this._renderContentElement,this)):null;if(typeof e=="string"){const i=this._contentWidgets[0];return!i||i.destroyed?null:K("div",{class:this.classes(nr.contentNode,nr.contentNodeText),key:`${s}-content`},i.render())}return this.renderNodeContent(e)}_renderContentElement(e,s){var r;const{visibleElements:i}=this;if(typeof i.content!="boolean"&&!((r=i.content)!=null&&r[e.type]))return null;switch(e.type){case"attachments":return this._renderAttachments(s);case"custom":return this._renderCustom(e,s);case"fields":return this._renderFields(s);case"media":return this._renderMedia(s);case"text":return this._renderText(e,s);case"expression":return this._renderExpression(s);case"relationship":return this._renderRelationship(s);case"utility-network-associations":return this._renderAssociation(s);default:return null}}_renderAttachments(e){const s=this._contentWidgets[e];if(!s||s.destroyed)return null;const{state:i,attachmentInfos:r}=s.viewModel;return i==="loading"||r.length>0?K("div",{class:this.classes(nr.contentElement),key:this._buildKey("attachments-element",e)},s.render()):null}_renderRelationship(e){const s=this._contentWidgets[e];return s&&!s.destroyed&&this.flowItems?K("div",{class:nr.contentElement,key:this._buildKey("relationship-element",e)},s.render()):null}_renderAssociation(e){const s=this._contentWidgets[e];return s&&!s.destroyed&&this.flowItems?K("div",{class:nr.contentElement,key:this._buildKey("utility-network-association-element",e)},s.render()):null}_renderExpression(e){const s=this._contentWidgets[e];return s&&!s.destroyed&&s.viewModel.contentElement?K("div",{class:nr.contentElement,key:this._buildKey("expression-element",e)},s.render()):null}_renderCustom(e,s){const{creator:i}=e,r=this._contentWidgets[s];return!r||r.destroyed?null:i?K("div",{class:nr.contentElement,key:this._buildKey("custom-element",s)},r.render()):null}_renderFields(e){const s=this._contentWidgets[e];return!s||s.destroyed?null:K("div",{class:nr.contentElement,key:this._buildKey("fields-element",e)},s.render())}_renderMedia(e){const s=this._contentWidgets[e];return!s||s.destroyed?null:K("div",{class:nr.contentElement,key:this._buildKey("media-element",e)},s.render())}_renderLastEditInfo(){const{visibleElements:e,messages:s}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:r,user:n}=i,o=i.type==="edit"?n?s.lastEditedByUser:s.lastEdited:n?s.lastCreatedByUser:s.lastCreated,a=Nu(o,{date:r,user:n});return K("div",{class:this.classes(nr.lastEditedInfo,nr.contentElement),key:"edit-info-element"},a)}_renderText(e,s){const i=e.text,r=this._contentWidgets[s];return!r||r.destroyed?null:i?K("div",{class:this.classes(nr.contentElement,nr.text),key:this._buildKey("text-element",s)},r.render()):null}_buildKey(e,...s){var i,r;return`${e}__${((r=(i=this.viewModel)==null?void 0:i.graphic)==null?void 0:r.uid)||"0"}-${s.join("-")}`}_destroyContentWidget(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}_destroyContentWidgets(){this._contentWidgets.forEach(e=>this._destroyContentWidget(e)),this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:e,visibleElements:s,flowItems:i,viewModel:r}=this,n=r==null?void 0:r.content,{contentViewModels:o}=r;if(Array.isArray(n))n.forEach((a,l)=>{if(a.type==="attachments"&&(this._contentWidgets[l]=new cHe({displayType:a.displayType,headingLevel:s.title&&e<6?e+1:e,viewModel:o[l]})),a.type==="fields"&&(this._contentWidgets[l]=new o_e({viewModel:o[l]})),a.type==="media"&&(this._contentWidgets[l]=new E_e({viewModel:o[l]})),a.type==="text"&&(this._contentWidgets[l]=new UA({viewModel:o[l]})),a.type==="custom"&&(this._contentWidgets[l]=new UA({viewModel:o[l]})),a.type==="expression"&&(this._contentWidgets[l]=new zWe({viewModel:o[l]})),a.type==="relationship"){const u=new jWe({flowItems:i,featureVisibleElements:s,viewModel:o[l]});this._contentWidgets[l]=u}if(a.type==="utility-network-associations"){const u=async h=>{const{viewModel:m,listType:f,title:g}=h;if(!i)return;m.activeAssociationType=f;const{default:v}=await me(()=>import("./FeatureUtilityNetworkAssociationList-WqUwEcDJ.js"),[]),b=new v({viewModel:m,parentFeatureViewModel:r,listType:f,title:g,featureVisibleElements:s,description:r.title,flowItems:i});i.push(b)},c=new YWe({flowItems:i,onSelectAssociationType:u,parentFeatureViewModel:r,featureVisibleElements:s,viewModel:o[l]});this._contentWidgets[l]=c}},this);else{const a=o[0];a&&!a.destroyed&&(this._contentWidgets[0]=new UA({viewModel:a}))}this.scheduleRender()}};p([_()],vr.prototype,"flowType",void 0),p([_()],vr.prototype,"graphic",null),p([_()],vr.prototype,"defaultPopupTemplateEnabled",null),p([_()],vr.prototype,"flowItems",void 0),p([_()],vr.prototype,"headingLevel",void 0),p([_({readOnly:!0})],vr.prototype,"isTable",null),p([_()],vr.prototype,"icon",null),p([_()],vr.prototype,"label",null),p([_()],vr.prototype,"location",null),p([_(),ur("esri/widgets/Feature/t9n/Feature")],vr.prototype,"messages",void 0),p([_(),ur("esri/t9n/common")],vr.prototype,"messagesCommon",void 0),p([_()],vr.prototype,"spatialReference",null),p([_()],vr.prototype,"timeZone",null),p([_({readOnly:!0})],vr.prototype,"title",null),p([_()],vr.prototype,"visibleElements",void 0),p([Ht("visibleElements")],vr.prototype,"castVisibleElements",null),p([_()],vr.prototype,"map",null),p([_()],vr.prototype,"view",null),p([_({type:m9})],vr.prototype,"viewModel",void 0),vr=p([Q("esri.widgets.Feature")],vr);const W_e=vr,ZWe=Object.freeze(Object.defineProperty({__proto__:null,default:W_e},Symbol.toStringTag,{value:"Module"}));let jy=class extends Wl.EventedAccessor{constructor(e){super(e),this.location=null,this.screenLocationEnabled=!1,this.view=null,this.addHandles([Or(()=>{const s=this.screenLocationEnabled?this.view:null;return s?[s.size,s.type==="3d"?s.camera:s.viewpoint]:null},()=>this.notifyChange("screenLocation")),Ee(()=>this.screenLocation,(s,i)=>{s!=null&&i!=null&&this.emit("view-change")})])}destroy(){this.view=null}get screenLocation(){const{location:e,view:s,screenLocationEnabled:i}=this,r=s==null?void 0:s.spatialReference,n=r?Lce(e,r).geometry:null;return i&&n&&(s!=null&&s.ready)?s.toScreen(n):null}};p([_()],jy.prototype,"location",void 0),p([_()],jy.prototype,"screenLocation",null),p([_()],jy.prototype,"screenLocationEnabled",void 0),p([_()],jy.prototype,"view",void 0),jy=p([Q("esri.widgets.support.AnchorElementViewModel")],jy);const Z_e=jy;let tN=class extends Z_e{constructor(e){super(e),this.visible=!1}};p([_()],tN.prototype,"visible",void 0),tN=p([Q("esri.widgets.Spinner.SpinnerViewModel")],tN);const Q_e=tN,ZO="esri-spinner",QO={base:ZO,spinnerStart:`${ZO}--start`,spinnerFinish:`${ZO}--finish`};let Hy=class extends Er{constructor(e,s){super(e,s),this._animationDelay=500,this._animationPromise=null,this.viewModel=new Q_e}initialize(){this.addHandles(Ee(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:s,promise:i}=e??{};s&&(this.viewModel.location=s),this.visible=!0;const r=()=>this.hide();i&&i.catch(()=>{}).then(r)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:s}=this.viewModel,i=!!s,r=e&&i,n=!e&&i,o={[QO.spinnerStart]:r,[QO.spinnerFinish]:n},a=this._getPositionStyles();return K("div",{class:this.classes(QO.base,o),styles:a})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const s=FC(this._animationDelay);this._animationPromise=s,s.catch(()=>{}).then(()=>{this._animationPromise===s&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:s}=this.viewModel;if(s==null||e==null)return{};const{padding:i}=s;return{left:e.x-i.left+"px",top:e.y-i.top+"px"}}};p([_()],Hy.prototype,"location",null),p([_()],Hy.prototype,"view",null),p([_({type:Q_e})],Hy.prototype,"viewModel",void 0),p([_()],Hy.prototype,"visible",null),Hy=p([Q("esri.widgets.Spinner")],Hy);const QWe=Hy,eo="esri-features",Rr={icon:`${eo}__icon`,actionImage:`${eo}__action-image`,base:eo,container:`${eo}__container`,contentContainer:`${eo}__content-container`,contentFeature:`${eo}__content-feature`,flowItemCollapsed:`${eo}__flow-item--collapsed`,header:`${eo}__header`,footer:`${eo}__footer`,featureMenuObserver:`${eo}__feature-menu-observer`,actionExit:`${eo}__action--exit`,loader:`${eo}__loader`,featuresHeading:`${eo}__heading`,paginationText:`${eo}__pagination-text`,paginationActionBar:`${eo}__pagination-action-bar`,paginationMenuButton:`${eo}__pagination-menu-button`,paginationPrevious:`${eo}__pagination-previous`},T_=Ge.ofType({key:"type",defaultKeyValue:"button",base:JC,typeMap:{button:_0,toggle:f$}}),kf=new _0({icon:"magnifying-glass-plus",id:"zoom-to-feature",title:"{messages.zoom}",className:fd.zoomInMagnifyingGlass}),Lse=new _0({icon:"trash",id:"remove-selected-feature",title:"{messages.remove}",className:fd.trash}),kv=new _0({icon:"magnifying-glass-plus",id:"zoom-to-clustered-features",title:"{messages.zoom}",className:fd.zoomInMagnifyingGlass}),Ef=new f$({icon:"table",id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:fd.table,value:!1}),Mp=kf.clone();let Yy=class extends Er{constructor(e,s){super(e,s),this.messages=null,this.closed=!1,this.closable=!0,this._handleOpenFeature=i=>{this.emit("open-feature",{feature:i})},this._handleZoomToFeature=i=>{this.emit("zoom-to-feature",{featureWidget:i})}}loadDependencies(){return sl({action:()=>me(()=>import("./index-9hW8Ud6V.js"),__vite__mapDeps([253,240,241,242,243,244,245,254,246,249,251])),"action-bar":()=>me(()=>import("./index-CPMOc5ra.js"),__vite__mapDeps([311,240,241,242,243,244,245,253,254,246,249,251,255,256,257,258,247,259,260,261,262,263,252])),"action-group":()=>me(()=>import("./index-mCYGoQ2c.js").then(e=>e.i),__vite__mapDeps([252,240,241,242,243,244,245,253,254,246,249,251,255,256,257,258,247,259,260,261,262,263])),"flow-item":()=>me(()=>import("./index-BcyHfZZl.js"),__vite__mapDeps([281,240,241,242,243,244,245,253,254,246,249,251,255,256,257,258,247,259,260,261,262,263,273,282]))})}render(){const{flowItems:e}=this,s=e==null?void 0:e.toArray();return K(qGe,null,s==null?void 0:s.map((i,r)=>this._renderFlowItem(i,r===e.length-1)))}_handleCloseClick(){this.emit("close")}_handleExitClick(){this.emit("exit")}_handleDrillInBackClick(){const{flowItems:e}=this,s=e==null?void 0:e.pop();s&&("activeCategory"in s.viewModel?(s.viewModel.activeCategory=null,e.length||(s.viewModel.showAllEnabled=!1)):"showAllEnabled"in s.viewModel&&(s.viewModel.showAllEnabled=!1),s&&(s.viewModel=null,s.destroy()))}_getExitMessage(e){switch(e.flowType){case"feature":case"feature-association":return"";case"feature-relationship":return this.messages.exitRelatedRecords;case"feature-utility-network-associations":case"feature-utility-network-association-type":return this.messages.exitAssociations}}_renderFlowItem(e,s){const{messages:i,closable:r,closed:n}=this,o="graphic"in e&&!e.isTable,a=e.flowType==="feature-association",l=this._getExitMessage(e),u=i.selectFeature;return K("calcite-flow-item",{bind:this,closable:r,closed:n,description:F_(this._getDrillInFlowItemDescription(e)??""),heading:F_(e.title??""),key:`flow-item-${e.viewModel.uid}`,selected:s,onCalciteFlowItemBack:c=>{c.preventDefault(),this._handleDrillInBackClick()},onCalciteFlowItemClose:this._handleCloseClick},K("calcite-action",{appearance:"transparent",bind:this,class:Rr.actionExit,icon:"move-up",key:"exit-action",onclick:this._handleExitClick,slot:"header-actions-start",text:l,title:l}),o?K("calcite-action",{appearance:"transparent",bind:this,icon:"zoom-to-object",key:"open-feature-action",onclick:()=>this._handleOpenFeature(e),slot:"header-actions-end",text:u,title:u}):null,a?K("calcite-action-bar",{expandDisabled:!0,expanded:!0,key:"header-action-bar",scale:"s",slot:"action-bar"},K("calcite-action-group",{overlayPositioning:"fixed",scale:"s"},this._renderDefaultActions(e))):null,K("div",{class:Rr.container},e.render()))}_renderDefaultActions(e){const s=this._getActionTitle(Mp);return K("calcite-action",{active:Mp.active,appearance:"solid",bind:this,"data-action-uid":Mp.uid,disabled:Mp.disabled,icon:Mp.icon??"question",indicator:Mp.indicator,key:`action-${Mp.uid}`,loading:Mp.active,onclick:()=>this._handleZoomToFeature(e),scale:"s",text:s,textEnabled:!0,title:s})}_getActionTitle(e){const{messages:s}=this,{id:i}=e,r=e.title??"";return i==="zoom-to-feature"?Nu(r,{messages:s}):r}_getDrillInFlowItemDescription(e){switch(e.flowType){case"feature":case"feature-association":case"feature-utility-network-associations":return e.viewModel.description??"";case"feature-relationship":return e.allItemsDescription;case"feature-utility-network-association-type":return e.description??""}}};p([_()],Yy.prototype,"flowItems",void 0),p([_(),ur("esri/widgets/Features/t9n/Features")],Yy.prototype,"messages",void 0),p([_()],Yy.prototype,"closed",void 0),p([_()],Yy.prototype,"closable",void 0),Yy=p([Q("esri.widgets.Features.FeaturesDrillIn")],Yy);const JWe=Yy;let KWe=class{constructor(e){this._observable=new ix,this._set=new Set(e)}get size(){return lt(this._observable),this._set.size}add(e){const s=this._set.size;return this._set.add(e),this._set.size!==s&&this._observable.notify(),this}clear(){this._set.size>0&&(this._set.clear(),this._observable.notify())}delete(e){const s=this._set.delete(e);return s&&this._observable.notify(),s}entries(){return lt(this._observable),this._set.entries()}forEach(e,s){lt(this._observable),this._set.forEach((i,r)=>e.call(s,i,r,this),s)}has(e){return lt(this._observable),this._set.has(e)}keys(){return lt(this._observable),this._set.keys()}values(){return lt(this._observable),this._set.values()}[Symbol.iterator](){return lt(this._observable),this._set[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._set[Symbol.toStringTag]}};const eZe="OBJECTID";var En;(function(t){t[t.size=22]="size",t[t.lineWidth=50]="lineWidth",t[t.maxSize=120]="maxSize",t[t.maxOutlineSize=80]="maxOutlineSize",t[t.tallSymbolWidth=20]="tallSymbolWidth"})(En||(En={}));const mE={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}]};function tZe(t,e,s){const i=En.size;let r=i,n=i;t<1?r*=.75:t>1&&(n*=1.25);const o=0,a=0;let l=i,u=i;return e&&s&&(r=n=l=u=0),[{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[s?l:.875*l,o]},{command:"L",values:[s?r-.5*l:a,n-.5*u]},{command:"L",values:[r-.5*l,n-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[l,e?o:.125*u]},{command:"L",values:[r-.5*l,e?n-.5*u:u]},{command:"L",values:[r-.5*l,n-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r-.5*l,n-.5*u]},{command:"L",values:[s?r-.5*l:a,n-.5*u]},{command:"L",values:[s?r-.5*l:a,e?n-.5*u:u]},{command:"L",values:[r-.5*l,e?n-.5*u:u]},{command:"Z",values:[]}]}]}function sZe(t){const e=En.size,s=.5*t,i=0,r=0;return[{type:"path",path:[{command:"M",values:[r,.7*e*.5]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+s]},{command:"L",values:[r,.7*e+s-.7*e*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+s]},{command:"L",values:[e,s]},{command:"L",values:[e,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,i]},{command:"L",values:[e,i]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[r,.7*e*.5]},{command:"Z",values:[]}]}]}function iZe(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function rZe(t,e){let s=e?En.tallSymbolWidth:t;const i=t,r=e?4:6;s<=En.size?s-=.5*r:s-=r;const n=0,o=0,a=e?.35*s:.5*s;return[{type:"path",path:[{command:"M",values:[.5*s,n]},{command:"L",values:[s,.5*a]},{command:"L",values:[.5*s,a]},{command:"L",values:[o,.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,.5*a]},{command:"L",values:[.5*s,a]},{command:"L",values:[.5*s,i]},{command:"L",values:[o,i-.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*s,a]},{command:"L",values:[.5*s,i]},{command:"L",values:[s,i-.5*a]},{command:"L",values:[s,.5*a]},{command:"Z",values:[]}]}]}function nZe(t,e){let s=e?En.tallSymbolWidth:t;const i=t,r=e?4:6;s<=En.size?s-=.5*r:s-=r;const n=.5*s,o=.15*s,a=0,l=i-o;return[{type:"ellipse",cx:.5*s,cy:l,rx:n,ry:o},{type:"path",path:[{command:"M",values:[a,o]},{command:"L",values:[a,l]},{command:"L",values:[s,l]},{command:"L",values:[s,o]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*s,cy:o,rx:n,ry:o}]}function oZe(t,e){let s=e?En.tallSymbolWidth:t;const i=t,r=e?4:6;s<=En.size?s-=.5*r:s-=r;const n=.15*s,o=i-n;return[{type:"ellipse",cx:.5*s,cy:o,rx:.5*s,ry:n},{type:"path",path:[{command:"M",values:[.5*s,0]},{command:"L",values:[s,o]},{command:"L",values:[0,o]},{command:"Z",values:[]}]}]}function aZe(t){let e=t;const s=t,i=6;e<En.size?e-=.5*i:e-=i;const r=.15*e,n=0;return[{type:"path",path:[{command:"M",values:[0,n]},{command:"L",values:[e,n]},{command:"L",values:[.5*e,s-r]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:n,rx:.5*e,ry:r}]}function lZe(t){let e=t;const s=t,i=4;e<En.size?e-=.5*i:e-=i;const r=0,n=0,o=e,a=s,l=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*o,r]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,r]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[n,.5*a-l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[.45*o,s]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]}]}function uZe(t){const e=t,s=2;let i=t;i<En.size?i-=.5*s:i-=s;const r=0,n=0;return[{type:"path",path:[{command:"M",values:[.45*e,r]},{command:"L",values:[e,i]},{command:"L",values:[.45*e,.6*i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,r]},{command:"L",values:[.45*e,.6*i]},{command:"L",values:[n,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,i]},{command:"L",values:[.45*e,.6*i]},{command:"L",values:[e,i]},{command:"Z",values:[]}]}]}function Bf(t,e){return Math.round(Math.min(Math.max(t+255*e*.75,0),255))}function Ovt(t,e){if(t==null)return new Be;if("type"in t&&(t.type==="linear"||t.type==="pattern"))return t;const s=new Be(t);return new Be([Bf(s.r,e),Bf(s.g,e),Bf(s.b,e),s.a])}function cZe(t){return"r"in t&&"g"in t&&"b"in t}function J_e(t){return"h"in t&&"s"in t&&"v"in t}function K_e(t){return"l"in t&&"a"in t&&"b"in t}function e0e(t){return"l"in t&&"c"in t&&"h"in t}function hZe(t){return"x"in t&&"y"in t&&"z"in t}const mZe=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],dZe=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function t0e(t,e){const s=[];let i,r;if(t[0].length!==e.length)throw new Error("dimensions do not match");const n=t.length,o=t[0].length;let a=0;for(i=0;i<n;i++){for(a=0,r=0;r<o;r++)a+=t[i][r]*e[r];s.push(a)}return s}function s0e(t){const e=[t.r/255,t.g/255,t.b/255].map(i=>i<=.04045?i/12.92:((i+.055)/1.055)**2.4),s=t0e(mZe,e);return{x:100*s[0],y:100*s[1],z:100*s[2]}}function d9(t){const e=t0e(dZe,[t.x/100,t.y/100,t.z/100]).map(s=>{const i=s<=.0031308?12.92*s:1.055*s**.4166666666666667-.055;return Math.min(1,Math.max(i,0))});return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function i0e(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map(s=>s>.008856451679035631?s**.3333333333333333:7.787037037037035*s+.13793103448275862);return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function r0e(t){const e=t.l,s=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map(i=>i>6/29?i**3:3*(6/29)**2*(i-4/29));return{x:95.047*s[0],y:100*s[1],z:108.883*s[2]}}function pZe(t){const e=t.l,s=t.a,i=t.b,r=Math.sqrt(s*s+i*i);let n=Math.atan2(i,s);return n=n>0?n:n+2*Math.PI,{l:e,c:r,h:n}}function fZe(t){const e=t.l,s=t.c,i=t.h;return{l:e,a:s*Math.cos(i),b:s*Math.sin(i)}}function gZe(t){return i0e(s0e(t))}function yZe(t){return d9(r0e(t))}function _Ze(t){return pZe(i0e(s0e(t)))}function vZe(t){return d9(r0e(fZe(t)))}function bZe(t){const e=t.r,s=t.g,i=t.b,r=Math.max(e,s,i),n=r-Math.min(e,s,i);let o=r,a=n===0?0:r===e?(s-i)/n%6:r===s?(i-e)/n+2:(e-s)/n+4,l=n===0?0:n/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}function xZe(t){const e=(t.h+360)%360/60,s=t.s/100,i=t.v/100*255,r=i*s,n=r*(1-Math.abs(e%2-1));let o;switch(Math.floor(e)){case 0:o={r,g:n,b:0};break;case 1:o={r:n,g:r,b:0};break;case 2:o={r:0,g:r,b:n};break;case 3:o={r:0,g:n,b:r};break;case 4:o={r:n,g:0,b:r};break;case 5:case 6:o={r,g:0,b:n};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+i-r),o.g=Math.round(o.g+i-r),o.b=Math.round(o.b+i-r),o}function S0(t){return cZe(t)?t:e0e(t)?vZe(t):K_e(t)?yZe(t):hZe(t)?d9(t):J_e(t)?xZe(t):t}function Q$(t){return J_e(t)?t:bZe(S0(t))}function wZe(t){return K_e(t)?t:gZe(S0(t))}function Lvt(t){return e0e(t)?t:_Ze(S0(t))}function SZe(t){let{r:e,g:s,b:i,a:r}=t;return r<1&&(e=Math.round(r*e+255*(1-r)),s=Math.round(r*s+255*(1-r)),i=Math.round(r*i+255*(1-r))),new Be({r:e,g:s,b:i})}function EZe(t,e){const{r:s,g:i,b:r}=e!=null&&e.ignoreAlpha?t:SZe(t);return .2126*s+.7152*i+.0722*r}var I8;function Vvt(t,e=I8.High){return EZe(t,{ignoreAlpha:!0})>e?new Be([0,0,0,t.a]):new Be([255,255,255,t.a])}function qvt(t,e){const s=wZe(t);s.l*=1-e;const i=S0(s),r=t.clone();return r.setColor(i),r.a=t.a,r}function Gvt(t,e){const s=t.clone();return s.a*=e,s}function zvt(t,e){const s=Q$(t);s.s*=e;const i=S0(s),r=t.clone();return r.setColor(i),r.a=t.a,r}function Uvt(t){return Be.toUnitRGBA(t)}function Bvt(t){return w0(t[0],t[1],t[2],t.length>3?t[3]:1)}function jvt(t,e){const s=Be.toUnitRGBA(t);return s[3]*=e,s}function Hvt(t,e,s={}){if(t.length===0||e<=0)return[];if((t=t.map(i=>typeof i=="string"?new Be(i):i)).length===1||e===1){const i=[],r=t[0];for(let n=0;n<e;n++)i.push(r.clone());return i}if(s.shuffle&&(t=xoe(he(t),s.seed)),t.length>=e){const i=[],r=(t.length-1)/(e-1);for(let n=0;n<e;n++){const o=Math.round(n*r);i.push(t[o].clone())}return i}return CZe(t,e,s)}function CZe(t,e,s={}){const i=[],r=t.length-1,n=Math.ceil((e-t.length)/r);e:for(let o=0;o<r;o++){const a=t[o],l=t[o+1];for(let u=1;u<=n;u++){const c=u/(n+1);if(i.push(PZe(a,l,c,s)),i.length+t.length===e)break e}}return[...t.map(o=>o.clone()),...xoe(i,s.seed??1)]}(function(t){t[t.Low=160]="Low",t[t.High=225]="High"})(I8||(I8={}));const JO=(t,e)=>{const s=Math.floor(10*e())-5;return Math.min(255,Math.max(0,t+s))};function PZe(t,e,s,i={}){const r=t.r,n=t.g,o=t.b,a=e.r,l=e.g,u=e.b,c=Math.round(r+(a-r)*s),h=Math.round(n+(l-n)*s),m=Math.round(o+(u-o)*s);if(!i.offset)return new Be([c,h,m]);const f=oz(i.seed);return new Be([JO(c,f),JO(h,f),JO(m,f)])}let TZe=0;function IZe(){return TZe++}let MZe=0;function AZe(){return MZe++}let NZe=0;function DZe(){return NZe++}const $Ze="http://www.w3.org/2000/svg",Vse=ge("android"),RZe=ge("chrome")||Vse&&Vse>=4?"auto":"optimizeLegibility",kZe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},FZe=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let Yi={},Is={};const OZe=Math.PI;function Ff(t,e){const s=t*(OZe/180);return Math.abs(e*Math.sin(s))+Math.abs(e*Math.cos(s))}function n0e(t){return t.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function o0e(t,e,s,i,r){if(t){if(t.type==="circle")return K("circle",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",r:t.r,stroke:s.color,"stroke-dasharray":s.dashArray,"stroke-dashoffset":s.dashOffset,"stroke-linecap":s.cap,"stroke-linejoin":s.join,"stroke-miterlimit":"4","stroke-width":s.width});if(t.type==="ellipse")return K("ellipse",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",rx:t.rx,ry:t.ry,stroke:s.color,"stroke-dasharray":s.dashArray,"stroke-linecap":s.cap,"stroke-linejoin":s.join,"stroke-miterlimit":"4","stroke-width":s.width});if(t.type==="rect")return K("rect",{fill:e,"fill-rule":"evenodd",height:t.height,stroke:s.color,"stroke-dasharray":s.dashArray,"stroke-linecap":s.cap,"stroke-linejoin":s.join,"stroke-miterlimit":"4","stroke-width":s.width,width:t.width,x:t.x,y:t.y});if(t.type==="image")return K("image",{alt:r||"image",height:t.height,href:t.src,preserveAspectRatio:"none",width:t.width,x:t.x,y:t.y});if(t.type==="path"){const n=typeof t.path!="string"?n0e(t.path):t.path;return K("path",{d:n,fill:e,"fill-rule":"evenodd",stroke:s.color,"stroke-dasharray":s.dashArray,"stroke-linecap":s.cap,"stroke-linejoin":s.join,"stroke-miterlimit":"4","stroke-width":s.width})}if(t.type==="text")return $C(i),K("text",{"dominant-baseline":i.dominantBaseline,fill:e,"fill-rule":"evenodd","font-family":i.font.family,"font-size":i.font.size,"font-style":i.font.style,"font-variant":i.font.variant,"font-weight":i.font.weight,kerning:i.kerning,rotate:i.rotate,stroke:s.color,"stroke-dasharray":s.dashArray,"stroke-linecap":s.cap,"stroke-linejoin":s.join,"stroke-miterlimit":"4","stroke-width":s.width,"text-anchor":i.align,"text-decoration":i.decoration,"text-rendering":RZe,x:t.x,y:t.y},t.text)}return null}function a0e(t){if(!t)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in t))return{fill:new Be(t).toString(),pattern:null,linearGradient:null};if(t.type==="pattern"){const s=`patternId-${IZe()}`;return{fill:`url(#${s})`,pattern:{id:s,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}},linearGradient:null}}const e=`linearGradientId-${AZe()}`;return{fill:`url(#${e})`,pattern:null,linearGradient:{id:e,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map(s=>({offset:s.offset,color:s.color&&new Be(s.color).toString()}))}}}function l0e(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return t&&(t.width!=null&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new Be(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashoffset&&(e.dashOffset=t.dashoffset),t.style&&!t.dashArray&&(e.dashArray=d_e(t).join(",")||"none")),e}function u0e(t,e){const s={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const i=t.alignBaseline,r=i==="baseline"?"auto":i==="top"?"text-top":i==="bottom"?"hanging":i;s.align=t.align,s.dominantBaseline=r,s.decoration=t.decoration,s.kerning=t.kerning?"auto":"0",s.rotate=t.rotated?"90":"0",$C(e),s.font.style=e.style||"normal",s.font.variant=e.variant||"normal",s.font.weight=e.weight||"normal",s.font.size=e.size&&e.size.toString()||"10pt",s.font.family=e.family||"serif"}return s}function LZe(t){const{pattern:e,linearGradient:s}=t;if(e)return K("pattern",{height:e.height,id:e.id,patternUnits:"userSpaceOnUse",width:e.width,x:e.x,y:e.y},K("image",{height:e.image.height,href:e.image.href,width:e.image.width,x:e.image.x,y:e.image.y}));if(s){const i=s.stops.map((r,n)=>K("stop",{key:`${n}-stop`,offset:r.offset,"stop-color":r.color}));return K("linearGradient",{gradientUnits:"userSpaceOnUse",id:s.id,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2},i)}return null}function VZe(t,e){if(!t||t.length===0)return null;const s=[];for(const i of t){const{shape:r,fill:n,stroke:o,font:a}=i,l=a0e(n),u=l0e(o),c=r.type==="text"?u0e(r,a):null,h=o0e(r,l.fill,u,c);h&&s.push(h)}return K("mask",{id:e,maskUnits:"userSpaceOnUse"},K("g",null,s))}function qse(t,e,s){return Nb(t,E$(t),[e,s])}function Gse(t,e,s,i,r){return C$(t,E$(t),[e,s]),t[4]=t[4]*e-i*e+i,t[5]=t[5]*s-r*s+r,t}function qZe(t,e,s,i){const r=e%360*Math.PI/180;cP(t,E$(t),r);const n=Math.cos(r),o=Math.sin(r),a=t[4],l=t[5];return t[4]=a*n-l*o+i*o-s*n+s,t[5]=l*n+a*o-s*o-i*n+i,t}function Qo(t,e){Yi&&"left"in Yi?(Yi.left!=null&&Yi.left>t&&(Yi.left=t),(Yi.right==null||Yi.right<t)&&(Yi.right=t),(Yi.top==null||Yi.top>e)&&(Yi.top=e),(Yi.bottom==null||Yi.bottom<e)&&(Yi.bottom=e)):Yi={left:t,bottom:e,right:t,top:e}}function zse(t){const e=t.args,s=e.length;let i;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(i=0;i<s;i+=2)Qo(e[i],e[i+1]);Is.x=e[s-2],Is.y=e[s-1];break;case"H":for(i=0;i<s;++i)Qo(e[i],Is.y);Is.x=e[s-1];break;case"V":for(i=0;i<s;++i)Qo(Is.x,e[i]);Is.y=e[s-1];break;case"m":{let r=0;for(("x"in Is)||(Qo(Is.x=e[0],Is.y=e[1]),r=2),i=r;i<s;i+=2)Qo(Is.x+=e[i],Is.y+=e[i+1]);break}case"l":case"t":for(i=0;i<s;i+=2)Qo(Is.x+=e[i],Is.y+=e[i+1]);break;case"h":for(i=0;i<s;++i)Qo(Is.x+=e[i],Is.y);break;case"v":for(i=0;i<s;++i)Qo(Is.x,Is.y+=e[i]);break;case"c":for(i=0;i<s;i+=6)Qo(Is.x+e[i],Is.y+e[i+1]),Qo(Is.x+e[i+2],Is.y+e[i+3]),Qo(Is.x+=e[i+4],Is.y+=e[i+5]);break;case"s":case"q":for(i=0;i<s;i+=4)Qo(Is.x+e[i],Is.y+e[i+1]),Qo(Is.x+=e[i+2],Is.y+=e[i+3]);break;case"A":for(i=0;i<s;i+=7)Qo(e[i+5],e[i+6]);Is.x=e[s-2],Is.y=e[s-1];break;case"a":for(i=0;i<s;i+=7)Qo(Is.x+=e[i+5],Is.y+=e[i+6])}}function Use(t,e,s){const i=kZe[t.toLowerCase()];let r;typeof i=="number"&&(i?e.length>=i&&(r={action:t,args:e.slice(0,e.length-e.length%i)},s.push(r),zse(r)):(r={action:t,args:[]},s.push(r),zse(r)))}function GZe(t){const e=(typeof t.path!="string"?n0e(t.path):t.path).match(FZe),s=[];if(Yi={},Is={},!e)return null;let i="",r=[];const n=e.length;for(let a=0;a<n;++a){const l=e[a],u=parseFloat(l);isNaN(u)?(i&&Use(i,r,s),r=[],i=l):r.push(u)}Use(i,r,s);const o={x:0,y:0,width:0,height:0};return Yi&&"left"in Yi&&(o.x=Yi.left,o.y=Yi.top,o.width=Yi.right-Yi.left,o.height=Yi.bottom-Yi.top),o}function zZe(t){const e={x:0,y:0,width:0,height:0};if(t.type==="circle")e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if(t.type==="ellipse")e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if(t.type==="image"||t.type==="rect")e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if(t.type==="path"){const s=GZe(t);e.x=s.x,e.y=s.y,e.width=s.width,e.height=s.height}return e}function UZe(t){const e={x:0,y:0,width:0,height:0};let s=null,i=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(const n of t)s?(s.x=Math.min(s.x,n.x),s.y=Math.min(s.y,n.y),i=Math.max(i,n.x+n.width),r=Math.max(r,n.y+n.height)):(s=e,s.x=n.x,s.y=n.y,i=n.x+n.width,r=n.y+n.height);return s&&(s.width=i-s.x,s.height=r-s.y),s}function BZe(t,e,s,i,r,n,o,a,l){let u=(o&&n?Ff(n,e):e)/2,c=(o&&n?Ff(n,s):s)/2;if(l){const S=l[0],T=l[1];u=(o&&n?Ff(n,S):S)/2,c=(o&&n?Ff(n,T):T)/2}const h=t.width+i,m=t.height+i,f=g3(),g=g3();let v=!1;if(r&&h!==0&&m!==0){const S=e!==s?e/s:h/m,T=e>s?e:s;let P=1,I=1;isNaN(T)||(S>1?(P=T/h,I=T/S/m):(I=T/m,P=T*S/h)),Zy(g,g,Gse(f,P,I,u,c)),v=!0}const b=t.x+(h-i)/2,w=t.y+(m-i)/2;if(Zy(g,g,qse(f,u-b,c-w)),!v&&(h>e||m>s)){const S=h/e>m/s,T=(S?e:s)/(S?h:m);Zy(g,g,Gse(f,T,T,b,w))}return a&&Zy(g,g,qse(f,a[0],a[1])),n&&Zy(g,g,qZe(f,n,b,w)),`matrix(${g[0]},${g[1]},${g[2]},${g[3]},${g[4]},${g[5]})`}function jZe(t,e,s){const i=t==null?void 0:t.effects.find(u=>u.type==="bloom");if(!i)return null;const{strength:r,radius:n}=i,o=r>0?n:0,a=(r+o)*e,l=4*r+1;return K("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${s}`,width:"300%",x:"-100%",y:"-100%"},K("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(r+.5*o)*(5**(e/100)*(.4+e/100)),result:"dilate"}),K("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:a/25}),K("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:a/50}),K("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},K("feFuncR",{slope:l,type:"linear"}),K("feFuncG",{slope:l,type:"linear"}),K("feFuncB",{slope:l,type:"linear"})),K("feMerge",null,K("feMergeNode",{in:"intensityBlur"}),K("feMergeNode",{in:"intensityBrightness"}),K("feGaussianBlur",{stdDeviation:r/10})))}function HZe(t,e,s,i={}){var m,f,g;const r=[],n=[],o=DZe(),a=jZe(i.effectView,e,o);let l=null;if(a){const v=(m=i.effectView)==null?void 0:m.effects.find(T=>T.type==="bloom"),b=(v.strength?v.strength+v.radius/2:0)/3,w=e+e*b,S=s+s*b;l=[Math.max(w,10),Math.max(S,10)]}let u=e,c=s;if(i.useRotationSize)for(let v=0;v<t.length;v++){const b=((f=i.rotations)==null?void 0:f[v])??0;u=Math.max(Ff(b,e),u),c=Math.max(Ff(b,s),c)}for(let v=0;v<t.length;v++){const b=t[v],w=[],S=[];let T=0,P=0,I=0;for(const R of b){const{shape:O,fill:z,stroke:q,font:U,offset:V}=R;i.ignoreStrokeWidth||O.type==="text"||(T+=(q==null?void 0:q.width)||0);const B=a0e(z),H=l0e(q),W=O.type==="text"?u0e(O,U):null;r.push(LZe(B)),w.push(o0e(O,B.fill,H,W,i.ariaLabel)),S.push(zZe(O)),V&&(P+=V[0],I+=V[1])}const A=((g=i.rotations)==null?void 0:g[v])??0;i.useRotationSize&&(P+=(u-Ff(A,e))/2,I+=(c-Ff(A,s))/2);const D=BZe(UZe(S),e,s,T,i.scale??!1,A,i.useRotationSize??!1,[P,I],l);let k=null;if(i.masking){const R=`mask-${v}`,O=i.masking[v];r.push(VZe(O,R)),k=`url(#${R})`}n.push(k?K("g",{mask:k},K("g",{transform:D},w)):K("g",{transform:D},w))}return a&&($C(l),u=l[0],c=l[1]),K("svg",{"aria-label":i.ariaLabel,focusable:!1,height:c,role:"img",style:"display: block;",width:u,xmlns:$Ze},a,K("defs",null,r),a?K("g",{filter:`url(#bloom${o})`},n):n)}const Bse=Y5();function YZe(t,e){Bse.append(t,e),Bse.detach(e)}function J$(t,e,s){const i=Math.ceil(e[0]),r=Math.ceil(e[1]);if(!t.some(o=>!!o.length))return null;const n=(s==null?void 0:s.node)||document.createElement("div");return s.opacity!=null&&(n.style.opacity=s.opacity.toString()),s.effectView!=null&&(n.style.filter=g_e(s.effectView)),YZe(n,()=>HZe(t,i,r,s)),n}function XZe(t,e){t=Math.ceil(t),e=Math.ceil(e);const s=document.createElement("canvas");s.width=t,s.height=e,s.style.width=t+"px",s.style.height=e+"px";const i=s.getContext("2d");return i.clearRect(0,0,t,e),i}function WZe(t,e,s){return t?js(t,{responseType:"image"}).then(i=>{const r=i.data,n=r.width,o=r.height,a=n/o;let l=e;if(s){const u=Math.max(n,o);l=Math.min(l,u)}return{image:r,width:a<=1?Math.ceil(l*a):l,height:a<=1?l:Math.ceil(l/a)}}):Promise.reject(new ae("renderUtils: imageDataSize","href not provided."))}function ZZe(t,e){return!(!t||e==="ignore")&&(e!=="multiply"||t.r!==255||t.g!==255||t.b!==255||t.a!==1)}function QZe(t,e,s,i,r){switch(r){case"multiply":t[e]*=s[0],t[e+1]*=s[1],t[e+2]*=s[2],t[e+3]*=s[3];break;default:{const n=Q$({r:t[e],g:t[e+1],b:t[e+2]});n.h=i.h,n.s=i.s,n.v=n.v/100*i.v;const o=S0(n);t[e]=o.r,t[e+1]=o.g,t[e+2]=o.b,t[e+3]*=s[3];break}}}function JZe(t,e,s,i,r){return WZe(t,e,r).then(n=>{const o=n.width??e,a=n.height??e;if(n.image&&ZZe(s,i)){let l=n.image.width,u=n.image.height;ge("edge")&&/\.svg$/i.test(t)&&(l-=1,u-=1);const c=XZe(o,a);c.drawImage(n.image,0,0,l,u,0,0,o,a);const h=c.getImageData(0,0,o,a),m=[s.r/255,s.g/255,s.b/255,s.a],f=Q$(s);for(let g=0;g<h.data.length;g+=4)QZe(h.data,g,m,f,i);c.putImageData(h,0,0),t=c.canvas.toDataURL("image/png")}else{const l=Mt==null?void 0:Mt.findCredential(t);if(l!=null&&l.token){const u=t.includes("?")?"&":"?";t=`${t}${u}token=${l.token}`}}return{url:t,width:o,height:a}}).catch(()=>({url:t,width:e,height:e}))}const KZe=["web-gltf","web","cim"];function eQe(t){return t=t||globalThis.location.hostname,tQe.some(e=>(t==null?void 0:t.match(e))!=null)}function jse(t,e){return t?(e=e||globalThis.location.hostname)?e.match(c0e)!=null||e.match(m0e)!=null?t.replace("static.arcgis.com","staticdev.arcgis.com"):e.match(h0e)!=null||e.match(d0e)!=null?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t:null}const c0e=/^devext\.arcgis\.com$/,h0e=/^qaext\.arcgis\.com$/,m0e=/^[\w-]*\.mapsdevext\.arcgis\.com$/,d0e=/^[\w-]*\.mapsqa\.arcgis\.com$/,tQe=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,c0e,h0e,/^jsapps\.esri\.com$/,m0e,d0e];function p0e(t,e,s){const i=t.name;return i==null?Promise.reject(new ae("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?sQe(i,e,s):Rge(t,e,s).then(r=>g0e(r,i,e,TUe,s))}function f0e(t,e){return e.items.find(s=>s.name===t)}async function g0e(t,e,s,i,r){var b,w;const n=(s==null?void 0:s.portal)!=null?s.portal:qo.getDefault(),o={portal:n,url:Sr(t.baseUrl)},a=f0e(e,t.data);if(!a)throw new ae("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e});const l=(r==null?void 0:r.acceptedFormats)??KZe,u=i(a,l);if(!u)throw new ae("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${e}' does not have an accepted format (one of ${l})`,{symbolName:e});const{url:c,format:h}=u;let m=Zf(c,o),f=((b=a.thumbnail)==null?void 0:b.href)??null;const g=(w=a.thumbnail)==null?void 0:w.imageData;eQe()&&(m=jse(m)??"",f=jse(f));const v={portal:n,url:Sr(Dz(m)),origin:"portal-item"};return $U(m,r).then(S=>{const T=h==="cim"?kge(S.data):S.data,P=Nge(T,v);if(P&&xg(P)){if(f){const I=Zf(f,o);P.thumbnail=new w_({url:I})}else g&&(P.thumbnail=new w_({url:`data:image/png;base64,${g}`}));t.styleUrl?P.styleOrigin=new OE({portal:s.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(P.styleOrigin=new OE({portal:s.portal,styleName:t.styleName,name:e}))}return P})}function sQe(t,e,s){const i=IUe.replaceAll(/\{SymbolName\}/gi,t),r=e.portal!=null?e.portal:qo.getDefault();return $U(i,s).then(n=>{const o=kge(n.data);return Nge(o,{portal:r,url:Sr(Dz(i)),origin:"portal-item"})})}const iQe=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:g0e,getStyleItemFromStyle:f0e,resolveWebStyleSymbol:p0e},Symbol.toStringTag,{value:"Module"})),e_=En.size,sN=En.maxSize,p9=En.maxOutlineSize,Hse=En.lineWidth,M8=En.tallSymbolWidth;function Fv(t){const e=t.outline,s=t.material!=null?t.material.color:null,i=s!=null?s.toHex():null;if(e==null||"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"&&e.pattern.style==="none")return t.type==="fill"&&i==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const r=ko(e.size)||0;return{color:"rgba("+(e.color!=null?e.color.toRgba():"255,255,255,1")+")",width:Math.min(r,p9),style:"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"?e9(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}async function rQe(t,e){var i,r,n;if((i=t.thumbnail)!=null&&i.url)return t.thumbnail.url;if(e.type==="icon"&&((r=e==null?void 0:e.resource)==null?void 0:r.href))return AHe(e);const s=Ii("esri/images/Legend/legend3dsymboldefault.png");if(t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)){const o=await p0e(t.styleOrigin,{portal:t.styleOrigin.portal}).catch(()=>null);if(o&&"thumbnail"in o&&((n=o.thumbnail)!=null&&n.url))return o.thumbnail.url}return s}function KO(t,e=1){const s=t.a,i=Q$(t),r=i.h,n=i.s/e,o=100-(100-i.v)/e,{r:a,g:l,b:u}=S0({h:r,s:n,v:o});return[a,l,u,s]}function q3(t){var e;return t.type==="water"?t.color==null?null:t.color:((e=t.material)==null?void 0:e.color)==null?null:t.material.color}function Ns(t,e=0){const s=q3(t);if(!s){if(t.type==="fill")return null;const r=PHe.r,n=Bf(r,e);return[n,n,n,100]}const i=s.toRgba();for(let r=0;r<3;r++)i[r]=Bf(i[r],e);return i}async function y0e(t,e){const s=t.style;return s==="none"?null:{type:"pattern",x:0,y:0,src:await CHe(Ii(`esri/symbols/patterns/${s}.png`),e.toCss(!0)),width:5,height:5}}function Yse(t){return t.outline?Fv(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function f9(t,e){const s=q3(t);if(!s)return null;let i="rgba(";return i+=Bf(s.r,e)+",",i+=Bf(s.g,e)+",",i+=Bf(s.b,e)+",",i+s.a+");"}function A8(t,e){const s=f9(t,e);return s?"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"&&t.pattern.style==="none"?null:{color:s,width:Math.min(t.size?ko(t.size):.75,p9),style:"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"?e9(t.pattern.style):null,cap:"cap"in t?t.cap:null,join:"join"in t?t.join==="miter"?ko(2):t.join:null}:{}}function QI(t,e,s){const i=s!=null?.75*s:0;return{type:"linear",x1:i?.25*i:0,y1:i?.5*i:0,x2:i||4,y2:i?.5*i:4,colors:[{color:t,offset:0},{color:e,offset:1}]}}function nQe(t){const e=t.depth,s=t.height,i=t.width;return i!==0&&e!==0&&s!==0&&i===e&&i!=null&&s!=null&&i<s}function oQe(t,e,s){var r,n;const i=[];if(!t)return i;switch(t.type){case"icon":{const l=e,u=e;switch(((r=t.resource)==null?void 0:r.primitive)??d4e){case"circle":i.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:Ns(t,0),stroke:Fv(t)});break;case"square":i.push({shape:{type:"path",path:[{command:"M",values:[0,u]},{command:"L",values:[0,0]},{command:"L",values:[l,0]},{command:"L",values:[l,u]},{command:"Z",values:[]}]},fill:Ns(t,0),stroke:Fv(t)});break;case"triangle":i.push({shape:{type:"path",path:[{command:"M",values:[0,u]},{command:"L",values:[.5*l,0]},{command:"L",values:[l,u]},{command:"Z",values:[]}]},fill:Ns(t,0),stroke:Fv(t)});break;case"cross":i.push({shape:{type:"path",path:[{command:"M",values:[.5*l,0]},{command:"L",values:[.5*l,u]},{command:"M",values:[0,.5*u]},{command:"L",values:[l,.5*u]}]},stroke:Yse(t)});break;case"x":i.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[l,u]},{command:"M",values:[l,0]},{command:"L",values:[0,u]}]},stroke:Yse(t)});break;case"kite":i.push({shape:{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[.5*l,0]},{command:"L",values:[l,.5*u]},{command:"L",values:[.5*l,u]},{command:"Z",values:[]}]},fill:Ns(t,0),stroke:Fv(t)})}break}case"object":switch(((n=t.resource)==null?void 0:n.primitive)??_4e){case"cone":{const o=QI(Ns(t,0),Ns(t,-.6),s?M8:e),a=oZe(e,s);i.push({shape:a[0],fill:o},{shape:a[1],fill:o});break}case"inverted-cone":{const o=Ns(t,0),a=QI(o,Ns(t,-.6),e),l=aZe(e);i.push({shape:l[0],fill:a},{shape:l[1],fill:o});break}case"cube":{const o=rZe(e,s);i.push({shape:o[0],fill:Ns(t,0)},{shape:o[1],fill:Ns(t,-.3)},{shape:o[2],fill:Ns(t,-.5)});break}case"cylinder":{const o=QI(Ns(t,0),Ns(t,-.6),s?M8:e),a=nZe(e,s);i.push({shape:a[0],fill:o},{shape:a[1],fill:o},{shape:a[2],fill:Ns(t,0)});break}case"diamond":{const o=lZe(e);i.push({shape:o[0],fill:Ns(t,-.3)},{shape:o[1],fill:Ns(t,0)},{shape:o[2],fill:Ns(t,-.3)},{shape:o[3],fill:Ns(t,-.7)});break}case"sphere":{const o=QI(Ns(t,0),Ns(t,-.6));o.x1=0,o.y1=0,o.x2=.25*e,o.y2=.25*e,i.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:o});break}case"tetrahedron":{const o=uZe(e);i.push({shape:o[0],fill:Ns(t,-.3)},{shape:o[1],fill:Ns(t,0)},{shape:o[2],fill:Ns(t,-.6)});break}}break}return i}function K$(t){const e=typeof(t==null?void 0:t.size)=="number"?t==null?void 0:t.size:null;return e?ko(e):null}function aQe(t){return t.type==="icon"?"multiply":"tint"}async function lQe(t,e){const s=K$(e),i=e!=null&&e.maxSize?ko(e.maxSize):null,r=(e==null?void 0:e.disableUpsampling)??!1,n=t.symbolLayers,o=[],a=[];let l=!1,u=0,c=0,h=0;n.forEach(g=>{var S,T,P,I;if(g.type!=="icon"&&g.type!=="object")return;g&&g.type==="icon"&&(h=Math.max(g.size&&ko(g.size),h));const v=g.type==="icon"?g.size&&ko(g.size):0,b=s||v?Math.ceil(Math.min(s||v,i||sN)):e_;let w=g.type==="icon"?g.angle:null;if((e==null?void 0:e.rotation)!=null&&(w=(w??0)+e.rotation),a.push(w),(S=g==null?void 0:g.resource)==null?void 0:S.href){const A=rQe(t,g).then(D=>{var O;const k=(O=g==null?void 0:g.material)==null?void 0:O.color,R=aQe(g);return JZe(D,b,k,R,r)}).then(D=>{const k=D.width,R=D.height;return u=Math.max(u,k),c=Math.max(c,R),w&&(l=!0),[{shape:{type:"image",x:0,y:0,width:k,height:R,src:D.url},fill:null,stroke:null}]});o.push(A)}else{let A=b;g.type==="icon"&&s&&(A=b*(v/h));const D=(e==null?void 0:e.symbolConfig)==="tall"||((T=e==null?void 0:e.symbolConfig)==null?void 0:T.isTall)||g.type==="object"&&nQe(g);u=Math.max(u,D?M8:A),c=Math.max(c,A),w&&((P=g.resource)!=null&&P.primitive)&&["square","triangle","x"].includes((I=g.resource)==null?void 0:I.primitive)&&(l=!0),o.push(Promise.resolve(oQe(g,A,D)))}});const m=await Promise.allSettled(o),f=[];return m.forEach(g=>{g.status==="fulfilled"?f.push(g.value):g.reason&&Ne.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",g.reason)}),J$(f,[u,c],{node:e==null?void 0:e.node,scale:!1,opacity:e==null?void 0:e.opacity,ariaLabel:e==null?void 0:e.ariaLabel,rotations:a,useRotationSize:l})}function uQe(t,e){const s=t.symbolLayers,i=[],r=MHe(t),n=K$(e),o=(e!=null&&e.maxSize?ko(e.maxSize):null)||p9;let a,l=0,u=0;return s.forEach((c,h)=>{if(!c||c.type!=="line"&&c.type!=="path")return;const m=[];switch(c.type){case"line":{const f=A8(c,0);if(f==null)break;const g=(f==null?void 0:f.width)||0;h===0&&(a=g);const v=Math.min(n||g,o),b=h===0?v:n?v*(g/a):v,w=b>Hse/2?2*b:Hse;u=Math.max(u,b),l=Math.max(l,w),f.width=b,m.push({shape:{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[l,.5*u]}]},stroke:f});break}case"path":{const f=Math.min(n||e_,o),g=Ns(c,0),v=Ns(c,-.2),b=f9(c,-.4),w=b?{color:b,width:1}:{};if(c.profile==="quad"){const S=c.width,T=c.height,P=tZe(S&&T?S/T:1,T===0,S===0),I={...w,join:"bevel"};m.push({shape:P[0],fill:v,stroke:I},{shape:P[1],fill:v,stroke:I},{shape:P[2],fill:g,stroke:I})}else m.push({shape:mE.pathSymbol3DLayer[0],fill:v,stroke:w},{shape:mE.pathSymbol3DLayer[1],fill:g,stroke:w});u=Math.max(u,f),l=u}}i.push(m)}),Promise.resolve(J$(i,[l,u],{node:e==null?void 0:e.node,scale:r,opacity:e==null?void 0:e.opacity,ariaLabel:e==null?void 0:e.ariaLabel}))}async function cQe(t,e){const s=t.type==="mesh-3d",i=t.symbolLayers,r=K$(e),n=e!=null&&e.maxSize?ko(e.maxSize):null,o=r||e_,a=[];let l=0,u=0,c=!1;for(let h=0;h<i.length;h++){const m=i.at(h),f=[];if(!s||m.type==="fill"){switch(m.type){case"fill":{const g=Math.min(o,n||sN);if(l=Math.max(l,g),u=Math.max(u,g),c=!0,s){const v=mE.meshSymbol3DFill,b=f9(m,-.4),w=b?{color:b,width:1,join:"round"}:{};f.push({shape:v[0],fill:Ns(m,0),stroke:w},{shape:v[1],fill:Ns(m,-.2),stroke:w},{shape:v[2],fill:Ns(m,-.6),stroke:w})}else{let v=Ns(m,0);const b="pattern"in m?m.pattern:null,w=Fv(m),S=q3(m);b!=null&&b.type==="style"&&b.style!=="solid"&&S&&(v=await y0e(b,S)),f.push({shape:mE.fill[0],fill:v,stroke:w})}break}case"line":{const g=A8(m,0);if(g==null)break;const v={stroke:g,shape:mE.fill[0]};l=Math.max(l,e_),u=Math.max(u,e_),f.push(v);break}case"extrude":{const g={join:"round",width:1,...A8(m,-.4)},v=Ns(m,0),b=Ns(m,-.2),w=Math.min(o,n||sN),S=sZe(w);g.width=1,f.push({shape:S[0],fill:b,stroke:g},{shape:S[1],fill:b,stroke:g},{shape:S[2],fill:v,stroke:g});const T=e_,P=.7*e_+.5*w;l=Math.max(l,T),u=Math.max(u,P);break}case"water":{const g=q3(m),v=KO(g),b=KO(g,2),w=KO(g,3),S=iZe();c=!0,f.push({shape:S[0],fill:v},{shape:S[1],fill:b},{shape:S[2],fill:w});const T=Math.min(o,n||sN);l=Math.max(l,T),u=Math.max(u,T);break}}a.push(f)}}return J$(a,[l,u],{node:e==null?void 0:e.node,scale:c,opacity:e==null?void 0:e.opacity,ariaLabel:e==null?void 0:e.ariaLabel})}function hQe(t,e){if(t.symbolLayers.length===0)return Promise.reject(new ae("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case"point-3d":return lQe(t,e);case"line-3d":return uQe(t,e);case"polygon-3d":case"mesh-3d":return cQe(t,e)}return Promise.reject(new ae("symbolPreview: swatchInfo3D","symbol not supported."))}const mQe=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:y0e,getSizeFromOptions:K$,getSymbolLayerFill:Ns,previewSymbol3D:hQe},Symbol.toStringTag,{value:"Module"}));let I1=null;const Xse=[255,255,255];function Wse(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function Yvt(t,e,s){const{backgroundColor:i,outline:r,dotSize:n}=t,o=(s==null?void 0:s.swatchSize)||En.size,a=.8,l=Math.round(o*o/Math.max(n,.5)**2*a),u=window.devicePixelRatio,c=document.createElement("canvas"),h=o*u;c.width=h,c.height=h,c.style.width=c.width/u+"px",c.style.height=c.height/u+"px";const m=c.getContext("2d");if(i&&(m.fillStyle=i.toCss(!0),m.fillRect(0,0,h,h),m.fill()),m.fillStyle=(e==null?void 0:e.toCss(!0))??"",I1&&I1.length/2===l)for(let g=0;g<2*l;g+=2){const v=I1[g],b=I1[g+1];m.fillRect(v,b,n*u,n*u),m.fill()}else{I1=[];for(let g=0;g<2*l;g+=2){const v=Wse(0,h),b=Wse(0,h);I1.push(v,b),m.fillRect(v,b,n*u,n*u),m.fill()}}r&&(r.color&&(m.strokeStyle=r.color.toCss(!0)),m.lineWidth=r.width,m.strokeRect(0,0,h,h));const f=new Image(o,o);return f.src=c.toDataURL(),f.ariaLabel=(s==null?void 0:s.ariaLabel)??null,f.alt=(s==null?void 0:s.ariaLabel)??"",f}function Xvt(t,e={}){const s=e.radius||40,i=2*Math.PI*s,r=t.length,n=i/r,o=[],a=KU(e.outline);(a==null?void 0:a.width)!=null&&(a.width*=2),(a||e.backgroundColor)&&o.push({shape:{type:"circle",cx:s,cy:s,r:s},fill:e.backgroundColor,stroke:a,offset:[0,0]});const l=e.values,u=l&&l.length===r&&l.reduce((g,v)=>g+v,0)===100,c=[0];for(let g=0;g<r;g++){let v=null;u&&(v=l[g]*i/100,c.push(v+c[g])),o.push({shape:{type:"circle",cx:s,cy:s,r:s/2},fill:[0,0,0,0],stroke:{width:s,dashArray:`${(v??n)/2} ${i}`,dashoffset:"-"+(u?c[g]/2:g*(n/2)),color:t[g]},offset:[0,0]})}let h=null;const m=2*s+((a==null?void 0:a.width)||0),f=e.holePercentage;if(f){a&&o.push({shape:{type:"circle",cx:s,cy:s,r:s*f},fill:null,stroke:a,offset:[0,0]});const g=m/2;h=[[{shape:{type:"circle",cx:g,cy:g,r:g},fill:Xse,stroke:a?{...a,color:Xse}:null,offset:[0,0]},{shape:{type:"circle",cx:g,cy:g,r:s*f},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return J$([o],[m,m],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:h,rotations:[-90],ariaLabel:e.ariaLabel})}function Wvt(t,e={}){const r=e.align==="horizontal",n=r?75:24,o=r?24:75,a=e.width??n,l=e.height??o,u=e.gradient??!0,c=window.devicePixelRatio,h=a*c,m=l*c,f=document.createElement("canvas");f.width=h,f.height=m,f.ariaLabel=e.ariaLabel??null,f.style.width=`${a}px`,f.style.height=`${l}px`;const g=f.getContext("2d"),v=r?h:0,b=r?0:m;if(u){const S=g.createLinearGradient(0,0,v,b),T=t.length,P=T===1?0:1/(T-1);t.forEach((I,A)=>S.addColorStop(A*P,I.toString())),g.fillStyle=S,g.fillRect(0,0,h,m)}else{const S=r?h/t.length:h,T=r?m:m/t.length;let P=0,I=0;for(const A of t)g.fillStyle=A.toString(),g.fillRect(P,I,S,T),P=r?P+S:0,I=r?0:I+T}const w=document.createElement("div");return w.style.width=`${a}px`,w.style.height=`${l}px`,dQe(w,e==null?void 0:e.effectList),w.appendChild(f),w}function dQe(t,e){if(!e)return;t.style.filter=g_e(e);const s=e.effects;if(s){for(const i of s)if((i==null?void 0:i.type)==="drop-shadow"){i.offsetX<0?t.style.marginLeft=`${Math.abs(i.offsetX)}px`:t.style.marginRight=`${i.offsetX}px`;break}}}async function pQe(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:s}=await me(()=>import("./previewWebStyleSymbol-2PI47igZ.js"),[]);return s(t,pQe,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:s}=await me(()=>Promise.resolve().then(()=>mQe),void 0);return s(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:s}=await me(()=>import("./previewSymbol2D-MY-RQ0zx.js"),__vite__mapDeps([312,66,4]));return s(t,e)}case"cim":{const{previewCIMSymbol:s}=await me(()=>import("./previewCIMSymbol-D1g2RaGE.js"),__vite__mapDeps([313,64,65,66,67,68,69,70,62,314,175,171,4]));return s(t,e)}default:return}}function _0e(t){return t&&"opacity"in t?t.opacity*_0e(t.parent):1}async function Zse(t,e){var T;if(!t)return;const s=t.sourceLayer,i=(e!=null&&e.useSourceLayer?s:t.layer)??s,r=e!=null&&e.ignoreOpacity?1:_0e(i);if(t.symbol!=null&&(e==null||e.ignoreGraphicSymbol!==!0)){const P=t.symbol.type==="web-style"?await t.symbol.fetchSymbol({...e,acceptedFormats:["web","cim"],cache:e!=null?e.webStyleCache:null}):t.symbol.clone();return kO(P,null,r),P}const n=(e==null?void 0:e.renderer)??fQe(i);let o=n&&"getSymbolAsync"in n?await n.getSymbolAsync(t,e):null;if(!o)return;if(o=o.type==="web-style"?await o.fetchSymbol({...e,cache:e!=null?e.webStyleCache:null}):o.clone(),!n||!("visualVariables"in n)||!((T=n.visualVariables)!=null&&T.length))return kO(o,null,r),o;if("arcadeRequiredForVisualVariables"in n&&n.arcadeRequiredForVisualVariables&&(e==null?void 0:e.arcade)==null){const P={...e};P.arcade=await Zc(),e=P}const{getColor:a,getOpacity:l,getAllSizes:u,getRotationAngle:c}=await me(()=>Promise.resolve().then(()=>O$),void 0),h=[],m=[],f=[],g=[];for(const P of n.visualVariables)switch(P.type){case"color":h.push(P);break;case"opacity":m.push(P);break;case"rotation":g.push(P);break;case"size":P.target||f.push(P)}const v=!!h.length&&h[h.length-1],b=v?a(v,t,e):null,w=!!m.length&&m[m.length-1];let S=w?l(w,t,e):null;if(r!=null&&(S=S!=null?S*r:r),e!=null&&e.ignoreOpacity&&(S=1),kO(o,b,S),f.length&&(e==null?void 0:e.ignoreSizeVariables)!==!0){const P=u(f,t,e);await zHe(o,P)}if((e==null?void 0:e.ignoreRotationVariables)!==!0)for(const P of g)UHe(o,c(P,t,e),P.axis);return o}function fQe(t){if(t)return"renderer"in t?t.renderer:void 0}function gQe(t){return t&&typeof t.highlight=="function"}function yQe(t,e,s){return t==null||t>=s&&(e===0||t<=e)}function Zvt(t,e){if(e&&t){const{minScale:s,maxScale:i}=t;if(_Qe(s,i))return yQe(e,s,i)}return!0}function _Qe(t,e){return t!=null&&t>0||e!=null&&e>0}function Qvt(t){return!(t!=null&&t.minScale)||!t.maxScale||t.minScale>=t.maxScale}const vQe="esri.widgets.Popup.PopupViewModel",G3=()=>Ne.getLogger(vQe),bQe=t=>{const{event:e,view:s,viewModel:i}=t,{action:r}=e;if(!r)return Promise.reject(new ae("trigger-action:missing-arguments","Event has no action"));const{disabled:n,id:o}=r;if(!o)return Promise.reject(new ae("trigger-action:invalid-action","action.id is missing"));if(n)return Promise.reject(new ae("trigger-action:invalid-action","Action is disabled"));if(o===kf.id)return b0e(i).catch(ZL);if(o===kv.id)return wQe(i);if(o===Ef.id)return i.browseClusterEnabled=!i.browseClusterEnabled,i.featureMenuOpen=i.browseClusterEnabled,Promise.resolve();if(o===Lse.id){i.visible=!1;const{selectedFeature:a}=i;if(!a)return Promise.reject(new ae(`trigger-action:${Lse.id}`,"selectedFeature is required",{selectedFeature:a}));const{sourceLayer:l}=a;return l?l.remove(a):s==null||s.graphics.remove(a),Promise.resolve()}return Promise.resolve()};function v0e(t){const{selectedFeature:e,location:s,view:i}=t;return i?e??s??null:null}function t_(t){var e,s;return!!t&&t.isAggregate&&((s=(e=t.sourceLayer)==null?void 0:e.featureReduction)==null?void 0:s.type)==="cluster"}async function xQe(t,e){if((e==null?void 0:e.type)!=="3d"||!t||t.declaredClass!=="esri.Graphic")return!0;const s=e.getViewForGraphic(t);if(s&&"whenGraphicBounds"in s){let i=null;try{i=await s.whenGraphicBounds(t,{useViewElevation:!0})}catch{}return!i||!i.boundingBox||i.boundingBox[0]===i.boundingBox[3]&&i.boundingBox[1]===i.boundingBox[4]&&i.boundingBox[2]===i.boundingBox[5]}return!0}async function b0e(t,e){var h,m;const{location:s,selectedFeature:i,view:r,zoomFactor:n}=t;await((h=e==null?void 0:e.viewModel)==null?void 0:h.updateGeometry());const o=e==null?void 0:e.graphic,a=o!=null&&o.geometry?o:v0e(t);if(!r||!a){const f=new ae("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:a,view:r});throw G3().error(f),f}const l=r.scale/n,u=(o==null?void 0:o.geometry)??((m=t.selectedFeature)==null?void 0:m.geometry)??s,c=u!=null&&u.type==="point"&&await xQe(o??i,r);kf.active=!0,kf.disabled=!0;try{await t.zoomTo({target:{target:a,scale:c?l:void 0}})}catch(f){if(Lr(f))return;const g=new ae("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:o??i});G3().error(g)}finally{kf.active=!1,kf.disabled=!1,t.zoomToLocation=null,c&&(t.location=u)}}async function wQe(t){const{selectedFeature:e,view:s}=t;if((s==null?void 0:s.type)!=="2d"){const o=new ae("zoomToCluster:invalid-view","View must be 2d MapView.",{view:s});throw G3().error(o),o}if(!e||!t_(e)){const o=new ae("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw G3().error(o),o}const[i,r]=await g9(s,e);kv.active=!0,kv.disabled=!0;const{extent:n}=await i.queryExtent(r);n&&await t.zoomTo({target:n}),kv.active=!1,kv.disabled=!1}async function SQe(t){const{view:e,selectedFeature:s}=t;if(!e||!s)return;const[i,r]=await g9(e,s),{extent:n}=await i.queryExtent(r);t.selectedClusterBoundaryFeature.geometry=n,e.graphics.add(t.selectedClusterBoundaryFeature)}async function EQe(t){const{selectedFeature:e,view:s}=t;if(!s||!e)return;const[i,r]=await g9(s,e);Ef.active=!0,Ef.disabled=!0;const{features:n}=await i.queryFeatures(r);Ef.active=!1,Ef.disabled=!1,Ef.value=!0;const o={features:[e].concat(n)};(t==null?void 0:t.initialDisplayMode)==="feature"&&(o.featureMenuOpen=!0),t==null||t.open(o)}async function g9(t,e){const s=await t.whenLayerView(e.sourceLayer),i=s.createQuery(),r=e.getObjectId();return i.aggregateIds=r!=null?[r]:[],[s,i]}function CQe(t){Ef.value=!1;const e=t.features.filter(s=>t_(s));e.length&&(t.features=e)}const eL="location-scale-handle",PQe=()=>[kf.clone()],TQe=()=>[kv.clone(),Ef.clone()];let JI=null;function IQe(t,e){return t==="building-scene"||e==="2d"&&(t==="map-image"||t==="tile"||t==="imagery"||t==="imagery-tile")}let Ut=class extends _fe(Z_e){constructor(e){super(e),this._pendingPromises=new KWe,this._fetchFeaturesController=null,this._highlightPromises={"highlight-active-feature":null,"highlight-selected-feature":null},this._selectedClusterFeature=null,this.actions=new T_,this.activeFeature=null,this.autoCloseEnabled=!1,this.browseClusterEnabled=!1,this.content=null,this.defaultPopupTemplateEnabled=!1,this.featurePage=null,this.featuresPerPage=20,this.featureMenuOpen=!1,this.featureMenuTitle=null,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.initialDisplayMode="feature",this.selectedClusterBoundaryFeature=new tn({symbol:new bg({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null,this._debouncedLocationUpdate=jh(async s=>{var o,a,l,u;const{spatialReference:i}=this,r=(a=(o=this.selectedFeature)==null?void 0:o.geometry)==null?void 0:a.type,n=this.location??s;if(r&&r!=="mesh"&&i&&n&&this.selectedFeature)if(r!=="point")try{const c=this.selectedFeature;let h=c.geometry;const m=this._getHighlightLayer(c),f=c.getObjectId();if(!m||!this.view)return;if(f){const g=(l=this.view)==null?void 0:l.allLayerViews.find(w=>w.layer.uid===m.uid);if(!g||!("queryFeatures"in g))return;const v=g.createQuery();v.outSpatialReference=i,v.objectIds=[f],v.returnGeometry=!0;const{features:b}=await g.queryFeatures(v);h=(u=b[0])==null?void 0:u.geometry}if(!h||h.type==="mesh")return;if(h=Vd(h,i),JI||(JI=await me(()=>import("./geometryEngineAsync-CIShf4Ft.js"),[])),!await JI.intersects(h,n)){const g=(await JI.nearestCoordinate(h,n)).coordinate??n;this.selectedFeature===c&&(this.location=g)}}catch(c){Lr(c)||Ne.getLogger(this).error(c)}else this.location=t8(this.selectedFeature.geometry)??n})}initialize(){this.addHandles([this.on("view-change",()=>this._autoClose()),Ee(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),Ee(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),Ee(()=>{var e,s;return(s=(e=this.view)==null?void 0:e.animation)==null?void 0:s.state},e=>this._animationStateChange(e)),Ee(()=>this.location,e=>this._locationChange(e)),Ee(()=>this.selectedFeature,e=>this._selectedFeatureChange(e)),Ee(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),Ee(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),Ee(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",e=>bQe({event:e,viewModel:this,view:this.view})),Or(()=>!this.waitingForResult,()=>this._waitingForResultChange(),Xc),Ee(()=>[this.features,this.map,this.spatialReference,this.timeZone],()=>this._updateFeatureVMs()),Ee(()=>{var e;return(e=this.view)==null?void 0:e.scale},()=>this._viewScaleChange()),Or(()=>!this.visible,()=>this.browseClusterEnabled=!1),Ee(()=>this.browseClusterEnabled,e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures(),this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null,this.map=null,this.spatialReference=null,this.timeZone=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new T_;e.removeAll();const{actions:s,defaultActions:i,defaultPopupTemplateEnabled:r,includeDefaultActions:n,selectedFeature:o}=this,a=n?i.concat(s):s,l=o&&(typeof o.getEffectivePopupTemplate=="function"&&o.getEffectivePopupTemplate(r)||o.popupTemplate),u=l==null?void 0:l.actions,c=l!=null&&l.overwriteActions?u:(u==null?void 0:u.concat(a))??a;return c==null||c.filter(Boolean).forEach(h=>e.add(h)),e}get defaultActions(){const e=this._get("defaultActions")||new T_;return e.removeAll(),e.addMany(t_(this.selectedFeature)?TQe():PQe()),e}get featureCount(){return this.features.length}set features(e){const s=e||[];this._set("features",s);const{pendingPromisesCount:i,promiseCount:r,selectedFeatureIndex:n}=this,o=r&&s.length;this.initialDisplayMode!=="list"?o&&i&&n===-1?this.selectedFeatureIndex=0:o&&n!==-1||(this.selectedFeatureIndex=s.length?0:-1):(!o||o&&i===r)&&(this.selectedFeatureIndex=-1)}set location(e){var n,o;let s=e;const i=(n=this.spatialReference)==null?void 0:n.isWebMercator;((o=e==null?void 0:e.spatialReference)==null?void 0:o.isWGS84)&&i&&(s=bd(e)),this._set("location",s)}get map(){var e;return((e=this.view)==null?void 0:e.map)??null}set map(e){this._override("map",e)}get pendingPromisesCount(){return this._pendingPromises.size}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){this._pendingPromises.clear(),this.features=[],Array.isArray(e)&&e.length?(this._set("promises",e),(e=e.slice()).forEach(s=>this._pendingPromises.add(s)),e.reduce((s,i)=>s.finally(()=>i.then(r=>{this._pendingPromises.has(i)&&this._updateFeatures(r)}).finally(()=>this._pendingPromises.delete(i)).catch(()=>{})),Promise.resolve())):this._set("promises",[])}get selectedFeature(){const{features:e,selectedFeatureIndex:s}=this;return s===-1?null:e[s]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return typeof e=="number"?e:-1}set selectedFeatureIndex(e){const{featureCount:s}=this;(isNaN(e)||e<0||!s)&&(e=-1),this.activeFeature=null,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get spatialReference(){var e;return((e=this.view)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{view:e,map:s}=this;return e?e.ready?"ready":"disabled":s?"ready":"disabled"}get timeZone(){var e;return((e=this.view)==null?void 0:e.timeZone)??Gu}set timeZone(e){this._overrideIfSome("timeZone",e)}get waitingForContents(){return this.featureViewModels.some(e=>e.waitingForContent)}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||this.featureCount!==0)}centerAtLocation(){const{view:e}=this,s=v0e(this);return s&&e?this.callGoTo({target:{target:s,scale:e.scale}}):Promise.reject(new ae("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:s,view:e}))}zoomTo(e){return this.callGoTo(e)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(e,s){var r;const{view:i}=this;if(!i||!e)throw new ae("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:i});return i.fetchPopupFeatures(e,{pointerType:(r=s==null?void 0:s.event)==null?void 0:r.pointerType,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:s==null?void 0:s.signal})}open(e){const s={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:i}=s;delete s.fetchFeatures,i&&this._setFetchFeaturesPromises(s.location);const r=["actionsMenuOpen","collapsed"];for(const n of r)delete s[n];this.set(s)}triggerAction(e){const s=this.allActions.at(e);s&&!s.disabled&&this.emit("trigger-action",{action:s})}next(){return this.selectedFeatureIndex=this._getRoundRobinIndex(this.selectedFeatureIndex+1,this.featureCount),this}previous(){return this.selectedFeatureIndex=this._getRoundRobinIndex(this.selectedFeatureIndex-1,this.featureCount),this}disableClusterBrowsing(){CQe(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const{view:e,selectedFeature:s}=this;(e==null?void 0:e.type)==="2d"?t_(s)?(await SQe(this),await EQe(this)):Ne.getLogger(this).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",s):Ne.getLogger(this).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",s)}handleViewClick(e){this._fetchFeaturesAndOpen(e)}_getRoundRobinIndex(e,s){return(e+s)%s}_animationStateChange(e){this.zoomToLocation||(kf.disabled=e==="waiting-for-target")}_clearBrowsedClusterGraphics(){var s,i;const e=[this.selectedClusterBoundaryFeature,this._selectedClusterFeature].filter(Qa);(i=(s=this.view)==null?void 0:s.graphics)==null||i.removeMany(e),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){if(t_(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}_locationChange(e){const{selectedFeature:s,updateLocationEnabled:i,view:r}=this;r&&i&&e&&(!s||s.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>0?Math.floor((this.selectedFeatureIndex+1)/this.featuresPerPage):null}_featureViewModelsChange(){this.featurePage=this.featureCount>0?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:s,featurePage:i,featuresPerPage:r,featureViewModels:n}=this;if(i==null)return;const o=((i-1)*r+s)%s,a=o+r;n.slice(o,a).forEach((l,u)=>{l&&(l.graphic??(l.graphic=e[o+u]))})}async _selectedFeatureChange(e){var o,a;const{location:s,updateLocationEnabled:i,view:r}=this;if(!e||!r)return;if(this.browseClusterEnabled)return this._selectedClusterFeature&&(r.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),t_(e)?void 0:(e.symbol=await Zse(e),this._selectedClusterFeature=e,void r.graphics.add(this._selectedClusterFeature));const n=(o=e.sourceLayer)==null?void 0:o.type;if(n!=="map-image"&&n!=="imagery"&&n!=="imagery-tile"||(e.symbol=await Zse(e)),!i&&s||!e.geometry){if(i&&!e.geometry){await this.centerAtLocation();const l=(a=r.center)==null?void 0:a.clone();l&&(this.location=l)}}else this.location=t8(e.geometry)}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}async _setFetchFeaturesPromises(e){const{pendingFeatures:s}=await this._fetchFeaturesWithController({mapPoint:e});this.promises=s}_destroyFeatureVMs(){this.featureViewModels.forEach(e=>e&&!e.destroyed&&e.destroy()),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:e,features:s,featureViewModels:i,view:r,spatialReference:n,map:o,timeZone:a,location:l}=this;if(t_(s[0])||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!(s!=null&&s.length))return;const u=i.slice(),c=[];s.forEach((h,m)=>{if(!h)return;let f=null;if(u.some((g,v)=>(g&&g.graphic===h&&(f=g,u.splice(v,1)),!!f)),f)c[m]=f;else{const g=new m9({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:n,graphic:h===e?h:null,location:l,map:o,view:r,timeZone:a});c[m]=g}}),u.forEach(h=>h&&!h.destroyed&&h.destroy()),this._set("featureViewModels",c)}async _getScreenPoint(e,s){const{spatialReference:i,view:r}=this;if(!r)return null;await(r==null?void 0:r.when());const n=e==null?void 0:e.spatialReference;return n&&i?(await s$(n,i,null,s),r.toScreen(e)):null}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null}async _projectScreenPointAndFetchFeatures({mapPoint:e,screenPoint:s,event:i,signal:r}){return this.fetchFeatures(s??await this._getScreenPoint(e??this.location,{signal:r}),{signal:r,event:i})}_fetchFeaturesWithController({mapPoint:e,screenPoint:s,event:i}){this._cancelFetchingFeatures();const r=new AbortController,{signal:n}=r;this._fetchFeaturesController=r;const o=this._projectScreenPointAndFetchFeatures({mapPoint:e,screenPoint:s,signal:n,event:i});return o.catch(()=>{}).then(()=>{this._fetchFeaturesController=null}),o}async _fetchFeaturesAndOpen(e){const{mapPoint:s,screenPoint:i}=e,{view:r}=this;this.removeHandles(eL),this.addHandles([Ee(()=>{var o;return(o=this.view)==null?void 0:o.scale},()=>this._debouncedLocationUpdate(s).catch(o=>{Lr(o)||Ne.getLogger(this).error(o)})),Or(()=>!this.visible,()=>{this.removeHandles(eL)},{once:!0})],eL);const{pendingFeatures:n}=await this._fetchFeaturesWithController({mapPoint:s,screenPoint:i,event:e});r!=null&&r.popup&&"open"in r.popup&&r.popup.open({location:s??void 0,promises:n})}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}async _getLayerView(e,s){return await e.when(),e.whenLayerView(s)}_getHighlightLayer(e){const{layer:s,sourceLayer:i}=e;return i&&"layer"in i&&i.layer?i.layer:(i==null?void 0:i.type)==="map-notes"||(i==null?void 0:i.type)==="subtype-group"?i:s}_getHighlightLayerView(e,s){return s.type==="subtype-sublayer"&&s.parent&&this._mapIncludesLayer(s.parent)?this._getLayerView(e,s.parent):s&&this._mapIncludesLayer(s)?this._getLayerView(e,s):null}_getHighlightTarget(e,s,i){if(IQe(s.type,i))return e;const r=e.getObjectId();if(r!=null)return r;const n=s.type==="imagery"?void 0:"objectIdField"in s?s.objectIdField||eZe:null,o=e.attributes;return o&&n&&o[n]||e}_mapIncludesLayer(e){var s,i;return!!((i=(s=this.map)==null?void 0:s.allLayers)!=null&&i.includes(e))}async _highlightFeature(e,s){this.removeHandles(e);const i=this[s];if(!i)return;const{highlightEnabled:r,view:n,visible:o}=this;if(!n||!r||!o)return;const a=this._getHighlightLayer(i);if(!a)return;const l=this._getHighlightLayerView(n,a);if(!l)return;this._highlightPromises[e]=l;const u=await l;if(!(u&&gQe(u)&&this._highlightPromises[e]===l&&this[s]&&this.highlightEnabled))return;const c=u.highlight(this._getHighlightTarget(i,a,n.type));this.addHandles(c,e)}async _highlightActiveFeature(){return this._highlightFeature("highlight-active-feature","activeFeature")}async _highlightSelectedFeature(){return this._highlightFeature("highlight-selected-feature","selectedFeature")}_updateFeatures(e){const{features:s}=this,i=e.filter(r=>!s.includes(r));i!=null&&i.length&&(this.features=s.concat(i))}};p([_()],Ut.prototype,"_fetchFeaturesController",void 0),p([_({type:T_})],Ut.prototype,"actions",void 0),p([_({readOnly:!0})],Ut.prototype,"active",null),p([_()],Ut.prototype,"activeFeature",void 0),p([_({readOnly:!0})],Ut.prototype,"allActions",null),p([_()],Ut.prototype,"autoCloseEnabled",void 0),p([_()],Ut.prototype,"browseClusterEnabled",void 0),p([_()],Ut.prototype,"content",void 0),p([_({type:T_,readOnly:!0})],Ut.prototype,"defaultActions",null),p([_({type:Boolean})],Ut.prototype,"defaultPopupTemplateEnabled",void 0),p([_({readOnly:!0})],Ut.prototype,"featureCount",null),p([_()],Ut.prototype,"featurePage",void 0),p([_({value:[]})],Ut.prototype,"features",null),p([_()],Ut.prototype,"featuresPerPage",void 0),p([_()],Ut.prototype,"featureMenuOpen",void 0),p([_()],Ut.prototype,"featureMenuTitle",void 0),p([_()],Ut.prototype,"featureViewModelAbilities",void 0),p([_({readOnly:!0})],Ut.prototype,"featureViewModels",void 0),p([_()],Ut.prototype,"highlightEnabled",void 0),p([_()],Ut.prototype,"includeDefaultActions",void 0),p([_()],Ut.prototype,"initialDisplayMode",void 0),p([_({type:Et})],Ut.prototype,"location",null),p([_()],Ut.prototype,"map",null),p([_({readOnly:!0})],Ut.prototype,"pendingPromisesCount",null),p([_({readOnly:!0})],Ut.prototype,"promiseCount",null),p([_()],Ut.prototype,"promises",null),p([_({readOnly:!0})],Ut.prototype,"selectedClusterBoundaryFeature",void 0),p([_({value:null,readOnly:!0})],Ut.prototype,"selectedFeature",null),p([_({value:-1})],Ut.prototype,"selectedFeatureIndex",null),p([_({readOnly:!0})],Ut.prototype,"selectedFeatureViewModel",null),p([_({type:St})],Ut.prototype,"spatialReference",null),p([_({readOnly:!0})],Ut.prototype,"state",null),p([_()],Ut.prototype,"timeZone",null),p([_()],Ut.prototype,"title",void 0),p([_()],Ut.prototype,"updateLocationEnabled",void 0),p([_()],Ut.prototype,"view",void 0),p([_()],Ut.prototype,"visible",void 0),p([_({readOnly:!0})],Ut.prototype,"waitingForContents",null),p([_({readOnly:!0})],Ut.prototype,"waitingForResult",null),p([_()],Ut.prototype,"zoomFactor",void 0),p([_()],Ut.prototype,"zoomToLocation",void 0),p([_()],Ut.prototype,"centerAtLocation",null),Ut=p([Q("esri.widgets.Features.FeaturesViewModel")],Ut);const eR=Ut;let Su=class extends Ye{constructor(){super(...arguments),this.actionBar=!0,this.closeButton=!0,this.collapseButton=!1,this.featureMenuHeading=!0,this.featureNavigation=!0,this.featureListLayerTitle=!0,this.flow=!0,this.heading=!0,this.spinner=!0}};p([_({type:Boolean,nonNullable:!0})],Su.prototype,"actionBar",void 0),p([_({type:Boolean,nonNullable:!0})],Su.prototype,"closeButton",void 0),p([_({type:Boolean,nonNullable:!0})],Su.prototype,"collapseButton",void 0),p([_({type:Boolean,nonNullable:!0})],Su.prototype,"featureMenuHeading",void 0),p([_({type:Boolean,nonNullable:!0})],Su.prototype,"featureNavigation",void 0),p([_({type:Boolean,nonNullable:!0})],Su.prototype,"featureListLayerTitle",void 0),p([_({type:Boolean,nonNullable:!0})],Su.prototype,"flow",void 0),p([_({type:Boolean,nonNullable:!0})],Su.prototype,"heading",void 0),p([_({type:Boolean,nonNullable:!0})],Su.prototype,"spinner",void 0),Su=p([Q("esri.widgets.Features.FeaturesVisibleElements")],Su);const x0e=Su,Qse="selected-index",MQe=0,Jse="features-spinner";function Kse(t){return(t==null?void 0:t.declaredClass.startsWith("esri.layers."))??!1}let rs=class extends X_e(Er){constructor(e,s){super(e,s),this._featureMenuIntersectionObserverCallback=([i])=>{i!=null&&i.isIntersecting&&this.viewModel.featurePage!=null&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document}),this._featureMenuIntersectionObserverNode=null,this._spinner=null,this._feature=null,this._focusAbortController=null,this._drillInFlowItems=new Ge,this._drillInWidget=new JWe({flowItems:this._drillInFlowItems}),this._rootNode=null,this._rootFlowItemNode=null,this._featureMenuViewportNode=null,this._actionBarMenuNode=null,this.collapsed=!1,this.featureNavigationTop=!1,this.headerActions=new T_,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.responsiveActionsEnabled=!1,this.viewModel=new eR,this.visibleElements=new x0e,this._renderAction=(i,r)=>{const n=this._getActionTitle(i),{type:o,active:a,uid:l,disabled:u,indicator:c}=i;return i.visible?K("calcite-action",{active:o==="toggle"&&i.value,appearance:"solid",bind:this,"data-action-id":i.id,"data-action-uid":l,disabled:u,icon:this._getActionIcon(i),indicator:c,key:`action-${r}`,loading:a,onclick:this._triggerAction,scale:"s",text:n,textEnabled:!this._hideActionText,title:this._hideActionText?n:void 0},this._getFallbackIcon(i)):null},this._openFeatureMenu=()=>{this.featureMenuOpen=!0,this._focusFlowItemNode()},this._closeFeatureMenu=()=>{this.featureMenuOpen=!1,this._focusFlowItemNode()},this._previousFeature=()=>{this.viewModel.previous()},this._nextFeature=()=>{this.viewModel.next()},this._handleFeatureBack=()=>{this.initialDisplayMode==="list"?(this.selectedFeatureIndex=-1,this._focusFlowItemNode()):this._openFeatureMenu()},this._handleFeatureMenuBack=()=>{this.initialDisplayMode==="list"?(this.selectedFeatureIndex=-1,this._focusFlowItemNode()):this.featureMenuOpen&&this._closeFeatureMenu()},this._storeRootNode=i=>{this._rootNode=i},this._displaySpinnerThrottled=XE(()=>this._displaySpinner(),MQe),this._addSelectedFeatureIndexHandle(),this.addHandles([this._displaySpinnerThrottled,Ee(()=>{var i;return(i=this.viewModel)==null?void 0:i.active},()=>this._toggleScreenLocationEnabled()),Ee(()=>{var i;return(i=this.viewModel)==null?void 0:i.active},i=>this._drillInWidget.closed=!i),Ee(()=>{var i;return(i=this.visibleElements)==null?void 0:i.closeButton},i=>this._drillInWidget.closable=i),Ee(()=>{var i;return(i=this.visibleElements)==null?void 0:i.spinner},i=>this._spinnerEnabledChange(i)),Ee(()=>{var i;return(i=this.viewModel)==null?void 0:i.view},(i,r)=>this._viewChange(i,r)),Ee(()=>{var i,r;return(r=(i=this.viewModel)==null?void 0:i.view)==null?void 0:r.ready},(i,r)=>this._viewReadyChange(i??!1,r??!1)),Ee(()=>{var i,r;return[(i=this.viewModel)==null?void 0:i.waitingForResult,(r=this.viewModel)==null?void 0:r.location]},()=>{this._hideSpinner(),this._displaySpinnerThrottled()}),Ee(()=>{var i;return(i=this.viewModel)==null?void 0:i.screenLocation},()=>this._closeOpenActionMenu()),Ee(()=>this.selectedFeatureWidget,()=>this._destroyDrillInFlowItemWidgets()),Ee(()=>{var r;const i=(r=this.selectedFeatureWidget)==null?void 0:r.viewModel;return[i==null?void 0:i.title,i==null?void 0:i.state]},()=>this._setTitleFromFeatureWidget()),Ee(()=>{var r;const i=(r=this.selectedFeatureWidget)==null?void 0:r.viewModel;return[i==null?void 0:i.content,i==null?void 0:i.state]},()=>this._setContentFromFeatureWidget()),Ee(()=>{var i;return(i=this.viewModel)==null?void 0:i.featureViewModels},()=>this._featureMenuViewportScrollTop()),Ee(()=>this._drillInFlowItems.length,()=>this._focusFlowItemNode()),this._drillInWidget.on("close",()=>this.close()),this._drillInWidget.on("exit",()=>this._destroyDrillInFlowItemWidgets()),this._drillInWidget.on("open-feature",({feature:i})=>this._openRelatedFeature(i)),this._drillInWidget.on("zoom-to-feature",({featureWidget:i})=>b0e(this.viewModel,i))])}loadDependencies(){return sl({action:()=>me(()=>import("./index-9hW8Ud6V.js"),__vite__mapDeps([253,240,241,242,243,244,245,254,246,249,251])),"action-bar":()=>me(()=>import("./index-CPMOc5ra.js"),__vite__mapDeps([311,240,241,242,243,244,245,253,254,246,249,251,255,256,257,258,247,259,260,261,262,263,252])),"action-group":()=>me(()=>import("./index-mCYGoQ2c.js").then(e=>e.i),__vite__mapDeps([252,240,241,242,243,244,245,253,254,246,249,251,255,256,257,258,247,259,260,261,262,263])),button:()=>me(()=>import("./index-CmPXJs7R.js"),__vite__mapDeps([239,240,241,242,243,244,245,246,247,248,249,250,251])),icon:()=>me(()=>import("./index-BhFhNIYS.js").then(e=>e.i),__vite__mapDeps([243,244,241,245])),flow:()=>me(()=>import("./index-5r6cdDcQ.js"),__vite__mapDeps([280,246,245,251,244,241])),"flow-item":()=>me(()=>import("./index-BcyHfZZl.js"),__vite__mapDeps([281,240,241,242,243,244,245,253,254,246,249,251,255,256,257,258,247,259,260,261,262,263,273,282])),list:()=>me(()=>import("./index-kzOfcToX.js"),__vite__mapDeps([272,240,241,242,273,246,245,244,254,243,274,275,276,247,248,249,261,250,251,257,270])),"list-item":()=>me(()=>import("./index-B_oefgqS.js"),__vite__mapDeps([264,243,244,241,245,265,246,256,257,249,261,251,258,266,240,242,253,254,267,268,269,270,271])),"list-item-group":()=>me(()=>import("./index-DQnEbd7J.js"),__vite__mapDeps([315,249,271])),loader:()=>me(()=>import("./index-B0fAt0SM.js"),__vite__mapDeps([240,241,242]))})}destroy(){var e,s,i;this._destroyDrillInFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),this._unobserveFeatureMenuObserver(),(e=this._featureMenuIntersectionObserver)==null||e.disconnect(),(s=this._drillInWidget)==null||s.destroy(),(i=this._focusAbortController)==null||i.abort()}get _hideActionText(){var s;if(!this.responsiveActionsEnabled)return!1;const e=(s=this.view)==null?void 0:s.widthBreakpoint;return e==="xsmall"||e==="small"||e==="medium"}get _featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&!!this.viewModel.selectedFeature&&this.visibleElements.featureNavigation}get _isCollapsed(){return this._collapseEnabled&&this.collapsed}get _collapseEnabled(){return this.visibleElements.collapseButton&&(this.initialDisplayMode==="list"||!!this.title&&!!this.content)}get active(){return this.viewModel.active}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get icon(){return null}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(e){this.viewModel.featureMenuOpen=e}get featureMenuTitle(){return this.viewModel.featureMenuTitle}set featureMenuTitle(e){this.viewModel.featureMenuTitle=e}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get initialDisplayMode(){return this.viewModel.initialDisplayMode}set initialDisplayMode(e){this.viewModel.initialDisplayMode=e}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedDrillInFeature(){const e=Array.from(this._drillInFlowItems).at(-1);if(!e)return null;const{flowType:s}=e;return s==="feature-association"||s==="feature-relationship"?e.graphic??null:null}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(e){this.viewModel.selectedFeatureIndex=e}get selectedFeatureWidget(){const{_feature:e,headingLevel:s,_drillInFlowItems:i,timeZone:r,spatialReference:n,map:o}=this,{selectedFeatureViewModel:a}=this.viewModel,l={title:!1};return a?(e?(e.viewModel=a,e.visibleElements=l):this._feature=new W_e({flowItems:i,headingLevel:s+1,timeZone:r,spatialReference:n,map:o,viewModel:a,visibleElements:l}),this._feature):null}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}get timeZone(){return this.viewModel.timeZone}set timeZone(e){this.viewModel.timeZone=e}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(e){this.viewModel.updateLocationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}blur(){var s;const{active:e}=this.viewModel;e?(s=this._rootFlowItemNode)==null||s.blur():Ne.getLogger(this).warn("Features can only be blurred when currently active.")}clear(){return this.viewModel.clear()}close(){this.viewModel.visible=!1}fetchFeatures(e,s){return this.viewModel.fetchFeatures(e,s)}focus(){const{active:e}=this.viewModel;e?this._focusFlowItemNode():Ne.getLogger(this).warn("Features can only be focused when currently active.")}next(){return this.viewModel.next()}open(e){this.removeHandles(Qse);const s={collapsed:(e==null?void 0:e.collapsed)??!1};this.set(s),this.viewModel.open(e),this.addHandles(Or(()=>!this.viewModel.waitingForResult,()=>this._addSelectedFeatureIndexHandle(),{once:!0}))}previous(){return this.viewModel.previous()}triggerAction(e){return this.viewModel.triggerAction(e)}render(){return K("div",{afterCreate:this._storeRootNode,bind:this,class:this.classes(Rr.base,vt.widget,vt.panel),onkeydown:this._onMainKeydown},this._renderHeader(),this._renderContentContainer())}_renderFeatureNavigation(){return[this._renderPagination(),this.initialDisplayMode==="list"?this._renderFeaturePaginationText():this._renderFeatureMenuButton()]}_renderHeader(){return this.featureNavigationTop&&this._featureNavigationVisible?K("div",{class:Rr.header,key:"header-actions"},this._renderFeatureNavigation()):null}_renderFooter(){return!this.featureNavigationTop&&this._featureNavigationVisible?K("div",{class:Rr.footer,key:"footer-actions",slot:"footer"},this._renderFeatureNavigation()):null}_renderFeaturePaginationText(){const{messages:e,viewModel:s}=this,{featureCount:i,selectedFeatureIndex:r}=s;return K("div",{class:Rr.paginationText,key:"feature-pagination-text"},Nu(e.pageText,{index:Un(r+1),total:Un(i)}))}_renderFeatureMenuButton(){const{messages:e,viewModel:s}=this,{featureCount:i,selectedFeatureIndex:r,pendingPromisesCount:n}=s;return K("calcite-action",{appearance:"solid",bind:this,class:Rr.paginationMenuButton,icon:"list",key:"feature-menu-button",label:e.selectFeature,loading:n>0,onclick:this._openFeatureMenu,scale:"s",text:Nu(e.pageText,{index:Un(r+1),total:Un(i)}),textEnabled:!0,title:e.selectFeature})}_renderPagination(){const{previous:e,next:s}=this.messagesCommon.pagination;return K("calcite-action-bar",{class:Rr.paginationActionBar,expandDisabled:!0,key:"pagination-action-bar",layout:"horizontal",overflowActionsDisabled:!0,scale:"s"},K("calcite-action-group",{scale:"s"},K("calcite-action",{appearance:"solid",class:Rr.paginationPrevious,icon:"chevron-left",iconFlipRtl:!0,label:e,onclick:this._previousFeature,scale:"s",text:e,title:e}),K("calcite-action",{appearance:"solid",icon:"chevron-right",iconFlipRtl:!0,label:s,onclick:this._nextFeature,scale:"s",text:s,title:s})))}_renderFeatureMenuItem(e){const{initialDisplayMode:s}=this,{selectedFeatureViewModel:i,featureViewModels:r}=this.viewModel,n=e===i,o=r.indexOf(e);return K("calcite-list-item",{bind:this,"data-feature-index":o,key:`feature-menu-item-${e.uid}`,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onmouseleave:this._removeActiveFeature,onmouseover:this._setActiveFeature,selected:n,onCalciteListItemSelect:this._selectFeature},K("span",{innerHTML:e.title||this.messagesCommon.untitled,slot:"content"}),s==="list"?K("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"}):null)}_groupResultsByLayer(){const{featureViewModels:e}=this.viewModel,s=new Map;return e.forEach(i=>{const r=i==null?void 0:i.graphic;if(!r)return;const{layer:n,sourceLayer:o}=r,a=(Kse(n)?n:null)||(Kse(o)?o:null),l=s.get(a)??[];s.set(a,[...l,i])}),s}_renderFeatureMenu(){const{messages:e,viewModel:s}=this,i=this._groupResultsByLayer(),r=this.initialDisplayMode==="list"?"none":"single";return s.featureViewModels.length?K("calcite-list",{displayMode:"flat",label:e==null?void 0:e.featuresList,selectionAppearance:"icon",selectionMode:r},Array.from(i.keys(),n=>{var l;const o=(l=i.get(n))==null?void 0:l.map(u=>this._renderFeatureMenuItem(u)),a=n?n.title??this.messagesCommon.untitled:null;return this.visibleElements.featureListLayerTitle&&a!==null?K("calcite-list-item-group",{heading:a,key:(n==null?void 0:n.uid)||"map-graphics"},o):o})):null}_renderHeaderAction(e,s){const i=e.title||"";return e.visible?K("calcite-action",{active:e.type==="toggle"&&e.value,appearance:"solid",bind:this,"data-action-id":e.id,"data-action-uid":e.uid,disabled:e.disabled,icon:e.icon??void 0,indicator:e.indicator,key:`header-action-${s}`,loading:e.active,onclick:this._triggerHeaderAction,slot:"header-actions-end",text:i,title:i}):null}_renderHeaderActions(){return this.headerActions.map((e,s)=>this._renderHeaderAction(e,s)).toArray()}_renderContentFeature(){const{headingLevel:e,visibleElements:s,_isCollapsed:i,_collapseEnabled:r,featureNavigationTop:n,_drillInFlowItems:o,initialDisplayMode:a,selectedFeature:l,featureMenuOpen:u}=this,{title:c,active:h}=this.viewModel,m=s.heading&&c?c:"";if(a==="list"&&!l)return null;const f=o.length===0&&(a==="list"?!!l:!u);return K("calcite-flow-item",{afterCreate:this._storeRootFlowItemNode,bind:this,class:this.classes({[Rr.contentFeature]:!0,[Rr.flowItemCollapsed]:i}),closable:s.closeButton,closed:!h,collapsed:i,collapseDirection:n?"down":"up",collapsible:r,headingLevel:e,key:"root-flow-item",selected:f,onCalciteFlowItemBack:this._handleFeatureBack,onCalciteFlowItemClose:this.close,onCalciteFlowItemToggle:this._handleCollapseToggle},m?K(JU,{class:this.classes(Rr.featuresHeading,vt.heading),innerHTML:m,key:"header-content",level:this.headingLevel,slot:"header-content"}):null,this._renderHeaderActions(),this._renderActionBar(),K("div",{class:this.classes(Rr.container,Rr.contentContainer)},this._renderContent()),this._renderFooter())}_renderFeatureMenuContainer(){const{viewModel:e,visibleElements:s,featureMenuTitle:i,messages:r,messagesCommon:n,_drillInFlowItems:o,initialDisplayMode:a,featureMenuOpen:l,selectedFeature:u,_collapseEnabled:c,_isCollapsed:h,featureNavigationTop:m,headingLevel:f}=this,{active:g,featureViewModels:v,pendingPromisesCount:b}=e,{featureMenuHeading:w}=s,S=i??r.selectFeature;if(a==="feature"&&!l)return null;const T=o.length===0&&(a==="list"?!u:l);return K("calcite-flow-item",{afterCreate:this._storeFeatureMenuFlowItemNode,bind:this,class:this.classes({[Rr.flowItemCollapsed]:h}),closable:a==="list"&&s.closeButton,closed:!g,collapsed:a==="list"&&h,collapseDirection:m?"down":"up",collapsible:a==="list"&&c,description:w?Nu(r.total,{total:v.length}):void 0,heading:w?S:void 0,headingLevel:f,key:"feature-menu",loading:e.waitingForContents,selected:T,onCalciteFlowItemBack:P=>{P.preventDefault(),this._handleFeatureMenuBack()},onCalciteFlowItemClose:this.close,onCalciteFlowItemToggle:this._handleCollapseToggle},a==="list"?this._renderHeaderActions():null,b>0?K("calcite-loader",{class:Rr.loader,inline:!0,key:"feature-menu-loader",label:n.loading,slot:"header-actions-end"}):null,K("div",{class:Rr.container},this._renderFeatureMenu()),K("div",{afterCreate:this._featureMenuIntersectionObserverCreated,bind:this,class:Rr.featureMenuObserver}),a==="feature"?K("calcite-button",{appearance:"transparent",onclick:this._handleFeatureMenuBack,slot:"footer-actions",width:"full"},n.back):null)}_renderContentContainer(){const e=this.initialDisplayMode==="list"?[this._renderFeatureMenuContainer(),this._renderContentFeature(),this._drillInWidget.render()]:[this._renderContentFeature(),this._renderFeatureMenuContainer(),this._drillInWidget.render()];return this.visibleElements.flow?K("calcite-flow",{key:"content-container"},e):e}_getFallbackIcon(e){const{className:s,icon:i}=e;if(i)return null;const r=tze({action:e,feature:this.selectedFeature}),n={[Rr.icon]:!!s,[Rr.actionImage]:!!r};return s&&(n[s]=!0),r||s?K("span",{"aria-hidden":"true",class:this.classes(Rr.icon,n),key:"icon",styles:Dfe(r)}):null}_renderActionBar(){var e;return!this._isCollapsed&&this.visibleElements.actionBar&&((e=this.viewModel.allActions)!=null&&e.length)?K("calcite-action-bar",{expandDisabled:!0,expanded:!this._hideActionText,key:"header-action-bar",scale:"s",slot:"action-bar"},K("calcite-action-group",{afterCreate:s=>this._actionBarMenuNode=s,overlayPositioning:"fixed",scale:"s"},this._renderActions())):null}_renderActions(){return this.viewModel.allActions.toArray().map(this._renderAction)}_renderContent(){var s;const e=(s=this.viewModel)==null?void 0:s.content;return e?typeof e=="string"?K("div",{class:nr.contentNode,innerHTML:e,key:e}):this.renderNodeContent(e):null}_handleCollapseToggle(){this.collapsed=!this.collapsed}async _openRelatedFeature(e){await e.viewModel.updateGeometry();const s=e.graphic,i=s==null?void 0:s.geometry;if(i==null||s==null)return;this._destroyDrillInFlowItemWidgets(),await this.viewModel.zoomTo({target:i});const r=t8(i);this.open({features:[s],location:r??void 0}),this._focusFlowItemNode()}async _focusFlowItemNode(){var i,r;(i=this._focusAbortController)==null||i.abort(),this._focusAbortController=new AbortController;const e=this._focusAbortController.signal;await zl(bz(e));const s=(r=this._rootNode)==null?void 0:r.querySelector("calcite-flow-item[selected]");tb(s)}_storeRootFlowItemNode(e){this._rootFlowItemNode=e}_storeFeatureMenuFlowItemNode(e){this._featureMenuViewportNode=e}_setActiveFeature(e){var r;const{viewModel:s}=this,i=e.currentTarget["data-feature-index"];s.activeFeature=((r=s.features)==null?void 0:r[i])||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_selectFeature(e){const s=e.currentTarget["data-feature-index"];isNaN(s)||(this.viewModel.selectedFeatureIndex=s),this.initialDisplayMode==="feature"?this._handleFeatureMenuBack():this._focusFlowItemNode()}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}_getActionIcon(e){return e.icon?e.icon:e.image||e.className?void 0:"question"}_getActionTitle(e){const{messages:s,selectedFeature:i,messagesCommon:r}=this,{id:n}=e,o=i==null?void 0:i.attributes,a=e.title??"",l=n==="zoom-to-feature"?Nu(a,{messages:s}):n==="remove-selected-feature"?Nu(a,{messages:r}):n==="zoom-to-clustered-features"||n==="browse-clustered-features"?Nu(a,{messages:s}):e.title;return l&&o?Nu(l,o):l??""}_onMainKeydown(e){const{key:s}=e;s==="ArrowLeft"&&(e.stopPropagation(),this._handleFeatureMenuBack(),this.previous()),s==="ArrowRight"&&(e.stopPropagation(),this._handleFeatureMenuBack(),this.next())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&this._featureMenuViewportNode.scrollContentTo({top:0})}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_setTitleFromFeatureWidget(){const{selectedFeatureWidget:e,messagesCommon:s}=this,i=e==null?void 0:e.viewModel;e&&(this.viewModel.title=(i==null?void 0:i.state)==="error"?s==null?void 0:s.errorMessage:(i==null?void 0:i.title)||"")}_addSelectedFeatureIndexHandle(){const e=Ee(()=>{var s;return(s=this.viewModel)==null?void 0:s.selectedFeatureIndex},(s,i)=>this._selectedFeatureIndexUpdated(s,i));this.addHandles(e,Qse)}_selectedFeatureIndexUpdated(e,s){const{featureCount:i}=this.viewModel;i&&e!==s&&e!==-1&&(this._destroyDrillInFlowItemWidgets(),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_triggerHeaderAction(e){const s=e.currentTarget;if(s.disabled)return;const i=s.dataset.actionUid,r=this.headerActions.find(({uid:n})=>n===i);r&&!r.disabled&&((r==null?void 0:r.type)==="toggle"&&(r.value=!r.value),this.emit("trigger-header-action",{action:r}))}_triggerAction(e){const s=e.currentTarget;if(s.disabled)return;const i=s.dataset.actionUid,{allActions:r}=this.viewModel,n=r.findIndex(a=>a.uid===i),o=r.at(n);o&&o.type==="toggle"&&(o.value=!o.value),this.viewModel.triggerAction(n)}_createSpinner(e){e&&(this._spinner=new QWe({view:e}),e.ui.add(this._spinner,{key:Jse,position:"manual",internal:!0}))}_wireUpView(e){var s;this._destroySpinner(),e&&((s=this.visibleElements)!=null&&s.spinner)&&this._createSpinner(e)}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide())}_viewReadyChange(e,s){var i;e?this._wireUpView((i=this.viewModel)==null?void 0:i.view):s&&this.viewModel.clear()}_viewChange(e,s){e&&s&&this.viewModel.clear()}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,!e.destroyed&&e.destroy()),this._feature=null}_closeOpenActionMenu(){const{_actionBarMenuNode:e}=this;e&&(e.menuOpen=!1)}_destroyDrillInFlowItemWidgets(){this._drillInFlowItems.drain(e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),"activeCategory"in e.viewModel&&(e.viewModel.activeCategory=null),e.viewModel=null,e.destroy()})}_toggleScreenLocationEnabled(){const{viewModel:e}=this;e&&(e.screenLocationEnabled=e.active)}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:s,waitingForResult:i}=this.viewModel;i&&s?e.show({location:s}):e.hide()}_destroySpinner(){var s,i;const{_spinner:e}=this;e&&((i=(s=e.view)==null?void 0:s.ui)==null||i.remove(e,Jse),e.destroy(),this._spinner=null)}_spinnerEnabledChange(e){var s;this._destroySpinner(),e&&this._createSpinner((s=this.viewModel)==null?void 0:s.view)}};p([_()],rs.prototype,"_drillInFlowItems",void 0),p([_()],rs.prototype,"_hideActionText",null),p([_()],rs.prototype,"_featureNavigationVisible",null),p([_()],rs.prototype,"_isCollapsed",null),p([_()],rs.prototype,"_collapseEnabled",null),p([_({readOnly:!0})],rs.prototype,"active",null),p([_()],rs.prototype,"collapsed",void 0),p([_()],rs.prototype,"content",null),p([_()],rs.prototype,"icon",null),p([_()],rs.prototype,"featureMenuOpen",null),p([_()],rs.prototype,"featureMenuTitle",null),p([_()],rs.prototype,"featureNavigationTop",void 0),p([_()],rs.prototype,"features",null),p([_()],rs.prototype,"goToOverride",null),p([_({type:T_})],rs.prototype,"headerActions",void 0),p([_()],rs.prototype,"headingLevel",void 0),p([_()],rs.prototype,"initialDisplayMode",null),p([_()],rs.prototype,"location",null),p([_()],rs.prototype,"label",null),p([_()],rs.prototype,"map",null),p([_(),ur("esri/widgets/Features/t9n/Features")],rs.prototype,"messages",void 0),p([_(),ur("esri/t9n/common")],rs.prototype,"messagesCommon",void 0),p([_()],rs.prototype,"promises",null),p([_()],rs.prototype,"responsiveActionsEnabled",void 0),p([_({readOnly:!0})],rs.prototype,"selectedFeature",null),p([_({readOnly:!0})],rs.prototype,"selectedDrillInFeature",null),p([_()],rs.prototype,"selectedFeatureIndex",null),p([_({readOnly:!0})],rs.prototype,"selectedFeatureWidget",null),p([_()],rs.prototype,"spatialReference",null),p([_()],rs.prototype,"title",null),p([_()],rs.prototype,"timeZone",null),p([_()],rs.prototype,"updateLocationEnabled",null),p([_()],rs.prototype,"view",null),p([_({type:eR}),fU(["triggerAction","trigger-action"])],rs.prototype,"viewModel",void 0),p([_({type:x0e,nonNullable:!0})],rs.prototype,"visibleElements",void 0),p([_()],rs.prototype,"visible",null),rs=p([Q("esri.widgets.Features")],rs);const AQe=rs,Ml="esri-popup",ty=`${Ml}--is-docked`,Dr={base:Ml,baseHidden:`${Ml}--hidden`,main:`${Ml}__main-container`,shadow:`${Ml}--shadow`,isDocked:ty,isDockedTopLeft:`${ty}-top-left`,isDockedTopCenter:`${ty}-top-center`,isDockedTopRight:`${ty}-top-right`,isDockedBottomLeft:`${ty}-bottom-left`,isDockedBottomCenter:`${ty}-bottom-center`,isDockedBottomRight:`${ty}-bottom-right`,alignTopCenter:`${Ml}--aligned-top-center`,alignBottomCenter:`${Ml}--aligned-bottom-center`,alignTopLeft:`${Ml}--aligned-top-left`,alignBottomLeft:`${Ml}--aligned-bottom-left`,alignTopRight:`${Ml}--aligned-top-right`,alignBottomRight:`${Ml}--aligned-bottom-right`,pointer:`${Ml}__pointer`,pointerDirection:`${Ml}__pointer-direction`};let N8=class extends eR{constructor(e){super(e)}};N8=p([Q("esri.widgets.Popup.PopupViewModel")],N8);const w0e=N8;let Sc=class extends Ye{constructor(){super(...arguments),this.actionBar=!0,this.closeButton=!0,this.collapseButton=!0,this.featureMenuHeading=!0,this.featureNavigation=!0,this.featureListLayerTitle=!0,this.heading=!0,this.spinner=!0}};p([_({type:Boolean,nonNullable:!0})],Sc.prototype,"actionBar",void 0),p([_({type:Boolean,nonNullable:!0})],Sc.prototype,"closeButton",void 0),p([_({type:Boolean,nonNullable:!0})],Sc.prototype,"collapseButton",void 0),p([_({type:Boolean,nonNullable:!0})],Sc.prototype,"featureMenuHeading",void 0),p([_({type:Boolean,nonNullable:!0})],Sc.prototype,"featureNavigation",void 0),p([_({type:Boolean,nonNullable:!0})],Sc.prototype,"featureListLayerTitle",void 0),p([_({type:Boolean,nonNullable:!0})],Sc.prototype,"heading",void 0),p([_({type:Boolean,nonNullable:!0})],Sc.prototype,"spinner",void 0),Sc=p([Q("esri.widgets.Popup.PopupVisibleElements")],Sc);const S0e=Sc,NQe=200,eie={buttonEnabled:!0,position:"auto",breakpoint:{width:544}};let cs=class extends Er{constructor(e,s){super(e,s),this._dockAction=new _0({id:"popup-dock-action"}),this._featuresWidget=new AQe({responsiveActionsEnabled:!0}),this._containerNode=null,this._mainContainerNode=null,this._pointerOffsetInPx=16,this._focusAbortController=null,this.alignment="auto",this.dockEnabled=!1,this.headingLevel=2,this.messages=null,this.viewModel=new w0e,this.visibleElements=new S0e}initialize(){this.addHandles([Ee(()=>{var e,s;return[(s=(e=this.viewModel)==null?void 0:e.view)==null?void 0:s.widthBreakpoint,this.dockEnabled]},()=>this._handleDockIcon(),ht),Ee(()=>{var e,s;return[this.dockEnabled,(e=this.messages)==null?void 0:e.undock,(s=this.messages)==null?void 0:s.dock]},()=>this._handleDockEnabled(),ht),Ee(()=>this.dockOptions,e=>{const{_dockAction:s}=this,i=this._featuresWidget.headerActions;i.remove(s),e.buttonEnabled&&i.add(s)},ht),Ee(()=>{var e;return(e=this.viewModel)==null?void 0:e.screenLocation},()=>this._positionContainer()),Ee(()=>{var e;return[(e=this.viewModel)==null?void 0:e.active,this.dockEnabled]},()=>this._toggleScreenLocationEnabled()),Ee(()=>{var e,s,i,r,n,o,a;return[(e=this.viewModel)==null?void 0:e.screenLocation,(i=(s=this.viewModel)==null?void 0:s.view)==null?void 0:i.padding,(n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.size,(o=this.viewModel)==null?void 0:o.active,(a=this.viewModel)==null?void 0:a.location,this.alignment]},()=>this.reposition()),Ee(()=>{var e,s;return(s=(e=this.viewModel)==null?void 0:e.view)==null?void 0:s.size},(e,s)=>this._updateDockEnabledForViewSize(e,s)),Ee(()=>{var e;return(e=this.viewModel)==null?void 0:e.view},(e,s)=>this._viewChange(e,s)),Ee(()=>{var e,s;return(s=(e=this.viewModel)==null?void 0:e.view)==null?void 0:s.ready},(e,s)=>this._viewReadyChange(e??!1,s??!1)),Ee(()=>this.viewModel,()=>this._featuresWidget.viewModel=this.viewModel,ht),Ee(()=>this._featureNavigationTop,e=>this._featuresWidget.featureNavigationTop=e,ht),Ee(()=>this.headingLevel,e=>this._featuresWidget.headingLevel=e,ht),Ee(()=>this.visibleElements.actionBar,e=>this._featuresWidget.visibleElements.actionBar=!!e,ht),Ee(()=>this.visibleElements.closeButton,e=>this._featuresWidget.visibleElements.closeButton=!!e,ht),Ee(()=>this.visibleElements.collapseButton,e=>this._featuresWidget.visibleElements.collapseButton=!!e,ht),Ee(()=>this.visibleElements.heading,e=>this._featuresWidget.visibleElements.heading=!!e,ht),Ee(()=>this.visibleElements.spinner,e=>this._featuresWidget.visibleElements.spinner=!!e,ht),Ee(()=>this.visibleElements.featureNavigation,e=>this._featuresWidget.visibleElements.featureNavigation=!!e,ht),Ee(()=>this.visibleElements.featureMenuHeading,e=>this._featuresWidget.visibleElements.featureMenuHeading=!!e,ht),Ee(()=>this.visibleElements.featureListLayerTitle,e=>this._featuresWidget.visibleElements.featureListLayerTitle=!!e,ht),Vo(()=>this._featuresWidget,"trigger-header-action",e=>{e.action===this._dockAction&&(this.dockEnabled=!this.dockEnabled)})])}destroy(){var e;this._dockAction.destroy(),this._featuresWidget&&(this._featuresWidget.viewModel=new eR,this._featuresWidget.destroy()),(e=this._focusAbortController)==null||e.abort()}get _featureNavigationTop(){const{currentAlignment:e,currentDockPosition:s}=this;return e==="bottom-left"||e==="bottom-center"||e==="bottom-right"||s==="top-left"||s==="top-center"||s==="top-right"}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}get active(){return this.viewModel.active}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(e){this.viewModel.autoCloseEnabled=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get collapsed(){return this._featuresWidget.collapsed}set collapsed(e){this._featuresWidget.collapsed=e}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||eie}set dockOptions(e){var l,u;const s={...eie},i=(u=(l=this.viewModel)==null?void 0:l.view)==null?void 0:u.breakpoints,r={};i&&(r.width=i.xsmall,r.height=i.xsmall);const n={...s,...e},o={...s.breakpoint,...r},{breakpoint:a}=n;typeof a=="object"?n.breakpoint={...o,...a}:a&&(n.breakpoint=o),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(e){this.viewModel.featureMenuOpen=e}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get icon(){return"popup"}set icon(e){this._overrideIfSome("icon",e)}get initialDisplayMode(){return this.viewModel.initialDisplayMode}set initialDisplayMode(e){this.viewModel.initialDisplayMode=e}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedDrillInFeature(){return this._featuresWidget.selectedDrillInFeature??null}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(e){this.viewModel.selectedFeatureIndex=e}get selectedFeatureWidget(){return this._featuresWidget.selectedFeatureWidget}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(e){this.viewModel.updateLocationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}blur(){const{active:e}=this.viewModel;e||Ne.getLogger(this).warn("Popup can only be blurred when currently active."),this._featuresWidget.blur()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(e,s){return this.viewModel.fetchFeatures(e,s)}focus(){const{active:e}=this.viewModel;e||Ne.getLogger(this).warn("Popup can only be focused when currently active."),this._handleFocus()}next(){return this.viewModel.next()}open(e){const s=!!e&&!!e.featureMenuOpen,i={collapsed:!!e&&!!e.collapsed,featureMenuOpen:s};this.set(i),this.viewModel.open(e),e!=null&&e.shouldFocus&&this._handleFocus(!0)}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(e){return this.viewModel.triggerAction(e)}render(){var h,m,f,g;const{dockEnabled:e,currentAlignment:s,currentDockPosition:i}=this,{active:r,screenLocation:n}=this.viewModel,o=r&&e,a=r&&!e,l=(m=(h=this.selectedFeature)==null?void 0:h.layer)==null?void 0:m.title,u=(g=(f=this.selectedFeature)==null?void 0:f.layer)==null?void 0:g.id,c={[Dr.alignTopCenter]:s==="top-center",[Dr.alignBottomCenter]:s==="bottom-center",[Dr.alignTopLeft]:s==="top-left",[Dr.alignBottomLeft]:s==="bottom-left",[Dr.alignTopRight]:s==="top-right",[Dr.alignBottomRight]:s==="bottom-right",[Dr.isDocked]:o,[Dr.shadow]:a,[Dr.isDockedTopLeft]:i==="top-left",[Dr.isDockedTopCenter]:i==="top-center",[Dr.isDockedTopRight]:i==="top-right",[Dr.isDockedBottomLeft]:i==="bottom-left",[Dr.isDockedBottomCenter]:i==="bottom-center",[Dr.isDockedBottomRight]:i==="bottom-right"};return K("div",{afterCreate:this._positionContainer,afterUpdate:this._positionContainer,"aria-hidden":(!r).toString(),"aria-label":F_(this.title??""),"aria-modal":"false",bind:this,class:this.classes(Dr.base,c,{[Dr.baseHidden]:!n&&!e}),"data-layer-id":u,"data-layer-title":l,role:"dialog"},r?[this._renderMainContainer(),this._renderPointer()]:null)}_renderPointer(){return this.dockEnabled?null:K("div",{class:Dr.pointer,key:"popup-pointer",role:"presentation"},K("div",{class:this.classes(Dr.pointerDirection,Dr.shadow)}))}_renderMainContainer(){const{dockEnabled:e}=this,s={[Dr.shadow]:e};return K("div",{afterCreate:this._setMainContainerNode,afterUpdate:this._setMainContainerNode,bind:this,class:this.classes(Dr.main,vt.widget,s)},this._featuresWidget.render())}_getAnimationDurationMS(){const{_containerNode:e}=this;return e?1e3*parseFloat(window.getComputedStyle(e).animationDuration):NQe}async _handleFocus(e=!1){var i;(i=this._focusAbortController)==null||i.abort(),this._focusAbortController=new AbortController;const s=this._focusAbortController.signal;e&&await zC(()=>{var r;return((r=this.viewModel)==null?void 0:r.active)===!0},{signal:s}),await zl(bz(s)),await zl(FC(this._getAnimationDurationMS(),s)),this._featuresWidget.focus()}_isOutsideView(e){const{popupHeight:s,popupWidth:i,screenLocation:r,side:n,view:o}=e;if(isNaN(i)||isNaN(s)||!o||!r)return!1;const a=o.padding;return n==="right"&&r.x+i/2>o.width-a.right||n==="left"&&r.x-i/2<a.left||n==="top"&&r.y-s<a.top||n==="bottom"&&r.y+s>o.height-a.bottom}_calculateAutoAlignment(e){if(e!=="auto")return e;const{_pointerOffsetInPx:s,_containerNode:i,_mainContainerNode:r,viewModel:n}=this,{screenLocation:o,view:a}=n;if(o==null||!a||!i)return"top-center";function l(P){return parseInt(P.replaceAll(/[^-\d.]/g,""),10)}const u=r?window.getComputedStyle(r,null):null,c=u?l(u.getPropertyValue("max-height")):0,h=u?l(u.getPropertyValue("height")):0,{height:m,width:f}=i.getBoundingClientRect(),g=f+s,v=Math.max(m,c,h)+s,b=this._isOutsideView({popupHeight:v,popupWidth:g,screenLocation:o,side:"right",view:a}),w=this._isOutsideView({popupHeight:v,popupWidth:g,screenLocation:o,side:"left",view:a}),S=this._isOutsideView({popupHeight:v,popupWidth:g,screenLocation:o,side:"top",view:a}),T=this._isOutsideView({popupHeight:v,popupWidth:g,screenLocation:o,side:"bottom",view:a});return w?S?"bottom-right":"top-right":b?S?"bottom-left":"top-left":S?T?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return typeof e=="function"?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:s}=this;return s||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(e){const s=["left","right"];return zh(this.container)&&s.reverse(),e==null?void 0:e.replace(/leading/gi,s[0]).replaceAll(/trailing/gi,s[1])}_callDockPosition(e){return typeof e=="function"?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((e=this.dockOptions)==null?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_calculateAutoDockPosition(e){var a;if(e!=="auto")return e;const s=(a=this.viewModel)==null?void 0:a.view,i=zh(this.container)?"top-left":"top-right";if(!s)return i;const r=s.padding||{left:0,right:0},n=s.width-r.left-r.right,{breakpoints:o}=s;return o&&n<=o.xsmall?"bottom-center":i}_getDockIcon(){const e=this._getDockPosition();if(this.dockEnabled)return"minimize";switch(e){case"top-left":case"bottom-left":return"dock-left";case"top-center":return"maximize";case"bottom-center":return"dock-bottom";default:return"dock-right"}}_handleDockIcon(){this._dockAction.icon=this._getDockIcon()}_handleDockEnabled(){var e,s;this._dockAction.title=this.dockEnabled?(e=this.messages)==null?void 0:e.undock:(s=this.messages)==null?void 0:s.dock}_setMainContainerNode(e){this._mainContainerNode=e}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!this._containerNode)return;const{screenLocation:s}=this.viewModel,{width:i}=this._containerNode.getBoundingClientRect(),r=this._calculatePositionStyle(s,i);r&&Object.assign(this._containerNode.style,r)}_calculateFullWidth(e){const{currentAlignment:s,_pointerOffsetInPx:i}=this;return s==="top-left"||s==="bottom-left"||s==="top-right"||s==="bottom-right"?e+i:e}_calculateAlignmentPosition(e,s,i,r){const{currentAlignment:n,_pointerOffsetInPx:o}=this;if(!i)return;const{padding:a}=i,l=r/2,u=i.height-s,c=i.width-e;return n==="bottom-center"?{top:s+o-a.top,left:e-l-a.left}:n==="top-left"?{bottom:u+o-a.bottom,right:c+o-a.right}:n==="bottom-left"?{top:s+o-a.top,right:c+o-a.right}:n==="top-right"?{bottom:u+o-a.bottom,left:e+o-a.left}:n==="bottom-right"?{top:s+o-a.top,left:e+o-a.left}:n==="top-center"?{bottom:u+o-a.bottom,left:e-l-a.left}:void 0}_calculatePositionStyle(e,s){const{dockEnabled:i,view:r}=this;if(!r)return;if(i)return{left:"",top:"",right:"",bottom:""};if(e==null||!s)return;const n=this._calculateFullWidth(s),o=this._calculateAlignmentPosition(e.x,e.y,r,n);return o?{top:o.top!==void 0?`${o.top}px`:"auto",left:o.left!==void 0?`${o.left}px`:"auto",bottom:o.bottom!==void 0?`${o.bottom}px`:"auto",right:o.right!==void 0?`${o.right}px`:"auto"}:void 0}_viewChange(e,s){e&&s&&(this.close(),this.clear())}_viewReadyChange(e,s){e?this._wireUpView():s&&(this.close(),this.clear())}_wireUpView(){this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(e,s,i){const[r,n]=e,[o,a]=s,{width:l=0,height:u=0}=i??{};return r<=l&&o>l||r>l&&o<=l||n<=u&&a>u||n>u&&a<=u}_updateDockEnabledForViewSize(e,s){var c,h;if(!e||!s)return;const i=((h=(c=this.viewModel)==null?void 0:c.view)==null?void 0:h.padding)||{left:0,right:0,top:0,bottom:0},r=i.left+i.right,n=i.top+i.bottom,o=[],a=[];o[0]=e[0]-r,o[1]=e[1]-n,a[0]=s[0]-r,a[1]=s[1]-n;const{dockOptions:l}=this,u=l.breakpoint;this._dockingThresholdCrossed(o,a,u)&&this._setDockEnabledForViewSize(l),this._setCurrentDockPosition()}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:s}=this;if(!s)return;const i=s.active&&!e;s.screenLocationEnabled=i}_shouldDockAtCurrentViewSize(e){var l,u;const s=e.breakpoint,i=(u=(l=this.viewModel)==null?void 0:l.view)==null?void 0:u.ui;if(!i)return!1;const{width:r,height:n}=i;if(isNaN(r)||isNaN(n)||!s)return!1;const o=s.hasOwnProperty("width")&&r<=(s.width??0),a=s.hasOwnProperty("height")&&n<=(s.height??0);return o||a}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}};p([_({readOnly:!0})],cs.prototype,"_featureNavigationTop",null),p([_()],cs.prototype,"actions",null),p([_({readOnly:!0})],cs.prototype,"active",null),p([_()],cs.prototype,"alignment",void 0),p([_()],cs.prototype,"autoCloseEnabled",null),p([_()],cs.prototype,"defaultPopupTemplateEnabled",null),p([_()],cs.prototype,"content",null),p([_()],cs.prototype,"collapsed",null),p([_({readOnly:!0})],cs.prototype,"currentAlignment",null),p([_({readOnly:!0})],cs.prototype,"currentDockPosition",null),p([_()],cs.prototype,"dockOptions",null),p([_()],cs.prototype,"dockEnabled",void 0),p([_({readOnly:!0})],cs.prototype,"featureCount",null),p([_()],cs.prototype,"featureMenuOpen",null),p([_()],cs.prototype,"features",null),p([_()],cs.prototype,"goToOverride",null),p([_()],cs.prototype,"headingLevel",void 0),p([_()],cs.prototype,"highlightEnabled",null),p([_()],cs.prototype,"icon",null),p([_()],cs.prototype,"initialDisplayMode",null),p([_()],cs.prototype,"location",null),p([_()],cs.prototype,"label",null),p([_(),ur("esri/widgets/Popup/t9n/Popup")],cs.prototype,"messages",void 0),p([_()],cs.prototype,"promises",null),p([_({readOnly:!0})],cs.prototype,"selectedFeature",null),p([_({readOnly:!0})],cs.prototype,"selectedDrillInFeature",null),p([_()],cs.prototype,"selectedFeatureIndex",null),p([_({readOnly:!0})],cs.prototype,"selectedFeatureWidget",null),p([_()],cs.prototype,"title",null),p([_()],cs.prototype,"updateLocationEnabled",null),p([_()],cs.prototype,"view",null),p([_({type:w0e}),fU(["triggerAction","trigger-action"])],cs.prototype,"viewModel",void 0),p([_()],cs.prototype,"visible",null),p([_({type:S0e,nonNullable:!0})],cs.prototype,"visibleElements",void 0),cs=p([Q("esri.widgets.Popup")],cs);const y9=cs,tie=Object.freeze(Object.defineProperty({__proto__:null,default:y9},Symbol.toStringTag,{value:"Module"}));function E0e(t){if(!t)return null;const e=t.wkid;if(e)return f3e[e];const s=t.wkt2??t.wkt;return s?DQe(s):null}function DQe(t){const e=d3e.exec(t);if(!e||e.length!==2)return null;const s=e[1].split(",");if(!s||s.length<3)return null;const i=parseFloat(s[1]),r=parseFloat(s[2]);return isNaN(i)||isNaN(r)?null:{a:i,f:r===0?0:1/r}}function tR(t){const e=E0e(t);if($Qe(e))return e;const s=e.a*(1-e.f);return Object.assign(e,{b:s,eSq:1-(s/e.a)**2,radius:(2*e.a+s)/3,densificationRatio:1e4/((2*e.a+s)/3)})}function $Qe(t){return t!=null&&"b"in t&&"eSq"in t&&"radius"in t}function KI(t,e,s){const{a:i,eSq:r}=tR(s),n=Math.sqrt(r),o=Math.sin(e[1]*za),a=i*e[0]*za;let l;return r>0?l=i*((1-r)*(o/(1-r*(o*o))-1/(2*n)*Math.log((1-n*o)/(1+n*o))))*.5:l=i*o,t[0]=a,t[1]=l,t}function sR(t){return Td(t)&&!!E0e(t)}function rbt(t,e="square-meters"){if(t.some(o=>!sR(o.spatialReference)))throw new ae("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const s=[];for(let o=0;o<t.length;o++){const a=t[o],l=a.spatialReference,{radius:u,densificationRatio:c}=tR(l),h=u*c;s.push(RQe(a,h))}const i=[],r=[0,0],n=[0,0];for(let o=0;o<s.length;o++){const{rings:a,spatialReference:l}=s[o];let u=0;for(let c=0;c<a.length;c++){const h=a[c];KI(r,h[0],l),KI(n,h[h.length-1],l);let m=n[0]*r[1]-r[0]*n[1];for(let f=0;f<h.length-1;f++)KI(r,h[f+1],l),KI(n,h[f],l),m+=n[0]*r[1]-r[0]*n[1];u+=m}u=os(u,"square-meters",e),i.push(u/-2)}return i}function nbt(t,e="meters"){if(!t)throw new ae("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some(i=>!sR(i.spatialReference)))throw new ae("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const s=[];for(let i=0;i<t.length;i++){const r=t[i],{spatialReference:n}=r,o=r.type==="polyline"?r.paths:r.rings;let a=0;for(let l=0;l<o.length;l++){const u=o[l];let c=0;for(let h=1;h<u.length;h++){const m=u[h-1][0],f=u[h][0],g=u[h-1][1],v=u[h][1];if(g!==v||m!==f){const b=new C0e;P0e(b,[m,g],[f,v],n),c+=b.distance}}a+=c}a=os(a,"meters",e),s.push(a)}return s}function RQe(t,e){if(t.type!=="polyline"&&t.type!=="polygon")throw new ae("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:s}=t;if(!sR(s))throw new ae("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const i=t.type==="polyline"?t.paths:t.rings,r=[],n=[0,0],o=new C0e;for(const l of i){const u=[];r.push(u),u.push([l[0][0],l[0][1]]);let c,h,m=l[0][0],f=l[0][1];for(let g=0;g<l.length-1;g++){if(c=l[g+1][0],h=l[g+1][1],m===c&&f===h)continue;const v=[m,f];P0e(o,[m,f],[c,h],s);const{azimuth:b,distance:w}=o,S=w/e;if(S>1){for(let T=1;T<=S-1;T++)iN(n,v,b,T*e,s),u.push(n.slice());iN(n,v,b,(w+Math.floor(S-1)*e)/2,s),u.push(n.slice())}iN(n,v,b,w,s),u.push(n.slice()),m=n[0],f=n[1]}}const a=Qb(St,s);return t.type==="polyline"?new Vl({paths:r,spatialReference:a}):new po({rings:r,spatialReference:a})}let C0e=class{constructor(e=0,s=void 0,i=void 0){this.distance=e,this.azimuth=s,this.reverseAzimuth=i}};function iN(t,e,s,i,r){const n=e[0],o=e[1],a=n*za,l=o*za,u=(s??0)*za,{a:c,b:h,f:m}=tR(r),f=Math.sin(u),g=Math.cos(u),v=(1-m)*Math.tan(l),b=1/Math.sqrt(1+v*v),w=v*b,S=Math.atan2(v,g),T=b*f,P=T*T,I=1-P,A=I*(c*c-h*h)/(h*h),D=1+A/16384*(4096+A*(A*(320-175*A)-768)),k=A/1024*(256+A*(A*(74-47*A)-128));let R,O,z,q=i/(h*D),U=2*Math.PI;for(;Math.abs(q-U)>1e-12;)z=Math.cos(2*S+q),R=Math.sin(q),O=Math.cos(q),U=q,q=i/(h*D)+k*R*(z+k/4*(O*(2*z*z-1)-k/6*z*(4*R*R-3)*(4*z*z-3)));const V=w*R-b*O*g,B=Math.atan2(w*O+b*R*g,(1-m)*Math.sqrt(P+V*V)),H=m/16*I*(4+m*(4-3*I)),W=Math.atan2(R*f,b*O-w*R*g)-(1-H)*m*T*(q+H*R*(z+H*O*(2*z*z-1)));return t[0]=(a+W)/za,t[1]=B/za,t}function P0e(t,e,s,i){const r=e[0]*za,n=e[1]*za,o=s[0]*za,a=s[1]*za,{a:l,b:u,f:c,radius:h}=tR(i),m=o-r,f=Math.atan((1-c)*Math.tan(n)),g=Math.atan((1-c)*Math.tan(a)),v=Math.sin(f),b=Math.cos(f),w=Math.sin(g),S=Math.cos(g);let T,P,I,A,D,k,R,O,z,q,U=1e3,V=m;do{if(R=Math.sin(V),O=Math.cos(V),I=Math.sqrt(S*R*(S*R)+(b*w-v*S*O)*(b*w-v*S*O)),I===0)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;D=v*w+b*S*O,k=Math.atan2(I,D),z=b*S*R/I,P=1-z*z,A=D-2*v*w/P,isNaN(A)&&(A=0),q=c/16*P*(4+c*(4-3*P)),T=V,V=m+(1-q)*c*z*(k+q*I*(A+q*D*(2*A*A-1)))}while(Math.abs(V-T)>1e-12&&--U>0);if(U===0){const Z=h,te=Math.acos(Math.sin(n)*Math.sin(a)+Math.cos(n)*Math.cos(a)*Math.cos(o-r))*Z,ve=o-r,ke=Math.sin(ve)*Math.cos(a),Fe=Math.cos(n)*Math.sin(a)-Math.sin(n)*Math.cos(a)*Math.cos(ve),Pe=Math.atan2(ke,Fe);return t.azimuth=Pe/za,t.distance=te,t.reverseAzimuth=void 0,t}const B=P*(l*l-u*u)/(u*u),H=B/1024*(256+B*(B*(74-47*B)-128)),W=u*(1+B/16384*(4096+B*(B*(320-175*B)-768)))*(k-H*I*(A+H/4*(D*(2*A*A-1)-H/6*A*(4*I*I-3)*(4*A*A-3)))),ie=Math.atan2(S*Math.sin(V),b*w-v*S*Math.cos(V)),se=Math.atan2(b*Math.sin(V),b*w*Math.cos(V)-v*S);return t.azimuth=ie/za,t.distance=W,t.reverseAzimuth=se/za,t}function abt(t){return sR(t)?t:Yc(t)?St.WGS84:null}var D8;let af=D8=class extends po{constructor(t){super(t),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){const t=this.center,e=this.numberOfPoints;if(this.hasZ=(t==null?void 0:t.hasZ)??!1,this.rings.length!==0||!t)return;const s=os(this.radius,this.radiusUnit,"meters"),i=t.spatialReference;let r,n="geographic";if(i.isWebMercator?n="webMercator":((i.wkid&&Y[i.wkid])!=null||(i.wkt2||i.wkt)&&UD(i.wkt2||i.wkt))&&(n="projected"),this.geodesic){let o;switch(n){case"webMercator":o=o_(t);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":o=t}r=this._createGeodesicCircle(o,s,e),n==="webMercator"&&(r=bd(r))}else{let o;n==="webMercator"||n==="projected"?o=s/zz(t.spatialReference):n==="geographic"&&(o=Ple(s,"meters",gle(t.spatialReference).radius)),r=this._createPlanarCircle(t,o,e)}this.spatialReference=r.spatialReference,this.addRing(r.rings[0])}clone(){const{center:t,numberOfPoints:e,radius:s,radiusUnit:i,geodesic:r}=this;return new D8({center:t==null?void 0:t.clone(),numberOfPoints:e,radius:s,radiusUnit:i,geodesic:r})}_createGeodesicCircle(t,e,s){const i=[],r=[t.x,t.y];for(let n=0;n<360;n+=360/s){const o=this.hasZ?[0,0,t.z??0]:[0,0];iN(o,r,n,e,St.WGS84),i.push(o)}return i.push(i[0]),new po({rings:[i]})}_createPlanarCircle(t,e,s){const i=[],r=2*Math.PI/s;for(let n=0;n<s;++n){const o=r*n,a=[t.x+Math.cos(-o)*e,t.y+Math.sin(-o)*e];this.hasZ&&a.push(t.z??0),i.push(a)}return i.push(i[0]),new po({spatialReference:t.spatialReference,rings:[i]})}};p([_({type:Et})],af.prototype,"center",void 0),p([_()],af.prototype,"geodesic",void 0),p([_()],af.prototype,"numberOfPoints",void 0),p([_()],af.prototype,"radius",void 0),p([_()],af.prototype,"radiusUnit",void 0),af=D8=p([Q("esri.geometry.Circle")],af);const kQe=af;function FQe(t){switch(t){case 1:return"Unknown error";case 2:return"Corrupted geometry";case 3:return"Empty geometry";case 4:return"Math singularity";case 5:return"Buffer is too small";case 6:return"Invalid shape type";case 7:return"Projection out of supported range";case 8:return"Non simple geometry";case 9:return"Cannot calculate geodesic";case 10:return"Notation conversion";case 11:return"Missing grid file";case 12:return"Invalid call";case 13:return"Internal error";case 14:return"Not implemented";case 15:return"IO error";case 16:return"Invalid 3D";case 17:return"An ambiguous geography edge with antipodal points";case 18:return"Geocentric coordinates require ellipsoidal height";case 19:return"Geography cannot be projected into a gnomonic plane or a result of an operation cannot fit into a gnomonic plane";case 20:return"Geometry is too large to be exported in to a given format";case 22:return"Operation is canceled by the user";case 21:return"The operation, such as projection or geodetic computation, cannot be performed without pe-wasm loaded";default:return"unknown error"}}function F(t,e){try{if(!t)throw new Error(e)}catch(s){throw s}}let Sg=class extends Error{constructor(e,s){super(s),this.m_AdditionalMessage=s,this.m_ErrorType=e,this.name="GeometryError"}what(){return FQe(this.m_ErrorType)}additionalMessage(){return this.m_AdditionalMessage?this.m_AdditionalMessage:""}code(){return this.m_ErrorType}},OQe=class extends Sg{constructor(e){super(2,e),this.name="CorruptedGeometryError"}},LQe=class extends Sg{constructor(e){super(3,e),this.name="EmptyGeometryError"}},VQe=class extends Sg{constructor(e){super(4,e),this.name="MathSingularityError"}},qQe=class extends Sg{constructor(e){super(21,e),this.name="ProjectionEngineNotLoadedError"}},GQe=class extends Sg{constructor(e){super(8,e),this.name="NonSimpleGeometryError"}};var G;(function(t){t[t.enumUnknown=0]="enumUnknown",t[t.enumPoint=513]="enumPoint",t[t.enumLine=5122]="enumLine",t[t.enumBezier=5123]="enumBezier",t[t.enumEllipticArc=5124]="enumEllipticArc",t[t.enumEnvelope=3077]="enumEnvelope",t[t.enumMultiPoint=8710]="enumMultiPoint",t[t.enumPolyline=25607]="enumPolyline",t[t.enumPolygon=27656]="enumPolygon",t[t.enumMultipatch=40969]="enumMultipatch",t[t.enumGeometryCollection=3594]="enumGeometryCollection",t[t.enumRationalBezier2=5134]="enumRationalBezier2",t[t.enumBezier2=5135]="enumBezier2",t[t.enumRationalBezier23d=5392]="enumRationalBezier23d",t[t.enumGreatArc3d=5393]="enumGreatArc3d"})(G||(G={}));const zQe=[0,0,1,1,1,2,0,1,2,3,-1,-1,-1,-1,1,1];function ca(t){return zQe[15&t]}function Fb(t){return!!(512&t)}function UQe(t){return!!(1024&t)}function pbt(t){return!!(2048&t)}function zi(t){return!!(4096&t)}function zo(t){return!!(8192&t)}function xt(t){return!!(16384&t)}function _9(t){return!!(32768&t)}function QE(t){const e=t.getGeometryType();return zo(e)?t.getPointCount():t.isEmpty()?0:e===G.enumEnvelope?4:e===G.enumPoint?1:zi(e)?2:void Ce("missing type")}function T0e(t){const e=t.getGeometryType();if(xt(e))return t.hasNonLinearSegments();if(e===G.enumGeometryCollection){const s=t;for(let i=0,r=s.getGeometryCount();i<r;i++)if(T0e(s.getGeometry(i)))return!0;return!1}return!!zi(e)&&e!==G.enumLine}function iR(t){throw new qQe(t)}function I0e(t){throw new OQe(t)}function ee(t){throw new Error(t)}function $8(t){throw new VQe(t)}function BQe(){ee("Geometry type is not supported for 3D operations.")}function Us(t){throw new Sg(12,t)}function rR(t){throw new LQe(t)}function yt(t){throw new Sg(14,t)}function bt(t){throw new Error(t)}function Ce(t){throw new Sg(13,t)}function jQe(t){throw new Error(t)}function R8(t){throw new GQe(t)}function HQe(){yt("Operation does not support curves.")}function JE(t){t&&T0e(t)&&HQe()}function Nd(t){t&&_9(t.getGeometryType())&&yt("Unsupported geometry type.")}function nR(t){t===G.enumGeometryCollection&&ee("Geometry_collection instances are not supported in this operation")}function YQe(t){nR(t.getGeometryType())}function k8(t){ee(`bad wkid: ${t}`)}function M0e(t){let e="bad wkt: ";e+=t,e+="...",ee(e)}function KE(t,e){t||ee(e)}let Fr=class A0e{constructor(e){this.sum=e,this.compensation=0}assign(e){return this.compensation=e.compensation,this.sum=e.sum,this}reset(){this.sum=this.compensation=0}resetToStart(e){this.sum=e,this.compensation=0}normalize(){const e=[Number.NaN];this.sum=pE(this.sum,this.compensation,e),this.compensation=e[0]}add(e){const s=this.sum+e;let i;if(Math.abs(this.sum)>=Math.abs(e)){const r=this.sum-s+e;i=this.compensation+r}else{const r=e-s+this.sum;i=this.compensation+r}this.sum=s,this.compensation=i}sub(e){this.add(-e)}addProduct(e,s){const i=[0],r=z3(e,s,i);this.add(r),this.add(i[0])}mul(e){const s=new A0e(0);s.addProduct(this.sum,e),s.addProduct(this.compensation,e),this.assign(s)}getResult(){return this.sum+this.compensation}pe(e){return this.add(e),this}me(e){return this.add(-e),this}};const XQe=0x00000000ffffffffn,WQe=0x0000ffffn,ZQe=0x000000ffn,QQe=0x0fn,JQe=0xffff0000n,KQe=0xff00n,eJe=0xf0n,tJe=[5,1,2,1,3,1,2,1,4,1,2,1,3,1,2,1],sJe=[-1,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3];function F8(t){let e=0;return t&WQe||(e+=16,t>>=16n),t&ZQe||(e+=8,t>>=8n),t&QQe||(e+=4,t>>=4n),e+tJe[Number(BigInt.asUintN(4,t))]}function iJe(t){let e=0;return t&JQe&&(e+=16,t>>=16n),t&KQe&&(e+=8,t>>=8n),t&eJe&&(e+=4,t>>=4n),e+sJe[Number(BigInt.asUintN(4,t))]+1}function sie(t){let e=0;return t&XQe||(e=32,t>>=32n),e+F8(BigInt.asUintN(32,t))}function rJe(t){let e=0;return 0xffffffff00000000n&t&&(e=32,t>>=32n),e+iJe(t)}let de=class IS{constructor(e,s){if(this.m_EnvelopeType=1,e!==void 0){if(e instanceof IS)return this.vmin=e.vmin,void(this.vmax=e.vmax);this.vmin=e,this.vmax=s,this.normalize()}else this.setEmpty()}static construct(e,s){return new IS(e,s)}static constructEmpty(){return new IS}setCoords(e,s){this.vmin=e,this.vmax=s,this.normalize()}setCoordsFromEnvelope(e){this.vmin=e.vmin,this.vmax=e.vmax}setEmpty(){this.vmin=Number.NaN,this.vmax=Number.NaN}getCenter(){return .5*(this.vmin+this.vmax)}equalsRange(e,s){return uo(this.vmin,e)&&uo(this.vmax,s)}equals(e,s){return!(!this.isEmpty()||!e.isEmpty())||(s!==void 0?Math.abs(this.vmin-e.vmin)<=s&&Math.abs(this.vmax-e.vmax)<=s:this.vmin===e.vmin&&this.vmax===e.vmax)}width(){return this.vmax-this.vmin}isEmpty(){return Number.isNaN(this.vmin)||Number.isNaN(this.vmax)}isZero(){return this.vmin===this.vmax}setInfinite(){this.vmin=Number.NEGATIVE_INFINITY,this.vmax=Number.POSITIVE_INFINITY}move(e){this.isEmpty()||(this.vmin+=e,this.vmax+=e)}contains(e){return e.vmin>=this.vmin&&e.vmax<=this.vmax}containsCoordinate(e){return e>=this.vmin&&e<=this.vmax}containsRightExclusive(e){return e>=this.vmin&&e<this.vmax}containsExclusiveCoordinate(e){return e>this.vmin&&e<this.vmax}containsExclusive(e){return e.vmin>this.vmin&&e.vmax<this.vmax}isIntersecting(e){return this.vmin<=e.vmin?this.vmax>=e.vmin:e.vmax>=this.vmin}mergeCoordinate(e){if(this.isEmpty())return this.vmin=e,void(this.vmax=e);this.mergeNeCoordinate(e)}merge(e){if(e.isEmpty())return;const s=e.vmin,i=e.vmax;this.mergeCoordinate(s),this.mergeCoordinate(i)}mergeNe(e){const s=e.vmin,i=e.vmax;this.mergeNeCoordinate(s),this.mergeNeCoordinate(i)}mergeNeCoordinate(e){e<this.vmin?this.vmin=e:e>this.vmax&&(this.vmax=e)}intersect(e){this.isEmpty()||e.isEmpty()?this.setEmpty():(this.vmin<e.vmin&&(this.vmin=e.vmin),this.vmax>e.vmax&&(this.vmax=e.vmax),this.vmin>this.vmax&&this.setEmpty())}inflate(e){this.isEmpty()||(this.vmin-=e,this.vmax+=e,this.vmax<this.vmin&&this.setEmpty())}normalize(){this.vmin<=this.vmax||(this.vmin>this.vmax?this.vmax=be(this.vmin,this.vmin=this.vmax):this.setEmpty())}isValid(){return this.isEmpty()||this.vmin<=this.vmax}snapClip(e){return ys(e,this.vmin,this.vmax)}calculateToleranceFromEnvelope(){return this.isEmpty()?K_():(Math.abs(this.vmin)+Math.abs(this.vmax)+1)*K_()}static unit(){return nJe}normalizeNoNAN(){this.vmin>this.vmax&&(this.vmax=be(this.vmin,this.vmin=this.vmax))}setCoordsNoNAN(e,s){this.vmin=e,this.vmax=s,this.normalizeNoNAN()}clone(){return new IS(this.vmin,this.vmax)}};const nJe=new de(0,1);let le=class Ls{static getNAN(){return new Ls(Number.NaN)}constructor(e,s){this.m_value=e??0,this.m_eps=s??0}[Symbol.toPrimitive](e){return this}clone(){return new Ls(this.m_value,this.m_eps)}assign(e){return this.m_value=e.m_value,this.m_eps=e.m_eps,this}scaleError(e){this.m_eps*=e}setError(e){this.m_eps=e}set(e,s){return this.m_value=e,this.m_eps=s??0,this}setWithEps(e,s){return s===void 0&&(s=1),this.m_value=e,this.m_eps=Ls.ulp(e)*s,this}setE(e){return this.m_value=e.m_value,this.m_eps=e.m_eps,this}precise(){return new Ls(this.m_value)}value(){return this.m_value}toDouble(){return this.m_value}eps(){return this.m_eps}resetError(){return this.m_eps=0,this}absThis(){return this.m_value=Math.abs(this.m_value),this}add(e){return this.clone().addThis(e)}addE(e){return this.clone().addThisE(e)}addThisE(e){const s=this.m_value+e.m_value,i=this.m_eps+e.m_eps+Ls.ulp(s);return this.m_value=s,this.m_eps=i,this}addThis(e){const s=this.m_value+e,i=this.m_eps+Ls.ulp(s);return this.m_value=s,this.m_eps=i,this}subE(e){return this.clone().subThisE(e)}sub(e){return this.clone().subThis(e)}subThisE(e){const s=this.m_value-e.m_value,i=this.m_eps+e.m_eps+Ls.ulp(s);return this.m_value=s,this.m_eps=i,this}subThis(e){const s=this.m_value-e,i=this.m_eps+Ls.ulp(s);return this.m_value=s,this.m_eps=i,this}setAddE(e,s){return this.m_value=e.m_value+s.m_value,this.m_eps=e.m_eps+s.m_eps+Ls.ulp(this.m_value),this}setAdd(e,s){return this.m_value=e+s,this.m_eps=Ls.ulp(this.m_value),this}setAddEN(e,s){return this.m_value=e.m_value+s,this.m_eps=e.m_eps+Ls.ulp(this.m_value),this}setAddNE(e,s){return this.m_value=e+s.m_value,this.m_eps=s.m_eps+Ls.ulp(this.m_value),this}setSubE(e,s){return this.m_value=e.m_value-s.m_value,this.m_eps=e.m_eps+s.m_eps+Ls.ulp(this.m_value),this}setSub(e,s){return this.m_value=e-s,this.m_eps=Ls.ulp(this.m_value),this}setSubEN(e,s){return this.m_value=e.m_value-s,this.m_eps=e.m_eps+Ls.ulp(this.m_value),this}setSubNE(e,s){return this.m_value=e-s.m_value,this.m_eps=s.m_eps+Ls.ulp(this.m_value),this}mulThisE(e){const s=this.m_value*e.m_value;return this.m_eps=this.m_eps*Math.abs(e.m_value)+e.m_eps*Math.abs(this.m_value)+this.m_eps*e.m_eps+Ls.ulp(s),this.m_value=s,this}mulThis(e){const s=this.m_value*e;return this.m_eps=this.m_eps*Math.abs(e)+Ls.ulp(s),this.m_value=s,this}mul(e){return this.clone().mulThis(e)}mulE(e){return this.clone().mulThisE(e)}setMulE(e,s){const i=e.m_value*s.m_value;return this.m_eps=e.m_eps*Math.abs(s.m_value)+s.m_eps*Math.abs(e.m_value)+e.m_eps*s.m_eps+Ls.ulp(i),this.m_value=i,this}setMul(e,s){return this.m_value=e*s,this.m_eps=Ls.ulp(this.m_value),this}setMulEN(e,s){return this.setE(e),this.mulThis(s)}setMulNE(e,s){return this.setE(s),this.mulThis(e)}mulThisByPower2(e){return this.m_value*=e,this.m_eps*=Math.abs(e),this}static st_mulByPower2(e,s){return new Ls(e.m_value,e.m_eps).mulThisByPower2(s)}divE(e){return this.clone().divThisE(e)}divThisE(e){const s=Math.abs(e.m_value),i=this.m_value/e.m_value;let r=(this.m_eps+Math.abs(i)*e.m_eps)/s;if(e.m_eps>.01*s){const n=e.m_eps/s;r*=1+(1+n)*n}return this.m_value=i,this.m_eps=r+Ls.ulp(i),this}divThis(e){const s=Math.abs(e);return this.m_value/=e,this.m_eps=this.m_eps/s+Ls.ulp(this.m_value),this}setDivE(e,s){return this.setE(e),this.divThisE(s)}setDiv(e,s){return this.m_value=e/s,this.m_eps=Ls.ulp(this.m_value),this}setDivEN(e,s){return this.setE(e),this.divThis(s)}setDivNE(e,s){return this.set(e),this.divThisE(s)}divThisByPower2(e){return this.m_value/=e,this.m_eps/=Math.abs(e),this}invThis(){return this.setE(Dd.clone().divThisE(this)),this}sqrt(){return this.clone().sqrtThis()}sqrtThis(){let e,s;return this.m_value>=0?(e=Math.sqrt(this.m_value),s=this.m_value>10*this.m_eps?.5*this.m_eps/e:this.m_value>this.m_eps?e-Math.sqrt(this.m_value-this.m_eps):Math.max(e,Math.sqrt(this.m_value+this.m_eps)-e),s+=Ls.ulp(e)):this.m_value<-this.m_eps?(e=Number.NaN,s=Number.NaN):(e=0,s=Math.sqrt(this.m_eps)),this.m_value=e,this.m_eps=s,this}sqr(){return this.clone().sqrThis()}sqrThis(){const e=this.m_value*this.m_value;return this.m_eps=2*this.m_eps*Math.abs(this.m_value)+this.m_eps*this.m_eps+Ls.ulp(e),this.m_value=e,this}setSin(e){const s=Math.sin(e.m_value),i=Math.cos(e.m_value);this.m_value=s;const r=Math.abs(s),n=Math.abs(e.value());return this.m_eps=(Math.abs(i)+.5*r*e.m_eps)*e.m_eps+Ls.ulp(r+n),this}static ulp(e){let s=vP(e);const i=((0x7ff0000000000000n&s)>>52n)-1075n;return i>-1023n?(s=i+0x3ffn<<52n,CJe(s)):e===0?0:Number.MIN_VALUE}setCos(e){const s=Math.sin(e.m_value),i=Math.cos(e.m_value);this.m_value=i;const r=Math.abs(i),n=Math.abs(e.value());return this.m_eps=(Math.abs(s)+.5*r*e.m_eps)*e.m_eps+Ls.ulp(r+n),this}static st_cosAndSin(e,s,i){const r=Math.sin(e.m_value),n=Math.cos(e.m_value);i.m_value=r,s.m_value=n;const o=Math.abs(r),a=Math.abs(n),l=Math.abs(e.value());i.m_eps=(Math.abs(n)+.5*o*e.m_eps)*e.m_eps+Ls.ulp(o+l),s.m_eps=(Math.abs(r)+.5*a*e.m_eps)*e.m_eps+Ls.ulp(a+l)}negate(){return this.clone().negateThis()}negateThis(){return this.m_value=-this.m_value,this}setAbs(){return this.m_value=Math.abs(this.m_value),this}isInInterval(e){return de.construct(this.m_value-this.m_eps,this.m_value+this.m_eps).isIntersecting(e)}eq(e){return Math.abs(this.m_value-e.m_value)<=this.m_eps+e.m_eps}ne(e){return!this.eq(e)}gt(e){return this.m_value-e.m_value>this.m_eps+e.m_eps}lt(e){return e.m_value-this.m_value>this.m_eps+e.m_eps}ge(e){return!this.lt(e)}le(e){return!this.gt(e)}tolEQ(e,s){return Math.abs(this.m_value-e.m_value)<=s||this.eq(e)}tolNE(e,s){return!this.tolEQ(e,s)}tolGT(e,s){return this.m_value-e.m_value>s&&this.gt(e)}tolLT(e,s){return e.m_value-this.m_value>s&&this.lt(e)}tolGE(e,s){return!this.tolLT(e,s)}tolLE(e,s){return!this.tolGT(e,s)}isZero(){return Math.abs(this.m_value)<=this.m_eps}isFuzzyZero(){return this.isZero()&&this.m_eps!==0}tolIsZero(e){return Math.abs(this.m_value)<=Math.max(this.m_eps,e)}setPi(){this.setE(oJe)}setEuler(){this.set(2.718281828459045,v9())}static size(){return 1}};function to(t,e){const s=Y3(t),i=Y3(e),r=53-sie(s),n=53-sie(i);return(r>=0?r:0)+(n>=0?n:0)<=52}function eM(t,e){const s=t+e;return s-t===e&&s-e===t}function Jo(t,e){const s=t-e;return t-s===e&&e+s===t}function v9(){return Bs()}le.dimensions=1;const oJe=new le(Math.PI,.5*v9()),bx=new le(0,0),Dd=new le(1,0),aJe=new le(4,0);function Pu(t,e,s){return t.addE(e.subE(t).mulE(s))}function Tu(t,e,s){return e.subE(e.subE(t).mulE(Dd.subE(s)))}function lJe(t){return Math.atanh(t)}function uJe(t){let e;if(t===0)e=1;else if(Math.abs(t)>.01)e=lJe(t)/t;else{let s;const i=-36.841361487904734;e=0;const r=t*t;for(let n=2*Math.trunc(i/Math.log(r)+2.5)-1;n>1;n-=2)s=1/n,e=(e+s)*r;e+=1}return e}function O8(t){const e=Math.PI*Math.PI/6;let s;if(t===1)s=e;else if(t>1)s=e;else if(t===0)s=t;else if(t<0){const i=1+(t=Math.abs(t)),r=Math.log(i);s=r*r/-2-O8(t/i)}else if(t>.5){const i=1-t,r=Math.log(t)*Math.log(i);s=e-O8(i)-r}else{s=0;const i=1+Math.trunc(-16*Math.log(10)/Math.log(t)+1.5);let r=i;for(let n=i;n>0;n--,r-=1)s*=t,s+=1/(r*r);s*=t}return s}function fbt(t,e){const s=e*t;if(Math.abs(e)<.1){let i=0;for(let r=60;r>=1;r--)i*=s,i+=1/r/r;return i*=t,i}return O8(s)/e}function cJe(t,e){return t<e?Zi(t,e):Zi(e,t)}function $d(t,e){const s=Math.abs(t);return e>=0?s:-s}function J_(t){return Math.round(t)}function Li(t,e,s,i,r){r[0]=e[0]+(s[0]-e[0])*i,r[1]=e[1]+(s[1]-e[1])*i,t===3&&(r[2]=e[2]+(s[2]-e[2])*i)}function Vi(t,e,s,i,r){r[0]=s[0]-(s[0]-e[0])*(1-i),r[1]=s[1]-(s[1]-e[1])*(1-i),t===3&&(r[2]=s[2]-(s[2]-e[2])*(1-i))}function dE(t,e,s,i,r){i<=.5?Li(t,e,s,i,r):Vi(t,e,s,i,r)}function Rl(t,e,s,i,r){r[0]=e[0].addE(s[0].subE(e[0]).mulE(i)),r[1]=e[1].addE(s[1].subE(e[1]).mulE(i))}function kl(t,e,s,i,r){r[0]=s[0].subE(s[0].subE(e[0]).mulE(Dd.subE(i))),r[1]=s[1].subE(s[1].subE(e[1]).mulE(Dd.subE(i)))}function zt(t,e,s){let i;return i=s<=.5?t+(e-t)*s:e-(e-t)*(1-s),i}function vn(t,e,s){return t+(e-t)*s}function kr(t,e,s){return e-(e-t)*(1-s)}function wi(t,e,s,i){s<=.5?(i.x=t.x+(e.x-t.x)*s,i.y=t.y+(e.y-t.y)*s):(i.x=e.x-(e.x-t.x)*(1-s),i.y=e.y-(e.y-t.y)*(1-s))}function hJe(t,e,s,i){s<=.5?(i.x=t.x+(e.x-t.x)*s,i.y=t.y+(e.y-t.y)*s,i.z=t.z+(e.z-t.z)*s):(i.x=e.x-(e.x-t.x)*(1-s),i.y=e.y-(e.y-t.y)*(1-s),i.z=e.z-(e.z-t.z)*(1-s))}function Pt(t){return t*t}function iie(t){return t*t*t}function mJe(t){return 1/Math.sqrt(t)}function di(t){return t<0?-1:t>0?1:0}function gbt(t,e,s,i){const r=[0],n=[0],o=[0];return pE(z3(t,s,r),z3(e,i,n),o)+(r[0]+n[0]+o[0])}const rie=[0],dJe=[0];function nie(t,e,s){return pJe(z3(t,e,rie),s,rie[0],dJe)}const tL=[0],sL=[0],iL=[0],rL=[0];function z3(t,e,s){const i=t*e;return oie(t,tL,sL),oie(e,iL,rL),s[0]=sL[0]*rL[0]-(i-tL[0]*iL[0]-sL[0]*iL[0]-tL[0]*rL[0]),i}function oie(t,e,s){const i=134217729*t;e[0]=i-(i-t),s[0]=t-e[0]}const aie=[0],lie=[0];function pJe(t,e,s,i){const r=pE(t,e,aie),n=pE(r,s,lie);return pE(n,aie[0]+lie[0],i)}function pE(t,e,s){const i=t+e;return Math.abs(t)>Math.abs(e)?s[0]=t-i+e:s[0]=e-i+t,i}function og(t,e){return t%e}function b9(t){const e=1-t;if(e===0)return 1;let s;if(e<=.01){const i=e,r=Math.log(i);s=1+i*(.4431471805599453-.25*r+i*(.05680519270997949-.09375*r+i*(.02183137044373718-.05859375*r+i*(.011544521417308362-.042724609375*r+i*(.00714200031339596-.0336456298828125*r+i*(.004854743337164948-.027757644653320312*r+i*(.003514687963781376-.023627042770385742*r)))))))}else{if(t<.016){const i=t;return jn()*(1-i*(.25+i*(.046875+i*(.01953125+i*(.01068115234375+i*(.0067291259765625+i*(.004626274108886719+i*(.0033752918243408203+i*.0025710230693221092))))))))}s=N0e(0,e,1)-t*D0e(0,e,1)/3}return ys(s,1,jn())}function x9(t,e,s=Number.NaN){if(F(e>=0&&e<=1),e===0)return t;let i=1,r=t;if(r<0&&(r=-r,i=-1),e===1){const c=Math.round(r/Lt()),h=r-c*Lt();return i*(2*c+Math.sin(h))}const n=jn(),o=Math.floor(r/n);1&o?r=(o+1)*n-r:r-=o*n;const a=Math.sin(r),l=Number.isNaN(s)?b9(e):s;let u;if(a===1)u=l+Math.sqrt(1-e)*(r-n);else{const c=r*r;if(.01424*Math.pow(c,4)<=2*Bs())u=r*(1+c*e*(-1/6+c*((4-3*e)/120-(16+(45*e-60)*e)/5040*c)));else if(e<=.01){const h=Math.sin(2*r),m=Math.sin(4*r),f=Math.sin(6*r),g=Math.sin(8*r),v=Math.sin(10*r);u=r+e*((2*-r+h)/8+e*((-3*r+2*h-.25*m)/64+e*((-20*r+15*h-3*m+f/3)/1024+e*(5*(-140*r+112*h-28*m+16/3*f-.5*g)/65536+7*e*((-63*r+52.5*h-15*m+3.75*f-.625*g+.05*v)/65536+e*(-693*r+594*h-185.625*m+1.375*f-12.375*g+1.8*v-.125*Math.sin(12*r))/1048576)))))}else{const h=a*a,m=Math.cos(r),f=m*m,g=$0e(a,m,e);u=a*(N0e(f,g,1)-e*h*D0e(f,g,1)/3)}}return 1&o?u=l*(o+1)-u:u+=l*o,i*u}function fJe(t,e,s=Number.NaN){if(t===0)return 0;let i=1,r=t;t<0&&(r=-r,i=-1);const n=Number.isNaN(s)?b9(e):s,o=Math.floor(r/n);1&o?r=(o+1)*n-r:r-=o*n;let a=r<=0?0:r>=n?jn():gJe(r,e,n);return 1&o?a=jn()*(o+1)-a:a+=jn()*o,i*a}function N0e(t,e,s){F((t!==0?1:0)+(e!==0?1:0)+1>1);let i=t,r=e,n=s;for(;;){const o=Math.sqrt(i*r)+Math.sqrt(r*n)+Math.sqrt(n*i);i=.25*(i+o),r=.25*(r+o),n=.25*(n+o);const a=(i+r+n)/3,l=(a-i)/a,u=(a-r)/a,c=(a-n)/a;if(Math.abs(l)<=.0024&&Math.abs(u)<=.0024&&Math.abs(c)<=.0024){const h=l*u-c*c,m=l*u*c;return(1+(1/24*h-.1-3/44*m-5*h*h/208+h*m/16)*h+(1/14+3*m/104)*m)/Math.sqrt(a)}}}function D0e(t,e,s){F(t!==0||e!==0);let i=t,r=e,n=s;const o=new Fr(0);let a=1;for(;;){const l=.2*(i+r+3*n),u=(l-i)/l,c=(l-r)/l,h=(l-n)/l;if(Math.abs(u)<=.0015&&Math.abs(c)<=.0015&&Math.abs(h)<=.0015){const b=u*c,w=h*h,S=b-w,T=b-6*w,P=T+S+S,I=3/26,A=T*(.25*(9/22)*T-.21428571428571427-1.5*I*h*P),D=h*(1/6*P+h*(-.4090909090909091*S+h*I*b));return 3*o.getResult()+a*(1+A+D)/(l*Math.sqrt(l))}const m=Math.sqrt(i),f=Math.sqrt(r),g=Math.sqrt(n),v=m*(f+g)+f*g;o.add(a/(g*(n+v))),a*=.25,i=.25*(i+v),r=.25*(r+v),n=.25*(n+v)}}function $0e(t,e,s){return t<.999?1-s*Pt(t):1-s+s*Pt(e)}function gJe(t,e,s){if(e===0)return t;if(e===1)return Math.asin(t);let i=0,r=!0;if(t<.2){const o=t*t,a=t*(1+o*e*(1/6+o*((13*e-4)/120+(16-284*e+493*e*e)/5040*o))),l=Math.abs(e*(4944*e-64-31224*e*e+37369*e*e*e)/362880*Math.pow(t,9));if(l<Math.abs(a)*Bs())return a;i=a,r=l>.1*a}if(r){const o=1-e,a=1-t/s,l=Math.sqrt(a*a+o*o),u=Math.atan2(o,t+Bs());i=jn()+Math.sqrt(l)*(u-jn())}let n=0;for(let o=0;o<7;o++){n=x9(i,e,s);const a=$0e(Math.sin(i),Math.cos(i),e);if(i-=(n-t)/Math.sqrt(a),o>0&&Math.abs(n-t)<=4*Bs()*t)break}return i}function _P(t,e,s,i,r){return t===0?i===0?e:i===1?s:r:t===1?i===0?e:i===1?s:zt(e,s,i):(t===2&&yt("angular interpolation"),void yt(""))}function U3(t,e,s,i,r,n,o,a){if(t===0)for(let l=0;l<n;++l)i[l+r]=o===0?e[l]:o===1?s[l]:a;else if(t===1)if(o===0)$s(i,e,r,0,n);else if(o===1)$s(i,s,r,0,n);else for(let l=0;l<n;++l)i[l+r]=zt(e[l],s[l],o);else if(t===2)if(o===0)$s(i,e,r,0,n);else if(o===1)$s(i,s,r,0,n);else{let l=0;for(let u=0,c=r;u<n;++u,++c)i[c]=zt(e[u],s[u],o),l+=i[c]*i[c];if(l>0){l=Math.sqrt(l);for(let u=r;u<r+n;++u)i[u]/=l}else{for(let u=r;u<r+n;++u)i[u]=0;i[r]=1}}else yt("")}function $s(t,e,s,i,r){if(r===0)return;let n=0,o=s,a=i;for(;n++<r;)t[o++]=e[a++]}function yJe(t,e,s){let i=0;for(let r=0;!i&&r<s;++r)i=t[r]-e[r];return i}function be(t,e){return t}function xx(t){t.sort((e,s)=>e<s?-1:e>s?1:0)}function L8(t,e){const s=t.slice(0,e);xx(s),$s(t,s,0,0,e)}function Qc(t,e,s,i){const r=t.slice(e,e+s);r.sort(i),$s(t,r,e,0,s)}function em(t,e){return t<e?-1:t>e?1:0}function uie(t,e,s,i){return t<s?-1:t>s?1:e<i?-1:e>i?1:0}function R0e(t,e){if(t.length<2)return t.length;let s=0;for(let i=1;i<t.length;++i)e(t[i],t[s])||(s++,t[i]=be(t[s],t[s]=t[i]));return 1+s}function _Je(t,e){t[e]=t.at(-1),t.pop()}function k0e(t,e=!1){return{[Symbol.dispose](){this.bForget||t()},bForget:e}}function B3(t,e,s){t.length=e,t.fill(s)}function vJe(t,e,s){t.length=s;for(let i=0;i<s;++i)t[i]=new e}function ne(t,e){const s=new Array(e);for(let i=0;i<e;++i)s[i]=new t;return s}function j3(t,e,s){for(let i=0;i<s;++i)t[i].assign(e[i]);return s}function H3(t,e){const s=t.slice(0,e);for(let i=0;i<e;++i)s[i]=s[i].clone();return s}function fE(t){return Array.from({length:t},()=>null)}function cie(t,e){return Array.from({length:e},()=>t())}function Me(t,e){const s=new Array(t);return s.fill(e),s}function oR(t,e){return e in t&&Object.getOwnPropertyNames(t).length===1}let bJe=class{constructor(...e){this.m_elts=e}get length(){return this.m_elts.length}at(e){return this.m_elts[e]}[Symbol.dispose](){for(const e of this.m_elts)e[Symbol.dispose]()}};function Zi(t,e){return{first:t,second:e}}const w9=Math.PI,MS=2*Math.PI,Nt=.5*Math.PI;let xJe=class{constructor(e,s){this.m_cr=e,this.m_cc=s,this.m_v=Me(e*s,0)}get(e,s){return this.m_v[e*this.m_cc+s]}set(e,s,i){this.m_v[e*this.m_cc+s]=i}inc(e,s){return++this.m_v[e*this.m_cc+s]}};const F0e=new ArrayBuffer(8),O0e=new Float64Array(F0e),L0e=new BigUint64Array(F0e),wJe=0x0fffffffffffffn,SJe=0x7ff0000000000000n;function EJe(){return Number.EPSILON*OJe}function vP(t){return O0e[0]=t,L0e[0]}function CJe(t){return L0e[0]=t,O0e[0]}function Y3(t){return vP(t)&wJe}function hie(t){return Number((vP(t)&SJe)>>52n)}function sy(t){if(t===0n)return-1n;if(t===1n||-1n===t)return 0n;t<0n&&(t=-t);let e=0n,s=512n,i=1n<<e+s;for(;t>=i;)e+=s,s<<=1n,i<<=s;let r=e;s>>=1n;let n=r+s;for(;s>0n;)t<1n<<n||(r=n),s>>=1n,n=r+s;return r}function uo(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function wx(t,e,s){return t===e||Math.abs(t-e)<=s||Number.isNaN(t)&&Number.isNaN(e)}function Gs(t,e){return t<e?-1:t>e?1:0}function PJe(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;{const s=Number.isNaN(t),i=Number.isNaN(e);return s<i?-1:s>i?1:0}}function co(){return 2147483647}function mie(){return 32767}function Qr(){return 2147483647}function TJe(){return-2147483648}const aR=Qr(),IJe=BigInt(aR),V0e=2166136261,AS=16777619;function MJe(t){let e=V0e,s=t;return e=(e^255&s)*AS,s>>=8,e=(e^255&s)*AS,s>>=8,e=(e^255&s)*AS,s>>=8,e=(e^255&s)*AS,e&aR}const AJe=14695981039346656037n,iy=1099511628211n;function NJe(t){let e=AJe,s=t;return e=(e^0xffn&s)*iy,s>>=8n,e=(e^0xffn&s)*iy,s>>=8n,e=(e^0xffn&s)*iy,s>>=8n,e=(e^0xffn&s)*iy,s>>=8n,e=(e^0xffn&s)*iy,s>>=8n,e=(e^0xffn&s)*iy,s>>=8n,e=(e^0xffn&s)*iy,e&IJe}function DJe(t){return 1103515245*t+12345&2147483647}function q0e(t){let e=V0e;for(let s=0,i=t.length;s<i;++s)e=(e^t.charCodeAt(s))*AS;return e&aR}function Wi(t,e){return e+2654435769+(t<<6)+(t>>2)&aR}function $Je(t,e){return Wi(t,z0e(e))}function G0e(t){return Wi(3735928559,t)}function RJe(t,e){return Wi(t,G0e(e))}function kc(t){return MJe(t)}function z0e(t){return Number(NJe(t))}function kJe(t){return U0e(t)}function tM(t){return z0e(vP(kJe(t)))}function ub(t){return DJe(t)}const FJe=100,OJe=100;function K_(){return Number.EPSILON*FJe}function V8(){return .38196601125010515}function LJe(){return 1.4142135623730951}function Bs(){return Number.EPSILON}function bs(t,e,s){return t===e||t===s}function ys(t,e,s){return t>=e?t<=s?t:s:e}function q8(t,e,s){const i=t[0];if(i>=e){if(i<=s)return!1;t[0]=s}else t[0]=e;return!0}function VJe(t,e){return t>=e?e:t<-e?-e:t}function Lt(){return w9}function Gn(){return MS}function jn(){return Nt}const qJe=3*jn();function GJe(){return qJe}function U0e(t){return t+0}function die(t){return{v:t}}let Ae=class Hi{constructor(){this.m_rn=die(0n),this.m_rd=die(1n),this.m_bNaN=!1,this.m_bNormalized=!1,this.m_power=0,this.m_sign=0}static constructAssign(e,s){const i=e.clone();return s!==void 0&&i.limitPrecisionThis(s),i}static constructDouble(e){return new Hi().setDouble(e)}static constructInt64(e){return new Hi().setInt64(e)}static constructRational(e,s){return new Hi().setRational(e,s)}static constructInt32(e){return this.constructInt64(BigInt(Math.trunc(e)))}[Symbol.toPrimitive](e){return this}compare(e){return this.lt(e)?-1:this.gt(e)?1:0}assignCopy(e){return this.setThis(e)}abs(){return this.clone().absThis()}absThis(){return this.isNAN()||(this.m_sign*=this.m_sign),this}clone(){return new Hi().setThis(this)}setThis(e){return this.m_bNaN=e.m_bNaN,this.m_bNormalized=e.m_bNormalized,this.m_rn.v=e.m_rn.v,this.m_rd.v=e.m_rd.v,this.m_power=e.m_power,this.m_sign=e.m_sign,this}setZero(){return this.m_rn.v=0n,this.m_rd.v=1n,this.m_bNaN=!1,this.m_power=0,this.m_bNormalized=!0,this.m_sign=0,this}setDouble(e){if(this.setZero(),e===0)return this;if(Number.isInteger(e)&&Math.abs(e)<Qr())return this.setInt32(e);const s=vP(e),i=(s&Hi.s_em)>>52n,r=!!(s&Hi.s_sm),n=s&Hi.s_fm;if(i===Hi.s_emax)return n?(this.m_rn.v=this.m_rd.v=0n,this.m_bNaN=!0,this):(this.m_rn.v=r?-1n:1n,this.m_rd.v=0n,this);i===0n&&yt("denormalized numbers not yet implemented");const o=i-1023n,a=o>=0n?o:0n,l=o<0n?-o:0n;return this.m_rn.v=(1n<<52n|n)<<a,this.m_rd.v=1n<<52n+l,this.m_sign=r?-1:1,this.m_bNormalized=!1,this.normalizeThis()}setInt64(e){return e===0n?this.setZero():(this.m_bNaN=!1,this.m_sign=e>0n?1:-1,this.m_rn.v=e>0n?e:-e,this.m_rd.v=1n,this.m_power=0,this.m_bNormalized=!1,this.normalizeThis())}setRational(e,s){return e===0n?s===0n?this.setNAN():this.setZero():s===0n?e>0n?this.setPositiveInf():this.setNegativeInf():(this.m_sign=(e>0n?1:-1)*(s>0n?1:-1),this.m_rn.v=e>0n?e:-e,this.m_rd.v=s>0n?s:-s,this.m_power=0,this.m_bNormalized=!1,this.normalizeThis())}setInt32(e){return this.setInt64(BigInt(Math.trunc(e)))}getDouble(){return this.convertToDouble()}toDouble(){return this.convertToDouble()}value(){return this.convertToDouble()}isNAN(){return this.m_bNaN}isPositiveInf(){return!this.isNAN()&&this.m_rd.v===0n&&this.m_sign===1}isNegativeInf(){return!this.isNAN()&&this.m_rd.v===0n&&this.m_sign===-1}isFinite(){return!this.isNAN()&&this.m_rd.v!==0n}setNAN(){return this.m_bNaN=!0,this.m_rn.v=0n,this.m_rd.v=0n,this.m_power=0,this.m_bNormalized=!0,this}setPositiveInf(){return this.m_rn.v=1n,this.m_rd.v=0n,this.m_bNaN=!1,this.m_bNormalized=!0,this.m_sign=1,this.m_power=0,this}setNegativeInf(){return this.m_rn.v=1n,this.m_rd.v=0n,this.m_bNaN=!1,this.m_bNormalized=!0,this.m_sign=-1,this.m_power=0,this}subThis(e){if(e.isNAN()&&this.setNAN(),this.isPositiveInf()&&e.isPositiveInf())this.setNAN();else{if(this.isPositiveInf()&&e.isNegativeInf())return this.setPositiveInf(),this;if(this.isNegativeInf()&&e.isNegativeInf())this.setNAN();else if(this.isNegativeInf()&&e.isPositiveInf())return this.setNegativeInf(),this}return this.isNAN()?this:this.opPlusMinus(e,!1)}thisSubAbs(e){return F(0),this}mulThis(e){return e.isNAN()&&this.setNAN(),this.isNAN()?this:(this.m_sign*=e.m_sign,this.m_sign===0?this.setZero():(this.m_rn.v*=e.m_rn.v,this.m_rd.v*=e.m_rd.v,this.m_power+=e.m_power,this.m_bNormalized=!1,this.normalizeThis(),this))}mulDoubleThis(e){return this.mulThis(Hi.constructDouble(e))}thisMulInt64(e){return F(0),this}thisMulInt32(e){return F(0),this}divThis(e){return this.mulThis(e.clone().invertThis())}divDoubleThis(e){return this.divThis(Hi.constructDouble(e))}addDoubleThis(e){return this.addThis(Hi.constructDouble(e))}subDoubleThis(e){return this.subThis(Hi.constructDouble(e))}mul(e){return this.clone().mulThis(e)}mulBigIntThis(e){return this.mulThis(Hi.constructInt64(e))}mulDouble(e){return this.clone().mulThis(Hi.constructDouble(e))}div(e){return this.clone().divThis(e)}divDouble(e){return this.clone().divDoubleThis(e)}add(e){return this.clone().addThis(e)}fmSubThis(e,s){return this.subThis(e.clone().mulThis(s))}fmAddThis(e,s){return this.addThis(e.clone().mulThis(s))}addThis(e){if(e.isNAN()&&this.setNAN(),this.isPositiveInf()&&e.isPositiveInf())return this.setPositiveInf(),this;if(this.isPositiveInf()&&e.isNegativeInf())this.setNAN();else{if(this.isNegativeInf()&&e.isNegativeInf())return this.setNegativeInf(),this;this.isNegativeInf()&&e.isPositiveInf()&&this.setNAN()}return this.isNAN()?this:this.opPlusMinus(e,!0)}addDouble(e){return this.clone().addThis(Hi.constructDouble(e))}sub(e){return this.clone().subThis(e)}subDouble(e){return this.clone().subThis(Hi.constructDouble(e))}isZero(){return this.m_sign===0}equals(e){return this.clone().subThis(e).isZero()}lt(e){return!this.isNAN()&&!e.isNAN()&&!(this.isPositiveInf()&&e.isPositiveInf()||this.isNegativeInf()&&e.isNegativeInf())&&!this.isPositiveInf()&&(!!e.isPositiveInf()||this.clone().sub(e).LZ())}absLessAbs(e){return this.abs().lt(e.abs())}gt(e){return this.clone().sub(e).GZ()}lte(e){return this.sub(e).LEZ()}gte(e){return this.sub(e).GEZ()}normalizeThis(){if(this.m_bNormalized)return this;if(this.m_rn.v===0n)return this.setZero();let e=0,s=0xffffffffn;for(;(this.m_rn.v&s)===0n&&s<=this.m_rn.v;)s<<=32n,e+=32;s&=this.m_rn.v,s>>=BigInt(e),e+=F8(BigInt.asUintN(32,s))-1;let i=0;for(s=0xffffffffn;(this.m_rd.v&s)===0n&&s<=this.m_rd.v;)s<<=32n,i+=32;return s&=this.m_rd.v,s>>=BigInt(i),i+=F8(BigInt.asUintN(32,s))-1,this.m_rn.v>>=BigInt(e),this.m_rd.v>>=BigInt(i),this.m_power+=e-i,this.m_rn.v>1n&&this.m_rd.v>1n&&(this.m_rn.v%this.m_rd.v===0n?(this.m_rn.v/=this.m_rd.v,this.m_rd.v=1n):this.m_rd.v%this.m_rn.v===0n&&(this.m_rd.v/=this.m_rn.v,this.m_rn.v=1n)),this.m_bNormalized=!0,this}negateThis(){return this.isNAN()||(this.m_sign*=-1),this}negate(){return this.clone().negateThis()}invertThis(){return this.isNAN()?this:this.isPositiveInf()||this.isNegativeInf()?(this.setZero(),this):this.m_rn.v===0n?(this.setPositiveInf(),this):(this.m_rd=be(this.m_rn,this.m_rn=this.m_rd),this.m_power=-this.m_power,this)}limitPrecisionThis(e){if(e===0)return this;if(this.isZero())return this.setZero();if(!this.isFinite())return this;this.normalizeThis();let s=Number(sy(this.m_rn.v));if(s>e){const i=s-e;this.m_rn.v>>=BigInt(s-e),this.m_power+=i}if(s=Number(sy(this.m_rd.v)),s>e){const i=s-e;this.m_rd.v>>=BigInt(s-e),this.m_power-=i}return this}hiBitIndex(){return Math.max(Number(sy(this.m_rn.v)),Number(sy(this.m_rd.v)))}ldexp(e){return this.clone().ldexpThis(e)}ldexpThis(e){return e&&(this.m_bNormalized=!1,this.m_power+=e,this.normalizeThis()),this}LZ(){return!this.isNAN()&&this.m_sign===-1}GZ(){return!this.isNAN()&&this.m_sign===1}LEZ(){return!this.isNAN()&&this.m_sign<=0}GEZ(){return!this.isNAN()&&this.m_sign>=0}toString(){return this.toDouble().toString()}sqr(){return this.clone().sqrThis()}sqrThis(){return this.mulThis(this.clone())}static sqrt(e,s){if(e.m_sign<0n&&bt("MP_value: sqrt(-1)"),e.isZero())return e.clone();let i=52,r=2220446049250313e-31;for(;i<s;)2*i<=s?(r*=r,i*=2):(r*=2220446049250313e-31,i+=52);i+=52;const n=sy(e.m_rn.v),o=sy(e.m_rd.v);let a,l=e.m_power+Number(n-o);const u=new Hi;Math.abs(l)>200?(1&Math.abs(l)&&(l+=1),a=Hi.constructAssign(e,53).ldexpThis(-l).value(),u.setThis(e).ldexpThis(-l),F(Number.isFinite(a))):(u.setThis(e),a=u.value(),F(Number.isFinite(a)),l=0),a=Math.sqrt(a);const c=Hi.constructDouble(a),h=Hi.constructDouble(r);h.mulThis(c).ldexpThis(1);const m=r*a*2,f=c.clone(),g=new Hi;let v;for(let b=0;b<10;++b){f.mulThis(c),g.setThis(u).subThis(f).absThis();let w=g.value();if(v=1,w<.9)for(;w>m;)w*=w,++v;else v=4;if(g.lte(h))break;for(let S=0;S<v;S++)f.setThis(c).divThis(u).invertThis().addThis(c).ldexpThis(-1).limitPrecisionThis(i),c.setThis(f)}return c.ldexpThis(l/2)}static cubicRoot(e,s){if(e.isZero())return e.clone();let i=52,r=2220446049250313e-31;for(;i<s;)2*i<=s?(r*=r,i*=2):(r*=2220446049250313e-31,i+=52);i+=52;const n=Math.pow(Math.abs(e.value()),1/3),o=Hi.constructDouble(n),a=o.clone();a.sqrThis().mulDoubleThis(3).mulDoubleThis(r),a.limitPrecisionThis(32),e.LZ()&&o.negateThis();for(let l=0;l<10;++l){const u=o.clone();u.sqrThis().mulThis(o);const c=u.clone();if(c.subThis(e),c.absThis().limitPrecisionThis(32),c.lte(a))break;c.setThis(e),c.ldexpThis(1),c.addThis(u);const h=u.clone();h.ldexpThis(1),h.addThis(e),c.divThis(h),o.mulThis(c),o.limitPrecisionThis(i)}return o}isInTheRangeOfDouble(){return F(0),!1}sign(){return this.m_sign}cosAndSin(e,s){F(0)}static nan(){return F(0),new Hi}convertToDouble(){if(this.m_bNaN)return Number.NaN;if(this.isZero())return 0;if(this.m_rd.v===0n)return this.m_sign===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;const e=this.m_sign===-1,s=this.m_rn.v<<(this.m_power>=0?BigInt(this.m_power):0n);let i=this.m_rd.v<<(this.m_power<0?BigInt(-this.m_power):0n);const r=s/i;let n=Number(r);if(BigInt(n)!==r)return e?-n:n;let o=s-r*i;if(o){let a=sy(i)-1023n;a>0n&&(i>>=a,o<<=52n,o>>=a);let l=Number(o);Number.isFinite(l)||(o>>=52n,l=Number(o),a=0n),a>0n&&(l/=Math.pow(2,52)),n+=l/Number(i)}return e?-n:n}signVal(){return this.m_sign===1?1n:this.m_sign===-1?-1n:0n}opPlusMinus(e,s){const i=Math.min(this.m_power,e.m_power);let r,n;this.m_power>i?(r=BigInt(this.m_power-i),n=0n):(r=0n,n=BigInt(e.m_power-i));const o=this.signVal()*this.m_rn.v*e.m_rd.v<<r,a=e.signVal()*e.m_rn.v*this.m_rd.v<<n;return this.m_rn.v=s?o+a:o-a,this.m_rd.v*=e.m_rd.v,this.m_power=i,this.m_sign=1,this.m_rn.v<0n&&(this.m_sign=-1,this.m_rn.v=-this.m_rn.v),this.m_bNormalized=!1,this.normalizeThis(),this}};Ae.s_sm=0x8000000000000000n,Ae.s_em=0x7ff0000000000000n,Ae.s_fm=0x000fffffffffffffn,Ae.s_emax=0x7ffn;const Fc=Ae.constructInt32(1),zn=Ae.constructInt32(0);function zJe(t,e){return rJe(t^e)}function UJe(t,e){let s=hie(t);const i=hie(e);return s===i?(s-=53-zJe(Y3(t),Y3(e)),s):s>i?s:i}function BJe(t,e){for(let s=0,i=0,r=t.length;s<r;s+=2,i++)e[i].x=t[s],e[i].y=t[s+1]}function jJe(t){const e=new Float64Array(2*t.length);for(let s=0,i=t.length;s<i;++s){const r=s<<1;e[r]=t[s].x,e[r+1]=t[s].y}return e}function M1(t){const e=ne(M,t.length);for(let s=0,i=t.length;s<i;++s)e[s].setCoords(t[s][0],t[s][1]);return e}let M=class jt{static construct(e,s){return new jt(e,s)}constructor(e,s){e!==void 0?(this.x=e,this.y=s):this.x=this.y=Number.NaN}clone(){return new jt(this.x,this.y)}assign(e){this.setCoordsPoint2D(e)}setCoords(e,s){return this.x=e,this.y=s,this}setCoordsPoint2D(e){this.x=e.x,this.y=e.y}isEqualPoint2D(e,s){return s!==void 0?Math.abs(this.x-e.x)<=s&&Math.abs(this.y-e.y)<=s:this.x===e.x&&this.y===e.y}isEqual(e,s,i){return i!==void 0?Math.abs(this.x-e)<=i&&Math.abs(this.y-s)<=i:this.x===e&&this.y===s}equalsPoint2D(e,s){return this.isEqualPoint2D(e,s)}setSub(e,s){this.x=e.x-s.x,this.y=e.y-s.y}addThis(e){return this.x+=e.x,this.y+=e.y,this}setAdd(e,s){return this.x=e.x+s.x,this.y=e.y+s.y,this}absoluteOther(e){}absolute(){return F(0),this}setNegate(){this.x=-this.x,this.y=-this.y}setNegateOther(e){this.x=-e.x,this.y=-e.y}interpolateThis(e,s){}interpolate(e,s,i){F(0)}scaleAddThis(e,s){this.x=this.x*e+s.x,this.y=this.y*e+s.y}setScaleAdd(e,s,i){this.x=s.x*e+i.x,this.y=s.y*e+i.y}scaleOther(e,s){F(0)}scale(e){this.x*=e,this.y*=e}compare(e){return this.y<e.y?-1:this.y>e.y?1:this.x<e.x?-1:this.x>e.x?1:0}compareX(e){return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}normalizeOther(e){F(0)}normalize(){const e=this.length();return e?(this.x/=e,this.y/=e):(this.x=1,this.y=0),this}getUnitVector(){return this.clone().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}sqrLength(){return this.x*this.x+this.y*this.y}static averageFast(e,s){return F(0),{}}static average(e,s){const i=new jt;if(s===0)return i.setNAN(),i;if(s===1)return i.assign(e[0]),i;const r=new Fr(e[0].x),n=new Fr(e[0].y);for(let o=1;o<s;o++)r.add(e[o].x),n.add(e[o].y),255&o||(r.normalize(),n.normalize());return i.x=r.getResult()/s,i.y=n.getResult()/s,i}offset(e,s){const i=jt.distance(e,s),r=jt.construct(this.x,this.y);if(i===0)return jt.distance(r,e);const n=s.clone();return n.subThis(e),r.subThis(e),r.crossProduct(n)/i}side(e,s){return e.equals(s)?this.equals(e)?0:1:jt.orientationRobust(s,e,this)}static sqrDistance(e,s){const i=e.x-s.x,r=e.y-s.y;return i*i+r*r}static sqrDistanceCoords(e,s,i,r){const n=i-e,o=r-s;return n*n+o*o}static distance(e,s){return Math.sqrt(jt.sqrDistance(e,s))}dotProduct(e){return this.x*e.x+this.y*e.y}dotProductAbs(e){return Math.abs(this.x*e.x)+Math.abs(this.y*e.y)}crossProduct(e){return this.x*e.y-this.y*e.x}crossProductAbs(e){return F(0),0}rotateDirect(e,s){const i=this.x*e-this.y*s,r=this.x*s+this.y*e;this.x=i,this.y=r}rotateReverse(e,s){const i=this.x*e+this.y*s,r=-this.x*s+this.y*e;this.x=i,this.y=r}leftPerpendicularThis(){const e=this.x;this.x=-this.y,this.y=e}leftPerpendicularOther(e){const s=e.x;this.x=-e.y,this.y=s}rightPerpendicularThis(){const e=this.x;this.x=this.y,this.y=-e}rightPerpendicularOther(e){const s=e.x;this.x=e.y,this.y=-s}equals(e){return this.x===e.x&&this.y===e.y}notequals(e){return this.x!==e.x||this.y!==e.y}not(){return!this.x&&!this.y}gt(e){return this.y>e.y||this.y===e.y&&this.x>e.x}gte(e){return!this.lt(e)}lt(e){return this.y<e.y||this.y===e.y&&this.x<e.x}lte(e){return!this.gt(e)}subThis(e){return this.x-=e.x,this.y-=e.y,this}divThis(e){return this.x/=e,this.y/=e,this}add(e){return new jt(this.x+e.x,this.y+e.y)}sub(e){return new jt(this.x-e.x,this.y-e.y)}negateThis(){return this.x=-this.x,this.y=-this.y,this}negate(){return new jt(-this.x,-this.y)}mul(e){return new jt(this.x*e,this.y*e)}mulThis(e){return this.x*=e,this.y*=e,this}divide(e){return new jt(this.x/e,this.y/e)}setNAN(){this.x=this.y=Number.NaN}isNAN(){return Number.isNaN(this.x)||Number.isNaN(this.y)}static getNAN(){return new jt(Number.NaN,Number.NaN)}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)}isZero(){return this.x===0&&this.y===0}norm(e){switch(e){case 0:{const s=Math.abs(this.x),i=Math.abs(this.y),r=s-i;return r>=0?s:r<=0?i:Number.NaN}case 1:return Math.abs(this.x)+Math.abs(this.y);case 2:return Math.sqrt(this.x*this.x+this.y*this.y);default:ee("norm")}}getQuarter(){return jt.getQuarterCoords(this.x,this.y)}static getQuarterCoords(e,s){return e>0?s>=0?1:4:s>0?2:e===0?4:3}static compareVectors(e,s){const i=e.getQuarter(),r=s.getQuarter();return r===i?jt.orientationRobustImpl(jt.construct(0,0),s,e,!0):i<r?-1:1}static compareVectorsOrigin(e,s,i){const r=s.sub(e),n=i.sub(e),o=r.getQuarter(),a=n.getQuarter();return a===o?jt.orientationRobustImpl(e,i,s,!0):o<a?-1:1}static orientationRobust(e,s,i){return jt.orientationRobustImpl(e,s,i,!1)}static orientationRobustEx(e,s,i,r){if(e.equals(s)||i.equals(r))return 0;const n=s.x-e.x,o=s.y-e.y,a=r.x-i.x,l=r.y-i.y;{const f=jt.getQuarterCoords(n,o)-1,g=jt.getQuarterCoords(a,l)-1,v=jt.d[f][g];if(v!==0)return v}const u=n*l,c=o*a,h=4*Bs()*(Math.abs(u)+Math.abs(c)),m=u-c;return Math.abs(m)>=h?m<0?-1:m>0?1:0:jt.orientationRobustExMp(e,s,i,r)}static orientationRobustExMp(e,s,i,r){const n=Ae.constructDouble(s.x),o=Ae.constructDouble(r.x);n.subThis(Ae.constructDouble(e.x)),o.subThis(Ae.constructDouble(i.x));const a=Ae.constructDouble(s.y),l=Ae.constructDouble(r.y);return a.subThis(Ae.constructDouble(e.y)),l.subThis(Ae.constructDouble(i.y)),n.mulThis(l),a.mulThis(o),n.subThis(a),n.LZ()?-1:n.GZ()?1:0}static orientationNonRobust(e,s,i){const r=s.sub(e).crossProduct(i.sub(e));return r<0?-1:r>0?1:0}static orientationRobustImpl(e,s,i,r){if(s.isEqualPoint2D(e)||i.isEqualPoint2D(e)||s.isEqualPoint2D(i))return 0;const n=s.x-e.x,o=s.y-e.y,a=i.x-e.x,l=i.y-e.y;if(!r){const h=jt.getQuarterCoords(n,o)-1,m=jt.getQuarterCoords(a,l)-1,f=jt.d[h][m];if(f!==0)return f}const u=(Math.abs(n)+Math.abs(o)+Math.abs(a)+Math.abs(l))*(Math.abs(s.x)+Math.abs(s.y)+Math.abs(i.x)+Math.abs(i.y))*8*v9(),c=n*l-o*a;if(Math.abs(c)>u)return c<0?-1:1;if(Jo(s.x,e.x)&&Jo(i.y,e.y)&&Jo(s.y,e.y)&&Jo(i.x,e.x)&&to(n,l)&&to(o,a)){const h=n*l,m=o*a;if(Jo(h,m)){const f=h-m;return f<0?-1:f>0?1:0}}return jt.orientationRobustMp(e,s,i)}static orientationRobustMp(e,s,i){const r=Ae.constructDouble(s.x),n=Ae.constructDouble(i.x);{const l=Ae.constructDouble(e.x);r.subThis(l),n.subThis(l)}const o=Ae.constructDouble(i.y),a=Ae.constructDouble(s.y);{const l=Ae.constructDouble(e.y);o.subThis(l),a.subThis(l)}return r.mulThis(o),a.mulThis(n),r.subThis(a),r.LZ()?-1:r.GZ()?1:0}static inCircleRobust(e,s,i,r){const n=new le,o=new le;n.set(e.x),n.subThis(r.x),o.set(e.y),o.subThis(r.y);const a=new le,l=new le;a.set(s.x),a.subThis(r.x),l.set(s.y),l.subThis(r.y);const u=new le,c=new le;u.set(i.x),u.subThis(r.x),c.set(i.y),c.subThis(r.y);const h=n.mulE(l).subE(o.mulE(a)),m=a.mulE(c).subE(l.mulE(u)),f=n.mulE(c).subE(o.mulE(u)),g=n.mulE(n).addE(o.mulE(o)),v=a.mulE(a).addE(l.mulE(l)),b=u.mulE(u).addE(c.mulE(c)),w=g.mulE(m).subE(v.mulE(f)).addE(b.mulE(h));if(!w.isFuzzyZero()){const S=w.value();return S<0?-1:S>0?1:0}return jt.inCircleRobustMp(e,s,i,r)}static inCircleRobustMp(e,s,i,r){do{if(!Jo(e.x,r.x)||!Jo(e.y,r.y)||!Jo(s.x,r.x)||!Jo(s.y,r.y)||!Jo(i.x,r.x)||!Jo(i.y,r.y))break;const P=e.x-r.x,I=e.y-r.y,A=s.x-r.x,D=s.y-r.y,k=i.x-r.x,R=i.y-r.y;if(!to(P,D)||!to(I,A)||!to(A,R)||!to(D,k)||!to(P,R)||!to(I,k)||!to(P,P)||!to(I,I)||!to(A,A)||!to(D,D)||!to(k,k)||!to(R,R))break;const O=P*D,z=I*A,q=A*R,U=D*k,V=P*R,B=I*k,H=P*P,W=I*I,ie=A*A,se=D*D,Z=k*k,te=R*R;if(!Jo(O,z)||!Jo(q,U)||!Jo(V,B)||!eM(H,W)||!eM(ie,se)||!eM(Z,te))break;const ve=O-z,ke=q-U,Fe=V-B,Pe=H+W,Ve=ie+se,Ke=Z+te;if(!to(Pe,ke)||!to(Ve,Fe)||!to(Ke,ve))break;const He=Pe*ke,Rs=Ve*Fe,Cr=Ke*ve;if(!Jo(He,Rs))break;const Js=He-Rs;if(!eM(Js,Cr))break;const as=Js+Cr;return as<0?-1:as>0?1:0}while(!1);const n=Ae.constructDouble(r.x),o=Ae.constructDouble(r.y),a=Ae.constructDouble(e.x),l=Ae.constructDouble(e.y);a.subThis(n),l.subThis(o);const u=Ae.constructDouble(s.x),c=Ae.constructDouble(s.y);u.subThis(n),c.subThis(o);const h=Ae.constructDouble(i.x),m=Ae.constructDouble(i.y);h.subThis(n),m.subThis(o);const f=a.mul(c).sub(l.mul(u)),g=u.mul(m).sub(c.mul(h)),v=a.mul(m).sub(l.mul(h)),b=a.mul(a).add(l.mul(l)),w=u.mul(u).add(c.mul(c)),S=h.mul(h).add(m.mul(m)),T=b.mul(g).sub(w.mul(v)).add(S.mul(f));return T.LZ()?-1:T.GZ()?1:0}static inCircleRobustMp3Point(e,s,i){const r=Ae.constructDouble(e.x),n=Ae.constructDouble(e.y),o=Ae.constructDouble(s.x),a=Ae.constructDouble(s.y),l=Ae.constructDouble(i.x),u=Ae.constructDouble(i.y),c=l.mul(l).add(u.mul(u)).sub(l.mul(r).add(u.mul(n)).add(l.mul(o)).add(u.mul(a))).add(r.mul(o).add(n.mul(a)));return c.LZ()?-1:c.GZ()?1:0}static inCircleRobust3Point(e,s,i){const r=new le(e.x),n=new le(e.y),o=new le(s.x),a=new le(s.y),l=new le(i.x),u=new le(i.y),c=l.mulE(l).addE(u.mulE(u)).subE(l.mulE(r).addE(u.mulE(n)).addE(l.mulE(o)).addE(u.mulE(a))).addE(r.mulE(o).addE(n.mulE(a)));if(!c.isFuzzyZero()){const h=c.value();return h<0?-1:h>0?1:0}return jt.inCircleRobustMp3Point(e,s,i)}static calculateCircleCenterFromThreePoints(e,s,i){if(e.equals(i)||e.equals(s)||i.equals(s))return jt.getNAN();const r=HJe(e,s,i);return r.isNAN()?YJe(e,s,i):r}static calculateAngle(e,s){return Math.atan2(e.crossProduct(s),e.dotProduct(s))}static isBisectorRobust(e,s,i){return F(0),!1}static size(){return 2}get 0(){return this.x}get 1(){return this.y}set 0(e){this.x=e}set 1(e){this.y=e}static compareZorder(e,s){const i=jt.c_compare_zorder_xx[e.x<0?1:0]|jt.c_compare_zorder_yy[e.y<0?1:0],r=jt.c_compare_zorder_xx[s.x<0?1:0]|jt.c_compare_zorder_yy[s.y<0?1:0];if(i===r){let n=0,o=0;for(let a=0;a<2;++a){const l=UJe(e[a],s[a]);l>n&&(n=l,o=a)}return e[o]<s[o]}return i<r}static lerp(e,s,i){const r=new jt;return wi(e,s,i,r),r}static getClosestCoordinate(e,s,i,r=!1){const n=jt.getNAN();n.setSub(s,e);const o=n.sqrLength();if(o===0)return .5;if(s.isEqualPoint2D(i))return 1;const a=jt.getNAN();a.setSub(i,e);let l=a.dotProduct(n)/o;return r||(l<0?l=0:l>1&&(l=1)),l}static intersectLinesAtOnePoint(e,s,i,r){if(e.equals(s)||i.equals(r))return jt.getNAN();const n=s.x-e.x,o=i.x-r.x,a=s.y-e.y,l=i.y-r.y,u=n*l-o*a;if(!u)return jt.getNAN();const c=u;if(c===0)return jt.getNAN();let h=(i.x-e.x)*l-(i.y-e.y)*o;h/=c;const m=new jt;return wi(e,s,h,m),m.isFinite()?m:jt.getNAN()}toString(){return`[${this.x},${this.y}]`}};function HJe(t,e,s){const i=new le(e.x);i.subThis(t.x);const r=new le(e.y);r.subThis(t.y);const n=new le(s.x);n.subThis(t.x);const o=new le(s.y);o.subThis(t.y);const a=i.clone();a.mulThisE(o);let l=r.clone();if(l.mulThisE(n),a.subThisE(l),a.value()===0)return M.getNAN();a.mulThis(2);const u=i.clone();u.mulThisE(i);const c=r.clone();c.mulThisE(r);const h=u.clone();h.addThisE(c);const m=n.clone();m.mulThisE(n);const f=o.clone();f.mulThisE(o);const g=m.clone();g.addThisE(f);const v=r.clone();v.mulThisE(g),l=o.clone(),l.mulThisE(h),v.subThisE(l),v.divThisE(a);const b=i.clone();b.mulThisE(g),l=n.clone(),l.mulThisE(h),b.subThisE(l),b.divThisE(a);const w=M.construct(t.x-v.value(),t.y+b.value()),S=t.sub(w).length(),T=e.sub(w).length(),P=s.sub(w).length(),I=1e-15*(S+Math.abs(t.x)+Math.abs(e.x)+Math.abs(s.x)+Math.abs(t.y)+Math.abs(e.y)+Math.abs(s.y));return Math.abs(S-T)<=I&&Math.abs(S-P)<=I&&v.eps()<I&&b.eps()<I?w:M.getNAN()}function YJe(t,e,s){const i=Ae.constructDouble(e.x);i.subDoubleThis(t.x);const r=Ae.constructDouble(e.y);r.subDoubleThis(t.y);const n=Ae.constructDouble(s.x);n.subDoubleThis(t.x);const o=Ae.constructDouble(s.y);o.subDoubleThis(t.y);const a=i.clone();a.mulThis(o);let l=r.clone();if(l.mulThis(n),a.subThis(l),a.isZero())return M.getNAN();a.mulDoubleThis(2);const u=i.clone();u.mulThis(i);const c=r.clone();c.mulThis(r);const h=u.clone();h.addThis(c);const m=n.clone();m.mulThis(n);const f=o.clone();f.mulThis(o);const g=m.clone();g.addThis(f);const v=r.clone();v.mulThis(g),l=o.clone(),l.mulThis(h),v.subThis(l),v.divThis(a);const b=i.clone();return b.mulThis(g),l=n.clone(),l.mulThis(h),b.subThis(l),b.divThis(a),M.construct(t.x-v.value(),t.y+b.value())}M.dimensions=2,M.d=[[0,1,0,-1],[-1,0,1,0],[0,-1,0,1],[1,0,-1,0]],M.c_compare_zorder_xx=[2,0],M.c_compare_zorder_yy=[1,0];let X=class Io{static construct(e,s,i,r){return new Io(e,s,i,r)}constructor(e,s,i,r){this.m_EnvelopeType=2,e===void 0?(this.xmin=Number.NaN,this.ymin=Number.NaN,this.xmax=Number.NaN,this.ymax=Number.NaN):typeof e=="number"?(this.xmin=e,this.ymin=s,this.xmax=i,this.ymax=r):(this.xmin=e.xmin,this.ymin=e.ymin,this.xmax=e.xmax,this.ymax=e.ymax),this.normalize()}static constructEmpty(){return new Io(Number.NaN,Number.NaN,Number.NaN,Number.NaN)}clone(){return new Io(this)}assign(e){return this.xmin=e.xmin,this.xmax=e.xmax,this.ymin=e.ymin,this.ymax=e.ymax,this}width(){return this.xmax-this.xmin}height(){return this.ymax-this.ymin}maxDimension(){return Math.max(this.width(),this.height())}minDimension(){return Math.min(this.width(),this.height())}sqrDiagonal(){const e=this.width(),s=this.height();return e*e+s*s}diagonal(){return Math.sqrt(this.sqrDiagonal())}getCenterX(){return .5*(this.xmin+this.xmax)}getCenterY(){return .5*(this.ymin+this.ymax)}getCenter(){return M.construct(this.getCenterX(),this.getCenterY())}queryCenter(e){e.x=.5*(this.xmin+this.xmax),e.y=.5*(this.ymin+this.ymax)}setEmpty(){this.xmin=Number.NaN,this.ymin=Number.NaN,this.xmax=Number.NaN,this.ymax=Number.NaN}setInfinite(){this.xmin=Number.NEGATIVE_INFINITY,this.xmax=Number.POSITIVE_INFINITY,this.ymin=Number.NEGATIVE_INFINITY,this.ymax=Number.POSITIVE_INFINITY}isDegenerate(e){return!this.isEmpty()&&(this.width()<=e||this.height()<=e)}isZero(){return!(this.isEmpty()||this.width()&&this.height())}isEmpty(){return Number.isNaN(this.xmin)||Number.isNaN(this.ymin)||Number.isNaN(this.xmax)||Number.isNaN(this.ymax)}mergeNeCoords(e,s){this.xmin>e?this.xmin=e:this.xmax<e&&(this.xmax=e),this.ymin>s?this.ymin=s:this.ymax<s&&(this.ymax=s)}mergeNe(e){this.mergeNeCoords(e.x,e.y)}mergeCoords(e,s){this.isEmpty()?(this.xmin=e,this.ymin=s,this.xmax=e,this.ymax=s):(this.xmin>e?this.xmin=e:this.xmax<e&&(this.xmax=e),this.ymin>s?this.ymin=s:this.ymax<s&&(this.ymax=s))}merge(e){this.mergeCoords(e.x,e.y)}mergeEnvelope2D(e){e.isEmpty()||(this.mergeCoords(e.xmin,e.ymin),this.mergeNeCoords(e.xmax,e.ymax))}mergePoints(e,s){for(let i=0;i<s;){if(!this.isEmpty()){for(let r=i;r<s;r++)this.mergeNe(e[r]);break}this.setCoords(e[i]),i++}}mergePointsInterleaved(e,s,i){for(let r=2*s,n=r+2*i;r<n;r+=2)this.mergeCoords(e.read(r),e.read(r+1))}inflateCoords(e,s){this.isEmpty()||(this.xmin-=e,this.xmax+=e,this.ymin-=s,this.ymax+=s,(this.xmin>this.xmax||this.ymin>this.ymax)&&this.setEmpty())}getInflatedCoords(e,s){const i=this.clone();return i.inflateCoords(e,s),i}inflate(e){this.inflateCoords(e,e)}getInflated(e){const s=this.clone();return s.inflateCoords(e,e),s}zoom(e,s){this.isEmpty()||this.setCoords({center:this.getCenter(),width:e*this.width(),height:s*this.height()})}scale(e){e<0&&this.setEmpty(),this.xmin*=e,this.xmax*=e,this.ymin*=e,this.ymax*=e}equals(e,s){return!(!this.isEmpty()||!e.isEmpty())||(s?Math.abs(this.xmin-e.xmin)<=s&&Math.abs(this.ymin-e.ymin)<=s&&Math.abs(this.xmax-e.xmax)<=s&&Math.abs(this.ymax-e.ymax)<=s:this.xmin===e.xmin&&this.ymin===e.ymin&&this.xmax===e.xmax&&this.ymax===e.ymax)}setCoords(e){e.xmin!==void 0?(this.xmin=e.xmin,this.xmax=e.xmax,this.ymin=e.ymin,this.ymax=e.ymax):e.x!==void 0?(this.xmin=e.x,this.xmax=e.x,this.ymin=e.y,this.ymax=e.y):e.pt1!==void 0?(this.xmin=e.pt1.x,this.ymin=e.pt1.y,this.xmax=e.pt2.x,this.ymax=e.pt2.y,this.normalize()):e.env2D!==void 0?(this.xmin=e.env2D.xmin,this.xmax=e.env2D.xmax,this.ymin=e.env2D.ymin,this.ymax=e.env2D.ymax,this.normalize()):e.pt!==void 0?(this.xmin=e.pt.x,this.xmax=e.pt.x,this.ymin=e.pt.y,this.ymax=e.pt.y):e.center!==void 0?(this.xmin=e.center.x-.5*e.width,this.xmax=this.xmin+e.width,this.ymin=e.center.y-.5*e.height,this.ymax=this.ymin+e.height,this.normalize()):yt("unrecognized input type for setCoords"),this.normalize()}queryIntervalX(e){this.isEmpty()?e.setEmpty():e.setCoords(this.xmin,this.xmax)}queryIntervalY(e){this.isEmpty()?e.setEmpty():e.setCoords(this.ymin,this.ymax)}setFromPoints(e,s){if(s===0)return void this.setEmpty();if(Array.isArray(e)){const r=e;this.setCoords(r[0]);for(let n=1;n<s;){if(!this.isEmpty()){for(let o=n;o<s;o++)this.mergeNe(r[o]);return}this.setCoords(r[n]),n++}return}const i=e;this.setCoords({x:i[0],y:i[1]});for(let r=1,n=2*s;r<n;r+=2){if(!this.isEmpty()){for(let o=r,a=2*s;o<a;o+=2)this.mergeNeCoords(i[o],i[o+1]);return}this.setCoords({x:i[r],y:i[r+1]}),r+=2}}normalize(){let e=!1;this.xmin<=this.xmax||([this.xmin,this.xmax]=[this.xmax,this.xmin],e=!0),this.ymin<=this.ymax||([this.ymin,this.ymax]=[this.ymax,this.ymin],e=!0),!e||this.xmin<=this.xmax&&this.ymin<=this.ymax||this.setEmpty()}isValid(){return this.isEmpty()||this.xmin<=this.xmax&&this.ymin<=this.ymax}getLowerLeft(){return new M(this.xmin,this.ymin)}getLowerRight(){return new M(this.xmax,this.ymin)}getUpperLeft(){return new M(this.xmin,this.ymax)}getUpperRight(){return new M(this.xmax,this.ymax)}move(e,s){this.isEmpty()||(this.xmin+=e,this.ymin+=s,this.xmax+=e,this.ymax+=s)}centerAtCoords(e,s){this.move(e-this.getCenterX(),s-this.getCenterY())}centerAt(e){this.centerAtCoords(e.x,e.y)}containsCoords(e,s){return e>=this.xmin&&e<=this.xmax&&s>=this.ymin&&s<=this.ymax}contains(e){return this.containsCoords(e.x,e.y)}containsEnvelope(e){return e.xmin>=this.xmin&&e.xmax<=this.xmax&&e.ymin>=this.ymin&&e.ymax<=this.ymax}containsExclusiveCoords(e,s){return e>this.xmin&&e<this.xmax&&s>this.ymin&&s<this.ymax}containsExclusive(e){return this.containsExclusiveCoords(e.x,e.y)}containsExclusiveEnvelope(e){return e.xmin>this.xmin&&e.xmax<this.xmax&&e.ymin>this.ymin&&e.ymax<this.ymax}isIntersecting(e){return(this.xmin<=e.xmin?this.xmax>=e.xmin:e.xmax>=this.xmin)&&(this.ymin<=e.ymin?this.ymax>=e.ymin:e.ymax>=this.ymin)}isIntersectingNe(e){return(this.xmin<=e.xmin?this.xmax>=e.xmin:e.xmax>=this.xmin)&&(this.ymin<=e.ymin?this.ymax>=e.ymin:e.ymax>=this.ymin)}intersect(e){if(this.isEmpty())return!1;if(e.isEmpty())return this.setEmpty(),!1;e.xmin>this.xmin&&(this.xmin=e.xmin),e.xmax<this.xmax&&(this.xmax=e.xmax),e.ymin>this.ymin&&(this.ymin=e.ymin),e.ymax<this.ymax&&(this.ymax=e.ymax);const s=this.xmin<=this.xmax&&this.ymin<=this.ymax;return s||this.setEmpty(),s}queryCorner(e){switch(3&e){case 0:return new M(this.xmin,this.ymin);case 1:return new M(this.xmin,this.ymax);case 2:return new M(this.xmax,this.ymax);default:return new M(this.xmax,this.ymin)}}queryCorners(e){e[0].setCoords(this.xmin,this.ymin),e[1].setCoords(this.xmin,this.ymax),e[2].setCoords(this.xmax,this.ymax),e[3].setCoords(this.xmax,this.ymin)}queryCornersReversed(e){e[0].setCoords(this.xmin,this.ymin),e[1].setCoords(this.xmax,this.ymin),e[2].setCoords(this.xmax,this.ymax),e[3].setCoords(this.xmin,this.ymax)}reaspect(e,s){if(this.isEmpty())return;const i=e/s,r=.5*this.width(),n=.5*this.height()*i;if(r<=n){const o=this.getCenterX();this.xmin=o-n,this.xmax=o+n}else{const o=r/i,a=this.getCenterY();this.ymin=a-o,this.ymax=a+o}this.normalize()}getArea(){return this.isEmpty()?0:this.width()*this.height()}getLength(){return this.isEmpty()?0:2*(this.width()+this.height())}clipCode(e){return(e.x<this.xmin?1:0)|(e.x>this.xmax?1:0)<<1|(e.y<this.ymin?1:0)<<2|(e.y>this.ymax?1:0)<<3}clipLine(e,s){let i=this.clipCode(e),r=this.clipCode(s);if(i&r)return 0;if(!(i|r))return 4;const n=(i?1:0)|(r?2:0);do{const o=s.x-e.x,a=s.y-e.y;if(Math.abs(o)>Math.abs(a)?i&Io.XMASK?(i&Io.XLESSXMIN?(e.y+=a*(this.xmin-e.x)/o,e.x=this.xmin):(e.y+=a*(this.xmax-e.x)/o,e.x=this.xmax),i=this.clipCode(e)):r&Io.XMASK?(r&Io.XLESSXMIN?(s.y+=a*(this.xmin-s.x)/o,s.x=this.xmin):(s.y+=a*(this.xmax-s.x)/o,s.x=this.xmax),r=this.clipCode(s)):i?(i&Io.YLESSYMIN?(e.x+=o*(this.ymin-e.y)/a,e.y=this.ymin):(e.x+=o*(this.ymax-e.y)/a,e.y=this.ymax),i=this.clipCode(e)):(r&Io.YLESSYMIN?(s.x+=o*(this.ymin-s.y)/a,s.y=this.ymin):(s.x+=o*(this.ymax-s.y)/a,s.y=this.ymax),r=this.clipCode(s)):i&Io.YMASK?(i&Io.YLESSYMIN?(e.x+=o*(this.ymin-e.y)/a,e.y=this.ymin):(e.x+=o*(this.ymax-e.y)/a,e.y=this.ymax),i=this.clipCode(e)):r&Io.YMASK?(r&Io.YLESSYMIN?(s.x+=o*(this.ymin-s.y)/a,s.y=this.ymin):(s.x+=o*(this.ymax-s.y)/a,s.y=this.ymax),r=this.clipCode(s)):i?(i&Io.XLESSXMIN?(e.y+=a*(this.xmin-e.x)/o,e.x=this.xmin):(e.y+=a*(this.xmax-e.x)/o,e.x=this.xmax),i=this.clipCode(e)):(r&Io.XLESSXMIN?(s.y+=a*(this.xmin-s.x)/o,s.x=this.xmin):(s.y+=a*(this.xmax-s.x)/o,s.x=this.xmax),r=this.clipCode(s)),i&r)return 0}while(i|r);return n}distanceFromEnvelope(e){return Math.sqrt(this.sqrDistanceEnvelope(e,null,null))}distance(e){return Math.sqrt(this.sqrDistance(e))}sqrDistanceEnvelope(e,s,i){if(!s&&!i){if(this.isEmpty()||e.isEmpty())return Number.NaN;let u,c=0,h=0;return u=this.xmin-e.xmax,u>c&&(c=u),u=this.ymin-e.ymax,u>h&&(h=u),u=e.xmin-this.xmax,u>c&&(c=u),u=e.ymin-this.ymax,u>h&&(h=u),c*c+h*h}if(this.isEmpty()||e.isEmpty())return s&&s.setNAN(),i&&i.setNAN(),Number.NaN;let r,n=0,o=0;const a=Math.max(this.xmin,e.xmin),l=Math.max(this.ymin,e.ymin);return s&&s.setCoords(a,l),i&&i.setCoords(a,l),r=this.xmin-e.xmax,r>n&&(n=r,s&&(s.x=this.xmin),i&&(i.x=e.xmax)),r=this.ymin-e.ymax,r>o&&(o=r,s&&(s.y=this.ymin),i&&(i.y=e.ymax)),r=e.xmin-this.xmax,r>n&&(n=r,s&&(s.x=this.xmax),i&&(i.x=e.xmin)),r=e.ymin-this.ymax,r>o&&(o=r,s&&(s.y=this.ymax),i&&(i.y=e.ymin)),n*n+o*o}sqrDistance(e,s){if(s===void 0){if(this.isEmpty()||e.isNAN())return Number.NaN;let o,a=0,l=0;return o=this.xmin-e.x,o>a&&(a=o),o=this.ymin-e.y,o>l&&(l=o),o=e.x-this.xmax,o>a&&(a=o),o=e.y-this.ymax,o>l&&(l=o),a*a+l*l}if(this.isEmpty()||e.isNAN())return s.setNAN(),Number.NaN;s.assign(e);let i,r=0,n=0;return i=this.xmin-e.x,i>r&&(r=i,s.x=this.xmin),i=this.ymin-e.y,i>n&&(n=i,s.y=this.ymin),i=e.x-this.xmax,i>r&&(r=i,s.x=this.xmax),i=e.y-this.ymax,i>n&&(n=i,s.y=this.ymax),r*r+n*n}sqrMaxMinDistanceEnvelope(e){if(this.isEmpty()||e.isEmpty())return Number.NaN;let s=Number.MAX_VALUE;{const i=M.sqrDistanceCoords(this.xmin,this.ymin,e.xmax,e.ymin),r=M.sqrDistanceCoords(this.xmin,this.ymin,e.xmax,e.ymax),n=M.sqrDistanceCoords(this.xmin,this.ymax,e.xmax,e.ymin),o=M.sqrDistanceCoords(this.xmin,this.ymax,e.xmax,e.ymax),a=Math.max(i,r),l=Math.max(n,o),u=Math.max(a,l);s=Math.min(u,s)}{const i=M.sqrDistanceCoords(this.xmin,this.ymin,e.xmin,e.ymax),r=M.sqrDistanceCoords(this.xmin,this.ymin,e.xmax,e.ymax),n=M.sqrDistanceCoords(this.xmax,this.ymin,e.xmin,e.ymax),o=M.sqrDistanceCoords(this.xmax,this.ymin,e.xmax,e.ymax),a=Math.max(i,r),l=Math.max(n,o),u=Math.max(a,l);s=Math.min(u,s)}{const i=M.sqrDistanceCoords(this.xmax,this.ymin,e.xmin,e.ymin),r=M.sqrDistanceCoords(this.xmax,this.ymin,e.xmin,e.ymax),n=M.sqrDistanceCoords(this.xmax,this.ymax,e.xmin,e.ymin),o=M.sqrDistanceCoords(this.xmax,this.ymax,e.xmin,e.ymax),a=Math.max(i,r),l=Math.max(n,o),u=Math.max(a,l);s=Math.min(u,s)}{const i=M.sqrDistanceCoords(this.xmin,this.ymax,e.xmin,e.ymin),r=M.sqrDistanceCoords(this.xmin,this.ymax,e.xmax,e.ymin),n=M.sqrDistanceCoords(this.xmax,this.ymax,e.xmin,e.ymin),o=M.sqrDistanceCoords(this.xmax,this.ymax,e.xmax,e.ymin),a=Math.max(i,r),l=Math.max(n,o),u=Math.max(a,l);s=Math.min(u,s)}return s}sqrMaxDistanceEnvelope(e){if(this.isEmpty()||e.isEmpty())return Number.NaN;let s=0;const i=ne(M,4);this.queryCorners(i);const r=ne(M,4);e.queryCorners(r);for(let n=0;n<4;n++)for(let o=0;o<4;o++){const a=M.sqrDistance(i[n],r[o]);a>s&&(s=a)}return s}sqrMaxMinDistance(e){const s=M.sqrDistance(e,this.getLowerLeft()),i=M.sqrDistance(e,this.getUpperLeft()),r=M.sqrDistance(e,this.getLowerRight()),n=M.sqrDistance(e,this.getUpperRight());let o,a=Math.max(s,i);return o=Math.max(s,r),a>o&&(a=o),o=Math.max(i,n),a>o&&(a=o),o=Math.max(r,n),a>o&&(a=o),a}sqrMinDistance(e){return this.contains(e)?0:this.sqrDistance(e)}sqrMaxDistance(e){let s=M.sqrDistance(e,this.getLowerLeft());return s=Math.max(M.sqrDistance(e,this.getUpperLeft()),s),s=Math.max(M.sqrDistance(e,this.getUpperRight()),s),s=Math.max(M.sqrDistance(e,this.getLowerRight()),s),s}snapToBoundary(e){if(e.isNAN())return!1;if(this.isEmpty())return e.setNAN(),!0;let s=!0;if(e.x<this.xmin?e.x=this.xmin:e.x>this.xmax?e.x=this.xmax:s=!1,e.y<this.ymin?e.y=this.ymin:e.y>this.ymax?e.y=this.ymax:s=!1,s)return!0;if(e.x===this.xmin||e.x===this.xmax||e.y===this.ymin||e.y===this.ymax)return!1;const i=this.xmax-e.x,r=e.x-this.xmin,n=this.ymax-e.y,o=e.y-this.ymin;return Math.max(i,r)>Math.max(n,o)?e.y=o<n?this.ymin:this.ymax:e.x=r<i?this.xmin:this.xmax,!0}snapClip(e){const s=ys(e.x,this.xmin,this.xmax),i=ys(e.y,this.ymin,this.ymax);return M.construct(s,i)}boundaryDistance(e){if(this.isEmpty()||e.isNAN())return Number.NaN;if(e.x===this.xmin)return e.y-this.ymin;const s=this.ymax-this.ymin,i=this.xmax-this.xmin;if(e.y===this.ymax)return s+e.x-this.xmin;if(e.x===this.xmax)return s+i+this.ymax-e.y;if(e.y===this.ymin)return 2*s+i+this.xmax-e.x;const r=new M;return r.setCoordsPoint2D(e),this.snapToBoundary(r),this.boundaryDistance(r)}envelopeSide(e){if(this.isEmpty())return-1;let s=this.boundaryDistance(e);const i=this.ymax-this.ymin,r=this.xmax-this.xmin;return s<i?0:(s-=i)<r?1:s-r<i?2:3}querySide(e,s){switch(e){case 0:s.constructFromCoords(this.xmin,this.ymin,this.xmin,this.ymax);break;case 1:s.constructFromCoords(this.xmin,this.ymax,this.xmax,this.ymax);break;case 2:s.constructFromCoords(this.xmax,this.ymax,this.xmax,this.ymin);break;case 3:s.constructFromCoords(this.xmax,this.ymin,this.xmin,this.ymin);break;default:ee("query_side")}return s}isPointOnBoundary(e,s){return Math.abs(e.x-this.xmin)<=s||Math.abs(e.x-this.xmax)<=s||Math.abs(e.y-this.ymin)<=s||Math.abs(e.y-this.ymax)<=s}calculateToleranceFromEnvelope(){return this.isEmpty()?K_():(Math.abs(this.xmin)+Math.abs(this.xmax)+Math.abs(this.ymin)+Math.abs(this.ymax)+1)*K_()}toString(){return`[${this.xmin}, ${this.ymin}, ${this.xmax}, ${this.ymax}]`}};X.XLESSXMIN=1,X.YLESSYMIN=4,X.XMASK=3,X.YMASK=12;const pie=[0,0,Number.NaN,0,0,0,0,0,-1,-1,0,0,0,0],XJe=[2,1,1,1,3,1,2,3,2,4,1,1,2,1],WJe=[1,1,1,0,2,1,1,1,0,0,0,0,0,1],ZJe=[1,1,1,2,0,0,0,0,2,2,4,2,2,1],QJe=[4,8,4,8,1],S9=25;function qh(){return Me(S9,Number.NaN)}let Es=class sd{getAttributeCount(){return this.m_attributeCount}getSemantics(e){return this.m_indexToSemantics[e]}getSemanticsBitArray(){return this.m_semanticsBitArray}getAttributeIndex(e){return this.m_semanticsToIndexMap[e]}static getInterpolation(e){return WJe[e]}static getPersistence(e){return ZJe[e]}static getPersistenceSize(e){return QJe[e]}static getPersistenceSizeFromSemantics(e){return sd.getPersistenceSize(sd.getPersistence(e))*sd.getComponentCount(e)}static getComponentCount(e){return XJe[e]}static maxComponentCount(){return 4}static isInteger(e){return e===2||e===3||e===4}static isIntegerSemantics(e){return sd.isInteger(sd.getPersistence(e))}static isTexture(e){return e===5||e===6||e===7}hasAttribute(e){return!!(this.m_semanticsBitArray&1<<e)}hasAttributesFrom(e){return(this.m_semanticsBitArray&e.m_semanticsBitArray)===e.m_semanticsBitArray}hasZ(){return this.hasAttribute(1)}hasM(){return this.hasAttribute(2)}hasID(){return this.hasAttribute(3)}getTotalComponentCount(){return this.m_totalComponentCount}static getDefaultValue(e){return pie[e]}static isDefaultValue(e,s){return uo(pie[e],s)}equals(e){return this===e}getDefaultPointAttributes(){return this.m_defaultPointAttributes}getPointAttributeOffset(e){return this.m_pointAttributeOffsets[e]}constructor(e){this.m_semanticsBitArray=e,this.m_attributeCount=0,this.m_totalComponentCount=0,this.m_semanticsToIndexMap=new Int32Array(14),this.m_indexToSemantics=new Int32Array(14),this.m_pointAttributeOffsets=new Int32Array(14),this.m_defaultPointAttributes=Me(S9,Number.NaN),this.m_semanticsToIndexMap.fill(-1),this.m_indexToSemantics.fill(-1);let s=0,i=1,r=14;for(;s<r;s++)e&i&&(this.m_semanticsToIndexMap[s]=this.m_attributeCount,this.m_indexToSemantics[this.m_attributeCount]=s,this.m_attributeCount++,this.m_totalComponentCount+=sd.getComponentCount(s)),i<<=1;let n=0;for(s=0,r=this.getAttributeCount();s<r;s++){const o=this.getSemantics(s),a=sd.getComponentCount(o),l=sd.getDefaultValue(o);this.m_pointAttributeOffsets[s]=n;for(let u=0;u<a;u++)this.m_defaultPointAttributes[n]=l,n++}}};var nL=Es;function lR(){return Me(14,0)}let eC=class B0e{static getInstance(){return B0e.s_thisInstance}constructor(){this.m_map=new Map,this.m_vd2D=new nL(1),this.m_map.set(1,this.m_vd2D),this.m_vd3D=new nL(3),this.m_map.set(3,this.m_vd2D)}GetVD2D(){return this.m_vd2D}GetVD3D(){return this.m_vd3D}FindOrAdd(e){if(e===1)return this.GetVD2D();if(e===3)return this.GetVD3D();const s=this.m_map.get(e);if(s)return s;const i=new nL(e);return this.m_map.set(e,i),i}};function E9(t){return eC.getInstance().FindOrAdd(t)}function Sx(t,e){if(!t||!e)return e||t;const s=t.getSemanticsBitArray()|e.getSemanticsBitArray();return(s&t.getSemanticsBitArray())===s?t:(s&e.getSemanticsBitArray())===s?e:E9(s)}function bP(t,e){const s=t.getSemanticsBitArray()|1<<e;return(s&t.getSemanticsBitArray())===s?t:E9(s)}function xP(t,e){const s=(t.getSemanticsBitArray()|1<<e)-(1<<e);return s===t.getSemanticsBitArray()?t:E9(s)}function Jr(){return eC.getInstance().GetVD2D()}function tC(){return eC.getInstance().GetVD3D()}function uR(t,e,s){if(s.fill(-1),t!==null&&e!==null)for(let i=0,r=t.getAttributeCount();i<r;i++)s[i]=e.getAttributeIndex(t.getSemantics(i))}eC.s_thisInstance=new eC;let gt=class la{static construct(e,s,i){return new la(e,s,i)}constructor(e,s,i){e!==void 0?(this.x=e,this.y=s,this.z=i):this.x=this.y=this.z=Number.NaN}get 0(){return this.x}get 1(){return this.y}get 2(){return this.z}set 0(e){this.x=e}set 1(e){this.y=e}set 2(e){this.z=e}clone(){return new la(this.x,this.y,this.z)}assign(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}setCoords(e,s,i){return this.x=e,this.y=s,this.z=i,this}setCoordsPoint2DZ(e,s){return this.setCoords(e.x,e.y,s)}setCoordsPoint3D(e){this.x=e.x,this.y=e.y,this.z=e.z}setZero(){this.x=0,this.y=0,this.z=0}setNormalized(e){this.assign(e),this.normalizeThis()}normalizeThis(){const e=this.length();return e?(this.x/=e,this.y/=e,this.z/=e):(this.x=1,this.y=0,this.z=0),this}getUnitVector(){const e=new la;return e.setNormalized(this),e}sqrLength(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthXY(){return F(0),0}static sqrDistance(e,s){return Pt(e.x-s.x)+Pt(e.y-s.y)+Pt(e.z-s.z)}static sqrDistanceCoords(e,s,i,r,n,o){return Pt(e-r)+Pt(s-n)+Pt(i-o)}static distance(e,s){return Math.sqrt(la.sqrDistance(e,s))}isEqual(e,s){return s===void 0&&(s=0),Math.abs(this.x-e.x)<=s&&Math.abs(this.y-e.y)<=s&&wx(this.z,e.z,s)}static compareByLength(e,s,i,r){return F(0),0}isEqualCoords(e,s,i,r){return F(0),this.x===e&&this.y===s&&this.z===i}isEqualsTols(e,s,i){return F(0),!1}isEqualCoordsTols(e,s,i,r,n){return F(0),!1}static st_isEqual(e,s,i,r){return F(0),!1}equals(e,s){return this.isEqual(e,s)}equalsTols(e,s,i){return F(0),!1}divThis(e){return this.x/=e,this.y/=e,this.z/=e,this}subThis(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}setSub(e,s){return this.x=e.x-s.x,this.y=e.y-s.y,this.z=e.z-s.z,this}sub(e){return la.construct(this.x-e.x,this.y-e.y,this.z-e.z)}addThis(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}add(e){return this.clone().addThis(e)}setAdd(e,s){return this.x=e.x+s.x,this.y=e.y+s.y,this.z=e.z+s.z,this}mul(e){return la.construct(this.x*e,this.y*e,this.z*e)}dotProduct(e){return this.x*e.x+this.y*e.y+this.z*e.z}crossProductVector(e){const s=this.y*e.z-e.y*this.z,i=e.x*this.z-this.x*e.z,r=this.x*e.y-e.x*this.y;return new la(s,i,r)}setCrossProductVector(e,s){const i=e.y*s.z-s.y*e.z,r=s.x*e.z-e.x*s.z,n=e.x*s.y-s.x*e.y;return this.x=i,this.y=r,this.z=n,this}setScaled(e,s){return this.x=e*s.x,this.y=e*s.y,this.z=e*s.z,this}scaleThis(e){return this.x*=e,this.y*=e,this.z*=e,this}scaleZThis(e){return this.z*=e,this}setNAN(){return F(0),this}isNAN(){return Number.isNaN(this.x)||Number.isNaN(this.y)||Number.isNaN(this.z)}static getNAN(){return la.construct(Number.NaN,Number.NaN,Number.NaN)}isFinite(){return F(0),!1}isZero(){return this.x===0&&this.y===0&&this.z===0}norm(e){return F(0),0}sqrDistanceFromCenterToSpheroidSurface(e,s){return F(0),0}distanceFromCenterToSpheroidSurface(e,s){return Math.sqrt(this.sqrDistanceFromCenterToSpheroidSurface(e,s))}static getClosestCoordinate(e,s,i,r=!1){return F(0),0}compare(e){return this.y<e.y?-1:this.y>e.y?1:this.x<e.x?-1:this.x>e.x?1:this.z<e.z?-1:this.z>e.z?1:0}compareXYZ(e){return F(0),0}negateThis(){this.x=-this.x,this.y=-this.y,this.z=-this.z}static averageFast(e,s){return F(0),{}}static average(e,s){return F(0),{}}static size(){return la.dimensions}static lerp(e,s,i){const r=new la;return hJe(e,s,i,r),r}static slerp(e,s,i){return F(0),{}}static compareVectors(e,s){return F(0),0}static selectRightHandedBasisFromNormal(e,s,i){const r=e.getUnitVector(),n=r.createAPerpendicular(),o=new la;o.setCrossProductVector(r,n),o.normalizeThis(),s.setCoordsPoint3D(n),i.setCoordsPoint3D(o)}createAPerpendicular(){const e=[this.crossProductVector(new la(0,0,1)),this.crossProductVector(new la(1,0,0)),this.crossProductVector(new la(0,1,0))],s=[e[0].sqrLength(),e[1].sqrLength(),e[2].sqrLength()],i=e[s.reduce((r,n,o)=>s[r]>s[o]?r:o,0)];return i.normalizeThis(),i}calculateAngle(e){return F(0),0}static crossDotSign(e,s,i){return F(0),0}static isBisectorRobust(e,s,i){return F(0),0}static compareZOrder(e,s){return F(0),!1}};gt.dimensions=3;class Ql{static constructEmpty(){return new Ql(Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN)}constructor(e,s,i,r,n,o){this.m_EnvelopeType=3,this.xmin=e,this.ymin=s,this.zmin=i,this.xmax=r,this.ymax=n,this.zmax=o,this.normalize()}inflate(e){this.inflateCoords(e,e,e)}inflateCoords(e,s,i){F(0)}getEnvelope2D(){return new X(this.xmin,this.ymin,this.xmax,this.ymax)}getEnvelopeZs(){return new de(this.zmin,this.zmax)}setEmptyZ(){this.zmin=Number.NaN,this.zmax=Number.NaN}normalize(){let e=!1;this.xmin<=this.xmax||(this.xmax=be(this.xmin,this.xmin=this.xmax),e=!0),this.ymin<=this.ymax||(this.ymax=be(this.ymin,this.ymin=this.ymax),e=!0),!e||this.xmin<=this.xmax&&this.ymin<=this.ymax?this.zmin<=this.zmax||(this.zmax=be(this.zmin,this.zmin=this.zmax),this.zmin<=this.zmax||this.setEmptyZ()):this.setEmpty()}isEmpty(){return Number.isNaN(this.xmin)||Number.isNaN(this.ymin)||Number.isNaN(this.xmax)||Number.isNaN(this.ymax)}isEmptyZ(){return Number.isNaN(this.zmin)||Number.isNaN(this.zmax)}setEmpty(){this.xmin=Number.NaN,this.ymin=Number.NaN,this.zmin=Number.NaN,this.xmax=Number.NaN,this.ymax=Number.NaN,this.zmax=Number.NaN}mergeEnv3D(e){e.isEmpty()||(this.mergeCoords(e.xmin,e.ymin,e.zmin),this.mergeCoords(e.xmax,e.ymax,e.zmax))}mergeNe(e){this.mergeNeCoords(e.x,e.y,e.z)}mergeNeCoords(e,s,i){this.xmin>e?this.xmin=e:this.xmax<e&&(this.xmax=e),this.ymin>s?this.ymin=s:this.ymax<s&&(this.ymax=s),this.zmin>i?this.zmin=i:this.zmax<i&&(this.zmax=i)}mergeCoords(e,s,i){this.isEmpty()?(this.xmin=e,this.xmax=e,this.ymin=s,this.ymax=s,this.zmin=i,this.zmax=i):(this.isEmptyZ()&&(this.zmin=i,this.zmax=i),this.mergeNeCoords(e,s,i))}setCoords(e,s,i,r,n,o){this.xmin=e,this.ymin=s,this.zmin=i,this.xmax=r,this.ymax=n,this.zmax=o,this.normalize()}sqrDistanceEnvelope3DAndPoints(e,s,i,r=1){return F(0),0}sqrMaxDistance(e,s=1){return F(0),0}}const Ov=-559038737;var jf=Es;function cR(t,e,s){switch(t){case 0:return new X3(e,s);case 1:return new ag(e,s);case 2:return new Qs(e,s);case 3:throw new Error("64 bit int attribute stream not implemented");case 4:return new Ob(e,s);default:ee("")}}function C9(t,e){const s=jf.getComponentCount(t);return cR(jf.getPersistence(t),e*s,jf.getDefaultValue(t))}function rN(t,e){const s=jf.getComponentCount(t);return cR(jf.getPersistence(t),e*s)}function yn(t,e){return new Qs(t,e)}function Oh(t,e){return new Ob(t,e)}function fa(t,e){return new ag(t,e)}class Rd{size(){return this.m_size}checkResize(e,s){e>this.m_size&&this.resize(e,s)}resize(e,s){if((e=Math.trunc(e))===this.m_size)return;const i=!!s||Number.isNaN(s);if(e<this.m_a.length)this.m_a.length>Rd.s_resizeMin&&1.25*e<this.m_a.length&&(this.m_a=this.m_a.slice(0,e)),i&&e>this.m_size&&this.m_a.fill(s,this.m_size,e);else if(e>=this.m_a.length){const r=1.25*e,n=new this.m_a.constructor(r);n.set(this.m_a),this.m_a=n,i&&this.m_a.fill(s,this.m_size,e)}this.m_size=e}resizeRounded(e,s){return this.resize(e,s)}reserve(e){}read(e){return this.m_a[e]}readAsDbl(e){return this.read(e)}write(e,s){this.m_a[e]=s}writeAsDbl(e,s){this.write(e,s)}setRange(e,s,i){(s<0||i<0||i+s>this.size())&&ee(),this.m_a.fill(e,s,s+i)}add(e){this.resize(this.m_size+1),this.m_a[this.m_size-1]=e}addArray(e,s){const i=this.m_size;s===void 0?(this.resize(this.m_size+e.length),this.m_a.set(e,i)):(this.resize(this.m_size+s),this.m_a.set(e.slice(0,s),i))}equals(e,s,i,r){return this.getPersistence()!==e.getPersistence()?!1:JJe(this,e,s,i,r)}insertRange(e,s,i,r){const n=this.m_size;this.checkResize(Math.max(0,r)+i),this.m_a.copyWithin(e+i,e,r>=0?r:n),this.m_a.fill(s,e,e+i)}readRange(e,s){return this.m_a.slice(e,e+s)}insertRangeFromStream(e,s,i,r,n,o,a){F(this.getPersistence()===s.getPersistence());const l=s,u=this.m_size;r&&this.checkResize(Math.max(0,a)+r),this.m_a.copyWithin(e+r,e,a>=0?a:u),this.m_a.set(l.readRange(i,r),e),n||this.reverseRange(e,r,o)}writeRange(e,s,i,r,n,o){F(this.getPersistence()===i.getPersistence());const a=i;if((e<0||s<0||r<0)&&ee(),a.size()<r+s&&ee(),s===0)return;this.size()<s+e&&this.resize(s+e);const l=a.m_a.subarray(r,r+s);KJe(this.m_a,e,s,l)}insertAttributes(e,s,i,r){const n=jf.getComponentCount(i);this.m_a.copyWithin(e+n,e,r>=0?r:this.m_size);for(let o=0;o<n;o++)this.m_a[e+o]=s.getAttributeAsDbl(i,o)}insertAttributesFromPoints(e,s,i,r,n){F(jf.getPersistence(r)===this.getPersistence());const o=jf.getComponentCount(r),a=this.m_size;if(this.checkResize(Math.max(0,n)+o*i),this.m_a.copyWithin(e+o*i,e,n>=0?n:a),r===0){const l=new M;for(let u=e,c=0;c<i;c++,u+=2)s[c].queryXY(l),this.m_a[u]=l.x,this.m_a[u+1]=l.y}else if(o===1)for(let l=e,u=0;u<i;u++,l++)this.m_a[l]=s[u].getAttributeAsDbl(r,0);else for(let l=e,u=0;u<i;u++,l+=o)for(let c=0;c<o;c++)this.m_a[l+c]=s[u].getAttributeAsDbl(r,c)}eraseRange(e,s,i){this.m_size<e+s&&ee(),this.m_a.copyWithin(e,e+s),this.m_size-=s}reverseRange(e,s,i){if((i<1||s%i!=0)&&ee(),this.m_a.subarray(e,e+s).reverse(),i>1)for(let r=e,n=e+s;r<n;r+=i){let o=r,a=r+i-1;for(;o<a;){const l=this.m_a[o];this.m_a[o]=this.m_a[a],this.m_a[a]=l,o++,a--}}}rotate(e,s,i){(s<e||s>i||e>i)&&bt("rotate"),s!==e&&s!==i&&(this.reverseRange(e,s-e,1),this.reverseRange(s,i-s,1),this.reverseRange(e,i-e,1))}sort(e,s,i){this.m_a.subarray(e,s).sort(i)}constructor(e){if(e.move)this.m_a=e.move.m_a,this.m_size=e.move.m_size,e.move.m_a=e.move.m_a.slice(0,0),e.move.m_size=0;else if(e.copy)this.m_size=e.copy.m_size,e.maxSize&&(this.m_size=Math.min(e.maxSize,this.m_size)),this.m_a=e.copy.m_a.slice(0,this.m_size);else{const s=Math.max(e.size,Rd.s_constructMin);this.m_a=new e.ctor(s),(e.defaultValue||Number.isNaN(e.defaultValue))&&this.m_a.fill(e.defaultValue),this.m_size=e.size}}}Rd.s_constructMin=2,Rd.s_resizeMin=30;class Ob extends Rd{setBits(e,s){this.m_a[e]|=s}clearBits(e,s){this.m_a[e]&=~s}getPersistence(){return 4}clone(){return new Ob({ctor:Int8Array,copy:this})}restrictedClone(e){return new Ob({ctor:Int8Array,copy:this,maxSize:e})}constructor(e,s){super(typeof e=="number"?{ctor:Int8Array,size:e,defaultValue:s}:e)}}class Qs extends Rd{getPersistence(){return 2}clone(){return new Qs({ctor:Int32Array,copy:this})}restrictedClone(e){return new Qs({ctor:Int32Array,copy:this,maxSize:e})}write(e,s){F(s<=Qr()),super.write(e,s)}constructor(e,s){super(typeof e=="number"?{ctor:Int32Array,size:e,defaultValue:s}:e)}}class X3 extends Rd{getPersistence(){return 0}clone(){return new X3({ctor:Float32Array,copy:this})}restrictedClone(e){return new X3({ctor:Float32Array,copy:this,maxSize:e})}constructor(e,s){super(typeof e=="number"?{ctor:Float32Array,size:e,defaultValue:s}:e)}}class ag extends Rd{getPersistence(){return 1}getArray(){return this.m_a}applyTransformation(e,s,i){(1&s||s+2*i>this.size())&&ee();const r=s===0?this.m_a:this.m_a.subarray(s);e.transformInterleavedPoints(r,i,r)}readPoint2D(e){const s=this.m_a[e],i=this.m_a[e+1];return new M(s,i)}queryPoint2D(e,s){return s.x=this.m_a[e],s.y=this.m_a[e+1],s}writePoint2D(e,s){this.write(e,s.x),this.write(e+1,s.y)}insert(e,s,i){this.checkResize(i+2),this.m_a.copyWithin(e+2,e,i),this.m_a[e]=s.x,this.m_a[e+1]=s.y}insertRangeFromPoints(e,s,i,r,n,o){const a=this.m_size;if(this.checkResize(Math.max(o,0)+2*r),this.m_a.copyWithin(e+2*r,e,o>=0?o:a),n)for(let l=i,u=e,c=0;c<r;++c,++l){const h=s[l];this.m_a[u++]=h.x,this.m_a[u++]=h.y}else for(let l=i+r-1,u=e,c=0;c<r;++c,--l){const h=s[l];this.m_a[u++]=h.x,this.m_a[u++]=h.y}}queryRange(e,s,i,r,n){if((e<0||s<0)&&ee(),!r&&(n<=0||s%n!=0)&&ee(),s===0)return;if(s===1)return void(i[0]=this.m_a[e]);const o=this.m_a.subarray(e,e+s);i.set(o)}writeRangeFromArray(e,s,i,r,n){if((e<0||s<0)&&ee(),s===0)return;if(s===1)return void(this.m_a[e]=i[0]);let o=i;s<i.length&&(o=i.subarray(0,s)),this.m_a.set(o,e)}clone(){return new ag({ctor:Float64Array,copy:this})}restrictedClone(e){return new ag({ctor:Float64Array,copy:this,maxSize:e})}constructor(e,s){super(typeof e=="number"?{ctor:Float64Array,size:e,defaultValue:s}:e)}}function JJe(t,e,s,i,r){if(t.getPersistence()!==e.getPersistence())return!1;const n=t.getPersistence()<=1,o=t.size(),a=e.size();if(i>o||i>a)return!1;if(r)if(n){for(let l=s;l<i;l++)if(!wx(t.read(l),e.read(l),r))return!1}else for(let l=s;l<i;l++){let u=t.read(l)-e.read(l);if(u<0&&(u=-u),u>r)return!1}else for(let l=s;l<i;l++){const u=t.read(l),c=e.read(l);if(u!==c){if(n&&Number.isNaN(u)&&Number.isNaN(c))continue;return!1}}return!0}function KJe(t,e,s,i,r,n){if((e<0||s<0)&&ee(),s===0)return;if(s===1)return void(t[e]=i[0]);let o=i;s<i.length&&(o=i.subarray(0,s)),t.set(o,e)}class Jc{constructor(){this.m_minValue=-1,this.m_maxValue=-1,this.m_dy=Number.NaN,this.m_buckets=new Qs(0),this.m_bucketedIndices=new Qs(0)}static sortEx(e,s,i,r,n=32){if(i-s<=n)return void r.userSort(s,i,e);new Jc().sort(e,s,i,r,n)}sort(e,s,i,r,n=32){if(i-s<=n)return void r.userSort(s,i,e);let o=!0,a=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let c=s;c<i;c++){const h=r.getValue(e.read(c));h<a&&(a=h),h>l&&(l=h)}if(this.reset(i-s,a,l,i-s)){for(let h=s;h<i;h++){const m=e.read(h),f=r.getValue(m),g=this.getBucket(f);this.m_buckets.write(g,this.m_buckets.read(g)+1),this.m_bucketedIndices.write(h-s,m)}let c=this.m_buckets.read(0);this.m_buckets.write(0,0);for(let h=1,m=this.m_buckets.size();h<m;h++){const f=this.m_buckets.read(h);this.m_buckets.write(h,c),c+=f}for(let h=s;h<i;h++){const m=this.m_bucketedIndices.read(h-s),f=r.getValue(m),g=this.getBucket(f),v=this.m_buckets.read(g);e.write(v+s,m),this.m_buckets.write(g,v+1)}o=!1}if(o)return void r.userSort(s,i,e);let u=0;for(let c=0,h=this.m_buckets.size();c<h;c++){const m=u;u=this.m_buckets.read(c),u>m&&r.userSort(s+m,s+u,e)}this.m_buckets.size()>100&&(this.m_buckets.resize(0),this.m_bucketedIndices.resize(0))}reset(e,s,i,r){if(e<2||i===s)return!1;const n=Math.min(Jc.c_maxBuckets,e);return this.m_buckets.resize(n),this.m_buckets.setRange(0,0,this.m_buckets.size()),this.m_minValue=s,this.m_maxValue=i,this.m_bucketedIndices.resize(r),this.m_dy=(i-s)/(n-1),!0}getBucket(e){return Math.trunc((e-this.m_minValue)/this.m_dy)}getBucketCount(){return this.m_buckets.size()}}Jc.c_maxBuckets=65536;class et{constructor(e){this.m_buffer=null,this.m_firstFree=-1,this.m_last=0,this.m_size=0,this.m_capacity=0,this.m_bufferSize=0,this.m_stride=0,this.m_stride=e,this.m_realStride=e,this.m_blockSize=Math.trunc(et.st_realBlockSize/this.m_realStride)}dbgdelete_(e){return this.m_buffer[e>>et.st_blockPower][1+(e&et.st_blockMask)]=et.st_deadVertex,!0}deleteElement(e){(e>>et.st_blockPower)*this.m_blockSize*this.m_realStride+(e&et.st_blockMask)<this.m_last*this.m_realStride?(this.m_buffer[e>>et.st_blockPower][e&et.st_blockMask]=this.m_firstFree,this.m_firstFree=e):this.m_last--,this.m_size--}getField(e,s){return this.m_buffer[e>>et.st_blockPower][(e&et.st_blockMask)+s]}setField(e,s,i){this.m_buffer[e>>et.st_blockPower][(e&et.st_blockMask)+s]=i}getStride(){return this.m_stride}newElement(){let e=this.m_firstFree;if(e===-1){if(this.m_last===this.m_capacity){const r=this.m_capacity!==0?Math.trunc(2*(this.m_capacity+1)):1;this.grow(r)}e=(this.m_last/this.m_blockSize<<et.st_blockPower)+this.m_last%this.m_blockSize*this.m_realStride,this.m_last++}else this.m_firstFree=this.m_buffer[e>>et.st_blockPower][e&et.st_blockMask];this.m_size++;const s=this.m_buffer[e>>et.st_blockPower],i=e&et.st_blockMask;for(let r=0;r<this.m_stride;r++)s[i+r]=-1;return e}elementToIndex(e){return(e>>et.st_blockPower)*this.m_blockSize+(e&et.st_blockMask)/this.m_realStride}deleteAll(e){this.m_firstFree=-1,this.m_last=0,this.m_size=0,e&&(this.m_buffer=null,this.m_capacity=0)}size(){return this.m_size}setCapacity(e){e>this.m_capacity&&this.grow(e)}capacity(){return this.m_capacity}swap(e,s){const i=this.m_buffer[e>>et.st_blockPower],r=this.m_buffer[s>>et.st_blockPower],n=e&et.st_blockMask,o=s&et.st_blockMask;for(let a=0;a<this.m_stride;a++){const l=i[n+a];i[n+a]=r[o+a],r[o+a]=l}}swapField(e,s,i){const r=this.m_buffer[e>>et.st_blockPower],n=this.m_buffer[s>>et.st_blockPower],o=(e&et.st_blockMask)+i,a=(s&et.st_blockMask)+i,l=r[o];r[o]=n[a],n[a]=l}static impossibleIndex2(){return-2}static impossibleIndex3(){return-3}static isValidElement(e){return e>=0}ensureBufferBlocksCapacity(e){if(this.m_buffer.length<e){const s=new Array(e);for(let i=0;i<this.m_buffer.length;i++)s[i]=this.m_buffer[i];this.m_buffer=s}}grow(e){this.m_buffer===null&&(this.m_bufferSize=0,this.m_buffer=new Array(8));const s=Math.trunc((e+this.m_blockSize-1)/this.m_blockSize);if(this.ensureBufferBlocksCapacity(s),s===1){let i=0;const r=e*this.m_realStride;for(;r>et.st_sizes[i];)i++;const n=new Int32Array(et.st_sizes[i]);this.m_bufferSize===1?(n.set(this.m_buffer[0]),this.m_buffer[0]=n):(this.m_buffer[this.m_bufferSize]=n,this.m_bufferSize++),this.m_capacity=Math.trunc(n.length/this.m_realStride)}else{if(this.m_bufferSize===1&&this.m_buffer[0].length<et.st_realBlockSize){const i=new Int32Array(et.st_realBlockSize);i.set(this.m_buffer[0]),this.m_buffer[0]=i,this.m_capacity=this.m_blockSize}for(;this.m_bufferSize<s;)this.m_buffer[this.m_bufferSize++]=new Int32Array(et.st_realBlockSize),this.m_capacity+=this.m_blockSize}}}function eKe(t,e){return{element:t,box:e.clone()}}et.st_realBlockSize=16384,et.st_blockMask=16383,et.st_blockPower=14,et.st_sizes=[16,32,64,128,256,512,1024,2048,4096,8192,16384],et.st_deadVertex=-2125315821;class Ln{constructor(e,s,i){this.m_extent=new X,this.m_dataExtent=new X,this.m_childExtents=[new X,new X,new X,new X],this.m_elementNodes=new et(4),this.m_data=[],this.m_freeData=[],this.m_root=-1,this.m_height=8,i===void 0&&(i=!1),this.m_quadTreeNodes=new et(i?11:10),this.m_bStoreDuplicates=i,this.reset_(e,s)}reset(e,s){this.m_quadTreeNodes.deleteAll(!1),this.m_elementNodes.deleteAll(!1),this.m_data.length=0,this.m_freeData.length=0,this.reset_(e,s)}insert(e,s){if(this.m_root===-1&&this.createRoot_(),this.m_bStoreDuplicates){const r=this.insertDuplicates_(e,s,0,this.m_extent,this.m_root,!1,-1);return r!==-1&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:s}):this.m_dataExtent.mergeEnvelope2D(s)),r}const i=this.insert_(e,s,0,this.m_extent,this.m_root,!1,-1);return i!==-1&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:s}):this.m_dataExtent.mergeEnvelope2D(s)),i}insertEx(e,s,i){if(this.m_root===-1&&this.createRoot_(),this.m_bStoreDuplicates){const l=this.insertDuplicates_(e,s,0,this.m_extent,this.m_root,!1,-1);return l!==-1&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:s}):this.m_dataExtent.mergeEnvelope2D(s)),l}let r;r=i===-1?this.m_root:this.getQuad_(i);const n=this.getHeight(r),o=this.getExtent(r),a=this.insert_(e,s,n,o,r,!1,-1);return a!==-1&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:s}):this.m_dataExtent.mergeEnvelope2D(s)),a}removeElement(e){F(0)}getElement(e){return this.getElementValue_(this.getData_(e))}getElementAtIndex(e){return F(0),0}getElementExtent(e){const s=this.getData_(e);return this.getBoundingBoxValue_(s).clone()}getElementExtentAtIndex(e){return F(0),{}}getDataExtent(){return this.m_dataExtent.clone()}getQuadTreeExtent(){return F(0),{}}getHeight(e){return this.m_quadTreeNodes.getField(e,6)>>Ln.m_heightBitShift}getMaxHeight(){return this.m_height}getExtent(e){const s=new X;if(s.setCoords({env2D:this.m_extent}),e===this.m_root)return s;const i=[];let r=e;do i.push(this.getQuadrant_(r)),r=this.getParent_(r);while(r!==this.m_root);const n=i.length;for(let o=0;o<n;o++){const a=i.at(-1);i.pop(),a===0?(s.xmin=.5*(s.xmin+s.xmax),s.ymin=.5*(s.ymin+s.ymax)):a===1?(s.xmax=.5*(s.xmin+s.xmax),s.ymin=.5*(s.ymin+s.ymax)):a===2?(s.xmax=.5*(s.xmin+s.xmax),s.ymax=.5*(s.ymin+s.ymax)):(s.xmin=.5*(s.xmin+s.xmax),s.ymax=.5*(s.ymin+s.ymax))}return s}getQuad(e){return this.getQuad_(e)}getElementCount(){return this.m_root===-1?0:this.getSubTreeElementCount_(this.m_root)}getSubTreeElementCount(e){return this.getSubTreeElementCount_(e)}getContainedSubTreeElementCount(e){return this.m_bStoreDuplicates?this.getContainedSubTreeElementCount_(e):this.getSubTreeElementCount_(e)}getIntersectionCount(e,s,i){if(this.m_root===-1)return 0;const r=new X;r.setCoords({env2D:e}),r.inflateCoords(s,s);const n=[],o=[];n.push(this.m_root),o.push(this.m_extent.clone());const a=ne(X,4);let l=0;for(;n.length>0;){let u=!1;const c=n.at(-1),h=o.at(-1);if(n.pop(),o.pop(),r.containsEnvelope(h)){if(l+=this.getSubTreeElementCount(c),i>0&&l>=i)return i}else if(r.isIntersecting(h)){for(let m=this.getFirstElement_(c);m!==-1;m=this.getNextElement_(m)){const f=this.getData_(m);if(this.getBoundingBoxValue_(f).isIntersecting(r)&&(l++,i>0&&l>=i))return i}u=this.getHeight(c)+1<=this.m_height}if(u){Ln.setChildExtents_(h,a);for(let m=0;m<4;m++){const f=this.getChild_(c,m);f!==-1&&this.getSubTreeElementCount_(f)>0&&r.isIntersecting(a[m])&&(n.push(f),o.push(a[m].clone()))}}}return l}hasData(e,s){return this.getIntersectionCount(e,s,1)>=1}getIterator(e,s){return new fie(this,e,s)}getIteratorForQT(){return new fie(this)}getSortedIterator(e,s){return new gie(this.getIterator(e,s))}getSortedIteratorForQT(){return new gie(this.getIteratorForQT())}visitLeavesNearest(e,s,i,r){F(0)}reset_(e,s){(s<0||s>127)&&ee("invalid height"),this.m_height=s,this.m_extent.setCoords({env2D:e}),this.m_dataExtent.setEmpty(),this.m_root=-1}insert_(e,s,i,r,n,o,a){if(!r.containsEnvelope(s))return i===0?-1:this.insert_(e,s,0,this.m_extent,this.m_root,o,a);if(!o)for(let h=n;h!==-1;h=this.getParent_(h))this.setSubTreeElementCount_(h,this.getSubTreeElementCount_(h)+1);const l=new X;l.setCoords({env2D:r});let u,c=n;for(u=i;u<this.m_height&&this.canPushDown_(c);u++){Ln.setChildExtents_(l,this.m_childExtents);let h=!1;for(let m=0;m<4;m++)if(this.m_childExtents[m].containsEnvelope(s)){h=!0;let f=this.getChild_(c,m);f===-1&&(f=this.createChild_(c,m)),this.setSubTreeElementCount_(f,this.getSubTreeElementCount_(f)+1),c=f,l.setCoords({env2D:this.m_childExtents[m]});break}if(!h)break}return this.insertAtQuad_(e,s,u,l,c,o,n,a,-1)}insertDuplicates_(e,s,i,r,n,o,a){if(!o){if(!r.containsEnvelope(s))return-1;this.setSubTreeElementCount_(n,this.getSubTreeElementCount_(n)+1),this.setContainedSubTreeElementCount_(n,this.getContainedSubTreeElementCount_(n)+1)}const l=Math.max(s.width(),s.height());let u=-1;const c=[],h=[],m=[];c.push(n),h.push(r.clone()),m.push(i);const f=ne(X,4);for(;c.length>0;){let g=!1;const v=c.at(-1),b=h.at(-1),w=m.at(-1);if(c.pop(),h.pop(),m.pop(),w+1<this.m_height&&this.canPushDown_(v)&&l<=Math.max(b.width(),b.height())/2&&(g=!0),g){Ln.setChildExtents_(b,f);let S=!1;for(let T=0;T<4;T++)if(S=f[T].containsEnvelope(s),S){let P=this.getChild_(v,T);P===-1&&(P=this.createChild_(v,T)),c.push(P),h.push(f[T].clone()),m.push(w+1),this.setSubTreeElementCount_(P,this.getSubTreeElementCount_(P)+1),this.setContainedSubTreeElementCount_(P,this.getContainedSubTreeElementCount_(P)+1);break}if(!S){for(let T=0;T<4;T++)if(f[T].isIntersecting(s)){let P=this.getChild_(v,T);P===-1&&(P=this.createChild_(v,T)),c.push(P),h.push(f[T].clone()),m.push(w+1),this.setSubTreeElementCount_(P,this.getSubTreeElementCount_(P)+1)}}}else u=this.insertAtQuad_(e,s,w,b,v,o,n,a,u),o=!1}return 0}insertAtQuad_(e,s,i,r,n,o,a,l,u){this.getFirstElement_(n);const c=this.getLastElement_(n);let h=-1;if(o){if(n===a)return l;this.disconnectElementHandle_(l),h=l}else u===-1?(h=this.createElement_(),this.setDataValues_(this.getData_(h),e,s)):h=this.createElementFromDuplicate_(u);return this.setQuad_(h,n),c!==-1?(this.setPrevElement_(h,c),this.setNextElement_(c,h)):this.setFirstElement_(n,h),this.setLastElement_(n,h),this.setLocalElementCount_(n,this.getLocalElementCount_(n)+1),this.canFlush_(n)&&this.flush_(i,r,n),h}static setChildExtents_(e,s){const i=.5*(e.xmin+e.xmax),r=.5*(e.ymin+e.ymax);s[0].setCoords({xmin:i,ymin:r,xmax:e.xmax,ymax:e.ymax}),s[1].setCoords({xmin:e.xmin,ymin:r,xmax:i,ymax:e.ymax}),s[2].setCoords({xmin:e.xmin,ymin:e.ymin,xmax:i,ymax:r}),s[3].setCoords({xmin:i,ymin:e.ymin,xmax:e.xmax,ymax:r})}disconnectElementHandle_(e){const s=this.getQuad_(e),i=this.getFirstElement_(s),r=this.getLastElement_(s),n=this.getPrevElement_(e),o=this.getNextElement_(e);i===e?(o!==-1?this.setPrevElement_(o,-1):this.setLastElement_(s,-1),this.setFirstElement_(s,o)):r===e?(this.setNextElement_(n,-1),this.setLastElement_(s,n)):(this.setPrevElement_(o,n),this.setNextElement_(n,o)),this.setPrevElement_(e,-1),this.setNextElement_(e,-1),this.setLocalElementCount_(s,this.getLocalElementCount_(s)-1)}canFlush_(e){return this.getLocalElementCount_(e)===Ln.m_flushingCount&&!this.hasChildren_(e)}flush_(e,s,i){let r;const n=new X;let o=this.getFirstElement_(i),a=-1,l=-1;do l=this.getData_(o),r=this.getElementValue_(l),n.setCoords({env2D:this.getBoundingBoxValue_(l)}),a=this.getNextElement_(o),this.m_bStoreDuplicates?this.insertDuplicates_(r,n,e,s,i,!0,o):this.insert_(r,n,e,s,i,!0,o),o=a;while(o!==-1)}canPushDown_(e){return this.getLocalElementCount_(e)>=Ln.m_flushingCount||this.hasChildren_(e)}hasChildren_(e){return this.getChild_(e,0)!==-1||this.getChild_(e,1)!==-1||this.getChild_(e,2)!==-1||this.getChild_(e,3)!==-1}createChild_(e,s){const i=this.m_quadTreeNodes.newElement();return this.setChild_(e,s,i),this.setSubTreeElementCount_(i,0),this.setLocalElementCount_(i,0),this.setParent_(i,e),this.setHeightAndQuadrant_(i,this.getHeight_(e)+1,s),this.m_bStoreDuplicates&&this.setContainedSubTreeElementCount_(i,0),i}createRoot_(){this.m_root=this.m_quadTreeNodes.newElement(),this.setSubTreeElementCount_(this.m_root,0),this.setLocalElementCount_(this.m_root,0),this.setHeightAndQuadrant_(this.m_root,0,0),this.m_bStoreDuplicates&&this.setContainedSubTreeElementCount_(this.m_root,0)}createElement_(){const e=this.m_elementNodes.newElement();let s;return this.m_freeData.length>0?(s=this.m_freeData.at(-1),this.m_freeData.pop()):(s=this.m_data.length,this.m_data.length=s+1),this.setData_(e,s),e}createElementFromDuplicate_(e){const s=this.m_elementNodes.newElement(),i=this.getData_(e);return this.setData_(s,i),s}freeElementAndBoxNode_(e){F(0)}getChild_(e,s){return this.m_quadTreeNodes.getField(e,s)}setChild_(e,s,i){this.m_quadTreeNodes.setField(e,s,i)}getFirstElement_(e){return this.m_quadTreeNodes.getField(e,4)}setFirstElement_(e,s){this.m_quadTreeNodes.setField(e,4,s)}getLastElement_(e){return this.m_quadTreeNodes.getField(e,5)}setLastElement_(e,s){this.m_quadTreeNodes.setField(e,5,s)}getQuadrant_(e){return this.m_quadTreeNodes.getField(e,6)&Ln.m_quadrantMask}getHeight_(e){return this.m_quadTreeNodes.getField(e,6)>>Ln.m_heightBitShift}setHeightAndQuadrant_(e,s,i){const r=s<<Ln.m_heightBitShift|i;this.m_quadTreeNodes.setField(e,6,r)}getLocalElementCount_(e){return this.m_quadTreeNodes.getField(e,7)}setLocalElementCount_(e,s){this.m_quadTreeNodes.setField(e,7,s)}getSubTreeElementCount_(e){return this.m_quadTreeNodes.getField(e,8)}setSubTreeElementCount_(e,s){this.m_quadTreeNodes.setField(e,8,s)}getParent_(e){return this.m_quadTreeNodes.getField(e,9)}setParent_(e,s){this.m_quadTreeNodes.setField(e,9,s)}getContainedSubTreeElementCount_(e){return this.m_quadTreeNodes.getField(e,10)}setContainedSubTreeElementCount_(e,s){this.m_quadTreeNodes.setField(e,10,s)}getData_(e){return this.m_elementNodes.getField(e,0)}setData_(e,s){this.m_elementNodes.setField(e,0,s)}getPrevElement_(e){return this.m_elementNodes.getField(e,1)}getNextElement_(e){return this.m_elementNodes.getField(e,2)}setPrevElement_(e,s){this.m_elementNodes.setField(e,1,s)}setNextElement_(e,s){this.m_elementNodes.setField(e,2,s)}getQuad_(e){return this.m_elementNodes.getField(e,3)}setQuad_(e,s){this.m_elementNodes.setField(e,3,s)}getElementValue_(e){return this.m_data[e].element}getBoundingBoxValue_(e){return this.m_data[e].box}setDataValues_(e,s,i){this.m_data[e]=eKe(s,i)}}Ln.m_quadrantMask=3,Ln.m_heightBitShift=2,Ln.m_flushingCount=5;class fie{constructor(e,s,i){this.m_bLinear=!1,this.m_queryStart=new M,this.m_queryEnd=new M,this.m_queryBox=new X,this.m_tolerance=0,this.m_currentElementHandle=-1,this.m_nextElementHandle=-1,this.m_quadsStack=[],this.m_extentsStack=[],this.m_childExtents=[new X,new X,new X,new X],this.m_quadTree=e,s&&this.resetIterator(s,i)}resetIterator(e,s){if(s===void 0&&(s=0),e instanceof X)return this.m_quadsStack.length=0,this.m_extentsStack.length=0,this.m_currentElementHandle=-1,this.m_queryBox.setCoords({env2D:e}),this.m_queryBox.inflateCoords(s,s),this.m_tolerance=Number.NaN,void(this.m_quadTree.m_root!==-1&&this.m_queryBox.isIntersecting(this.m_quadTree.m_extent)?(this.m_quadsStack.push(this.m_quadTree.m_root),this.m_extentsStack.push(this.m_quadTree.m_extent.clone()),this.m_nextElementHandle=this.m_quadTree.getFirstElement_(this.m_quadTree.m_root),this.m_bLinear=!1):this.m_nextElementHandle=-1);if(this.m_quadsStack.length=0,this.m_extentsStack.length=0,this.m_currentElementHandle=-1,e.queryLooseEnvelope(this.m_queryBox),this.m_queryBox.inflateCoords(s,s),this.m_quadTree.m_root!==-1&&this.m_queryBox.isIntersecting(this.m_quadTree.m_extent)){const i=e.getGeometryType();if(this.m_bLinear=i===G.enumLine,this.m_bLinear){const r=e;this.m_queryStart.assign(r.getStartXY()),this.m_queryEnd.assign(r.getEndXY()),this.m_tolerance=s}else this.m_tolerance=Number.NaN;this.m_quadsStack.push(this.m_quadTree.m_root),this.m_extentsStack.push(this.m_quadTree.m_extent.clone()),this.m_nextElementHandle=this.m_quadTree.getFirstElement_(this.m_quadTree.m_root)}else this.m_nextElementHandle=-1}next(){if(this.m_quadsStack.length===0)return-1;this.m_currentElementHandle=this.m_nextElementHandle;const e=new M,s=new M,i=new X;let r=!1;for(;!r;){for(;this.m_currentElementHandle!==-1;){const n=this.m_quadTree.getData_(this.m_currentElementHandle);if(i.setCoords({env2D:this.m_quadTree.getBoundingBoxValue_(n)}),i.isIntersecting(this.m_queryBox)){if(!this.m_bLinear){r=!0;break}if(e.setCoordsPoint2D(this.m_queryStart),s.setCoordsPoint2D(this.m_queryEnd),i.inflateCoords(this.m_tolerance,this.m_tolerance),i.clipLine(e,s)>0){r=!0;break}}this.m_currentElementHandle=this.m_quadTree.getNextElement_(this.m_currentElementHandle)}if(this.m_currentElementHandle===-1){const n=this.m_quadsStack.at(-1),o=this.m_extentsStack.at(-1);Ln.setChildExtents_(o,this.m_childExtents),this.m_quadsStack.pop(),this.m_extentsStack.pop();for(let a=0;a<4;a++){const l=this.m_quadTree.getChild_(n,a);if(l!==-1&&this.m_quadTree.getSubTreeElementCount(l)>0&&this.m_childExtents[a].isIntersecting(this.m_queryBox))if(this.m_bLinear){e.setCoordsPoint2D(this.m_queryStart),s.setCoordsPoint2D(this.m_queryEnd);const u=new X;u.setCoords({env2D:this.m_childExtents[a]}),u.inflateCoords(this.m_tolerance,this.m_tolerance),u.clipLine(e,s)>0&&(this.m_quadsStack.push(l),this.m_extentsStack.push(this.m_childExtents[a].clone()))}else this.m_quadsStack.push(l),this.m_extentsStack.push(this.m_childExtents[a].clone())}if(this.m_quadsStack.length===0)return-1;this.m_currentElementHandle=this.m_quadTree.getFirstElement_(this.m_quadsStack.at(-1))}}return this.m_nextElementHandle=this.m_quadTree.getNextElement_(this.m_currentElementHandle),this.m_currentElementHandle}clone(){return F(0),{}}}class gie{constructor(e){this.m_bucketSort=new Jc,this.m_sortedHandles=new Qs(0),this.m_index=-1,this.m_quadTreeIteratorImpl=e}resetIterator(e,s){this.m_quadTreeIteratorImpl.resetIterator(e,s),this.m_sortedHandles.resize(0),this.m_index=-1}next(){if(this.m_index===-1){let e=-1;for(;(e=this.m_quadTreeIteratorImpl.next())!==-1;)this.m_sortedHandles.add(e);const s=this,i={userSort(r,n,o){o.sort(r,n,(a,l)=>s.m_quadTreeIteratorImpl.m_quadTree.getElement(a)-s.m_quadTreeIteratorImpl.m_quadTree.getElement(l))},getValue:r=>s.m_quadTreeIteratorImpl.m_quadTree.getElement(r)};this.m_bucketSort.sort(this.m_sortedHandles,0,this.m_sortedHandles.size(),i)}return this.m_index===this.m_sortedHandles.size()-1?-1:(this.m_index++,this.m_sortedHandles.read(this.m_index))}clone(){return F(0),{}}}class E0{constructor(e=!1){this.m_bNotifyOnActions=e}onDelete(e){}onSet(e){}onEndSearch(e){}onAddUniqueElementFailed(e){}onDeleteImpl(e,s){this.m_bNotifyOnActions&&this.onDelete(e.getElement(s))}onSetImpl(e,s){this.m_bNotifyOnActions&&this.onSet(e.getElement(s))}onAddUniqueElementFailedImpl(e){this.m_bNotifyOnActions&&this.onAddUniqueElementFailed(e)}onEndSearchImpl(e){this.m_bNotifyOnActions&&this.onEndSearch(e)}}class Xe{static st_nullNode(){return-1}constructor(){this.m_defaultTreap=-1,this.m_random=124234251,this.m_comparator=null,this.m_treapData=new et(7),this.m_treapCount=0,this.m_maxDepthEver=0,this.m_bBalancing=!0}setComparator(e){this.m_comparator=e}getComparator(){return this.m_comparator}disableBalancing(){this.m_bBalancing=!1}enableBalancing(){this.m_bBalancing||(F(this.m_treapCount<=1),this.rebalance(-1),this.m_bBalancing=!0)}isAutoBalancing(){return this.m_bBalancing}rebalance(e){if(this.m_bBalancing||(e===-1&&(e=this.m_defaultTreap),this.size(e)===0))return;const s=[];for(let i=this.getFirst(e);i!==-1;i=this.getNext(i))s.push(i),this.setParent_(i,-1),this.setRight_(i,-1),this.setLeft_(i,-1);this.setRoot_(-1,e),this.setFirst_(-1,e),this.setLast_(-1,e),this.setSize_(0,e),this.m_bBalancing=!0;for(const i of s)this.addBiggestElement_(i,e);this.m_bBalancing=!1}setCapacity(e){this.m_treapData.setCapacity(e)}createTreap(e){const s=this.m_treapData.newElement();return this.setSize_(0,s),this.setTreapData_(e,s),this.m_treapCount++,s}deleteTreap(e){this.m_treapData.deleteElement(e),this.m_treapCount--}addElement(e,s=-1){return s===-1&&(this.m_defaultTreap===Xe.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),s=this.m_defaultTreap),this.addElement_(e,0,s)}addUniqueElement(e,s=-1){return s===-1&&(this.m_defaultTreap===Xe.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),s=this.m_defaultTreap),this.addElement_(e,1,s)}addBiggestElement(e,s=-1){s===-1&&(this.m_defaultTreap===Xe.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),s=this.m_defaultTreap);const i=this.newNode_(e);return this.addBiggestElement_(i,s),i}addElementAtPosition(e,s,i,r,n,o=-1){if(o===-1&&(this.m_defaultTreap===Xe.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),o=this.m_defaultTreap),this.getRoot_(o)===Xe.st_nullNode()){const v=this.newNode_(i);return this.setRoot_(v,o),this.addToList_(-1,v,o),v}let a,l,u,c,h;if(n?(a=s!==Xe.st_nullNode()?this.m_comparator.compare(this,i,s):-1,l=e!==Xe.st_nullNode()?this.m_comparator.compare(this,i,e):1):(a=-1,l=1),r&&(a===0||l===0)){this.m_comparator.onAddUniqueElementFailedImpl(i);const v=a===0?s:e;return this.setDuplicateElement_(v,o),-1}h=s!==Xe.st_nullNode()&&e!==Xe.st_nullNode()?this.m_random>ub(this.m_random)>>1:s!==Xe.st_nullNode(),h?(c=a,u=s):(c=l,u=e);let m=-1,f=-1,g=!0;for(;;){if(c<0){const v=this.getLeft(u);if(v===Xe.st_nullNode()){f=u,m=this.newNode_(i),this.setLeft_(u,m),this.setParent_(m,u);break}u=v}else{const v=this.getRight(u);if(v===Xe.st_nullNode()){f=this.getNext(u),m=this.newNode_(i),this.setRight_(u,m),this.setParent_(m,u);break}u=v}g&&(c*=-1,g=!1)}return this.bubbleUp_(m),this.getParent(m)===Xe.st_nullNode()&&this.setRoot_(m,o),this.addToList_(f,m,o),m}replaceElementAtPosition(e,s,i,r,n=-1){if(r){const o=this.getNext(e);let a=-1;o!==Xe.st_nullNode()&&(a=this.m_comparator.compare(this,s,o));const l=this.getPrev(e);let u=-1;if(l!==Xe.st_nullNode()&&(u=this.m_comparator.compare(this,s,l)),i&&(a===0||u===0)){this.m_comparator.onAddUniqueElementFailedImpl(s);const c=a===0?o:l;return n===Xe.st_nullNode()&&(this.m_defaultTreap===Xe.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),n=this.m_defaultTreap),this.setDuplicateElement_(c,n),-1}}return this.setElement_(e,s),e}getDuplicateElement(e=-1){return e===-1?this.getDuplicateElement_(this.m_defaultTreap):this.getDuplicateElement_(e)}deleteNode(e,s=-1){this.m_comparator&&this.m_comparator.onDeleteImpl(this,e),s===-1&&(s=this.m_defaultTreap),this.m_bBalancing?this.deleteNode_(e,s):this.unbalancedDelete_(e,s)}search(e,s=-1){let i=this.getRoot(s);for(;i!==Xe.st_nullNode();){const r=this.m_comparator.compare(this,e,i);if(!r)return i;i=r<0?this.getLeft(i):this.getRight(i)}return this.m_comparator.onEndSearchImpl(e),Xe.st_nullNode()}searchLowerBound(e,s=-1){let i=this.getRoot(s),r=-1;for(;i!==Xe.st_nullNode();){const n=e.compare(this,i);if(!n)return i;n<0?i=this.getLeft(i):(r=i,i=this.getRight(i))}return r}searchUpperBound(e,s=-1){let i=this.getRoot(s),r=-1;for(;i!==Xe.st_nullNode();){const n=e.compare(this,i);if(!n)return i;n<0?(r=i,i=this.getLeft(i)):i=this.getRight(i)}return r}getElement(e){return this.m_treapData.getField(e,3)}getLeft(e){return this.m_treapData.getField(e,0)}getRight(e){return this.m_treapData.getField(e,1)}getParent(e){return this.m_treapData.getField(e,2)}getNext(e){return this.m_treapData.getField(e,6)}getPrev(e){return this.m_treapData.getField(e,5)}getFirst(e=-1){return e===-1?this.getFirst_(this.m_defaultTreap):this.getFirst_(e)}getLast(e=-1){return e===-1?this.getLast_(this.m_defaultTreap):this.getLast_(e)}getTreapData(e=-1){return e===-1?this.getTreapData_(this.m_defaultTreap):this.getTreapData_(e)}setElement(e,s){this.m_comparator!==null&&this.m_comparator.onSetImpl(this,e),this.setElement_(e,s)}getRoot(e=-1){return e===-1?this.getRoot_(this.m_defaultTreap):this.getRoot_(e)}clear(){this.m_treapData.deleteAll(!1),this.m_defaultTreap=Xe.st_nullNode(),this.m_treapCount=0,this.m_maxDepthEver=0}addToList_(e,s,i){let r;e!==-1?(r=this.getPrev(e),this.setPrev_(e,s)):r=this.getLast_(i),this.setPrev_(s,r),r!==-1&&this.setNext_(r,s),this.setNext_(s,e),e===this.getFirst_(i)&&this.setFirst_(s,i),e===-1&&this.setLast_(s,i),this.setSize_(this.getSize_(i)+1,i)}size(e=-1){return e===-1?this.getSize_(this.m_defaultTreap):this.getSize_(e)}getMaxDepth(e=-1){return this.getMaxDepthHelper_(this.getRoot(e))}getMaxDepthEver(){return this.m_maxDepthEver}static st_isValidNode(e){return et.isValidElement(e)}dbgCheck_(e){}getPriority_(e){return this.m_treapData.getField(e,4)}bubbleDown_(e){let s=this.getLeft(e),i=this.getRight(e);const r=this.getPriority_(e);for(;s!==Xe.st_nullNode()||i!==Xe.st_nullNode();){const n=s!==Xe.st_nullNode()?this.getPriority_(s):co(),o=i!==Xe.st_nullNode()?this.getPriority_(i):co();if(r<=Math.min(n,o))return;n<=o?this.rotateRight_(s):this.rotateLeft_(e),s=this.getLeft(e),i=this.getRight(e)}}bubbleUp_(e){if(!this.m_bBalancing)return;const s=this.getPriority_(e);let i=this.getParent(e);for(;i!==Xe.st_nullNode()&&this.getPriority_(i)>s;)this.getLeft(i)===e?this.rotateRight_(e):this.rotateLeft_(i),i=this.getParent(e)}rotateLeft_(e){const s=e,i=this.getRight(e);let r;this.setParent_(i,this.getParent(s)),this.setParent_(s,i),r=this.getLeft(i),this.setRight_(s,r),r!==Xe.st_nullNode()&&this.setParent_(r,s),this.setLeft_(i,s),r=this.getParent(i),r!==Xe.st_nullNode()&&(this.getLeft(r)===s?this.setLeft_(r,i):this.setRight_(r,i))}rotateRight_(e){const s=this.getParent(e),i=e;let r;this.setParent_(i,this.getParent(s)),this.setParent_(s,i),r=this.getRight(i),this.setLeft_(s,r),r!==Xe.st_nullNode()&&this.setParent_(r,s),this.setRight_(i,s),r=this.getParent(i),r!==Xe.st_nullNode()&&(this.getLeft(r)===s?this.setLeft_(r,i):this.setRight_(r,i))}setParent_(e,s){this.m_treapData.setField(e,2,s)}setLeft_(e,s){this.m_treapData.setField(e,0,s)}setRight_(e,s){this.m_treapData.setField(e,1,s)}setPriority_(e,s){this.m_treapData.setField(e,4,s)}setPrev_(e,s){this.m_treapData.setField(e,5,s)}setNext_(e,s){this.m_treapData.setField(e,6,s)}setRoot_(e,s){this.m_treapData.setField(s,0,e)}setFirst_(e,s){this.m_treapData.setField(s,1,e)}setLast_(e,s){this.m_treapData.setField(s,2,e)}setDuplicateElement_(e,s){this.m_treapData.setField(s,3,e)}setSize_(e,s){this.m_treapData.setField(s,4,e)}setTreapData_(e,s){this.m_treapData.setField(s,5,e)}getRoot_(e){return e===-1?Xe.st_nullNode():this.m_treapData.getField(e,0)}getFirst_(e){return e===-1?Xe.st_nullNode():this.m_treapData.getField(e,1)}getLast_(e){return e===-1?Xe.st_nullNode():this.m_treapData.getField(e,2)}getDuplicateElement_(e){return e===-1?Xe.st_nullNode():this.m_treapData.getField(e,3)}getSize_(e){return e===-1?0:this.m_treapData.getField(e,4)}getTreapData_(e){return this.m_treapData.getField(e,5)}newNode_(e){const s=this.m_treapData.newElement();return this.setPriority_(s,this.generatePriority_()),this.setElement_(s,e),s}freeNode_(e,s){e!==Xe.st_nullNode()&&this.m_treapData.deleteElement(e)}generatePriority_(){return this.m_random=ub(this.m_random),this.m_random&co()>>1}maxPriority(){return F(0),0}getMaxDepthHelper_(e){return e===Xe.st_nullNode()?0:1+Math.max(this.getMaxDepthHelper_(this.getLeft(e)),this.getMaxDepthHelper_(this.getRight(e)))}addElement_(e,s,i){if(this.getRoot(i)===Xe.st_nullNode()){const l=this.newNode_(e);return this.setRoot_(l,i),this.addToList_(-1,l,i),this.m_maxDepthEver=Math.max(this.m_maxDepthEver,1),l}let r=this.getRoot_(i),n=-1,o=-1,a=1;for(;;){const l=s===-1?1:this.m_comparator.compare(this,e,r);if(l<0){const u=this.getLeft(r);if(u===Xe.st_nullNode()){o=r,n=this.newNode_(e),this.setLeft_(r,n),this.setParent_(n,r);break}r=u}else{if(s===1&&l===0)return this.m_comparator.onAddUniqueElementFailedImpl(e),this.setDuplicateElement_(r,i),-1;const u=this.getRight(r);if(u===Xe.st_nullNode()){o=this.getNext(r),n=this.newNode_(e),this.setRight_(r,n),this.setParent_(n,r);break}r=u}a++}return this.bubbleUp_(n),this.getParent(n)===Xe.st_nullNode()&&this.setRoot_(n,i),this.addToList_(o,n,i),this.m_maxDepthEver=Math.max(a,this.m_maxDepthEver),n}removeFromList_(e,s){const i=this.getPrev(e),r=this.getNext(e);i!==-1?this.setNext_(i,r):this.setFirst_(r,s),r!==-1?this.setPrev_(r,i):this.setLast_(i,s),this.setSize_(this.getSize_(s)-1,s)}unbalancedDelete_(e,s){this.removeFromList_(e,s);let i=this.getLeft(e),r=this.getRight(e),n=this.getParent(e),o=e;if(i!==-1&&r!==-1){let l;this.m_random=ub(this.m_random),l=this.m_random>co()>>1?this.getNext(e):this.getPrev(e);const u=this.getParent(l)===e;this.m_treapData.swapField(e,l,0),this.m_treapData.swapField(e,l,1),this.m_treapData.swapField(e,l,2),n!==-1?this.getLeft(n)===e?this.setLeft_(n,l):this.setRight_(n,l):this.setRoot_(l,s),u?(i===l?(this.setLeft_(l,e),this.setParent_(r,l)):r===l&&(this.setRight_(l,e),this.setParent_(i,l)),this.setParent_(e,l),n=l):(this.setParent_(i,l),this.setParent_(r,l),n=this.getParent(e),o=l),i=this.getLeft(e),r=this.getRight(e),i!==-1&&this.setParent_(i,e),r!==-1&&this.setParent_(r,e)}const a=i!==-1?i:r;n===-1?this.setRoot_(a,s):this.getLeft(n)===o?this.setLeft_(n,a):this.setRight_(n,a),a!==-1&&this.setParent_(a,n),this.freeNode_(e,s)}deleteNode_(e,s){this.setPriority_(e,co());let i=Xe.st_nullNode(),r=Xe.st_nullNode();const n=this.getRoot_(s),o=n===e;if(o&&(i=this.getLeft(n),r=this.getRight(n),i===Xe.st_nullNode()&&r===Xe.st_nullNode()))return this.removeFromList_(n,s),this.freeNode_(n,s),void this.setRoot_(Xe.st_nullNode(),s);this.bubbleDown_(e);const a=this.getParent(e);a!==Xe.st_nullNode()&&(this.getLeft(a)===e?this.setLeft_(a,Xe.st_nullNode()):this.setRight_(a,Xe.st_nullNode())),this.removeFromList_(e,s),this.freeNode_(e,s),o&&this.setRoot_(i===Xe.st_nullNode()||this.getParent(i)!==Xe.st_nullNode()?r:i,s)}setElement_(e,s){this.m_treapData.setField(e,3,s)}addBiggestElement_(e,s){if(this.getRoot_(s)===Xe.st_nullNode())return this.setRoot_(e,s),void this.addToList_(-1,e,s);const i=this.getLast_(s);this.setRight_(i,e),this.setParent_(e,i),this.bubbleUp_(e),this.getParent(e)===Xe.st_nullNode()&&this.setRoot_(e,s),this.addToList_(-1,e,s)}}class Wr{constructor(e){this.m_lists=new et(6),this.m_listOfLists=Wr.st_nullNode(),e===void 0?(this.m_listNodes=new et(3),this.m_bStoreListIndexWithNode=!1):(this.m_listNodes=new et(e?4:3),this.m_bStoreListIndexWithNode=e)}freeNode_(e){this.m_listNodes.deleteElement(e)}newNode_(){return this.m_listNodes.newElement()}freeList_(e){F(0)}newList_(){return this.m_lists.newElement()}setPrev_(e,s){this.m_listNodes.setField(e,1,s)}setNext_(e,s){this.m_listNodes.setField(e,2,s)}setData_(e,s){F(0)}setList_(e,s){return this.m_listNodes.setField(e,3,s)}setListSize_(e,s){this.m_lists.setField(e,4,s)}setNextList_(e,s){F(0)}setPrevList_(e,s){this.m_lists.setField(e,2,s)}createList(e){const s=this.newList_();return this.m_lists.setField(s,3,this.m_listOfLists),this.m_lists.setField(s,4,0),this.m_lists.setField(s,5,e),this.m_listOfLists!==Wr.st_nullNode()&&this.setPrevList_(this.m_listOfLists,s),this.m_listOfLists=s,s}deleteList(e){this.clear(e);const s=this.m_lists.getField(e,2),i=this.m_lists.getField(e,3);return s!==Wr.st_nullNode()?this.setNextList_(s,i):this.m_listOfLists=i,i!==Wr.st_nullNode()&&this.setPrevList_(i,s),this.freeList_(e),i}reserveLists(e){F(0)}getListData(e){return this.m_lists.getField(e,5)}getList(e){return F(0),0}setListData(e,s){this.m_lists.setField(e,5,s)}addElement(e,s){return this.insertElement(e,-1,s)}insertElement(e,s,i){const r=this.newNode_();let n=-1;if(s!==Wr.st_nullNode()&&(n=this.getPrev(s),this.setPrev_(s,r)),this.setNext_(r,s),n!==Wr.st_nullNode()&&this.setNext_(n,r),s===this.m_lists.getField(e,0)&&this.m_lists.setField(e,0,r),s===Wr.st_nullNode()){const o=this.m_lists.getField(e,1);this.setPrev_(r,o),o!==-1&&this.setNext_(o,r),this.m_lists.setField(e,1,r)}return this.setData(r,i),this.setListSize_(e,this.getListSize(e)+1),this.m_bStoreListIndexWithNode&&this.setList_(r,e),r}deleteElement(e,s){const i=this.getPrev(s),r=this.getNext(s);return i!==Wr.st_nullNode()?this.setNext_(i,r):this.m_lists.setField(e,0,r),r!==Wr.st_nullNode()?this.setPrev_(r,i):this.m_lists.setField(e,1,i),this.freeNode_(s),this.setListSize_(e,this.getListSize(e)-1),r}reserveNodes(e){this.m_listNodes.setCapacity(e)}getData(e){return this.m_listNodes.getField(e,0)}getElement(e){return this.getData(e)}setData(e,s){this.m_listNodes.setField(e,0,s)}getNext(e){return this.m_listNodes.getField(e,2)}getPrev(e){return this.m_listNodes.getField(e,1)}getFirst(e){return this.m_lists.getField(e,0)}getLast(e){return this.m_lists.getField(e,1)}static st_nullNode(){return-1}clear(e){if(e!==void 0){let s=this.getLast(e);for(;s!==Wr.st_nullNode();){const i=s;s=this.getPrev(i),this.freeNode_(i)}return this.m_lists.setField(e,0,-1),this.m_lists.setField(e,1,-1),void this.setListSize_(e,0)}for(let s=this.getFirstList();s!==-1;)s=this.deleteList(s)}isEmpty(e){return F(0),!1}getNodeCount(){return this.m_listNodes.size()}getListCount(){return this.m_lists.size()}getListSize(e){return this.m_lists.getField(e,4)}getFirstList(){return this.m_listOfLists}getNextList(e){return this.m_lists.getField(e,3)}}class tKe extends E0{constructor(e){super(),this.m_intervalTree=e}compare(e,s,i){const r=e.getElement(i),n=this.m_intervalTree.getValue_(s),o=this.m_intervalTree.getValue_(r);return n<o?-1:n===o?ho.isLeft_(s)&&ho.isRight_(r)?-1:ho.isLeft_(r)&&ho.isRight_(s)?1:0:1}}class ho{constructor(e){this.m_bEnvelopesRef=!1,this.m_intervals=[],this.m_envelopesRef=null,this.m_intervalNodes=new et(3),this.m_intervalHandles=[],this.m_endIndicesUnique=[],this.m_cCount=-1,this.m_root=-1,this.m_bSortIntervals=!1,this.m_bConstructing=!1,this.m_bConstructionEnded=!1,this.m_bOfflineDynamic=e,this.m_tertiaryNodes=new et(this.m_bOfflineDynamic?5:4),this.m_secondaryTreaps=new Xe,this.m_secondaryTreaps.setComparator(new tKe(this)),this.m_secondaryLists=new Wr}addEnvelopesRef(e){this.reset_(!0,!0),this.m_bEnvelopesRef=!0,this.m_envelopesRef=e,this.m_bConstructing=!1,this.m_bConstructionEnded=!0,this.m_bOfflineDynamic||(this.insertIntervalsStatic_(),this.m_cCount=this.m_envelopesRef.length)}startConstruction(){this.reset_(!0,!1)}addInterval(e){this.m_bConstructing||Us(""),this.m_intervals.push(e.clone())}addIntervalCoords(e,s){F(0)}endConstruction(){this.m_bConstructing||Us(""),this.m_bConstructing=!1,this.m_bConstructionEnded=!0,this.m_bOfflineDynamic||(this.insertIntervalsStatic_(),this.m_cCount=this.m_intervals.length)}insert(e){if(this.m_bOfflineDynamic&&this.m_bConstructionEnded||Us(""),this.m_root===-1){const n=this.m_bEnvelopesRef?this.m_envelopesRef.length:this.m_intervals.length;if(this.m_bSortIntervals){const o=new Qs(0);this.querySortedEndPointIndices_(o),this.m_endIndicesUnique.length=0,this.querySortedDuplicatesRemoved_(o),this.m_intervalHandles.length=n,this.m_intervalHandles.fill(-1),this.m_bSortIntervals=!1}else this.m_intervalHandles.fill(-1,0,n);this.m_root=this.createRoot_()}const s=this.insertIntervalEnd_(e<<1,this.m_root),i=this.getSecondaryFromInterval_(s),r=this.m_secondaryTreaps.addElement(1+(e<<1),i);this.setRightEnd_(s,r),this.m_intervalHandles[e]=s,this.m_cCount++}remove(e){this.m_bOfflineDynamic&&this.m_bConstructionEnded||Us("");const s=this.m_intervalHandles[e];let i;s===-1&&ee("the interval does not exist in the interval tree"),this.m_intervalHandles[e]=-1,this.m_cCount--;let r=this.getSecondaryFromInterval_(s),n=-1;n=this.m_secondaryTreaps.getTreapData(r),this.m_secondaryTreaps.deleteNode(this.getLeftEnd_(s),r),this.m_secondaryTreaps.deleteNode(this.getRightEnd_(s),r),i=this.m_secondaryTreaps.size(r),i===0&&(this.m_secondaryTreaps.deleteTreap(r),this.setSecondaryToTertiary_(n,-1)),this.m_intervalNodes.deleteElement(s);let o=this.getPptr_(n),a=this.getLptr_(n),l=this.getRptr_(n);for(;!(i>0||n===this.m_root||a!==-1&&l!==-1);)n===this.getLptr_(o)?a!==-1?(this.setLptr_(o,a),this.setPptr_(a,o),this.setLptr_(n,-1),this.setPptr_(n,-1)):l!==-1?(this.setLptr_(o,l),this.setPptr_(l,o),this.setRptr_(n,-1),this.setPptr_(n,-1)):(this.setLptr_(o,-1),this.setPptr_(n,-1)):a!==-1?(this.setRptr_(o,a),this.setPptr_(a,o),this.setLptr_(n,-1),this.setPptr_(n,-1)):l!==-1?(this.setRptr_(o,l),this.setPptr_(l,o),this.setRptr_(n,-1),this.setPptr_(n,-1)):(this.setRptr_(o,-1),this.setPptr_(n,-1)),this.m_tertiaryNodes.deleteElement(n),n=o,r=this.getSecondaryFromTertiary_(n),i=r!==-1?this.m_secondaryTreaps.size(r):0,a=this.getLptr_(n),l=this.getRptr_(n),o=this.getPptr_(n)}size(){return this.m_cCount}getIteratorQuery(e,s){return e instanceof de?new yie(this,e,s):(F(0),{})}getIterator(){return new yie(this)}querySortedEndPointIndices_(e){const s=this.m_bEnvelopesRef?this.m_envelopesRef.length:this.m_intervals.length;for(let i=0;i<2*s;i++)e.add(i);this.sortEndIndices_(e,0,2*s)}querySortedDuplicatesRemoved_(e){let s=Number.NaN;for(let i=0;i<e.size();i++){const r=e.read(i),n=this.getValue_(r);n!==s&&(this.m_endIndicesUnique.push(r),s=n)}}insertIntervalsStatic_(){const e=this.m_bEnvelopesRef?this.m_envelopesRef.length:this.m_intervals.length,s=new Qs(0);this.querySortedEndPointIndices_(s),this.m_endIndicesUnique.length=0,this.querySortedDuplicatesRemoved_(s),this.m_intervalNodes.setCapacity(e),this.m_secondaryLists.reserveNodes(2*e);const i=Me(e,-1);this.m_root=this.createRoot_();for(let r=0;r<s.size();r++){const n=s.read(r);let o=i[n>>1];if(o!==-1){const a=this.getSecondaryFromInterval_(o);this.setRightEnd_(o,this.m_secondaryLists.addElement(a,n))}else o=this.insertIntervalEnd_(n,this.m_root),i[n>>1]=o}}createRoot_(){const e=this.calculateDiscriminantIndex1_(0,this.m_endIndicesUnique.length-1);return this.createTertiaryNode_(e)}insertIntervalEnd_(e,s){let i=-1,r=s,n=-1,o=-1,a=0,l=this.m_endIndicesUnique.length-1,u=0;const c=e>>1;let h=Number.NaN,m=Number.NaN,f=!0;const g=this.getMin_(c),v=this.getMax_(c);let b=-1;for(;f;){u=a+(l-a>>1),b=this.calculateDiscriminantIndex1_(a,l);const w=this.getDiscriminantFromIndex1_(b);if(v<w){if(r!==-1){if(b===this.getDiscriminantIndex1_(r))i=r,h=w,r=this.getLptr_(r),m=r!==-1?this.getDiscriminant_(r):Number.NaN;else if(m>w){const P=this.createTertiaryNode_(b);w<h?this.setLptr_(i,P):this.setRptr_(i,P),this.setRptr_(P,r),this.m_bOfflineDynamic&&(this.setPptr_(P,i),this.setPptr_(r,P)),i=P,h=w,r=-1,m=Number.NaN}}l=u;continue}if(g>w){if(r!==-1){if(b===this.getDiscriminantIndex1_(r))i=r,h=w,r=this.getRptr_(r),m=r!==-1?this.getDiscriminant_(r):Number.NaN;else if(m<w){const P=this.createTertiaryNode_(b);w<h?this.setLptr_(i,P):this.setRptr_(i,P),this.setLptr_(P,r),this.m_bOfflineDynamic&&(this.setPptr_(P,i),this.setPptr_(r,P)),i=P,h=w,r=-1,m=Number.NaN}}a=u+1;continue}let S=-1;S=r===-1||b!==this.getDiscriminantIndex1_(r)?this.createTertiaryNode_(b):r,n=this.getSecondaryFromTertiary_(S),n===-1&&(n=this.createSecondary_(S),this.setSecondaryToTertiary_(S,n));const T=this.addEndIndex_(n,e);o=this.createIntervalNode_(),this.setSecondaryToInterval_(o,n),this.setLeftEnd_(o,T),r!==-1&&b===this.getDiscriminantIndex1_(r)||(w<h?this.setLptr_(i,S):this.setRptr_(i,S),this.m_bOfflineDynamic&&this.setPptr_(S,i),r!==-1&&(m<w?this.setLptr_(S,r):this.setRptr_(S,r),this.m_bOfflineDynamic&&this.setPptr_(r,S))),f=!1;break}return o}createTertiaryNode_(e){const s=this.m_tertiaryNodes.newElement();return this.setDiscriminantIndex1_(s,e),s}createSecondary_(e){return this.m_bOfflineDynamic?this.m_secondaryTreaps.createTreap(e):this.m_secondaryLists.createList(e)}createIntervalNode_(){return this.m_intervalNodes.newElement()}reset(){this.m_bOfflineDynamic&&this.m_bConstructionEnded||Us(""),this.reset_(!1,this.m_bEnvelopesRef)}reset_(e,s){e?(this.m_bEnvelopesRef=!1,this.m_envelopesRef=null,this.m_bSortIntervals=!0,this.m_bConstructing=!0,this.m_bConstructionEnded=!1,this.m_endIndicesUnique.length=0,s?(this.m_intervals.length=0,this.m_bEnvelopesRef=!0):this.m_intervals.length=0):this.m_bSortIntervals=!1,this.m_bOfflineDynamic?this.m_secondaryTreaps.clear():this.m_secondaryLists.clear(),this.m_intervalNodes.deleteAll(!1),this.m_tertiaryNodes.deleteAll(!1),this.m_root=-1,this.m_cCount=0}getDiscriminant_(e){const s=this.getDiscriminantIndex1_(e);return this.getDiscriminantFromIndex1_(s)}getDiscriminantFromIndex1_(e){if(e===-1)return Number.NaN;if(e>0){const r=e-2,n=this.m_endIndicesUnique[r],o=this.m_endIndicesUnique[r+1];return .5*(this.getValue_(n)+this.getValue_(o))}const s=-e-2,i=this.m_endIndicesUnique[s];return this.getValue_(i)}calculateDiscriminantIndex1_(e,s){let i;return e<s?i=e+(s-e>>1)+2:i=-(e+2),i}setDiscriminantIndex1_(e,s){this.m_tertiaryNodes.setField(e,0,s)}setSecondaryToTertiary_(e,s){this.m_tertiaryNodes.setField(e,1,s)}setLptr_(e,s){this.m_tertiaryNodes.setField(e,2,s)}setRptr_(e,s){this.m_tertiaryNodes.setField(e,3,s)}setPptr_(e,s){this.m_tertiaryNodes.setField(e,4,s)}setSecondaryToInterval_(e,s){this.m_intervalNodes.setField(e,0,s)}addEndIndex_(e,s){let i=-1;return i=this.m_bOfflineDynamic?this.m_secondaryTreaps.addElement(s,e):this.m_secondaryLists.addElement(e,s),i}setLeftEnd_(e,s){this.m_intervalNodes.setField(e,1,s)}setRightEnd_(e,s){this.m_intervalNodes.setField(e,2,s)}getFirst_(e){return this.m_bOfflineDynamic?this.m_secondaryTreaps.getFirst(e):this.m_secondaryLists.getFirst(e)}getLast_(e){return this.m_bOfflineDynamic?this.m_secondaryTreaps.getLast(e):this.m_secondaryLists.getLast(e)}static isLeft_(e){return!(1&e)}static isRight_(e){return!(1&~e)}getDiscriminantIndex1_(e){return this.m_tertiaryNodes.getField(e,0)}getSecondaryFromTertiary_(e){return this.m_tertiaryNodes.getField(e,1)}getLptr_(e){return this.m_tertiaryNodes.getField(e,2)}getRptr_(e){return this.m_tertiaryNodes.getField(e,3)}getPptr_(e){return this.m_tertiaryNodes.getField(e,4)}getSecondaryFromInterval_(e){return this.m_intervalNodes.getField(e,0)}getLeftEnd_(e){return this.m_intervalNodes.getField(e,1)}getRightEnd_(e){return this.m_intervalNodes.getField(e,2)}getMin_(e){return this.m_bEnvelopesRef?this.m_envelopesRef[e].xmin:this.m_intervals[e].vmin}getMax_(e){return this.m_bEnvelopesRef?this.m_envelopesRef[e].xmax:this.m_intervals[e].vmax}sortEndIndices_(e,s,i){const r=this,n={userSort(o,a,l){r.sortEndIndicesHelper_(l,o,a)},getValue:o=>r.getValue_(o)};new Jc().sort(e,s,i,n)}sortEndIndicesHelper_(e,s,i){e.sort(s,i,(r,n)=>{const o=this.getValue_(r),a=this.getValue_(n);return o<a||o===a&&ho.isLeft_(r)&&ho.isRight_(n)?-1:1})}getValue_(e){if(!this.m_bEnvelopesRef){const i=this.m_intervals[e>>1];return ho.isLeft_(e)?i.vmin:i.vmax}const s=this.m_envelopesRef[e>>1];return ho.isLeft_(e)?s.xmin:s.xmax}}class yie{constructor(e,s,i){this.m_query=de.constructEmpty(),this.m_tertiaryHandle=-1,this.m_nextTertiaryHandle=-1,this.m_forkedHandle=-1,this.m_currentEndHandle=-1,this.m_nextEndHandle=-1,this.m_tertiaryStack=[],this.m_functionIndex=0,this.m_intervalTree=e,this.m_functionStack=new Array(2),this.m_functionStack[0]=this.nullFunc_,this.m_functionStack[1]=this.nullFunc_,s!==void 0&&this.resetIterator(s,i)}nullFunc_(){return Ce("should not be called"),!1}resetIterator(e,s){if(typeof e=="number"){const i=new de;i.setCoords(e,e),this.resetIterator(i,s)}else s===void 0&&(s=0),this.m_query.vmin=e.vmin-s,this.m_query.vmax=e.vmax+s,this.m_tertiaryStack.length=0,this.m_functionIndex=0,this.m_functionStack[0]=this.initialize_}next(){if(this.m_intervalTree.m_bConstructionEnded||Us(""),this.m_functionIndex<0)return-1;for(;this.m_fi=this.m_functionStack[this.m_functionIndex],this.m_fi(););return this.m_currentEndHandle!==-1?this.getCurrentEndIndex_()>>1:-1}initialize_(){return this.m_tertiaryHandle=-1,this.m_nextTertiaryHandle=-1,this.m_forkedHandle=-1,this.m_currentEndHandle=-1,this.m_intervalTree.m_tertiaryNodes.size()>0?(this.m_functionStack[0]=this.pIn_,this.m_nextTertiaryHandle=this.m_intervalTree.m_root,!0):(this.m_functionIndex=-1,!1)}pIn_(){if(this.m_tertiaryHandle=this.m_nextTertiaryHandle,this.m_tertiaryHandle===-1)return this.m_functionIndex=-1,this.m_currentEndHandle=-1,!1;const e=this.m_intervalTree.getDiscriminant_(this.m_tertiaryHandle);if(this.m_query.vmax<e){const i=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),i!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(i),this.m_functionStack[++this.m_functionIndex]=this.left_),!0}if(e<this.m_query.vmin){const i=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_tertiaryHandle),i!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getLast_(i),this.m_functionStack[++this.m_functionIndex]=this.right_),!0}this.m_functionStack[this.m_functionIndex]=this.pL_,this.m_forkedHandle=this.m_tertiaryHandle;const s=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),s!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(s),this.m_functionStack[++this.m_functionIndex]=this.all_),!0}pL_(){if(this.m_tertiaryHandle=this.m_nextTertiaryHandle,this.m_tertiaryHandle===-1)return this.m_functionStack[this.m_functionIndex]=this.pR_,this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_forkedHandle),!0;if(this.m_intervalTree.getDiscriminant_(this.m_tertiaryHandle)<this.m_query.vmin){const i=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_tertiaryHandle),i!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getLast_(i),this.m_functionStack[++this.m_functionIndex]=this.right_),!0}const e=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),e!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(e),this.m_functionStack[++this.m_functionIndex]=this.all_);const s=this.m_intervalTree.getRptr_(this.m_tertiaryHandle);return s!==-1&&this.m_tertiaryStack.push(s),!0}pR_(){if(this.m_tertiaryHandle=this.m_nextTertiaryHandle,this.m_tertiaryHandle===-1)return this.m_functionStack[this.m_functionIndex]=this.pT_,!0;const e=this.m_intervalTree.getDiscriminant_(this.m_tertiaryHandle);if(this.m_query.vmax<e){const r=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),r!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(r),this.m_functionStack[++this.m_functionIndex]=this.left_),!0}const s=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_tertiaryHandle),s!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(s),this.m_functionStack[++this.m_functionIndex]=this.all_);const i=this.m_intervalTree.getLptr_(this.m_tertiaryHandle);return i!==-1&&this.m_tertiaryStack.push(i),!0}pT_(){if(this.m_tertiaryStack.length===0)return this.m_functionIndex=-1,this.m_currentEndHandle=-1,!1;this.m_tertiaryHandle=this.m_tertiaryStack.at(-1),this.m_tertiaryStack.pop();const e=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return e!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(e),this.m_functionStack[++this.m_functionIndex]=this.all_),this.m_intervalTree.getLptr_(this.m_tertiaryHandle)!==-1&&this.m_tertiaryStack.push(this.m_intervalTree.getLptr_(this.m_tertiaryHandle)),this.m_intervalTree.getRptr_(this.m_tertiaryHandle)!==-1&&this.m_tertiaryStack.push(this.m_intervalTree.getRptr_(this.m_tertiaryHandle)),!0}left_(){return this.m_currentEndHandle=this.m_nextEndHandle,this.m_currentEndHandle!==-1&&ho.isLeft_(this.getCurrentEndIndex_())&&this.m_intervalTree.getValue_(this.getCurrentEndIndex_())<=this.m_query.vmax?(this.m_nextEndHandle=this.getNext_(),!1):(this.m_functionIndex--,!0)}right_(){return this.m_currentEndHandle=this.m_nextEndHandle,this.m_currentEndHandle!==-1&&ho.isRight_(this.getCurrentEndIndex_())&&this.m_intervalTree.getValue_(this.getCurrentEndIndex_())>=this.m_query.vmin?(this.m_nextEndHandle=this.getPrev_(),!1):(this.m_functionIndex--,!0)}all_(){return this.m_currentEndHandle=this.m_nextEndHandle,this.m_currentEndHandle!==-1&&ho.isLeft_(this.getCurrentEndIndex_())?(this.m_nextEndHandle=this.getNext_(),!1):(this.m_functionIndex--,!0)}getNext_(){return this.m_intervalTree.m_bOfflineDynamic?this.m_intervalTree.m_secondaryTreaps.getNext(this.m_currentEndHandle):this.m_intervalTree.m_secondaryLists.getNext(this.m_currentEndHandle)}getPrev_(){return this.m_intervalTree.m_bOfflineDynamic?this.m_intervalTree.m_secondaryTreaps.getPrev(this.m_currentEndHandle):this.m_intervalTree.m_secondaryLists.getPrev(this.m_currentEndHandle)}getCurrentEndIndex_(){return this.m_intervalTree.m_bOfflineDynamic?this.m_intervalTree.m_secondaryTreaps.getElement(this.m_currentEndHandle):this.m_intervalTree.m_secondaryLists.getData(this.m_currentEndHandle)}}class wP{constructor(){this.m_tolerance=0,this.m_sweepIndexRed=-1,this.m_sweepIndexBlue=-1,this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_intervalTreeRed=null,this.m_intervalTreeBlue=null,this.m_iteratorRed=null,this.m_iteratorBlue=null,this.m_envelopesRed=[],this.m_envelopesBlue=[],this.m_elementsRed=[],this.m_elementsBlue=[],this.m_sortedEndIndicesRed=new Qs(0),this.m_sortedEndIndicesBlue=new Qs(0),this.m_queuedListRed=-1,this.m_queuedListBlue=-1,this.m_queuedEnvelopes=new Wr,this.m_queuedIndicesRed=[],this.m_queuedIndicesBlue=[],this.m_bAddRed=!1,this.m_bAddBlue=!1,this.m_bAddRedRed=!1,this.m_bDone=!0,this.m_function=this.nullFunc_,this.reset_()}startConstruction(){this.reset_(),this.m_bAddRedRed=!0,this.m_elementsRed.length=0,this.m_envelopesRed.length=0}addEnvelope(e,s){this.m_bAddRedRed||Us(""),this.m_elementsRed.push(e),this.m_envelopesRed.push(new X(s))}endConstruction(){this.m_bAddRedRed||Us(""),this.m_bAddRedRed=!1,this.m_envelopesRed.length>0&&(this.m_function=this.initialize_,this.m_bDone=!1)}startRedConstruction(){this.reset_(),this.m_bAddRed=!0,this.m_elementsRed.length=0,this.m_envelopesRed.length=0}addRedEnvelope(e,s){this.m_bAddRed||Us(""),this.m_elementsRed.push(e),this.m_envelopesRed.push(s.clone())}endRedConstruction(){this.m_bAddRed||Us(""),this.m_bAddRed=!1,this.m_envelopesRed.length>0&&this.m_envelopesBlue.length>0&&(this.m_function===this.nullFunc_||this.m_function===this.initializeBlue_?this.m_function=this.initializeRedBlue_:this.m_function!==this.initializeRedBlue_&&(this.m_function=this.initializeRed_),this.m_bDone=!1)}startBlueConstruction(){this.reset_(),this.m_bAddBlue=!0,this.m_elementsBlue.length=0,this.m_envelopesBlue.length=0}addBlueEnvelope(e,s){this.m_bAddBlue||Us(""),this.m_elementsBlue.push(e),this.m_envelopesBlue.push(s.clone())}endBlueConstruction(){this.m_bAddBlue||Us(""),this.m_bAddBlue=!1,this.m_envelopesRed.length>0&&this.m_envelopesBlue.length>0&&(this.m_function===this.nullFunc_||this.m_function===this.initializeRed_?this.m_function=this.initializeRedBlue_:this.m_function!==this.initializeRedBlue_&&(this.m_function=this.initializeBlue_),this.m_bDone=!1)}next(){if(this.m_bDone)return!1;for(;this.m_function(););return!this.m_bDone}getHandleA(){return this.m_envelopeHandleA}getHandleB(){return this.m_envelopeHandleB}setTolerance(e){this.m_tolerance=e}getElement(e){return this.m_elementsRed[e]}getRedEnvelope(e){return this.m_envelopesRed[e]}getBlueEnvelope(e){return this.m_envelopesBlue[e]}getRedElement(e){return this.m_elementsRed[e]}getBlueElement(e){return this.m_elementsBlue[e]}isTop_(e){return!(1&~e)}isBottom_(e){return!(1&e)}reset_(){this.m_bAddRed=!1,this.m_bAddBlue=!1,this.m_bAddRedRed=!1,this.m_sweepIndexRed=-1,this.m_sweepIndexBlue=-1,this.m_queuedListRed=-1,this.m_queuedListBlue=-1,this.m_bDone=!0}initialize_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepBruteForce_,!0;this.m_intervalTreeRed||(this.m_intervalTreeRed=new ho(!0)),this.m_intervalTreeRed.addEnvelopesRef(this.m_envelopesRed),this.m_iteratorRed===null&&(this.m_iteratorRed=this.m_intervalTreeRed.getIterator()),this.m_sortedEndIndicesRed.resize(0);for(let e=0;e<2*this.m_envelopesRed.length;e++)this.m_sortedEndIndicesRed.add(e);return this.sortYEndIndices_(this.m_sortedEndIndicesRed,0,2*this.m_envelopesRed.length,!0),this.m_sweepIndexRed=2*this.m_envelopesRed.length,this.m_function=this.sweep_,!0}initializeRed_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10||this.m_envelopesBlue.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepRedBlueBruteForce_,!0;this.m_intervalTreeRed||(this.m_intervalTreeRed=new ho(!0)),this.m_intervalTreeRed.addEnvelopesRef(this.m_envelopesRed),this.m_iteratorRed===null&&(this.m_iteratorRed=this.m_intervalTreeRed.getIterator()),this.m_sortedEndIndicesRed.resize(0);for(let e=0;e<2*this.m_envelopesRed.length;e++)this.m_sortedEndIndicesRed.add(e);return this.sortYEndIndices_(this.m_sortedEndIndicesRed,0,this.m_sortedEndIndicesRed.size(),!0),this.m_sweepIndexRed=this.m_sortedEndIndicesRed.size(),this.m_queuedListRed!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListRed),this.m_queuedIndicesRed.length=0,this.m_queuedListRed=-1),this.m_function=this.sweepRedBlue_,this.resetBlue_()}initializeBlue_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10||this.m_envelopesBlue.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepRedBlueBruteForce_,!0;this.m_intervalTreeBlue||(this.m_intervalTreeBlue=new ho(!0)),this.m_intervalTreeBlue.addEnvelopesRef(this.m_envelopesBlue),this.m_iteratorBlue==null&&(this.m_iteratorBlue=this.m_intervalTreeBlue.getIterator()),this.m_sortedEndIndicesBlue.resize(0);for(let e=0;e<2*this.m_envelopesBlue.length;e++)this.m_sortedEndIndicesBlue.add(e);return this.sortYEndIndices_(this.m_sortedEndIndicesBlue,0,this.m_sortedEndIndicesBlue.size(),!1),this.m_sweepIndexBlue=this.m_sortedEndIndicesBlue.size(),this.m_queuedListBlue!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListBlue),this.m_queuedIndicesBlue.length=0,this.m_queuedListBlue=-1),this.m_function=this.sweepRedBlue_,this.resetRed_()}initializeRedBlue_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10||this.m_envelopesBlue.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepRedBlueBruteForce_,!0;this.m_intervalTreeRed||(this.m_intervalTreeRed=new ho(!0)),this.m_intervalTreeBlue||(this.m_intervalTreeBlue=new ho(!0)),this.m_intervalTreeRed.addEnvelopesRef(this.m_envelopesRed),this.m_intervalTreeBlue.addEnvelopesRef(this.m_envelopesBlue),this.m_iteratorRed===null&&(this.m_iteratorRed=this.m_intervalTreeRed.getIterator()),this.m_iteratorBlue===null&&(this.m_iteratorBlue=this.m_intervalTreeBlue.getIterator()),this.m_sortedEndIndicesRed.resize(0),this.m_sortedEndIndicesBlue.resize(0);for(let e=0;e<2*this.m_envelopesRed.length;e++)this.m_sortedEndIndicesRed.add(e);for(let e=0;e<2*this.m_envelopesBlue.length;e++)this.m_sortedEndIndicesBlue.add(e);return this.sortYEndIndices_(this.m_sortedEndIndicesRed,0,this.m_sortedEndIndicesRed.size(),!0),this.sortYEndIndices_(this.m_sortedEndIndicesBlue,0,this.m_sortedEndIndicesBlue.size(),!1),this.m_sweepIndexRed=this.m_sortedEndIndicesRed.size(),this.m_sweepIndexBlue=this.m_sortedEndIndicesBlue.size(),this.m_queuedListRed!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListRed),this.m_queuedIndicesRed.length=0,this.m_queuedListRed=-1),this.m_queuedListBlue!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListBlue),this.m_queuedIndicesBlue.length=0,this.m_queuedListBlue=-1),this.m_function=this.sweepRedBlue_,!0}sweep_(){const e=this.m_sortedEndIndicesRed.read(--this.m_sweepIndexRed),s=e>>1;if(this.isBottom_(e))return this.m_intervalTreeRed.remove(s),this.m_sweepIndexRed!==0||(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1);const i=de.construct(this.m_envelopesRed[s].xmin,this.m_envelopesRed[s].xmax);return this.m_iteratorRed.resetIterator(i,this.m_tolerance),this.m_envelopeHandleA=s,this.m_function=this.iterate_,!0}sweepBruteForce_(){return--this.m_sweepIndexRed==-1?(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1):(this.m_envelopeHandleA=this.m_sweepIndexRed,this.m_sweepIndexBlue=this.m_sweepIndexRed,this.m_function=this.iterateBruteForce_,!0)}sweepRedBlueBruteForce_(){return--this.m_sweepIndexRed==-1?(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1):(this.m_envelopeHandleA=this.m_sweepIndexRed,this.m_sweepIndexBlue=this.m_envelopesBlue.length,this.m_function=this.iterateRedBlueBruteForce_,!0)}sweepRedBlue_(){const e=this.m_sortedEndIndicesRed.read(this.m_sweepIndexRed-1),s=this.m_sortedEndIndicesBlue.read(this.m_sweepIndexBlue-1),i=this.getAdjustedValue_(e,!0),r=this.getAdjustedValue_(s,!1);return i>r?this.sweepRed_():i<r?this.sweepBlue_():this.isTop_(e)?this.sweepRed_():this.isTop_(s)?this.sweepBlue_():this.sweepRed_()}sweepRed_(){const e=this.m_sortedEndIndicesRed.read(--this.m_sweepIndexRed),s=e>>1;if(this.isBottom_(e))return this.m_queuedListRed!==-1&&this.m_queuedIndicesRed[s]!==-1?(this.m_queuedEnvelopes.deleteElement(this.m_queuedListRed,this.m_queuedIndicesRed[s]),this.m_queuedIndicesRed[s]=-1):this.m_intervalTreeRed.remove(s),this.m_sweepIndexRed!==0||(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1);if(this.m_queuedListBlue!==-1&&this.m_queuedEnvelopes.getListSize(this.m_queuedListBlue)>0){let i=this.m_queuedEnvelopes.getFirst(this.m_queuedListBlue);for(;i!==-1;){const r=this.m_queuedEnvelopes.getData(i);this.m_intervalTreeBlue.insert(r),this.m_queuedIndicesBlue[r]=-1;const n=this.m_queuedEnvelopes.getNext(i);this.m_queuedEnvelopes.deleteElement(this.m_queuedListBlue,i),i=n}}if(this.m_intervalTreeBlue.size()>0){const i=de.construct(this.m_envelopesRed[s].xmin,this.m_envelopesRed[s].xmax);this.m_iteratorBlue.resetIterator(i,this.m_tolerance),this.m_envelopeHandleA=s,this.m_function=this.iterateBlue_}else this.m_queuedListRed===-1&&(B3(this.m_queuedIndicesRed,this.m_envelopesRed.length,-1),this.m_queuedListRed=this.m_queuedEnvelopes.createList(1)),this.m_queuedIndicesRed[s]=this.m_queuedEnvelopes.addElement(this.m_queuedListRed,s),this.m_function=this.sweepRedBlue_;return!0}sweepBlue_(){const e=this.m_sortedEndIndicesBlue.read(--this.m_sweepIndexBlue),s=e>>1;if(this.isBottom_(e))return this.m_queuedListBlue!==-1&&this.m_queuedIndicesBlue[s]!==-1?(this.m_queuedEnvelopes.deleteElement(this.m_queuedListBlue,this.m_queuedIndicesBlue[s]),this.m_queuedIndicesBlue[s]=-1):this.m_intervalTreeBlue.remove(s),this.m_sweepIndexBlue!==0||(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1);if(this.m_queuedListRed!==-1&&this.m_queuedEnvelopes.getListSize(this.m_queuedListRed)>0){let i=this.m_queuedEnvelopes.getFirst(this.m_queuedListRed);for(;i!==-1;){const r=this.m_queuedEnvelopes.getData(i);this.m_intervalTreeRed.insert(r),this.m_queuedIndicesRed[r]=-1;const n=this.m_queuedEnvelopes.getNext(i);this.m_queuedEnvelopes.deleteElement(this.m_queuedListRed,i),i=n}}if(this.m_intervalTreeRed.size()>0){const i=de.construct(this.m_envelopesBlue[s].xmin,this.m_envelopesBlue[s].xmax);this.m_iteratorRed.resetIterator(i,this.m_tolerance),this.m_envelopeHandleB=s,this.m_function=this.iterateRed_}else this.m_queuedListBlue===-1&&(B3(this.m_queuedIndicesBlue,this.m_envelopesBlue.length,-1),this.m_queuedListBlue=this.m_queuedEnvelopes.createList(0)),this.m_queuedIndicesBlue[s]=this.m_queuedEnvelopes.addElement(this.m_queuedListBlue,s),this.m_function=this.sweepRedBlue_;return!0}iterate_(){if(this.m_envelopeHandleB=this.m_iteratorRed.next(),this.m_envelopeHandleB!==-1)return!1;const e=this.m_sortedEndIndicesRed.read(this.m_sweepIndexRed)>>1;return this.m_intervalTreeRed.insert(e),this.m_function=this.sweep_,!0}iterateRed_(){if(this.m_envelopeHandleA=this.m_iteratorRed.next(),this.m_envelopeHandleA!==-1)return!1;this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1;const e=this.m_sortedEndIndicesBlue.read(this.m_sweepIndexBlue)>>1;return this.m_intervalTreeBlue.insert(e),this.m_function=this.sweepRedBlue_,!0}iterateBlue_(){if(this.m_envelopeHandleB=this.m_iteratorBlue.next(),this.m_envelopeHandleB!==-1)return!1;const e=this.m_sortedEndIndicesRed.read(this.m_sweepIndexRed)>>1;return this.m_intervalTreeRed.insert(e),this.m_function=this.sweepRedBlue_,!0}iterateBruteForce_(){if(--this.m_sweepIndexBlue==-1)return this.m_function=this.sweepBruteForce_,!0;const e=this.m_envelopesRed[this.m_sweepIndexRed].clone(),s=this.m_envelopesRed[this.m_sweepIndexBlue];return e.inflateCoords(this.m_tolerance,this.m_tolerance),!e.isIntersecting(s)||(this.m_envelopeHandleB=this.m_sweepIndexBlue,!1)}iterateRedBlueBruteForce_(){if(--this.m_sweepIndexBlue==-1)return this.m_function=this.sweepRedBlueBruteForce_,!0;const e=this.m_envelopesRed[this.m_sweepIndexRed].clone(),s=this.m_envelopesBlue[this.m_sweepIndexBlue];return e.inflateCoords(this.m_tolerance,this.m_tolerance),!e.isIntersecting(s)||(this.m_envelopeHandleB=this.m_sweepIndexBlue,!1)}resetRed_(){return this.m_sweepIndexRed=this.m_sortedEndIndicesRed.size(),this.m_intervalTreeRed.size()>0&&this.m_intervalTreeRed.reset(),this.m_queuedListRed!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListRed),this.m_queuedIndicesRed.length=0,this.m_queuedListRed=-1),this.m_bDone=!1,!0}resetBlue_(){return this.m_sweepIndexBlue=this.m_sortedEndIndicesBlue.size(),this.m_intervalTreeBlue.size()>0&&this.m_intervalTreeBlue.reset(),this.m_queuedListBlue!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListBlue),this.m_queuedIndicesBlue.length=0,this.m_queuedListBlue=-1),this.m_bDone=!1,!0}nullFunc_(){return Ce("should not be called"),!1}sortYEndIndices_(e,s,i,r){const n=this,o={userSort(a,l,u){n.sortYEndIndicesHelper_(u,a,l,r)},getValue:a=>n.getAdjustedValue_(a,r)};new Jc().sort(e,s,i,o)}sortYEndIndicesHelper_(e,s,i,r){e.sort(s,i,(n,o)=>{const a=this.getAdjustedValue_(n,r),l=this.getAdjustedValue_(o,r);return a<l||a===l&&this.isBottom_(n)&&this.isTop_(o)?-1:1})}getAdjustedValue_(e,s){const i=.5*this.m_tolerance;if(s){const n=this.m_envelopesRed[e>>1];return this.isBottom_(e)?n.ymin-i:n.ymax+i}const r=this.m_envelopesBlue[e>>1];return this.isBottom_(e)?r.ymin-i:r.ymax+i}}var _ie=Es;class Uo{constructor(e,s){this.tolerance=e!==void 0?e:Number.NaN,this.resolution=s!==void 0?s:Number.NaN}add(e){return new Uo(this.tolerance+e,this.resolution)}scale(e){return new Uo(this.tolerance*e,this.resolution*e)}total(){return this.tolerance+this.resolution}}function sKe(t,e,s,i,r){const n=i*i,o=t.sub(e),a=s.sub(e),l=o.sqrLength(),u=a.sqrLength();if(l<=n||u<=n)return!0;const c=Pt(o.crossProduct(a));return c<=n*l||c<=n*u?o.dotProduct(a)>=0:!1}function j0e(t,e,s){return i=>s===0?(i+t)*e:1*(i-t*e)/e}function P9(t,e){const s=new X;return t.queryLooseEnvelope(s),s.mergeEnvelope2D(e),s}function sM(t,e){const s=X.constructEmpty();t.queryLooseEnvelope(s);const i=X.constructEmpty();return e.queryLooseEnvelope(i),s.mergeEnvelope2D(i),s}function iKe(t,e){return(Number.isFinite(t)||Number.isNaN(t))&&(Number.isFinite(e)||Number.isNaN(e))}function H0e(t,e){return Number.isFinite(t)&&Number.isFinite(e)}function Y0e(t,e,s){const i=X.constructEmpty();return i.setFromPoints(t,e),hR(0,null,i.calculateToleranceFromEnvelope(),s,!1)}function Ji(t,e,s){return hR(0,t,e.calculateToleranceFromEnvelope(),s,!1)}function sC(t,e,s){return hR(1,t,e.calculateToleranceFromEnvelope(),s,!1)}function vie(t,e,s){return sC(t,e.queryInterval(1,0),s)}function ba(t,e,s){const i=X.constructEmpty();return e.queryEnvelope(i),Ji(t,i,s)}function Eg(t,e,s=!1){return hR(0,t,e.calculateToleranceFromEnvelope(),s,!0).total()}function iC(t,e,s){const i=X.constructEmpty();return e.queryEnvelope(i),Eg(t,i,s)}function hR(t,e,s,i,r){const n=new Uo(0,0);if(e!==null&&(n.tolerance=e.getTolerance(t),(!r||i)&&e!==null)){const o=e.getResolution(t);n.resolution=o,i&&(n.resolution*=2)}return i&&(s*=4,n.tolerance*=1.01,n.resolution*=1.01),n.total()<s?new Uo(s,0):n}function il(t){return Math.sqrt(2)*(2*t.tolerance+t.resolution)}function T9(t){return Math.sqrt(2)*(t.tolerance+t.resolution)}function tm(t){return t>=3}function rKe(t,e){const s=[0];return t.getImpl().getIsSimple(e,s)>=3}function vbt(t,e){t.getImpl().setIsSimple(3,e)}function nKe(t,e,s,i){if(Pt(e.x-t.x)+Pt(e.y-t.y)<=s*s){const r=t.z,n=e.z;return wx(r,n,i)}return!1}function Hf(t){return t>=4}function oKe(t,e){return t===G.enumPolygon?tm(e):e>=1}function aKe(t,e,s){const i=X.constructEmpty(),r=X.constructEmpty();t.queryLooseEnvelope(i),e.queryLooseEnvelope(r),i.inflateCoords(s,s),r.inflateCoords(s,s);const n=X.constructEmpty();n.setCoords({env2D:i}),n.intersect(r);const o=t.querySegmentIterator(),a=e.querySegmentIterator(),l=X.constructEmpty(),u=X.constructEmpty(),c=new wP;c.setTolerance(s);let h=!1;for(c.startRedConstruction();o.nextPath();)for(;o.hasNextSegment();)o.nextSegment().queryLooseEnvelope(l),l.isIntersecting(n)&&(h=!0,c.addRedEnvelope(o.getStartPointIndex(),l));if(c.endRedConstruction(),!h)return null;let m=!1;for(c.startBlueConstruction();a.nextPath();)for(;a.hasNextSegment();)a.nextSegment().queryLooseEnvelope(u),u.isIntersecting(n)&&(m=!0,c.addBlueEnvelope(a.getStartPointIndex(),u));return c.endBlueConstruction(),m?c:null}function lKe(t,e,s,i,r){t.getGeometryType(),e.getGeometryType();const n=X.constructEmpty(),o=X.constructEmpty();t.queryLooseEnvelope(n),e.queryLooseEnvelope(o),n.inflateCoords(s,s),o.inflateCoords(s,s);const a=X.constructEmpty();a.setCoords({env2D:n}),a.intersect(o);const l=new wP;l.setTolerance(s);let u=!1;l.startRedConstruction();for(let h=0,m=t.getPathCount();h<m;h++)t.queryLoosePathEnvelope(h,n),n.isIntersecting(a)&&(u=!0,l.addRedEnvelope(h,n));if(l.endRedConstruction(),!u)return null;let c=!1;l.startBlueConstruction();for(let h=0,m=e.getPathCount();h<m;h++)e.queryLoosePathEnvelope(h,o),o.isIntersecting(a)&&(c=!0,l.addBlueEnvelope(h,o));return l.endBlueConstruction(),c?l:null}function bie(t,e,s){const i=X.constructEmpty(),r=X.constructEmpty();t.queryLooseEnvelope(i),e.queryEnvelope(r),i.inflateCoords(s,s),r.inflateCoords(s,s);const n=X.constructEmpty();n.setCoords({env2D:i}),n.intersect(r);const o=t.querySegmentIterator(),a=new wP;a.setTolerance(s);let l=!1;for(a.startRedConstruction();o.nextPath();)for(;o.hasNextSegment();)o.nextSegment().queryLooseEnvelope(i),i.isIntersecting(n)&&(l=!0,a.addRedEnvelope(o.getStartPointIndex(),i));if(a.endRedConstruction(),!l)return null;let u=!1;a.startBlueConstruction();for(let c=0,h=e.getPointCount();c<h;c++){const m=e.getXY(c);n.contains(m)&&(u=!0,a.addBlueEnvelope(c,X.construct(m.x,m.y,m.x,m.y)))}return a.endBlueConstruction(),u?a:null}function uKe(t,e,s){const i=X.constructEmpty(),r=X.constructEmpty();t.queryEnvelope(i),e.queryEnvelope(r),i.inflateCoords(s,s),r.inflateCoords(s,s);const n=X.constructEmpty();n.setCoords({env2D:i}),n.intersect(r);const o=new wP;o.setTolerance(s);let a=!1;o.startRedConstruction();const l=new M;for(let h=0,m=t.getPointCount();h<m;h++)t.queryXY(h,l),n.contains(l)&&(a=!0,o.addRedEnvelope(h,X.construct(l.x,l.y,l.x,l.y)));if(o.endRedConstruction(),!a)return null;let u=!1;o.startBlueConstruction();const c=new M;for(let h=0,m=e.getPointCount();h<m;h++)e.queryXY(h,c),n.contains(c)&&(u=!0,o.addBlueEnvelope(h,X.construct(c.x,c.y,c.x,c.y)));return o.endBlueConstruction(),u?o:null}function cKe(t){const e=new X;return t.queryLooseEnvelope(e),e.inflateCoords(1,1),hKe(t,e)}function hKe(t,e,s){const i=new X;if(t.queryLooseEnvelope(i),i.isEmpty())return null;t.getGeometryType();const r=new Ln(i,8);let n=-1;const o=new X;let a=!1;do for(let l=0,u=t.getPathCount();l<u;l++)if(t.queryLoosePathEnvelope(l,o),o.isIntersecting(e)){if(n=r.insertEx(l,o,n),n===-1){a&&Ce("build_quad_tree_for_paths"),i.assign(t.calculateEnvelope2D(!1)),a=!0,r.reset(i,8);break}a=!1}while(a);return r}function Lb(t,e){if(!e){const l=new X;t.queryLooseEnvelope(l);const u=new Ln(l,8);let c=-1;const h=new X,m=t.querySegmentIterator();let f=!1;for(;m.nextPath();)for(;m.hasNextSegment();){const g=m.nextSegment(),v=m.getStartPointIndex();if(g.queryLooseEnvelope(h),c=u.insertEx(v,h,c),c===-1){f&&Ce(""),l.assign(t.calculateEnvelope2D(!1)),f=!0,u.reset(l,8),m.resetToFirstPath();break}}return u}const s=new X;t.queryLooseEnvelope(s);const i=new Ln(s,8);let r=-1;const n=new X,o=t.querySegmentIterator();let a=!1;for(;o.nextPath();)for(;o.hasNextSegment();){const l=o.nextSegment(),u=o.getStartPointIndex();if(l.queryLooseEnvelope(n),n.isIntersecting(e)&&(r=i.insertEx(u,n,r),r===-1)){a&&Ce(""),s.assign(t.calculateEnvelope2D(!1)),a=!0,i.reset(s,8),o.resetToFirstPath();break}}return i}function xie(t,e){if(e){const s=new Ln(e,8),i=new M,r=new X;let n=!1;for(let o=0;o<t.getPointCount();o++)i.setCoordsPoint2D(t.getXY(o)),e.contains(i)&&(r.setCoords({pt:i}),s.insert(o,r)!==-1||(n&&Ce(""),n=!0,s.reset(t.calculateEnvelope2D(),8),o=-1));return s}return yt("no-extent version not yet impl"),null}function wie(t,e,s,i,r){let n=!1;const o=r.vmin,a=r.vmax;for(let l=s;l<e;l+=i){const u=t.read(l);u<o?(n=!0,t.write(l,o)):u>a&&(n=!0,t.write(l,a))}return n}function G8(t,e,s,i){if(!t.hasAttribute(s))return!1;const r=t.getGeometryType();if(r===G.enumGeometryCollection){const n=t,o=n.getGeometryCount();let a=0;for(let l=0;l<o;++l)a|=G8(n.getGeometry(l),e,s,i)?1:0;return!!a}if(zo(r)){const n=t,o=_ie.getPersistence(s),a=_ie.getComponentCount(s),l=n.getPointCount();if(o===1){const u=wie(n.getAttributeStreamRef(s),l*a,i,a,e);return u&&n.notifyModified(),u}if(o===2){const u=wie(n.getAttributeStreamRef(s),l*a,i,a,e);return u&&n.notifyModified(),u}Ce("snap_coordinate not implemented")}if(r===G.enumEnvelope){const n=t,o=n.queryInterval(s,i);let a=!1;return o.vmin<e.vmin&&(a=!0,o.vmin=e.vmin),o.vmax>e.vmax&&(a=!0,o.vmax=e.vmax),a&&n.setIntervalEnvelope(s,i,o),a}if(r===G.enumPoint){const n=t;let o=n.getAttributeAsDbl(s,i),a=!1;return o<e.vmin&&(a=!0,o=e.vmin),o>e.vmax&&(a=!0,o=e.vmax),a&&n.setAttributeBasic(s,i,o),a}if(zi(r)){const n=t;let o=n.getStartAttributeAsDbl(s,i),a=!1;return o<e.vmin&&(a=!0,o=e.vmin),o>e.vmax&&(a=!0,o=e.vmax),a&&n.setStartAttribute(s,i,o),o=n.getEndAttributeAsDbl(s,i),o<e.vmin&&(a=!0,o=e.vmin),o>e.vmax&&(a=!0,o=e.vmax),a&&n.setEndAttribute(s,i,o),a}Ce("snap_coordinate not implemented")}var du=Es;let nt=class z8{constructor(e){if(this.m_description=null,this.x=Number.NaN,this.y=Number.NaN,this.m_attribs=null,e){if(!e.copy)return e.move?(this.m_description=e.move.m_description,e.move.m_description=null,this.m_attribs=e.move.m_attribs,e.move.m_attribs=null,this.x=e.move.x,void(this.y=e.move.y)):e.vd?(this.m_description=e.vd,void(e.attribBuffer?(this.m_attribs=e.attribBuffer,e.initDefaultValues&&this.setDefaultAttributeValues()):this.ensureAttributes())):e.pt?(this.m_description=Jr(),void this.setXY(e.pt)):void("x"in e&&("z"in e?(this.m_description=tC(),this.ensureAttributes(),this.setXYZ(new gt(e.x,e.y,e.z))):(this.m_description=Jr(),this.setXYCoords(e.x,e.y))));e.copy.copyTo(this)}else this.m_description=Jr()}assignCopy(e){return this.m_attribs=null,e.copyTo(this),this}assignMove(e){return this.m_attribs=null,e.copyTo(this),e.setEmpty(),this}getXY(){return new M(this.x,this.y)}queryXY(e){e.x=this.x,e.y=this.y}setXY(e){this.x=e.x,this.y=e.y}setXYCoords(e,s){this.x=e,this.y=s}getXYZ(){const e=new gt;return e.x=this.x,e.y=this.y,e.z=this.getZ(),e}setXYZ(e){this.addAttribute(1),this.x=e.x,this.y=e.y,this.m_attribs[0]=e.z}getX(){return this.x}setX(e){this.x=e}getY(){return this.y}setY(e){this.y=e}getZ(){return this.m_description.hasZ()?this.m_attribs[0]:du.getDefaultValue(1)}setZ(e){this.addAttribute(1),this.m_attribs[0]=e}getM(){return this.getAttributeAsDbl(2,0)}setM(e){this.addAttribute(2),this.m_description.hasZ()?this.m_attribs[1]=e:this.m_attribs[0]=e}getID(){return this.getAttributeAsInt(3,0)}setID(e){this.setAttributeBasic(3,0,e)}isEqualXY(e,s){return s===void 0&&(s=0),Math.abs(e.x-this.x)<=s&&Math.abs(e.y-this.y)<=s}isEqualXYCoords(e,s,i){return i===void 0&&(i=0),Math.abs(e-this.x)<=i&&Math.abs(s-this.y)<=i}getAttributeAsDbl(e,s){if(e===0){if(s===0)return this.x;if(s===1)return this.y;bt("")}const i=du.getComponentCount(e);(s<0||s>=i)&&bt("");const r=this.m_description.getAttributeIndex(e);return r>=0?this.m_attribs[this.m_description.getPointAttributeOffset(r)-2+s]:du.getDefaultValue(e)}getAttributeAsInt(e,s){return Math.trunc(this.getAttributeAsDbl(e,s))}setAttributeBasic(e,s,i){if(e===0)return void(s===0?this.x=i:s===1?this.y=i:bt(""));const r=du.getComponentCount(e);(s<0||s>=r)&&bt("");let n=this.m_description.getAttributeIndex(e);n<0&&(this.addAttribute(e),n=this.m_description.getAttributeIndex(e)),this.m_attribs[this.m_description.getPointAttributeOffset(n)-2+s]=i}copyAttributesFrom(e,s){if(this===e)return;const i=e.getDescription();for(let r=s&&i.hasZ()?2:1,n=i.getAttributeCount();r<n;++r){const o=i.getSemantics(r),a=du.getComponentCount(o);for(let l=0;l<a;++l){const u=e.getAttributeAsDbl(o,l);this.setAttributeBasic(o,l,u)}}}getAttributeArray(){return this.m_attribs}getDescription(){return this.m_description}assignVertexDescription(e){this.m_description!==e&&this.assignVertexDescriptionImpl(e)}mergeVertexDescription(e){this.m_description!==e&&(this.m_description.hasAttributesFrom(e)||this.mergeVertexDescriptionImpl(e))}hasAttribute(e){return this.m_description.hasAttribute(e)}addAttribute(e){if(this.m_description.hasAttribute(e))return;const s=bP(this.m_description,e);this.assignVertexDescription(s)}dropAttribute(e){if(!this.m_description.hasAttribute(e))return;const s=xP(this.m_description,e);this.assignVertexDescription(s)}dropAllAttributes(){const e=Jr();e!==this.m_description&&this.assignVertexDescription(e)}getGeometryType(){return G.enumPoint}getDimension(){return 0}queryEnvelope(e){if(e instanceof Sn)return e.setEmpty(),e.assignVertexDescription(this.m_description),void e.merge(this);if(e instanceof Ql){if(this.isEmpty())return void e.setEmpty();const s=this.getXYZ();return e.xmin=s.x,e.ymin=s.y,e.zmin=s.z,e.xmax=s.x,e.ymax=s.y,void(e.zmax=s.z)}this.isEmpty()?e.setEmpty():(e.xmin=this.x,e.ymin=this.y,e.xmax=this.x,e.ymax=this.y)}queryLooseEnvelope(e){this.queryEnvelope(e)}queryInterval(e,s){const i=new de;if(this.isEmpty())return i.setEmpty(),i;const r=this.getAttributeAsDbl(e,s);return i.vmin=r,i.vmax=r,i}applyTransformation(e){if(!this.isEmpty()){if(e.m_TransformationType===1){const s=this.getXY();return e.transformInPlace(s),void this.setXY(s)}yt("3d not impl")}}transformAttribute(e,s,i,r,n){if(this.isEmpty())return;this.addAttribute(e);const o=this.getAttributeAsDbl(e,s),a=j0e(i,r,n);this.setAttributeBasic(e,s,a(o))}createInstance(){return new z8({vd:this.m_description})}copyTo(e){if(this===e)return;e.getGeometryType()!==G.enumPoint&&ee();const s=e;s.x=this.x,s.y=this.y,this.m_attribs?(s.assignVertexDescription(this.m_description),s.m_attribs=this.m_attribs.slice()):(s.releaseAttributes(),s.assignVertexDescription(this.m_description))}isEmpty(){return Number.isNaN(this.x)||Number.isNaN(this.y)}setEmpty(){this.m_description||(this.m_description=Jr(),this.releaseAttributes()),this.x=Number.NaN,this.y=Number.NaN,this.m_attribs&&$s(this.m_attribs,this.m_description.getDefaultPointAttributes(),0,2,this.m_description.getTotalComponentCount()-2)}calculateArea2D(){return 0}calculateLength2D(){return 0}calculateLength3D(e){return 0}equals(e,s){if(e===this)return!0;if(e.getGeometryType()!==G.enumPoint)return!1;const i=e;if(this.m_description!==i.m_description||this.isEmpty()!==i.isEmpty())return!1;if(this.isEmpty())return!0;if(s===void 0&&(s=0),Math.abs(this.x-i.x)>s||Math.abs(this.y-i.y)>s)return!1;for(let r=0,n=this.m_description.getTotalComponentCount()-2;r<n;r++)if(!wx(this.m_attribs[r],i.m_attribs[r],s))return!1;return!0}getBoundary(){return null}clone(){const e=new z8({vd:this.m_description});return this.copyTo(e),e}swap(e){if(this===e)return;e.getGeometryType()!==G.enumPoint&&ee("wrong geometry type");const s=e;s.m_description=be(this.m_description,this.m_description=s.m_description),s.x=be(this.x,this.x=s.x),s.y=be(this.y,this.y=s.y),s.m_attribs=be(this.m_attribs,this.m_attribs=s.m_attribs)}replaceNaNs(e,s){if(this.addAttribute(e),this.isEmpty())return;const i=du.getComponentCount(e);for(let r=0;r<i;r++){const n=this.getAttributeAsDbl(e,r);Number.isNaN(n)&&this.setAttributeBasic(e,r,s)}}lerp(e,s,i){if(e.getDescription()!==s.getDescription()&&ee("Point.lerp"),this.assignVertexDescription(e.getDescription()),e.isEmpty()||s.isEmpty())return this.setEmpty(),this;this.ensureAttributes();const r=qh();e.queryValues(r,r.length);const n=qh();s.queryValues(n,n.length);const o=qh();let a=r,l=n;const u=o;let c=0;for(let h=0,m=this.m_description.getAttributeCount();h<m;h++){const f=this.m_description.getSemantics(h),g=du.getInterpolation(f),v=du.getComponentCount(f),b=du.getDefaultValue(f);U3(g,a,l,u,c,v,i,b),a=a.slice(v),l=l.slice(v),c+=v}return this.setValues(o,c),this}setDefaultAttributeValues(){const e=this.m_description.getTotalComponentCount()-2;e>0&&(this.m_attribs?$s(this.m_attribs,this.m_description.getDefaultPointAttributes(),0,2,e):this.m_attribs=this.m_description.getDefaultPointAttributes().slice(2))}static sqrDistance2D(e,s){return M.sqrDistanceCoords(e.x,e.y,s.x,s.y)}getImpl(){return this}mergeVertexDescriptionImpl(e){const s=Sx(this.getDescription(),e);this.assignVertexDescription(s)}releaseAttributes(){this.m_attribs=null}assignVertexDescriptionImpl(e){this.m_description||(this.m_description=Jr());const s=lR();uR(e,this.m_description,s);let i=null;e.getTotalComponentCount()-2>0&&(i=e.getDefaultPointAttributes().slice(2));for(let r=1,n=e.getAttributeCount();r<n;r++){const o=s[r];if(o!==-1){const a=this.m_description.getPointAttributeOffset(o)-2,l=e.getPointAttributeOffset(r)-2,u=du.getComponentCount(e.getSemantics(r));for(let c=0;c<u;c++)i[l+c]=this.m_attribs[a+c]}}this.m_attribs=i,this.m_description=e}ensureAttributes(){this.m_description.getTotalComponentCount()-2>0&&this.m_attribs===null&&(this.m_attribs=this.m_description.getDefaultPointAttributes().slice(2))}queryValues(e,s){const i=this.m_description.getTotalComponentCount();F(i<=s),e[0]=this.x,e[1]=this.y,$s(e,this.m_attribs,2,0,i-2)}copyCommonAttributesTo(e){e.x=this.x,e.y=this.y;const s=e.getDescription();if(s===this.m_description)this.m_attribs&&$s(e.m_attribs,this.m_attribs,0,0,this.m_description.getTotalComponentCount()-2);else{let i=0;for(let r=1,n=s.getAttributeCount();r<n;r++){const o=s.getSemantics(r);let a=du.getComponentCount(o);if(this.m_description.hasAttribute(o)){let l=this.m_description.getPointAttributeOffset(this.m_description.getAttributeIndex(o))-2;for(;a!==0;)e.m_attribs[i++]=this.m_attribs[l++],a--}else{const l=du.getDefaultValue(o);for(;a!==0;)e.m_attribs[i++]=l,a--}}}}setValues(e,s){const i=this.m_description.getTotalComponentCount();F(i<=s),this.x=e[0],this.y=e[1],$s(this.m_attribs,e,0,2,i-2)}dbgDefaultAttribs(){}};nt.type=G.enumPoint;var Nl=Es;function W3(t,e){return e*(t.getTotalComponentCount()-2)}let $l=class{constructor(e){if(this.m_attributes=null,e)if(e.xmin!==void 0)this.m_envelope2D=new X(e.xmin,e.ymin,e.xmax,e.ymax);else if(e.env2D!==void 0)this.m_envelope2D=new X(e.env2D);else if(e.move)this.m_envelope2D=new X(e.move.m_envelope2D),this.m_attributes=e.move.m_attributes,e.move.m_attributes=null;else{if(!e.moveEnv)throw new Error("unrecognized EnvelopeData constructor options");{const s=e.moveEnv.accessEnvelopeData();this.m_envelope2D=new X(s.m_envelope2D),this.m_attributes=s.m_attributes,s.m_attributes=null}}else this.m_envelope2D=X.constructEmpty()}ensureAttributes(e){const s=e.getTotalComponentCount()-2;!this.m_attributes&&s&&(this.m_attributes=Me(2*s,Number.NaN),this.m_attributes.fill(Number.NaN))}copyTo(e,s){const i=s,r=e.getTotalComponentCount()-2;if(i.m_description!==e&&(i.releaseAttributes_(),i.m_description=e,r&&(i.m_data.m_attributes=Me(2*r,Number.NaN))),r){F(this.m_attributes&&i.m_data.m_attributes);const n=2*r;$s(i.m_data.m_attributes,this.m_attributes,0,0,n)}i.m_data.m_envelope2D=new X(this.m_envelope2D)}copyToIfNotNull(e,s){s.m_envelope2D=new X(this.m_envelope2D),s.releaseAttributes(),e.getTotalComponentCount()-2&&this.m_attributes&&(s.m_attributes=this.m_attributes.slice())}releaseAttributes(){this.m_attributes=null}isEmpty(){return this.m_envelope2D.isEmpty()}transformAttribute(e,s,i,r,n){F(0)}queryInterval(e,s,i,r){if(this.isEmpty())return void r.setEmpty();if(s===0)return void(i===0?this.m_envelope2D.queryIntervalX(r):i===1?this.m_envelope2D.queryIntervalY(r):bt(""));const n=Nl.getComponentCount(s);(i<0||i>=n)&&bt("");const o=e.getAttributeIndex(s);if(o>=0)return r.vmin=this.m_attributes[W3(e,0)+e.getPointAttributeOffset(o)-2+i],void(r.vmax=this.m_attributes[W3(e,1)+e.getPointAttributeOffset(o)-2+i]);{const a=Nl.getDefaultValue(s);return void r.setCoords(a,a)}}queryEnvelope3D(e,s){const i=new de;this.queryInterval(e,1,0,i),s.setCoords(this.m_envelope2D.xmin,this.m_envelope2D.ymin,i.vmin,this.m_envelope2D.xmax,this.m_envelope2D.ymax,i.vmax)}setEmpty(e){this.m_envelope2D.setEmpty();const s=e.getTotalComponentCount()-2;s&&(this.m_attributes?this.dbgAssertSize(s):this.m_attributes=Me(2*s,Number.NaN),this.m_attributes.fill(Number.NaN))}dbgAssertSize(e){}},Sn=class nN{constructor(e){if(this.m_EnvelopeType=4,this.m_description=Jr(),e===void 0)this.m_data=new $l;else if(e.vd!==void 0)this.m_description=e.vd,this.m_data=new $l,this.ensureAttributes_();else if(e!=null&&e.env2D)this.m_data=new $l({env2D:e.env2D});else if(e.xmin!==void 0)this.m_data=new $l({xmin:e.xmin,ymin:e.ymin,xmax:e.xmax,ymax:e.ymax});else if(e.copy)this.m_data=new $l,e.copy.copyTo(this);else if(e.move)this.m_description=e.move.m_description,e.move.m_description=null,this.m_data=new $l({move:e.move.m_data});else{if(!e.centerPoint)throw new Error("unrecognized Envelope constructor options");this.m_description=e.centerPoint.getDescription(),this.m_data=new $l,this.ensureAttributes_(),this.setFromPoint(e.centerPoint,e.width,e.height)}}accessEnvelopeData(){return this.m_description=null,this.m_data}assignMove(e){return this===e||(this.m_description=e.m_description,e.m_description=null,this.m_data=new $l({move:e.m_data})),this}assignCopy(e){return this===e||e.copyTo(this),this}transformAttribute(e,s,i,r,n){F(0)}setAttributeBasic(e,s,i){if(this.addAttribute(e),this.m_data.isEmpty())return;const r=this.queryInterval(e,s);r.vmin=i,r.vmax=i,this.setIntervalEnvelope(e,s,r)}mergeVertexDescriptionImpl(e){const s=Sx(this.getDescription(),e);this.assignVertexDescription(s)}asEnvelope2D(){return new X(this.m_data.m_envelope2D)}assignVertexDescription(e){this.m_description!==e&&this.assignVertexDescriptionImpl(e)}getGeometryType(){return G.enumEnvelope}getDimension(){return 2}getXMin(){return this.m_data.m_envelope2D.xmin}getYMin(){return this.m_data.m_envelope2D.ymin}getXMax(){return this.m_data.m_envelope2D.xmax}getYMax(){return this.m_data.m_envelope2D.ymax}width(){return this.m_data.isEmpty()?Number.NaN:this.m_data.m_envelope2D.width()}height(){return this.m_data.isEmpty()?Number.NaN:this.m_data.m_envelope2D.height()}getCenterXY(){return this.m_data.isEmpty()?new M:this.m_data.m_envelope2D.getCenter()}getCenter(e){if(e.assignVertexDescription(this.m_description),this.m_data.isEmpty())return void e.setEmpty();const s=this.m_description.getAttributeCount();for(let i=1;i<s;i++){const r=this.m_description.getSemantics(i),n=Nl.getComponentCount(r);for(let o=0;o<n;o++){const a=.5*(this.getAttributeAsDblImpl(0,r,o)+this.getAttributeAsDblImpl(1,r,o));e.setAttributeBasic(r,o,a)}}e.setXY(this.m_data.m_envelope2D.getCenter())}setCoords(e,s,i,r){this.m_data.m_envelope2D.setCoords({xmin:e,ymin:s,xmax:i,ymax:r})}setEnvelope(e){if(e instanceof X)this.m_data.m_envelope2D=new X(e),this.m_data.m_envelope2D.normalize();else{this.addAttribute(1),this.m_data.m_envelope2D=e.getEnvelope2D(),this.m_data.m_envelope2D.normalize();const s=de.constructEmpty();s.setCoords(e.zmin,e.zmax),this.setInterval(1,0,s.vmin,s.vmax)}}merge(e){if(e instanceof X)return e.isValid()||ee(""),void this.m_data.m_envelope2D.mergeEnvelope2D(e);if(e instanceof nN){if(e.m_data.isEmpty())return;const s=e.getDescription();this.mergeVertexDescription(s),this.m_data.m_envelope2D.mergeEnvelope2D(e.m_data.m_envelope2D);for(let i=1,r=s.getAttributeCount();i<r;i++){const n=s.getSemantics(i),o=Nl.getComponentCount(n);for(let a=0;a<o;a++){const l=e.queryInterval(n,a),u=this.queryInterval(n,a);u.merge(l),this.setIntervalEnvelope(n,a,u)}}}else if(e instanceof nt){const s=e;if(s.isEmpty())return;const i=s.getDescription();if(this.mergeVertexDescription(i),this.m_data.isEmpty())return void this.setFromPoint(s);this.m_data.m_envelope2D.merge(s.getXY());for(let r=1,n=i.getAttributeCount();r<n;r++){const o=i.getSemantics(r),a=Nl.getComponentCount(o);for(let l=0;l<a;l++){const u=s.getAttributeAsDbl(o,l),c=this.queryInterval(o,l);c.mergeCoordinate(u),this.setIntervalEnvelope(o,l,c)}}}else yt("unrecognized type for envelope.merge")}intersect(e){if(!this.m_data.m_envelope2D.intersect(e.m_data.m_envelope2D))return this.setEmpty(),!1;const s=e.getDescription();this.mergeVertexDescription(s);for(let i=1,r=this.m_description.getAttributeCount();i<r;i++){const n=this.m_description.getSemantics(i),o=Nl.getComponentCount(n);for(let a=0;a<o;a++){const l=e.queryInterval(n,a),u=this.queryInterval(n,a);u.intersect(l),this.setIntervalEnvelope(n,a,u)}}return!0}intersectCommonAttributes(e){if(!this.m_data.m_envelope2D.intersect(e.m_data.m_envelope2D))return this.setEmpty(),!1;const s=e.getDescription();for(let i=1,r=this.m_description.getAttributeCount();i<r;i++){const n=this.m_description.getSemantics(i);if(!s.hasAttribute(n))continue;const o=Nl.getComponentCount(n);for(let a=0;a<o;a++){const l=e.queryInterval(n,a),u=this.queryInterval(n,a);u.intersect(l),this.setIntervalEnvelope(n,a,u)}}return!0}move(e,s){this.m_data.m_envelope2D.move(e,s)}centerAt(e,s){this.m_data.m_envelope2D.centerAtCoords(e,s)}centerAtPoint(e){this.m_data.m_envelope2D.centerAt(e)}reaspect(e,s){this.m_data.m_envelope2D.reaspect(e,s)}inflateCoords(e,s){this.m_data.m_envelope2D.inflateCoords(e,s)}containsCoords(e,s){return this.m_data.m_envelope2D.containsCoords(e,s)}contains(e){return this.m_data.m_envelope2D.contains(e)}containsPoint(e){return!e.isEmpty()&&this.m_data.m_envelope2D.contains(e.getXY())}containsEnvelope(e){return this.m_data.m_envelope2D.containsEnvelope(e.m_data.m_envelope2D)}setIntervalEnvelope(e,s,i){if(this.addAttribute(e),this.m_data.isEmpty())return;const r=new de(i);if(r.normalize(),e===0){if(r.isEmpty())return void this.setEmpty();s===0?(this.m_data.m_envelope2D.xmin=r.vmin,this.m_data.m_envelope2D.xmax=r.vmax):s===1?(this.m_data.m_envelope2D.ymin=r.vmin,this.m_data.m_envelope2D.ymax=r.vmax):bt("")}else this.setAttributeAsDblImpl(0,e,s,r.vmin),this.setAttributeAsDblImpl(1,e,s,r.vmax)}setInterval(e,s,i,r){this.setIntervalEnvelope(e,s,new de(i,r))}queryInterval(e,s){const i=new de;return this.m_data.queryInterval(this.m_description,e,s,i),i}queryEnvelope(e){e.m_EnvelopeType!==2?e.m_EnvelopeType!==3?e.m_EnvelopeType!==4?yt("unrecognized type for queryEnveloper"):this.copyTo(e):this.m_data.queryEnvelope3D(this.m_description,e):e.setCoords({env2D:this.m_data.m_envelope2D})}applyTransformation(e){e.m_TransformationType!==1?F(0):e.transformEnvInPlace(this.m_data.m_envelope2D)}createInstance(){return new nN({vd:this.m_description})}copyTo(e){e!==this&&this.m_data.copyTo(this.m_description,e)}isEmpty(){return this.m_data.isEmpty()}setEmpty(){this.m_description||(this.m_description=Jr()),this.m_data.setEmpty(this.m_description)}calculateArea2D(){return this.m_data.m_envelope2D.getArea()}calculateLength2D(){return this.m_data.m_envelope2D.getLength()}calculateLength3D(e){return F(0),0}equals(e,s){if(e===this)return!0;const i=e;if(this.m_description!==i.m_description||this.m_data.isEmpty()!==i.m_data.isEmpty())return!1;if(this.m_data.isEmpty())return!0;if(s===void 0&&(s=0),Math.abs(this.m_data.m_envelope2D.xmin-i.m_data.m_envelope2D.xmin)>s||Math.abs(this.m_data.m_envelope2D.ymin-i.m_data.m_envelope2D.ymin)>s||Math.abs(this.m_data.m_envelope2D.xmax-i.m_data.m_envelope2D.xmax)>s||Math.abs(this.m_data.m_envelope2D.ymax-i.m_data.m_envelope2D.ymax)>s)return!1;for(let r=0,n=2*(this.m_description.getTotalComponentCount()-2);r<n;r++)if(!wx(this.m_data.m_attributes[r],i.m_data.m_attributes[r],s))return!1;return!0}getBoundary(){return yt("getBoundary not available in this context. Use the boundary operator with an envelope parameter"),null}clone(){return new nN({copy:this})}swap(e){if(this===e)return;e.getGeometryType()!==G.enumEnvelope&&ee("wrong geometry type");const s=e;s.m_description=be(this.m_description,this.m_description=s.m_description),s.m_data.m_envelope2D=be(this.m_data.m_envelope2D,this.m_data.m_envelope2D=s.m_data.m_envelope2D),s.m_data.m_attributes=be(this.m_data.m_attributes,this.m_data.m_attributes=s.m_data.m_attributes)}queryCoordinates(e){this.m_data.isEmpty()&&ee(""),this.m_data.m_envelope2D.queryCorners(e)}queryCornerByVal(e,s){(e<0||e>3)&&bt(""),s.assignVertexDescription(this.m_description);const i=this.getDescription().getAttributeCount();for(let r=1;r<i;r++){const n=this.m_description.getSemantics(r),o=Nl.getComponentCount(n);for(let a=0;a<o;a++)s.setAttributeBasic(n,a,this.getAttributeAsDblImpl(e%2,n,a))}s.setXY(this.m_data.m_envelope2D.queryCorner(e))}queryCorner(e,s){s.assign(this.m_data.m_envelope2D.queryCorner(e))}getDescription(){return this.m_description}mergeVertexDescription(e){this.m_description!==e&&(this.m_description&&this.m_description.hasAttributesFrom(e)||this.mergeVertexDescriptionImpl(e))}hasAttribute(e){return this.m_description.hasAttribute(e)}addAttribute(e){if(this.m_description.hasAttribute(e))return;const s=bP(this.m_description,e);this.assignVertexDescription(s)}dropAttribute(e){if(!this.m_description.hasAttribute(e))return;const s=xP(this.m_description,e);this.assignVertexDescription(s)}dropAllAttributes(){const e=Jr();e!==this.m_description&&this.assignVertexDescription(e)}queryLooseEnvelope(e){this.queryEnvelope(e)}replaceNaNs(e,s){if(this.addAttribute(e),this.m_data.isEmpty())return;const i=Nl.getComponentCount(e);for(let r=0;r<i;r++){const n=this.queryInterval(e,r);n.isEmpty()&&(n.vmin=s,n.vmax=s,this.setIntervalEnvelope(e,r,n))}}getImpl(){return this}setFromPoint(e,s,i){this.m_data.m_envelope2D.setCoords({center:e.getXY(),width:s??0,height:i??0});const r=e.getDescription();for(let n=1,o=r.getAttributeCount();n<o;n++){const a=r.getSemantics(n),l=Nl.getComponentCount(a);for(let u=0;u<l;u++){const c=e.getAttributeAsDbl(a,u);this.setInterval(a,u,c,c)}}}assignVertexDescriptionImpl(e){const s=lR();uR(e,this.m_description,s);let i=null;const r=e.getTotalComponentCount()-2,n=this.m_description?this.m_description.getTotalComponentCount()-2:0;r>0&&(i=Me(2*r,Number.NaN));for(let o=1;o<e.getAttributeCount();o++){const a=s[o];if(a!==-1){const l=e.getPointAttributeOffset(o)-2,u=Nl.getComponentCount(e.getSemantics(o)),c=this.m_description.getPointAttributeOffset(a)-2;$s(i,this.m_data.m_attributes,l,c,u),$s(i,this.m_data.m_attributes,r+l,n+c,u)}}this.releaseAttributes_(),this.m_data.m_attributes=i,this.m_description=e}getAttributeAsDblImpl(e,s,i){if(this.m_data.isEmpty()&&rR(""),s===0)return e?i?this.m_data.m_envelope2D.ymax:this.m_data.m_envelope2D.xmax:i?this.m_data.m_envelope2D.ymin:this.m_data.m_envelope2D.xmin;i>=Nl.getComponentCount(s)&&bt("");const r=this.m_description.getAttributeIndex(s);return r>=0?this.m_data.m_attributes[W3(this.m_description,e)+this.m_description.getPointAttributeOffset(r)-2+i]:Es.getDefaultValue(s)}setAttributeAsDblImpl(e,s,i,r){s===0&&(e?i===1?this.m_data.m_envelope2D.ymax=r:i===0?this.m_data.m_envelope2D.xmax=r:bt(""):i===1?this.m_data.m_envelope2D.ymin=r:i===0?this.m_data.m_envelope2D.xmin=r:bt(""));const n=Nl.getComponentCount(s);(i<0||i>=n)&&bt(""),this.addAttribute(s);const o=this.m_description.getAttributeIndex(s);this.m_data.m_attributes[W3(this.m_description,e)+this.m_description.getPointAttributeOffset(o)-2+i]=r}releaseAttributes_(){this.m_data.releaseAttributes()}ensureAttributes_(){this.m_data.ensureAttributes(this.m_description)}};Sn.type=G.enumEnvelope;Object.freeze(Object.defineProperty({__proto__:null,Envelope:Sn,EnvelopeData:$l},Symbol.toStringTag,{value:"Module"}));let mKe=class br{constructor(e,s,i){if(e instanceof br)return this.data=e.data,this.N=e.N,this.M=e.M,e.data=null,e.N=0,void(e.M=0);this.data=e,this.N=s,this.M=i}assignCopy(e){return this===e||(F(this.N*this.M==e.N*e.M),this.data.set(e.data),this.N=e.N,this.M=e.M),this}setZero(){var e;return(e=this.data)==null||e.fill(0),this}setIdentity(){for(let i=0;i<this.N;i++)for(let r=0;r<this.M;r++)this.setRowCol(i,r,i===r?1:0);return this}rows(){return this.N}cols(){return this.M}row(e){return F(0),{}}set(e,s){return this.data[e]=s,this}setRowCol(e,s,i){return this.data[e*this.M+s]=i,this}at(e){return this.data[e]}atRowCol(e,s){return this.data[e*this.M+s]}mulScalar(e,s){F(0)}mul(e,s){if(F(this.M===e.rows()),F(this.N===s.rows()),F(e.cols()===s.cols()),s===this){const r=new Float64Array(this.N*this.M),n=new br(r,this.N,this.M);return this.mul(e,n),void s.assignCopy(n)}if(s===e){const r=new Float64Array(e.N*e.M),n=new br(r,e.N,e.M);return this.mul(e,n),void s.assignCopy(n)}const i=e.cols();for(let r=0;r<this.N;r++)for(let n=0;n<i;n++){let o=0;for(let a=0;a<this.M;a++)o+=this.atRowCol(r,a)*e.atRowCol(a,n);s.setRowCol(r,n,o)}}mulTranspose(e,s){if(F(this.M===e.cols()),F(this.N===s.rows()),F(e.rows()===s.cols()),s===this){const r=new Float64Array(this.N*this.M),n=new br(r,this.N,this.M);return this.mulTranspose(e,n),void s.assignCopy(n)}if(s===e){const r=new Float64Array(e.N*e.M),n=new br(r,e.N,e.M);return this.mulTranspose(e,n),void s.assignCopy(n)}const i=e.rows();for(let r=0;r<this.N;r++)for(let n=0;n<i;n++){let o=0;for(let a=0;a<this.M;a++)o+=this.atRowCol(r,a)*e.atRowCol(n,a);s.setRowCol(r,n,o)}}mulLeft(e,s){F(0)}mulLeftTranspose(e,s){F(0)}mulDiag(e,s){if(F(this.M===e.N*e.M),F(this.N===s.rows()),F(this.M===s.cols()),s===this){const r=new Float64Array(this.N*this.M),n=new br(r,this.N,this.M);return this.mulDiag(e,n),void s.assignCopy(n)}const i=this.M;for(let r=0;r<this.N;r++)for(let n=0;n<i;n++)s.setRowCol(r,n,this.atRowCol(r,n)*e.at(n))}transposeInPlace(){if(this.N===this.M){for(let i=0;i<this.N;i++)for(let r=i+1;r<this.M;r++){const n=this.atRowCol(i,r);this.setRowCol(i,r,this.atRowCol(r,i)),this.setRowCol(r,i,n)}return this}const e=new Float64Array(this.N*this.M),s=new br(e,this.N,this.M);return s.assignCopy(this),this.M=be(this.N,this.N=this.M),s.transpose(this),this}transpose(e){if(this!==e){br.checkDims(e,this.M,this.N);for(let s=0;s<this.N;s++)for(let i=0;i<this.M;i++)e.setRowCol(i,s,this.atRowCol(s,i))}else e.transposeInPlace()}add(e,s){}svd(e,s,i,r=!1){if(br.checkDims(e,this.N,this.M),br.checkDims(s,this.M,1),br.checkDims(i,this.M,this.M),r){if(F(this.N===this.M),!this.symmetricEigen(s,i))return!1;for(let q=0;q<this.M;++q)s.at(q)<0&&s.set(q,0);return e.assignCopy(i),!0}let n,o,a,l,u,c,h,m=0,f=0,g=0,v=0,b=0;const w=this.M,S=this.N;e.assignCopy(this);const T=new Float64Array(w),P=new br(T,w,1),I=(q,U)=>U>=0?Math.abs(q):-Math.abs(q),A=(q,U)=>{if((q=Math.abs(q))>(U=Math.abs(U))){const V=U/q;return q*Math.sqrt(V*V+1)}if(U>0){const V=q/U;return U*Math.sqrt(V*V+1)}return 0};for(let q=0;q<w;q++){if(m=q+1,P.set(q,v*g),g=l=v=0,q<S){for(let V=q;V<S;V++)v+=Math.abs(e.atRowCol(V,q));if(v){for(let V=q;V<S;V++)e.setRowCol(V,q,e.atRowCol(V,q)/v),l+=e.atRowCol(V,q)*e.atRowCol(V,q);o=e.atRowCol(q,q),g=-I(Math.sqrt(l),o),a=o*g-l,e.setRowCol(q,q,o-g);for(let V=m;V<w;V++){l=0;for(let B=q;B<S;B++)l+=e.atRowCol(B,q)*e.atRowCol(B,V);o=l/a;for(let B=q;B<S;B++)e.setRowCol(B,V,e.atRowCol(B,V)+o*e.atRowCol(B,q))}for(let V=q;V<S;V++)e.setRowCol(V,q,e.atRowCol(V,q)*v)}}if(s.set(q,v*g),g=l=v=0,q<S&&q!==w-1){for(let V=m;V<w;V++)v+=Math.abs(e.atRowCol(q,V));if(v){for(let V=m;V<w;V++)e.setRowCol(q,V,e.atRowCol(q,V)/v),l+=e.atRowCol(q,V)*e.atRowCol(q,V);o=e.atRowCol(q,m),g=-I(Math.sqrt(l),o),a=o*g-l,e.setRowCol(q,m,o-g);for(let V=m;V<w;V++)P.set(V,e.atRowCol(q,V)/a);for(let V=m;V<S;V++){l=0;for(let B=m;B<w;B++)l+=e.atRowCol(V,B)*e.atRowCol(q,B);for(let B=m;B<w;B++)e.setRowCol(V,B,e.atRowCol(V,B)+l*P.at(B))}for(let V=m;V<w;V++)e.setRowCol(q,V,e.atRowCol(q,V)*v)}}const U=Math.abs(s.at(q))+Math.abs(P.at(q));b=U>b?U:b}for(let q=w-1;q>=0;q--){if(q<w-1){if(g){for(let U=m;U<w;U++)i.setRowCol(U,q,e.atRowCol(q,U)/e.atRowCol(q,m)/g);for(let U=m;U<w;U++){l=0;for(let V=m;V<w;V++)l+=e.atRowCol(q,V)*i.atRowCol(V,U);for(let V=m;V<w;V++)i.setRowCol(V,U,i.atRowCol(V,U)+l*i.atRowCol(V,q))}}for(let U=m;U<w;U++)i.setRowCol(q,U,0),i.setRowCol(U,q,0)}i.setRowCol(q,q,1),g=P.at(q),m=q}for(let q=(S<w?S:w)-1;q>=0;q--){m=q+1,g=s.at(q);for(let U=m;U<w;U++)e.setRowCol(q,U,0);if(g){g=1/g;for(let U=m;U<w;U++){l=0;for(let V=m;V<S;V++)l+=e.atRowCol(V,q)*e.atRowCol(V,U);o=l/e.atRowCol(q,q)*g;for(let V=q;V<S;V++)e.setRowCol(V,U,e.atRowCol(V,U)+o*e.atRowCol(V,q))}for(let U=q;U<S;U++)e.setRowCol(U,q,e.atRowCol(U,q)*g)}else for(let U=q;U<S;U++)e.setRowCol(U,q,0);e.setRowCol(q,q,e.atRowCol(q,q)+1)}for(let q=w-1;q>=0;q--)for(let U=1;;U++){let V=1;for(m=q;m>=0;m--){if(f=m-1,Math.abs(P.at(m))+b===b){V=0;break}if(Math.abs(s.at(f))+b===b)break}if(V){n=0,l=1;for(let B=m;B<=q&&(o=l*P.at(B),P.set(B,P.at(B)*n),Math.abs(o)+b!==b);B++){g=s.at(B),a=A(o,g),s.set(B,a),a=1/a,n=g*a,l=-o*a;for(let H=0;H<S;H++)c=e.atRowCol(H,f),h=e.atRowCol(H,B),e.setRowCol(H,f,c*n+h*l),e.setRowCol(H,B,h*n-c*l)}}if(h=s.at(q),m===q){if(h<0){s.set(q,-h);for(let B=0;B<w;B++)i.setRowCol(B,q,-i.atRowCol(B,q))}break}if(U===100)return!1;u=s.at(m),f=q-1,c=s.at(f),g=P.at(f),a=P.at(q),o=((c-h)*(c+h)+(g-a)*(g+a))/(2*a*c),g=A(o,1),o=((u-h)*(u+h)+a*(c/(o+I(g,o))-a))/u,n=l=1;for(let B=m;B<=f;B++){const H=B+1;g=P.at(H),c=s.at(H),a=l*g,g*=n,h=A(o,a),P.set(B,h),n=o/h,l=a/h,o=u*n+g*l,g=g*n-u*l,a=c*l,c*=n;for(let W=0;W<w;W++)u=i.atRowCol(W,B),h=i.atRowCol(W,H),i.setRowCol(W,B,u*n+h*l),i.setRowCol(W,H,h*n-u*l);h=A(o,a),s.set(B,h),h&&(h=1/h,n=o*h,l=a*h),o=n*g+l*c,u=n*c-l*g;for(let W=0;W<S;W++)c=e.atRowCol(W,B),h=e.atRowCol(W,H),e.setRowCol(W,B,c*n+h*l),e.setRowCol(W,H,h*n-c*l)}P.set(m,0),P.set(q,o),s.set(q,u)}const D=new Float64Array(this.N),k=new Float64Array(this.M),R=new br(D,this.N,1),O=new br(k,this.M,1);let z=1;do z*=3,z++;while(z<=this.M);do{z/=3,z=Math.trunc(z);for(let q=z;q<this.M;q++){const U=s.at(q);for(let B=0;B<this.N;B++)R.set(B,e.atRowCol(B,q));for(let B=0;B<this.M;B++)O.set(B,i.atRowCol(B,q));let V=q;for(;s.at(V-z)<U;){s.set(V,s.at(V-z));for(let B=0;B<this.N;B++)e.setRowCol(B,V,e.atRowCol(B,V-z));for(let B=0;B<this.M;B++)i.setRowCol(B,V,i.atRowCol(B,V-z));if(V-=z,V<z)break}s.set(V,U);for(let B=0;B<this.N;B++)e.setRowCol(B,V,R.at(B));for(let B=0;B<this.M;B++)i.setRowCol(B,V,O.at(B))}}while(z>1);for(let q=0;q<this.M;q++){let U=0;for(let V=0;V<this.N;V++)e.atRowCol(V,q)<0&&U++;for(let V=0;V<this.M;V++)i.atRowCol(V,q)<0&&U++;if(U>Math.trunc((this.N+this.M)/2)){for(let V=0;V<this.N;V++)e.setRowCol(V,q,-e.atRowCol(V,q));for(let V=0;V<this.M;V++)i.setRowCol(V,q,-i.atRowCol(V,q))}}return!0}isSymmetric(){if(this.N!==this.M)return!1;for(let e=0;e<this.N;e++)for(let s=e+1;s<this.M;s++)if(this.atRowCol(e,s)!==this.atRowCol(s,e))return!1;return!0}isZero(){return F(0),!1}isIdentity(){return F(0),!1}equals(e,s){if(s!==void 0&&F(0),this.N!==e.N||this.M!==e.M)return!1;for(let i=0;i<this.N*this.M;i++)if(this.data[i]!==e.data[i])return!1;return!0}maxElement(){return F(0),0}minElement(){return F(0),0}determinant(){if(F(this.N===this.M),this.N===1)return this.data[0];if(this.N===2)return this.data[0]*this.data[3]-this.data[1]*this.data[2];if(this.N===3){const n=this;return n.atRowCol(0,0)*(n.atRowCol(1,1)*n.atRowCol(2,2)-n.atRowCol(1,2)*n.atRowCol(2,1))-n.atRowCol(0,1)*(n.atRowCol(1,0)*n.atRowCol(2,2)-n.atRowCol(2,0)*n.atRowCol(1,2))+n.atRowCol(0,2)*(n.atRowCol(1,0)*n.atRowCol(2,1)-n.atRowCol(1,1)*n.atRowCol(2,0))}const e=new Float64Array(this.N*this.N),s=new br(e,this.N,this.N),i=new Float64Array(this.N);if(!this.luDecomposition(s,i))return 0;let r=1;for(let n=0;n<this.N;n++)r*=s.atRowCol(n,n),i[n]!==n&&(r=-r);return r}submatrix(e,s,i){F(0)}inverse(e){F(0)}pseudoInverse(e,s=!1,i=2220446049250313e-31){if(e.setZero(),this.N===1&&this.M===1)return this.atRowCol(0,0)!==0?e.setRowCol(0,0,1/this.atRowCol(0,0)):e.setRowCol(0,0,0),!0;if(this.N===2&&this.M===2){const m=this.atRowCol(0,0)*this.atRowCol(1,1)-this.atRowCol(0,1)*this.atRowCol(1,0),f=1e-5*(Math.abs(this.atRowCol(0,0)*this.atRowCol(1,1))+Math.abs(this.atRowCol(0,1)*this.atRowCol(1,0)));if(Math.abs(m)>f)return e.setRowCol(0,0,this.atRowCol(1,1)/m),e.setRowCol(0,1,-this.atRowCol(0,1)/m),e.setRowCol(1,0,-this.atRowCol(1,0)/m),e.setRowCol(1,1,this.atRowCol(0,0)/m),!0}const r=new Float64Array(this.N*this.M),n=new br(r,this.N,this.M),o=new Float64Array(this.M),a=new br(o,this.M,1),l=new Float64Array(this.M*this.M),u=new br(l,this.M,this.M);if(!this.svd(n,a,u,s))return!1;const c=Math.max(this.N,this.M),h=i*Math.abs(a.at(0))*c;for(let m=0;m<this.M;m++)a.at(m)>h?a.set(m,1/a.at(m)):a.set(m,0);return u.mulDiag(a,e),e.mulTranspose(n,e),!0}luDecomposition(e,s){return F(0),!1}symmetricEigen(e,s){F(this.rows()===this.cols()),F(this.rows()===e.rows()),F(s.rows()===s.cols()&&s.rows()===this.rows()),F(this.isSymmetric());const i=new Float64Array(this.N*this.M),r=new br(i,this.N,this.M);r.assignCopy(this);const n=100/Number.EPSILON,o=this.rows(),a=new Float64Array(o),l=new Float64Array(o),u=new br(a,o,1),c=new br(l,o,1);for(let m=0;m<o;m++)u.set(m,r.atRowCol(m,m)),e.set(m,r.atRowCol(m,m)),c.set(m,0);s.setIdentity();const h=()=>{const m=u;s.transposeInPlace();let f=1;do f*=3,f++;while(f<=o);do{f/=3,f=Math.trunc(f);for(let g=f;g<o;g++){const v=e.at(g),b=Math.abs(v);for(let S=0;S<this.M;S++)m.set(S,s.atRowCol(S,g));let w=g;for(;Math.abs(e.at(w-f))<b;){e.set(w,e.at(w-f));for(let S=0;S<this.M;S++)s.setRowCol(S,w,s.atRowCol(S,w-f));if(w-=f,w<f)break}if(w!==g){e.set(w,v);for(let S=0;S<this.M;S++)s.setRowCol(S,w,m.at(S))}}}while(f>1)};for(let m=1;;m++){let f=0;for(let v=1;v<o;v++)for(let b=0;b<v;b++)f+=Math.abs(r.atRowCol(v,b));if(f===0)return h(),!0;const g=m<4?.2*f/(o*o):0;for(let v=0;v<o;v++)for(let b=v+1;b<o;b++){let w=n*Math.abs(r.atRowCol(b,v));if(m>4&&w<=Math.abs(e.at(v))&&w<=Math.abs(e.at(b)))r.setRowCol(b,v,0);else if(Math.abs(r.atRowCol(b,v))>g){let S,T=e.at(b)-e.at(v);if(w<Math.abs(T))S=r.atRowCol(b,v)/T;else{const k=.5*T/r.atRowCol(b,v);S=1/(Math.abs(k)+Math.sqrt(1+k*k)),k<0&&(S=-S)}const P=1/Math.sqrt(1+S*S),I=S*P,A=I/(1+P);T=S*r.atRowCol(b,v),c.set(v,c.at(v)-T),c.set(b,c.at(b)+T),e.set(v,e.at(v)-T),e.set(b,e.at(b)+T),r.setRowCol(b,v,0);let D=0;for(;D<v;D++)w=r.atRowCol(v,D),T=r.atRowCol(b,D),r.setRowCol(v,D,w-I*(T+w*A)),r.setRowCol(b,D,T+I*(w-T*A));for(D++;D<b;D++)w=r.atRowCol(D,v),T=r.atRowCol(b,D),r.setRowCol(D,v,w-I*(T+w*A)),r.setRowCol(b,D,T+I*(w-T*A));for(D++;D<o;D++)w=r.atRowCol(D,v),T=r.atRowCol(D,b),r.setRowCol(D,v,w-I*(T+w*A)),r.setRowCol(D,b,T+I*(w-T*A));for(D=0;D<o;D++)w=s.atRowCol(v,D),T=s.atRowCol(b,D),s.setRowCol(v,D,w-I*(T+w*A)),s.setRowCol(b,D,T+I*(w-T*A))}}for(let v=0;v<o;v++)u.set(v,u.at(v)+c.at(v)),e.set(v,u.at(v)),c.set(v,0)}}static checkDims(e,s,i){F(e.rows()===s&&e.cols()===i)}},md=class extends mKe{constructor(e){if(e.copy){const i=new Float64Array(e.copy.N*e.copy.M);return super(i,e.copy.N,e.copy.M),this.buffer=i,void this.assignCopy(e.copy)}const s=new Float64Array(e.NN*e.MM);super(s,e.NN,e.MM),this.buffer=s,e.initializerList&&$s(this.buffer,e.initializerList,0,0,e.initializerList.length)}assignCopy(e){return this===e||super.assignCopy(e),this}},Rt=class lf{constructor(e){this.m_TransformationType=1,e===void 0?this.setIdentity():e instanceof lf?this.set(e):this.setScale(e)}set(e){return this.xx=e.xx,this.xy=e.xy,this.xd=e.xd,this.yx=e.yx,this.yy=e.yy,this.yd=e.yd,this}clone(){return new lf().set(this)}setZero(){this.xx=0,this.yy=0,this.xy=0,this.yx=0,this.xd=0,this.yd=0}isEqual(e){return this===e||this.xx===e.xx&&this.xy===e.xy&&this.xd===e.xd&&this.yx===e.yx&&this.yy===e.yy&&this.yd===e.yd}transformInPlace(e){const s=this.xx*e.x+this.xy*e.y+this.xd,i=this.yx*e.x+this.yy*e.y+this.yd;e.x=s,e.y=i}transform(e){const s=e.clone();return this.transformInPlace(s),s}queryTransform(e,s){const i=this.xx*e.x+this.xy*e.y+this.xd,r=this.yx*e.x+this.yy*e.y+this.yd;s.setCoords(i,r)}transformEnvInPlace(e){if(e.isEmpty())return;const s=ne(M,4);e.queryCorners(s),this.transformPoints2D(s,4,s),e.setFromPoints(s,4)}queryTransformEnv(e,s){F(0)}transformPoints2D(e,s,i){for(let r=0;r<s;++r)this.queryTransform(e[r],i[r])}transformInterleavedPoints(e,s,i){s*=2;const r=M.getNAN();for(let n=0;n<s;n+=2)r.x=e[n],r.y=e[n+1],this.transformInPlace(r),i[n]=r.x,i[n+1]=r.y}multiply(e){return lf.st_multiply(this,e,this),this}mulLeft(e){return F(0),this}static st_multiply(e,s,i){const r=e.xx*s.xx+e.yx*s.xy,n=e.xy*s.xx+e.yy*s.xy,o=e.xd*s.xx+e.yd*s.xy+s.xd,a=e.xx*s.yx+e.yx*s.yy,l=e.xy*s.yx+e.yy*s.yy,u=e.xd*s.yx+e.yd*s.yy+s.yd;i.xx=r,i.xy=n,i.xd=o,i.yx=a,i.yy=l,i.yd=u}getCoefficients(e){F(e.length>=6),e[0]=this.xx,e[1]=this.xy,e[2]=this.xd,e[3]=this.yx,e[4]=this.yy,e[5]=this.yd}setCoefficients(e){F(e.length>=6),this.xx=e[0],this.xy=e[1],this.xd=e[2],this.yx=e[3],this.yy=e[4],this.yd=e[5]}copyTo(e){F(0)}initializeFromRect(e,s){e.isEmpty()||s.isEmpty()||!e.width()||!e.height()?this.setZero():(this.xy=this.yx=0,this.xx=s.width()/e.width(),this.yy=s.height()/e.height(),this.xd=s.xmin-e.xmin*this.xx,this.yd=s.ymin-e.ymin*this.yy)}initializeFromRectIsotropic(e,s){if(e.isEmpty()||!e.width()||!e.height()||s.isEmpty())this.setZero();else{this.yx=0,this.xy=0,this.xx=s.width()/e.width(),this.yy=s.height()/e.height(),this.xx>this.yy?this.xx=this.yy:this.yy=this.xx;const i=s.getCenter(),r=e.getCenter();this.xd=i.x-r.x*this.xx,this.yd=i.y-r.y*this.yy}}initializeFromTwoPointsArray(e,s){if(e[0].equals(s[0])&&e[1].equals(s[1]))return void this.setIdentity();if(e[0].equals(e[1])){if(s[0].equals(s[1]))return void this.setShift(s[0].sub(e[0]));ee("")}if(!e[0].equals(e[1])&&s[0].equals(s[1]))return this.setZero(),void this.shift(s[0]);this.setShiftCoords(-e[0].x,-e[0].y);const i=M.distance(e[0],e[1]),r=M.distance(s[0],s[1]),n=r/i;this.scale(n,n);const o=e[1].sub(e[0]);o.divThis(i);const a=s[1].sub(s[0]);a.divThis(r);const l=o.crossProduct(a),u=o.dotProduct(a);this.rotate(u,l),this.shiftCoords(s[0].x,s[0].y)}initializeFromTwoPoints(e,s,i,r){const n=[e,s],o=[i,r];this.initializeFromTwoPointsArray(n,o)}transformSizeInPlace(e){F(0)}transformSize(e,s){F(0)}transformTol(e){return F(0),0}transformWithoutTranslateArray(e,s,i){for(let r=0;r<s;++r)this.transformWithoutTranslate(e[r],i[r])}transformWithoutTranslateInPlace(e){const s=this.xx*e.x+this.xy*e.y,i=this.yx*e.x+this.yy*e.y;e.setCoords(s,i)}transformWithoutTranslate(e,s){const i=this.xx*e.x+this.xy*e.y,r=this.yx*e.x+this.yy*e.y;s.setCoords(i,r)}setIdentity(){this.xx=1,this.xy=0,this.xd=0,this.yx=0,this.yy=1,this.yd=0}isIdentity(){return!(this.xx!==1||this.yy!==1||this.xy||this.xd||this.yx||this.yd)}isIdentityTol(e){const s=e*e;return!(Pt(this.xd)+Pt(this.yd)>s)&&!(Pt(this.xy+this.xd)+Pt(this.yy+this.yd-1)>s)&&!(Pt(this.xx+this.xd-1)+Pt(this.yx+this.yd)>s)}isReflective(){return this.xx*this.yy-this.yx*this.xy<0}isUniform(e){const s=this.xx*this.xx+this.yx*this.yx,i=this.xy*this.xy+this.yy*this.yy,r=(s+i)*e;return Math.abs(s-i)<=r&&Math.abs(this.xx*this.xy+this.yx*this.yy)<=r}isUniformNoRotation(){return this.xx!==0&&Math.abs(this.xx)===Math.abs(this.yy)&&this.xy===0&&this.yx===0}isTranslate(){return this.xx===1&&this.yy===1&&!this.xy&&!this.yx}isTranslateTol(e){const s=new M;return s.setCoords(0,1),this.transformWithoutTranslateInPlace(s),s.y-=1,!(s.sqrLength()>e*e)&&(s.setCoords(1,0),this.transformWithoutTranslateInPlace(s),s.x-=1,s.sqrLength()<=e*e)}isOrthonormal(e){const s=new lf;return s.xx=this.xx*this.xx+this.xy*this.xy,s.xy=this.xx*this.yx+this.xy*this.yy,s.yx=this.yx*this.xx+this.yy*this.xy,s.yy=this.yx*this.yx+this.yy*this.yy,s.xd=0,s.yd=0,s.isIdentityTol(e)}isDegenerate(e){return Math.abs(this.xx*this.yy-this.yx*this.xy)<=2*e*(Math.abs(this.xx*this.yy)+Math.abs(this.yx*this.xy))}isZero(){return this.xx===0&&this.yy===0&&this.xy===0&&this.yx===0&&this.xd===0&&this.yd===0}isScaleAndTranslateTol(e){return this.xy*this.xy+this.yx*this.yx<=(this.xx*this.xx+this.yy*this.yy)*e}setTranslate(e,s){return this.xx=1,this.xy=0,this.xd=e,this.yx=0,this.yy=1,this.yd=s,this}setShiftCoords(e,s){return this.xx=1,this.xy=0,this.xd=e,this.yx=0,this.yy=1,this.yd=s,this}setShift(e){return this.xx=1,this.xy=0,this.xd=e.x,this.yx=0,this.yy=1,this.yd=e.y,this}setScaleCoords(e,s){return this.xx=e,this.xy=0,this.xd=0,this.yx=0,this.yy=s,this.yd=0,this}setScale(e){return this.setScaleCoords(e,e),this}setFlipX(e,s){return this.xx=-1,this.xy=0,this.xd=e+s,this.yx=0,this.yy=1,this.yd=0,this}setFlipY(e,s){return this.xx=1,this.xy=0,this.xd=0,this.yx=0,this.yy=-1,this.yd=e+s,this}setShear(e,s){return this.xx=1,this.xy=e,this.xd=0,this.yx=s,this.yy=1,this.yd=0,this}scale(e,s){return this.xx*=e,this.xy*=e,this.xd*=e,this.yx*=s,this.yy*=s,this.yd*=s,this}setRotateAngle(e){return this.setRotate(Math.cos(e),Math.sin(e))}setRotate(e,s){return this.xx=e,this.xy=-s,this.xd=0,this.yx=s,this.yy=e,this.yd=0,this}setRotateAngleAbout(e,s){return this.setRotateAbout(Math.cos(e),Math.sin(e),s)}setRotateAbout(e,s,i){return this.setTranslate(-i.x,-i.y),this.rotate(e,s),this.translate(i.x,i.y)}setSwapCoordinates(){return this.xx=0,this.xy=1,this.xd=0,this.yx=1,this.yy=0,this.yd=0,this}setRotateCw90(){return this.xx=0,this.xy=1,this.xd=0,this.yx=-1,this.yy=0,this.yd=0,this}setRotateCcw90(){return this.xx=0,this.xy=-1,this.xd=0,this.yx=1,this.yy=0,this.yd=0,this}shiftCoords(e,s){return this.xd+=e,this.yd+=s,this}shift(e){return this.xd+=e.x,this.yd+=e.y,this}translate(e,s){return this.xd+=e,this.yd+=s,this}flipX(e,s){return this.xx=-this.xx,this.xy=-this.xy,this.xd=e+s-this.xd,this}flipY(e,s){return this.yx=-this.yx,this.yy=-this.yy,this.yd=e+s-this.yd,this}shear(e,s){const i=new lf;return i.setShear(e,s),this.multiply(i)}rotateAngle(e){const s=new lf;return s.setRotateAngle(e),this.multiply(s)}rotate(e,s){const i=new lf;return i.setRotate(e,s),this.multiply(i)}rotateAbout(e,s,i){return this.translate(-i.x,-i.y),this.rotate(e,s),this.translate(i.x,i.y)}rotateAngleAbout(e,s){return this.rotateAbout(Math.cos(e),Math.sin(e),s)}setInvert(e){return this.set(e),this.invertThis()}invertThis(){let e=this.xx*this.yy-this.xy*this.yx;if(e===0)return this.setZero(),this;e=1/e;const s=(this.xy*this.yd-this.xd*this.yy)*e,i=(this.xd*this.yx-this.xx*this.yd)*e,r=this.yy*e,n=-this.xy*e,o=-this.yx*e,a=this.xx*e;return this.xd=s,this.yd=i,this.xx=r,this.yy=a,this.xy=n,this.yx=o,this}invertPrecise(e){return this.set(e),this.invertPreciseThis()}invertPreciseThis(){const e=Ae.constructDouble(this.xy),s=Ae.constructDouble(this.xx),i=s.mulDouble(this.yy).sub(e.mulDouble(this.yx));if(i.isZero())return this.setZero(),this;const r=i.clone();r.invertThis();const n=Ae.constructDouble(this.xd),o=e.mulDouble(this.yd).sub(n.mulDouble(this.yy)).mul(r).toDouble(),a=n.mulDouble(this.yx).sub(s.mulDouble(this.yd)).mul(r).toDouble(),l=r.mulDouble(this.yy).toDouble(),u=r.mulDouble(-this.xy).toDouble(),c=r.mulDouble(-this.yx).toDouble(),h=r.mulDouble(this.xx).toDouble();return this.xd=o,this.yd=a,this.xx=l,this.yy=h,this.xy=u,this.yx=c,this}extractScaleTransform(e,s){const i=Math.sqrt(this.xx*this.xx+this.xy*this.xy),r=Math.sqrt(this.yx*this.yx+this.yy*this.yy);s.setScaleCoords(1/i,1/r),s.multiply(this),e.setScaleCoords(i,r)}setFromTwoTriangles(e,s){let i=!0;for(let c=0;c<3;++c)i=i&&e[c].equals(s[c]);if(i)return this.setIdentity(),!0;const r=new M;r.setSub(e[0],e[1]);const n=new M;n.setSub(e[0],e[2]);const o=new M;o.setSub(s[0],s[1]);const a=new M;a.setSub(s[0],s[2]);const l=4*Number.EPSILON*(Math.abs(r.x*n.y)+Math.abs(n.x*r.y));let u=r.x*n.y-r.y*n.x;return Math.abs(u)>l?(u=1/u,this.xx=(o.x*n.y-r.y*a.x)*u,this.xy=(r.x*a.x-o.x*n.x)*u,this.yx=(o.y*n.y-r.y*a.y)*u,this.yy=(r.x*a.y-o.y*n.x)*u,this.xd=s[0].x-(this.xx*e[0].x+this.xy*e[0].y),this.yd=s[0].y-(this.yx*e[0].x+this.yy*e[0].y),!0):(this.setZero(),!1)}initializeFromControlPoints(e,s,i,r,n=null){return s===0?(this.setIdentity(),void(n&&n.setIdentity())):s===1?(this.setShift(r[0].sub(i[0])),void(n&&n.setShift(i[0].sub(r[0])))):(s<3&&(e=1),void(e===4&&s>2?dKe(this,s,i,r,n):pKe(e,this,s,i,r,n)))}calculateErrors(e,s,i,r){F(e>0&&s!==null&&i!==null);let n=0;for(let o=0;o<e;++o){const a=this.transform(s[o]),l=M.sqrDistance(i[o],a);n+=l,r&&(r[o]=Math.sqrt(l))}return Math.sqrt(n/e)}};const o2=[43,11,41,9,61];function U8(t,e){F(!(e.rows()!==2&&e.rows()!==3||e.cols()!==2&&e.rows()!==3)),t.xx=e.atRowCol(0,0),t.xy=e.atRowCol(0,1),t.yx=e.atRowCol(1,0),t.yy=e.atRowCol(1,1),e.cols()===3?(t.xd=e.atRowCol(0,2),t.yd=e.atRowCol(1,2)):(t.xd=0,t.yd=0)}function dKe(t,e,s,i,r){const n=M.average(s,e),o=M.average(i,e),a=new md({NN:2,MM:2});a.setZero();const l=new md({NN:2,MM:2});l.setZero();for(let h=0;h<e;++h)a.setRowCol(0,0,a.atRowCol(0,0)+(s[h].x-n.x)*(s[h].x-n.x)),a.setRowCol(0,1,a.atRowCol(0,1)+(s[h].x-n.x)*(s[h].y-n.y)),a.setRowCol(1,1,a.atRowCol(1,1)+(s[h].y-n.y)*(s[h].y-n.y)),l.setRowCol(0,0,l.atRowCol(0,0)+(i[h].x-o.x)*(s[h].x-n.x)),l.setRowCol(0,1,l.atRowCol(0,1)+(i[h].x-o.x)*(s[h].y-n.y)),l.setRowCol(1,0,l.atRowCol(1,0)+(i[h].y-o.y)*(s[h].x-n.x)),l.setRowCol(1,1,l.atRowCol(1,1)+(i[h].y-o.y)*(s[h].y-n.y));a.setRowCol(1,0,a.atRowCol(0,1));const u=new md({NN:2,MM:2});a.pseudoInverse(u,!0)||$8("Failed to compute pseudo inverse"),l.mul(u,l),U8(t,l);const c=n.clone();t.transformInPlace(c),t.xd=o.x-c.x,t.yd=o.y-c.y,r&&(l.pseudoInverse(u,!1)||$8("Failed to compute pseudo inverse"),U8(r,u),r.transformInPlace(o),r.xd=n.x-o.x,r.yd=n.y-o.y)}function pKe(t,e,s,i,r,n){F(t===1||t===0||t===2||t===3),e.setIdentity();const o=M.average(i,s),a=M.average(r,s);if(F(t<o2.length&&t>0),8&o2[t]){const u=new md({NN:2,MM:2});u.setZero();for(let b=0;b<s;++b)u.setRowCol(0,0,u.atRowCol(0,0)+(r[b].x-a.x)*(i[b].x-o.x)),u.setRowCol(1,0,u.atRowCol(1,0)+(r[b].x-a.x)*(i[b].y-o.y)),u.setRowCol(0,1,u.atRowCol(0,1)+(r[b].y-a.y)*(i[b].x-o.x)),u.setRowCol(1,1,u.atRowCol(1,1)+(r[b].y-a.y)*(i[b].y-o.y));const c=new md({NN:2,MM:2}),h=new md({NN:2,MM:1}),m=new md({NN:2,MM:2});u.svd(c,h,m)||$8("Failed to compute svd");const f=new md({NN:2,MM:2});c.transpose(f);const g=new md({NN:2,MM:2});m.mul(f,g),!(32&o2[t])&&g.determinant()<0&&(f.setRowCol(1,0,-f.atRowCol(1,0)),f.setRowCol(1,1,-f.atRowCol(1,1)),m.mul(f,g));const v=new Rt;U8(v,g),e.set(v)}if(2&o2[t]){let u=0,c=0;for(let h=0;h<s;++h){const m=i[h].sub(o);u+=m.sqrLength(),e.transformInPlace(m),c+=m.dotProduct(r[h].sub(a))}if(u===0)c===0?e.setIdentity():e.setZero();else{const h=c/u;e.scale(h,h)}}else F(!(4&o2[t]));const l=o.clone();e.transformInPlace(l),e.xd=a.x-l.x,e.yd=a.y-l.y,n&&(n.set(e),n.invertThis(),n.isZero()&&(n.xd=o.x,n.yd=o.y))}class nm{*[Symbol.iterator](){let e=this.next();for(;e;)yield e,e=this.next()}}let kd=class extends nm{constructor(e){super(),this.m_iGeom=-1,this.m_aGeoms=e?e.slice():[]}next(){if(this.m_iGeom<this.m_aGeoms.length-1){const e=this.m_aGeoms[++this.m_iGeom];return this.m_aGeoms[this.m_iGeom]=null,e}return null}tock(){return!1}getGeometryID(){return this.m_iGeom}getRank(){return 1}},iM=class{constructor(){this.posStream=null,this.streams=null}get(e){return e>0?this.streams[e-1]:this.posStream}set(e,s){e>0?this.streams[e-1]=s:this.posStream=s}destroyAndSetSize(e){if(this.streams=null,e>1){this.streams=new Array(e-1);for(let s=0;s<e-1;++s)this.streams[s]=null}this.posStream=null}swap(e){[this.streams,e.streams]=[e.streams,this.streams],[this.posStream,e.posStream]=[e.posStream,this.posStream]}empty(){return this.posStream===null&&this.streams===null}};function fKe(t,e,s,i,r){(e<0||s<0||i<1||e+i*(s-1)+1>t.size())&&ee("Index out of bound");for(let n=e,o=e+i*(s-1)+1;n<o;n+=i)t.writeAsDbl(n,r(t.readAsDbl(n)))}function gKe(t,e,s){if(t)for(let i=e.length-1;i>=0;--i)s(e[i]);else e.forEach(s)}function yKe(t,e){let s=ub(t);const i=e.length/Qr();for(let r=0;r<e.length;++r){const n=Math.trunc(s*i);s=ub(s);const o=Math.trunc(s*i),a=e[n];e[n]=e[o],e[o]=a}}function _Ke(t,e,s){const i=t.getDescription().getTotalComponentCount();t.setX(e[0]),t.setY(e[1]),$s(t.getAttributeArray(),e,0,2,i-2)}var Di=Es;const B8="can not assign an empty point to a vertex";let X0e=class{constructor(e){if(this.m_accelerators=null,e!==void 0&&e.move)this.m_description=e.move.m_description,e.move.m_description=Jr(),this.m_vertexAttributes=e.move.m_vertexAttributes,e.move.m_vertexAttributes=new iM,this.m_envelopeData=e.move.m_envelopeData,e.move.m_envelopeData=new $l,this.m_pointCount=e.move.m_pointCount,this.m_reservedPointCount=e.move.m_reservedPointCount,this.m_flags=e.move.m_flags,this.m_bFillRule=e.move.m_bFillRule,this.m_bPathStarted=e.move.m_bPathStarted,this.m_bPolygon=e.move.m_bPolygon,this.m_simpleTolerance=e.move.m_simpleTolerance;else{const s=e!==void 0&&e.vd?e.vd:Jr();this.m_description=s,this.m_vertexAttributes=new iM,this.m_envelopeData=new $l,this.m_pointCount=0,this.m_reservedPointCount=-1,this.m_flags=4063,this.m_bFillRule=this.m_bPathStarted=this.m_bPolygon=!1,this.m_simpleTolerance=0,e!==void 0&&e.copy&&e.copy.copyTo(this)}}equalsBase(e,s){if(!zo(e.getGeometryType()))return!1;const i=e;if(this===i)return!0;if(!this.m_description.equals(i.getDescription())||this.isEmptyImpl()!==i.isEmptyImpl())return!1;if(this.isEmptyImpl())return!0;const r=this.getPointCount();if(r!==i.getPointCount())return!1;for(let n=0;n<this.m_description.getAttributeCount();n++){const o=this.m_description.getSemantics(n),a=this.getAttributeStreamRef(o),l=i.getAttributeStreamRef(o),u=Di.getComponentCount(o);if(!a.equals(l,0,r*u,s))return!1}if(s){if(!this.equalsImplTol(e,s))return!1}else if(!this.equalsImpl(e))return!1;return!0}transformAttribute(e,s,i,r,n){this.addAttribute(e),this.isEmpty()||i===0&&r===1||(fKe(this.getAttributeStreamRef(e),s,this.getPointCount(),Di.getComponentCount(e),j0e(i,r,n)),this.notifyModified())}getDescription(){return this.m_description}assignVertexDescription(e){this.m_description!==e&&this.assignVertexDescriptionImpl(e)}mergeVertexDescriptionImpl(e){const s=this.getDescription(),i=Sx(s,e);this.assignVertexDescription(i)}mergeVertexDescription(e){this.m_description!==e&&(this.m_description.hasAttributesFrom(e)||this.mergeVertexDescriptionImpl(e))}hasAttribute(e){return this.m_description.hasAttribute(e)}addAttribute(e){if(this.m_description.hasAttribute(e))return;const s=bP(this.m_description,e);this.assignVertexDescription(s)}dropAttribute(e){if(!this.m_description.hasAttribute(e))return;const s=xP(this.m_description,e);this.assignVertexDescription(s)}dropAllAttributes(){const e=Jr();e!==this.m_description&&this.assignVertexDescription(e)}getAttributeStreamRef(e){this.throwIfEmpty(),this.m_description.hasAttribute(e)||ee("AttributeStream : Geometry does not have the attribute");const s=this.m_description.getAttributeIndex(e);return this.m_vertexAttributes.get(s)}setAttributeStreamRef(e,s){s||ee("stream"),s&&Di.getPersistence(e)!==s.getPersistence()&&ee(""),this.addAttribute(e);const i=this.m_description.getAttributeIndex(e);this.m_vertexAttributes.empty()&&this.m_vertexAttributes.destroyAndSetSize(this.m_description.getAttributeCount()),this.m_vertexAttributes.set(i,s),this.notifyModifiedFlags(2001)}notifyModifiedFlags(e){e===65535&&(this.m_reservedPointCount=-1,this.notifyModifiedAllImpl()),this.setDirtyFlagProtected(e,!0),this.clearAccelerators(),32&e&&this.verifyAllStreamsAfterSizeChange()}notifyModified(){this.notifyModifiedFlags(2001)}getPointCount(){return this.m_pointCount}getPointByVal(e,s){const i=s;i.assignVertexDescription(this.m_description);for(let r=0;r<this.m_description.getAttributeCount();r++){const n=this.m_description.getSemantics(r);for(let o=0,a=Di.getComponentCount(n);o<a;o++){const l=this.m_vertexAttributes.get(r).readAsDbl(a*e+o);i.setAttributeBasic(n,o,l)}}}setPointByVal(e,s){const i=s;i.isEmpty()&&ee(B8);const r=i.getDescription();r!==this.m_description&&this.mergeVertexDescription(r);const n=this.m_vertexAttributes.get(0);n.write(2*e,i.getX()),n.write(2*e+1,i.getY());for(let o=1,a=this.m_description.getAttributeCount();o<a;o++){const l=this.m_description.getSemantics(o),u=Di.getComponentCount(l);for(let c=0;c<u;c++){const h=i.getAttributeAsDbl(l,c);this.m_vertexAttributes.get(o).writeAsDbl(e*u+c,h)}}this.notifyModifiedFlags(2001)}setPointByValFromArray(e,s,i,r){F(0)}getPointByValAsArray(e,s,i,r){F(0)}isEmpty(){return this.isEmptyImpl()}isEmptyImpl(){return this.m_pointCount===0}getAttributeAsDbl(e,s,i){const r=Di.getComponentCount(e);i>=r&&bt("");const n=this.m_description.getAttributeIndex(e);return n>=0?this.m_vertexAttributes.get(n).readAsDbl(s*r+i):Di.getDefaultValue(e)}queryAttributeAsDbl(e,s,i,r){const n=Di.getComponentCount(e);r<n&&bt("");const o=this.m_description.getAttributeIndex(e);if(o>=0){const a=s*n,l=this.m_vertexAttributes.get(o);for(let u=0;u<n;u++)i[u]=l.readAsDbl(a+u)}else{const a=Di.getDefaultValue(e);for(let l=0;l<n;l++)i[l]=a}}getAttributeAsInt(e,s,i){return Math.trunc(this.getAttributeAsDbl(e,s,i))}queryAttributeAsInt(e,s,i,r){F(0)}setAttribute(e,s,i,r){const n=Di.getComponentCount(e);i>=n&&bt(""),this.addAttribute(e);const o=this.m_description.getAttributeIndex(e);this.notifyModifiedFlags(2001),this.m_vertexAttributes.get(o).writeAsDbl(s*n+i,r)}setAttributeFromArray(e,s,i,r){(s<0||s>=this.m_pointCount)&&bt("");const n=Di.getComponentCount(e);r!==n&&bt(""),this.addAttribute(e);const o=this.m_description.getAttributeIndex(e);this.notifyModifiedFlags(2001);const a=this.m_vertexAttributes.get(o);for(let l=0;l<n;++l)a.writeAsDbl(s*n+l,i[l])}getXY(e){return this.m_vertexAttributes.get(0).readPoint2D(2*e)}queryXY(e,s){return this.m_vertexAttributes.get(0).queryPoint2D(2*e,s)}setXY(e,s){this.m_vertexAttributes.get(0).writePoint2D(2*e,s),this.notifyModifiedFlags(2001)}setXYCoords(e,s,i){const r=this.m_vertexAttributes.get(0);r.write(2*e,s),r.write(2*e+1,i),this.notifyModifiedFlags(2001)}getXYZ(e){const s=this.m_vertexAttributes.get(0),i=gt.getNAN();return i.x=s.read(2*e),i.y=s.read(2*e+1),this.m_description.hasAttribute(1)?i.z=this.m_vertexAttributes.get(1).read(e):i.z=Di.getDefaultValue(1),i}setXYZ(e,s){this.addAttribute(1),this.notifyModifiedFlags(2001);const i=this.m_vertexAttributes.get(0);i.write(2*e,s.x),i.write(2*e+1,s.y),this.m_vertexAttributes.get(1).write(e,s.z)}queryEnvelope(e){e instanceof X||e instanceof Ql?this.updateEnvelope(e):(this.updateAllDirtyIntervals(!0),this.m_envelopeData.copyTo(this.m_description,e))}queryLooseEnvelope(e){this.updateLooseEnvelope(e)}queryInterval(e,s){const i=de.constructEmpty();return this.isEmptyImpl()||(this.updateAllDirtyIntervals(!0),this.m_envelopeData.queryInterval(this.m_description,e,s,i)),i}setAttributeBasic(e,s,i){this.setAttributeImpl(e,s,i)}setAttributeImpl(e,s,i){if(this.addAttribute(e),this.isEmpty())return;let r=!1;const n=Di.getComponentCount(e),o=this.getAttributeStreamRef(e),a=Number.isNaN(i);if(o.getPersistence()===1){const l=o;for(let u=s,c=this.m_pointCount*n;u<c;u+=n){const h=l.read(u);(a||h===i)&&Number.isNaN(h)||(l.write(u,i),r=!0)}}else for(let l=s,u=this.m_pointCount*n;l<u;l+=n)o.readAsDbl(l)!==i&&(o.writeAsDbl(l,i),r=!0);r&&this.notifyModifiedFlags(2001)}replaceNaNs(e,s){if(this.addAttribute(e),this.isEmpty())return;let i=!1;const r=Di.getComponentCount(e),n=this.getAttributeStreamRef(e);for(let o=0;o<r;o++)if(n.getPersistence()===1){const a=n;for(let l=0,u=this.m_pointCount*r;l<u;l++){const c=a.read(l);Number.isNaN(c)&&(a.write(l,s),i=!0)}}else for(let a=0,l=this.m_pointCount*r;a<l;a++){const u=n.readAsDbl(a);Number.isNaN(u)&&(n.writeAsDbl(a,s),i=!0)}i&&this.notifyModifiedFlags(2001)}calculateLength3D(e){return F(0),0}setEnvelopeForImport(e){this.m_description.equals(e.getDescription())||ee(""),this.m_envelopeData=new $l({moveEnv:e}),this.setDirtyFlagProtected(192,!1)}copyTo(e){e.getGeometryType()!==this.getGeometryType()&&ee(""),this!==e&&this.copyToUnchecked(e,!1)}queryCoordinates(e,s,i,r){let n=r<0?this.m_pointCount:r;if(n=Math.min(n,i+s),(i<0||n<i||this.m_pointCount>0&&i>=this.m_pointCount)&&ee(""),this.m_pointCount===0)return n;const o=this.getAttributeStreamRef(0);for(let a=2*i,l=2*n,u=0;a<l;a+=2,u++)o.queryPoint2D(a,e[u]);return n}queryCoordinates3D(e,s,i,r){let n=r<0?this.m_pointCount:r;if(n=Math.min(n,i+s),(i<0||n<i||this.m_pointCount>0&&i>=this.m_pointCount)&&ee(""),this.m_pointCount===0)return n;const o=this.getAttributeStreamRef(0);let a=null;const l=Di.getDefaultValue(1),u=this.m_description.hasAttribute(1);u&&(a=this.getAttributeStreamRef(1));let c=0;for(let h=i;h<n;h++,c++)e[c].x=o.read(2*h),e[c].y=o.read(2*h+1),e[c].z=u?a.read(h):l;return n}clearAndSetDirtyFlagProtected(e,s){let i=0;const r=e&~s,n=s|r;i=this.m_flags,(i&n)!==s&&(this.m_flags=i&~r|s)}getIsSimple(e,s){s[0]=0;let i=-1;const r=this.m_flags,n=this.m_simpleTolerance;return 1&r||(i=(14&r)>>1,s[0]=n,n<e&&(i=-1)),i}setIsSimple(e,s,i=!1){if(e===2?F(this.getGeometryType()===G.enumPolyline):e===1?F(this.getGeometryType()===G.enumMultiPoint||this.getGeometryType()===G.enumPolyline):e===3&&F(this.getGeometryType()===G.enumPolygon),e===-1)this.setDirtyFlagProtected(17,!0);else{let r=e<<1;i||(r|=16),this.clearAndSetDirtyFlagProtected(31,r),this.m_simpleTolerance!==s&&(this.m_simpleTolerance=s)}}attributeStreamIsAllocated(e){this.throwIfEmpty();const s=this.m_description.getAttributeIndex(e);return s>=0&&this.m_vertexAttributes.get(s)!==null}capacity(){return this.m_reservedPointCount===-1&&this.m_pointCount===0?0:this.m_reservedPointCount}getDescriptionImpl(){return this.m_description}copyToUnchecked(e,s=!1){s&&this.hasDirtyFlag(32)&&jQe("Cannot do shallow clone on unprepared geometry");const i=e,r=this.getGeometryType(),n=i.getGeometryType();F(r===n||r===G.enumPolygon&&n===G.enumPolyline,"failure in copyToUnchcked"),i.clearAccelerators(),i.m_description=this.m_description,i.m_vertexAttributes.destroyAndSetSize(0),i.m_envelopeData.releaseAttributes();const o=this.m_description.getAttributeCount(),a=new iM;if(!this.m_vertexAttributes.empty()){a.destroyAndSetSize(o);for(let l=0;l<o;l++)if(this.m_vertexAttributes.get(l))if(s)a.set(l,this.m_vertexAttributes.get(l));else{const u=Di.getComponentCount(this.m_description.getSemantics(l));a.set(l,this.m_vertexAttributes.get(l).restrictedClone(this.getPointCount()*u))}}if(this.m_envelopeData.copyToIfNotNull(this.m_description,i.m_envelopeData),i.m_flags=this.m_flags,i.m_simpleTolerance=this.m_simpleTolerance,r!==n){const l=[Number.NaN];i.getIsSimple(0,l)>=3?i.setIsSimple(1,l[0]):i.setIsSimple(-1,0)}i.m_vertexAttributes.swap(a),a.destroyAndSetSize(0),i.m_pointCount=this.m_pointCount,i.hasDirtyFlag(32)?(F(!s),i.m_reservedPointCount=-1):i.m_reservedPointCount=i.m_pointCount;try{this.copyToImpl(i,s)}catch(l){throw i.setEmpty(),l}i.verifyAllStreamsAfterSizeChange()}buildRasterizedGeometryAccelerator(e,s){return!1}getAccelerators(){return this.m_accelerators}clearAccelerators(){this.m_accelerators&&this.m_accelerators.release(),this.m_accelerators=null}ensureUniqueAccelerators(){if(this.m_accelerators&&!this.m_accelerators.uniqueUse()){const e=this.m_accelerators.clone();this.m_accelerators.release(),this.m_accelerators=e}}interpolateTwoVertices(e,s,i,r){(e<0||e>=this.m_pointCount)&&bt(""),(s<0||s>=this.m_pointCount)&&bt(""),r.assignVertexDescription(this.m_description);const n=Me(Di.maxComponentCount(),Number.NaN),o=Me(Di.maxComponentCount(),Number.NaN),a=qh();let l=0;for(let u=0;u<this.m_description.getAttributeCount();u++){const c=this.m_description.getSemantics(u),h=Di.getInterpolation(c),m=Di.getComponentCount(c),f=Di.getDefaultValue(c);this.queryAttributeAsDbl(c,e,n,m),this.queryAttributeAsDbl(c,s,o,m),F(l+m<=S9),U3(h,n,o,a,l,m,i,f),l+=m}_Ke(r,a)}getShortestDistance(e,s){return M.distance(this.getXY(e),this.getXY(s))}getShortestSqrDistance(e,s){return M.sqrDistance(this.getXY(e),this.getXY(s))}resizeImpl(e){if(e<0&&ee(),(e=Math.ceil(e))===this.m_pointCount)return;this.m_pointCount=e;const s=this.m_pointCount<=this.m_reservedPointCount?2001:4095;this.notifyModifiedFlags(s)}assignVertexDescriptionImpl(e){if(!this.m_vertexAttributes.empty()){const s=lR();uR(e,this.m_description,s);const i=new iM;i.destroyAndSetSize(e.getAttributeCount());for(let r=0;r<e.getAttributeCount();r++){const n=s[r];n!==-1?i.set(r,this.m_vertexAttributes.get(n)):this.m_reservedPointCount=-1}i.swap(this.m_vertexAttributes)}this.m_description=e,this.m_envelopeData.releaseAttributes(),this.notifyModifiedFlags(4095)}hasDirtyFlag(e){return!!(this.m_flags&e)}setDirtyFlagProtected(e,s){s?this.m_flags|=e:this.m_flags&=~e}notifyModifiedAllImpl(){}verifyAllStreamsAfterSizeChange(){this.hasDirtyFlag(32)&&this.verifyAllStreamsAfterSizeChangeImpl()}verifyAllStreamsAfterSizeChangeImpl(){if(this.hasDirtyFlag(32)){if(this.m_reservedPointCount<this.m_pointCount){this.m_vertexAttributes.empty()&&this.m_vertexAttributes.destroyAndSetSize(this.m_description.getAttributeCount()),this.m_reservedPointCount=Number.MAX_SAFE_INTEGER;let e=0;e=this.m_pointCount<4?3:this.m_pointCount<=128?2*this.m_pointCount:Math.trunc((4*this.m_pointCount+2)/3);for(let s=0;s<this.m_description.getAttributeCount();s++){const i=this.m_description.getSemantics(s);let r=0;if(this.m_vertexAttributes.get(s)!==null){const n=Di.getComponentCount(i);r=this.m_vertexAttributes.get(s).size()/n,r<this.m_pointCount&&(this.m_vertexAttributes.get(s).resize(e*n,Di.getDefaultValue(i)),r=e)}else this.m_vertexAttributes.set(s,C9(i,e)),r=e;r<this.m_reservedPointCount&&(this.m_reservedPointCount=r)}}this.verifyStreamsAfterSizeChangeExtraImpl(),this.setDirtyFlagProtected(32,!1)}}verifyStreamsAfterSizeChangeExtraImpl(){}updateAllDirtyIntervals(e){if(e?this.hasDirtyFlag(192):this.hasDirtyFlag(128)){if(this.isEmpty())return this.hasDirtyFlag(192)&&this.m_envelopeData.setEmpty(this.m_description),void this.setDirtyFlagProtected(192,!1);const s=this.updateXYImpl(e),i=new Sn({vd:this.m_description});i.setEnvelope(s);for(let r=1;r<this.m_description.getAttributeCount();r++){const n=this.m_description.getSemantics(r),o=Di.getComponentCount(n),a=this.m_vertexAttributes.get(r);for(let l=0;l<o;l++){const u=new de;u.setEmpty();for(let c=0;c<this.m_pointCount;c++){const h=a.readAsDbl(c*o+l);u.mergeCoordinate(h)}i.setIntervalEnvelope(n,l,u)}}(e?this.hasDirtyFlag(192):this.hasDirtyFlag(128))&&(this.m_envelopeData=new $l({moveEnv:i}),this.clearDirtyIntervalsFlag(e))}}updateXYImpl(e){const s=X.constructEmpty(),i=this.m_vertexAttributes.get(0);return s.mergePointsInterleaved(i,0,this.m_pointCount),s}updateEnvelope3D(e){F(0)}updateLooseEnvelope(e){this.updateAllDirtyIntervals(!1),e instanceof X?e.assign(this.m_envelopeData.m_envelope2D):this.m_envelopeData.queryEnvelope3D(this.m_description,e)}updateEnvelope(e){this.updateAllDirtyIntervals(!0),e.assign(this.m_envelopeData.m_envelope2D)}setEmptyImpl(){this.m_pointCount=0,this.m_reservedPointCount=-1,this.m_vertexAttributes.destroyAndSetSize(0),this.notifyModifiedFlags(4095)}clearDirtyIntervalsFlag(e){this.setDirtyFlagProtected(192,!1)}reserveImpl(e,s){if(e<0&&ee(""),e===0)return;let i=e=Math.ceil(e);if(this.m_reservedPointCount<i){this.m_vertexAttributes.empty()&&this.m_vertexAttributes.destroyAndSetSize(this.m_description.getAttributeCount()),s?(this.m_vertexAttributes.get(0)===null&&this.m_vertexAttributes.set(0,rN(0,0)),this.m_vertexAttributes.get(0).resizeRounded(2*i),i=this.m_vertexAttributes.get(0).size()>>1):this.m_vertexAttributes.get(0)===null?this.m_vertexAttributes.set(0,rN(0,i)):this.m_vertexAttributes.get(0).resize(2*i);for(let r=1;r<this.m_description.getAttributeCount();r++){const n=this.m_description.getSemantics(r),o=Di.getComponentCount(n);this.m_vertexAttributes.get(r)!==null?this.m_vertexAttributes.get(r).resize(i*o):this.m_vertexAttributes.set(r,rN(n,i))}this.reserveImplImpl(i,s),this.m_reservedPointCount=i}}reserveRounded(e){e<0&&ee(),e=Math.ceil(e),this.reserveImpl(e,!0)}reserveImplImpl(e,s){}throwIfEmpty(){this.isEmptyImpl()&&rR("")}},pi=class W0e extends X0e{constructor(e){super(e),e&&(e.points?this.addPoints2D(e.points,e.pointsSize,0,-1):e.point&&this.add(e.point))}assignCopy(e){return e.copyTo(this),this}assignMove(e){return e.copyTo(this),e.setEmpty(),this}insertPoint2D(e,s){e>this.getPointCount()&&ee("invalid point index"),e<0&&(e=this.getPointCount());const i=this.m_pointCount;this.resizeNoInit(this.m_pointCount+1);for(let r=0,n=this.m_description.getAttributeCount();r<n;r++){const o=this.m_description.getSemantics(r),a=Es.getComponentCount(o);if(o===0)this.m_vertexAttributes.get(r).insert(a*e,s,a*i);else{const l=Es.getDefaultValue(o);this.m_vertexAttributes.get(r).insertRange(a*e,l,a,a*i)}}this.notifyModifiedFlags(2001)}insertPoint(e,s){s.isEmpty()&&ee(B8),e<0&&(e=this.getPointCount()),this.mergeVertexDescription(s.getDescription());const i=this.m_pointCount;this.resizeNoInit(this.m_pointCount+1);for(let r=0,n=this.m_description.getAttributeCount();r<n;r++){const o=this.m_description.getSemantics(r),a=Es.getComponentCount(o);if(s.hasAttribute(o))this.m_vertexAttributes.get(r).insertAttributes(a*e,s,o,a*i);else{const l=Es.getDefaultValue(o);this.m_vertexAttributes.get(r).insertRange(a*e,l,a,a*i)}}this.notifyModifiedFlags(2001)}insertPoints(e,s,i){if((e>this.getPointCount()||i<0)&&bt(""),e<0&&(e=this.getPointCount()),i===0)return;const r=s[0].getDescription();this.mergeVertexDescription(r);const n=this.m_pointCount;this.resizeNoInit(this.m_pointCount+i);for(let o=0,a=this.m_description.getAttributeCount();o<a;o++){const l=this.m_description.getSemantics(o),u=Es.getComponentCount(l);if(this.m_vertexAttributes.get(o))if(r.hasAttribute(l))this.m_vertexAttributes.get(o).insertAttributesFromPoints(e*u,s,i,l,n*u);else{const c=Es.getDefaultValue(l);this.m_vertexAttributes.get(o).insertRange(u*e,c,u*i,u*n)}}this.notifyModifiedFlags(2001)}insertPoints2D(e,s,i){if((e>this.getPointCount()||i<0)&&ee("invalid point index"),e<0&&(e=this.getPointCount()),i===0)return;const r=this.m_pointCount;this.resizeNoInit(this.m_pointCount+i);for(let n=0,o=this.m_description.getAttributeCount();n<o;n++){const a=this.m_description.getSemantics(n),l=Es.getComponentCount(a);if(this.m_vertexAttributes.get(n))if(a===0)this.m_vertexAttributes.get(n).insertRangeFromPoints(l*e,s,0,i,!0,l*r);else{const u=Es.getDefaultValue(a);this.m_vertexAttributes.get(n).insertRange(l*e,u,l,l*r)}}this.notifyModifiedFlags(2001)}removePoints(e,s){if((e<0||s<0||e+s>this.getPointCount())&&bt("remove_points"),s!==0){for(let i=0,r=this.m_description.getAttributeCount();i<r;i++)if(this.m_vertexAttributes.get(i)){const n=this.m_description.getSemantics(i),o=Es.getComponentCount(n);this.m_vertexAttributes.get(i).eraseRange(o*e,o*s,o*this.m_pointCount)}this.m_pointCount-=s,this.m_reservedPointCount>0&&(this.m_reservedPointCount-=s),this.notifyModifiedFlags(2001)}}removePoint(e){for(let s=0,i=this.m_description.getAttributeCount();s<i;s++)if(this.m_vertexAttributes.get(s)){const r=this.m_description.getSemantics(s),n=Es.getComponentCount(r);this.m_vertexAttributes.get(s).eraseRange(n*e,n,n*this.m_pointCount)}this.m_pointCount--,this.m_reservedPointCount>0&&this.m_reservedPointCount--,this.notifyModifiedFlags(2001)}calculateEnvelope2D(){return this.updateXYImpl(!0)}resizeNoInit(e){this.resizeImpl(e)}resizeAndInitNonPositionAttributes(e){const s=this.m_pointCount;if(this.resizeImpl(e),this.m_pointCount>s)for(let i=1,r=this.m_description.getAttributeCount();i<r;i++){const n=this.m_description.getSemantics(i),o=Es.getDefaultValue(n),a=Es.getComponentCount(n);this.m_vertexAttributes.get(i).insertRange(a*s,o,a*(this.m_pointCount-s),a*s)}}queryCoordinates3D(e,s,i,r){let n=r<0?this.m_pointCount:r;if(n=Math.min(n,i+s),(i<0||n<i||this.m_pointCount>0&&i>=this.m_pointCount)&&ee(""),this.m_pointCount===0)return n;const o=this.getAttributeStreamRef(0);let a=null;const l=Es.getDefaultValue(1),u=this.m_description.hasAttribute(1);u&&(a=this.getAttributeStreamRef(1));let c=0;for(let h=i;h<n;h++,c++)e[c].x=o.read(2*h),e[c].y=o.read(2*h+1),e[c].z=u?a.read(h):l;return n}queryAttributeAsInt(e,s,i,r){F(0)}add(e){e.isEmpty()&&ee(B8),this.resizeAndInitNonPositionAttributes(this.m_pointCount+1),this.setPointByVal(this.m_pointCount-1,e)}addXY(e,s){this.resizeAndInitNonPositionAttributes(this.m_pointCount+1);const i=new M(e,s);this.setXY(this.m_pointCount-1,i)}addXYZ(e,s,i){this.resizeAndInitNonPositionAttributes(this.m_pointCount+1);const r=new gt;r.setCoords(e,s,i),this.setXYZ(this.m_pointCount-1,r)}addPoint2D(e){this.addXY(e.x,e.y)}addPoint3D(e){this.addXYZ(e.x,e.y,e.z)}addPoints(e,s,i){this===e&&ee("Multi_point_impl.add");const r=i<0?e.getPointCount():i;if((s<0||s>e.getPointCount()||r<s)&&ee(""),s===r)return;const n=e.getDescription();this.mergeVertexDescription(n);const o=r-s,a=this.m_pointCount;this.resizeNoInit(this.m_pointCount+o);for(let l=0,u=this.m_description.getAttributeCount();l<u;l++){const c=this.m_description.getSemantics(l),h=Es.getComponentCount(c),m=this.getAttributeStreamRef(c);if(n.hasAttribute(c)){const f=e.getAttributeStreamRef(c);m.insertRangeFromStream(a*h,f,s*h,o*h,!0,1,a*h)}else{const f=Es.getDefaultValue(c);m.insertRange(a*h,f,o*h,a*h)}}}addPoints2D(e,s,i,r){let n=s;const o=r<0?n:r;if((n<0||i<0||i>n||o<i)&&ee(""),i===o)return;n=o-i;const a=this.m_pointCount;this.resizeAndInitNonPositionAttributes(this.m_pointCount+n);const l=this.getAttributeStreamRef(0);for(let u=0;u<n;++u)l.writePoint2D(2*(a+u),e[i+u]);this.notifyModifiedFlags(2001)}addPoints3D(e,s,i,r){let n=s;const o=r<0?n:r;if((n<0||i<0||i>n||o<i)&&ee(""),this.addAttribute(1),i===o)return;n=o-i;const a=this.m_pointCount;this.resizeAndInitNonPositionAttributes(this.m_pointCount+n);const l=this.getAttributeStreamRef(0),u=new M;for(let h=0;h<n;h++)u.x=e[i+h].x,u.y=e[i+h].y,l.writePoint2D(2*(a+h),u);const c=this.getAttributeStreamRef(1);for(let h=0;h<n;h++)c.write(a+h,e[i+h].z);this.notifyModifiedFlags(2001)}getGeometryType(){return G.enumMultiPoint}getDimension(){return 0}createInstance(){return new W0e({vd:this.getDescription()})}setEmpty(){this.setEmptyImpl()}applyTransformation(e){if(this.isEmpty()||e.isIdentity())return;const s=this.m_vertexAttributes.get(0);e.m_TransformationType===1?s.applyTransformation(e,0,this.m_pointCount):yt("3d xform not impl"),this.notifyModifiedFlags(2001)}calculateArea2D(){return 0}calculateLength2D(){return 0}calculateLength3D(e){return 0}equals(e,s){return e.getGeometryType()===G.enumMultiPoint&&this.equalsBase(e,s)}queryEnvelope(e){e.m_EnvelopeType===4?(this.updateAllDirtyIntervals(!0),this.m_envelopeData.copyTo(this.m_description,e)):e.m_EnvelopeType===2?this.updateEnvelope(e):yt("")}getImpl(){return this}getBoundary(){return null}reserve(e){this.reserveImpl(e)}clone(){const e=this.createInstance();return this.copyTo(e),e}swap(e){F(0)}buildQuadTreeAccelerator(e){return!1}getHashCodeImpl(){return F(0),0}equalsImpl(e){return!0}equalsImplTol(e,s){return!0}copyToImpl(e,s){}};pi.type=G.enumMultiPoint;let Yn=class j8{constructor(){this.m_EnvelopeType=5,this.envAabb=X.constructEmpty(),this.envRot=X.constructEmpty()}static constructEmpty(){return new j8}width(){return this.envAabb.width()}height(){return this.envAabb.height()}maxDim(){return Math.max(this.width(),this.height())}setEmpty(){this.envAabb.setEmpty(),this.envRot.setEmpty()}setCoords(e){this.envAabb.setCoords(e),this.envRot.setCoords({x:a2(e),y:l2(e)})}setFromPoints(e,s){this.setEmpty(),this.mergePoints(e,s)}mergeNe(e){this.envAabb.mergeNe(e),this.envRot.mergeNeCoords(a2(e),l2(e))}mergePoints(e,s){this.envAabb.mergePoints(e,s);for(let i=0;i<s;){if(!this.envRot.isEmpty()){for(let r=i;r<s;r++){const n=a2(e[r]),o=l2(e[r]);this.envRot.mergeNeCoords(n,o)}break}{const r=a2(e[i]),n=l2(e[i]);this.envRot.setCoords({x:r,y:n}),i++}}}isIntersectingPoint2D(e){return!(!this.envAabb.contains(e)||!this.envRot.containsCoords(a2(e),l2(e)))}isIntersectingW(e){return this.envAabb.isIntersecting(e.envAabb)&&this.envRot.isIntersecting(e.envRot)}containsW(e){return!(!this.envAabb.containsEnvelope(e.envAabb)||!this.envRot.containsEnvelope(e.envRot))}containsPoint2D(e){return this.isIntersectingPoint2D(e)}intersectW(e){const s=this.envAabb.intersect(e.envAabb),i=this.envRot.intersect(e.envRot);return s&&!i&&this.envAabb.setEmpty(),i&&!s&&this.envRot.setEmpty(),s&&i}inflate(e){this.envAabb.inflateCoords(e,e);const s=e*LJe();this.envRot.inflateCoords(s,s),s<0&&j8.st_reduceEmpty(this)}static st_reduceEmpty(e){const s=e.envAabb.isEmpty(),i=e.envRot.isEmpty();s&&!i?e.envRot.setEmpty():i&&!s&&e.envAabb.setEmpty()}};function a2(t){return t.x-t.y}function l2(t){return t.x+t.y}let je=class uf{constructor(){this.x=le.getNAN(),this.y=le.getNAN()}static getNAN(){return new uf}static constructPoint2D(e){const s=new uf;return s.x.set(e.x),s.y.set(e.y),s}static constructCoords(e,s){const i=new uf;return i.x.set(e),i.y.set(s),i}static constructCoordsE(e,s){const i=new uf;return i.setCoordsE(e,s),i}get 0(){return this.x.clone()}set 0(e){this.x.setE(e)}get 1(){return this.y.clone()}set 1(e){this.y.setE(e)}clone(){return new uf().setE(this)}scaleThis(e){return this.x.mulThisE(e),this.y.mulThisE(e),this}setCoords(e,s){return this.x.set(e),this.y.set(s),this}setCoordsE(e,s){return this.x.setE(e),this.y.setE(s),this}set(e){return this.x.set(e.x),this.y.set(e.y),this}setE(e){return this.x.setE(e.x),this.y.setE(e.y),this}setWithEps(e,s){return this.x.setWithEps(e.x,s),this.y.setWithEps(e.y,s),this}getUnitVector(){const e=this.clone();return e.normalize(),e}sqrLength(){return this.x.sqr().addE(this.y.sqr())}length(){return this.sqrLength().sqrt()}mulE(e){const s=new uf;return s.setCoordsE(this.x.mulE(e),this.y.mulE(e)),s}mul(e){const s=new uf;return s.setCoordsE(this.x.mul(e),this.y.mul(e)),s}mulThis(e){return this.x.mulThis(e),this.y.mulThis(e),this}mulThisE(e){return this.x.mulThisE(e),this.y.mulThisE(e),this}divE(e){return this.clone().divThisE(e)}divThisE(e){return this.x.divThisE(e),this.y.divThisE(e),this}normalize(){const e=this.length();e.value()===0?(this.x=Dd.clone(),this.y=bx.clone()):(this.x.divThisE(e),this.y.divThisE(e))}addE(e){return this.clone().addThisE(e)}addThisE(e){return this.x.addThisE(e.x),this.y.addThisE(e.y),this}subE(e){return this.clone().subThisE(e)}subThisE(e){return this.x.subThisE(e.x),this.y.subThisE(e.y),this}static distance(e,s){return e.subE(s).length()}negateThis(){return this.x.negateThis(),this.y.negateThis(),this}eq(e){return this.x.eq(e.x)&&this.y.eq(e.y)}isZero(){return this.x.isZero()&&this.y.isZero()}isTrueZero(){return!this.x.value()&&!this.y.value()}rotateDirect(e,s){const i=this.x.mulE(e).subThisE(this.y.mulE(s)),r=this.x.mulE(s).addThisE(this.y.mulE(e));return this.x.setE(i),this.y.setE(r),this}rotateReverse(e,s){const i=this.x.mulE(e).addThisE(this.y.mulE(s)),r=this.x.negate().mulThisE(s).addThisE(this.y.mulE(e));return this.x.setE(i),this.y.setE(r),this}dotProduct(e){return this.x.mulE(e.x).addE(this.y.mulE(e.y))}crossProduct(e){return this.x.mulE(e.y).subE(this.y.mulE(e.x))}value(){return M.construct(this.x.value(),this.y.value())}},H8=class Z0e{constructor(){this.a11=new le(1),this.a12=new le(0),this.a21=new le(0),this.a22=new le(1)}clone(){const e=new Z0e;return e.a11.setE(this.a11),e.a12.setE(this.a12),e.a21.setE(this.a21),e.a22.setE(this.a22),e}assign(e){return this.a11.setE(e.a11),this.a12.setE(e.a12),this.a21.setE(e.a21),this.a22.setE(e.a22),this}mulThis(e){const s=this.a11.mulE(e.a11).addThisE(this.a12.mulE(e.a21)),i=this.a11.mulE(e.a12).addThisE(this.a12.mulE(e.a22)),r=this.a21.mulE(e.a11).addThisE(this.a22.mulE(e.a21)),n=this.a21.mulE(e.a12).addThisE(this.a22.mulE(e.a22));return this.a11=s,this.a12=i,this.a21=r,this.a22=n,this}mulLeftThis(e){const s=e.clone();return this.assign(s.mulThis(this)),this}det(){return this.a11.mulE(this.a22).subThisE(this.a12.mulE(this.a21))}invertThis(){const e=this.det();if(e.value()!==0){const s=this.a22.divE(e),i=this.a12.negate().divThisE(e),r=this.a21.negate().divThisE(e),n=this.a11.divE(e);this.a11=s,this.a12=i,this.a21=r,this.a22=n}else this.setZero();return!e.isZero()}transposeThis(){return this.a21=be(this.a12,this.a12=this.a21),this}eigenSymmetric(e,s){const i=this.a12.clone();i.addThisE(this.a21),i.mulThisByPower2(.5);let r=new le(1),n=new le(0);if(i.isZero())e[0].setE(this.a11),e[1].setE(this.a22);else{const o=new le(1);if(this.a11.ne(this.a22)){const a=this.a11.subE(this.a22).divE(i);a.mulThisByPower2(.5);const l=a.sqr();o.setE(a),o.absThis(),o.subThisE(l.add(1).sqrtThis()),a.gt(bx)&&o.negateThis();const u=o.sqr().addThis(1).sqrtThis().invThis();n=o.mulE(u),r.setE(u);const c=o.mulE(i);e[0]=this.a11.addE(c),e[1]=this.a22.subE(c)}else r=new le(1/Math.sqrt(2)),n=r.clone(),e[0]=this.a11.addE(i),e[1]=this.a22.subE(i)}s[0].x=r.toDouble(),s[0].y=n.toDouble(),s[1].x=n.negate().toDouble(),s[1].y=r.toDouble(),Math.abs(e[0].toDouble())>Math.abs(e[1].toDouble())&&(e[1]=be(e[0],e[0]=e[1]),s[1]=be(s[0],s[0]=s[1]))}setZero(){this.a11.set(0),this.a21.set(0),this.a12.set(0),this.a22.set(0)}};var lg=Es;function rl(t,e){const s=t.getStartXY();if(s.equals(e.getStartXY())||s.equals(e.getEndXY()))return!0;const i=t.getEndXY();return!!i.equals(e.getStartXY())||!!i.equals(e.getEndXY())}function mR(t,e){let s=t.calculateLowerLength2D();return!(s>e)&&(!!t.isLine()||(s=t.calculateUpperLength2D(),s<=e||e!==0&&t.calculateLength2D()<=e))}function I9(t,e){const s=t.getEndXY().sub(t.getStartXY()).length(),i=t.calculateUpperLength2D()-s<=e[0];return e[0]*=.1,i}function Q0e(t,e,s,i,r,n,o,a){let l=t.calculateUpperLength2D(),u=e.calculateUpperLength2D(),c=t,h=e,m=!1;l>u&&(h=be(c,c=h),i=be(s,s=i),u=be(l,l=u),m=!0);const f=s===0;{o[0]=f?1:0;const A=c.getCoord2D(o[0]);a[0]=h.getClosestCoordinate(A,!1);const D=h.getCoord2D(a[0]);if(M.distance(A,D)<=r){const k=[.5,.75,.25,.1,.9];let R=!0;for(let O=0;O<k.length;O++)if(A.assign(c.getCoord2D(k[O])),!h.isCloserThanDistance(A,new de(0,1),r)){R=!1;break}if(R)return m&&(a[0]=be(o[0],o[0]=a[0])),1}}if(l<=3*r)return 0;let g=ys(Math.max(r/l,.1),0,.5),v=.01*r,b=0,w=0,S=g,T=-1,P=0,I=1/32;for(let A=0;;A++){F(A<4095);const D=f?g:1-g,k=c.getCoord2D(D),R=h.getClosestCoordinate(k,!1);if(R===i)return P;const O=h.getCoord2D(R),z=M.distance(k,O);if(A===0&&(T=z),z<=v?(I=.5,w=z,b=g):(S=g,T=z),Math.abs(w-T)>.1*v&&S-b>1e-16)g=zt(b,S,I);else{if(o[P]=D,a[P]=R,m&&(a[P]=be(o[P],o[P]=a[P])),n===1||P===1)return P===1&&o[0]>o[1]&&(o[1]=be(o[0],o[0]=o[1]),a[1]=be(a[0],a[0]=a[1])),P+1;P++,b=S,w=T,S=.8,T=-1,g=.8,I=1/32,v=10*r,A=0}}}function NS(t,e,s,i,r,n,o,a,l){if(bs(s,0,1)&&bs(i,0,1)&&M.distance(t.getCoord2D(s),e.getCoord2D(i))===0){const c=new je,h=Bs();if(t.queryDerivative(new le(s,h),c),c.isTrueZero()){const b=s===1?-1e-12:1e-12;t.queryDerivative(new le(s,h).add(b),c)}s===1&&c.negateThis();const m=new je;if(e.queryDerivative(new le(i,h),m),m.isTrueZero()){const b=s===1?-1e-12:1e-12;e.queryDerivative(new le(i,h).add(b),m)}i===1&&m.negateThis(),c.isZero()||c.normalize(),m.isZero()||m.normalize();const f=c.dotProduct(m),g=c.crossProduct(m);g.scaleError(3);const v=()=>{{const b=t.calculateUpperLength2D(),w=e.calculateUpperLength2D();return Math.min(.01*r/Math.min(b,w),1e-10)}};if(f.ge(bx)&&(g.isZero()||Math.abs(g.value())<v()))return Q0e(t,e,s,i,r,n,o,a)}return 0}function vKe(t,e,s){return F(t.isCurve()||e.isCurve()),!!(t.getStartXY().equals(e.getStartXY())&&NS(t,e,0,0,s,2,[0,0],[0,0])||t.getEndXY().equals(e.getEndXY())&&NS(t,e,1,1,s,2,[0,0],[0,0])||t.getStartXY().equals(e.getEndXY())&&NS(t,e,0,1,s,2,[0,0],[0,0])||t.getEndXY().equals(e.getStartXY())&&NS(t,e,1,0,s,2,[0,0],[0,0]))}function M9(t,e){t.m_XStart=e.x,t.m_YStart=e.y}function Sie(t,e,s){t.m_XStart=e,t.m_YStart=s}function A9(t,e){t.m_XEnd=e.x,t.m_YEnd=e.y}function Eie(t,e,s){t.m_XEnd=e,t.m_YEnd=s}function bKe(t,e,s){e?t.m_XEnd===s.x&&t.m_YEnd===s.y||(t.m_XEnd=s.x,t.m_YEnd=s.y,t.endPointModified()):t.m_XStart===s.x&&t.m_YStart===s.y||(t.m_XStart=s.x,t.m_YStart=s.y,t.endPointModified())}function Cie(t,e){const s=new gt;return e?(s.x=t.m_XEnd,s.y=t.m_YEnd):(s.x=t.m_XStart,s.y=t.m_YStart),s.z=xKe(t,e),s}function xKe(t,e){return t.m_description.hasZ()?t.m_attributes[e*(t.m_description.getTotalComponentCount()-2)]:lg.getDefaultValue(1)}function rM(t,e,s){t.m_description.hasZ()||t.addAttribute(1),e?t.m_XEnd===s.x&&t.m_YEnd===s.y||(t.m_XEnd=s.x,t.m_YEnd=s.y,t.endPointModified()):t.m_XStart===s.x&&t.m_YStart===s.y||(t.m_XStart=s.x,t.m_YStart=s.y,t.endPointModified()),t.m_attributes[(t.m_description.getTotalComponentCount()-2)*e]=s.z}function Pie(t,e,s){s.assignVertexDescription(t.m_description);const i=e===0?t.m_XStart:t.m_XEnd,r=e===0?t.m_YStart:t.m_YEnd;s.setXYCoords(i,r);for(let n=1;n<t.m_description.getAttributeCount();n++){const o=t.m_description.getSemantics(n);for(let a=0,l=lg.getComponentCount(o);a<l;a++){const u=$c(t,e,o,a);s.setAttributeBasic(o,a,u)}}}function Tie(t,e,s){s.isEmpty()&&rR(""),bKe(t,e,s.getXY());const i=s.getDescription();i!==t.m_description&&t.mergeVertexDescription(i);for(let r=1,n=i.getAttributeCount();r<n;r++){const o=i.getSemantics(r),a=lg.getComponentCount(o);for(let l=0;l<a;l++)dd(t,e,o,l,s.getAttributeAsDbl(o,l))}}function $c(t,e,s,i){if((e<0||e>1)&&bt(""),s===0)return(i<0||i>=2)&&bt(""),e===0?i===0?t.m_XStart:t.m_YStart:i===0?t.m_XEnd:t.m_YEnd;const r=lg.getComponentCount(s);(i<0||i>=r)&&bt("");const n=t.m_description.getAttributeIndex(s);return n>=0?t.m_attributes[e*(t.m_description.getTotalComponentCount()-2)+t.m_description.getPointAttributeOffset(n)-2+i]:lg.getDefaultValue(s)}function dd(t,e,s,i,r){if((e<0||e>1)&&bt(""),s===0)return e===0?i===0?t.m_XStart=r:i===1?t.m_YStart=r:bt(""):e===1?i===0?t.m_XEnd=r:i===1?t.m_YEnd=r:bt(""):bt(""),void t.endPointModified();const n=lg.getComponentCount(s);(i<0||i>=n)&&bt("");let o=t.m_description.getAttributeIndex(s);o<0&&(t.addAttribute(s),o=t.m_description.getAttributeIndex(s)),t.m_attributes[e*(t.m_description.getTotalComponentCount()-2)+t.m_description.getPointAttributeOffset(o)-2+i]=r}function J0e(t,e){if(t===e)return;e.isEmpty()&&rR("");const s=e.getDescription();s!==t.m_description&&t.mergeVertexDescription(s);for(let i=1,r=s.getAttributeCount();i<r;i++){const n=s.getSemantics(i),o=lg.getComponentCount(n);for(let a=0;a<o;a++){let l=$c(e,0,n,a);dd(t,0,n,a,l),l=$c(e,1,n,a),dd(t,1,n,a,l)}}}function wKe(t,e){const s=lR();uR(e,t.m_description,s);let i=null;const r=e.getTotalComponentCount()-2,n=t.m_description?t.m_description.getTotalComponentCount()-2:0;if(r>0&&(i=Me(2*r,Number.NaN),$s(i,e.getDefaultPointAttributes(),0,2,r),$s(i,e.getDefaultPointAttributes(),r,2,r),t.m_description!==null))for(let o=1;o<e.getAttributeCount();o++){const a=s[o];if(a!==-1){const l=t.m_description.getPointAttributeOffset(a)-2,u=e.getPointAttributeOffset(o)-2,c=lg.getComponentCount(e.getSemantics(o));for(let h=0;h<c;++h)i[u]=t.m_attributes[l],i[r+u]=t.m_attributes[n+l]}}t.m_attributes=i,t.m_description=e}function Bh(t){return t.absNorm()*K_()}function jo(t,e){return Math.max(t.absNorm(),e.absNorm())*K_()}function nl(t,e,s){const i=new Yn;t.queryEnvelopeW(de.unit(),i);const r=new Yn;return e.queryEnvelopeW(de.unit(),r),r.inflate(s),!i.isIntersectingW(r)}function N9(t,e,s){const i=H3(t,s),r=H3(e,s);i.sort((n,o)=>n.compare(o)),r.sort((n,o)=>n.compare(o));for(let n=0;n<3;n++){if(i[n].compare(r[n])<0)return-1;if(i[n].compare(r[n])!==0)return 1}return 0}var A1=Es;class SP{constructor(e){if(e.copy)this.m_XStart=e.copy.m_XStart,this.m_YStart=e.copy.m_YStart,this.m_XEnd=e.copy.m_XEnd,this.m_YEnd=e.copy.m_YEnd,this.m_description=e.copy.m_description,this.m_attributes=null,this.m_description&&this.m_description.getTotalComponentCount()-2&&(this.m_attributes=e.copy.m_attributes.slice());else{if(e.move)return this.m_description=e.move.m_description,e.move.m_description=null,this.m_attributes=e.move.m_attributes,e.move.m_attributes=null,this.m_XStart=e.move.m_XStart,this.m_YStart=e.move.m_YStart,this.m_XEnd=e.move.m_XEnd,void(this.m_YEnd=e.move.m_YEnd);if(e.XStart!==void 0)return this.m_XStart=e.XStart,this.m_YStart=e.YStart,this.m_XEnd=e.XEnd,this.m_YEnd=e.YEnd,this.m_attributes=null,this.m_description=e.vd?e.vd:Jr(),void(e.vd&&this.setDefaultAttributeValues());if(e.ZStart!==void 0)return this.m_XStart=e.XStart,this.m_YStart=e.YStart,this.m_XEnd=e.XEnd,this.m_YEnd=e.YEnd,this.m_description=e.vd?e.vd:tC(),void(e.vd?(this.setDefaultAttributeValues(),this.addAttribute(1),this.m_attributes[0]=e.ZStart,this.m_attributes[this.m_description.getTotalComponentCount()-2]=e.ZEnd):this.m_attributes=[e.ZStart,e.ZEnd]);if(e.start)return this.m_XStart=e.start.x,this.m_YStart=e.start.y,this.m_XEnd=e.end.x,this.m_YEnd=e.end.y,this.m_attributes=null,void(this.m_description=Jr());if(e.start3D)return this.m_XStart=e.start3D.x,this.m_YStart=e.start3D.y,this.m_XEnd=e.end3D.x,this.m_YEnd=e.end3D.y,this.m_description=e.vd?e.vd:tC(),void(e.vd?(this.setDefaultAttributeValues(),this.addAttribute(1),this.m_attributes[0]=e.start3D.z,this.m_attributes[this.m_description.getTotalComponentCount()-2]=e.end3D.z):this.m_attributes=[e.start3D.z,e.end3D.z]);Ce("bad constructor params"),this.m_XStart=this.m_YStart=this.m_XEnd=this.m_YEnd=Number.NaN}}setDefaultAttributeValues(){const e=this.m_description.getTotalComponentCount()-2;e>0&&(this.m_attributes===null&&(this.m_attributes=Me(2*e,Number.NaN)),$s(this.m_attributes,this.m_description.getDefaultPointAttributes(),0,2,e),$s(this.m_attributes,this.m_description.getDefaultPointAttributes(),e,2,e))}absNormXYZ(e){return yt("not implemented"),0}snapControlPoints3D(){return yt("not implemented"),!1}setCoordsForIntersector3D(e,s,i){yt("not implemented")}transformAttribute(e,s,i,r,n){yt("")}mergeVertexDescriptionImpl(e){const s=this.getDescription(),i=Sx(s,e);this.assignVertexDescription(i)}changeEndPoints(e,s){const i=e.getXY(),r=s.getXY();this.changeEndPoints2D(i,r);let n=e.getDescription();n!==this.getDescription()&&this.mergeVertexDescription(n),n=s.getDescription(),n!==this.getDescription()&&this.mergeVertexDescription(n);for(let o=1,a=n.getAttributeCount();o<a;o++){const l=n.getSemantics(o),u=A1.getComponentCount(l);for(let c=0;c<u;c++)dd(this,0,l,c,e.getAttributeAsDbl(l,c)),dd(this,1,l,c,s.getAttributeAsDbl(l,c))}}getStartXY(){return new M(this.m_XStart,this.m_YStart)}setStartXY(e){this.m_XStart=e.x,this.m_YStart=e.y,this.endPointModified()}setStartXYCoords(e,s){this.m_XStart=e,this.m_YStart=s,this.endPointModified()}getStartXYZ(){return Cie(this,0)}setStartXYZ(e){rM(this,0,e)}setStartXYZCoords(e,s,i){rM(this,0,gt.construct(e,s,i))}queryStart(e){Pie(this,0,e)}setStart(e){Tie(this,0,e)}setStart2D(e){this.setStartXY(e)}getStartAttributeAsDbl(e,s){return $c(this,0,e,s)}getStartAttributeAsInt(e,s){return F(0),0}setStartAttribute(e,s,i){dd(this,0,e,s,i)}setStartAttributesFromPoint(e,s){const i=e.getDescription();for(let r=s&&i.hasZ()?2:1,n=i.getAttributeCount();r<n;++r){const o=i.getSemantics(r),a=A1.getComponentCount(o);for(let l=0;l<a;++l){const u=e.getAttributeAsDbl(o,l);this.setStartAttribute(o,l,u)}}}setEndAttributesFromPoint(e,s){const i=e.getDescription();for(let r=s&&i.hasZ()?2:1,n=i.getAttributeCount();r<n;++r){const o=i.getSemantics(r),a=A1.getComponentCount(o);for(let l=0;l<a;++l){const u=e.getAttributeAsDbl(o,l);this.setEndAttribute(o,l,u)}}}getStartX(){return this.m_XStart}getStartY(){return this.m_YStart}getStartZ(){return F(0),0}getEndX(){return this.m_XEnd}getEndY(){return this.m_YEnd}getEndZ(){return F(0),0}getEndXY(){return new M(this.m_XEnd,this.m_YEnd)}setEndXY(e){this.m_XEnd=e.x,this.m_YEnd=e.y,this.endPointModified()}setEndXYCoords(e,s){this.m_XEnd=e,this.m_YEnd=s,this.endPointModified()}getEndXYZ(){return Cie(this,1)}setEndXYZ(e){rM(this,1,e)}setEndXYZCoords(e,s,i){rM(this,1,gt.construct(e,s,i))}queryEnd(e){Pie(this,1,e)}setEnd(e){Tie(this,1,e)}setEnd2D(e){this.setEndXY(e)}getEndAttributeAsDbl(e,s){return $c(this,1,e,s)}getEndAttributeAsInt(e,s){return F(0),Math.trunc(0)}setEndAttribute(e,s,i){dd(this,1,e,s,i)}getDimension(){return 1}copyTo(e){if(this===e)return;e.getGeometryType()!==this.getGeometryType()&&ee("");const s=e;s.assignVertexDescription(this.m_description),s.m_attributes&&$s(s.m_attributes,this.m_attributes,0,0,2*(this.m_description.getTotalComponentCount()-2)),s.m_XStart=this.m_XStart,s.m_YStart=this.m_YStart,s.m_XEnd=this.m_XEnd,s.m_YEnd=this.m_YEnd,this.copyToImpl(s)}isEmpty(){return this.isEmptyImpl()}isClosed(){return this.m_XStart===this.m_XEnd&&this.m_YStart===this.m_YEnd}setEmpty(){}calculateArea2D(){return 0}queryInterval(e,s){const i=de.constructEmpty();return i.vmin=$c(this,0,e,s),i.vmax=i.vmin,i.mergeNeCoordinate($c(this,1,e,s)),i}calculateLength3D(e){return F(0),0}getCoord3D(e){return F(0),{}}getCoord2D(e){const s=M.getNAN();return this.queryCoord2D(e,s),s}queryCoord3D(e,s){F(0)}getCoordZ(e){return F(0),0}queryCoord(e,s){s.assignVertexDescription(this.m_description),s.setXY(this.getCoord2D(e));for(let i=1,r=this.m_description.getAttributeCount();i<r;i++){const n=this.m_description.getSemantics(i),o=A1.getComponentCount(n);for(let a=0;a<o;a++){const l=this.getAttributeAsDbl(e,n,a);s.setAttributeBasic(n,a,l)}}}isCloserThanDistance(e,s,i){const r=X.constructEmpty();if(this.queryLooseEnvelopeOnInterval(s,r),r.distance(e)>i)return!1;const n=this.getClosestCoordinateOnInterval(e,s,i);return!Number.isNaN(n)&&M.distance(e,this.getCoord2D(n))<=i}isMonotoneQuickAndDirty(){return!1}isTrue3D(){return!1}getReversed(){const e=this.clone();return e.reverse(),e}reverse(){this.m_XEnd=be(this.m_XStart,this.m_XStart=this.m_XEnd),this.m_YEnd=be(this.m_YStart,this.m_YStart=this.m_YEnd),this.reverseImpl();for(let e=1,s=this.m_description.getAttributeCount();e<s;e++){const i=this.m_description.getSemantics(e);for(let r=0,n=A1.getComponentCount(i);r<n;r++){const o=$c(this,0,i,r);dd(this,0,i,r,$c(this,1,i,r)),dd(this,1,i,r,o)}}return this.afterCompletedModification(),this}isEmptyImpl(){return!1}isCircular(){return!1}distance(e,s,i,r){if(!s&&this.isIntersecting(e,0,!1)){if(i!==null||r!==null){const u=Me(9,Number.NaN),c=Me(9,Number.NaN),h=this.intersect(e,null,u,c,0);F(h<=9),h===0&&Ce(""),i!==null&&(i[0]=u[0]),r!==null&&(r[0]=c[0])}return 0}let n,o=Number.MAX_VALUE,a=-1,l=o;return n=this.getStartXY(),a=e.getClosestCoordinate(n,!1),n.subThis(e.getCoord2D(a)),l=n.length(),l<o&&(o=l,r!==null&&(r[0]=a),i!==null&&(i[0]=0)),n=this.getEndXY(),a=e.getClosestCoordinate(n,!1),n.subThis(e.getCoord2D(a)),l=n.length(),l<o&&(o=l,r!==null&&(r[0]=a),i!==null&&(i[0]=1)),n=e.getStartXY(),a=this.getClosestCoordinate(n,!1),n.subThis(this.getCoord2D(a)),l=n.length(),l<o&&(o=l,i!==null&&(i[0]=a),r!==null&&(r[0]=0)),n=e.getEndXY(),a=this.getClosestCoordinate(n,!1),n.subThis(this.getCoord2D(a)),l=n.length(),l<o&&(o=l,i!==null&&(i[0]=a),r!==null&&(r[0]=1)),o}calculateSubLengthFromStart(e){return this.tToLength(e)}calculateSubLength(e,s){return s===e?0:this.tToLength(s)-this.tToLength(e)}static recalculateParentT(e,s,i){return zt(e,s,i)}moveTo(e){const s=this.isClosed(),i=new Rt;i.setShift(e.sub(this.getStartXY())),this.applyTransformation(i),s?this.changeEndPoints2D(e,e):this.changeEndPoints2D(e,this.getEndXY())}moveTo3D(e){F(0)}getDescription(){return this.m_description}assignVertexDescription(e){wKe(this,e)}mergeVertexDescription(e){this.m_description!==e&&(this.m_description.hasAttributesFrom(e)||this.mergeVertexDescriptionImpl(e))}hasAttribute(e){return this.m_description.hasAttribute(e)}addAttribute(e){if(this.m_description.hasAttribute(e))return;const s=bP(this.m_description,e);this.assignVertexDescription(s)}dropAttribute(e){if(!this.m_description.hasAttribute(e))return;const s=xP(this.m_description,e);this.assignVertexDescription(s)}dropAllAttributes(){const e=Jr();e!==this.m_description&&this.assignVertexDescription(e)}swap(e){if(this===e)return;e.getGeometryType()!==this.getGeometryType()&&ee("wrong geometry type");const s=e;s.m_description=be(this.m_description,this.m_description=s.m_description),s.m_XStart=be(this.m_XStart,this.m_XStart=s.m_XStart),s.m_YStart=be(this.m_YStart,this.m_YStart=s.m_YStart),s.m_XEnd=be(this.m_XEnd,this.m_XEnd=s.m_XEnd),s.m_YEnd=be(this.m_YEnd,this.m_YEnd=s.m_YEnd),s.m_attributes=be(this.m_attributes,this.m_attributes=s.m_attributes),this.swapImpl(s)}equals(e,s){if(this.getGeometryType()!==e.getGeometryType())return!1;const i=s===void 0;i&&(s=0);const r=e;if(this===r)return!0;if(this.m_description!==r.m_description||Math.abs(this.m_XStart-r.m_XStart)>s||Math.abs(this.m_XEnd-r.m_XEnd)>s||Math.abs(this.m_YStart-r.m_YStart)>s||Math.abs(this.m_YEnd-r.m_YEnd)>s)return!1;for(let n=0,o=2*(this.m_description.getTotalComponentCount()-2);n<o;n++)if(!wx(this.m_attributes[n],r.m_attributes[n],s))return!1;return i?this.equalsImpl(r):this.equalsImplTol(r,s)}getImpl(){return this}setAttributeBasic(e,s,i){if(this.addAttribute(e),e===0&&this.isCurve()){(s<0||s>1)&&ee("");const r=new Rt,n=s===0?i:0,o=s===1?i:0;r.setShiftCoords(n,o),s===0?r.xx=0:r.yy=0,this.applyTransformation(r)}else this.setStartAttribute(e,s,i),this.setEndAttribute(e,s,i)}replaceNaNs(e,s){if(this.addAttribute(e),this.isEmpty())return;const i=A1.getComponentCount(e);for(let r=0;r<i;r++){const n=this.getStartAttributeAsDbl(e,r);Number.isNaN(n)&&this.setStartAttribute(e,r,s);const o=this.getEndAttributeAsDbl(e,r);Number.isNaN(o)&&this.setEndAttribute(e,r,s)}}}SP.s_maxMonotonicPartParams=8;let SKe=class extends nm{constructor(e,s){super(),this.m_index=-1,this.gc=e,this.dim=s}next(){for(;;){if(this.m_index>=this.gc.getGeometryCount()||(this.m_index++,this.m_index===this.gc.getGeometryCount()))return null;const e=this.gc.getGeometry(this.m_index);if(this.dim===-1||1<<e.getDimension()&this.dim)return e}return null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}},K0e=class Y8{constructor(e){this.m_geoms=[],this.m_description=Jr(),e&&(e.vd?this.m_description=e.vd:e.copy?e.copy.copyTo(this):ee("constructor argument not recognized"))}getGeometryCount(){return this.m_geoms.length}reserve(e){}addGeometry(e){if(e.getGeometryType()===G.enumGeometryCollection){const s=e;for(let i=0,r=s.getGeometryCount();i<r;i++)this.addGeometry(s.getGeometry(i))}else this.m_geoms.push(e.clone()),this.mergeVertexDescription(e.getDescription())}addCursor(e){for(let s=e.next();s!==null;s=e.next())this.addGeometry(s)}getGeometry(e){return(e<0||e>=this.m_geoms.length)&&ee("Geometry_collection.get_geometry"),this.m_geoms[e]}modifiedElementIndex(e){this.mergeVertexDescription(this.getGeometry(e).getDescription())}modifiedElement(e){this.mergeVertexDescription(e.getDescription())}getGeometryType(){return G.enumGeometryCollection}getDimension(){let e=0;for(const s of this.m_geoms)e=Math.max(e,s.getDimension());return e}getDescription(){return this.m_description}assignVertexDescription(e){this.m_description!==e&&this.assignVertexDescriptionImpl(e)}assignVertexDescriptionImpl(e){for(const s of this.m_geoms)s.assignVertexDescription(e);this.m_description=e}mergeVertexDescription(e){this.m_description!==e&&(this.m_description.hasAttributesFrom(e)||this.mergeVertexDescriptionImpl(e))}hasAttribute(e){return this.m_description.hasAttribute(e)}addAttribute(e){if(this.m_description.hasAttribute(e))return;const s=bP(this.m_description,e);this.assignVertexDescription(s)}dropAttribute(e){if(!this.m_description.hasAttribute(e))return;const s=xP(this.m_description,e);this.assignVertexDescription(s)}dropAllAttributes(){const e=Jr();e!==this.m_description&&this.assignVertexDescription(e)}queryInterval(e,s){let i=new de;const r=new de;r.setEmpty();for(const n of this.m_geoms)i=n.queryInterval(e,s),r.merge(i);return r}queryEnvelope(e){if(e.m_EnvelopeType===4){const s=new Sn;e.setEmpty(),e.assignVertexDescription(this.m_description);for(const i of this.m_geoms)i.queryEnvelope(s),e.merge(s)}else if(e.m_EnvelopeType===2){const s=new X;e.setEmpty();for(const i of this.m_geoms)i.queryEnvelope(s),e.mergeEnvelope2D(s)}yt("3d envelope case not implemented")}queryLooseEnvelope(e){if(e.m_EnvelopeType===2){const s=new X;e.setEmpty();for(const i of this.m_geoms)i.queryLooseEnvelope(s),e.mergeEnvelope2D(s)}yt("3d not impl")}isEmpty(){return this.m_geoms.length===0}setEmpty(){this.m_geoms.length=0}applyTransformation(e){if(e.m_TransformationType===1)for(const s of this.m_geoms)s.applyTransformation(e);yt("3d xform not impl")}transformAttribute(e,s,i,r,n){for(const o of this.m_geoms)o.transformAttribute(e,s,i,r,n)}createInstance(){return new Y8({vd:this.getDescription()})}copyTo(e){e.getGeometryType()!==G.enumGeometryCollection&&ee("");const s=e;if(s!==this){s.m_geoms.length=0,s.assignVertexDescription(this.m_description);for(const i of this.m_geoms)s.m_geoms.push(i.clone())}}calculateArea2D(){const e=new Fr(0);for(const s of this.m_geoms)e.pe(s.calculateArea2D());return e.getResult()}calculateLength2D(){const e=new Fr(0);for(const s of this.m_geoms)e.pe(s.calculateLength2D());return e.getResult()}calculateLength3D(e){return F(0),0}getBoundary(){const e=this.createInstance(),s=e;for(const i of this.m_geoms){const r=i.getBoundary();r&&s.m_geoms.push(r)}return e}clone(){return new Y8({copy:this})}equals(e,s){if(e===this)return!0;if(e.getGeometryType()!==G.enumGeometryCollection)return!1;const i=e;if(this.m_description!==i.m_description||this.m_geoms.length!==i.m_geoms.length)return!1;for(let r=0;r<this.m_geoms.length;++r)if(!this.m_geoms[r].equals(i.m_geoms[r],s))return!1;return!0}swap(e){e.getGeometryType()!==G.enumGeometryCollection&&ee("");const s=e;s!==this&&(this.m_geoms=be(s.m_geoms,s.m_geoms=this.m_geoms))}setAttributeBasic(e,s,i){for(const r of this.m_geoms)r.setAttributeBasic(e,s,i)}replaceNaNs(e,s){for(const i of this.m_geoms)i.replaceNaNs(e,s)}getImpl(){return this}mergeVertexDescriptionImpl(e){const s=this.getDescription(),i=Sx(s,e);this.assignVertexDescription(i)}};function EKe(t,e=-1){return new SKe(t,e)}K0e.type=G.enumGeometryCollection;let EP=class extends SP{constructor(e){super(e)}},CKe=class extends EP{isTrue3D(){return!0}constructor(e){super(e)}};function ga(t,e,s){D9(e,t.getStartXY(),t.getEndXY(),s)}function D9(t,e,s,i){wi(e,s,t,i)}function nM(t,e){return zt(t.m_XStart,t.m_XEnd,e)}function oL(t,e){return zt(t.m_YStart,t.m_YEnd,e)}function PKe(t,e){const s=t.getStartZ(),i=t.getEndZ();return zt(s,i,e)}function TKe(t,e,s){const i=je.constructPoint2D(t.getStartXY()),r=je.constructPoint2D(t.getEndXY());s.setCoordsE(r.x.subE(i.x),r.y.subE(i.y))}function e1e(t,e,s){e.value()<=.5?Rl(2,je.constructPoint2D(t.getStartXY()),je.constructPoint2D(t.getEndXY()),e,s):kl(2,je.constructPoint2D(t.getStartXY()),je.constructPoint2D(t.getEndXY()),e,s)}function Iie(t,e,s){t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=s.x,t.m_YEnd=s.y,t.afterCompletedModification()}function IKe(t,e){const s=t.getStartXYZ();s.z*=e;const i=t.getEndXYZ();return i.z*=e,s.norm(1)+i.norm(1)}function t1e(t){if(t.m_YEnd<t.m_YStart||t.m_YEnd===t.m_YStart&&t.m_XEnd<t.m_XStart){t.m_XEnd=be(t.m_XStart,t.m_XStart=t.m_XEnd),t.m_YEnd=be(t.m_YStart,t.m_YStart=t.m_YEnd);for(let e=0,s=t.m_description.getTotalComponentCount()-2;e<s;e++)t.m_attributes[e+s]=be(t.m_attributes[e],t.m_attributes[e]=t.m_attributes[e+s])}}function X8(t,e,s,i){let r=0;if((t.m_XStart===e.m_XStart&&t.m_YStart===e.m_YStart||t.m_XStart===e.m_XEnd&&t.m_YStart===e.m_YEnd)&&(r++,!i))return 1;if(t.m_XEnd===e.m_XStart&&t.m_YEnd===e.m_YStart||t.m_XEnd===e.m_XEnd&&t.m_YEnd===e.m_YEnd){if(r++,r===2)return 2;if(!i)return 1}return e.isIntersectingPoint(t.getStartXY(),s,!0)||e.isIntersectingPoint(t.getEndXY(),s,!0)||t.isIntersectingPoint(e.getStartXY(),s,!0)||t.isIntersectingPoint(e.getEndXY(),s,!0)?4:i&&r?0:AKe(t,e)?4:0}function dR(t,e,s,i,r,n,o,a){i!==null&&B3(i,2,Number.NaN),r!==null&&B3(r,2,Number.NaN),s!==null&&vJe(s,M,2);const l=MKe(t,e,2,s,i,r,n,o,a);return i&&(i.length=l),r&&(r.length=l),s&&(s.length=l),l}function MKe(t,e,s,i,r,n,o,a,l){const u=Lv(t,e.getStartXY(),o,!1),c=Lv(t,e.getEndXY(),o,!1),h=Lv(e,t.getStartXY(),o,!1),m=Lv(e,t.getEndXY(),o,!1);let f=0,g=0;if(!Number.isNaN(u)){let b=!1;a&&bs(u,0,1)&&t.getCoord2D(u).isEqualPoint2D(e.getStartXY())&&(f++,b=!0),b||(r&&(r[g]=u),n&&(n[g]=0),i&&i[g].setCoords(e.m_XStart,e.m_YStart),g++)}if(!Number.isNaN(c)){let b=!1;a&&bs(c,0,1)&&t.getCoord2D(c).isEqualPoint2D(e.getEndXY())&&(f++,b=!0),b||(s>g&&(r&&(r[g]=c),n&&(n[g]=1),i&&i[g].setCoords(e.m_XEnd,e.m_YEnd)),g++)}if(g!==2&&!Number.isNaN(h)&&!(u===0&&h===0||c===0&&h===1)){let b=!1;a&&bs(h,0,1)&&e.getCoord2D(h).isEqualPoint2D(t.getStartXY())&&(f++,b=!0),b||(s>g&&(r&&(r[g]=0),n&&(n[g]=h),i&&i[g].setCoords(t.m_XStart,t.m_YStart)),g++)}if(g!==2&&!Number.isNaN(m)&&!(u===1&&m===0||c===1&&m===1)){let b=!1;a&&bs(m,0,1)&&e.getCoord2D(m).isEqualPoint2D(t.getEndXY())&&(f++,b=!0),b||(s>g&&(r&&(r[g]=1),n&&(n[g]=m),i&&i[g].setCoords(e.m_XEnd,e.m_YEnd)),g++)}if(g>0)return l&&(n=be(r,r=n)),g===2&&s>=2&&r&&r[0]>r[1]&&(r[1]=be(r[0],r[0]=r[1]),n&&(n[1]=be(n[0],n[0]=n[1])),i&&(i[1]=be(i[0],i[0]=i[1]))),g;if(f>0)return 0;const v=NKe(t,e,o);return Number.isNaN(v.x)?0:(i&&(i[0]=t.getCoord2D(v.x)),r&&(r[0]=v.x),n&&(n[0]=v.y),1)}function AKe(t,e){const s=oM(t,e.m_XStart,e.m_YStart),i=oM(t,e.m_XEnd,e.m_YEnd);if(s<0&&i<0||s>0&&i>0)return!1;const r=oM(e,t.m_XStart,t.m_YStart),n=oM(e,t.m_XEnd,t.m_YEnd);return r<0&&n<0||r>0&&n>0?!1:W8(t)>W8(e)?Aie(t,e):Aie(e,t)}function Lv(t,e,s,i){const r=M.getNAN(),n=M.getNAN();let o=!1;t.m_YEnd<t.m_YStart||t.m_YEnd===t.m_YStart&&t.m_XEnd<t.m_XStart?(r.setCoords(t.m_XEnd,t.m_YEnd),n.setCoords(t.m_XStart,t.m_YStart),o=!0):(r.setCoords(t.m_XStart,t.m_YStart),n.setCoords(t.m_XEnd,t.m_YEnd));const a=o?1:0,l=o?0:1,u=M.getNAN();u.setSub(e,r);let c=u.length(),h=3*c*Bs();if(c<=Math.max(s,h))return i&&c===0?Number.NaN:a;if(u.setSub(e,n),c=u.length(),h=3*c*Bs(),c<=Math.max(s,h))return i&&c===0?Number.NaN:l;u.setCoords(n.x-r.x,n.y-r.y);const m=u.length();if(m>0){const f=1/m;u.scale(f);const g=M.getNAN();g.setSub(e,r);const v=g.dotProduct(u),b=8*g.dotProductAbs(u)*Bs();u.leftPerpendicularThis();const w=g.dotProduct(u),S=8*g.dotProductAbs(u)*Bs(),T=Math.max(s,b);if(v<-T||v>m+T)return Number.NaN;const P=Math.max(s,S);if(Math.abs(w)<=P){let I=v*f;I=ys(I,0,1);const A=M.getNAN();if(D9(I,r,n,A),M.distance(A,e)<=s){if(I<.5){if(M.distance(A,r)<=s&&M.distance(e,r)<=s)return a}else if(M.distance(A,n)<=s&&M.distance(e,n)<=s)return l;return o?1-I:I}}}return Number.NaN}function oM(t,e,s){const i=M.getNAN();i.setCoords(e,s),i.subThis(t.getStartXY());const r=M.getNAN();r.setSub(t.getEndXY(),t.getStartXY());const n=r.crossProduct(i),o=4*Bs()*(Math.abs(r.x*i.y)+Math.abs(r.y*i.x));return n>o?-1:n<-o?1:0}function Mie(t,e,s,i){const r=i?t.m_XStart:t.m_XEnd,n=i?t.m_YStart:t.m_YEnd,o=M.getNAN();return o.x=e.getEndX()-r,o.y=e.getEndY()-n,s.dotProduct(o)>3*Bs()*s.dotProductAbs(o)?(o.x=e.getStartX()-r,o.y=e.getStartY()-n,s.dotProduct(o)<=3*Bs()*s.dotProductAbs(o)):!0}function Aie(t,e){const s=M.getNAN();return s.x=t.m_XEnd-t.m_XStart,s.y=t.m_YEnd-t.m_YStart,!!Mie(t,e,s,!1)&&(s.negateThis(),!!Mie(t,e,s,!0))}function W8(t){const e=t.m_XStart-t.m_XEnd,s=t.m_YStart-t.m_YEnd;return e*e+s*s}function NKe(t,e,s){const i=t.m_XEnd-t.m_XStart,r=t.m_YEnd-t.m_YStart,n=e.m_XEnd-e.m_XStart,o=e.m_YEnd-e.m_YStart,a=n*r-i*o;if(a===0)return M.getNAN();const l=4*Bs()*(Math.abs(n*r)+Math.abs(i*o)),u=e.m_XStart-t.m_XStart,c=e.m_YStart-t.m_YStart,h=n*c-u*o,m=4*Bs()*(Math.abs(n*c)+Math.abs(u*o)),f=h/a,g=Math.abs(a),v=(m*g+l*Math.abs(h))/(a*a)+Bs()*Math.abs(f);if(f<-v||f>1+v)return M.getNAN();const b=i*c-u*r,w=b/a,S=(4*Bs()*(Math.abs(i*c)+Math.abs(u*r))*g+l*Math.abs(b))/(a*a)+Bs()*Math.abs(w);if(w<-S||w>1+S)return M.getNAN();let T=ys(f,0,1),P=ys(w,0,1);const I=M.getNAN();ga(t,T,I);const A=M.getNAN();if(ga(e,P,A),!s||M.distance(I,A)>s){const D=M.getNAN();wi(I,A,.5,D),T=t.getClosestCoordinate(D,!1),P=e.getClosestCoordinate(D,!1);const k=M.getNAN();ga(t,T,k);const R=M.getNAN();ga(e,P,R),k.subThis(R);const O=k.length(),z=(t.absNorm()+e.absNorm())*K_();if(O>Math.max(s,z))return M.getNAN()}return new M(T,P)}let aL=class{constructor(e){if(this.m_segFlagStream=null,this.m_xyStream=null,this.m_bCirculator=!1,this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=0,this.m_nextPathIndex=0,this.m_currentPathIndex=-1,this.m_parent=e.parent,this.m_buffer=new this.m_parent.m_segmentBufferCTor,this.m_description=e.parent.getDescription(),this.m_segmentCount=this.getSegmentCount(this.m_nextPathIndex),e.pointIndex!==void 0){(e.pointIndex<0||e.pointIndex>=e.parent.getPointCount())&&bt("");const s=e.parent.getPathIndexFromPointIndex(e.pointIndex);this.m_currentPathIndex=s,this.m_nextPathIndex=s+1,this.m_nextSegmentIndex=e.pointIndex-e.parent.getPathStart(s),this.m_segmentCount=this.getSegmentCount(this.m_currentPathIndex)}else if(e.pathIndex!==void 0){(e.pathIndex<0||e.pathIndex>=e.parent.getPathCount()||e.segmentIndex<0)&&bt("");const s=e.parent.isClosedPath(e.pathIndex)?0:1;e.segmentIndex>=e.parent.getPathSize(e.pathIndex)-s&&bt(""),this.m_nextSegmentIndex=e.segmentIndex,this.m_currentPathIndex=e.pathIndex,this.m_nextPathIndex=this.m_nextSegmentIndex+1,this.m_segmentCount=this.getSegmentCount(this.m_nextPathIndex)}this.prepare(),this.m_pathBegin=-1,this.m_bCurrentPathClosed=!1,this.m_bStripAttributes=!1,this.m_prevPathIndex=-1,this.m_prevSegmentIndex=-1,this.m_bNeedsUpdate=!1,this.m_currentPathIndex>-1&&(this.m_pathBegin=this.m_parent.getPathStart(this.m_currentPathIndex),this.m_bCurrentPathClosed=this.m_parent.isClosedPath(this.m_currentPathIndex))}stripAttributes(){this.m_bStripAttributes=!0}prepare(){this.m_bCirculator=!1,this.m_parent.isEmptyImpl()?(this.m_segFlagStream=null,this.m_xyStream=null):(this.m_segFlagStream=this.m_parent.getSegmentFlagsStreamRef(),this.m_xyStream=this.m_parent.getAttributeStreamRef(0))}nextPath(){return this.m_currentPathIndex=this.m_nextPathIndex,!(this.m_currentPathIndex>=this.m_parent.getPathCount())&&(this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=0,this.m_segmentCount=this.getSegmentCount(this.m_currentPathIndex),this.m_pathBegin=this.m_parent.getPathStart(this.m_currentPathIndex),this.m_bCurrentPathClosed=this.m_parent.isClosedPath(this.m_currentPathIndex),this.m_nextPathIndex++,!0)}previousPath(){return this.m_nextPathIndex!==0&&(this.m_nextPathIndex--,this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=0,this.m_segmentCount=this.getSegmentCount(this.m_nextPathIndex),this.m_currentPathIndex=this.m_nextPathIndex,this.m_pathBegin=this.m_parent.getPathStart(this.m_currentPathIndex),this.m_bCurrentPathClosed=this.m_parent.isClosedPath(this.m_currentPathIndex),this.resetToLastSegment(),!0)}getSegmentCount(e){return this.m_parent.isEmptyImpl()?0:this.m_parent.getSegmentCountPath(e)}resetToFirstPath(){this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=-1,this.m_segmentCount=-1,this.m_nextPathIndex=0,this.m_currentPathIndex=-1,this.m_pathBegin=-1,this.m_bCurrentPathClosed=!1}resetToLastPath(){this.m_nextPathIndex=this.m_parent.getPathCount(),this.m_currentPathIndex=-1,this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=-1,this.m_segmentCount=-1,this.m_pathBegin=-1}resetToPath(e){(e<0||e>this.m_parent.getPathCount())&&bt(""),this.m_nextPathIndex=e,this.m_currentPathIndex=-1,this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=-1,this.m_segmentCount=-1,this.m_pathBegin=-1,this.m_bCurrentPathClosed=!1}isLastPath(){return this.m_currentPathIndex===this.m_parent.getPathCount()-1}isFirstSegmentInPath(){return this.m_currentSegmentIndex===0}isLastSegmentInPath(){return this.m_currentSegmentIndex===this.m_segmentCount-1}resetToFirstSegment(){this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=0}resetToLastSegment(){this.m_nextSegmentIndex=this.m_segmentCount,this.m_currentSegmentIndex=-1}resetTo(e){this.m_parent!==e.m_parent&&Us(""),this.m_currentSegmentIndex=e.m_currentSegmentIndex,this.m_nextSegmentIndex=e.m_nextSegmentIndex,this.m_currentPathIndex=e.m_currentPathIndex,this.m_nextPathIndex=e.m_nextPathIndex,this.m_segmentCount=e.m_segmentCount,this.m_bCirculator=e.m_bCirculator,this.m_pathBegin=e.m_pathBegin,this.m_bCurrentPathClosed=e.m_bCurrentPathClosed,this.m_bStripAttributes=e.m_bStripAttributes,this.m_description=e.m_description}resetToVertex(e,s){if(this.m_currentPathIndex>=0&&this.m_currentPathIndex<this.m_parent.getPathCount()){const r=this.getPathBegin();if(e>=r&&e<this.m_parent.getPathEnd(this.m_currentPathIndex))return this.m_currentSegmentIndex=-1,void(this.m_nextSegmentIndex=e-r)}let i;i=s>=0&&s<this.m_parent.getPathCount()&&e>=this.m_parent.getPathStart(s)&&e<this.m_parent.getPathEnd(s)?s:this.m_parent.getPathIndexFromPointIndex(e),this.m_nextPathIndex=i+1,this.m_currentPathIndex=i,this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=e-this.m_parent.getPathStart(i),this.m_segmentCount=this.getSegmentCount(i),this.m_pathBegin=this.m_parent.getPathStart(this.m_currentPathIndex),this.m_bCurrentPathClosed=this.m_parent.isClosedPath(this.m_currentPathIndex)}hasNextSegment(){return this.m_nextSegmentIndex<this.m_segmentCount}hasPreviousSegment(){return this.m_nextSegmentIndex>0}nextSegment(){return this.m_currentSegmentIndex!==this.m_nextSegmentIndex&&this.updateSegment(),this.m_bCirculator?this.m_nextSegmentIndex=(this.m_nextSegmentIndex+1)%this.m_segmentCount:(this.m_nextSegmentIndex===this.m_segmentCount&&bt("Segment_iterator_impl::next_segment"),this.m_nextSegmentIndex++),this.m_buffer.get()}previousSegment(){return this.m_bCirculator?this.m_nextSegmentIndex=(this.m_segmentCount+this.m_nextSegmentIndex-1)%this.m_segmentCount:(this.m_nextSegmentIndex===0&&bt(""),this.m_nextSegmentIndex--),this.m_nextSegmentIndex!==this.m_currentSegmentIndex&&this.updateSegment(),this.m_buffer.get()}nextCurve(){if(!this.m_parent.hasNonLinearSegments())return this.resetToLastSegment(),null;let e=0;for(;;){if(this.m_nextSegmentIndex===this.m_segmentCount||e===this.m_segmentCount)return null;const s=this.getPathBegin()+this.m_nextSegmentIndex;if((31&this.m_segFlagStream.read(s))!==1){this.updateSegment();break}this.m_bCirculator?this.m_nextSegmentIndex=(this.m_nextSegmentIndex+1)%this.m_segmentCount:this.m_nextSegmentIndex++,e++}return this.m_currentSegmentIndex!==this.m_nextSegmentIndex&&this.updateSegment(),this.m_bCirculator?this.m_nextSegmentIndex=(this.m_nextSegmentIndex+1)%this.m_segmentCount:(this.m_nextSegmentIndex===this.m_segmentCount&&bt(""),this.m_nextSegmentIndex++),this.m_buffer.get()}getPathBegin(){return this.m_pathBegin}getPathIndex(){return this.m_currentPathIndex}getStartPointIndex(){return this.getPathBegin()+this.m_currentSegmentIndex}getEndPointIndex(){return this.isClosingSegment()?this.getPathBegin():this.getStartPointIndex()+1}updateSegment(){(this.m_nextSegmentIndex<0||this.m_nextSegmentIndex>=this.m_segmentCount||this.m_currentPathIndex<0)&&bt(""),this.m_currentSegmentIndex=this.m_nextSegmentIndex,this.m_parent.getSegmentFromPath(this.m_currentPathIndex,this.m_currentSegmentIndex,this.m_buffer,this.m_bStripAttributes)}isClosingSegment(){return this.m_bCurrentPathClosed&&this.m_currentSegmentIndex===this.m_segmentCount-1}isCurve(){return this.m_segFlagStream!==null?(31&this.m_segFlagStream.read(this.m_currentSegmentIndex))!==1:!1}isPathClosed(){return this.m_bCurrentPathClosed}setCirculator(e){this.m_bCirculator=e}getImpl(){return this}},Nie=class s1e{constructor(e){this.m_rasterizedGeometry=null,this.m_quadTree=null,this.m_quadTreeForPaths=null,this.m_refCount=1,e&&e.copyTo(this)}getRasterizedGeometry(){return this.m_rasterizedGeometry}copyTo(e){e!==this&&(F(e.uniqueUse()),e.m_quadTree=this.m_quadTree,e.m_quadTreeForPaths=this.m_quadTreeForPaths,e.m_rasterizedGeometry=this.m_rasterizedGeometry)}clone(){const e=new s1e;return this.copyTo(e),e}uniqueUse(){return this.m_refCount===1}addRef(){++this.m_refCount}release(){--this.m_refCount==0&&(this.m_rasterizedGeometry=null,this.m_quadTree=null,this.m_quadTreeForPaths=null)}setRasterizedGeometry(e){F(this.uniqueUse())}setQuadTree(e){F(this.uniqueUse()),this.m_quadTree=e}setQuadTreeForPaths(e){F(this.uniqueUse()),this.m_quadTreeForPaths=e}getQuadTree(){return this.m_quadTree}getQuadTreeForPaths(){return this.m_quadTreeForPaths}};function Z3(t){return!(t.isEmpty()||t.getGeometryType()!==G.enumPolyline&&t.getGeometryType()!==G.enumPolygon)&&!(t.getPointCount()<20)}function i1e(t){return!(t.isEmpty()||t.getGeometryType()!==G.enumPolyline&&t.getGeometryType()!==G.enumPolygon)&&!(t.getPointCount()<20)}function DKe(t,e){return t.readPoint2D(e+4)}function lL(t){const e=t.getGeometryType();return e===G.enumEllipticArc?10:e===G.enumBezier?4:e===G.enumRationalBezier2?5:e===G.enumBezier2?2:void Ce("")}function Al(t){const e=31&t;return e===4?10:e===2?4:e===8?5:e===16?2:0}function Cg(t,e,s,i){const r=4*Bs()*(Math.abs(e.vmin)+Math.abs(e.vmax)),n=Bs();if(t.getMaxDerivative()===1){F(s>0);const c=$ie(t,0,e,Bs(),r);return i[0]=c.root,c.cRoots}let o,a=[];const l=new de(e.vmin-r,e.vmax+r);a.push(new M(l.vmin,l.vmax));let u=0;for(let c=t.getMaxDerivative()-1;c>=0;c--){o=a,a=[];for(let h=0,m=o.length;h<m;h++){if(o[h][0]<o[h][1]){let f,g,v;if(c===t.getMaxDerivative()-1?{root:f,funcAtRoot:g,cRoots:v}=$ie(t,c,de.construct(o[h][0],o[h][1]),n,.5*r):{root:f,funcAtRoot:g,cRoots:v}=FKe(t,c,de.construct(o[h][0],o[h][1]),n,.5*r),v===1){if(c===0)u<s&&(o[h][0]<=e.vmin&&o[h][1]>=e.vmin&&f!==e.vmin&&t.getValue(0,e.vmin)===0&&(f=e.vmin),o[h][0]<=e.vmax&&o[h][1]>=e.vmax&&f!==e.vmax&&t.getValue(0,e.vmax)===0&&(f=e.vmax),i[u]=e.snapClip(f),u>0?i[u]-i[u-1]>r&&u++:u++);else{const b=M.getNAN();b[0]=o[h][0],b[1]=f,a.push(b);const w=M.getNAN();w[0]=f,w[1]=o[h][1],a.push(w)}continue}}a.push(o[h])}}return u}function $Ke(t,e,s,i){const r=new le,n=rC(new le(t),new le(e),s,r);return i[0]=r.value(),n}function e0(t,e,s,i,r,n){const o=ne(le,2),a=xa(new le(t),new le(e),new le(s),i,r,o);return n[0]=o[0].value(),n[1]=o[1].value(),a}function r1e(t,e,s,i,r,n,o){const a=ne(le,3),l=Q3(new le(t),new le(e),new le(s),new le(i),r,n,a);return o[0]=a[0].value(),o[1]=a[1].value(),o[2]=a[2].value(),l}function Die(t,e,s,i,r,n,o,a){return kKe(t,e,s,i,r,n,o,a)}function RKe(t,e,s,i,r,n){return OKe(t,e,s,i,r,n)}function kKe(t,e,s,i,r,n,o,a){const l=Me(s*s,Number.NaN);l.fill(0),$s(a,i,0,0,s);const u=Me(s,Number.NaN),c=Me(s,Number.NaN),h=Me(s,Number.NaN);let m=t(a,s,e);const f=100;let g=0;for(g=0;g<f;g++){const v=m;for(let T=0;T<s;++T)c[T]=a[T];if(g%s==0){l.fill(0);for(let T=0;T<s;T++)l[T*s+T]=1}let b=0,w=0;for(let T=0;T<s;++T){for(let A=0;A<s;++A)u[A]=l[T*s+A];const P=m;m=Rie(t,e,a,u,r,n,s);const I=P-m;I>b&&(w=T,b=I)}for(let T=0;T<s;T++)u[T]=a[T]-c[T],h[T]=a[T]+(a[T]-c[T]);const S=t(h,s,e);if(S<v&&2*(v-2*m+S)*Pt(v-m-b)<Pt(v-S)*b){m=Rie(t,e,a,u,r,n,s);for(let T=0;T<s;++T)l[w*s+T]=l[(s-1)*s+T],l[(s-1)*s+T]=u[T]}if(v<=m)return t(a,s,e)}return m}function $ie(t,e,s,i,r){const n={root:0,funcAtRoot:0,cRoots:0};let o=s.vmin,a=s.vmax,l=0,u=Number.MAX_VALUE,c=t.getValue(e,o),h=t.getValue(e,a),m=0,f=0,g=0;if(c>=0&&h>=0||c<=0&&h<=0)return Math.abs(c)<Math.abs(h)?(n.funcAtRoot=c,n.root=o,n.cRoots=c===0?1:0,n):(n.funcAtRoot=h,n.root=a,n.cRoots=h===0?1:0,n);Math.abs(c)<Math.abs(h)&&(a=be(o,o=a),h=be(c,c=h)),l=o,m=c;let v=!0,b=0;for(;h!==0&&Math.abs(o-a)>i*Math.abs(a)+r;b++){let w=b>64;if(!w){f=c!==m&&h!==m?o*h*m/((c-h)*(c-m))+a*c*m/((h-c)*(h-m))+l*c*h/((m-c)*(m-h)):a-h*(a-o)/(h-c);const S=(3*o+a)/4;if(w=!(f>S&&f<a||f>a&&f<S),!w){const T=i*Math.abs(a)+r;if(v){const P=Math.abs(a-l);w=Math.abs(f-a)>=.5*P||P<T}else{const P=Math.abs(l-u);w=Math.abs(f-a)>=.5*P||P<T}}}if(w?(f=(o+a)/2,v=!0):v=!1,g=t.getValue(e,f),g===0)return n.root=f,n.funcAtRoot=g,n.cRoots=1,n;if(!w){const S=o-f,T=f-a;if(Math.abs(S)>10*Math.abs(T)){let P=a+3*T;for(let I=0;I<2;I++){const A=t.getValue(e,P);di(c)*di(A)>0?(o=P,c=A):P=zt(o,a,.75)}}else if(Math.abs(T)>10*Math.abs(S)){let P=o-3*S;for(let I=0;I<2;++I){const A=t.getValue(e,P);di(h)*di(A)>0?(a=P,h=A):P=zt(o,a,.25)}}}u=l,l=a,m=h,di(c)*di(g)<0?(a=f,h=g):(o=f,c=g),Math.abs(c)<Math.abs(h)&&(a=be(o,o=a),h=be(c,c=h)),b===128&&Ce("Root_finder iterations exceeded")}return n.root=a,n.funcAtRoot=h,n.cRoots=1,n}function FKe(t,e,s,i,r){const n={root:0,funcAtRoot:0,cRoots:0};let o=s.vmin,a=t.getValue(e,o),l=s.vmax,u=t.getValue(e,l);if(a>=0&&u>=0||a<=0&&u<=0)return Math.abs(a)<Math.abs(u)?(n.funcAtRoot=a,n.root=o,n.cRoots=a===0?1:0,n):(n.funcAtRoot=u,n.root=l,n.cRoots=u===0?1:0,n);u<0&&(u=be(a,a=u),l=be(o,o=l));let c=.5*(o+l),h=Math.abs(l-o),m=h,f=t.getValue(e,c),g=t.getValue(e+1,c);const v=1,b=4;let w=b;const S=2;let T=1,P=0,I=0,A=v;const D=32;let k=0;for(;++k<100;){let R;k>D||g===0||A===S&&P>1||A===v&&w<b?(A=v,T>1&&T--):(A=S,I>1&&Math.abs(2*f)>Math.abs(h*g)&&T++),h=m;let O=!1;if(A===v)do{if(I>2){const U=16*Math.abs(h);if(.5*Math.abs(o-l)>U){const V=Math.min(o,l),B=Math.max(o,l);if(c===V){R=c,c=V+U,m=c-R;break}if(c===B){R=c,c=B-U,m=c-R;break}}}m=.5*(l-o),R=c,c=o+m,O=o===c||l===c}while(!1);else for(;;){m=T*f/g,R=c,c-=m,O=c===R;const U=Math.min(o,l),V=Math.max(o,l);if(c<U){if(T>1){c=R,T--;continue}m=R-U,c=U}else if(c>V){if(T>1){c=R,T--;continue}m=R-V,c=V}break}if(O||Math.abs(m)<r){R!==c&&(f=t.getValue(e,c));break}f=t.getValue(e,c),g=t.getValue(e+1,c);const z=o,q=l;f<0?(a=f,o=c):(u=f,l=c),A===S&&(o===z&&l===q||I>1&&Math.abs(m)>=.5001*Math.abs(h))?P++:P=0,A===v?(w++,I=0):(w=0,I++)}return k===100&&Ce("Root_finder iterations exceeded"),n.root=c,n.funcAtRoot=f,n.cRoots=1,n}function Rie(t,e,s,i,r,n,o){const a=i.slice(0,o);let l=0;for(let w=0;w<o;w++)l+=i[w]*i[w];if(l=Math.sqrt(l),l>0)for(let w=0;w<o;w++)a[w]/=l;let u=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY;{const w=Me(o,0);for(let S=0;S<o;S++)w[S]=S;w.sort((S,T)=>{const P=Math.abs(a[S]),I=Math.abs(a[T]);return P<I?-1:P>I?1:0});for(let S=0;S<o;S++){const T=w[S];if(a[T]===0)continue;let P=(r[T]-s[T])/a[T],I=(n[T]-s[T])/a[T];I<P&&(I=be(P,P=I)),P>u&&(u=P),I<c&&(c=I)}}let h=0;const m=(Math.abs(u)+Math.abs(c))*Bs()*100,f=Me(o,Number.NaN),g=a.slice();function v(w,S){for(let T=0,P=o;T<P;T++)f[T]=s[T]+w*g[T];return t(f,o,e)}m>0&&(h=RKe(v,null,u,0,c,m));const b=v(h);for(let w=0,S=o;w<S;w++)s[w]=ys(f[w],r[w],n[w]);return b}function OKe(t,e,s,i,r,n){const o=V8();let a=i,l=t(a,e),u=s,c=r,h=t(u,e),m=t(c,e);l>h&&(l=h,a=u),l>m&&(l=m,a=c);let f=u,g=c,v=h,b=m;v>b&&(v=be(b,b=v),g=be(f,f=g));let w=a-f,S=f-g;const T=.5*Math.min(n,c-u),P=2*T,I=100;let A,D=0;for(A=0;A<I&&!(c-u<=P);++A){const k=u+.5*(c-u);let R=D>0;if(!R&&Math.abs(S)<=T&&(R=!0,D=3),!R){const q=a-f,U=a-g,V=q*(l-b);let B=U*(l-v),H=U*B-q*V;B=2*(B-V),B>0&&(H=-H),B=Math.abs(B),B===0||Math.abs(H)>=Math.abs(B*S/2)||H<=B*(u-a)||H>=B*(c-a)?(R=!0,D=3):(S=w,w=H/B)}R&&(S=a>=k?u-a:c-a,w=o*S,D--);let O=a+w;O<u+T?O=u+T:O>c-T&&(O=c-T);const z=t(O,e);z<l?(O>=a?(u=a,h=l):(c=a,m=l),g=f,f=a,a=O,b=v,v=l,l=z):(O<a?(u=O,h=z):(c=O,m=z),z<=v||f===a?(g=f,f=O,b=v,v=z):(z<=b||g===a||g===f)&&(g=O,b=z))}return a}function rC(t,e,s,i){return t.isZero()?e.isZero()?-1:0:(i.setE(e.clone().negateThis().divThisE(t)),s.containsCoordinate(i.value())?1:0)}function xa(t,e,s,i,r,n){if(t.value()===0)return r?(n[0].set(1),i.containsCoordinate(n[0].value())?1:0):rC(e,s,i,n[0]);if(r){let f=2;return n[0].set(1),n[1].setE(s).divThisE(t),n[1].eq(n[0])&&(n[1].set(1),f=1),i.containsCoordinate(n[1].value())||(f=1),i.containsCoordinate(n[0].value())||(f--,n[0].setE(n[1])),f===2&&n[0].value()>n[1].value()&&(n[1]=be(n[0],n[0]=n[1])),f}const o=e.clone().sqrThis().subThisE(t.clone().mulThisE(s).mulThisE(aJe));if(o.lt(bx))return 0;const a=new le(e.value()>=0?1:-1),l=o.clone().sqrtThis(),u=new le(-.5).mulThisE(e.clone().addThisE(a.clone().mulThisE(l)));let c=0;n[0].setE(u.divE(t));const h=new le(n[0].value()),m=new le(t.value()).mulE(h).addE(new le(e.value()).mulE(h).addE(new le(s.value())));return m.isZero()||kie(n[0],t,e,s,n[0]),i.containsCoordinate(n[0].value())&&c++,l.value()!==0&&u.value()!==0&&(n[c].assign(s.divE(u)),h.set(n[c].value()),m.assign(new le(t.value()).mulE(h).addE(new le(e.value()).mulE(h).addE(new le(s.value())))),m.isZero()||kie(n[c],t,e,s,n[c]),i.containsCoordinate(n[c].value())&&c++,c===2&&n[0].value()>n[1].value()&&(n[1]=be(n[0],n[0]=n[1]))),c}function Q3(t,e,s,i,r,n,o){if(t.value()===0)return xa(e,s,i,r,n,o);if(n){let a=1;o[0].set(1);const l=o.slice(a),u=xa(t,e.addE(t),i.negate(),r,!1,l);if(u>0){a+=u;for(let h=1;h<a;h++)o[h].eq(Dd)&&(o[a-1]=be(o[h],o[h]=o[a-1]),a--)}const c=o.slice(0,a);c.sort((h,m)=>h.value()<m.value()?-1:h.value()>m.value()?1:0);for(let h=0;h<a;++h)o[h]=c[h];return a}return GKe(t,e,s,i,r,o)}function n1e(t,e,s,i,r,n){return(n<e||e<0)&&ee("nth_degree_real_roots"),zKe(t,e,s,i,r)}function Z8(t,e,s,i){return{coef0:t.clone(),coef1:e.clone(),coef2:s.clone(),coef3:i.clone(),calcF(r){return this.coef0.clone().mulThis(r).addThisE(this.coef1).mulThis(r).addThisE(this.coef2).mulThis(r).addThisE(this.coef3)},calcDF(r){return this.coef0.clone().mulThis(3).mulThis(r).addThisE(this.coef1.clone().mulThisByPower2(2)).mulThis(r).addThisE(this.coef2)},estimateError(r){const n=Math.abs(r),o=((this.coef0.eps()*n+this.coef1.eps())*n+this.coef2.eps())*n+this.coef3.eps()+this.calcF(r).eps(),a=this.coef0.clone().mulThis(r).mulThis(3).addThisE(this.coef1.clone().mulThis(2)).mulThis(r).addThisE(this.coef2);if(a.isZero()){const l=this.coef0.clone().mulThis(r).mulThis(6).addThisE(this.coef1.clone().mulThis(2));if(l.isZero()){const u=this.coef0.clone().mulThis(6);return Math.pow(6*o/Math.abs(u.value()),1/3)}return Math.sqrt(2*o/Math.abs(l.value()))}return o/Math.abs(a.value())}}}let LKe=class{updateCoefs(e){if(this.lastDeriv1===e)return this.curCoefs=this.derivCoefs1,void(this.lastUsed=1);if(this.lastDeriv2===e)return this.curCoefs=this.derivCoefs2,void(this.lastUsed=2);let s;this.lastUsed===1?(s=this.derivCoefs2,this.lastDeriv2=e,this.lastUsed=2):(s=this.derivCoefs1,this.lastDeriv1=e,this.lastUsed=1),s.length=0;for(let i=0,r=this.truePower-e;i<=r;++i){s.push(this.coefs[i+e].clone());let n=i+e,o=n--;for(let a=1;a<e;a++)o*=n--;s[i].mulThis(o)}this.curCoefs=s}constructor(e,s,i,r){this.derivCoefs1=[],this.derivCoefs2=[],this.lastDeriv1=-1,this.lastDeriv2=-1,this.lastUsed=-1,this.curCoefs=null,this.coefs=e,this.power=s,this.truePower=0;for(let n=s;n>=1;n--)if(this.coefs[n].value()!==0){this.truePower=n;break}}getMaxDerivative(){return this.truePower+1}getValue(e,s){let i=this.coefs;e===0?i=this.coefs:(this.updateCoefs(e),i=this.curCoefs);const r=new Fr(0);let n=1;for(let o=0,a=this.truePower-e;o<=a;++o)r.pe(n*i[o].value()),n*=s;return r.getResult()}getError(e){const s=Math.abs(e),i=new Fr(0),r=new le(1),n=new le(0);for(let a=0,l=this.power;a<=l;++a)n.addThisE(this.coefs[a].mulE(r)),i.pe(r.value()*this.coefs[a].eps()),r.mulThis(s);i.pe(n.eps());let o=1;for(let a=1;a<=this.truePower;++a){o*=a,this.updateCoefs(a);const l=new le(1),u=new le(0);for(let c=0,h=this.truePower-a;c<=h;++c)u.addThisE(this.curCoefs[c].mulE(l)),l.mulThis(e);if(!u.isZero())return Math.pow(o*i.getResult()/Math.abs(u.value()),1/a)}return 0}};function o1e(t,e,s,i,r,n){let o=t,a=e,l=a-o;if(!n){let f=i.calcF(t).value(),g=i.calcF(e).value();if((f>0||f>g)&&(a=be(o,o=a),g=be(f,f=g)),f>=0||g<=0)return!1}let u,c=!1,h=s,m=0;for(;m<100;m++){const f=i.calcF(h);if(u=i.calcDF(h),u.isZero())return!1;if(!f.value()||m>3&&f.isZero()){c=!0;break}n||(f.value()<0?o=h:a=h);const g=f.value()/u.value(),v=h-g;n||(v>=o&&v<=a||v>=a&&v<=o)&&Math.abs(g)<=.5*l?(h=v,l=Math.abs(g)):(l=Math.abs(.5*(a-o)),h=.5*(o+a))}return!!c&&(r.set(h,i.estimateError(h)),!0)}function VKe(t,e,s,i,r,n,o,a){return o1e(t,e,s.value(),Z8(i,r,n,o),a,!1)}let qKe=class{constructor(e,s,i){this.coefs=ne(le,3),this.coefs[0].setE(e),this.coefs[1].setE(s),this.coefs[2].setE(i)}calcF(e){const s=new le(e);return this.coefs[0].mulE(s).addE(this.coefs[1]).mulE(s).addE(this.coefs[2])}calcDF(e){const s=new le(e);return le.st_mulByPower2(this.coefs[0],2).mulE(s).addE(this.coefs[1])}estimateError(e){const s=Math.abs(e),i=(this.coefs[0].eps()*s+this.coefs[1].eps())*s+this.coefs[2].eps()+this.calcF(e).eps(),r=new le(2).mulE(this.coefs[0]).mul(e).addE(this.coefs[1]);if(r.isZero()){const n=this.coefs[0].value();return Math.sqrt(i/Math.abs(n))}return i/Math.abs(r.value())}};function kie(t,e,s,i,r){return o1e(0,0,t.value(),new qKe(e,s,i),r,!0)}function GKe(t,e,s,i,r,n){const o=ne(le,3);let a=0;const l=e.negate().divThisE(t.clone().mulThis(3));r.containsCoordinate(l.value())&&(o[0].setE(l),a=1);const u=ne(le,2),c=xa(t.mul(3),e.mul(2),s,r,!1,u);if(c<0)return i.isZero()?-1:0;for(let v=0;v<c;v++)r.containsCoordinate(u[v].value())&&o[a++].setE(u[v]);Qc(o,0,a,(v,b)=>v.value()<b.value()?-1:v.value()>b.value()?1:0);const h=ne(le,5);h[0].set(r.vmin);for(let v=0;v<a;v++)h[1+v].setE(o[v]);h[1+a].set(r.vmax);const m=a+2;let f=1,g=0;{const v=h[0].clone();if(t.clone().mulThisE(v).addThisE(e).mulThisE(v).addThisE(s).mulThisE(v).addThisE(i).isZero()){const b=Z8(t,e,s,i);v.setError(b.estimateError(v.value())),n[g]=v,g++,f++}}for(let v=f;v<m;v++){const b=h[v].clone(),w=t.clone().mulThisE(b).addThisE(e).mulThisE(b).addThisE(s).mulThisE(b).addThisE(i).isZero();if(w||!h[v].eq(h[v-1])){if(w||VKe(h[v-1].value(),h[v].value(),h[v-1].clone().addThisE(h[v]).divThisByPower2(2),t,e,s,i,b)){if(g>0&&b.eq(n[g-1]))continue;if(g>=3&&Ce("cubic_polynomial_solver_too_many_roots"),w){const S=Z8(t,e,s,i);b.setError(S.estimateError(b.value()))}n[g]=b,g++}if(h[v].value()===r.vmax)break;w&&v++}}return g}function zKe(t,e,s,i,r,n){const o=new LKe(t,e,s,Bs());let a=0;if(o.truePower===2)a=xa(t[2],t[1],t[0],s,i,r);else if(o.truePower===1)a=rC(t[1],t[0],s,r[0]);else{if(o.truePower===0)return t[0].value()?0:-1;{const l=[];l.length=e,a=Cg(o,s,e,l);for(let u=0;u<a;u++)r[u].set(l[u])}}for(let l=0;l<a;l++)r[l].setError(o.getError(r[l].value()));return a}var aM=Es;let t0=class a1e extends EP{constructor(e){e===void 0||oR(e,"vd")?(super({vd:e==null?void 0:e.vd,XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_cp=new M(0,0)):e.from?(super({XStart:e.from.x,YStart:e.from.y,XEnd:e.to.x,YEnd:e.to.y,...e.vd}),this.m_cp=e.cp.clone()):e.points?(super({XStart:e.points[0].x,YStart:e.points[0].y,XEnd:e.points[2].x,YEnd:e.points[2].y,...e.vd}),this.m_cp=e.points[1].clone()):e.copy?(super(e),this.m_cp=e.copy.m_cp.clone()):Ce("unexpected constructor args")}getBoundary(){return Bc(this)}assignCopy(e){return this!==e&&e.copyTo(this),this}construct(e,s,i){this.setStartXY(e),this.m_cp.assign(s),this.setEndXY(i),cM(this)}constructPoints(e){this.setStartXY(e[0]),this.m_cp.assign(e[1]),this.setEndXY(e[2]),cM(this)}getGeometryType(){return G.enumBezier2}queryEnvelope(e){if(e.m_EnvelopeType!==2)yt("env type not impl");else{if(e.setCoords(this.getStartXY()),e.mergeNe(this.getEndXY()),e.contains(this.m_cp))return;const s=Jie(this);if(s!==null){const i=new M;for(const r of s.specialPoints)this.queryCoord2D(r,i),e.mergeNe(i)}else{const i=[];S1e(this,i);const r=new M;for(const n of i)this.queryCoord2D(n,r),e.mergeNe(r)}}}applyTransformation(e){if(e.m_TransformationType===1){const s=ne(M,3);return this.queryControlPoints(s),e.transformPoints2D(s,3,s),this.setStartXY(s[0]),this.m_cp.assign(s[1]),this.setEndXY(s[2]),void this.afterCompletedModification()}F(0)}createInstance(){return new a1e({vd:this.m_description})}calculateLength2D(){return eD(this,1,!1)}calculateLowerLength2D(){return M.distance(this.getStartXY(),this.getEndXY())}calculateUpperLength2D(){return this.calculateUpperLength2D_()}calculateUpperLength2D_(){return M.distance(this.getStartXY(),this.m_cp)+M.distance(this.getEndXY(),this.m_cp)}queryCoord2D(e,s){this.queryCoord2DExtended(e,s,!1)}queryCoord2DExtended(e,s,i){const r=ne(M,3);this.queryControlPoints(r),Vu(r,e,s,i)}queryCoord2DE(e,s){jet(this,e,s)}getCoordX(e){if(e<0||e>1){const s=new M;return this.queryCoord2DExtended(e,s,!0),s.x}if(e<=.5){const s=vn(this.getStartX(),this.m_cp.x,e),i=vn(this.m_cp.x,this.getEndX(),e);return vn(s,i,e)}{const s=kr(this.getStartX(),this.m_cp.x,e),i=kr(this.m_cp.x,this.getEndX(),e);return kr(s,i,e)}}getCoordY(e){if(e<0||e>1){const s=new M;return this.queryCoord2DExtended(e,s,!0),s.y}if(e<=.5){const s=vn(this.getStartX(),this.m_cp.x,e),i=vn(this.m_cp.x,this.getEndX(),e);return vn(s,i,e)}{const s=kr(this.getStartY(),this.m_cp.y,e),i=kr(this.m_cp.y,this.getEndY(),e);return kr(s,i,e)}}cut(e,s,i){const r=new ut;return this.queryCut(e,s,r,i),r.releaseSegment()}queryCut(e,s,i,r){const n=i.createQuadraticBezier();if(this.cutBezierIgnoreAttributes(e,s,n),r)return;n.assignVertexDescription(this.m_description);const o=this.m_description.getAttributeCount();if(o>1){for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=aM.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(e,l,c);n.setStartAttribute(l,c,h)}}for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=aM.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(s,l,c);n.setEndAttribute(l,c,h)}}}}queryDerivative(e,s){Yet(this,e,s)}cutBezierIgnoreAttributes(e,s,i){if((e<0||s>1||e>s)&&ee("Quadratic_bezier.cut_bezier_ignore_attributes"),e===0&&s===1)return i.setStartXY(this.getStartXY()),i.m_cp.assign(this.m_cp),void i.setEndXY(this.getEndXY());const r=ne(M,3);this.queryControlPoints(r),dC(r,e,s,r),i.constructPoints(r)}splitBezierIgnoreAttributes(e,s,i){F(0)}getAttributeAsDbl(e,s,i){if(s===0)return i===0?this.getCoordX(e):this.getCoordY(e);const r=this.calculateLength2D(),n=r>0?this.tToLength(e)/r:0,o=aM.getInterpolation(s),a=this.getStartAttributeAsDbl(s,i),l=this.getEndAttributeAsDbl(s,i);return _P(o,a,l,n,aM.getDefaultValue(s))}getClosestCoordinate(e,s){return tD(this,e,de.unit(),s)}getClosestCoordinateOnInterval(e,s,i=-1){return tD(this,e,s,!1)}getYMonotonicParts(e,s){return this.getMonotonicParts(e,s)}getMonotonicParts(e,s){e.length<2&&ee("");const i=cG(this);let r=0;if(i.specialPointsCount()===2)return 0;F(e.length>=i.specialPointsCount()-1);for(let n=1,o=i.specialPointsCount();n<o;++n)this.queryCut(i.specialPoints[n-1],i.specialPoints[n],e[r],s),r++;for(let n=0;n<r;++n)hG(e[n].get());return r}intersectionWithAxis2D(e,s,i,r){const n=ne(le,3),o=ne(le,2),a=new de(0,1);let l=0;if(e){if(n[0]=new le(this.getStartY()).sub(s),n[1]=new le(this.m_cp.y).subE(new le(this.getStartY())).mulThisByPower2(2),n[2]=new le(this.getStartY()).add(this.getEndY()).subE(new le(this.m_cp.y).mulThisByPower2(2)),l=xa(n[2],n[1],n[0],a,!1,o),i)for(let u=0;u<l;u++)i[u]=this.getCoordX(o[u].value())}else if(n[0]=new le(this.getStartX()).sub(s),n[1]=new le(this.m_cp.x).subE(new le(this.getStartX())).mulThisByPower2(2),n[2]=new le(this.getStartX()).add(this.getEndX()).subE(new le(this.m_cp.x).mulThisByPower2(2)),l=xa(n[2],n[1],n[0],a,!1,o),i)for(let u=0;u<l;u++)i[u]=this.getCoordY(o[u].value());if(r)for(let u=0;u<l;u++)r[u]=o[u].value();else i&&L8(i,l);return l}intersectionOfYMonotonicWithAxisX(e,s){if(this.m_YStart===this.m_YEnd)return e===this.m_YStart?s:Number.NaN;if(e===this.m_YStart)return this.m_XStart;if(e===this.m_YEnd)return this.m_XEnd;const i=[0,0],r=this.intersectionWithAxis2D(!0,e,i,null);return F(r!==2),r===-1?s:i[0]}isCurve(){return!0}isLine(){return!1}isDegenerate(e){return mR(this,e)}isDegenerate3D(e,s){return F(0),!1}queryLooseEnvelope(e){if(e.m_EnvelopeType===2)return e.setCoords(this.getStartXY()),e.mergeNe(this.m_cp),void e.mergeNe(this.getEndXY());F(0)}clone(e){const s=this.createInstance();return this.copyTo(s),s}queryInterval(e,s){if(e===0){const i=new X;this.queryEnvelope(i);const r=new de;return s===0?i.queryIntervalX(r):i.queryIntervalY(r),r}return super.queryInterval(e,s)}queryLooseEnvelopeOnInterval(e,s){const i=ne(M,4);this.queryControlPoints(i),dC(i,e.vmin,e.vmax,i),s.setFromPoints(i,4)}changeEndPoints2D(e,s){if(e.isEqual(this.m_XStart,this.m_YStart)&&s.isEqual(this.m_XEnd,this.m_YEnd))return;const i=this.m_cp.isEqual(this.m_XStart,this.m_YStart),r=this.m_cp.isEqual(this.m_XEnd,this.m_YEnd);this.setStartXY(e),this.setEndXY(s),i?this.m_cp.setCoordsPoint2D(e):r&&this.m_cp.setCoordsPoint2D(s),this.normalizeAfterEndpointChange()}tToLength(e){return eD(this,e,!0)}lengthToT(e){return Ret(this,e)}calculateWeightedAreaCentroid2D(e){const s=ne(M,3);zet(this,s);const i=s[2],r=s[1],n=new M,o=i.y*r.x-i.x*r.y;n.x=-(4*i.x+5*r.x)*o/60,n.y=-(4*i.y+5*r.y)*o/60;const a=Qie(this);return n.x+=(s[0].x-e.x)*a,n.y+=(s[0].y-e.y)*a,n}calculateWeightedCentroid2D(){const e=new M;return this.isDegenerate(0)?(e.setCoords(0,0),e):ket(this)?(e.assign(this.getCoord2D(.5).mul(this.calculateLength2D())),e):(e.assign(Let(this,1)),e)}getControlPoint1(){return this.m_cp.clone()}setControlPoint1(e){this.m_cp.setCoordsPoint2D(e),this.afterCompletedModification()}queryControlPoints(e){e[0].assign(this.getStartXY()),e[1].assign(this.m_cp),e[2].assign(this.getEndXY())}setControlPoints(e){for(let s=0;s<3;s++)e[s].isNAN()&&ee("NaN control points in bezier are not supported");this.m_XStart=e[0].x,this.m_YStart=e[0].y,this.m_cp.setCoordsPoint2D(e[1]),this.m_XEnd=e[2].x,this.m_YEnd=e[2].y,this.afterCompletedModification()}getTangent(e){const s=ys(e,0,1);let i=h2(this,1,s);return i.isZero()&&(i=h2(this,2,s),s===1&&i.negateThis()),i}getDerivative(e){return h2(this,1,ys(e,0,1))}getCurvature(e){const s=h2(this,1,e),i=h2(this,2,e),r=s.sqrLength();return r===0?Number.NaN:(s.divThis(Math.sqrt(r)),s.crossProduct(i)/r)}isIntersecting(e,s,i){return Cx(!1,this,e,s,i)!==0}isIntersectingPoint(e,s,i){if(i&&(e.isEqualPoint2D(this.getStartXY())||e.isEqualPoint2D(this.getEndXY())))return!1;const r=new X;if(this.queryLooseEnvelope(r),r.inflateCoords(s,s),!r.contains(e))return!1;const n=this.getClosestCoordinate(e,!1),o=new M;return this.queryCoord2D(n,o),M.distance(o,e)<=s}isIntersectingPoint3D(e,s,i,r,n=1){return F(0),!1}isMonotoneQuickAndDirty(){return!1}getMonotonicPartParams(e,s){const i=cG(this),r=i.specialPointsCount();if(!s)return i.specialPointsCount();e<r&&ee("");for(let n=0;n<r;n++)s[n]=i.specialPoints[n];return r}normalizeAfterEndpointChange(){return!1}orientBottomUp(){if(this.m_YEnd<this.m_YStart||this.m_YEnd===this.m_YStart&&this.m_XEnd<this.m_XStart){be(this.m_XStart,this.m_XStart=this.m_XEnd),be(this.m_YStart,this.m_YStart=this.m_YEnd);for(let e=0,s=this.m_description.getTotalComponentCount()-2;e<s;e++)this.m_attributes[e+s]=be(this.m_attributes[e],this.m_attributes[e]=this.m_attributes[e+s]);this.m_cachedValues=null}}isDegenerateToLineHelper(e){const s=[e];if(!I9(this,s))return!1;const i=this.getEndXY().sub(this.getStartXY()),r=i.length(),n=this.getControlPoint1();return n.sub(this.getStartXY()),!(Math.abs(n.crossProduct(i))/r>s[0])}copyIgnoreAttributes(e){const s=ne(M,3);this.queryControlPoints(s),e.setControlPoints(s)}calculateArea2DHelper(){return Qie(this)}absNorm(){return qet(this)}queryEnvelopeW(e,s){const i=ne(M,3);this.queryControlPoints(i),mC(i,e,s)}setSegmentFromCoords(e,s){this.construct(e[0],this.getControlPoint1(),e[s-1])}snapControlPoints(e){return Zet(this,e)}writeInBufferStream(e,s){const i=new Float64Array(2);return i[0]=this.m_cp.x,i[1]=this.m_cp.y,e.writeRangeFromArray(s,i.length,i,!0,1),s+i.length}readFromBufferStream(e,s){const i=new Float64Array(2);e.queryRange(s,i.length,i,!0,1),this.m_cp.x=i[0],this.m_cp.y=i[1],this.m_cachedValues=null}needsSnapControlPoints(e){return Qet(this,e)}calculateSpecialPointsForCracking(e,s){return 0}ensureXYMonotone(){return hG(this)}setCoordsForIntersector(e,s,i){Vet(this,e,s,i)}copyToImpl(e){const s=e;s.m_cp.setCoordsPoint2D(this.m_cp),P1e(s,Jie(this))}reverseImpl(){}equalsImplTol(e,s){const i=e;return!!this.m_cp.isEqualPoint2D(i.m_cp,s)}equalsImpl(e){const s=e;return!!this.m_cp.equals(s.m_cp)}swapImpl(e){const s=e;s.m_cp=be(this.m_cp,this.m_cp=s.m_cp),Det(this,s)}afterCompletedModification(){cM(this)}intersect(e,s,i,r,n){return C0(!1,this,e,s,i,r,n)}intersectPoint(e,s,i){return Fet(this,e,s.length,s,i)}endPointModified(){cM(this)}clearEndPointModified(){}};t0.type=G.enumBezier2;var lM=Es;let Oo=class l1e extends EP{constructor(e){return e===void 0||oR(e,"vd")?(super({vd:e==null?void 0:e.vd,XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_cp=new M(0,0),void(this.m_weights=[1,0,1])):(e.fromPoint&&e.weight?e={fromPoint:e.fromPoint,controlPoint1:e.controlPoint1,toPoint:e.toPoint,weight0:1,weight1:e.weight,weight2:1}:e.points&&e.weight?e={fromPoint:e.points[0],controlPoint1:e.points[1],toPoint:e.points[2],weight0:1,weight1:e.weight,weight2:1}:e.points&&e.weights&&(e={fromPoint:e.points[0],controlPoint1:e.points[1],toPoint:e.points[2],weight0:e.weights[0],weight1:e.weights[1],weight2:e.weights[2]}),e.fromPoint&&e.weight0?(super({start:e.fromPoint,end:e.toPoint}),(e.weight0<=0||e.weight1<0||e.weight2<=0)&&ee("weights"),this.m_cp=e.controlPoint1.clone(),void(this.m_weights=[e.weight0,e.weight1,e.weight2])):e.copy?(super(e),this.m_cp=e.copy.m_cp.clone(),void(this.m_weights=e.copy.m_weights.slice())):e.move?(super(e),this.m_cp=e.move.m_cp.clone(),void(this.m_weights=e.move.m_weights.slice())):void yt("unexpected constructor param"))}getBoundary(){return Bc(this)}assignMove(e){return this}assignCopy(e){return e.copyTo(this),this}construct(e,s,i,r){this.dropAllAttributes(),this.setCpsAndWeights(e,s,i,1,r,1),c2(this)}constructWeights(e,s,i,r,n,o){this.dropAllAttributes(),this.setCpsAndWeights(e,s,i,r,n,o),c2(this)}constructArray(e,s){this.construct(e[0],e[1],e[2],s)}constructArrayWeights(e,s){this.dropAllAttributes(),this.setCpsAndWeightsArray(e,s),c2(this)}convertToStandardForm(){}getStandardFormWeight(){return this.m_weights[1]/Math.sqrt(this.m_weights[0]*this.m_weights[2])}getGeometryType(){return G.enumRationalBezier2}queryEnvelope(e){if(e instanceof X){if(e.setCoords(this.getStartXY()),e.mergeNe(this.getEndXY()),e.contains(this.m_cp))return;const s=Bie(this);if(s!==null){const i=new M;for(const r of s.specialPoints)this.queryCoord2D(r,i),e.mergeNe(i)}else{const i=[],r=ne(M,3);this.queryControlPoints(r),y1e(r,this.m_weights,i);const n=new M;for(const o of i)this.queryCoord2D(o,n),e.mergeNe(n)}}}applyTransformation(e){if(e instanceof Rt){const s=ne(M,3);return this.queryControlPoints(s),e.transformPoints2D(s,3,s),this.setStartXY(s[0]),this.m_cp.assign(s[1]),this.setEndXY(s[2]),void this.afterCompletedModification()}}createInstance(){return new l1e({vd:this.m_description})}calculateLength2D(){return oC(this,1,!1)}calculateLowerLength2D(){return M.distance(this.getStartXY(),this.getEndXY())}calculateUpperLength2D(){return this.calculateUpperLength2D_()}calculateUpperLength2D_(){return this.m_weights[1]>0?M.distance(this.getStartXY(),this.m_cp)+M.distance(this.getEndXY(),this.m_cp):M.distance(this.getStartXY(),this.getEndXY())}queryCoord2D(e,s){return this.queryCoord2DExtension(e,s,!0)}queryCoord2DE(e,s){Tet(this,e,s)}queryCoord2DExtension(e,s,i){if(i){if(e<0)return void ga(new pt({start:this.getStartXY(),end:this.getStartXY().add(this.getTangent(0).getUnitVector())}),e,s);if(e>1)return void ga(new pt({start:this.getEndXY(),end:this.getEndXY().add(this.getTangent(1).getUnitVector())}),e-1,s)}const r=ne(M,3);this.queryControlPoints(r),bi(r,this.m_weights,e,s)}getCoordX(e){const s=new M;return this.queryCoord2DExtension(e,s,!0),s.x}getCoordY(e){const s=new M;return this.queryCoord2DExtension(e,s,!0),s.y}cut(e,s,i){const r=new ut;return this.queryCut(e,s,r,i),r.releaseSegment()}queryCut(e,s,i,r){const n=i.createQuadraticRationalBezier();if(this.cutBezierIgnoreAttributes(e,s,n),r)return;n.assignVertexDescription(this.m_description);const o=this.m_description.getAttributeCount();if(o>1){for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=lM.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(e,l,c);n.setStartAttribute(l,c,h)}}for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=lM.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(s,l,c);n.setEndAttribute(l,c,h)}}}}queryDerivative(e,s){uet(this,e,s)}cutBezierIgnoreAttributes(e,s,i){(e<0||s>1||e>s)&&ee("Quadratic_rational_bezier.cut_bezier_ignore_attributes");const r=ne(M,3);this.queryControlPoints(r);const n=[0,0,0];ug(r,this.m_weights,e,s,r,n),i.setControlPointsAndWeights(r,n)}splitBezierIgnoreAttributes(e,s,i){}getAttributeAsDbl(e,s,i){if(s===0)return i===0?this.getCoordX(e):this.getCoordY(e);const r=this.calculateLength2D(),n=r>0?this.tToLength(e)/r:0,o=lM.getInterpolation(s),a=this.getStartAttributeAsDbl(s,i),l=this.getEndAttributeAsDbl(s,i);return _P(o,a,l,n,lM.getDefaultValue(s))}getClosestCoordinate(e,s){return K3(this,e,de.unit(),s,-1)}getClosestCoordinateOnInterval(e,s,i=-1){return K3(this,e,s,!1,i)}getYMonotonicParts(e,s){return this.getMonotonicParts(e,s)}getMonotonicParts(e,s){e.length<2&&ee("");const i=nC(this);let r=0;if(i.specialPointsCount()===2)return 0;F(e.length>=i.specialPointsCount()-1);for(let n=1,o=i.specialPointsCount();n<o;++n)this.queryCut(i.specialPoints[n-1],i.specialPoints[n],e[r],s),r++;for(let n=0;n<r;++n)sG(e[n].get());return r}intersectionWithAxis2D(e,s,i,r){i&&(i.length=9),r&&(r.length=9);const n=new Array(3),o=ne(le,2),a=new de(0,1);let l=0;const u=ne(M,3);if(this.queryControlPoints(u),e){if(n[0]=new le(u[0].y).sub(s).mul(this.m_weights[0]),n[1]=new le(u[1].y).sub(s).mul(this.m_weights[1]),n[2]=n[0].subE(n[1].mul(2)).addE(new le(u[2].y).sub(s).mul(this.m_weights[2])),n[1]=n[1].subE(n[0]).mulThisByPower2(2),l=xa(n[2],n[1],n[0],a,!1,o),i)for(let c=0;c<l;c++)i[c]=this.getCoordX(o[c].value())}else if(n[0]=new le(u[0].x).sub(s).mul(this.m_weights[0]),n[1]=new le(u[1].x).sub(s).mul(this.m_weights[1]),n[2]=n[0].subE(n[1].mul(2)).addE(new le(u[2].x).sub(s).mul(this.m_weights[2])),n[1]=n[1].subE(n[0]).mulThisByPower2(2),l=xa(n[2],n[1],n[0],a,!1,o),i)for(let c=0;c<l;c++)i[c]=this.getCoordY(o[c].value());if(r)for(let c=0;c<l;c++)r[c]=o[c].value();else i&&Qc(i,0,l,em);return l}intersectionOfYMonotonicWithAxisX(e,s){if(this.m_YStart===this.m_YEnd)return e===this.m_YStart?s:Number.NaN;if(e===this.m_YStart)return this.m_XStart;if(e===this.m_YEnd)return this.m_XEnd;const i=[Number.NaN,Number.NaN],r=this.intersectionWithAxis2D(!0,e,i,null);return F(r!==2),r===-1?s:i[0]}isCurve(){return!0}isDegenerate(e){return mR(this,e)}isDegenerate3D(e,s){return!1}queryLooseEnvelope(e){if(e instanceof X)return e.setCoords({pt:this.getStartXY()}),e.mergeNe(this.m_cp),void e.mergeNe(this.getEndXY())}clone(e){const s=this.createInstance();return this.copyTo(s),s}queryInterval(e,s){if(e===0){const i=X.constructEmpty();this.queryEnvelope(i);const r=de.constructEmpty();return s===0?i.queryIntervalX(r):i.queryIntervalY(r),r}return super.queryInterval(e,s)}queryLooseEnvelopeOnInterval(e,s){const i=ne(M,3);this.queryControlPoints(i);const r=[0,0,0];ug(i,this.m_weights,e.vmin,e.vmax,i,r),s.setFromPoints(i,3)}changeEndPoints2D(e,s){if(e.isEqual(this.m_XStart,this.m_YStart)&&s.isEqual(this.m_XEnd,this.m_YEnd))return;const i=this.m_cp.isEqual(this.m_XStart,this.m_YStart),r=this.m_cp.isEqual(this.m_XEnd,this.m_YEnd);this.setStartXY(e),this.setEndXY(s),i?this.m_cp.setCoordsPoint2D(e):r&&this.m_cp.setCoordsPoint2D(s),this.normalizeAfterEndpointChange()}tToLength(e){return oC(this,e,!0)}lengthToT(e){return met(this,e)}calculateWeightedAreaCentroid2D(e){const s=fet(this),i=Uie(this);return s.x+=(this.getStartX()-e.x)*i,s.y+=(this.getStartY()-e.y)*i,s}calculateWeightedCentroid2D(){const e=new M;return this.isDegenerate(0)?(e.setCoords(0,0),e):yet(this)?(e.assign(this.getCoord2D(.5).mul(this.calculateLength2D())),e):(e.assign(bet(this,1)),e)}getControlPoint1(){return this.m_cp.clone()}setControlPoint1(e){this.m_cp.setCoordsPoint2D(e),this.afterCompletedModification()}queryWeights(e){for(let s=0;s<3;++s)e[s]=this.m_weights[s]}setWeights(e){}queryControlPoints(e){e[0].assign(this.getStartXY()),e[1].assign(this.m_cp),e[2].assign(this.getEndXY())}setControlPointsAndWeights(e,s){this.setCpsAndWeightsArray(e,s),this.afterCompletedModification()}getTangent(e){const s=ne(M,3);return this.queryControlPoints(s),tG(s,this.m_weights,e)}getDerivative(e){const s=ys(e,0,1),i=ne(M,4);return J3(this,1,s,i),i[1]}getCurvature(e){const s=ne(M,4);J3(this,2,e,s);const i=s[1].sqrLength();return i===0?Number.NaN:(s[1].divThis(Math.sqrt(i)),s[1].crossProduct(s[2])/i)}isIntersecting(e,s,i){return!1}isIntersectingPoint(e,s,i){return!1}isIntersectingPoint3D(e,s,i,r,n=1){return!1}isMonotoneQuickAndDirty(){const e=ne(M,3);return this.queryControlPoints(e),pR(e)}getMonotonicPartParams(e,s){const i=nC(this),r=i.specialPointsCount();if(!s)return i.specialPointsCount();e<r&&ee("");for(let n=0;n<r;n++)s[n]=i.specialPoints[n];return r}normalizeAfterEndpointChange(){return!1}orientBottomUp(){if(this.m_YEnd<this.m_YStart||this.m_YEnd===this.m_YStart&&this.m_XEnd<this.m_XStart){this.m_XEnd=be(this.m_XStart,this.m_XStart=this.m_XEnd),this.m_YEnd=be(this.m_YStart,this.m_YStart=this.m_YEnd),this.m_weights[2]=be(this.m_weights[0],this.m_weights[0]=this.m_weights[2]);for(let e=0,s=this.m_description.getTotalComponentCount()-2;e<s;e++)this.m_attributes[e+s]=be(this.m_attributes[e],this.m_attributes[e]=this.m_attributes[e+s]);this.m_cachedValues=null}}isLine(){return!1}isDegenerateToLineHelper(e){const s=[e];return!!I9(this,s)&&Eet(this,s[0])}copyIgnoreAttributes(e){const s=ne(M,3);this.queryControlPoints(s);const i=[0,0,0];this.queryWeights(i),e.setControlPointsAndWeights(s,i)}calculateArea2DHelper(){return Uie(this)}absNorm(){return this.getStartXY().norm(1)+this.getEndXY().norm(1)+this.m_cp.norm(1)}absNormXYZ(e){return F(0),0}queryEnvelopeW(e,s){b1e(this,e,s)}setSegmentFromCoords(e,s){const i=[0,0,0];this.queryWeights(i),this.constructWeights(e[0],this.getControlPoint1(),e[s-1],i[0],i[1],i[2])}writeInBufferStream(e,s){const i=new Float64Array(5);return i[0]=this.m_cp.x,i[1]=this.m_cp.y,i[2]=this.m_weights[0],i[3]=this.m_weights[1],i[4]=this.m_weights[2],e.writeRangeFromArray(s,i.length,i,!0,1),s+i.length}readFromBufferStream(e,s){const i=new Float64Array(5);e.queryRange(s,i.length,i,!0,1),this.m_cp.x=i[0],this.m_cp.y=i[1],this.m_weights[0]=i[2],this.m_weights[1]=i[3],this.m_weights[2]=i[4],this.m_cachedValues=null}snapControlPoints(e){const s=ne(M,3);this.queryControlPoints(s);const i=M.sqrDistance(s[1],s[0]),r=M.sqrDistance(s[1],s[2]);let n=s[0].clone(),o=i;i>r&&(n=s[2].clone(),o=r);let a=!1;return o<=e&&o!==0&&(a=!0,this.setControlPoint1(n)),a}needsSnapControlPoints(e){if(!e)return!1;const s=ne(M,3);this.queryControlPoints(s);const i=M.sqrDistance(s[1],s[0]),r=M.sqrDistance(s[1],s[2]);s[0].clone();let n=i;return i>r&&(s[2].clone(),n=r),n<=e&&n!==0}calculateSpecialPointsForCracking(e,s){return 0}ensureXYMonotone(){return sG(this)}setCoordsForIntersector(e,s,i){wet(this,e,s,i)}copyToImpl(e){const s=e;s.m_cp.setCoordsPoint2D(this.m_cp),s.m_weights[0]=this.m_weights[0],s.m_weights[1]=this.m_weights[1],s.m_weights[2]=this.m_weights[2],v1e(s,Bie(this))}reverseImpl(){this.m_weights[2]=be(this.m_weights[0],this.m_weights[0]=this.m_weights[2])}equalsImpl(e){const s=e;if(!this.m_cp.equals(s.m_cp))return!1;for(let i=0;i<3;i++)if(this.m_weights[i]!==s.m_weights[i])return!1;return!0}equalsImplTol(e,s){const i=e;if(!this.m_cp.isEqualPoint2D(i.m_cp,s))return!1;const r=ne(M,3);this.queryControlPoints(r);const n=ne(M,3);i.queryControlPoints(n);const o=[i.m_weights[0],i.m_weights[1],i.m_weights[2]];for(let a=0;a<3;a++){const l=new gt;l.setCoordsPoint2DZ(r[a].mul(this.m_weights[a]),this.m_weights[a]);const u=new gt;if(u.setCoordsPoint2DZ(n[a].mul(o[a]),o[a]),!l.isEqual(u,s))return!1}return!0}swapImpl(e){const s=e;s.m_cp=be(this.m_cp,this.m_cp=s.m_cp),s.m_weights=be(this.m_weights,this.m_weights=s.m_weights),iet(this,s)}afterCompletedModification(){c2(this)}intersect(e,s,i,r,n){return C0(!1,this,e,s,i,r,n)}intersectPoint(e,s,i){return vet(this,e,s,i)}endPointModified(){c2(this)}clearEndPointModified(){}setCpsAndWeights(e,s,i,r,n,o){(r<=0||o<=0||n<0)&&ee("weights"),(e.isNAN()||s.isNAN()||i.isNAN())&&ee("NAN control points in bezier are not supported"),this.setStartXY(e),this.m_cp.assign(s),this.m_weights[0]=r,this.m_weights[1]=n,this.m_weights[2]=o,this.setEndXY(i)}setCpsAndWeightsArray(e,s){this.setCpsAndWeights(e[0],e[1],e[2],s[0],s[1],s[2])}};Oo.type=G.enumRationalBezier2;let zs=class DS{static constructPoint2D(e){return new DS(Ae.constructDouble(e.x),Ae.constructDouble(e.y))}constructor(e,s){if(e===void 0)return this.x=new Ae().setNAN(),void(this.y=new Ae().setNAN());this.x=e.clone(),this.y=s.clone()}assignPoint2D(e){return this.x.setDouble(e.x),this.y.setDouble(e.y),this}setCoords(e,s){return this.x.setThis(e),this.y.setThis(s),this}asPoint2D(){return new M(this.x.value(),this.y.value())}crossProduct(e){return this.x.mul(e.y).sub(this.y.mul(e.x))}leftPerpendicularThis(){const e=this.x.clone();this.x=this.y.clone().negate(),this.y=e}clone(){return new DS(this.x,this.y)}dotProduct(e){return this.x.mul(e.x).add(this.y.mul(e.y))}add(e){return new DS(this.x.add(e.x),this.y.add(e.y))}sub(e){return new DS(this.x.sub(e.x),this.y.sub(e.y))}sqrLength(){return this.x.sqr().addThis(this.y.sqr())}mulThis(e){return this.x.mulThis(e),this.y.mulThis(e),this}mul(e){return this.clone().mulThis(e)}},u1e=class{constructor(e){return e.coefsT?(this.m_zeroCtor=e.zeroCtor,this.m_elements=e.coefsT.map(s=>s.clone()),F(this.m_elements.length===e.power+1),void this.updatePower()):e.coef0?(this.m_zeroCtor=e.zeroCtor,void(this.m_elements=[e.coef0.clone()])):e.copy?(this.m_zeroCtor=e.copy.m_zeroCtor,void(this.m_elements=e.copy.m_elements.map(s=>s.clone()))):(this.m_zeroCtor=e.zeroCtor,void(this.m_elements=[new this.m_zeroCtor]))}construct(e,s){return this.m_elements=e.map(i=>i.clone()),this.updatePower(),this}construct0(e){return this.m_elements.length=0,this.m_elements.push(e.clone()),this.updatePower(),this}assignCopy(e){return this.m_elements=e.m_elements.map(s=>s.clone()),this.updatePower(),this}assignMove(e){return this.m_elements=e.m_elements,e.m_elements=[],this.updatePower(),this}power(){return this.m_elements.length-1}addElement(e){this.m_elements.push(e.clone())}fmSubThis(e,s){return F(0),this}addThis(e){const s=Math.min(this.power(),e.power());for(let r=0;r<=s;++r)this.m_elements[r].addThis(e.m_elements[r]);const i=e.power();this.m_elements.length=Math.max(this.power(),e.power())+1;for(let r=s+1;r<=i;++r)this.m_elements[r]=e.m_elements[r];return this.updatePower(),this}add0(e){return this.m_elements[0].addThis(e),this.updatePower(),this}addNumber0(e){return F(0),this}sub(e){const s=Math.min(this.power(),e.power());for(let r=0;r<=s;++r)this.m_elements[r].subThis(e.m_elements[r]);const i=e.power();this.m_elements.length=Math.max(this.power(),e.power())+1;for(let r=s+1;r<=i;++r)this.m_elements[r]=e.m_elements[r].clone(),this.m_elements[r].negateThis();return this.updatePower(),this}sub0(e){return F(0),this}subNumber0(e){return F(0),this}subShifted(e,s){const i=this.power(),r=e.power()+s,n=Math.min(this.power(),r);let o=0;for(let a=s;a<=n;++a)this.m_elements[a].subThis(e.m_elements[o]),o++;if(r<=i)return this.updatePower(),this;this.m_elements.length=r+1;for(let a=i+1;a<this.m_elements.length;++a)this.m_elements[a]=new this.m_zeroCtor;for(let a=n+1;a<=r;++a)this.m_elements[a].subThis(e.m_elements[o++]);return this.updatePower(),this}subShiftedWithCoef(e,s,i){const r=this.power(),n=e.power()+i,o=Math.min(this.power(),n);let a=0;for(let l=i;l<=o;++l)this.m_elements[l].fmSubThis(e.m_elements[a],s),a++;if(n<=r)return this.updatePower(),this;this.m_elements.length=n+1;for(let l=r+1;l<this.m_elements.length;++l)this.m_elements[l]=new this.m_zeroCtor;for(let l=o+1;l<=n;++l)this.m_elements[l].fmSubThis(e.m_elements[a++],s);return this.updatePower(),this}mulThis(e){if(this.constructor===e.constructor){const s=e,i=[];for(let r=0,n=this.power();r<=n;r++)for(let o=0,a=s.power();o<=a;o++){const l=this.m_elements[r].clone();l.mulThis(s.m_elements[o]),r+o<i.length?i[r+o].addThis(l):i.push(l)}this.m_elements=i}else for(let s=0,i=this.power();s<=i;s++)this.m_elements[s].mulThis(e);return this.updatePower(),this}mulElementThis(e){for(let s=0,i=this.power();s<=i;s++)this.m_elements[s].mulThis(e);return this.updatePower(),this}mulNumber0(e){return F(0),this}mulBigint0(e){return F(0),this}mulBigIntThis(e){return F(0),this}mulInt320(e){return F(0),this}div0(e){return F(0),this}absThis(){return F(0),this}div(e,s,i){if(this.power()<e.power())return i.assignCopy(this),void s.setZero();i.setZero(),s.setZero();const r=e.getElement(e.power()),n=this.clone();let o=n.power();const a=n.power()-e.power();let l=a;for(s.m_elements=ne(s.m_zeroCtor,a+1);;){if(o<e.power()){i.assignMove(n);break}if(o===n.power()){const u=n.getElement(n.power());u.divThis(r),n.subShiftedWithCoef(e,u,n.power()-e.power()),s.m_elements[l]=u.clone()}l--,o--}i.updatePower(),s.updatePower()}divThis(e){return F(0),this}subThis(e){const s=Math.min(this.power(),e.power());for(let r=0;r<=s;++r)this.m_elements[r].subThis(e.m_elements[r]);const i=e.power();this.m_elements.length=Math.max(this.power(),e.power())+1;for(let r=s+1;r<=i;++r)this.m_elements[r]=e.m_elements[r].clone(),this.m_elements[r].negateThis();return this.updatePower(),this}sub0This(e){return this.m_elements[0].subThis(e),this.updatePower(),this}subFrom(e,s){F(0)}isZero(){return this.power()===0&&this.m_elements[0].isZero()}negateThis(){for(let e=this.m_elements.length-1;e>=0;e--)this.m_elements[e].negateThis();return this}getElement(e){return this.m_elements[e].clone()}setElement(e,s){return this.m_elements[e]=s.clone(),this}evaluate(e){const s=this.power(),i=this.m_elements[s].clone();for(let r=s-1;r>=0;--r)i.mulThis(e),i.addThis(this.m_elements[r]);return i}equals(e){if(this===e)return!0;if(this.power()!==e.power())return!1;for(let s=this.m_elements.length-1;s>=0;s--)if(!this.m_elements[s].equals(e.m_elements[s]))return!1;return!0}updatePower(){for(let e=this.m_elements.length-1;e>0&&this.m_elements[e].isZero();e--)this.m_elements.pop();return this}setZero(){return this.m_elements.length=1,this.m_elements[0]=new this.m_zeroCtor,this.updatePower(),this}derivative(e){if(this.power()<e)return this.clone().setZero();if(e===0)return this.clone();const s=new this.constructor({coefsT:this.m_elements.slice(e),power:this.power()-e});for(let i=e,r=this.power();i<=r;i++){let n=BigInt(i);for(let o=i-1,a=i-e;o>a;--o)n*=BigInt(o);s.m_elements[i-e].mulBigIntThis(n)}return s.updatePower(),s}derivative1This(){if(this.m_elements.length>1){this.m_elements=this.m_elements.slice(1);for(let e=1,s=this.power();e<=s;e++)this.m_elements[e].mulThis(Ae.constructInt32(e+1))}else this.m_elements.length=0,this.m_elements.push(new this.m_zeroCtor);return this}limitPrecisionThis(e){for(let s=this.power();s>=0;--s)this.m_elements[s].limitPrecisionThis(e);return this.updatePower(),this}hiBitIndex(){return this.m_elements.reduce((e,s)=>{const i=s.hiBitIndex();return e<i?i:e},0)}shiftRight(e){return this.m_elements.splice(0,e),this.updatePower(),this}static evaluateCoefs(e,s,i){const r=e.power();i.construct0(e.getElement(0).evaluate(s));for(let n=1;n<=r;++n)i.addElement(e.getElement(n).evaluate(s));i.updatePower()}},Vt=class c1e extends u1e{constructor(e){super(e===void 0?{zeroCtor:Ae}:{...e,zeroCtor:Ae})}clone(){return new c1e({copy:this})}absEvaluate(e){const s=this.power(),i=this.m_elements[s].clone();i.absThis();const r=e.clone();r.absThis();for(let n=s-1;n>=0;--n)i.mulThis(r),i.addThis(this.m_elements[n].abs());return i}},Mo=class h1e extends u1e{constructor(e){super(e===void 0?{zeroCtor:Vt}:{...e,zeroCtor:Vt})}clone(){return new h1e({copy:this})}constructFromMPValues(e,s){this.m_elements.length=0;for(let i=0;i<=s;++i)this.m_elements.push(new Vt({coef0:e[i]}));return this.updatePower(),this}};function UKe(){return{polypoly1:new Mo,polypoly2:new Mo,polyX2:new Vt,polyY2:new Vt,polyX2Deriv:new Vt,polyY2Deriv:new Vt,polypolyX1:new Mo,polypolyY1:new Mo,polypolyX1Deriv:new Mo,polypolyY1Deriv:new Mo,lazyPolypolyD1:new Mo,lazyPolypolyD1Deriv:new Mo,lazyPolyD2:new Vt,lazyPolyD2Deriv:null,polypoly11:new Mo,polypoly12:new Mo,tempPp:new Mo,tempPp1:new Mo,tempPp2:new Mo,tempP:new Vt,tempP1:new Vt,tempP2:new Vt}}function Ex(t,e,s,i,r,n,o,a,l,u,c,h,m,f,g,v,b,w=!1){const S=UKe();S.polyX2.construct(o,a),S.polyY2.construct(l,u),S.polypolyX1.constructFromMPValues(t,e),S.polypolyY1.constructFromMPValues(s,i),S.polypoly11.assignCopy(S.polypolyX1),S.polypoly12.assignCopy(S.polypolyY1),c&&(S.lazyPolyD2.construct(c,h),S.polypoly11.mulElementThis(S.lazyPolyD2),S.polypoly12.mulElementThis(S.lazyPolyD2)),r?(S.lazyPolypolyD1.constructFromMPValues(r,n),S.lazyPolypolyD1Deriv=new Mo({copy:S.lazyPolypolyD1}),S.lazyPolypolyD1Deriv.derivative1This(),S.tempPp.assignCopy(S.lazyPolypolyD1),S.tempPp.mulElementThis(S.polyX2),S.polypoly11.subThis(S.tempPp),S.tempPp.assignCopy(S.lazyPolypolyD1),S.tempPp.mulElementThis(S.polyY2),S.polypoly12.subThis(S.tempPp)):(S.polypoly11.sub0This(S.polyX2),S.polypoly12.sub0This(S.polyY2)),S.polypolyX1Deriv.assignCopy(S.polypolyX1),S.polypolyX1Deriv.derivative1This(),S.polypolyY1Deriv.assignCopy(S.polypolyY1),S.polypolyY1Deriv.derivative1This(),r&&(S.polypolyX1Deriv.mulThis(S.lazyPolypolyD1),S.tempPp2.assignCopy(S.lazyPolypolyD1Deriv),S.tempPp2.mulThis(S.polypolyX1),S.polypolyX1Deriv.subThis(S.tempPp2),S.polypolyY1Deriv.mulThis(S.lazyPolypolyD1),S.tempPp2.assignCopy(S.lazyPolypolyD1Deriv),S.tempPp2.mulThis(S.polypolyY1),S.polypolyY1Deriv.subThis(S.tempPp2)),S.polyX2Deriv.assignCopy(S.polyX2),S.polyX2Deriv.derivative1This(),S.polyY2Deriv.assignCopy(S.polyY2),S.polyY2Deriv.derivative1This(),c&&(F(S.lazyPolyD2Deriv===null),S.lazyPolyD2Deriv=new Vt({copy:S.lazyPolyD2}),S.lazyPolyD2Deriv.derivative1This(),S.polyX2Deriv.mulThis(S.lazyPolyD2),S.tempP1.assignCopy(S.lazyPolyD2Deriv),S.tempP1.mulThis(S.polyX2),S.polyX2Deriv.subThis(S.tempP1),S.polyY2Deriv.mulThis(S.lazyPolyD2),S.tempP1.assignCopy(S.lazyPolyD2Deriv),S.tempP1.mulThis(S.polyY2),S.polyY2Deriv.subThis(S.tempP1)),S.polypoly1.assignCopy(S.polypoly11),S.polypoly1.mulElementThis(S.polyX2Deriv),S.tempPp.assignCopy(S.polypoly12),S.tempPp.mulElementThis(S.polyY2Deriv),S.polypoly1.addThis(S.tempPp),S.polypoly2.assignCopy(S.polypolyX1Deriv),S.polypoly2.mulElementThis(S.polyY2Deriv),S.tempPp.assignCopy(S.polypolyY1Deriv),S.tempPp.mulElementThis(S.polyX2Deriv),S.polypoly2.subThis(S.tempPp);let T=[];const P=[];b||(b=[]),v||(v=[]),J8(S.polypoly11,S.polypoly12,S.tempP);let I=57,A=.25*Number.EPSILON;const D=[];let k=vf(S.tempP,m,g,A,I,D);if(k<0)return-1;for(let q=0;q<k;q++){Vt.evaluateCoefs(S.polypoly11,Ae.constructDouble(D[q]),S.tempP1);const U=[];let V=vf(S.tempP1,m,f,A,I,U);if(V!==0)if(Vt.evaluateCoefs(S.polypoly12,Ae.constructDouble(D[q]),S.tempP2),V<0){V=vf(S.tempP2,m,f,A,I,U),V<0&&Ce("mp_curve_proximity");for(let B=0;B<V;B++)P.push(Zi(U[B],D[q]))}else{const B=S.tempP2.absEvaluate(Fc);B.mulThis(Ae.constructDouble(1e-12));for(let H=0;H<V;H++){const W=S.tempP2.evaluate(Ae.constructDouble(U[H]));W.absThis(),W.lt(B)&&P.push(Zi(U[H],D[q]))}}}k=P.length,J8(S.polypoly1,S.polypoly2,S.tempP),I=57,A=.25*Number.EPSILON;const R=[];let O=vf(S.tempP,m,g,A,I,R);O<0&&(O=0);for(let q=0;q<O;q++){Vt.evaluateCoefs(S.polypoly1,Ae.constructDouble(R[q]),S.tempP1);const U=[];let V=vf(S.tempP1,m,f,A,I,U);if(V!==0)if(Vt.evaluateCoefs(S.polypoly2,Ae.constructDouble(R[q]),S.tempP2),V<0){if(V=vf(S.tempP2,m,f,A,I,U),V<0)continue;for(let B=0;B<V;B++)T.push(Zi(U[B],R[q]))}else{const B=S.tempP2.absEvaluate(Fc);B.mulThis(Ae.constructDouble(1e-12));for(let H=0;H<V;H++){const W=S.tempP2.evaluate(Ae.constructDouble(U[H]));W.absThis(),W.lt(B)&&T.push(Zi(U[H],R[q]))}}}if(O=T.length,k===0&&O===0)return 0;T=T.concat(P),T.sort((q,U)=>w?em(q.second,U.second):em(q.first,U.first));const z=R0e(T,(q,U)=>q.first===U.first&&q.second===U.second);T=T.slice(0,z),v.length=0,b.length=0;for(const q of T)v.push(q.first),b.push(q.second);return F(v.length===b.length),b.length}function BKe(t,e,s,i,r,n,o){if(t.power()===0)return t.isZero()?-1:0;const a=t.evaluate(Ae.constructInt32(1)).isZero();if(t.power()===1){const l=m1e(t.getElement(1),t.getElement(0),e,n.at(0));return n[0].limitPrecisionThis(i),l!==1?0:(n[0].limitPrecisionThis(i),1)}return t.power()===2?$S(t.getElement(2),t.getElement(1),t.getElement(0),i,e,a,n):t.power()===3?RS(t.getElement(3),t.getElement(2),t.getElement(1),t.getElement(0),i,e,a,n):t.power()===4?d1e(t.getElement(4),t.getElement(3),t.getElement(2),t.getElement(1),t.getElement(0),i,e,a,n):f1e(t,e,s,i,a,r,n,o)}function jKe(){return{polyIntersect:new Vt,polyX1:new Vt,polyY1:new Vt,polyX1Deriv:new Vt,polyY1Deriv:new Vt,lazyPolyD1:new Vt,lazyPolyD1Deriv:new Vt,tempP:new Vt,tempP1:new Vt,tempP2:new Vt,polypoly1Proximity:new Mo,polypoly2Proximity:new Mo}}function $9(t,e,s,i,r,n,o,a,l,u,c){const h=jKe();h.polyX1.construct(t,e),h.polyY1.construct(s,i),h.polyX1Deriv.assignCopy(h.polyX1),h.polyX1Deriv.derivative1This(),h.polyY1Deriv.assignCopy(h.polyY1),h.polyY1Deriv.derivative1This(),h.polyIntersect.assignCopy(h.polyX1),h.polyIntersect.mulThis(h.polyX1),h.polyIntersect.mulElementThis(o[0]),h.tempP.assignCopy(h.polyY1),h.tempP.mulThis(h.polyY1),h.tempP.mulElementThis(o[1]),h.polyIntersect.addThis(h.tempP),r?(h.lazyPolyD1.construct(r,n),h.tempP.assignCopy(h.lazyPolyD1),h.tempP.mulThis(h.lazyPolyD1),h.tempP.mulElementThis(o[2]),h.polyIntersect.addThis(h.tempP)):h.polyIntersect.add0(o[2]);{const P=o[0].clone(),I=P.clone();I.sqrThis();const A=o[1].clone(),D=A.clone();D.sqrThis();const k=o[2].clone(),R=P.clone();R.subThis(A),h.polyX1.construct(t,e),h.polyX1Deriv.assignCopy(h.polyX1),h.polyX1Deriv.derivative1This(),h.polyY1.construct(s,i),h.polyY1Deriv.assignCopy(h.polyY1),h.polyY1Deriv.derivative1This(),h.tempP.assignCopy(h.polyX1),h.tempP.mulThis(h.polyX1),h.tempP.mulElementThis(D),h.tempP.mulElementThis(k),h.polypoly1Proximity.construct0(h.tempP),h.tempP.assignCopy(h.polyX1),h.tempP.mulThis(A.mul(R).mul(k).ldexpThis(1)),h.polypoly1Proximity.addElement(h.tempP),h.tempP.assignCopy(h.polyX1),h.tempP.mulThis(h.polyX1),h.tempP.mulElementThis(P.mul(D)),h.tempP1.assignCopy(h.polyY1),h.tempP1.mulThis(h.polyY1),h.tempP1.mulElementThis(I.mul(A)),h.tempP.addThis(h.tempP1),h.tempP.add0(R.mul(R).mul(k)),h.polypoly1Proximity.addElement(h.tempP),h.tempP.assignCopy(h.polyX1),h.tempP.mulElementThis(R.mul(P).mul(A).ldexpThis(1)),h.polypoly1Proximity.addElement(h.tempP),h.tempP.construct0(P.mul(R).mul(R)),h.polypoly1Proximity.addElement(h.tempP),h.polypoly1Proximity.updatePower(),h.tempP.construct0(zn),h.polypoly2Proximity.construct0(h.tempP),h.tempP.assignCopy(h.polyX1),h.tempP.mulThis(h.polyX1Deriv),h.tempP1.assignCopy(h.polyY1),h.tempP1.mulThis(h.polyY1Deriv),h.tempP.addThis(h.tempP1),h.tempP.mulElementThis(P.mul(A)),h.polypoly2Proximity.addElement(h.tempP),h.tempP.assignCopy(h.polyX1Deriv),h.tempP.mulElementThis(R.mul(P)),h.polypoly2Proximity.addElement(h.tempP),h.polypoly2Proximity.updatePower()}const m=[],f=[];c||(c=[]);let g=2*h.polyIntersect.power()+58;const v=.5*Number.EPSILON,b=vf(h.polyIntersect,a,l,v,g,f);if(b<0)return-1;J8(h.polypoly1Proximity,h.polypoly2Proximity,h.tempP),g=2*h.tempP.power()+58;let w=vf(h.tempP,a,l,v,g,m);if(w<0&&(w=0),b===0&&w===0)return 0;const S=m.concat(f);c.length=S.length,$s(c,S,0,0,S.length),xx(c);const T=R0e(c,(P,I)=>em(P,I)===0);return c.length=T,c.length}function m1e(t,e,s,i){return t.isZero()?e.isZero()?-1:0:(i.setThis(e),i.negateThis(),i.divThis(t),s.isEmpty()||s.containsCoordinate(i.value())?1:0)}function $S(t,e,s,i,r,n,o){if(t.isZero())return n?(o[0].setInt32(1),r.containsCoordinate(1)?1:0):m1e(e,s,r,o[0]);if(n){let f=2;return o[0].setInt32(1),s.equals(t)?(o[1].setInt32(1),f=1):o[1].setThis(s.div(t)),r.containsCoordinate(o[1].value())||(f=1),r.containsCoordinate(o[0].value())||(f--,o[0].setThis(o[1])),f===2&&o[0].value()>o[1].value()&&(o[1]=be(o[0],o[0]=o[1])),f}const a=e.clone();a.sqrThis();const l=t.clone();if(l.mulThis(s).ldexpThis(2).negateThis().addThis(a),l.LZ())return 0;const u=i+2,c=Ae.sqrt(l,u),h=c.clone();e.LZ()&&h.negateThis(),h.addThis(e).limitPrecisionThis(u).ldexpThis(-1).negateThis();let m=0;return o[0].setThis(h).divThis(Ae.constructAssign(t,u)).limitPrecisionThis(i),(r.isEmpty()||r.containsCoordinate(o[0].value()))&&m++,c.isZero()||h.isZero()||(o[m].setThis(s).divThis(h).limitPrecisionThis(i),(r.isEmpty()||r.containsCoordinate(o[m].value()))&&m++,m===2&&o[0].gt(o[1])&&(o[1]=be(o[0],o[0]=o[1]))),m}function RS(t,e,s,i,r,n,o,a){if(t.isZero())return $S(e,s,i,r,n,o,a);const l=(z,q)=>{if(z>0){let U=q+z;for(let V=1;V<U;V++)a[V].equals(a[0])&&(a[U-1]=be(a[V],a[V]=a[U-1]),U--);q=U}return Qc(a,0,q,(U,V)=>U.compare(V)),q};if(i.isZero()){let z=0;return n.containsCoordinate(0)&&(a[0].setInt32(0),z=1),l($S(t,e,s,r,n,o,a.slice(1)),z)}if(o){let z=0;n.containsCoordinate(1)&&(a[0].setInt32(1),z=1);const q=e.add(t),U=i.negate(),V=t.add(q).add(U).isZero();return l($S(t,q,U,r,n,V,a.slice(z)),z)}const u=new Ae,c=new Ae,h=new Ae,m=e.clone();if(m.isZero())c.setThis(s),c.divThis(t),h.setThis(i),c.divThis(t);else{m.divThis(t).divDoubleThis(3).negateThis();const z=e.clone();z.sqrThis();const q=t.clone();q.sqrThis(),c.setThis(t),c.mulThis(s).mulDoubleThis(3).subThis(z).divThis(q).divDoubleThis(3),h.setThis(z),h.mulThis(e),h.ldexpThis(1),u.setThis(t),u.mulThis(e).mulThis(s).mulDoubleThis(9),h.subThis(u),u.setThis(q),u.mulThis(i).mulDoubleThis(27),h.addThis(u),h.divThis(q).divThis(t).divDoubleThis(27)}if(c.isZero()){const z=h.clone();return z.negateThis(),z.isZero()?(a[0].setThis(m),u2(n,r,a,1)):(a[0].setThis(Ae.cubicRoot(h,r).add(m)),u2(n,r,a,1))}const f=h.clone();if(f.sqrThis().ldexpThis(-2),u.setThis(c.clone()),u.sqrThis().mulThis(c).divDoubleThis(27),f.addThis(u),f.isZero())return a[0].setThis(h),a[0].mulDoubleThis(3).divThis(c),a[1].setThis(a[0]),a[1].negateThis(),a[1].ldexpThis(-1),a[0].addThis(m),a[1].addThis(m),u2(n,r,a,2);if(f.GZ())return f.setThis(Ae.sqrt(f,r+8)),u.setThis(h),u.ldexpThis(-1).negateThis(),u.addThis(f),a[0].setThis(Ae.cubicRoot(u,r+8)),u.setThis(h),u.ldexpThis(-1).negateThis(),u.subThis(f),a[0].addThis(Ae.cubicRoot(u,r+8)),a[0].addThis(m),u2(n,r,a,1);u.setThis(c),u.divDoubleThis(3).negateThis(),F(u.GEZ());const g=Ae.sqrt(u,r+8),v=g.clone();v.negateThis(),v.addThis(m),g.addThis(m);const b=Ae.constructDouble(n.isEmpty()?-Number.MAX_VALUE:n.vmin),w=Ae.constructDouble(n.isEmpty()?Number.MAX_VALUE:n.vmax),S=new Vt({zeroCtor:Ae});S.construct0(i),S.addElement(s),S.addElement(e),S.addElement(t);const T=new Vt({copy:S});T.derivative1This();let P=0;const I=ne(Ae,4);I[P++].setThis(b),v.gt(b)&&v.lt(w)&&I[P++].setThis(v),g.gt(b)&&g.lt(w)&&I[P++].setThis(g),I[P++].setThis(w);const A=3*r;let D=52,k=Number.EPSILON;for(;D<A;)2*D<=A?(k*=k,D*=2):(k*=Number.EPSILON,D+=52);D+=2;let R=0,O=!1;for(let z=1;z<P;z++)if(K8(S,T,I[z-1],I[z],k,D,a[0])){R=1,O=z+1<P;break}if(!R)return 0;if(O){const z=new Vt({zeroCtor:Ae,coef0:a[0]});z.negateThis(),z.addElement(Fc);const q=new Vt({zeroCtor:Ae}),U=new Vt({zeroCtor:Ae});S.div(z,q,U),F(q.power()===2),F(U.power()===0);const V=$S(q.getElement(2),q.getElement(1),q.getElement(0),r,n,!1,a.slice(1));F(V>=0&&V<=2),R+=V}return u2(n,r,a,R)}function d1e(t,e,s,i,r,n,o,a,l){if(t.isZero())return RS(e,s,i,r,n,o,a,l);const u=(v,b)=>{if(v>0){let w=b+v;for(let S=1;S<w;S++)l[S].equals(l[0])&&(l[w-1]=be(l[S],l[S]=l[w-1]),w--);b=w}return Qc(l,0,b,(w,S)=>w.compare(S)),b};if(r.isZero()){let v=0;return o.containsCoordinate(0)&&(l[0].setInt32(0),v=1),u(RS(t,e,s,i,n,o,a,l.slice(v)),v)}const c=new Vt({zeroCtor:Ae,coef0:r});if(c.addElement(i),c.addElement(s),c.addElement(e),c.addElement(t),a){let v=0;o.containsCoordinate(1)&&(l[0].setInt32(1),v=1);const b=new Vt({zeroCtor:Ae,coef0:Ae.constructInt32(-1)});b.addElement(Ae.constructInt32(1));const w=new Vt({zeroCtor:Ae}),S=new Vt({zeroCtor:Ae});return c.div(b,w,S),u(RS(w.power()===3?w.getElement(3):zn.clone(),w.power()>=2?w.getElement(2):zn.clone(),w.power()>=1?w.getElement(1):zn.clone(),w.getElement(0),n,o,w.evaluate(Fc).isZero(),l.slice(v)),v)}if(c.getElement(0).isZero()){let v=0;for(o.containsCoordinate(0)&&(v=1,l[0].setDouble(0));c.getElement(0).isZero()&&c.power()>0;)c.shiftRight(1);const b=RS(c.power()===3?c.getElement(3):zn.clone(),c.power()>=2?c.getElement(2):zn.clone(),c.power()>=1?c.getElement(1):zn.clone(),c.getElement(0),n,o,!1,l.slice(v));return b>0&&(v+=b),Qc(l,0,v,(w,S)=>w.compare(S)),v}let h=52,m=Number.EPSILON;for(;h<n;)2*h<=n?(m*=m,h*=2):(m*=Number.EPSILON,h+=52);h+=2;const f=g1e(c),g=Ae.constructDouble(Math.max(Math.abs(o.vmax),Math.abs(o.vmin)));return m=(f.lt(g)?f:g).mul(Ae.constructDouble(m)).toDouble(),f1e(c,o,m,h,a,!1,l,4)}function HKe(t,e){let s=t,i=e;i.power()>s.power()&&(i=be(s,s=i));const r=s.power()-i.power(),n=new Vt({copy:s.getElement(s.power())});s.mulThis(i.getElement(i.power()));for(let o=0,a=s.power();o<a;o++)if(o>=r){const l=new Vt({copy:i.getElement(o-r)});l.mulThis(n);const u=s.getElement(o).sub(l);s.setElement(o,u)}s.setElement(s.power(),s.getElement(s.power()).setZero()),s.updatePower(),Q8(s)}function Q8(t){let e=0;for(;e<t.power()&&t.getElement(e).isZero();)e++;return e>0&&(t.shiftRight(e),!0)}function J8(t,e,s){const i=t.clone(),r=e.clone();for(Q8(i),Q8(r);i.power()!==0||r.power()!==0;)HKe(i,r);s.assignMove(i.getElement(0))}function vf(t,e,s,i,r,n){n.length=0;const o=t.power(),a=ne(Ae,2*o+4),l=BKe(t,s||de.unit(),i,r,!1,a,a.length);if(l>0){n.length=0;for(let u=0;u<l;u++){const c=a[u].value();u>0&&c<=n.at(-1)||n.push(c)}return n.length}return l}function p1e(t,e,s){if(F(s>=1),t.power()===0)return t.isZero()?-1:0;const i=t.getElement(0);return i.negateThis(),i.divThis(t.getElement(1)),e[0].setThis(i),1}function YKe(t,e,s,i){if(t.power()<2)return p1e(t,s,i);F(i>=1);let r=t.getElement(1);r.mulThis(t.getElement(1));const n=t.getElement(0);if(n.mulThis(t.getElement(2)),n.ldexpThis(2),r.subThis(n),r.LZ())return 0;if(r.isZero()){const u=t.getElement(1);return u.negateThis(),u.divThis(t.getElement(2)),u.ldexpThis(-1),u.limitPrecisionThis(e),s[0].setThis(u),1}F(i>=2),r=Ae.sqrt(r,e+8);const o=t.getElement(1);o.negateThis();const a=o.clone();a.subThis(r),a.divThis(t.getElement(2)),a.ldexpThis(-1),a.limitPrecisionThis(e);const l=o.clone();return l.addThis(r),l.divThis(t.getElement(2)),l.ldexpThis(-1),l.limitPrecisionThis(e),a.lt(l)?(s[0].setThis(a),s[1].setThis(l)):(s[1].setThis(a),s[0].setThis(l)),2}function K8(t,e,s,i,r,n,o){let a=s.clone(),l=i.clone();a.limitPrecisionThis(n),l.limitPrecisionThis(n);let u=t.evaluate(a);u.limitPrecisionThis(n+2);let c=t.evaluate(l);if(c.limitPrecisionThis(n+2),u.GEZ()&&c.GEZ()||u.LEZ()&&c.LEZ())return u.absLessAbs(c)?(o=a,u.isZero()):(o=l,c.isZero());const h=c.LZ();h&&(c=be(u,u=c),l=be(a,a=l));const m=h?l:a,f=h?a:l,g=a.add(l).ldexpThis(-1);g.limitPrecisionThis(n);const v=l.sub(a);v.limitPrecisionThis(n),v.absThis();const b=v.clone();let w=t.evaluate(g),S=e.evaluate(g);const T=new Vt({copy:t}),P=new Vt({copy:e});{const ie=Math.max(t.hiBitIndex(),e.hiBitIndex()),se=Fc.clone();se.ldexpThis(-(n+2));for(let Z=64;Z<ie;){T.limitPrecisionThis(Z),P.limitPrecisionThis(Z);const te=T.evaluate(g),ve=P.evaluate(g),ke=te.sub(w),Fe=ve.sub(S);if(ke.divThis(w).absThis().lt(se)&&(S.isZero()||Fe.divThis(S).absThis().lt(se)))break;T.assignCopy(t),P.assignCopy(e),Z=Math.min(Z+64,ie)}w.limitPrecisionThis(n+2),S.limitPrecisionThis(n+2)}const I=1,A=4;let D=A;const k=2;let R=1,O=0,z=0,q=I;const U=32,V=Ae.constructDouble(.25*r),B=Ae.constructDouble(.5001);let H=0;const W=300;for(;++H<W;){if(H>U&&O>0||S.isZero()||q===k&&O>1||q===I&&D<A)q=I,R>1&&R--;else if(q=k,z>1){const ve=v.mul(S);ve.absThis(),ve.ldexpThis(-3),ve.absLessAbs(w)&&R++}v.setThis(b);const ie=new Ae;let se=!1;if(q===I)do{if(z>2){const ve=v.clone();if(ve.absThis(),ve.ldexpThis(4),f.sub(m).ldexpThis(-1).gt(ve)){if(g.equals(m)){ie.setThis(g),g.setThis(m.add(ve)),g.limitPrecisionThis(n),b.setThis(g.sub(ie));break}if(g.equals(f)){ie.setThis(g),g.setThis(f.sub(ve)),g.limitPrecisionThis(n),b.setThis(g.sub(ie));break}}}b.setThis(l.sub(a)),b.ldexpThis(-1),b.limitPrecisionThis(n),ie.setThis(g),g.setThis(a.add(b)),g.limitPrecisionThis(n),g.lt(m)?g.setThis(m):g.gt(f)&&g.setThis(f),se=a.equals(g)||l.equals(g)}while(!1);else for(;;){if(b.setThis(w.div(S)),b.limitPrecisionThis(n),R!==1&&b.mulDoubleThis(R),ie.setThis(g),g.subThis(b),g.limitPrecisionThis(n),se=g.equals(ie),g.lt(m)){if(R>1){g.setThis(ie),R--;continue}b.setThis(ie.sub(m)),g.setThis(m)}else if(g.gt(f)){if(R>1){g.setThis(ie),R--;continue}b.setThis(ie.sub(f)),g.setThis(f)}break}if(se||b.absLessAbs(V)){ie.equals(g)||(w=T.evaluate(g),w.limitPrecisionThis(n+2));break}w=T.evaluate(g),w.limitPrecisionThis(n+2),S=P.evaluate(g),S.limitPrecisionThis(n+2);const Z=a.clone(),te=l.clone();w.LZ()?(u.setThis(w),a.setThis(g)):(c.setThis(w),l.setThis(g)),q===k&&(a.equals(Z)&&l.equals(te)||z>1&&!b.absLessAbs(B.mul(v)))?O++:O=0,q===I?(D++,z=0):(D=0,z++)}return H>=W&&Ce("Root_finder iterations exceeded"),o.setThis(g),!0}function XKe(t,e,s,i,r){const n=t.evaluate(s);if(n.isZero())return!0;const o=Ae.constructDouble(.5*i),a=s.clone();a.subThis(o);const l=t.evaluate(a),u=s.clone();u.addThis(o);const c=t.evaluate(u);if(l.LZ()&&c.GZ()||l.GZ()&&c.LZ()||(n.GZ()?l.LEZ()||c.LEZ():l.GEZ()||c.GEZ()))return!0;const h=l.LEZ()&&c.LEZ(),m=l.GEZ()&&c.GEZ();let f=!1;return h?n.gt(l)&&n.gt(c)&&(f=!0):m&&n.lt(l)&&n.lt(c)&&(f=!0),!!f&&n.absThis().lt(Ae.constructDouble(1e-17))}function f1e(t,e,s,i,r,n,o,a){F(s>0),F(a>=t.power());const l=o,u=[];let c=[];const h=new Vt({zeroCtor:t.m_zeroCtor}),m=new Vt({zeroCtor:t.m_zeroCtor}),f=new Vt({zeroCtor:t.m_zeroCtor}),g=Ae.constructDouble(s),v=Ae.constructDouble(e.vmin),b=Ae.constructDouble(e.vmax),w=v.sub(g),S=b.add(g),T=g1e(t),P=T.clone();if(P.negateThis(),w.lt(P))w.setThis(P.sub(g));else if(w.gt(T))return 0;if(S.gt(T))S.setThis(T.add(g));else if(S.lt(P))return 0;let I=t,A=null;if(r){const B=new Vt({coef0:Ae.constructInt32(-1)});B.addElement(Fc),A=new Vt,I=A;const H=new Vt,W=new Vt;for(t.div(B,H,W),A.assignCopy(H);I.evaluate(Fc).isZero();)I.div(B,H,W),A.assignCopy(H)}let D=!1;if(I.power()>0&&I.getElement(0).isZero())for(D=!0,A||(A=new Vt({copy:I}),I=A);I.getElement(0).isZero();)A.shiftRight(1);let k=i+2*I.power()+2,R=s/Math.pow(2,I.power()+2),O=k;if(zn.gt(w)&&zn.lt(S)){for(let B=0,H=I.power();B<H;B++)if(I.getElement(B).isZero()){u.push(zn.clone());break}}for(let B=I.power()-1;B>0;B--)if(R*=2,k-=2,O-=2,I.power()-B!=1)if(I.power()-B!=2){m.assignMove(f),f.assignMove(I.derivative(B-1));let H=[];for(let W=0,ie=c.length;W<ie;++W)if(c[W].first.lte(c[W].second)){const se=new Ae;if(K8(m,h,c[W].first,c[W].second,R,k,se)){u.push(se);let Z=se.sub(g);Z.limitPrecisionThis(O),H.push(Zi(c[W].first,Z)),Z=se.add(g),Z.limitPrecisionThis(O),H.push(Zi(Z,c[W].second))}else H.push(c[W])}c=H,H=[],h.assignMove(m)}else{m.assignMove(I.derivative(B));const H=YKe(m,k,l,a);F(H>=0&&H<=2);for(let W=0;W<H;W++)l[W].gt(w)&&l[W].lt(S)&&!l[W].isZero()&&u.push(l[W].clone());if(u.length>1&&u.sort((W,ie)=>W.compare(ie)),u.length>0){let W=u[0].sub(g);W.limitPrecisionThis(O),c.push(Zi(w.clone(),W));let ie=u.length===1?S.clone():u[1].sub(g);W=u[0].add(g),W.limitPrecisionThis(O),ie.limitPrecisionThis(O),c.push(Zi(W,ie)),u.length>1&&(ie=u.length===2?S.clone():u[2].sub(g),ie.limitPrecisionThis(O),W=u[1].add(g),W.limitPrecisionThis(O),c.push(Zi(W,ie)),u.length>2&&(W=u[2].add(g),W.limitPrecisionThis(O),c.push(Zi(W,S.clone()))))}else c.push(Zi(w.clone(),S.clone()));h.assignCopy(m),f.assignMove(I.derivative(B-1))}else m.assignMove(I.derivative(B)),p1e(m,l,a)===1&&(l[0].gt(w)&&l[0].lt(S)&&!l[0].isZero()&&u.push(l[0].clone()),h.assignMove(m),f.assignMove(I.derivative(B-1)));u.sort((B,H)=>B.compare(H)),c.length===0&&(h.assignMove(I.derivative(I.power())),h.isZero()||c.push(Zi(w.clone(),S.clone())));let z=0,q=0,U=0;const V=new Ae;for(;;){if(q<c.length){if(c[q].first.gt(c[q].second)){q++;continue}let B=!1;if(U<u.length&&u[U].lt(c[q].first)&&(B=!0),!B){K8(I,h,c[q].first,c[q].second,s,i,V)&&(V.lt(v)?l[z++].setThis(v):V.gt(b)?l[z++].setThis(b):l[z++].setThis(V)),q++;continue}}if(!(U<u.length))break;U!==0&&u[U-1].equals(u[U])||XKe(I,h,u[U],s)&&(V.setThis(u[U]),V.lt(v)?V.setThis(v):V.gt(b)&&V.setThis(b),z!==0&&l[z].equals(V)||l[z++].setThis(V)),U++}return D&&zn.gt(w)&&zn.lt(S)&&(l[z++].setThis(zn),Qc(l,0,z,(B,H)=>B.compare(H))),r&&Fc.gt(w)&&Fc.lt(S)&&(l[z++].setThis(Fc),Qc(l,0,z,(B,H)=>B.compare(H))),z}function g1e(t){const e=t.getElement(t.power());e.limitPrecisionThis(53);const s=zn.clone();for(let i=0,r=t.power();i<r;i++){const n=t.getElement(i);n.limitPrecisionThis(53),n.divThis(e).absThis(),n.gt(s)&&s.setThis(n)}return s.addThis(Fc),s.mulThis(Ae.constructDouble(1+100*Number.EPSILON)),s}function u2(t,e,s,i){let r=i;if(!t.isEmpty()){r=0;for(let n=0;n<i;++n)t.containsCoordinate(s[n].value())&&(r!==n&&s[r].setThis(s[n]),r++)}r>1&&(s[0].gt(s[1])&&(s[1]=be(s[0],s[0]=s[1])),r>2&&(s[0].gt(s[2])&&(s[2]=be(s[0],s[0]=s[2])),s[1].gt(s[2])&&(s[2]=be(s[1],s[1]=s[2]))));for(let n=0;n<r;++n)s[n].limitPrecisionThis(e);return r}const Fie=[[.33998104358485626,.6521451548625461],[.8611363115940526,.34785484513745385]],Oie=[[.1834346424956498,.362683783378362],[.525532409916329,.31370664587788727],[.7966664774136267,.22238103445337448],[.9602898564975363,.10122853629037626]],Lie=[[.09501250983763744,.1894506104550685],[.2816035507792589,.18260341504492358],[.45801677765722737,.16915651939500254],[.6178762444026438,.14959598881657674],[.755404408355003,.12462897125553388],[.8656312023878318,.09515851168249279],[.9445750230732326,.062253523938647894],[.9894009349916499,.027152459411754096]],Vie=[[.04830766568773832,.0965400885147278],[.1444719615827965,.09563872007927486],[.23928736225213706,.09384439908080457],[.33186860228212767,.09117387869576389],[.42135127613063533,.08765209300440381],[.5068999089322294,.08331192422694675],[.5877157572407623,.07819389578707031],[.6630442669302152,.0723457941088485],[.7321821187402897,.06582222277636185],[.7944837959679424,.058684093478535544],[.84936761373257,.050998059262376175],[.8963211557660521,.04283589802222668],[.9349060759377397,.03427386291302143],[.9647622555875064,.02539206530926206],[.9856115115452684,.01627439473090567],[.9972638618494816,.007018610009470096]],qie=[[.024350292663424433,.048690957009139724],[.07299312178779904,.04857546744150343],[.12146281929612056,.048344762234802954],[.16964442042399283,.04799938859645831],[.21742364374000708,.04754016571483031],[.2646871622087674,.04696818281621002],[.31132287199021097,.046284796581314416],[.3572201583376681,.04549162792741814],[.4022701579639916,.044590558163756566],[.4463660172534641,.04358372452932345],[.48940314570705296,.04247351512365359],[.5312794640198946,.04126256324262353],[.571895646202634,.03995374113272034],[.6111553551723933,.038550153178615626],[.6489654712546573,.03705512854024005],[.6852363130542333,.035472213256882386],[.7198818501716109,.033805161837141606],[.7528199072605319,.03205792835485155],[.7839723589433414,.030234657072402478],[.8132653151227975,.028339672614259483],[.8406292962525803,.02637746971505466],[.8659993981540928,.024352702568710874],[.8893154459951141,.022270173808383253],[.9105221370785028,.02013482315353021],[.9295691721319396,.017951715775697343],[.9464113748584028,.015726030476024718],[.9610087996520538,.013463047896718643],[.973326827789911,.011168139460131128],[.983336253884626,.008846759826363947],[.9910133714767443,.006504457968978363],[.9963401167719553,.004147033260562468],[.9993050417357722,.001783280721696433]],Gie=[[.012223698960615764,.024446180196262518],[.03666379096873349,.024431569097850044],[.06108196960413957,.02440235563384958],[.08546364050451549,.024358557264690626],[.10979423112764375,.024300200167971867],[.13405919946118777,.02422731922281525],[.15824404271422493,.024139957989019287],[.18233430598533718,.024038168681024052],[.2063155909020792,.023922012136703457],[.23017356422666,.023791557781003402],[.2538939664226943,.023646883584447616],[.2774626201779044,.02348807601653591],[.3008654388776772,.02331522999406276],[.32408843502441337,.023128448824387027],[.3471177285976355,.022927844143686846],[.369939555349859,.02271353585023646],[.39254027503326744,.022485652032744968],[.414906379552275,.022244328893799764],[.43702450103710416,.02198971066846049],[.4588814198335522,.021721949538052076],[.48046407240417205,.02144120553920846],[.5017595591361445,.02114764646822135],[.5227551520511755,.02084144778075115],[.5434383024128103,.02052279248696007],[.5637966482266181,.020191871042130043],[.5838180216287631,.01984888123283086],[.6034904561585486,.019494028058706602],[.6228021939105849,.019127523609950944],[.6417416925623075,.01874958694054471],[.660297632272646,.01836044393733134],[.6784589224477192,.017960327185008687],[.6962147083695144,.017549475827117706],[.7135543776835874,.01712813542311138],[.7304675667419088,.016696557801589205],[.746944166797062,.016255000909785187],[.7629743300440948,.015803728659399347],[.7785484755064119,.015343010768865144],[.7936572947621933,.014873122602147314],[.8082917575079137,.014394345004166847],[.8224431169556439,.013906964132951985],[.8361029150609068,.013411271288616333],[.8492629875779689,.012907562739267348],[.8619154689395485,.012396139543950923],[.8740527969580318,.01187730737274028],[.8856677173453972,.011351376324080417],[.8967532880491582,.010818660739503076],[.9073028834017568,.010279479015832158],[.9173101980809605,.009734153415006806],[.9267692508789478,.009183009871660874],[.9356743882779164,.00862637779861675],[.9440202878302202,.008064589890486059],[.9518019613412644,.0074979819256347285],[.9590147578536999,.006926892566898814],[.9656543664319652,.006351663161707189],[.9717168187471366,.005772637542865698],[.9771984914639074,.00519016183267633],[.9820961084357185,.004604584256702955],[.9864067427245862,.004016254983738642],[.9901278184917344,.0034255260409102157],[.9932571129002129,.0028327514714579912],[.9957927585349812,.0022382884309626186],[.997733248625514,.0016425030186690294],[.9990774599773758,.0010458126793403489],[.9998248879471319,.00044938096029209035]];function Gh(t,e,s,i){const r=.5*(i-s),n=s+r,o=new Fr(0);for(let a=0,l=Math.trunc(t/2);a<l;++a){let u,c;switch(t){case 4:u=Fie[a][0],c=Fie[a][1];break;case 8:u=Oie[a][0],c=Oie[a][1];break;case 16:u=Lie[a][0],c=Lie[a][1];break;case 32:u=Vie[a][0],c=Vie[a][1];break;case 64:u=qie[a][0],c=qie[a][1];break;case 128:u=Gie[a][0],c=Gie[a][1];break;default:throw new Error("Quadrature_integral: invalid n")}const h=nie(-.5,u,n),m=nie(r,u,n);o.pe(e(h)*c),o.pe(e(m)*c)}return o.getResult()*r}function Vb(t,e,s,i,r,n){return QKe(t,e,s,n,i,r)}function WKe(t,e,s,i,r,n){let o=r;if(i)return n[0]=1,o=.5*(e-t)*(s(t)+s(e)),o;const a=n[0],l=(e-t)/a,u=t,c=new Fr(0);for(let h=1;h<=n[0];++h){const m=(h-.5)*l;c.add(s(u+m))}return o=.5*(o+(e-t)*c.getResult()/a),n[0]*=2,o}function ZKe(t,e,s,i,r,n,o){let a=0,l=Math.abs(r-s[t]);const u=Me(e,Number.NaN),c=Me(e,Number.NaN);for(let g=0;g<e;++g){const v=Math.abs(r-s[t+g]);v<l&&(a=g,l=v),u[g]=i[t+g],c[g]=i[t+g]}let h=0,m=0,f=0;n[0]=i[t+a],a--;for(let g=1;g<e;g++){for(let v=0;v<e-g;v++){if(m=s[t+v]-r,f=s[t+v+g]-r,h=m-f,h===0)return!1;const b=(u[v+1]-c[v])/h;u[v]=m*b,c[v]=f*b}if(2*(a+1)<e-g){const v=a+1;o[0]=u[v]}else{const v=a;o[0]=c[v],a--}n[0]+=o[0]}return!0}function QKe(t,e,s,i,r,n){if(s<e&&ee("xTo < xFrom"),s===e)return 0;const o=[0];let a=Number.MAX_VALUE;const l=[Number.MAX_VALUE];let u=0;const c=32,h=Me(c+1,Number.NaN),m=Me(c+1,Number.NaN),f=[0];h[0]=1;let g=0,v=0;for(let b=0;b<c;b++){if(u=WKe(e,s,i,b===0,u,f),m[b]=u,b+1>=t){ZKe(b+1-t,t,h,m,0,o,l)||Ce("polynomial_interpolation");const w=r*Math.abs(o[0])+n,S=Math.abs(a-o[0]);if(S<=w&&Math.abs(l[0])<=w){if(g++,g>1&&(S<=.1*v||v===0||g>2))return o[0]}else g=0;v=S,a=o[0]}m[b+1]=m[b],h[b+1]=.25*h[b]}return o[0]}let JKe=class{constructor(){this.length=Number.NaN,this.area=Number.NaN,this.centroidX=Number.NaN,this.centroidY=0,this.specialPoints=[],this.specialPointsLength=[]}specialPointsCount(){return this.specialPoints.length}};function eG(t,e,s,i,r,n,o,a){for(;;){const l=M.distance(e[0],e[2]),u=M.distance(e[0],e[1])+M.distance(e[1],e[2]);if(u-l<=r+i*u)return t+zt(l,u,.5);const c=ne(M,4),h=D=>(cb(e,s,1,D,c),c[1].length());if(o===0&&a<8){F(a<8);let D=h(0),k=h(1);n[0]+=2,D>k&&(k=be(D,D=k),e[2]=be(e[0],e[0]=e[2]),s[2]=be(s[0],s[0]=s[2]));let R=D/(D+k),O=1,z=u;for(;R<1/32&&z>=r+i*z;){O/=4;const q=h(O);n[0]++,R=D/(q+D);const U=new M;if(bi(e,s,.5*O,U),z=M.distance(U,e[0]),z<=r){const V=new M;bi(e,s,O,V),z+=M.distance(V,U)}}if(O!==1){const q=ne(M,3),U=[0,0,0];jie(e,s,O,e,s,q,U),t=eG(t,q,U,i,r,n,0,a+1),o++,a++;continue}}let m=!1;const f=8;n[0]+=f;const g=Gh(f,h,0,1),v=16;n[0]+=v;const b=Gh(v,h,0,1);if(m=Math.abs(g-b)>r+i*u,!m)return t+b;if(o<8&&a<9){const D=ne(M,3),k=[0,0,0];jie(e,s,.5,e,s,D,k),t=eG(t,D,k,i,r,n,o+1,a+1),o++,a++;continue}const w=32;n[0]+=w;const S=Gh(w,h,0,1);if(m=Math.abs(b-S)>r+i*u,!m)return t+S;const T=64;n[0]+=T;const P=Gh(T,h,0,1);if(m=Math.abs(S-P)>r+i*u,!m)return t+P;const I=128;n[0]+=I;const A=Gh(I,h,0,1);return m=Math.abs(P-A)>r+i*u,t+A}}function KKe(t,e,s,i,r){if(s===e)return 0;const n=ne(M,3),o=[0,0,0];t.queryControlPoints(n),t.queryWeights(o);const a=[0,0,0],l=ne(M,3);return ug(n,o,e,s,l,a),eG(0,l,a,i,r,[0],0,0)}let eet=class{constructor(e,s,i){this.controlPoints=H3(e,3),this.weights=[0,0,0],$s(this.weights,s,0,0,3),this.point=i.clone()}getMaxDerivative(){return 3}getValue(e,s){if(e===0){const i=new M;bi(this.controlPoints,this.weights,s,i);const r=ne(M,4);return cb(this.controlPoints,this.weights,1,s,r),2*i.sub(this.point).dotProduct(r[1])}if(e===1){const i=new M;bi(this.controlPoints,this.weights,s,i);const r=ne(M,4);return cb(this.controlPoints,this.weights,2,s,r),2*(i.sub(this.point).dotProduct(r[2])+r[1].dotProduct(r[1]))}if(e===2){const i=new M;bi(this.controlPoints,this.weights,s,i);const r=ne(M,4);return cb(this.controlPoints,this.weights,3,s,r),2*(i.sub(this.point).dotProduct(r[3])+3*r[1].dotProduct(r[2]))}return 0}getError(e){return F(0),0}};function tet(t,e,s,i){const r=_et(0,0,0,0,M.getNAN()),n=Me(18,Number.NaN),o=ne(M,3);t.queryControlPoints(o),o[2].subThis(e),o[1].subThis(e),o[0].subThis(e);const a=[0,0,0];t.queryWeights(a);const l=[1,zu(a),1],u=cC(a,s),c=cC(a,i),h=Cg(new eet(o,l,new M(0,0)),de.construct(u,c),18,n);bi(o,l,u,r.pt),r.t=u,r.d=M.distance(r.pt,new M(0,0));const m=new M;bi(o,l,c,m);const f=M.distance(m,new M(0,0));f<r.d&&(r.d=f,r.t=c,r.pt.assign(m));for(let g=0;g<h;g++){bi(o,l,n[g],m);const v=M.distance(m,new M(0,0));v<r.d&&(r.d=v,r.t=qb(a,n[g]),r.pt.assign(m))}return r}function set(t,e,s,i,r){let n=!0;const o=ne(M,4),a=Vb(5,e,s,i,r,u=>(J3(t,1,u,o),(n?t.getCoordX(u)-t.getStartX():t.getCoordY(u)-t.getStartY())*o[1].length()));n=!1;const l=Vb(5,e,s,i,r,u=>(J3(t,1,u,o),(n?t.getCoordX(u)-t.getStartX():t.getCoordY(u)-t.getStartY())*o[1].length()));return new M(a,l)}function c2(t){t.m_cachedValues=null}function iet(t,e){e.m_cachedValues=be(t.m_cachedValues,t.m_cachedValues=e.m_cachedValues)}function nC(t){if(t.m_cachedValues)return t.m_cachedValues;const e=new JKe,s=ne(M,3);t.queryControlPoints(s);const i=[0,0,0];return t.queryWeights(i),y1e(s,i,e.specialPoints),v1e(t,e),e}function y1e(t,e,s){if(e[1]===0)return s.length=0,s.push(0),void s.push(1);const i=ne(le,8);i[0].set(0);let r=1;{const n=new le(t[1].x).subThis(t[0].x).mulThis(e[1]).mulThis(e[0]),o=new le(t[2].x).subThis(t[0].x).mulThis(e[2]).mulThis(e[0]),a=n.subE(o).addThisE(new le(t[2].x).subThis(t[1].x).mulThis(e[2]).mulThis(e[1]));o.subThisE(n.mul(2));const l=ne(le,2);let u=xa(a,o,n,new de(0,1),!1,l);u<0&&(u=0);for(let c=0;c<u;c++)bs(l[c].value(),0,1)||(i[r]=l[c],r++)}{const n=new le(t[1].y).subThis(t[0].y).mulThis(e[1]).mulThis(e[0]),o=new le(t[2].y).subThis(t[0].y).mulThis(e[2]).mulThis(e[0]),a=n.subE(o).addThisE(new le(t[2].y).subThis(t[1].y).mulThis(e[2]).mulThis(e[1]));o.subThisE(n.mul(2));const l=ne(le,2);let u=xa(a,o,n,new de(0,1),!1,l);u<0&&(u=0);for(let c=0;c<u;c++)bs(l[c].value(),0,1)||(i[r]=l[c],r++)}if(i[r].set(1),r++,r>2){Qc(i,0,r,(l,u)=>em(l.value(),u.value()));let n=0,o=i[0].value(),a=1;for(let l=1;l<r;l++)i[l].eq(i[l-1])?(o+=i[l].value(),a++):(a>1&&(o/=a,i[n].set(o)),n++,i[n]=i[l],o=i[l].value(),a=1);n++,r=n}i[0].set(0),i[r-1].set(1),s.length=r;for(let n=0;n<r;n++)s[n]=i[n].value()}function oC(t,e,s){if(s){if(e<0)return e;if(e>1)return e-1+oC(t,1,!1)}if(t.isDegenerate(0))return 0;const i=e===1,r=nC(t);if(i&&!Number.isNaN(r.length))return r.length;const n=_1e(t),o=n/t.calculateUpperLength2D();let a=0,l=0;for(let u=1,c=r.specialPointsCount();u<c;u++){const h=r.specialPoints[u];if(a+=KKe(t,l,Math.min(e,h),o,n),e<=h)break;l=h}return i&&(r.length=a),a}function J3(t,e,s,i){const r=ne(M,3);t.queryControlPoints(r);const n=[0,0,0];t.queryWeights(n),cb(r,n,e,s,i)}function cb(t,e,s,i,r){const n=[t[0],t[1],t[2]],o=[e[0],e[1],e[2]],a=ne(M,4);ret(n,o,s,i,a);for(let l=0;l<=s;l++)r[l].setCoords(a[l].x,a[l].y)}function ret(t,e,s,i,r){F(s>0);const n=[t[0].clone(),t[1].clone(),t[2].clone()];if(!n[0].isZero()){for(let T=1;T<3;++T)n[T].subThis(n[0]);n[0].setCoords(0,0)}const o=uM(n,e,0,i),a=uL(e,0,i),l=o.divide(a);if(r[0].assign(l),s===0)return;const u=[e[1]*e[0],e[2]*e[0]*.5,e[1]*e[2]],c=[t[1].sub(t[0]),t[2].sub(t[0]),t[2].sub(t[1])],h=a*a,m=uM(c,u,0,i).mul(2).divide(h);if(r[1].assign(m),s===1)return;const f=uL(e,1,i),g=2*a*f,v=uM(c,u,1,i).mul(2).sub(m.mul(g)).divide(h);if(r[2].assign(v),s===2)return;const b=uM(c,u,2,i).mul(2),w=2*(f*f+a*uL(e,2,i)),S=b.sub(v.mul(g).mul(2)).sub(m.mul(w)).divide(h);r[3].assign(S),s!==3&&Ce("")}function uM(t,e,s,i){if(s===0){if(i<=.5){const r=new M;Li(2,t[0].mul(e[0]),t[1].mul(e[1]),i,r);const n=new M;Li(2,t[1].mul(e[1]),t[2].mul(e[2]),i,n);const o=new M;return Li(2,r,n,i,o),o}{const r=new M;Vi(2,t[0].mul(e[0]),t[1].mul(e[1]),i,r);const n=new M;Vi(2,t[1].mul(e[1]),t[2].mul(e[2]),i,n);const o=new M;return Vi(2,r,n,i,o),o}}if(s===1){const r=t[1].mul(e[1]),n=r.sub(t[0].mul(e[0])).mul(1-i).add(t[2].mul(e[2]).sub(r).mul(i));return n.mulThis(2),n}if(s===2){const r=t[1].mul(e[1]),n=t[2].mul(e[2]).sub(r).sub(r.sub(t[0].mul(e[0])));return n.mulThis(2),n}Ce("")}function zie(t,e,s,i){if(i.toDouble()<=.5){const r=new je;Rl(2,t[0].mulE(e[0]),t[1].mulE(e[1]),i,r);const n=new je;Rl(2,t[1].mulE(e[1]),t[2].mulE(e[2]),i,n);const o=new je;return Rl(2,r,n,i,o),o}{const r=new je;kl(2,t[0].mulE(e[0]),t[1].mulE(e[1]),i,r);const n=new je;kl(2,t[1].mulE(e[1]),t[2].mulE(e[2]),i,n);const o=new je;return kl(2,r,n,i,o),o}}function uL(t,e,s){if(e===0){const i=zt(t[0],t[1],s),r=zt(t[1],t[2],s);return zt(i,r,s)}if(e===1)return 2*((1-s)*(t[1]-t[0])+(t[2]-t[1])*s);if(e===2)return 2*(t[2]-t[1]-(t[1]-t[0]));Ce("")}function net(t,e,s){if(s.toDouble()<=.5){const i=Pu(t[0],t[1],s),r=Pu(t[1],t[2],s);return Pu(i,r,s)}{const i=Tu(t[0],t[1],s),r=Tu(t[1],t[2],s);return Tu(i,r,s)}}function oet(t,e,s,i,r){const n=[je.constructPoint2D(t[0]),je.constructPoint2D(t[1]),je.constructPoint2D(t[2])];n[2].subThisE(n[0]),n[1].subThisE(n[0]),n[0].setCoords(0,0),aet(n,[new le(e[0]),new le(e[1]),new le(e[2])],s,i,r)}function aet(t,e,s,i,r){F(s>0);const n=[t[0].clone(),t[1].clone(),t[2].clone()];if(!n[0].isZero()){for(let f=1;f<3;++f)n[f].subThisE(n[0]);n[0]=je.constructCoords(0,0)}const o=zie(n,e,0,i),a=net(e,0,i),l=o.divE(a);r[0].setE(l);const u=[e[1].mulE(e[0]),e[2].mulE(e[0]).mul(.5),e[1].mulE(e[2])],c=zie([t[1].subE(t[0]),t[2].subE(t[0]),t[2].subE(t[1])],u,0,i).mul(2),h=a.sqr(),m=c.divE(h);r[1].setE(m)}function uet(t,e,s){const i=ne(M,3);t.queryControlPoints(i);const r=Me(3,Number.NaN);t.queryWeights(r),cet(i,r,e,s)}function cet(t,e,s,i){s.value()<0&&s.set(0,s.eps()),s.value()>1&&s.set(1,s.eps());const r=ne(je,4);oet(t,e,1,s,r),i.setE(r[1])}function tG(t,e,s){const i=ys(s,0,1),r=ne(M,4);if(cb(t,e,3,i,r),r[1].isZero()){if(r[2].isZero())return r[3];{const n=r[2].clone();return i===1&&n.negateThis(),n}}return r[1]}let het=class{constructor(e,s){this.len=0,this.b=e,this.len=s}getMaxDerivative(){return 1}getValue(e,s){return e===0?this.len-oC(this.b,s,!1):0}getError(e){return F(0),0}};function met(t,e,s){const i=oC(t,1,!1);if(e<=0)return e;if(e>=i)return e-i+1;const r=[0];return Cg(new het(t,e),de.unit(),1,r)!==1&&Ce(""),r[0]}function Uie(t){const e=ne(M,3),s=[0,0,0];return t.queryControlPoints(e),t.queryWeights(s),det(e,s)}function det(t,e){const s=zu(e);if(s===1)return C1e(t);if(s===0)return 0;const i=[new M(0,0),t[1].sub(t[0]),t[2].sub(t[0])],r=i[1].crossProduct(i[2]);if(s<1){F(s>0);const n=1-s;let o;if(n<.01)o=-1/3+n*(2/15+n*(3/35+n*(16/315+n*(20/693+n*(16/1001+n*(56/6435))))));else{const a=n*(1+s),l=Math.atan2(Math.sqrt(n),Math.sqrt(1+s));o=s*(.5*s-mJe(a)*l)/a}return r*o}{const n=(s-1)*(s+1);return .25*s/Math.pow(n,1.5)*(-2*s*Math.sqrt(n)*r-4*i[1].y*i[2].x*Math.atanh(Math.sqrt((s-1)/(s+1)))-i[1].x*i[2].y*Math.log(2*s*(s-Math.sqrt(n))-1))}}function pet(t,e){const s=zu(e);if(s===1){const n=ne(M,3);O9(t,n);const o=n[2].clone(),a=n[1].clone(),l=new M,u=o.y*a.x-o.x*a.y;return l.x=-(4*o.x+5*a.x)*u/60,l.y=-(4*o.y+5*a.y)*u/60,l}if(s===0)return new M(0,0);F(s>0);const i=t[1].sub(t[0]),r=t[2].sub(t[0]);if(s<1){const n=Math.sqrt(1-s),o=Math.sqrt(1+s),a=(i.y*r.x-i.x*r.y)*s/Math.pow(n*o,5)/12,l=Math.atan2(n,o),u=s*n*o,c=s*s,h=i.mul(2*(2+c)),m=r.mul(2*c-5),f=h.add(m).mul(u),g=r.sub(i.mul(2*c)).mul(6*l);return f.add(g).mul(a)}{const n=Math.sqrt(s-1),o=Math.sqrt(s+1),a=(i.y*r.x-i.x*r.y)*s/Math.pow(n*o,5)/12,l=Math.atanh(n/o),u=s*n*o,c=s*s,h=i.mul(4).sub(r.mul(5)),m=i.add(r).mul(2*c),f=h.add(m).mul(u),g=r.sub(i.mul(2*c)).mul(6*l);return f.add(g).mul(a)}}function fet(t){const e=ne(M,3),s=[0,0,0];return t.queryControlPoints(e),t.queryWeights(s),pet(e,s)}function _1e(t){return get(t.calculateUpperLength2D())}function get(t){return 256*Bs()*t}function yet(t){if(t.m_weights[1]===0)return!0;const e=M.distance(t.getStartXY(),t.getEndXY()),s=t.calculateUpperLength2D();return s-e<=8*Number.EPSILON*s}function Bie(t){return t.m_cachedValues}function v1e(t,e){t.m_cachedValues=e}function K3(t,e,s,i,r){const n=ne(M,3);t.queryControlPoints(n);const o=[0,0,0];t.queryWeights(o);const a=[0];return R9(n,o,e,de.unit(),i,r,1,a)===1?a[0]:Number.NaN}function R9(t,e,s,i,r,n,o,a){KE(de.unit().contains(i)&&o>0,""),(n<0||Number.isNaN(n))&&(n=Number.MAX_VALUE);const l=new Array(3);for(let se=0;se<3;++se)l[se]=t[se].sub(s);const u=zu(e),c=zs.constructPoint2D(l[0]),h=zs.constructPoint2D(l[1]),m=zs.constructPoint2D(l[2]),f=Ae.constructDouble(u),g=f.clone();g.ldexpThis(1);const v=c.dotProduct(h.sub(c)).mul(f),b=f.mul(f.addDouble(2)),w=m.sub(h.mul(b.ldexp(1))),S=h.sqrLength().mul(f.mul(f).ldexp(1)).add(c.sqrLength().mul(f.ldexp(2).subDouble(1))).add(c.dotProduct(w)),T=m.sub(h.mul(g)).add(c.mul(g.subDouble(1))),P=h.mul(f).sub(c).dotProduct(T).mulDouble(3),I=h.dotProduct(m).mul(f.subDouble(3).mul(f)).ldexp(1),A=h.sqrLength().mul(f.mul(f).ldexp(2)),D=c.sqrLength().mul(f.ldexp(2).subDouble(3)),k=c.dotProduct(m.sub(h.mul(f.mulDouble(3).subDouble(1)).mul(f))).ldexp(1),R=m.sqrLength().addThis(I).addThis(A).addThis(D).addThis(k),O=c.add(m).sub(h.mul(g)),z=f.subDouble(1),q=m.sub(c).dotProduct(O).mul(z),U=new M(0,0),V=[];let B=new M;bi(l,e,i.vmin,B);let H=M.distance(B,U);if(H<=n&&V.push(new M(i.vmin,H)),i.vmin!==i.vmax&&(bi(l,e,i.vmax,B),H=M.distance(B,U),H<=n&&V.push(new M(i.vmax,H))),i.width()>0){const se=l[2].isZero(),Z=ne(Ae,4),te=d1e(q,R,P,S,v,58,i,se,Z);for(let ve=0;ve<te;ve++){if(!i.containsExclusiveCoordinate(Z[ve].toDouble()))continue;let ke=Z[ve].toDouble();ke=qb(e,ke);const Fe=new M;bi(l,e,ke,Fe),H=M.distance(Fe,U),H<=n&&V.push(new M(ke,H))}}if(r){F(i.equals(de.unit()));{bi(l,e,-1,B,!0);const se=new M;bi(l,e,0,se);const Z=new pt({start:B,end:se}),te=Z.getClosestCoordinate(U,!0);te<1&&(B=Z.getCoord2D(te),H=M.distance(B,U),H<=n&&V.push(new M(te-1,H)))}{bi(l,e,2,B,!0);const se=new M;bi(l,e,i.vmax,se);const Z=new pt({start:se,end:B}),te=Z.getClosestCoordinate(U,!0);te>0&&(B=Z.getCoord2D(te),H=M.distance(B,U),H<=n&&V.push(new M(1+te,H)))}}if(!V.length)return 0;V.sort((se,Z)=>se.compare(Z));let W=0;const ie=V[0].x;if(a[W++]=ie,W<o){const se=Y0e(l,4,!1).total(),Z=V[0].y;for(let te=1,ve=V.length;te<ve;te++)if(V[te].y>Z+se){V.length=te;break}V.sort((te,ve)=>em(te.x,ve.x)),W=0,a[W++]=V[0].x;for(let te=1,ve=V.length;te<ve;te++)V[te].x!==a[W-1]&&W<o&&(a[W++]=V[te].x)}return W}function _et(t,e,s,i,r){return{tmin:t,tmax:e,t:s,d:i,pt:r.clone()}}function vet(t,e,s,i,r){const n=new Yn;if(b1e(t,de.unit(),n),n.inflate(i),!n.isIntersectingPoint2D(e))return 0;const o=nC(t);let a=0;const l=[];let u=o.specialPoints[0];for(let c=1,h=o.specialPoints.length;c<h;++c){const m=o.specialPoints[c],f=tet(t,e,u,m);if(l.length===0)l.push(f);else if(f.t===f.tmin)F(l.at(-1).d<=f.d),l.at(-1).tmax=f.tmax;else if(l.at(-1).t===l.at(-1).tmax){F(l.at(-1).d>=f.d);const g=l.at(-1).tmin;l[l.length-1]=f,l.at(-1).tmin=g}else l.push(f);u=m}for(const c of l)if(c.d<=i){const h=c.t;s&&(s[a]=h),a++}return a}function b1e(t,e,s){const i=ne(M,3);t.queryControlPoints(i);const r=[0,0,0];t.queryWeights(r),aC(i,r,e,s)}function aC(t,e,s,i){if(s.equalsRange(0,1))return void i.setFromPoints(t,3);const r=ne(M,3),n=[0,0,0];ug(t,e,s.vmin,s.vmax,r,n),i.setFromPoints(r,3)}function pR(t){const e=Gs(t[0].y,t[1].y),s=Gs(t[1].y,t[2].y);if(e>=0&&s>=0||e<=0&&s<=0){const i=Gs(t[0].x,t[1].x),r=Gs(t[1].x,t[2].x);if(i>=0&&r>=0||i<=0&&r<=0)return!0}return!1}function sG(t){const e=ne(M,3);t.queryControlPoints(e);const s=s0(e);return s&&(t.m_cp.setCoordsPoint2D(e[1]),t.afterCompletedModification()),s}function s0(t){let e=!1;for(let s=0;s<2;s++){const i=Gs(t[0][s],t[2][s]);i>0?(Gs(t[0][s],t[1][s])<0&&(t[1][s]=t[0][s],e=!0),Gs(t[1][s],t[2][s])<0&&(t[1][s]=t[2][s],e=!0)):i<0?(Gs(t[0][s],t[1][s])>0&&(t[1][s]=t[0][s],e=!0),Gs(t[1][s],t[2][s])>0&&(t[1][s]=t[2][s],e=!0)):t[1][s]!==t[0][s]&&(t[1][s]=t[0][s],e=!0)}return e}function bet(t,e,s){s===void 0&&(s=e,e=0);const i=new M;if(e<0||s>1)return i.setNAN(),i;if(e>s&&ee("calculate_sub_weighted_centroid"),e===s||t.isDegenerate(0))return i.setCoords(0,0),i;const r=nC(t),n=_1e(t),o=n/t.calculateUpperLength2D();let a=e,l=0;for(let u=1,c=r.specialPointsCount();u<c;u++)if(e<r.specialPoints[u]){l=u-1;break}i.setCoords(0,0);for(let u=l+1,c=r.specialPointsCount();u<c;u++){const h=Math.min(r.specialPoints[u],s),m=set(t,a,h,o,n);if(i.addThis(m),a=h,s<=r.specialPoints[u])break}return i.add(t.getStartXY().mul(t.calculateLength2D()))}function jie(t,e,s,i,r,n,o){F(s>=0&&s<=1&&i!==n&&r!==o),F(e[0]>0&&e[2]>0&&e[1]>=0);const a=[1,zu(e),1],l=cC(e,s),u=H3(t,3),c=ne(gt,3);x1e(u,a,c);const h=ne(gt,3),m=ne(gt,3);aG(c,l,i?h:null,n?m:null),lG(e,s,r,o);const f=pR(u);if(i){for(let g=0;g<3;++g)nG(h[g],i[g]);uG(u,i),f&&s0(i)}if(n){for(let g=0;g<3;++g)nG(m[g],n[g]);uG(u,n),f&&s0(n)}}function ug(t,e,s,i,r,n){if(F(s>=0&&i<=1&&s<=i),s===i){const c=new M,h=w1e(t,e,s,c);return k9(t,c),r[0].assign(c),r[1].assign(c),r[2].assign(c),n[0]=h,n[1]=h,void(n[2]=h)}if(s===0&&i===1)return r[0].assign(t[0]),r[1].assign(t[1]),r[2].assign(t[2]),n[0]=e[0],n[1]=e[1],void(n[2]=e[2]);const o=ne(gt,3);{const c=[1,zu(e),1],h=cC(e,s),m=cC(e,i);x1e(t,c,o),aG(o,m,o,null),aG(o,h>=m?1:h/m,null,o)}const a=[0,0,0];lG(e,i,a,null),lG(a,s/i,null,a);const l=pR(t),u=ne(M,3);nG(o[1],u[1]),bi(t,e,s,u[0]),bi(t,e,i,u[2]),uG(t,u);for(let c=0;c<3;++c)r[c].assign(u[c]),n[c]=a[c];l&&s0(r)}function xet(t,e,s){const i=zu(e),r=[1,i,1],n=4*i/(3*(1+i));s[0].assign(t[0]),s[3].assign(t[2]),wi(t[0],t[1],n,s[1]),wi(t[2],t[1],n,s[2]),new Hl({cp:s}),new Oo({points:t,weight:i});let o=0,a=.1,l=0;for(let u=0;u<9;u++,a+=.1){const c=new M;bi(t,r,a,c);const h=new M;ri(s,a,h);const m=M.sqrDistance(c,h);m>o&&(o=m,l=a)}{const u=new M;bi(t,r,l,u);const c=[0];n0(s,u,de.unit(),!1,-1,1,c);const h=new M;return ri(s,c[0],h),o=M.sqrDistance(u,h),Math.sqrt(o)}}function wet(t,e,s,i){if(e.isEqual(t.m_XStart,t.m_YStart)&&s.isEqual(t.m_XEnd,t.m_YEnd))return;const r=!!i&&t.isMonotoneQuickAndDirty(),n=new Rt,o=ne(M,3);o[0].setCoords(t.m_XStart,t.m_YStart),o[2].setCoords(t.m_XEnd,t.m_YEnd);const a=new M;a.setSub(o[2],o[0]),a.leftPerpendicularThis(),o[1].setAdd(o[0],a);const l=ne(M,3);l[0].setCoordsPoint2D(e),l[2].setCoordsPoint2D(s),a.setSub(l[2],l[0]),a.leftPerpendicularThis(),l[1].setAdd(l[0],a),n.setFromTwoTriangles(o,l)?n.transformInPlace(t.m_cp):wi(e,s,.5,t.m_cp),t.changeEndPoints2D(e,s),r&&sG(t)}function Hie(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return t?4:2}else if(rl(e,s))return 1;return i0(t,e,s,null,null,null,i,r!==void 0&&r,!0,!1)!==0?4:0}function Yie(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return t?4:2}else if(rl(e,s))return 1;return iG(t,e,s,null,null,null,i,r??!1,!0,!1)!==0?4:0}function Eet(t,e){const s=t.getEndXY().sub(t.getStartXY()),i=s.length(),r=t.getControlPoint1();return r.subThis(t.getStartXY()),!(Math.abs(r.crossProduct(s))/i>e)}function Cet(t,e,s,i,r){if(r){const n=Ea(e,s);if(n!==0){if(t){if(n===1){if(e.m_weights[0]===s.m_weights[0]&&e.m_weights[1]===s.m_weights[1]&&e.m_weights[2]===s.m_weights[2])return 2}else if(e.m_weights[0]===s.m_weights[2]&&e.m_weights[1]===s.m_weights[1]&&e.m_weights[2]===s.m_weights[0])return 2;return 4}return 2}}else if(rl(e,s))return 1;return lC(t,e,s,null,null,null,i,r!==void 0&&r,!0,!1)!==0?4:0}function Xie(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return t?4:2}else if(rl(e,s))return 1;return rG(t,e,s,null,null,null,i,r??!1,!0,!1)!==0?4:0}function i0(t,e,s,i,r,n,o,a,l,u){if(r!==null&&(r.length=0),n!==null&&(n.length=0),i!==null&&(i.length=0),s.isDegenerate(0)){const Pe=[0,0],Ve=e.intersectPoint(s.getStartXY(),Pe,o);if(Ve>0){if(r!==null)for(let Ke=0;Ke<Ve;Ke++)r.push(Pe[Ke]);if(n!=null)for(let Ke=0;Ke<Ve;Ke++)n.push(0);if(i!=null)for(let Ke=0;Ke<Ve;Ke++){const He=new M;e.queryCoord2D(Pe[Ke],He),i.push(He)}}return Ve}const c=jo(e,s);if(o=Math.max(o,c),e.isDegenerateToLineHelper(c)){const Pe=new pt({start:e.getStartXY(),end:e.getEndXY()}),Ve=dR(Pe,s,i,r,n,o,a,u);if(r)for(let Ke=0;Ke<Ve;++Ke){const He=Pe.getCoord2D(r[Ke]);r[Ke]=e.getClosestCoordinate(He,!1)}return Ve}if(nl(e,s,o))return 0;const h=ne(M,3);e.queryControlPoints(h);const m=[0,0,0];e.queryWeights(m);const f=[1,zu(m),1],g=s.getEndXY().sub(s.getStartXY()),v=g.clone();v.leftPerpendicularThis();const b=h[0].clone(),w=h[1].clone(),S=h[2].clone(),T=w.sub(b),P=S.sub(b),I=S.sub(w),A=f[0],D=f[1],k=f[2],R=A*D,O=A*k,z=D*k,q=T.dotProduct(v)*R,U=P.dotProduct(v)*O;let V=q,B=U-2*q,H=I.dotProduct(v)*z+U-U;const W=Me(13,Number.NaN),ie=Me(13,Number.NaN);let se=e0(H,B,V,de.unit(),!1,W);se<0&&(W[0]=0,W[1]=1,se=2);let Z=0;for(let Pe=0,Ve=Z;Pe<se;++Pe){const Ke=new M;bi(h,f,W[Pe+Ve],Ke),ie[Z]=s.getClosestCoordinate(Ke,!1),M.distance(Ke,s.getCoord2D(ie[Z]))<=o&&(W[Z]=W[Pe+Ve],Z++)}const te=ne(M,3),ve=ne(M,3);if(e.queryControlPoints(ve),ve[0].subThis(s.getStartXY()),ve[1].subThis(s.getStartXY()),ve[2].subThis(s.getStartXY()),Pet(ve,f,te,!1),Math.abs(g.x)>=Math.abs(g.y)){const Pe=g.y/g.x;H=te[2].y-te[2].x*Pe,B=te[1].y-te[1].x*Pe,V=te[0].y-te[0].x*Pe}else{const Pe=g.x/g.y;H=te[2].x-te[2].y*Pe,B=te[1].x-te[1].y*Pe,V=te[0].x-te[0].y*Pe}const ke=e.getEndXY().equals(s.getStartXY())||e.getEndXY().equals(s.getEndXY()),Fe=[0,0];se=e0(H,B,V,de.unit(),ke,Fe);for(let Pe=0,Ve=Z;Pe<se;++Pe){W[Pe+Ve]=Fe[Pe];const Ke=new M;bi(h,f,W[Pe+Ve],Ke),ie[Z]=s.getClosestCoordinate(Ke,!1),M.distance(Ke,s.getCoord2D(ie[Z]))<=o&&(W[Z]=W[Pe+Ve],Z++)}F(Z<W.length+4);for(let Pe=0;Pe<Z;Pe++)W[Pe]=qb(m,W[Pe]);se=e.intersectPoint(s.getStartXY(),Fe,o);for(let Pe=0;Pe<se;Pe++)W[Z]=Fe[Pe],ie[Z++]=0;se=e.intersectPoint(s.getEndXY(),Fe,o);for(let Pe=0;Pe<se;Pe++)W[Z]=Fe[Pe],ie[Z++]=1;se=s.intersectPoint(e.getStartXY(),Fe,o);for(let Pe=0;Pe<se;Pe++)ie[Z]=Fe[Pe],W[Z++]=0;se=s.intersectPoint(e.getEndXY(),Fe,o);for(let Pe=0;Pe<se;Pe++)ie[Z]=Fe[Pe],W[Z++]=1;return Z===0?0:ol(t,e,s,W,ie,Z,i,r,n,o,a,l,u)}function iG(t,e,s,i,r,n,o,a,l,u){if(vs(s))return i0(t,e,new pt({start:s.getStartXY(),end:s.getEndXY()}),i,r,n,o,a,l,u);const c=jo(e,s);if(nl(e,s,o=Math.max(o,c)))return 0;const h=[],m=[],f=ne(M,4);{e.queryControlPoints(f);const v=ne(M,4),b=new Rt;s.canonicToWorldTransformation(b);const w=new Rt;w.setInvert(b),w.transformPoints2D(f,4,v);const S=ne(Ae,3),T=ne(Ae,3),P=ne(Ae,3),I=[0,0,0];e.queryWeights(I),uC(v,I,S,T,P);const A=ne(Ae,3);A[0].setDouble(s.getSemiMinorAxis()),A[0].sqrThis(),A[1].setDouble(s.getSemiMajorAxis()),A[1].sqrThis(),A[2].setThis(A[0]),A[2].mulThis(A[1]),A[2].negateThis();const D=$9(S,2,T,2,P,2,A,!0,de.unit(),de.unit(),h);if(D>0){let k=0;for(let R=0;R<D;R++){const O=new M;e.queryCoord2D(h[R],O);const z=s.getClosestCoordinate(O,!1),q=new M;s.queryCoord2D(z,q),M.distance(O,q)<=o&&(h[k]=h[R],m.push(z),k++)}h.length=k}}const g=[0,1];for(let v=0;v<2;v++){const b=v===0?s.getStartXY():s.getEndXY(),w=K3(e,b,de.unit(),!1,-1),S=new M;e.queryCoord2D(w,S),M.distance(b,S)<=o&&(h.push(w),m.push(g[v]))}for(let v=0;v<2;v++){const b=[0,3];{const w=s.getClosestCoordinate(f[b[v]],!1),S=new M;s.queryCoord2D(w,S),M.distance(f[b[v]],S)<=o&&(h.push(g[v]),m.push(w))}}return ol(t,e,s,h,m,h.length,i,r,n,o,a,l,u)}function lC(t,e,s,i,r,n,o,a,l,u){const c=ne(M,3);e.queryControlPoints(c);const h=ne(M,3);if(s.queryControlPoints(h),N9(c,h,3)<0)return lC(t,s,e,i,n,r,o,a,l,!u);const m=jo(e,s);if(e.isDegenerateToLineHelper(m)){const A=new pt({start:e.getStartXY(),end:e.getEndXY()}),D=i0(t,s,A,i,n,r,o,a,l,!u);if(r)for(let k=0;k<D;++k){const R=A.getCoord2D(r[k]);r[k]=e.getClosestCoordinate(R,!1)}return D}if(s.isDegenerateToLineHelper(m)){const A=new pt({start:s.getStartXY(),end:s.getEndXY()}),D=i0(t,e,A,i,r,n,o,a,l,u);if(n)for(let k=0;k<D;++k){const R=A.getCoord2D(n[k]);n[k]=s.getClosestCoordinate(R,!1)}return D}if(nl(e,s,o=Math.max(o,m)))return 0;const f=Me(3,Number.NaN);e.queryWeights(f);const g=Me(3,Number.NaN);s.queryWeights(g);const v=[1,zu(f),1],b=[1,zu(g),1],w=new de(0,1),S=new de(0,1);{const A=Yn.constructEmpty();aC(c,v,new de(0,1),A);const D=Yn.constructEmpty();aC(h,b,new de(0,1),D);const k=Math.max(A.maxDim(),D.maxDim());if(A.inflate(3*o),D.inflate(3*o),!A.intersectW(D))return 0;if(A.maxDim()<.1*k){if(oG(c,v,A,w),oG(h,b,A,S),w.isEmpty()||S.isEmpty())return 0;ug(c,v,w.vmin,w.vmax,c,v),ug(h,b,S.vmin,S.vmax,h,b)}}const T=Px(c,2,h,2,o);if(T===0)return 0;const P=[],I=[];if(T===-1){const A=ne(Ae,3),D=ne(Ae,3),k=ne(Ae,3);uC(c,v,A,D,k);const R=ne(Ae,3),O=ne(Ae,3),z=ne(Ae,3);uC(h,b,R,O,z);const q=[],U=[],V=Ex(A,2,D,2,k,2,R,2,O,2,z,2,!0,de.unit(),de.unit(),q,U);if(V>0)for(let B=0;B<V;B++){const H=new M;bi(h,b,U[B],H);const W=new M;bi(c,v,q[B],W),M.distance(W,H)<=o&&(P.push(q[B]),I.push(U[B]))}}for(let A=0;A<2;A++){let D,k,R;A===0?(D=c,k=h,R=b):(D=h,k=c,R=v);for(let O=0;O<2;O++){const z=O===0?0:D.length-1,q=new M,U=[0],V=R9(k,R,D[z],de.unit(),!1,-1,1,U);F(V===1),bi(k,R,U[0],q),M.distance(D[z],q)<=o&&(A===0?(P.push(z===0?0:1),I.push(U[0])):(I.push(z===0?0:1),P.push(U[0])))}}if(P.length===0)return 0;if(!w.equalsRange(0,1))for(let A=0;A<P.length;++A)P[A]=Oo.recalculateParentT(w.vmin,w.vmax,P[A]);if(!S.equalsRange(0,1))for(let A=0;A<I.length;++A)I[A]=Oo.recalculateParentT(S.vmin,S.vmax,I[A]);for(let A=0;A<P.length;++A)P[A]=qb(f,P[A]);for(let A=0;A<I.length;++A)I[A]=qb(g,I[A]);return ol(t,e,s,P,I,P.length,i,r,n,o,a,l,u)}function rG(t,e,s,i,r,n,o,a,l,u){if(e.isLine())return pC(t,s,new pt({start:e.getStartXY(),end:e.getEndXY()}),i,n,r,o,a,l,!u);if(s.isLine())return i0(t,e,new pt({start:s.getStartXY(),end:s.getEndXY()}),i,r,n,o,a,l,u);const c=jo(e,s);if(nl(e,s,o=Math.max(o,c)))return 0;const h=ne(M,3);e.queryControlPoints(h);const m=ne(M,3);s.queryControlPoints(m);const f=Px(h,2,m,2,o);if(f===0)return 0;const g=[],v=[];if(f===-1){const b=ne(Ae,3),w=ne(Ae,3),S=ne(Ae,3),T=[0,0,0];e.queryWeights(T),uC(h,T,b,w,S);const P=ne(zs,3);Gb(m,P);const I=Ex(b,2,w,2,S,2,[P[0].x,P[1].x,P[2].x],2,[P[0].y,P[1].y,P[2].y],2,null,0,!0,de.unit(),de.unit(),g,v);if(I>0){let A=0;for(let D=0;D<I;D++){const k=new M;s.queryCoord2D(v[D],k);const R=new M;e.queryCoord2D(g[D],R),M.distance(R,k)<=o&&(g[A]=g[D],v[A]=v[D],A++)}g.length=A,v.length=A}}for(let b=0;b<2;b++){let w;w=b===0?h:m;for(let S=0;S<2;S++){const T=S===0?0:w.length-1;let P;const I=new M;b===0?(P=tD(s,w[T],de.unit(),!1),s.queryCoord2D(P,I)):(P=K3(e,w[T],de.unit(),!1,-1),e.queryCoord2D(P,I)),M.distance(w[T],I)<=o&&(b===0?(g.push(T===0?0:1),v.push(P)):(v.push(T===0?0:1),g.push(P)))}}return ol(t,e,s,g,v,g.length,i,r,n,o,a,l,u)}function Pet(t,e,s,i=!1){const r=ne(M,3);i?(r[0].setCoordsPoint2D(t[0]),r[1].setCoordsPoint2D(t[1]),r[1].subThis(r[0]),r[2].setCoordsPoint2D(t[2]),r[2].subThis(r[0]),r[0].setCoords(0,0)):(r[0].setCoordsPoint2D(t[0]),r[1].setCoordsPoint2D(t[1]),r[2].setCoordsPoint2D(t[2])),r[0].mulThis(e[0]),r[1].mulThis(e[1]),r[2].mulThis(e[2]),s[1].setCoords(r[1].x-r[0].x,r[1].y-r[0].y),s[2].setCoordsPoint2D(r[2].sub(r[1])),s[2].subThis(s[1]),s[1].x*=2,s[1].y*=2,s[0].setCoordsPoint2D(r[0])}function uC(t,e,s,i,r){const n=Ae.constructDouble(e[0]),o=Ae.constructDouble(e[1]),a=Ae.constructDouble(e[2]);s[0].setDouble(t[0].x),s[0].mulThis(n),s[1].setDouble(t[1].x),s[1].mulThis(o),s[2].setDouble(t[2].x),s[2].mulThis(a),s[2].subThis(s[1]),s[1].subThis(s[0]),s[2].subThis(s[1]),s[1].ldexpThis(1),i[0].setDouble(t[0].y),i[0].mulThis(n),i[1].setDouble(t[1].y),i[1].mulThis(o),i[2].setDouble(t[2].y),i[2].mulThis(a),i[2].subThis(i[1]),i[1].subThis(i[0]),i[2].subThis(i[1]),i[1].ldexpThis(1),r[0].setDouble(e[0]),r[1].setDouble(e[1]),r[2].setThis(r[1]),r[2].ldexpThis(1),r[2].negateThis(),r[2].addThis(r[0]),r[2].addDoubleThis(e[2]),r[1].subThis(r[0]),r[1].ldexpThis(1)}function x1e(t,e,s){for(let i=0;i<3;++i)s[i].setCoordsPoint2DZ(t[i].mul(e[i]),e[i])}function w1e(t,e,s,i){if(s===0)return i.assign(t[0]),e[0];if(s===1)return i.assign(t[2]),e[2];const r=[t[0].x*e[0],t[1].x*e[1],t[2].x*e[2]],n=[t[0].y*e[0],t[1].y*e[1],t[2].y*e[2]],o=[e[0],e[1],e[2]],a=s;let l,u,c;if(s<=.5){const h=vn(r[0],r[1],a),m=vn(r[1],r[2],a);l=zt(h,m,a);const f=vn(n[0],n[1],a),g=vn(n[1],n[2],a);u=zt(f,g,a);const v=vn(o[0],o[1],a),b=vn(o[1],o[2],a);c=vn(v,b,a)}else{const h=kr(r[0],r[1],a),m=kr(r[1],r[2],a);l=kr(h,m,a);const f=kr(n[0],n[1],a),g=kr(n[1],n[2],a);u=kr(f,g,a);const v=kr(o[0],o[1],a),b=kr(o[1],o[2],a);c=kr(v,b,a)}return l/=c,u/=c,i.setCoords(l,u),k9(t,i),c}function Tet(t,e,s){const i=ne(M,3);t.queryControlPoints(i);const r=[0,0,0];t.queryWeights(r),Iet([je.constructPoint2D(i[0]),je.constructPoint2D(i[1]),je.constructPoint2D(i[2])],[new le(r[0]),new le(r[1]),new le(r[2])],e,s)}function Iet(t,e,s,i){if(s.value()===0)return void i.setE(t[0]);if(s.value()===1)return void i.setE(t[2]);const r=[t[0].x.mulE(e[0]),t[1].x.mulE(e[1]),t[2].x.mulE(e[2])],n=[t[0].y.mulE(e[0]),t[1].y.mulE(e[1]),t[2].y.mulE(e[2])],o=[e[0].clone(),e[1].clone(),e[2].clone()],a=new le,l=new le,u=new le;if(s.value()<=.5){const h=Pu(r[0],r[1],s),m=Pu(r[1],r[2],s);a.setE(Pu(h,m,s));const f=Pu(n[0],n[1],s),g=Pu(n[1],n[2],s);l.setE(Pu(f,g,s));const v=Pu(o[0],o[1],s),b=Pu(o[1],o[2],s);u.setE(Pu(v,b,s))}else{const h=Tu(r[0],r[1],s),m=Tu(r[1],r[2],s);a.setE(Tu(h,m,s));const f=Tu(n[0],n[1],s),g=Tu(n[1],n[2],s);l.setE(Tu(f,g,s));const v=Tu(o[0],o[1],s),b=Tu(o[1],o[2],s);u.setE(Tu(v,b,s))}a.divThisE(u),l.divThisE(u);const c=new M(a.value(),l.value());k9([t[0].value(),t[1].value(),t[2].value()],c),i.x.set(c.x,a.eps()),i.y.set(c.y,l.eps())}function nG(t,e){return e.setCoords(t.x/t.z,t.y/t.z),t.z}function bi(t,e,s,i,r){if(r){if(s<0)return void ga(new pt({start:t[0],end:t[0].add(tG(t,e,0).getUnitVector())}),s,i);if(s>1)return void ga(new pt({start:t[2],end:t[2].add(tG(t,e,1).getUnitVector())}),s-1,i)}w1e(t,e,s,i)}function oG(t,e,s,i){i.setEmpty();const r=[];r.push(new de(0,1));const n=.5*Math.max(s.width(),s.height());for(;r.length;){const o=r.at(-1);r.pop();const a=new Yn;if(aC(t,e,o,a),a.isIntersectingW(s)){const l=Math.max(a.width(),a.height());if(s.containsW(a)||l<=n||o.width()<1e-12)i.merge(o);else{const u=o.getCenter();r.push(de.construct(o.vmin,u)),r.push(de.construct(u,o.vmax))}}}}function zu(t){return t[1]/Math.sqrt(t[0]*t[2])}function qb(t,e){const s=Math.sqrt(t[2]/t[0]);return e/zt(s,1,e)}function cC(t,e){const s=Math.sqrt(t[0]/t[2]);return e/zt(s,1,e)}function aG(t,e,s,i){F(e>=0&&e<=1),new gt().setCoordsPoint3D(t[0]),new gt().setCoordsPoint3D(t[1]),new gt().setCoordsPoint3D(t[2]);const r=new gt,n=new gt,o=new gt;dE(3,t[0],t[1],e,r),dE(3,t[1],t[2],e,n),dE(3,r,n,e,o);const a=t[2].clone();s&&(s[0].assign(t[0]),s[1].assign(r),s[2].assign(o)),i&&(i[0].assign(o),i[1].assign(n),i[2].assign(a))}function lG(t,e,s,i){const r=[t[0],t[1],t[2]];F(e>=0&&e<=1&&s!==i);const n=zt(r[0],r[1],e),o=zt(r[1],r[2],e),a=zt(n,o,e);s&&(s[0]=r[0],s[1]=n,s[2]=a),i&&(i[0]=a,i[1]=o,i[2]=r[2])}function k9(t,e){const s=de.constructEmpty();s.vmin=s.vmax=t[0].x,s.mergeNeCoordinate(t[1].x),s.mergeNeCoordinate(t[2].x),e.x=ys(e.x,s.vmin,s.vmax),s.vmin=s.vmax=t[0].y,s.mergeNeCoordinate(t[1].y),s.mergeNeCoordinate(t[2].y),e.y=ys(e.y,s.vmin,s.vmax)}function uG(t,e){const s=new de;s.vmin=s.vmax=t[0].x,s.mergeNeCoordinate(t[1].x),s.mergeNeCoordinate(t[2].x),e[0].x=ys(e[0].x,s.vmin,s.vmax),e[1].x=ys(e[1].x,s.vmin,s.vmax),e[2].x=ys(e[2].x,s.vmin,s.vmax),s.vmin=s.vmax=t[0].y,s.mergeNeCoordinate(t[1].y),s.mergeNeCoordinate(t[2].y),e[0].y=ys(e[0].y,s.vmin,s.vmax),e[1].y=ys(e[1].y,s.vmin,s.vmax),e[2].y=ys(e[2].y,s.vmin,s.vmax)}let Met=class{constructor(){this.area=Number.NaN,this.centroid_x=Number.NaN,this.centroid_y=0,this.specialPoints=[],this.specialPointsLength=[]}specialPointsCount(){return this.specialPoints.length}},Aet=class{constructor(e,s){this.b=e,this.len=s}getMaxDerivative(){return 1}getValue(e,s){return e===0?this.len-eD(this.b,s,!1):0}getError(e){return F(0),0}};function Net(t,e,s,i,r){let n=!0;const o=ne(M,3);t.queryControlPoints(o);let a=n?0:1,l=o[1][a]-o[0][a],u=o[2][a]-o[0][a];const c=Vb(5,e,s,i,r,m=>{let f;if(m<=.5){const g=vn(0,l,m),v=vn(l,u,m);f=vn(g,v,m)}else{const g=kr(0,l,m),v=kr(l,u,m);f=kr(g,v,m)}return f*hC(o,1,m).length()});n=!1,a=n?0:1,l=o[1][a]-o[0][a],u=o[2][a]-o[0][a];const h=Vb(5,e,s,i,r,m=>{let f;if(m<=.5){const g=vn(0,l,m),v=vn(l,u,m);f=vn(g,v,m)}else{const g=kr(0,l,m),v=kr(l,u,m);f=kr(g,v,m)}return f*hC(o,1,m).length()});return new M(c,h)}function cM(t){t.m_cachedValues=null}function Det(t,e){e.m_cachedValues=be(t.m_cachedValues,t.m_cachedValues=e.m_cachedValues)}function cG(t){if(t.m_cachedValues)return t.m_cachedValues;const e=new Met;return S1e(t,e.specialPoints),P1e(t,e),e}function S1e(t,e){const s=ne(M,3);t.queryControlPoints(s);const i=ne(le,8);i[0].set(0);let r=1;{const n=ne(le,3);Uet(s,n,!1);const o=ne(le,2),a=new de(0,1);let l=rC(n[2].mul(2),n[1],a,o[0]);l<0&&(l=0);for(let u=0;u<l;u++)bs(o[u].value(),0,1)||(i[r]=o[u],r++)}{const n=ne(le,3);Bet(s,n,!1);const o=ne(le,2),a=new de(0,1);let l=rC(n[2].mul(2),n[1],a,o[0]);l<0&&(l=0);for(let u=0;u<l;u++)bs(o[u].value(),0,1)||(i[r]=o[u],r++)}if(i[r].set(1),r++,r>2){Qc(i,0,r,(l,u)=>l.value()-u.value());let n=0,o=i[0].value(),a=1;for(let l=1;l<r;l++)i[l].eq(i[l-1])?(o+=i[l].value(),a++):(a>1&&(o/=a,i[n].set(o)),n++,i[n]=i[l],o=i[l].value(),a=1);n++,r=n}i[0].set(0),i[r-1].set(1),e.length=r;for(let n=0;n<r;n++)e[n]=i[n].value()}function eD(t,e,s){const i=ne(M,3);return t.queryControlPoints(i),E1e(i,e,s)}function E1e(t,e,s){if(s){if(e<0)return e;if(e>1)return e-1+E1e(t,1,!1)}if(e===1)return Wie(t);const i=ne(M,3);return mG(t,e,i,null),Wie(i)}function Wie(t){if(t[0].equals(t[1]))return M.distance(t[2],t[0]);if(t[1].equals(t[2]))return M.distance(t[0],t[2]);const e=M.distance(t[0],t[1])+M.distance(t[2],t[1]),s=M.distance(t[0],t[2]);if(e-s<=e*Number.EPSILON)return s;const i=1,r=ne(M,3);O9(t,r,!0);const n=4*(Pt(r[2].x)+Pt(r[2].y)),o=2*(r[2].x*r[1].x+r[2].y*r[1].y),a=Pt(r[1].x)+Pt(r[1].y);if(1e-14*(Math.abs(o)+Math.abs(a))>=Math.abs(n))return 1e-14*Math.abs(a)>=Math.abs(o)?Math.sqrt(a)*i:2/(3*o)*(Math.pow(o*i+a,1.5)-Math.pow(a,1.5));const l=o/n,u=a/n,c=u-l*l,h=i+l;if(c===0)return l>=0&&h>=0||l<=0&&h<=0?Math.abs(.5*Math.sqrt(n)*(h*h-l*l)):.5*Math.sqrt(n)*(h*h+l*l);const m=Math.sqrt(c+h*h),f=Math.sqrt(u);return .5*Math.sqrt(n)*(h*m-l*f+c*Math.log(Math.abs((h+m)/(l+f))))}function Zie(t,e){const s=ys(e,0,1);let i=hC(t,1,s);return i.isZero()&&(i=hC(t,2,s)),i}function h2(t,e,s){const i=ne(M,3);return t.queryControlPoints(i),hC(i,e,s)}function hC(t,e,s){if(e===1){const i=t[1].sub(t[0]).mul(1-s).add(t[2].sub(t[1]).mul(s));return i.mulThis(2),i}return e===2?t[2].sub(t[1]).sub(t[1].sub(t[0]).mul(2)):M.construct(0,0)}function $et(t,e,s){{const i=je.constructPoint2D(t[1]).subE(je.constructPoint2D(t[0])),r=new le(1).subE(s),n=je.constructPoint2D(t[2]).subE(je.constructPoint2D(t[1])),o=i.mulE(r).addE(n.mulE(s));return o.mulThisE(new le(2)),o}}function Ret(t,e,s){const i=eD(t,1,!1);if(e<=0)return e;if(e>=i)return e-i+1;const r=[0];return Cg(new Aet(t,e),de.unit(),1,r)!==1&&Ce(""),r[0]}function Qie(t){const e=ne(M,3);return t.queryControlPoints(e),C1e(e)}function C1e(t){return-t[1].sub(t[0]).crossProduct(t[2].sub(t[0]))/3}function ket(t){const e=M.distance(t.getStartXY(),t.getEndXY()),s=t.calculateUpperLength2D();return s-e<=8*Number.EPSILON*s}function Jie(t){return t.m_cachedValues}function P1e(t,e){t.m_cachedValues=e}function tD(t,e,s,i,r){KE(de.unit().contains(s),"QuadraticBezierHelper::getClosestCoordinateSegment");const n=ne(M,3);t.queryControlPoints(n);let o=Number.MAX_VALUE;const a=[0],l=fR(n,e,a);if(s.containsCoordinate(a[0]))o=M.distance(e,l);else{a[0]=s.vmin,Vu(n,a[0],l),o=M.distance(l,e);const u=new M;Vu(n,s.vmax,u);const c=M.distance(u,e);o>c&&(l.setCoordsPoint2D(u),a[0]=s.vmax,o=c)}if(!i)return a[0];if(s.vmin<=0){const u=new M;t.queryCoord2DExtended(-1,u,!0);const c=new M;t.queryCoord2D(s.vmin,c);const h=new pt({start:u,end:c}),m=h.getClosestCoordinate(e,!0);if(m<1){const f=h.getCoord2D(m),g=M.distance(f,e);g<o&&(o=g,a[0]=m-1,l.assign(f))}}if(s.vmin>=1){const u=new M;t.queryCoord2DExtended(2,u,!0);const c=new M;t.queryCoord2D(s.vmax,c);const h=new pt({start:c,end:u}),m=h.getClosestCoordinate(e,!0);if(m>0){const f=h.getCoord2D(m),g=M.distance(f,e);g<o&&(o=g,a[0]=1+m,l.assign(f))}}return a[0]}function fR(t,e,s){const i=t[2].sub(t[1]).sub(t[1].sub(t[0])),r=t[1].sub(t[0]),n=t[0].sub(e),o=n.dotProduct(r),a=n.dotProduct(i)+2*r.dotProduct(r),l=3*r.dotProduct(i),u=i.dotProduct(i),c=Me(3,Number.NaN),h=r1e(u,l,a,o,de.unit(),!1,c),m=t[0].clone();let f=0,g=M.sqrDistance(t[0],e),v=M.sqrDistance(t[2],e);v<g&&(f=1,m.assign(t[2]),g=v);for(let b=0;b<h;b++){const w=new M;Vu(t,c[b],w),v=M.sqrDistance(w,e),v<g&&(g=v,m.assign(w),f=c[b])}return s&&(s[0]=f),m}function Fet(t,e,s,i,r,n){const o=new Yn;if(Oet(t,de.unit(),o),o.inflate(r),!o.isIntersectingPoint2D(e))return 0;const a=new M,l=tD(t,e,de.unit(),!1);return t.queryCoord2D(l,a),M.distance(a,e)<=r?(i&&(i[0]=l),1):0}function Oet(t,e,s){const i=ne(M,3);t.queryControlPoints(i),mC(i,e,s)}function mC(t,e,s){if(e.equalsRange(0,1))return void s.setFromPoints(t,3);const i=ne(M,3);dC(t,e.vmin,e.vmax,i),s.setFromPoints(i,3)}function Kie(t,e,s){s.setEmpty();const i=[];i.push(new de(0,1));const r=.5*Math.max(e.width(),e.height());for(;i.length;){const n=i.at(-1);i.pop();const o=new Yn;if(mC(t,n,o),o.isIntersectingW(e)){const a=Math.max(o.width(),o.height());if(e.containsW(o)||a<=r||n.width()<1e-12)s.merge(n);else{const l=n.getCenter();i.push(de.construct(n.vmin,l)),i.push(de.construct(l,n.vmax))}}}}function hG(t){const e=ne(M,3);t.queryControlPoints(e);const s=T1e(e);return s&&(t.m_cp.setCoordsPoint2D(e[1]),t.afterCompletedModification()),s}function T1e(t){let e=!1;for(let s=0;s<2;s++){const i=Gs(t[0][s],t[2][s]);i>0?(Gs(t[0][s],t[1][s])<0&&(t[1][s]=t[0][s],e=!0),Gs(t[1][s],t[2][s])<0&&(t[1][s]=t[2][s],e=!0)):i<0?(Gs(t[0][s],t[1][s])>0&&(t[1][s]=t[0][s],e=!0),Gs(t[1][s],t[2][s])>0&&(t[1][s]=t[2][s],e=!0)):t[1][s]!==t[0][s]&&(t[1][s]=t[0][s],e=!0)}return e}function Let(t,e,s){s===void 0&&(s=e,e=0);const i=new M;if(e<0||s>1)return i.setNAN(),i;if(e>s&&ee("calculate_sub_weighted_centroid"),e===s||t.isDegenerate(0))return i.setCoords(0,0),i;const r=cG(t),n=Bh(t),o=Math.min(n/t.calculateUpperLength2D(),1e-7);let a=e,l=0;for(let u=1,c=r.specialPointsCount();u<c;u++)if(e<r.specialPoints[u]){l=u-1;break}i.setCoords(0,0);for(let u=l+1,c=r.specialPointsCount();u<c;u++){const h=Math.min(r.specialPoints[u],s),m=Net(t,a,h,o,n);if(i.addThis(m),a=h,s<=r.specialPoints[u])break}return i.add(t.getStartXY().mul(t.calculateLength2D()))}function mG(t,e,s,i){new M().setCoordsPoint2D(t[0]),new M().setCoordsPoint2D(t[1]),new M().setCoordsPoint2D(t[2]);const r=new M,n=new M,o=new M;if(wi(t[0],t[1],e,r),wi(t[1],t[2],e,n),wi(r,n,e,o),s&&(s[0].assign(t[0]),s[1].assign(r),s[2].assign(o)),i){const a=t[2];i[0].assign(o),i[1].assign(n),i[2].assign(a)}}function dC(t,e,s,i){if(e===s){const n=new M;return Vu(t,e,n),i[0]=n,i[1]=n,void(i[2]=n)}const r=ne(M,3);mG(t,s,r,null),mG(r,e/s,null,r),Vu(t,e,r[0]),Vu(t,s,r[2]),i[0].setCoordsPoint2D(r[0]),i[1].setCoordsPoint2D(r[1]),i[2].setCoordsPoint2D(r[2])}function Vet(t,e,s,i){if(e.isEqual(t.m_XStart,t.m_YStart)&&s.isEqual(t.m_XEnd,t.m_YEnd))return;const r=!!i&&t.isMonotoneQuickAndDirty(),n=new Rt,o=ne(M,3);o[0].setCoords(t.m_XStart,t.m_YStart),o[2].setCoords(t.m_XEnd,t.m_YEnd);const a=new M;a.setSub(o[2],o[0]),a.leftPerpendicularThis(),o[1].setAdd(o[0],a);const l=ne(M,3);l[0].setCoordsPoint2D(e),l[2].setCoordsPoint2D(s),a.setSub(l[2],l[0]),a.leftPerpendicularThis(),l[1].setAdd(l[0],a),n.setFromTwoTriangles(o,l)?n.transformInPlace(t.m_cp):wi(e,s,.5,t.m_cp),t.changeEndPoints2D(e,s),r&&hG(t)}function qet(t){return t.getStartXY().norm(1)+t.getEndXY().norm(1)+t.m_cp.norm(1)}function ere(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return t?4:2}else if(rl(e,s))return 1;return pC(t,e,s,null,null,null,i,r??!1,!0,!1)!==0?4:0}function tre(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return t?4:2}else if(rl(e,s))return 1;return dG(t,e,s,null,null,null,i,r??!1,!0,!1)!==0?4:0}function Get(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return 2}else if(rl(e,s))return 1;return F9(t,e,s,null,null,null,i,r??!1,!0,!1)!==0?4:0}function pC(t,e,s,i,r,n,o,a,l,u){if(r!=null&&(r.length=0),n!==null&&(n.length=0),i!==null&&(i.length=0),s.isDegenerate(0)){const O=[0,0],z=e.intersectPoint(s.getStartXY(),O,o);if(z>0){if(r!==null)for(let q=0;q<z;q++)r.push(O[q]);if(n!==null)for(let q=0;q<z;q++)n.push(0);if(i!==null)for(let q=0;q<z;q++){const U=new M;e.queryCoord2D(O[q],U),i.push(U)}}return z}const c=jo(e,s);if(o=Math.max(o,c),e.isDegenerateToLineHelper(c)){const O=new pt({start:e.getStartXY(),end:e.getEndXY()}),z=dR(O,s,i,r,n,o,a,u);if(r)for(let q=0;q<z;++q){const U=O.getCoord2D(r[q]);r[q]=e.getClosestCoordinate(U,!1)}return z}if(nl(e,s,o))return 0;const h=zs.constructPoint2D(s.getStartXY()),m=zs.constructPoint2D(s.getEndXY()).sub(h),f=m.clone();f.leftPerpendicularThis();const g=zs.constructPoint2D(e.m_cp).sub(zs.constructPoint2D(e.getStartXY())),v=zs.constructPoint2D(e.getEndXY()).sub(zs.constructPoint2D(e.m_cp));let b=g.dotProduct(f).toDouble(),w=v.sub(g).dotProduct(f).toDouble();const S=Me(12,Number.NaN),T=Me(12,Number.NaN);let P=$Ke(w,b,de.unit(),S);P<0&&(S[0]=0,S[1]=1,P=2);let I,A=0;for(let O=0,z=A;O<P;++O){const q=e.getCoord2D(S[O+z]);T[A]=s.getClosestCoordinate(q,!1),M.distance(q,s.getCoord2D(T[A]))<=o&&(S[A]=S[O+z],A++)}const D=ne(M,3);e.queryControlPoints(D);{const O=ne(zs,3);if(Gb(D,O,!1),O[0]=O[0].sub(h),m.x.abs().gte(m.y.abs())){const z=m.y.div(m.x);w=O[2].y.sub(O[2].x.mul(z)).toDouble(),b=O[1].y.sub(O[1].x.mul(z)).toDouble(),I=O[0].y.sub(O[0].x.mul(z)).toDouble()}else{const z=m.x.div(m.y);w=O[2].x.sub(O[2].y.mul(z)).toDouble(),b=O[1].x.sub(O[1].y.mul(z)).toDouble(),I=O[0].x.sub(O[0].y.mul(z)).toDouble()}}const k=e.getEndXY().equals(s.getStartXY())||e.getEndXY().equals(s.getEndXY()),R=[0,0];P=e0(w,b,I,de.unit(),k,R);for(let O=0,z=A;O<P;++O){S[O+z]=R[O];const q=e.getCoord2D(S[O+z]);T[A]=s.getClosestCoordinate(q,!1),M.distance(q,s.getCoord2D(T[A]))<=o&&(S[A]=S[O+z],A++)}F(A<S.length+4),P=e.intersectPoint(s.getStartXY(),R,o);for(let O=0;O<P;O++)S[A]=R[O],T[A++]=0;P=e.intersectPoint(s.getEndXY(),R,o);for(let O=0;O<P;O++)S[A]=R[O],T[A++]=1;P=s.intersectPoint(e.getStartXY(),R,o);for(let O=0;O<P;O++)T[A]=R[O],S[A++]=0;P=s.intersectPoint(e.getEndXY(),R,o);for(let O=0;O<P;O++)T[A]=R[O],S[A++]=0;return A===0?0:ol(t,e,s,S,T,A,i,r,n,o,a,l,u)}function dG(t,e,s,i,r,n,o,a,l,u){if(vs(s))return pC(t,e,new pt({start:s.getStartXY(),end:s.getEndXY()}),i,r,n,o,a,l,u);const c=jo(e,s);if(nl(e,s,o=Math.max(o,c)))return 0;const h=[],m=[],f=ne(M,3);{e.queryControlPoints(f);const v=ne(M,3),b=new Rt;s.canonicToWorldTransformation(b);const w=new Rt;w.setInvert(b),w.transformPoints2D(f,3,v);const S=ne(zs,3);Gb(v,S);const T=[S[0].x,S[1].x,S[2].x],P=[S[0].y,S[1].y,S[2].y],I=ne(Ae,3);I[0].setDouble(s.getSemiMinorAxis()),I[0].sqrThis(),I[1].setDouble(s.getSemiMajorAxis()),I[1].sqrThis(),I[2]=I[0],I[2].mul(I[1]),I[2].negate();const A=$9(T,2,P,2,null,0,I,!0,de.unit(),de.unit(),h);if(A>0){let D=0;for(let k=0;k<A;k++){const R=new M;e.queryCoord2D(h[k],R);const O=s.getClosestCoordinate(R,!1),z=new M;s.queryCoord2D(O,z),M.distance(R,z)<=o&&(h[D]=h[k],m.push(O),D++)}h.length=D}}const g=[0,1];for(let v=0;v<2;v++){const b=v===0?s.getStartXY():s.getEndXY(),w=[0];fR(f,b,w);const S=new M;Vu(f,w[0],S),M.distance(b,S)<=o&&(h.push(w[0]),m.push(g[v]))}for(let v=0;v<2;v++){const b=[0,2];{const w=s.getClosestCoordinate(f[b[v]],!1),S=new M;s.queryCoord2D(w,S),M.distance(f[b[v]],S)<=o&&(h.push(g[v]),m.push(w))}}return ol(t,e,s,h,m,h.length,i,r,n,o,a,l,u)}function F9(t,e,s,i,r,n,o,a,l,u){const c=ne(M,3);e.queryControlPoints(c);const h=ne(M,3);if(s.queryControlPoints(h),N9(c,h,3)<0)return F9(t,s,e,i,n,r,o,a,l,!u);const m=jo(e,s);if(nl(e,s,o=Math.max(o,m)))return 0;if(Jet(e,s,i,r,n,o,a,l,u))return 2;const f=new de(0,1),g=new de(0,1);{const S=new Yn;mC(c,de.unit(),S);const T=new Yn;mC(h,de.unit(),T);const P=Math.max(S.maxDim(),T.maxDim());if(S.inflate(3*o),T.inflate(3*o),!S.intersectW(T))return 0;if(S.maxDim()<.1*P){if(Kie(c,S,f),Kie(h,S,g),f.isEmpty()||g.isEmpty())return 0;dC(c,f.vmin,f.vmax,c),dC(h,g.vmin,g.vmax,h)}}const v=Px(c,2,h,2,o);if(v===0)return 0;const b=[],w=[];if(v===-1){const S=ne(zs,3);Gb(c,S);const T=[S[0].x,S[1].x,S[2].x],P=[S[0].y,S[1].y,S[2].y],I=ne(zs,3);Gb(h,I);const A=Ex(T,2,P,2,null,0,[I[0].x,I[1].x,I[2].x],2,[I[0].y,I[1].y,I[2].y],2,null,0,!0,de.unit(),de.unit(),b,w,u);if(A>0){let D=0;for(let k=0;k<A;k++){const R=new M,O=new M;Vu(h,w[k],O),Vu(c,b[k],R),M.distance(R,O)<=o&&(b[D]=b[k],w[D]=w[k],D++)}b.length=D,w.length=D}}for(let S=0;S<2;S++){const T=S===0?c:h,P=S===0?h:c;for(let I=0;I<2;I++){const A=I===0?0:2,D=[0];fR(P,T[A],D);const k=new M;Vu(P,D[0],k),M.distance(T[A],k)<=o&&(S===0?(b.push(A===0?0:1),w.push(D[0])):(w.push(A===0?0:1),b.push(D[0])))}}if(b.length===0)return 0;if(!f.equalsRange(0,1))for(let S=0;S<b.length;++S)b[S]=t0.recalculateParentT(f.vmin,f.vmax,b[S]);if(!g.equalsRange(0,1))for(let S=0;S<w.length;++S)w[S]=t0.recalculateParentT(g.vmin,g.vmax,w[S]);return ol(t,e,s,b,w,b.length,i,r,n,o,a,l,u)}function O9(t,e,s=!1){const i=t[1].sub(t[0]);e[1].assign(i.mul(2)),e[2].assign(t[2].sub(t[1]).sub(i)),s?e[0].setCoords(0,0):e[0].assign(t[0])}function zet(t,e,s=!1){const i=ne(M,3);t.queryControlPoints(i),O9(i,e,s)}function Uet(t,e,s=!1){const r=new le(t[1][0]).subE(new le(t[0][0]));e[1]=r.mul(2),e[2]=new le(t[2][0]).subE(new le(t[1][0])).subE(r),s?e[0].set(0):e[0].set(t[0][0])}function Bet(t,e,s=!1){const r=new le(t[1][1]).subE(new le(t[0][1]));e[1]=r.mul(2),e[2]=new le(t[2][1]).subE(new le(t[1][1])).subE(r),s?e[0].set(0):e[0].set(t[0][1])}function Gb(t,e,s=!1){const i=zs.constructPoint2D(t[1]),r=i.sub(zs.constructPoint2D(t[0]));e[1]=r.mul(Ae.constructInt32(2)),e[2]=zs.constructPoint2D(t[2]).sub(i).sub(r),e[0]=s?new zs(zn,zn):zs.constructPoint2D(t[0])}function Vu(t,e,s,i){if(i){if(e<0)return void ga(new pt({start:t[0],end:t[0].add(Zie(t,0).getUnitVector())}),e,s);if(e>1)return void ga(new pt({start:t[2],end:t[2].add(Zie(t,1).getUnitVector())}),e-1,s)}if(e<=.5){const r=t[1].clone(),n=new M;Li(2,t[0],r,e,n);const o=new M;Li(2,r,t[2],e,o);const a=new M;Li(2,n,o,e,a),s.assign(a)}else{const r=t[1].clone(),n=new M;Vi(2,t[0],r,e,n);const o=new M;Vi(2,r,t[2],e,o);const a=new M;Vi(2,n,o,e,a),s.assign(a)}}function jet(t,e,s){const i=ne(M,3);t.queryControlPoints(i),Het(i,e,s)}function Het(t,e,s){if(e.value()<=.5){const i=je.constructPoint2D(t[1]),r=new je;Rl(2,je.constructPoint2D(t[0]),i,e,r);const n=new je;Rl(2,i,je.constructPoint2D(t[2]),e,n);const o=new je;Rl(2,r,n,e,o),s.setE(o)}else{const i=je.constructPoint2D(t[1]),r=new je;kl(2,je.constructPoint2D(t[0]),i,e,r);const n=new je;kl(2,i,je.constructPoint2D(t[2]),e,n);const o=new je;kl(2,r,n,e,o),s.setE(o)}}function Yet(t,e,s){const i=ne(M,4);t.queryControlPoints(i),Xet(i,e,s)}function Xet(t,e,s){e.value()<0&&e.set(0,e.eps()),e.value()>1&&e.set(1,e.eps()),s.setE($et(t,1,e))}function Wet(t,e){e[0].assign(t[0]),e[3].assign(t[2]),wi(t[0],t[1],2/3,e[1]),wi(t[1],t[2],1/3,e[2])}function Zet(t,e){const s=ne(M,3);t.queryControlPoints(s);const i=M.sqrDistance(s[1],s[0]),r=M.sqrDistance(s[1],s[2]);let n=s[0].clone(),o=i;i>r&&(n=s[2].clone(),o=r);let a=!1;return o<=e&&o!==0&&(a=!0,t.setControlPoint1(n)),a}function Qet(t,e){if(!e)return!1;const s=ne(M,3);t.queryControlPoints(s);const i=M.sqrDistance(s[1],s[0]),r=M.sqrDistance(s[1],s[2]);s[0].clone();let n=i;return i>r&&(s[2].clone(),n=r),n<=e&&n!==0}function Jet(t,e,s,i,r,n,o,a,l){const u=ne(M,3);t.queryControlPoints(u);const c=ne(M,3);if(e.queryControlPoints(c),u[0].equals(c[0])){if(u[1].equals(c[1])&&u[2].equals(c[2]))return s&&(s.length=0,s.push(u[0]),s.push(u[2])),i&&(i.length=0,i.push(0),i.push(1)),r&&(r.length=0,r.push(0),r.push(1)),!0;if(!u[0].equals(c[2]))return!1}return!!(u[0].equals(c[2])&&u[1].equals(c[1])&&u[2].equals(c[0]))&&(i&&(i.length=0,i.push(0),i.push(1),l&&(i[1]=be(i[0],i[0]=i[1]))),r&&(r.length=0,r.push(1),r.push(0),l&&(r[1]=be(r[0],r[0]=r[1]))),s&&(s.length=0,s.push(u[0]),s.push(u[2]),l&&(s[1]=be(s[0],s[0]=s[1]))),!0)}var hM=Es;let Hl=class I1e extends EP{constructor(e){e&&e.cp?(super({start:e.cp[0],end:e.cp[3],vd:e.vd}),this.m_cp=ne(M,2),this.m_cp[0].assign(e.cp[1]),this.m_cp[1].assign(e.cp[2])):e===void 0||oR(e,"vd")?(super({vd:e==null?void 0:e.vd,XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_cp=ne(M,2),this.m_cp[0].setCoords(0,0),this.m_cp[1].setCoords(0,0)):e.from?(super({start:e.from,end:e.to,vd:e.vd}),this.m_cp=ne(M,2),this.m_cp[0].assign(e.cp1),this.m_cp[1].assign(e.cp2)):(super({XStart:0,YStart:0,XEnd:0,YEnd:0,vd:e.vd}),Ce("unrecognized constructor params"),this.m_cp=ne(M,2),this.m_cp[0].setCoords(0,0),this.m_cp[1].setCoords(0,0)),this.m_cachedValues=0}getBoundary(){return Bc(this)}construct(e,s,i,r){this.m_XStart=e.x,this.m_YStart=e.y,this.m_XEnd=r.x,this.m_YEnd=r.y,this.m_cp[0].assign(s),this.m_cp[1].assign(i),this.afterCompletedModification()}constructPoints(e){this.m_XStart=e[0].x,this.m_YStart=e[0].y,this.m_XEnd=e[3].x,this.m_YEnd=e[3].y,this.m_cp[0].assign(e[1]),this.m_cp[1].assign(e[2]),this.afterCompletedModification()}constructFromQuadratic(e){const s=ne(M,4);Wet(e,s),this.constructPoints(s)}constructFromQuadraticSegment(e){this.dropAllAttributes(),this.assignVertexDescription(e.getDescription()),this.m_XStart=e.getStartX(),this.m_YStart=e.getStartY(),this.m_XEnd=e.getEndX(),this.m_YEnd=e.getEndY(),dE(2,e.getStartXY(),e.getControlPoint1(),2/3,this.m_cp[0]),dE(2,e.getControlPoint1(),e.getEndXY(),1/3,this.m_cp[1]),this.afterCompletedModification(),J0e(this,e)}getGeometryType(){return G.enumBezier}queryEnvelope(e){if(e.m_EnvelopeType!==2)return void F(0);if(e.setCoords(this.getStartXY()),e.mergeNe(this.getEndXY()),e.contains(this.m_cp[0])&&e.contains(this.m_cp[1]))return;const s=sre(this);if(s!==null){const a=new M;for(const l of s.specialPoints)this.queryCoord2D(l,a),e.mergeNe(a);return}const i=ne(le,8),r=ne(M,4);this.queryControlPoints(r);const n=L1e(r,i),o=new M;for(let a=1;a<n-1;a++)this.queryCoord2D(i[a].value(),o),e.mergeNe(o)}applyTransformation(e){if(e.m_TransformationType===1){const s=ne(M,4);return this.queryControlPoints(s),e.transformPoints2D(s,4,s),this.setStartXY(s[0]),this.m_cp[0].assign(s[1]),this.m_cp[1].assign(s[2]),this.setEndXY(s[3]),void cL(this)}F(0)}createInstance(){return new I1e({vd:this.m_description})}calculateLength2D(){return fC(this,1,!1)}calculateLowerLength2D(){return M.distance(this.getStartXY(),this.getEndXY())}calculateUpperLength2D(){return M.distance(this.getStartXY(),this.m_cp[0])+M.distance(this.m_cp[0],this.m_cp[1])+M.distance(this.getEndXY(),this.m_cp[1])}queryCoord2D(e,s){return this.queryCoord2DExtends(e,s,!0)}queryCoord2DExtends(e,s,i){const r=ne(M,4);this.queryControlPoints(r),ri(r,e,s,i)}queryCoord2DE(e,s){dtt(this,e,s)}getCoordX(e){if(e<0||e>1){const a=new M;return this.queryCoord2DExtends(e,a,!0),a.x}const s=zt(this.getStartX(),this.m_cp[0].x,e),i=zt(this.m_cp[0].x,this.m_cp[1].x,e),r=zt(this.m_cp[1].x,this.getEndX(),e),n=zt(s,i,e),o=zt(i,r,e);return zt(n,o,e)}getCoordY(e){if(e<0||e>1){const a=new M;return this.queryCoord2DExtends(e,a,!0),a.y}const s=zt(this.getStartY(),this.m_cp[0].y,e),i=zt(this.m_cp[0].y,this.m_cp[1].y,e),r=zt(this.m_cp[1].y,this.getEndY(),e),n=zt(s,i,e),o=zt(i,r,e);return zt(n,o,e)}cut(e,s,i){const r=new ut;return this.queryCut(e,s,r,i),r.releaseSegment()}queryCut(e,s,i,r){const n=i.createCubicBezier();if(this.cutBezierIgnoreAttributes(e,s,n),r)return;n.assignVertexDescription(this.m_description);const o=this.m_description.getAttributeCount();if(o>1){for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=hM.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(e,l,c);n.setStartAttribute(l,c,h)}}for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=hM.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(s,l,c);n.setEndAttribute(l,c,h)}}}}queryDerivative(e,s){k1e(this,e,s)}cutBezierIgnoreAttributes(e,s,i){(e<0||s>1||e>s)&&ee("Cubic_bezier.cut_bezier_ignore_attributes");const r=ne(M,4);this.queryControlPoints(r);const n=ne(M,4);r0(r,e,s,n),i.setControlPoints(n)}splitBezierIgnoreAttributes(e,s,i){this===s&&this===i&&ee("Cubic_bezier.split_bezier_ignore_attributes");const r=ne(M,4);this.queryControlPoints(r);const n=ne(M,4),o=ne(M,4);yC(r,e,n,o),s&&s.setControlPoints(n),i&&i.setControlPoints(o)}getAttributeAsDbl(e,s,i){if(s===0)return i===0?this.getCoordX(e):this.getCoordY(e);if(e===0)return this.getStartAttributeAsDbl(s,i);if(e===1)return this.getEndAttributeAsDbl(s,i);const r=this.getStartAttributeAsDbl(s,i),n=this.getEndAttributeAsDbl(s,i),o=this.calculateLength2D(),a=o>0?this.tToLength(e)/o:0,l=hM.getInterpolation(s);return _P(l,r,n,a,hM.getDefaultValue(s))}getClosestCoordinate(e,s){const i=[Number.NaN];return iD(this,e,de.unit(),s,-1,1,i),i[0]}getClosestCoordinateOnInterval(e,s,i=-1){const r=[Number.NaN];return iD(this,e,s,!1,i,1,r)===0?Number.NaN:r[0]}getYMonotonicParts(e,s=!1){return this.getMonotonicParts(e,s)}getMonotonicParts(e,s){e.length<2&&ee("");const i=gC(this);if(i.specialPointsCount()===2&&this.isMonotoneQuickAndDirty())return 0;let r=0;F(e.length>=i.specialPointsCount()-1);for(let n=1,o=i.specialPointsCount();n<o;++n)this.queryCut(i.specialPoints[n-1],i.specialPoints[n],e[r],s),r++;for(let n=0;n<r;++n)sD(e[n].get());return r}intersectionWithAxis2D(e,s,i,r){const n=ne(M,4);return this.queryControlPoints(n),wtt(n,e,s,i,r)}intersectionOfYMonotonicWithAxisX(e,s){if(this.m_YStart===this.m_YEnd)return e===this.m_YStart?s:Number.NaN;if(e===this.m_YStart)return this.m_XStart;if(e===this.m_YEnd)return this.m_XEnd;const i=[0,0],r=this.intersectionWithAxis2D(!0,e,i,null);return F(r!==2),r===-1?s:i[0]}isCurve(){return!0}isDegenerate(e){return mR(this,e)}isDegenerate3D(e,s){return F(0),!1}queryLooseEnvelope(e){if(e.m_EnvelopeType===2)return e.setCoords({pt:this.getStartXY()}),e.mergeNe(this.m_cp[0]),e.mergeNe(this.m_cp[1]),void e.mergeNe(this.getEndXY());F(0)}clone(e){const s=this.createInstance();return this.copyTo(s),s}queryInterval(e,s){if(e===0){const i=X.constructEmpty();this.queryEnvelope(i);const r=de.constructEmpty();return s===0?i.queryIntervalX(r):i.queryIntervalY(r),r}return super.queryInterval(e,s)}queryLooseEnvelopeOnInterval(e,s){const i=ne(M,4);this.queryControlPoints(i),r0(i,e.vmin,e.vmax,i),s.setFromPoints(i,4)}changeEndPoints2D(e,s){if(e.isEqual(this.m_XStart,this.m_YStart)&&s.isEqual(this.m_XEnd,this.m_YEnd))return;const i=this.m_cp[0].isEqual(this.m_XStart,this.m_YStart),r=this.m_cp[0].isEqual(this.m_XEnd,this.m_YEnd),n=this.m_cp[1].isEqual(this.m_XStart,this.m_YStart),o=this.m_cp[1].isEqual(this.m_XEnd,this.m_YEnd);this.setStartXY(e),this.setEndXY(s),i?this.m_cp[0].setCoordsPoint2D(e):r&&this.m_cp[0].setCoordsPoint2D(s),o?this.m_cp[1].setCoordsPoint2D(s):n&&this.m_cp[1].setCoordsPoint2D(e),this.normalizeAfterEndpointChange()}tToLength(e){return fC(this,e,!0)}lengthToT(e){return stt(this,e)}calculateWeightedAreaCentroid2D(e){const s=ne(M,4);A1e(this,s);const i=s[3],r=s[2],n=s[1],o=new M;o.x=(5*i.x*i.x*(7*r.y+16*n.y)+i.x*(-35*i.y*r.x+40*r.x*r.y-80*i.y*n.x+140*r.x*n.y+112*n.x*n.y)-2*(i.y*(20*r.x*r.x+70*r.x*n.x+56*n.x*n.x)-7*(4*r.x+5*n.x)*(-r.y*n.x+r.x*n.y)))/840,o.y=(-5*i.y*i.y*(7*r.x+16*n.x)+i.y*(5*i.x*(7*r.y+16*n.y)-4*(10*r.x*r.y+35*r.y*n.x+28*n.x*n.y))+2*(-7*(4*r.y+5*n.y)*(r.y*n.x-r.x*n.y)+i.x*(20*r.y*r.y+70*r.y*n.y+56*n.y*n.y)))/840;const a=ire(this);return o.x+=(s[0].x-e.x)*a,o.y+=(s[0].y-e.y)*a,o}calculateWeightedCentroid2D(){const e=new M;return this.isDegenerate(0)?(e.setCoords(0,0),e):ttt(this)?(e.assign(this.getCoord2D(.5).mul(this.calculateLength2D())),e):(e.assign(itt(this,1)),e)}getControlPoint1(){return this.m_cp[0].clone()}setControlPoint1(e){this.m_cp[0].setCoordsPoint2D(e),this.afterCompletedModification()}getControlPoint2(){return this.m_cp[1].clone()}setControlPoint2(e){this.m_cp[1].setCoordsPoint2D(e),this.afterCompletedModification()}queryControlPoints(e){e[0].assign(this.getStartXY()),e[1].assign(this.m_cp[0]),e[2].assign(this.m_cp[1]),e[3].assign(this.getEndXY())}setControlPoints(e){for(let s=0;s<4;s++)e[s].isNAN()&&ee("NAN control points in bezier are not supported");this.m_XStart=e[0].x,this.m_YStart=e[0].y,this.m_cp[0].setCoordsPoint2D(e[1]),this.m_cp[1].setCoordsPoint2D(e[2]),this.m_XEnd=e[3].x,this.m_YEnd=e[3].y,this.afterCompletedModification()}getTangent(e){const s=ne(M,4);return this.queryControlPoints(s),pG(s,e)}getDerivative(e){const s=ne(M,4);return this.queryControlPoints(s),Fn(s,1,e)}getCurvature(e){const s=I_(this,1,e),i=I_(this,2,e),r=s.sqrLength();return r===0?Number.NaN:(s.divThis(Math.sqrt(r)),s.crossProduct(i)/r)}isIntersectingPoint(e,s,i){if(i&&(e.equals(this.getStartXY())||e.equals(this.getEndXY())))return!1;const r=new X;if(this.queryLooseEnvelope(r),r.inflateCoords(s,s),!r.contains(e))return!1;const n=this.getClosestCoordinate(e,!1),o=new M;return this.queryCoord2D(n,o),M.distance(o,e)<=s}isIntersectingPoint3D(e,s,i,r,n=1){return F(0),!1}isMonotoneQuickAndDirty(){const e=ne(M,4);return this.queryControlPoints(e),htt(e)}getMonotonicPartParams(e,s){const i=gC(this),r=i.specialPointsCount();if(F(SP.s_maxMonotonicPartParams>=r),!s)return i.specialPointsCount();e<r&&ee("");for(let n=0;n<r;n++)s[n]=i.specialPoints[n];return r}normalizeAfterEndpointChange(){return!1}orientBottomUp(){if(this.m_YEnd<this.m_YStart||this.m_YEnd===this.m_YStart&&this.m_XEnd<this.m_XStart){this.m_XEnd=be(this.m_XStart,this.m_XStart=this.m_XEnd),this.m_YEnd=be(this.m_YStart,this.m_YStart=this.m_YEnd);for(let e=0,s=this.m_description.getTotalComponentCount()-2;e<s;e++)this.m_attributes[e+s]=be(this.m_attributes[e],this.m_attributes[e]=this.m_attributes[e+s]);this.m_cp[1]=be(this.m_cp[0],this.m_cp[0]=this.m_cp[1]),this.m_cachedValues=null}}findMinDeriv(){const e=new le;return R1e(this,e),e.value()}isLine(){return!1}isDegenerateToLineHelper(e){const s=this.getEndXY().sub(this.getStartXY()),i=s.length(),r=.1*e;let n=this.getControlPoint1();n.subThis(this.getStartXY());let o=Math.abs(n.crossProduct(s))/i;return!(o>r)&&(n=this.getControlPoint2(),n.subThis(this.getStartXY()),o=Math.abs(n.crossProduct(s))/i,!(o>r))}copyIgnoreAttributes(e){const s=ne(M,4);this.queryControlPoints(s),e.setControlPoints(s)}calculateArea2DHelper(){return ire(this)}absNorm(){return ytt(this)}queryEnvelopeW(e,s){F1e(this,e,s)}setSegmentFromCoords(e,s){vtt(this,e,s)}writeInBufferStream(e,s){const i=new Float64Array(4);return this.writeInBuffer_(i),e.writeRangeFromArray(s,i.length,i,!0,1),s+i.length}writeInBuffer_(e){return e[0]=this.m_cp[0].x,e[1]=this.m_cp[0].y,e[2]=this.m_cp[1].x,e[3]=this.m_cp[1].y,4}readFromBufferStream(e,s){const i=new Float64Array(4);e.queryRange(s,i.length,i,!0,1),this.readFromBuffer_(i)}readFromBuffer_(e){this.m_cp=ne(M,2),this.m_cp[0].x=e[0],this.m_cp[0].y=e[1],this.m_cp[1].x=e[2],this.m_cp[1].y=e[3],this.m_cachedValues=null}snapControlPoints(e){const s=ne(M,4);this.queryControlPoints(s);const i=(o,a,l)=>{let u=!1;return M.sqrDistance(o,l)<=e&&(u=!o.equals(l),o.setCoordsPoint2D(l),M.sqrDistance(a,l)<=e&&(u||(u=!a.equals(l)),a.setCoordsPoint2D(l))),u},r=i(s[1],s[2],s[0]),n=i(s[2],s[1],s[3]);return(r||n)&&this.setControlPoints(s),r||n}needsSnapControlPoints(e){if(!e)return!1;const s=ne(M,4);this.queryControlPoints(s);const i=(o,a,l)=>{let u=!1;return M.sqrDistance(o,l)<=e&&(u=!o.equals(l),o.setCoordsPoint2D(l),M.sqrDistance(a,l)<=e&&(u||(u=!a.equals(l)),a.setCoordsPoint2D(l))),u},r=i(s[1],s[2],s[0]),n=i(s[2],s[1],s[3]);return r||n}calculateSpecialPointsForCracking(e,s){return Stt(this,e,s)}ensureXYMonotone(){return sD(this)}setCoordsForIntersector(e,s,i){ntt(this,e,s,i)}copyToImpl(e){const s=e;s.m_cp[0].assign(this.m_cp[0]),s.m_cp[1].assign(this.m_cp[1]),$1e(s,sre(this))}reverseImpl(){this.m_cp[1]=be(this.m_cp[0],this.m_cp[0]=this.m_cp[1])}equalsImpl(e){const s=e;return!!this.m_cp[0].equals(s.m_cp[0])&&!!this.m_cp[1].equals(s.m_cp[1])}equalsImplTol(e,s){const i=e;return!!this.m_cp[0].isEqualPoint2D(i.m_cp[0],s)&&!!this.m_cp[1].isEqualPoint2D(i.m_cp[1],s)}swapImpl(e){const s=e;s.m_cp[0]=be(this.m_cp[0],this.m_cp[0]=s.m_cp[0]),s.m_cp[1]=be(this.m_cp[1],this.m_cp[1]=s.m_cp[1]),rtt(this,s)}afterCompletedModification(){cL(this)}isIntersecting(e,s,i){return Cx(!1,this,e,s,i)!==0}intersect(e,s,i,r,n){return C0(!1,this,e,s,i,r,n)}intersectPoint(e,s,i){return gtt(this,e,s,i)}endPointModified(){cL(this)}clearEndPointModified(){}};Hl.type=G.enumBezier;let Ket=class{constructor(){this.length=Number.NaN,this.specialPoints=[]}specialPointsCount(){return this.specialPoints.length}};function M1e(t){return ett(t.calculateUpperLength2D())}function ett(t){return 256*Bs()*t}function ttt(t){const e=M.distance(t.getStartXY(),t.getEndXY()),s=t.calculateUpperLength2D();return s-e<=8*Number.EPSILON*s}function A1e(t,e,s=!1){e[1].setCoords(t.m_cp[0].x-t.getStartX(),t.m_cp[0].y-t.getStartY()),e[1].mulThis(3),e[2].setCoords(t.m_cp[1].x-t.m_cp[0].x,t.m_cp[1].y-t.m_cp[0].y),e[2].mulThis(3),e[3]=t.getEndXY().sub(t.getStartXY()),e[3].subThis(e[2]),e[2].subThis(e[1]),s?e[0].setCoords(0,0):e[0]=t.getStartXY()}function N1e(t,e,s){const i=ne(M,4);t.queryControlPoints(i),L9(i,e,s)}function D1e(t,e,s){const i=ne(M,4);t.queryControlPoints(i),V9(i,e,s)}function L9(t,e,s){let i=t[1].x;i-=t[0].x,i*=3;let r=t[2].x;r-=t[1].x,r*=3;let n=t[3].x;n-=t[0].x,n-=r,r-=i,e[3].setWithEps(n),e[2].setWithEps(r),e[1].setWithEps(i),s?e[0].set(0):e[0].set(t[0].x)}function V9(t,e,s){let i=t[1].y;i-=t[0].y,i*=3;let r=t[2].y;r-=t[1].y,r*=3;let n=t[3].y;n-=t[0].y,n-=r,r-=i,e[3].setWithEps(n),e[2].setWithEps(r),e[1].setWithEps(i),s?e[0].set(0):e[0].set(t[0].y)}function zb(t,e,s=!1){const i=ne(zs,4);i[0].assignPoint2D(t[0]),i[1].assignPoint2D(t[1]),i[2].assignPoint2D(t[2]),i[3].assignPoint2D(t[3]),e[1].setCoords(i[1].x.sub(i[0].x),i[1].y.sub(i[0].y)),e[1].mulThis(Ae.constructInt32(3)),e[2].setCoords(i[2].x.sub(i[1].x),i[2].y.sub(i[1].y)),e[2].mulThis(Ae.constructInt32(3)),e[3]=i[3].sub(i[0]),e[3]=e[3].sub(e[2]),e[2]=e[2].sub(e[1]),s?e[0].setCoords(zn,zn):e[0]=i[0].clone()}function fC(t,e,s){if(s){if(e<0)return e;if(e>1)return e-1+fC(t,1,!1)}if(t.isDegenerate(0))return 0;const i=e===1,r=gC(t);if(i&&!Number.isNaN(r.length)&&!Number.isNaN(r.length))return r.length;const n=M1e(t),o=n/t.calculateUpperLength2D();let a=0,l=0;for(let u=1,c=r.specialPointsCount();u<c;u++){const h=r.specialPoints[u];if(a+=Ctt(t,l,Math.min(e,h),o,n),e<=h)break;l=h}return i&&(r.length=a),a}function stt(t,e,s){const i=fC(t,1,!1);if(e<=0)return e;if(e>=i)return e-i+1;const r=[0];return Cg(new Ett(t,e),de.unit(),1,r)!==1&&Ce(""),r[0]}function itt(t,e,s){s===void 0&&(s=e,e=0);const i=new M;if(e<0||s>1)return i.setNAN(),i;if(e>s&&ee("calculate_sub_weightedCentroid"),e===s||t.isDegenerate(0))return i.setCoords(0,0),i;const r=gC(t),n=M1e(t),o=n/t.calculateUpperLength2D();let a=e,l=0;for(let u=1,c=r.specialPointsCount();u<c;u++)if(e<r.specialPoints[u]){l=u-1;break}i.setCoords(0,0);for(let u=l+1,c=r.specialPointsCount();u<c;u++){const h=Math.min(r.specialPoints[u],s),m=Ptt(t,a,h,o,n);if(i.addThis(m),a=h,s<=r.specialPoints[u])break}return i.add(t.getStartXY().mul(t.calculateLength2D()))}function gC(t){if(t.m_cachedValues)return t.m_cachedValues;const e=new Ket,s=ne(le,8),i=ne(M,4);t.queryControlPoints(i);const r=L1e(i,s);e.specialPoints=[];for(let n=0;n<r;n++)e.specialPoints.push(s[n].value());return $1e(t,e),e}function sre(t){let e=null;return e=t.m_cachedValues,e}function $1e(t,e){t.m_cachedValues=e}function cL(t){t.m_cachedValues=null}function rtt(t,e){e.m_cachedValues=be(t.m_cachedValues,t.m_cachedValues=e.m_cachedValues)}function ntt(t,e,s,i){if(e.isEqual(t.m_XStart,t.m_YStart)&&s.isEqual(t.m_XEnd,t.m_YEnd))return;const r=!!i&&t.isMonotoneQuickAndDirty(),n=new Rt,o=ne(M,3);o[0].setCoords(t.m_XStart,t.m_YStart),o[2].setCoords(t.m_XEnd,t.m_YEnd);const a=new M;a.setSub(o[2],o[0]),a.leftPerpendicularThis(),o[1].setAdd(o[0],a);const l=ne(M,3);l[0].setCoordsPoint2D(e),l[2].setCoordsPoint2D(s),a.setSub(l[2],l[0]),a.leftPerpendicularThis(),l[1].setAdd(l[0],a),n.setFromTwoTriangles(o,l)?n.transformPoints2D(t.m_cp,2,t.m_cp):(wi(e,s,1/3,t.m_cp[0]),wi(e,s,2/3,t.m_cp[1])),t.changeEndPoints2D(e,s),r&&sD(t)}function ott(t,e,s,i,r){return{tmin:t,tmax:e,t:s,d:i,pt:r.clone()}}function att(t,e,s,i){const r=Me(18,Number.NaN),n=ne(M,4);t.queryControlPoints(n);const o=Cg(new O1e(n,e),de.construct(s,i),18,r),a=new M;t.queryCoord2D(s,a);let l=s,u=M.distance(a,e);const c=new M;t.queryCoord2D(i,c);const h=M.distance(c,e);h<u&&(u=h,l=i,a.assign(c));for(let m=0;m<o;m++){t.queryCoord2D(r[m],c);const f=M.distance(c,e);f<u&&(u=f,l=r[m],a.assign(c))}return ott(s,i,l,u,a)}function R1e(t,e){const s=ne(le,4);N1e(t,s,!0);const i=ne(le,4);D1e(t,i,!0);const r=s[3].clone(),n=s[2].clone(),o=s[1].clone(),a=i[3].clone(),l=i[2].clone(),u=i[1].clone(),c=n.mulE(o).addE(l.mulE(u)).mul(4),h=n.mulE(n).mul(8).addE(r.mulE(o).mul(12)).addE(l.mulE(l).mul(8).addE(a.mulE(u).mul(12))),m=r.mulE(n).addE(a.mulE(l)).mul(36),f=r.mulE(r).addE(a.mulE(a)).mul(36),g=ne(le,3),v=Q3(f,m,h,c,new de(0,1),!1,g);if(F(v<=3),v>0){const b=I_(t,1,0).sqrLength(),w=I_(t,1,1).sqrLength();let S=b;e.set(0),S<w&&(S=w,e.set(1));for(let T=0;T<v;T++){const P=I_(t,1,g[T].value()).sqrLength();P<S&&(S=P,e=g[T])}}}function ltt(t,e,s,i){if(e===1){const r=1-s,n=r*r,o=s*s,a=t[1].sub(t[0]),l=t[2].sub(t[1]),u=t[3].sub(t[2]),c=a.mul(n).add(l.mul(2*r*s)).add(u.mul(o));i.assign(c.mul(3))}else if(e===2){const r=1-s,n=t[2].sub(t[1]).sub(t[1].sub(t[0])),o=t[3].sub(t[2]).sub(t[2].sub(t[1])),a=n.mul(r).add(o.mul(s));i.assign(a.mul(6))}else if(e===3){const r=t[2].sub(t[1]),n=t[3].sub(r.mul(3)).sub(t[0]);i.assign(n.mul(6))}else i.setCoords(0,0)}function utt(t,e,s,i){{const r=Dd.subE(s),n=r.sqr(),o=s.sqr(),a=t[1].subE(t[0]).mulE(n).addE(t[2].subE(t[1]).mulE(new le(2).mulE(r).mulE(s))).addE(t[3].subE(t[2]).mulE(o));i.setE(a.mulE(new le(3)))}}function Fn(t,e,s){const i=new M;return ltt(t,e,s,i),i}function ctt(t,e,s){const i=[je.constructPoint2D(t[0]),je.constructPoint2D(t[1]),je.constructPoint2D(t[2]),je.constructPoint2D(t[3])],r=new je;return utt(i,e,s,r),r}function I_(t,e,s){const i=ne(M,4);return t.queryControlPoints(i),Fn(i,e,s)}function ire(t){const e=t.m_cp[0].sub(t.getStartXY()),s=t.m_cp[1].sub(t.m_cp[0]),i=t.getEndXY().sub(t.getStartXY());return e.mulThis(3),s.mulThis(3),i.subThis(s),s.subThis(e),(3*i.x*(2*s.y+5*e.y)-3*i.y*(2*s.x+5*e.x)+10*(s.x*e.y-s.y*e.x))/60}function sD(t){const e=ne(M,4);t.queryControlPoints(e);const s=gR(e);return s&&(t.m_cp[0].setCoordsPoint2D(e[1]),t.m_cp[1].setCoordsPoint2D(e[2]),t.afterCompletedModification()),s}function gR(t){let e=!1;for(let s=0;s<2;s++){const i=Gs(t[0][s],t[3][s]);i>0?(Gs(t[0][s],t[1][s])<0&&(t[1][s]=t[0][s],e=!0),Gs(t[1][s],t[3][s])<0&&(t[1][s]=t[3][s],e=!0),Gs(t[0][s],t[2][s])<0&&(t[2][s]=t[0][s],e=!0),Gs(t[2][s],t[3][s])<0&&(t[2][s]=t[3][s],e=!0),Gs(t[1][s],t[2][s])<0&&(t[2][s]=t[1][s],e=!0)):i<0?(Gs(t[0][s],t[1][s])>0&&(t[1][s]=t[0][s],e=!0),Gs(t[1][s],t[3][s])>0&&(t[1][s]=t[3][s],e=!0),Gs(t[0][s],t[2][s])>0&&(t[2][s]=t[0][s],e=!0),Gs(t[2][s],t[3][s])>0&&(t[2][s]=t[3][s],e=!0),Gs(t[1][s],t[2][s])>0&&(t[2][s]=t[1][s],e=!0)):t[1][s]===t[0][s]&&t[2][s]===t[0][s]||(t[1][s]=t[0][s],t[2][s]=t[0][s],e=!0)}return e}function htt(t){const e=Gs(t[0].y,t[1].y),s=Gs(t[1].y,t[2].y),i=Gs(t[2].y,t[3].y);if(e>=0&&s>=0&&i>=0||e<=0&&s<=0&&i<=0){const r=Gs(t[0].x,t[1].x),n=Gs(t[1].x,t[2].x),o=Gs(t[2].x,t[3].x);if(r>=0&&n>=0&&o>=0||r<=0&&n<=0&&o<=0)return!0}return!1}function mM(t,e,s){const i=new M,r=new M,n=new M,o=new M,a=new M;e<=.5?(Li(2,t[0],t[1],e,i),Li(2,t[1],t[2],e,r),Li(2,t[2],t[3],e,n),Li(2,i,r,e,o),Li(2,r,n,e,a),Li(2,o,a,e,s)):(Vi(2,t[0],t[1],e,i),Vi(2,t[1],t[2],e,r),Vi(2,t[2],t[3],e,n),Vi(2,i,r,e,o),Vi(2,r,n,e,a),Vi(2,o,a,e,s))}function yC(t,e,s,i){F(e>=0&&e<=1);const r=new M,n=new M,o=new M,a=new M,l=new M,u=new M;e<=.5?(Li(2,t[0],t[1],e,r),Li(2,t[1],t[2],e,n),Li(2,t[2],t[3],e,o),Li(2,r,n,e,a),Li(2,n,o,e,l),Li(2,a,l,e,u)):(Vi(2,t[0],t[1],e,r),Vi(2,t[1],t[2],e,n),Vi(2,t[2],t[3],e,o),Vi(2,r,n,e,a),Vi(2,n,o,e,l),Vi(2,a,l,e,u));const c=t[3].clone();s&&(s[0].assign(t[0]),s[1].assign(r),s[2].assign(a),s[3].assign(u)),i&&(i[0].assign(u),i[1].assign(l),i[2].assign(o),i[3].assign(c))}function r0(t,e,s,i){if(F(e>=0&&s<=1&&e<=s),e===s){const n=new M;return ri(t,e,n),i[0].assign(n),i[1].assign(n),i[2].assign(n),void i[3].assign(n)}if(e===0&&s===1){for(let n=0;n<4;++n)i[n].assign(t[n]);return}const r=ne(M,4);yC(t,s,r,null),yC(r,s>0?e/s:0,null,r),ri(t,e,r[0]),ri(t,s,r[3]),i[0].setCoordsPoint2D(r[0]),i[1].setCoordsPoint2D(r[1]),i[2].setCoordsPoint2D(r[2]),i[3].setCoordsPoint2D(r[3])}function ri(t,e,s,i){if(i){if(e<0)return void ga(new pt({start:t[0],end:t[0].add(pG(t,0).getUnitVector())}),e,s);if(e>1)return void ga(new pt({start:t[3],end:t[3].add(pG(t,1).getUnitVector())}),e-1,s)}if(e<=.5){const r=new M;Li(2,t[0],t[1],e,r);const n=new M;Li(2,t[1],t[2],e,n);const o=new M;Li(2,t[2],t[3],e,o);const a=new M;Li(2,r,n,e,a);const l=new M;Li(2,n,o,e,l),Li(2,a,l,e,s)}else{const r=new M;Vi(2,t[0],t[1],e,r);const n=new M;Vi(2,t[1],t[2],e,n);const o=new M;Vi(2,t[2],t[3],e,o);const a=new M;Vi(2,r,n,e,a);const l=new M;Vi(2,n,o,e,l),Vi(2,a,l,e,s)}}function mtt(t,e,s){if(e.value()<=.5){const i=new je;Rl(2,je.constructPoint2D(t[0]),je.constructPoint2D(t[1]),e,i);const r=new je;Rl(2,je.constructPoint2D(t[1]),je.constructPoint2D(t[2]),e,r);const n=new je;Rl(2,je.constructPoint2D(t[2]),je.constructPoint2D(t[3]),e,n);const o=new je;Rl(2,i,r,e,o);const a=new je;Rl(2,r,n,e,a),Rl(2,o,a,e,s)}else{const i=new je;kl(2,je.constructPoint2D(t[0]),je.constructPoint2D(t[1]),e,i);const r=new je;kl(2,je.constructPoint2D(t[1]),je.constructPoint2D(t[2]),e,r);const n=new je;kl(2,je.constructPoint2D(t[2]),je.constructPoint2D(t[3]),e,n);const o=new je;kl(2,i,r,e,o);const a=new je;kl(2,r,n,e,a),kl(2,o,a,e,s)}}function dtt(t,e,s){const i=ne(M,4);t.queryControlPoints(i),mtt(i,e,s)}function pG(t,e){const s=ys(e,0,1);let i=Fn(t,1,s);return i.isZero()&&(i=Fn(t,2,s),i.isZero()?i=Fn(t,3,s):s===1&&i.negateThis()),i}function k1e(t,e,s){const i=ne(M,4);t.queryControlPoints(i),ptt(i,e,s)}function ptt(t,e,s){e.value()<0&&e.set(0,e.eps()),e.value()>1&&e.set(1,e.eps()),s.setE(ctt(t,1,e))}function rre(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return t?4:2}else if(rl(e,s))return 1;return _C(t,e,s,null,null,null,i,r!==void 0&&r,!0,!1)!==0?4:0}function nre(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return t?4:2}else if(rl(e,s))return 1;return fG(t,e,s,null,null,null,i,r!==void 0&&r,!0,!1)!==0?4:0}function ftt(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return 2}else if(rl(e,s))return 1;return q9(t,e,s,null,null,null,i,r!==void 0&&r,!0,!1)!==0?4:0}function ore(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return t?4:2}else if(rl(e,s))return 1;return gG(t,e,s,null,null,null,i,r!==void 0&&r,!0,!1)!==0?4:0}function are(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return t?4:2}else if(rl(e,s))return 1;return yG(t,e,s,null,null,null,i,r??!1,!0,!1)!==0?4:0}function _C(t,e,s,i,r,n,o,a,l,u){if(r!==null&&(r.length=0),n!=null&&(n.length=0),i!==null&&(i.length=0),s.isDegenerate(0)){const k=[0,0,0],R=e.intersectPoint(s.getStartXY(),k,o);if(R>0){if(r!==null)for(let O=0;O<R;O++)r.push(k[O]);if(n!==null)for(let O=0;O<R;O++)n.push(0);if(i!=null)for(let O=0;O<R;O++){const z=new M;e.queryCoord2D(k[O],z),i.push(z)}}return R}const c=jo(e,s);if(nl(e,s,o=Math.max(o,c)))return 0;const h=ne(M,4);A1e(e,h);const m=s.getEndXY();m.subThis(s.getStartXY());const f=m.clone();f.leftPerpendicularThis();let g=3*h[3].dotProduct(f),v=2*h[2].dotProduct(f),b=h[1].dotProduct(f);const w=Me(15,Number.NaN),S=Me(15,Number.NaN);let T=e0(g,v,b,de.unit(),!1,w);T<0&&(w[0]=0,w[1]=1,T=2);let P,I=0;for(let k=0,R=I;k<T;++k){const O=e.getCoord2D(w[k+R]);S[I]=s.getClosestCoordinate(O,!1),M.distance(O,s.getCoord2D(S[I]))<=o&&(w[I]=w[k+R],I++)}if(h[0].subThis(s.getStartXY()),Math.abs(m.x)>=Math.abs(m.y)){const k=m.y/m.x;g=h[3].y-h[3].x*k,v=h[2].y-h[2].x*k,b=h[1].y-h[1].x*k,P=h[0].y-h[0].x*k}else{const k=m.x/m.y;g=h[3].x-h[3].y*k,v=h[2].x-h[2].y*k,b=h[1].x-h[1].y*k,P=h[0].x-h[0].y*k}const A=e.getEndXY().equals(s.getStartXY())||e.getEndXY().equals(s.getEndXY()),D=[0,0,0];T=r1e(g,v,b,P,de.unit(),A,D);for(let k=0,R=I;k<T;++k){w[k+R]=D[k];const O=e.getCoord2D(w[k+R]);S[I]=s.getClosestCoordinate(O,!1),M.distance(O,s.getCoord2D(S[I]))<=o&&(w[I]=w[k+R],I++)}T=e.intersectPoint(s.getStartXY(),D,o);for(let k=0;k<T;k++)w[I]=D[k],S[I++]=0;T=e.intersectPoint(s.getEndXY(),D,o);for(let k=0;k<T;k++)w[I]=D[k],S[I++]=1;return s.intersectPoint(e.getStartXY(),D,o)!==0&&(S[I]=D[0],w[I++]=0),s.intersectPoint(e.getEndXY(),D,o)!==0&&(S[I]=D[0],w[I++]=1),I===0?0:ol(t,e,s,w,S,I,i,r,n,o,a,l,u)}function fG(t,e,s,i,r,n,o,a,l,u){if(vs(s))return _C(t,e,new pt({start:s.getStartXY(),end:s.getEndXY()}),i,r,n,o,a,l,u);const c=jo(e,s);if(nl(e,s,o=Math.max(o,c)))return 0;const h=[],m=[],f=[],g=ne(M,4);{e.queryControlPoints(g);const b=ne(M,4),w=new Rt;s.canonicToWorldTransformation(w);const S=new Rt;S.setInvert(w),S.transformPoints2D(g,4,b);const T=ne(zs,4);zb(b,T);const P=[T[0].x,T[1].x,T[2].x,T[3].x],I=[T[0].y,T[1].y,T[2].y,T[3].y],A=ne(Ae,3);A[0].setDouble(s.getSemiMinorAxis()),A[0].sqrThis(),A[1].setDouble(s.getSemiMajorAxis()),A[1].sqrThis(),A[2].setThis(A[0]),A[2].mulThis(A[1]),A[2].negateThis();const D=$9(P,3,I,3,null,0,A,!0,de.unit(),de.unit(),m);if(D>0){let k=0;for(let R=0;R<D;R++){const O=new M;e.queryCoord2D(m[R],O);const z=s.getClosestCoordinate(O,!1),q=new M;s.queryCoord2D(z,q),M.distance(O,q)<=o&&(h.push(O.clone()),m[k]=m[R],f.push(z),k++)}m.length=k,h.length=k}}const v=[0,1];for(let b=0;b<2;b++){const w=b===0?s.getStartXY():s.getEndXY(),S=[0];n0(g,w,de.unit(),!1,-1,1,S);const T=new M;ri(g,S[0],T),M.distance(w,T)<=o&&(m.push(S[0]),f.push(v[b]),h.push(T.clone()))}for(let b=0;b<2;b++){const w=[0,3];{const S=s.getClosestCoordinate(g[w[b]],!1),T=new M;s.queryCoord2D(S,T),M.distance(g[w[b]],T)<=o&&(m.push(v[b]),f.push(S),h.push(T.clone()))}}return ol(t,e,s,m,f,m.length,i,r,n,o,a,l,u)}function q9(t,e,s,i,r,n,o,a,l,u){const c=ne(M,4);e.queryControlPoints(c);const h=ne(M,4);if(s.queryControlPoints(h),N9(c,h,4)<0)return q9(t,s,e,i,n,r,o,a,l,!u);const m=jo(e,s);if(nl(e,s,o=Math.max(o,m)))return 0;if(Ttt(e,s,i,r,n,o,a,l,u))return 2;const f=new de(0,1),g=new de(0,1);{const P=new Yn;vC(c,new de(0,1),P);const I=new Yn;vC(h,new de(0,1),I);const A=Math.max(P.maxDim(),I.maxDim());if(P.inflate(3*o),I.inflate(3*o),!P.intersectW(I))return 0;if(P.maxDim()<.1*A){if(_G(c,P,f),_G(h,P,g),f.isEmpty()||g.isEmpty())return 0;r0(c,f.vmin,f.vmax,c),r0(h,g.vmin,g.vmax,h)}}const v=Px(c,3,h,3,o);if(v===0)return 0;const b=[],w=[],S=[];let T=!1;if(v===-1){const P=ne(zs,4);zb(c,P);const I=[P[0].x,P[1].x,P[2].x,P[3].x],A=[P[0].y,P[1].y,P[2].y,P[3].y],D=ne(zs,4);zb(h,D);const k=[],R=[],O=Ex(I,3,A,3,null,0,[D[0].x,D[1].x,D[2].x,D[3].x],3,[D[0].y,D[1].y,D[2].y,D[3].y],3,null,0,!0,de.unit(),de.unit(),k,R);if(O>0)for(let z=0;z<O;z++){const q=new M;ri(h,R[z],q);const U=new M;ri(c,k[z],U),M.distance(U,q)<=o&&(b.push(U.clone()),S.push(R[z]),w.push(k[z]))}else O===-1&&(T=!0)}for(let P=0;P<2;P++){const I=P===0?c:h,A=P===0?h:c;for(let D=0;D<2;D++){const k=D===0?0:3,R=[0];n0(A,I[k],de.unit(),!1,-1,1,R);const O=new M;ri(A,R[0],O),M.distance(I[k],O)<=o&&(P===0?(w.push(k===0?0:1),S.push(R[0])):(S.push(k===0?0:1),w.push(R[0])),b.push(O.clone()))}}if(w.length===0&&T){const P=e.calculateUpperLength2D()>s.calculateUpperLength2D();{const I=[0,0];if(btt(P?e:s,I,!0)===2&&(F(de.unit().containsCoordinate(I[0])),!de.unit().containsCoordinate(I[1]))){const A=new M;ri(P?c:h,I[0],A);const D=[0,0];n0(P?h:c,A,de.unit(),!1,-1,2,D)===1&&(b.push(A.clone()),w.push(P?I[0]:D[0]),S.push(P?D[0]:I[0]))}}}if(w.length===0)return 0;if(!f.equalsRange(0,1))for(let P=0;P<w.length;++P)w[P]=Hl.recalculateParentT(f.vmin,f.vmax,w[P]);if(!g.equalsRange(0,1))for(let P=0;P<S.length;++P)S[P]=Hl.recalculateParentT(g.vmin,g.vmax,S[P]);return ol(t,e,s,w,S,w.length,i,r,n,o,a,l,u)}function gG(t,e,s,i,r,n,o,a,l,u){const c=jo(e,s);if(s.isDegenerateToLineHelper(c)){const I=new pt({start:s.getStartXY(),end:s.getEndXY()}),A=_C(t,e,I,i,r,n,o,a,l,u);if(n)for(let D=0;D<A;++D){const k=I.getCoord2D(n[D]);n[D]=s.getClosestCoordinate(k,!1)}return A}if(nl(e,s,o=Math.max(o,c)))return 0;const h=ne(M,4);e.queryControlPoints(h);const m=ne(M,3);s.queryControlPoints(m);const f=new de(0,1),g=new de(0,1),v=[0,0,0];s.queryWeights(v);const b=[1,zu(v),1];{const I=new Yn;vC(h,new de(0,1),I);const A=new Yn;aC(m,b,new de(0,1),A);const D=Math.max(I.maxDim(),A.maxDim());if(I.inflate(3*o),A.inflate(3*o),!I.intersectW(A))return 0;if(I.maxDim()<.1*D){if(_G(h,I,f),oG(m,b,I,g),f.isEmpty()||g.isEmpty())return 0;r0(h,f.vmin,f.vmax,h),ug(m,b,g.vmin,g.vmax,m,b)}}const w=Px(h,3,m,2,o);if(w===0)return 0;const S=[],T=[],P=[];if(w===-1){const I=ne(zs,4);zb(h,I);const A=[I[0].x,I[1].x,I[2].x,I[3].x],D=[I[0].y,I[1].y,I[2].y,I[3].y],k=ne(Ae,3),R=ne(Ae,3),O=ne(Ae,3);uC(m,b,k,R,O);const z=[],q=[],U=Ex(k,2,R,2,O,2,A,3,D,3,null,0,!0,de.unit(),de.unit(),q,z);if(U>0)for(let V=0;V<U;V++){const B=new M;ri(h,z[V],B);const H=new M;bi(m,b,q[V],H),M.distance(B,H)<=o&&(S.push(B.clone()),T.push(z[V]),P.push(q[V]))}}for(let I=0;I<2;I++){let A,D;I===0?(A=h,D=m):(D=h,A=m);for(let k=0;k<2;k++){const R=k===0?0:A.length-1,O=[0],z=new M;if(I===0){const q=R9(D,b,A[R],de.unit(),!1,-1,1,O);F(q===1),bi(D,b,O[0],z)}else{const q=n0(D,A[R],de.unit(),!1,-1,1,O);F(q===1),ri(D,O[0],z)}M.distance(A[R],z)<=o&&(I===0?(T.push(R===0?0:1),P.push(O[0])):(P.push(R===0?0:1),T.push(O[0])),S.push(z.clone()))}}if(T.length===0)return 0;if(!f.equalsRange(0,1))for(let I=0;I<T.length;++I)T[I]=Hl.recalculateParentT(f.vmin,f.vmax,T[I]);if(!g.equalsRange(0,1))for(let I=0;I<P.length;++I)P[I]=Oo.recalculateParentT(g.vmin,g.vmax,P[I]);for(let I=0;I<P.length;++I)P[I]=qb(v,P[I]);return ol(t,e,s,T,P,T.length,i,r,n,o,a,l,u)}function yG(t,e,s,i,r,n,o,a,l,u){const c=jo(e,s);if(nl(e,s,o=Math.max(o,c)))return 0;const h=ne(M,4);e.queryControlPoints(h);const m=ne(M,3);s.queryControlPoints(m);const f=Px(h,3,m,2,o);if(f===0)return 0;const g=[],v=[],b=[];if(f===-1){const w=ne(zs,4);zb(h,w);const S=[w[0].x,w[1].x,w[2].x,w[3].x],T=[w[0].y,w[1].y,w[2].y,w[3].y],P=ne(zs,3);Gb(m,P);const I=Ex([P[0].x,P[1].x,P[2].x],2,[P[0].y,P[1].y,P[2].y],2,null,0,S,3,T,3,null,0,!0,de.unit(),de.unit(),b,v);if(I>0){let A=0;for(let D=0;D<I;D++){const k=new M;e.queryCoord2D(v[D],k);const R=new M;s.queryCoord2D(b[D],R),M.distance(k,R)<=o&&(g.push(k.clone()),v[A]=v[D],b[A]=b[D],A++)}v.length=A,g.length=A}}for(let w=0;w<2;w++){let S,T;w===0?(S=h,T=m):(T=h,S=m);for(let P=0;P<2;P++){const I=P===0?0:S.length-1,A=[0],D=new M;if(w===0)fR(T,S[I],A),Vu(T,A[0],D);else{const k=n0(T,S[I],de.unit(),!1,-1,1,A);F(k===1),ri(T,A[0],D)}M.distance(S[I],D)<=o&&(w===0?(v.push(I===0?0:1),b.push(A[0])):(b.push(I===0?0:1),v.push(A[0])),g.push(D.clone()))}}return ol(t,e,s,v,b,v.length,i,r,n,o,a,l,u)}function gtt(t,e,s,i,r){const n=new Yn;if(F1e(t,de.unit(),n),n.inflate(i),!n.isIntersectingPoint2D(e))return 0;const o=gC(t);let a=0,l=o.specialPoints[0];const u=[];for(let c=1,h=o.specialPoints.length;c<h;++c){const m=o.specialPoints[c],f=att(t,e,l,m);if(u.length===0)u.push(f);else if(f.t===f.tmin)F(u.at(-1).d<=f.d),u.at(-1).tmax=f.tmax;else if(u.at(-1).t===u.at(-1).tmax){F(u.at(-1).d>=f.d);const g=u.at(-1).tmin;u[u.length-1]=f,u.at(-1).tmin=g}else u.push(f);l=m}for(const c of u)if(c.d<=i){const h=c.t;s&&(a>=s.length&&bt(""),s[a]=h),a++}return a}function F1e(t,e,s){const i=ne(M,4);t.queryControlPoints(i),vC(i,e,s)}function vC(t,e,s){if(e.equalsRange(0,1))return void s.setFromPoints(t,4);const i=ne(M,4);r0(t,e.vmin,e.vmax,i),s.setFromPoints(i,4)}let O1e=class{constructor(e,s){this.controlPoints=e,this.point=s.clone()}getMaxDerivative(){return 6}getValue(e,s){switch(e){case 0:{const i=new M;ri(this.controlPoints,s,i);const r=Fn(this.controlPoints,1,s);return 2*i.sub(this.point).dotProduct(r)}case 1:{const i=new M;ri(this.controlPoints,s,i);const r=Fn(this.controlPoints,1,s),n=Fn(this.controlPoints,2,s);return 2*(i.sub(this.point).dotProduct(n)+r.dotProduct(r))}case 2:{const i=new M;ri(this.controlPoints,s,i);const r=Fn(this.controlPoints,1,s),n=Fn(this.controlPoints,2,s),o=Fn(this.controlPoints,3,s);return 2*(i.sub(this.point).dotProduct(o)+3*r.dotProduct(n))}case 3:{const i=Fn(this.controlPoints,1,s),r=Fn(this.controlPoints,2,s),n=Fn(this.controlPoints,3,s);return 2*(4*i.dotProduct(n)+3*r.sqrLength())}case 4:{const i=Fn(this.controlPoints,2,s),r=Fn(this.controlPoints,3,s);return 2*(10*i.dotProduct(r))}case 5:{const i=Fn(this.controlPoints,3,s);return 2*(10*i.dotProduct(i))}default:return 0}}getError(e){return 0}};function n0(t,e,s,i,r,n,o){KE(de.unit().contains(s)&&n>0,"getClosestCoordinate"),(r<0||Number.isNaN(r))&&(r=Number.MAX_VALUE);const a=[],l=new M;ri(t,s.vmin,l);let u=M.distance(l,e);if(u<=r&&a.push(new M(s.vmin,u)),s.vmin!==s.vmax&&(ri(t,s.vmax,l),u=M.distance(l,e),u<=r&&a.push(new M(s.vmax,u))),s.width()>0){const m=Me(18,Number.NaN),f=Cg(new O1e(t,e),s,18,m);for(let g=0;g<f;g++)ri(t,m[g],l),u=M.distance(l,e),u>r||a.push(new M(m[g],u))}if(i){F(s.equals(de.unit()));{ri(t,-1,l,!0);const m=new M;ri(t,0,m);const f=new pt({start:l,end:m}),g=f.getClosestCoordinate(e,!0);g<1&&(l.assign(f.getCoord2D(g)),u=M.distance(l,e),u<=r&&a.push(new M(g-1,u)))}{ri(t,2,l,!0);const m=new M;ri(t,s.vmax,m);const f=new pt({start:m,end:l}),g=f.getClosestCoordinate(e,!0);g>0&&(l.assign(f.getCoord2D(g)),u=M.distance(l,e),u<=r&&a.push(new M(1+g,u)))}}if(!a.length)return 0;a.sort((m,f)=>m.compare(f));let c=0;const h=a[0].x;if(o[c++]=h,c<n){const m=Y0e(t,4,!1).total(),f=a[0].y;for(let g=1,v=a.length;g<v;g++)if(a[g].y>f+m){a.length=g;break}a.sort((g,v)=>em(g.x,v.x)),c=0,o[c++]=a[0].x;for(let g=1,v=a.length;g<v;g++)a[g].x!==o[c-1]&&c<n&&(o[c++]=a[g].x)}return c}function iD(t,e,s,i,r,n,o){const a=ne(M,4);return t.queryControlPoints(a),n0(a,e,s,i,r,n,o)}function ytt(t){return t.getStartXY().norm(1)+t.getEndXY().norm(1)+t.m_cp[0].norm(1)+t.m_cp[1].norm(1)}function _tt(t){return t[0].norm(1)+t[1].norm(1)+t[2].norm(1)+t[3].norm(1)}function vtt(t,e,s){if(F(s>=2),s===2){const g=new M;wi(e[0],e[s-1],1/3,g);const v=new M;return wi(e[0],e[s-1],2/3,v),void t.construct(e[0],g,v,e[s-1])}const i=e[0],r=e[s-1],n=[0,0],o=iD(t,i,de.unit(),!1,Number.NaN,2,n),a=[0,0],l=iD(t,r,de.unit(),!1,Number.NaN,2,a),u=[];for(let g=0;g<o;g++)for(let v=0;v<l;v++){const b=n[g],w=a[v],S=(A,D)=>{const k=Me(s-2,Number.NaN),R=()=>{let se=0;for(let Z=1,te=s-1;Z<te;Z++){se+=M.distance(e[Z-1],e[Z]);const ve=se;k[Z-1]=ve}se+=M.distance(e[s-2],e[s-1]);for(let Z=1,te=s-1;Z<te;Z++)k[Z-1]/=se};let O=!1,z=!1;{const se=new ut;b<=w?(t.queryCut(b,w,se,!0),A.assign(se.get().getControlPoint1()),D.assign(se.get().getControlPoint2())):(t.queryCut(w,b,se,!0),A.assign(se.get().getControlPoint2()),D.assign(se.get().getControlPoint1())),i.equals(A)&&(O=!0),r.equals(D)&&(z=!0)}R();let q=Number.MAX_VALUE;const U=A.clone(),V=D.clone();for(let se=0;se<5;se++)q=hL(!0,!1,i,U,V,r,O,z,k,s-2,e,s);for(let se=0;se<30;se++){const Z=U.clone();V.clone();const te=hL(!0,!0,i,U,V,r,O,z,k,s-2,e,s);if(q<=te&&Z.equals(U)&&Z.equals(V))break;q=te}R();let B=!1,H=Number.EPSILON;const W=A.clone(),ie=D.clone();for(let se=0;se<30;se++){const Z=W.clone();ie.clone();const te=hL(B,!0,i,W,ie,r,O,z,k,s-2,e,s);if(H<=te&&Z.equals(W)&&Z.equals(ie))break;B=!0,H=te}return H<q?(A.assign(W),D.assign(ie)):(A.assign(U),D.assign(V),H=q),H},T=new M,P=new M,I=[S(T,P),M.distance(i,T)+M.distance(T,P)+M.distance(P,r),T.x,T.y,P.x,P.y];u.splice(u.length,0,...I)}let c=u[0],h=u[1],m=0;for(let g=6;g<u.length;g+=6)u[g]<c&&(c=u[g],h=u[g+1],m=g);let f=m;for(let g=0;g<u.length;g+=6)g!==m&&u[g+1]<h&&Math.abs(c-u[g])<10*c&&(h=u[g+1],f=g);t.construct(i,new M(u[f+2],u[f+3]),new M(u[f+4],u[f+5]),r)}function btt(t,e,s=!1){const i=ne(M,4);t.queryControlPoints(i);const r=ne(zs,4);let n,o,a;zb(i,r,!0);const l=r[3].x.isZero(),u=r[3].y.isZero();if(l||u)if(l&&!u){if(r[2].x.isZero())return 0;n=r[1].x.div(r[2].x).negate(),o=r[2].y.div(r[3].y),a=r[1].y.div(r[3].y)}else{if(l||!u||r[2].y.isZero())return 0;n=r[1].y.div(r[2].y).negate(),o=r[2].x.div(r[3].x),a=r[1].x.div(r[3].x)}else{r[2].x.divThis(r[3].x),r[1].x.divThis(r[3].x),r[2].y.divThis(r[3].y),r[1].y.divThis(r[3].y);const f=r[2].x.sub(r[2].y);if(f.isZero())return 0;n=r[1].x.sub(r[1].y).div(f).negate(),o=r[2].x.clone(),a=r[1].x.clone()}if(!s&&n.abs().value()>2)return 0;const c=[0,0],h=t.getStartXY().equals(t.getEndXY()),m=e0(1,-n.toDouble(),n.add(o).mul(n).add(a).toDouble(),de.unit(),h,c);if(m===0)return 0;if(c[0]>=0&&c[0]<=1){const f=n.toDouble()-c[0];if(s||f>=0&&f<=1)return e[0]=c[0],e[1]=f,e[0]>e[1]&&(e[1]=be(e[0],e[0]=e[1])),2}if(m===2&&c[1]>=0&&c[1]<=1){const f=n.toDouble()-c[1];if(s||f>=0&&f<=1)return e[0]=c[1],e[1]=f,e[0]>e[1]&&(e[1]=be(e[0],e[0]=e[1])),2}return 0}function xtt(t,e,s){const i=t[1].mulE(e[2]).subThisE(t[2].mulE(e[1])),r=t[1].mulE(e[3]).subThisE(t[3].mulE(e[1])).mulThis(3),n=t[2].mulE(e[3]).subThisE(t[3].mulE(e[2])).mulThis(3),o=ne(le,2);let a=xa(n,r,i,new de(0,1),!1,o);a<0&&(a=0);let l=0;for(let u=0;u<a;u++)bs(o[u].value(),0,1)||(s[l].setE(o[u]),l++);return l}function L1e(t,e){e[0].set(0);let s=1;const i=ne(le,4);L9(t,i,!0);const r=ne(le,4);V9(t,r,!0);{const n=i[3].mul(3),o=i[2].mul(2),a=i[1].clone(),l=ne(le,2);let u=xa(n,o,a,new de(0,1),!1,l);u<0&&(u=0);for(let c=0;c<u;c++)bs(l[c].value(),0,1)||(e[s]=l[c],s++)}{const n=r[3].mul(3),o=r[2].mul(2),a=r[1].clone(),l=ne(le,2);let u=xa(n,o,a,new de(0,1),!1,l);u<0&&(u=0);for(let c=0;c<u;c++)bs(l[c].value(),0,1)||(e[s]=l[c],s++)}if(s+=xtt(i,r,e.slice(s)),e[s].set(1),s++,s>2){Qc(e,0,s,(c,h)=>{const m=c.value(),f=h.value();return m<f?-1:m>f?1:0});let n=0;const o=e[0].clone();let a=0;const l=_tt(t)*Bs(),u=new M;mM(t,e[0].value(),u);for(let c=1;c<s;c++){const h=new M;if(mM(t,e[c].value(),h),e[c].eq(o)||h.isEqualPoint2D(u,l)){if(n!==0){if(e[c].eps()===0)o.setE(e[c]),a=0;else if(a!==0){const m=Pt(1/e[c].eps()),f=1/a,g=m+f;o.set((e[c].value()*m+o.value()*f)/g),a=1/g,o.setError(Math.sqrt(a))}e[n].setE(o),mM(t,o.value(),u)}}else n++,e[n].setE(e[c]),o.setE(e[c]),mM(t,o.value(),u),a=Pt(e[c].eps())}n++,s=n}return s===1&&(s=2,e[1].set(1)),F(e[0].value()===0),F(e[s-1].value()===1),s}function wtt(t,e,s,i,r){const n=ne(le,4),o=ne(le,3),a=new de(0,1);let l=0;if(e){if(V9(t,n,!1),l=Q3(n[3],n[2],n[1],n[0].sub(s),a,!1,o),i)for(let u=0;u<l;u++){const c=new M;ri(t,o[u].value(),c),i[u]=c.x}}else if(L9(t,n,!1),l=Q3(n[3],n[2],n[1],n[0].sub(s),a,!1,o),i)for(let u=0;u<l;u++){const c=new M;ri(t,o[u].value(),c),i[u]=c.y}if(r)for(let u=0;u<l;u++)r[u]=o[u].value();else i&&Qc(i,0,l,em);return l}function _G(t,e,s){s.setEmpty();const i=[];i.push(new de(0,1));const r=.5*Math.max(e.width(),e.height());for(;i.length;){const n=i.at(-1);i.pop();const o=new Yn;if(vC(t,n,o),o.isIntersectingW(e)){const a=Math.max(o.width(),o.height());if(e.containsW(o)||a<=r||n.width()<1e-12)s.merge(n);else{const l=n.getCenter();i.push(de.construct(n.vmin,l)),i.push(de.construct(l,n.vmax))}}}}function Stt(t,e,s){s.length=0;{const k=new le;R1e(t,k);const R=new je;if(k1e(t,k,R),R.isZero())return k.isZero()||k.eq(new le(1))?0:(s.push(k.value()),1)}const i=ne(le,4);N1e(t,i,!0);const r=ne(le,4);D1e(t,r,!0);const n=ne(le,6),o=i[3].negate().mulE(r[1]).addE(i[2].mulE(r[2]).mul(2)).addE(i[1].mulE(r[3])),a=i[3].negate().mulE(r[1]).subE(i[2].mulE(r[2]).mul(2)).addE(i[1].mulE(r[3])),l=i[2].mulE(i[2]).subE(r[2].mulE(r[2]));n[0]=r[1].mulE(r[1]).mulE(o).addE(i[1].mulE(i[1]).mulE(a)).addE(i[1].mulE(r[1]).mulE(l).mul(2)).mul(6),n[1]=i[2].mulE(r[1]).subE(i[1].mulE(r[2])).mulE(i[2].mulE(i[2]).addE(i[1].mulE(i[3]).mul(2)).addE(r[2].mulE(r[2])).addE(r[1].mulE(r[3]).mul(2))).mul(24);const u=i[1].mulE(r[2]).mulE(r[2]).mulE(r[3]),c=i[2].mulE(i[2]).mulE(i[3]).mulE(r[1]).subE(u).mul(156),h=i[3].mulE(r[1]).subE(i[1].mulE(r[3])),m=i[3].mulE(r[1]).subE(i[1].mulE(r[3])),f=i[1].mulE(i[3]).mulE(m).addE(r[1].mulE(r[3]).mulE(h)).mul(72),g=r[1].mulE(r[3]).subE(i[1].mulE(i[3])),v=i[2].mulE(r[2]).mulE(g).mul(120),b=i[1].mulE(i[2]).mulE(i[2]).mulE(r[3]),w=i[3].mulE(r[1]).mulE(r[2]).mulE(r[2]).subE(b).mul(36);n[2]=c.addE(f).addE(v).addE(w);const S=i[2].mulE(i[3]).mulE(i[3]).mulE(r[1]).subE(i[1].mulE(r[2]).mulE(r[3]).mulE(r[3])).mul(360),T=i[2].mulE(r[2]).mulE(i[2].mulE(i[3]).subE(r[2].mulE(r[3]))).addE(i[3].mulE(r[2]).mulE(r[2]).mulE(r[2])).subE(i[2].mulE(i[2]).mulE(i[2]).mulE(r[3])).mul(24),P=i[2].mulE(r[1]).mulE(r[3]).mulE(r[3]).subE(i[1].mulE(i[3]).mulE(i[3]).mulE(r[2])).mul(72),I=i[3].mulE(r[3]).mulE(r[1].mulE(r[2]).subE(i[1].mulE(i[2]))).mul(288);n[3]=S.addE(T).addE(P).addE(I),n[4]=r[3].mulE(r[3]).addE(i[3].mulE(i[3])).mulE(i[3].mulE(r[1]).subE(i[1].mulE(r[3]))).mul(270).addE(i[3].mulE(r[2]).subE(i[2].mulE(r[3]))).mulE(i[2].mulE(i[3]).addE(r[2].mulE(r[3]))).mul(180),n[5]=i[3].mulE(r[2]).subE(i[2].mulE(r[3])).mulE(i[3].mulE(i[3]).addE(r[3].mulE(r[3]))).mul(216);const A=ne(le,5),D=n1e(n,5,new de(0,1),!1,A,5);if(D>0){let k=Math.abs(t.getCurvature(0)),R=0;const O=Math.abs(t.getCurvature(1));(O>k||!Number.isFinite(O))&&(R=1);for(let z=0;z<D;z++){const q=Math.abs(t.getCurvature(A[z].value()));t.getCoord2D(A[z].value()),(q>k||!Number.isFinite(q))&&(k=q,R=A[z].value())}if((!Number.isFinite(k)||1/k<e)&&!bs(R,0,1)){const z=t.getCoord2D(R);if(!z.equals(t.getStartXY())&&!z.equals(t.getEndXY()))return s.push(R),1}}return 0}let Ett=class{constructor(e,s){this.b=e,this.len=s}getMaxDerivative(){return 1}getValue(e,s){return e===0?this.len-fC(this.b,s,!1):0}getError(e){return 0}};function vG(t,e,s,i,r,n,o){for(;;){const a=M.distance(e[0],e[3]),l=M.distance(e[0],e[1])+M.distance(e[1],e[2])+M.distance(e[2],e[3]);if(l-a<=i+s*l)return t+zt(a,l,.5);const u=I=>Fn(e,1,I).length();if(n===0){F(o<8);let I=u(0),A=u(1);r[0]+=2,I>A&&(A=be(I,I=A),e[3]=be(e[0],e[0]=e[3]),e[2]=be(e[1],e[1]=e[2]));let D=I/(I+A),k=1,R=l;for(;D<1/32&&R>=32*(i+s*R);){k/=4;const O=u(k);r[0]++,D=I/(O+I);const z=new M;if(ri(e,.5*k,z),R=M.distance(z,e[0]),R<=i){const q=new M;ri(e,k,q),R+=M.distance(q,z)}}if(k!==1){const O=ne(M,4);yC(e,k,e,O),t=vG(t,O,s,i,r,0,o+1),n++,o++;continue}}const c=8;r[0]+=c;const h=Gh(c,u,0,1),m=16;r[0]+=m;const f=Gh(m,u,0,1);let g=Math.abs(h-f)>i+s*l;if(!g)return t+f;if(n<3){const I=ne(M,4);yC(e,.5,e,I),t=vG(t,I,s,i,r,n+1,o+1),n++,o++;continue}const v=32;r[0]+=v;const b=Gh(v,u,0,1);if(g=Math.abs(f-b)>i+s*l,!g)return t+b;const w=64;r[0]+=w;const S=Gh(w,u,0,1);if(g=Math.abs(b-S)>i+s*l,!g)return t+S;const T=128;r[0]+=T;const P=Gh(T,u,0,1);return g=Math.abs(S-P)>i+s*l,t+P}}function Ctt(t,e,s,i,r){if(s===e)return 0;const n=ne(M,4);t.queryControlPoints(n);const o=ne(M,4);return r0(n,e,s,o),vG(0,o,i,r,[0],0,0)}function Ptt(t,e,s,i,r){let n=!0;const o=Vb(5,e,s,i,r,l=>{const u=I_(t,1,l);return(n?t.getCoordX(l)-t.getStartX():t.getCoordY(l)-t.getStartY())*u.length()});n=!1;const a=Vb(5,e,s,i,r,l=>{const u=I_(t,1,l);return(n?t.getCoordX(l)-t.getStartX():t.getCoordY(l)-t.getStartY())*u.length()});return new M(o,a)}function Ttt(t,e,s,i,r,n,o,a,l){const u=ne(M,4);t.queryControlPoints(u);const c=ne(M,4);if(e.queryControlPoints(c),u[0].equals(c[0])){if(u[1].equals(c[1])&&u[2].equals(c[2])&&u[3].equals(c[3]))return s&&(s.length=0,s.push(u[0]),s.push(u[3])),i&&(i.length=0,i.push(0),i.push(1)),r&&(r.length=0,r.push(0),r.push(1)),!0;if(!u[0].equals(c[3]))return!1}return!!(u[0].equals(c[3])&&u[1].equals(c[2])&&u[2].equals(c[1])&&u[3].equals(c[0]))&&(i&&(i.length=0,i.push(0),i.push(1),l&&(i[1]=be(i[0],i[0]=i[1]))),r&&(r.length=0,r.push(1),r.push(0),l&&(r[1]=be(r[0],r[0]=r[1]))),s&&(s.length=0,s.push(u[0]),s.push(u[3]),l&&(s[1]=be(s[0],s[0]=s[1]))),!0)}function hL(t,e,s,i,r,n,o,a,l,u,c,h){let m=0,f=0,g=0,v=0,b=0,w=0,S=0;for(let P=1,I=h-1;P<I;P++){let A,D,k,R,O,z,q=-1,U=l[P-1];t&&(P>2?(U=ys(2*l[P-2]-l[P-3],0,1),l[P-1]=U):P===2&&U<=l[0]&&(U=l[0]));for(let H=0;H<11&&(A=l[P-1],D=A*A,k=D*A,R=1-A,O=R*R,z=O*R,t)&&!(Math.abs(A-q)<1e-12)&&H!==10;H++){const W=s.x-2*i.x+r.x,ie=s.x-3*i.x+3*r.x-n.x,se=s.y-2*i.y+r.y,Z=s.y-3*i.y+3*r.y-n.y,te=s.x-i.x-2*W*A+ie*D,ve=-c[P].x+s.x*z+A*(3*i.x*O+A*(3*r.x-3*r.x*A+n.x*A)),ke=s.y-i.y-2*se*A+Z*D,Fe=-c[P].y+s.y*z+A*(3*i.y*O+A*(3*r.y-3*r.y*A+n.y*A));q=A;const Pe=A- -6*(te*ve+ke*Fe)/(6*(3*Pt(te)-(-2*W+2*ie*A)*ve)+6*(3*Pt(ke)-(-2*se+2*Z*A)*Fe));l[P-1]=ys(Pe,P>1?l[P-2]:0,1)}m+=3*D*O*O,f+=3*k*z,g+=3*D*D*O;const V=-(z*s.x+k*n.x-c[P].x);v+=V*A*O,b+=V*D*R;const B=-(z*s.y+k*n.y-c[P].y);w+=B*A*O,S+=B*D*R}if(e){const P=m*g-f*f;Math.abs(P)>=1e-12*(Math.abs(m*g)+Math.abs(f*f))+1e-10?(o||(i.x=(v*g-b*f)/P,i.y=(w*g-S*f)/P),a||(r.x=(m*b-f*v)/P,r.y=(m*S-f*w)/P)):(wi(s,n,.3,i),wi(s,n,.6,r))}let T=0;for(let P=1,I=h-1;P<I;P++){const A=l[P-1],D=1-A,k=s.mul(iie(D)),R=i.mul(3*A*D*D),O=r.mul(3*A*A*D),z=n.mul(iie(A));T+=k.add(R).add(O).add(z).sub(c[P]).sqrLength()}return T}function lre(t,e,s,i){const r=t.getPathStart(e),n=t.getPathEnd(e);if(n-r<3)return;const o=2*r,a=M.getNAN();s.queryPoint2D(o,a);const l=a.x,u=a.y,c=M.getNAN();s.queryPoint2D(o+2,c);const h=M.getNAN();for(let m=o+4,f=2*n;m<f;m+=2)s.queryPoint2D(m,h),i.pe((h.x-a.x)*(c.y-u)),a.setCoordsPoint2D(c),c.setCoordsPoint2D(h);i.pe((l-a.x)*(c.y-u))}function Itt(t,e,s){for(;e.hasNextSegment();){const i=e.nextCurve();if(i===null)break;s.pe(2*i.calculateArea2DHelper())}}var Zt=Es;let Nm=class{static toSegType(e){let s=0;switch(e){case G.enumLine:s=1;break;case G.enumBezier:s=2;break;case G.enumEllipticArc:s=4;break;case G.enumRationalBezier2:s=8;break;case G.enumBezier2:s=16;break;default:Ce("")}return s}constructor(){this.m_segmentFlags=null,this.m_segmentParamIndex=null,this.m_segmentParams=null,this.m_curveCount=0,this.m_bezierCount=0,this.m_arcCount=0,this.m_rbezier2Count=0,this.m_bezier2Count=0,this.m_curveParamWritePoint=0}assignCopy(e){return this.m_segmentFlags=e.m_segmentFlags,this.m_segmentParamIndex=e.m_segmentParamIndex,this.m_segmentParams=e.m_segmentParams,this.m_curveCount=e.m_curveCount,this.m_bezierCount=e.m_bezierCount,this.m_arcCount=e.m_arcCount,this.m_rbezier2Count=e.m_rbezier2Count,this.m_bezier2Count=e.m_bezier2Count,this.m_curveParamWritePoint=e.m_curveParamWritePoint,this}},G9=class Va extends X0e{constructor(e){super(e),this.m_cachedRingAreas2D=null,this.m_paths=null,this.m_pathFlags=null,this.m_curveData=null,e.move?(this.m_bPolygon=e.move.m_bPolygon,this.m_cachedLength2D=e.move.m_cachedLength2D,this.m_cachedArea2D=e.move.m_cachedArea2D,this.m_currentPathIndex=e.move.m_currentPathIndex,this.m_cachedRingAreas2D=e.move.m_cachedRingAreas2D,this.m_paths=e.move.m_paths,this.m_pathFlags=e.move.m_pathFlags,this.m_curveData=e.move.m_curveData,e.move.m_curveData=null,e.move.setEmpty()):(this.m_bPolygon=e.bPolygon,this.m_cachedLength2D=0,this.m_cachedArea2D=0,this.m_currentPathIndex=0)}getGeometryType(){return this.m_bPolygon?G.enumPolygon:G.enumPolyline}getDimension(){return this.m_bPolygon?2:1}changeRingStartPoint(e){F(this.m_bPolygon);const s=this.getPathIndexFromPointIndex(e),i=this.getPathStart(s);if(i===e)return;const r=this.getPathEnd(s);(e>=r||e<i)&&ee("change_ring_start_point");for(let n=0,o=this.m_description.getAttributeCount();n<o;n++){const a=this.m_description.getSemantics(n),l=Zt.getComponentCount(a);this.m_vertexAttributes.get(n).rotate(i*l,e*l,r*l)}this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.rotate(i,e,r),this.m_curveData.m_segmentParamIndex.rotate(i,e,r))}setFillRule(e){this.m_bFillRule=e===1}getFillRule(){return this.m_bFillRule?1:0}isExteriorRingOGC(e){return!!this.m_bPolygon&&(this.updateOGCFlagsProtected(),!!(8&this.m_pathFlags.read(e)))}isExteriorRing(e){return this.calculateRingArea2D(e)>0}calculateRingArea2D(e){return this.m_bPolygon?(this.updateRingAreas2DProtected(),this.m_cachedRingAreas2D.read(e)):0}updateRingAreas2DProtected(){if(!this.hasDirtyFlag(1024))return;const e=this.getPathCount();if(e===0)return this.hasDirtyFlag(1024)&&(this.m_cachedArea2D=0),void this.setDirtyFlagProtected(1024,!1);const s=new ag(e),i=new Fr(0),r=new Fr(0);if(this.m_pointCount!==0){const n=this.getAttributeStreamRef(0);if(this.hasNonLinearSegments()){const o=new aL({parent:this});for(o.stripAttributes();o.nextPath();){r.reset();const a=o.getPathIndex();lre(this,a,n,r),Itt(this,o,r);const l=.5*r.getResult();i.add(l),s.write(a,l)}}else for(let o=0;o<e;o++){r.reset(),lre(this,o,n,r);const a=.5*r.getResult();i.add(a),s.write(o,a)}}this.hasDirtyFlag(1024)&&(this.m_cachedArea2D=i.getResult(),this.m_cachedRingAreas2D=s,this.setDirtyFlagProtected(1024,!1))}getOGCPolygonCount(){if(!this.m_bPolygon)return 0;this.updateOGCFlagsProtected();let e=0;const s=this.getPathCount();for(let i=0;i<s;i++)8&this.m_pathFlags.read(i)&&e++;return e}getHashCodeImpl(){return F(0),0}equalsImpl(e){const s=e,i=this.getPathCount();if(i!==s.getPathCount())return!1;const r=this.hasNonLinearSegments();if(r!==s.hasNonLinearSegments()||r&&(this.m_curveData.m_curveCount!==s.m_curveData.m_curveCount||this.m_curveData.m_bezierCount!==s.m_curveData.m_bezierCount)||this.m_paths&&!this.m_paths.equals(s.m_paths,0,i+1)||this.m_bFillRule!==s.m_bFillRule||!this.m_bPolygon&&this.m_pathFlags&&!this.m_pathFlags.equals(s.m_pathFlags,0,i))return!1;if(this.hasNonLinearSegments()){if(!this.m_curveData.m_segmentFlags.equals(s.m_curveData.m_segmentFlags,0,this.getPointCount()))return!1;for(let n=0,o=this.getPointCount();n<o;n++){const a=this.m_curveData.m_segmentFlags.read(n);if(!Va.isNonLinearSegmentFlag(a))continue;const l=this.m_curveData.m_segmentParamIndex.read(n),u=s.m_curveData.m_segmentParamIndex.read(n),c=Al(a);for(let h=0;h<c;h++){const m=this.m_curveData.m_segmentParams.read(l+h),f=s.m_curveData.m_segmentParams.read(u+h);if(!uo(m,f))return!1}}}return!0}equalsImplTol(e,s){const i=e,r=this.getPathCount();if(r!==i.getPathCount())return!1;const n=this.hasNonLinearSegments();if(n!==i.hasNonLinearSegments()||n&&(this.m_curveData.m_curveCount!==i.m_curveData.m_curveCount||this.m_curveData.m_bezierCount!==i.m_curveData.m_bezierCount)||this.m_paths&&!this.m_paths.equals(i.m_paths,0,r+1)||this.m_bFillRule!==i.m_bFillRule||!this.m_bPolygon&&this.m_pathFlags&&!this.m_pathFlags.equals(i.m_pathFlags,0,r))return!1;if(!n)return!0;if(!this.m_curveData.m_segmentFlags.equals(i.m_curveData.m_segmentFlags,0,this.getPointCount()))return!1;const o=this.querySegmentIterator(),a=i.querySegmentIterator();for(;o.nextPath();){if(!a.nextPath())return!1;for(;o.hasNextSegment();){const l=o.nextCurve(),u=a.nextCurve();if(!(l&&u&&l.equals(u,s))){if(!l&&!u)break;return!1}}}return!0}reserveImplImpl(e,s){this.m_curveData&&this.m_curveData.m_segmentFlags&&(this.m_curveData.m_segmentFlags.resize(e,1),this.m_curveData.m_segmentParamIndex.resize(e,-1),this.checkCompactSegmentParams())}verifyStreamsAfterSizeChangeExtraImpl(){this.m_paths||(this.m_paths=yn(1,0),this.m_pathFlags=Oh(1,0)),this.m_curveData&&this.m_curveData.m_segmentFlags&&(this.m_curveData.m_segmentFlags.resize(this.m_reservedPointCount,1),this.m_curveData.m_segmentParamIndex.resize(this.m_reservedPointCount,-1),this.checkCompactSegmentParams())}copyToImpl(e,s){const i=e;i.m_bPathStarted=!1,i.m_bFillRule=this.m_bFillRule,this.m_paths?i.m_paths=s?this.m_paths:this.m_paths.clone():i.m_paths=null,this.m_pathFlags?i.m_pathFlags=s?this.m_pathFlags:this.m_pathFlags.clone():i.m_pathFlags=null,this.m_curveData&&(i.m_curveData||(i.m_curveData=new Nm),i.m_curveData.assignCopy(this.m_curveData),i.m_curveData.m_curveCount=0,i.updateCurveCounter(this.m_curveData.m_curveCount),s||(this.m_curveData.m_segmentParamIndex?i.m_curveData.m_segmentParamIndex=this.m_curveData.m_segmentParamIndex.clone():i.m_curveData.m_segmentParamIndex=null,this.m_curveData.m_segmentFlags?i.m_curveData.m_segmentFlags=this.m_curveData.m_segmentFlags.clone():i.m_curveData.m_segmentFlags=null,this.m_curveData.m_segmentParams?i.m_curveData.m_segmentParams=this.m_curveData.m_segmentParams.clone():i.m_curveData.m_segmentParams=null)),i.hasDirtyFlag(512)||(i.m_cachedLength2D=this.m_cachedLength2D),i.m_cachedRingAreas2D=null,i.hasDirtyFlag(1024)||(i.m_cachedArea2D=this.m_cachedArea2D,this.m_cachedRingAreas2D!==null&&(i.m_cachedRingAreas2D=s?this.m_cachedRingAreas2D:this.m_cachedRingAreas2D.clone()))}calculateArea2D(){return this.m_bPolygon?(this.updateRingAreas2DProtected(),this.m_cachedArea2D):0}calculateLength2D(){if(!this.hasDirtyFlag(512))return this.m_cachedLength2D;const e=this.querySegmentIterator(),s=new Fr(0);for(;e.nextPath();)for(;e.hasNextSegment();)s.add(e.nextSegment().calculateLength2D());return this.hasDirtyFlag(512)&&(this.m_cachedLength2D=s.getResult()),this.setDirtyFlagProtected(512,!1),s.getResult()}calculatePathLength2D(e){const s=this.querySegmentIteratorAtVertex(this.getPathStart(e)),i=new Fr(0);for(;s.hasNextSegment();)i.add(s.nextSegment().calculateLength2D());return i.getResult()}calculateLength3D(e){return F(0),0}calculatePathLength3D(e,s){return F(0),0}copyTo(e){xt(e.getGeometryType())||ee(""),this!==e&&super.copyTo(e)}swap(e){F(0)}hasNonLinearSegments(){return this.getCurveCount()!==0}getSegmentCount(){let e=this.getPointCount();if(!this.m_bPolygon){e-=this.getPathCount();for(let s=0,i=this.getPathCount();s<i;s++)this.isClosedPath(s)&&e++}return e}getSegmentCountPath(e){let s=this.getPathSize(e);return!this.isClosedPath(e)&&s>0&&s--,s}add(e,s){this===e&&ee("Multi_path_impl::add");for(let i=0,r=e.getPathCount();i<r;i++)this.addPath(e,i,!s)}addPath(e,s,i){this.insertPath(-1,e,s,i)}addPathPoint2D(e,s,i){this.insertPath2D(-1,e,0,s,i)}addPathMultiPoint(e,s,i,r){i<0&&(i=e.getPointCount()-s),this.insertPointsFromMultipoint(-1,0,e,s,i,r)}addSegmentsFromPath(e,s,i,r,n){if(this===e&&ee("Multi_path_impl.add_segments_from_path"),n||this.getPathCount()!==0||(n=!0),s<0&&(s=e.getPathCount()-1),(s>=e.getPathCount()||i<0||r<0||i+r>e.getSegmentCountPath(s))&&bt("add_segments_from_path"),r===0)return;const o=e.getPathStart(s),a=e.isClosedPath(s)&&i+r===e.getSegmentCountPath(s);this.m_bPathStarted=!1,this.mergeVertexDescription(e.getDescription());let l=r;const u=o+i;let c=u+1;n&&(l++,c--),!n&&e.hasNonLinearSegments()&&e.m_curveData.m_segmentFlags.read(u)!==1&&(e.getXY(u).equals(this.getXY(this.m_pointCount-1))||ee("add_segments_from_path: start point mismatch"));const h=this.m_pointCount;if(this.resizeImpl(this.m_pointCount+l),this.verifyAllStreamsAfterSizeChange(),n){if(l===0)return;this.m_paths.add(this.m_pointCount);let f=e.m_pathFlags.read(s);this.m_bPolygon&&(f|=1),this.m_pathFlags.write(this.m_pathFlags.size()-1,f),this.m_pathFlags.add(0)}else this.m_paths.write(this.m_pathFlags.size()-1,this.m_pointCount);const m=a?l-1:l;for(let f=0,g=this.m_description.getAttributeCount();f<g;f++){const v=this.m_description.getSemantics(f),b=Zt.getComponentCount(v),w=e.m_description.getAttributeIndex(v);if(m>0){if(w<0||!e.m_vertexAttributes.get(w)){const S=Zt.getDefaultValue(v);this.m_vertexAttributes.get(f).insertRange(b*h,S,m*b,b*h),a&&this.m_vertexAttributes.get(f).insertRange(b*h+m*b,S,b,b*h);continue}this.m_vertexAttributes.get(f).insertRangeFromStream(b*h,e.m_vertexAttributes.get(w),b*c,m*b,!0,b,b*h)}a&&this.m_vertexAttributes.get(f).insertRangeFromStream(b*(h+m),e.m_vertexAttributes.get(w),b*o,b,!0,b,b*(h+m))}if(this.hasNonLinearSegments()&&this.initSegmentData(0),e.hasNonLinearSegments()){let f=0;for(let g=0,v=u;g<r;g++)f+=Al(e.m_curveData.m_segmentFlags.read(v)),v++;if(f>0){this.initSegmentData(f);let g=u,v=h-(n?0:1),b=0;for(let w=0;w<r;w++){const S=e.m_curveData.m_segmentFlags.read(g);if(this.m_curveData.m_segmentFlags.write(v,S),Va.isNonLinearSegmentFlag(S)){b++;let T=e.m_curveData.m_segmentParamIndex.read(g);const P=Al(S);this.m_curveData.m_segmentParamIndex.write(v,this.m_curveData.m_curveParamWritePoint);for(let I=0;I<P;I++){const A=e.m_curveData.m_segmentParams.read(T);this.m_curveData.m_segmentParams.write(this.m_curveData.m_curveParamWritePoint,A),this.m_curveData.m_curveParamWritePoint++,T++}this.incCurveType(S,1)}else this.m_curveData.m_segmentParamIndex.write(v,-1);v++,g++}this.modifyCurveCounter(b)}}if(a){const f=this.getPathCount()-1,g=this.getPathStart(f),v=this.getPathEnd(f)-1,b=this.getXY(g),w=this.getXY(v);b.isEqualPoint2D(w)&&(--this.m_pointCount,this.m_paths.write(f+1,this.m_pointCount))}this.notifyModifiedFlags(2001)}reverseAllPaths(){for(let e=0,s=this.getPathCount();e<s;e++)this.reversePath(e)}reversePath(e){e>=this.getPathCount()&&ee("");const s=this.getPathSize(e);if(s===0)return;const i=this.getPathStart(e),r=this.isClosedPath(e);if(this.hasNonLinearSegments()){let a=i;const l=new this.m_segmentBufferCTor;let u=!1;for(let c=0;c<s;c++,a++){const h=this.m_curveData.m_segmentFlags.read(a);if(!Va.isNonLinearSegmentFlag(h))continue;u=!0,this.querySegment(a,l,!0),l.get().reverse();const m=this.m_curveData.m_segmentParamIndex.read(a);l.get().writeInBufferStream(this.m_curveData.m_segmentParams,m)}if(u){const c=r?0:1;this.m_curveData.m_segmentFlags.reverseRange(i,s-c,1),this.m_curveData.m_segmentParamIndex.reverseRange(i,s-c,1)}}const n=r?1:0;for(let a=0,l=this.m_description.getAttributeCount();a<l;a++)if(this.m_vertexAttributes.get(a)){const u=this.m_description.getSemantics(a),c=Zt.getComponentCount(u);this.m_vertexAttributes.get(a).reverseRange(c*(i+n),c*(s-n),c)}const o=6&this.m_pathFlags.read(e);if(o){let a=0;4&o&&(a|=2),2&o&&(a|=4),this.m_pathFlags.clearBits(e,6),this.m_pathFlags.setBits(e,a)}this.notifyModifiedFlags(1233)}removePath(e){const s=this.getPathCount();e<0&&(e=s-1),e>=s&&ee("");const i=this.getPathStart(e),r=this.getPathSize(e);for(let n=0,o=this.m_description.getAttributeCount();n<o;n++)if(this.m_vertexAttributes.get(n)){const a=this.m_description.getSemantics(n),l=Zt.getComponentCount(a);this.m_vertexAttributes.get(n).eraseRange(l*i,l*r,l*this.m_pointCount)}if(this.hasNonLinearSegments()){let n=0;for(let o=i,a=i+r;o<a;o++){const l=this.m_curveData.m_segmentFlags.read(o);Va.isNonLinearSegmentFlag(l)&&(this.incCurveType(l,-1),n++)}this.modifyCurveCounter(-n),this.m_curveData.m_segmentFlags.eraseRange(i,r,this.m_pointCount),this.m_curveData.m_segmentParamIndex.eraseRange(i,r,this.m_pointCount)}for(let n=e+1;n<=s;n++){const o=this.m_paths.read(n);this.m_paths.write(n-1,o-r)}if(this.m_pathFlags)for(let n=e+1;n<=s;n++){const o=this.m_pathFlags.read(n);this.m_pathFlags.write(n-1,o)}this.m_paths.resize(s),this.m_pathFlags.resize(s),this.m_pointCount-=r,this.m_reservedPointCount-=r,e===s-1&&(this.m_bPathStarted=!1),this.notifyModifiedFlags(2001),this.checkCompactSegmentParams(),this.dbgVerifyCurves()}dbgVerifyCurves(){}insertPath(e,s,i,r){this===s&&ee("Multi_path_impl::insert_path");const n=this.getPathCount();if(!r&&s.hasNonLinearSegmentsPath(i))return e=this.insertPath(e,s,i,!0),this.reversePath(e),e;i>=s.getPathCount()&&ee(""),e>n&&ee(""),e<0&&(e=n),i<0&&(i=s.getPathCount()-1),this.m_bPathStarted=!1,this.mergeVertexDescription(s.getDescription());const o=s.getPathStart(i),a=s.getPathSize(i);if(a===0)return this.insertPath2D(e,null,0,0,!0);const l=this.m_pointCount,u=s.isClosedPath(i)&&!r?1:0;this.resizeImpl(this.m_pointCount+a),this.verifyAllStreamsAfterSizeChange();const c=e<n?this.getPathStart(e):l;for(let f=0,g=this.m_description.getAttributeCount();f<g;f++){const v=this.m_description.getSemantics(f),b=s.getDescription().getAttributeIndex(v),w=Zt.getComponentCount(v);if(b>=0&&s.m_vertexAttributes.get(b))u!==0&&this.m_vertexAttributes.get(f).insertRangeFromStream(c*w,s.m_vertexAttributes.get(b),w*o,w,!0,w,w*l),this.m_vertexAttributes.get(f).insertRangeFromStream((c+u)*w,s.m_vertexAttributes.get(b),w*(o+u),w*(a-u),r,w,w*(l+u));else{const S=Zt.getDefaultValue(v);this.m_vertexAttributes.get(f).insertRange(c*w,S,w*a,w*l)}}const h=l+a;this.m_paths.add(h);for(let f=n;f>=e+1;f--){const g=this.m_paths.read(f-1);this.m_paths.write(f,g+a)}this.m_pathFlags.add(0);for(let f=n-1;f>=e+1;f--){let g=this.m_pathFlags.read(f);g&=-9,this.m_pathFlags.write(f+1,g)}let m=s.getPathFlagsStreamRef().read(i);if(m&=-9,this.m_bPolygon&&(m|=1),this.m_pathFlags.write(e,m),s.hasNonLinearSegments()){this.initSegmentData(0);let f=o,g=0;for(let v=0;v<a;v++)g+=Al(s.m_curveData.m_segmentFlags.read(f)),f++;if(g>0){this.m_curveData.m_segmentFlags===null?(this.m_curveData.m_segmentFlags=Oh(this.m_pointCount,1),this.m_curveData.m_segmentParamIndex=yn(this.m_pointCount,-1)):(this.m_curveData.m_segmentFlags.insertRange(c,1,a,l),this.m_curveData.m_segmentParamIndex.insertRange(c,-1,a,l)),this.m_curveData.m_segmentParams?this.m_curveData.m_segmentParams.resize(this.m_curveData.m_curveParamWritePoint+g):this.m_curveData.m_segmentParams=fa(g),f=o;let v=c,b=0;for(let w=0;w<a;w++){const S=s.m_curveData.m_segmentFlags.read(f);if(Va.isNonLinearSegmentFlag(S)){this.m_curveData.m_segmentFlags.write(v,S),this.m_curveData.m_segmentParamIndex.write(v,this.m_curveData.m_curveParamWritePoint);const T=Al(S);let P=s.m_curveData.m_segmentParamIndex.read(f);for(let I=0;I<T;I++){const A=s.m_curveData.m_segmentParams.read(P);this.m_curveData.m_segmentParams.write(this.m_curveData.m_curveParamWritePoint,A),this.m_curveData.m_curveParamWritePoint++,P++}b++,this.incCurveType(S,1)}f++,v++}this.modifyCurveCounter(b)}}return this.notifyModifiedFlags(2001),e}insertPath2D(e,s,i,r,n){const o=this.getPathCount();(e>o||i<0)&&ee(""),e<0&&(e=o),this.m_bPathStarted=!1;const a=this.m_pointCount;this.resizeImpl(this.m_pointCount+r),r===0&&this.notifyModifiedFlags(32),this.verifyAllStreamsAfterSizeChange();const l=e<o?this.getPathStart(e):a;if(s)this.m_vertexAttributes.get(0).insertRangeFromPoints(2*l,s,i,r,n,2*a);else{const u=Zt.getDefaultValue(0);this.m_vertexAttributes.get(0).insertRange(2*l,u,2*r,2*a)}for(let u=1,c=this.m_description.getAttributeCount();u<c;u++){const h=this.m_description.getSemantics(u),m=Zt.getComponentCount(h),f=Zt.getDefaultValue(h);this.m_vertexAttributes.get(u).insertRange(l*m,f,m*r,m*a)}this.m_paths.add(this.m_pointCount);for(let u=o;u>=e+1;u--){const c=this.m_paths.read(u-1);this.m_paths.write(u,c+r)}this.m_pathFlags.add(0);for(let u=o-1;u>=e+1;u--){let c=this.m_pathFlags.read(u);c&=-9,this.m_pathFlags.write(u+1,c)}return this.m_bPolygon&&this.m_pathFlags.write(e,1),this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.insertRange(l,1,r,a),this.m_curveData.m_segmentParamIndex.insertRange(l,-1,r,a)),this.notifyModifiedFlags(2001),e}insertPathFromMultipoint(e,s,i,r,n){const o=s.getImpl(),a=this.getPathCount();(e>a||i<0)&&ee("");const l=r<0?o.getPointCount()-i:r;if(l>o.getPointCount()&&ee(""),i>=o.getPointCount()&&ee("pointsOffset"),e<0&&(e=a),this.m_bPathStarted=!1,this.mergeVertexDescription(o.getDescription()),l===0)return void this.insertPath2D(e,null,0,0,!0);const u=this.m_pointCount,c=i;this.resizeImpl(this.m_pointCount+l),this.verifyAllStreamsAfterSizeChange();const h=e<a?this.getPathStart(e):u;for(let g=0,v=this.m_description.getAttributeCount();g<v;g++){const b=this.m_description.getSemantics(g),w=o.getDescription().getAttributeIndex(b),S=Zt.getComponentCount(b);if(w>=0){const T=o.getAttributeStreamRef(b);this.m_vertexAttributes.get(g).insertRangeFromStream(h*S,T,S*c,S*l,n,S,S*u)}else{const T=Zt.getDefaultValue(b);this.m_vertexAttributes.get(g).insertRange(h*S,T,S*l,S*u)}}const m=u+l;this.m_paths.add(m);for(let g=a;g>=e+1;g--){const v=this.m_paths.read(g-1);this.m_paths.write(g,v+l)}this.m_pathFlags.add(0);for(let g=a-1;g>=e+1;g--){let v=this.m_pathFlags.read(g);v&=-9,this.m_pathFlags.write(g+1,v)}let f=0;this.m_bPolygon&&(f|=1),this.m_pathFlags.write(e,f),this.notifyModifiedFlags(2001)}insertPoints(e,s,i,r,n,o,a){var f;if(this===i&&ee("Multi_path_impl.insert_points"),e<0&&(e=this.getPathCount()),r<0&&(r=i.getPathCount()-1),(e>this.getPathCount()||s>=0&&s>this.getPathSize(e)||r>=i.getPathCount()||o>i.getPathSize(r))&&bt(""),!o)return;if(this.mergeVertexDescription(i.m_description),e===this.getPathCount()){this.m_paths.add(this.m_pointCount);let g=i.m_pathFlags.read(r);g&=-9,this.m_bPolygon?this.m_pathFlags.add(1|g):this.m_pathFlags.add(g)}s<0&&(s=this.getPathSize(e));const l=this.m_pointCount;this.resizeImpl(this.m_pointCount+o),this.verifyAllStreamsAfterSizeChange();const u=this.getPathStart(e),c=u+s;o<0&&(o=i.getPathSize(r));const h=i.getPathStart(r),m=h+o;for(let g=0,v=this.m_description.getAttributeCount();g<v;g++){const b=this.m_description.getSemantics(g),w=Zt.getComponentCount(b),S=i.m_description.getAttributeIndex(b);if(S<0||!i.m_vertexAttributes.get(S)){const T=Zt.getDefaultValue(b);this.m_vertexAttributes.get(g).insertRange(w*c,T,m*w,w*l)}else(f=this.m_vertexAttributes.get(g))==null||f.insertRangeFromStream(w*(u+s),i.m_vertexAttributes.get(S),w*(h+n),o*w,a,w,w*l)}this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.insertRange(u+s,1,o,l),this.m_curveData.m_segmentParamIndex.insertRange(u+s,-1,o,l),s>0&&this.isNonLinearSegment(u+s-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(u+s-1),-1),this.m_curveData.m_segmentFlags.write(u+s-1,1),this.m_curveData.m_segmentParamIndex.write(u+s-1,-1),this.modifyCurveCounter(-1)));for(let g=e+1,v=this.getPathCount();g<=v;g++){const b=this.m_paths.read(g);this.m_paths.write(g,b+o)}this.notifyModifiedFlags(2001)}insertPointsFromPoints(e,s,i,r,n,o){if(e<0&&(e=this.getPathCount()),(e>this.getPathCount()||s>this.getPathSize(e)||r<0)&&bt(""),!n)return;e===this.getPathCount()&&(this.m_paths.add(this.m_pointCount),this.m_bPolygon?this.m_pathFlags.add(1):this.m_pathFlags.add(0)),s<0&&(s=this.getPathSize(e));const a=this.m_pointCount;this.resizeImpl(this.m_pointCount+n),this.verifyAllStreamsAfterSizeChange();const l=this.getPathStart(e);this.m_vertexAttributes.get(0).insertRangeFromPoints(2*(l+s),i,r,n,o,2*a);for(let u=1,c=this.m_description.getAttributeCount();u<c;u++){const h=this.m_description.getSemantics(u),m=Zt.getComponentCount(h),f=Zt.getDefaultValue(h);this.m_vertexAttributes.get(u).insertRange((l+s)*m,f,m*n,m*a)}this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.insertRange(l+s,1,n,a),this.m_curveData.m_segmentParamIndex.insertRange(l+s,-1,n,a),s>0&&this.isNonLinearSegment(l+s-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(l+s-1),-1),this.m_curveData.m_segmentFlags.write(l+s-1,1),this.m_curveData.m_segmentParamIndex.write(l+s-1,-1),this.modifyCurveCounter(-1)));for(let u=e+1,c=this.getPathCount();u<=c;u++)this.m_paths.write(u,this.m_paths.read(u)+n);this.notifyModifiedFlags(2001)}insertPointsFromMultipoint(e,s,i,r,n,o){const a=i.getImpl(),l=this.getPathCount();e<0&&(e=this.getPathCount());const u=a.getPointCount();if((r<0||r>u)&&bt(""),(n<0||r+n>u)&&(n=u-r),s<0&&(s=e<l?this.getPathSize(e):0),(e>l||e<l&&s>this.getPathSize(e)||e===l&&s>0||n<0)&&bt(""),!n)return;if(this.mergeVertexDescription(a.getDescription()),e===l){this.m_paths.add(this.m_pointCount);const v=0;this.m_bPolygon?this.m_pathFlags.add(1|v):this.m_pathFlags.add(v)}s<0&&(s=this.getPathSize(e));const c=this.m_pointCount;this.resizeImpl(this.m_pointCount+n),this.verifyAllStreamsAfterSizeChange();const h=this.getPathStart(e),m=h+s,f=0,g=f+n;for(let v=0,b=this.m_description.getAttributeCount();v<b;v++){const w=this.m_description.getSemantics(v),S=Zt.getComponentCount(w);if(a.getDescription().getAttributeIndex(w)<0){const P=Zt.getDefaultValue(w);this.m_vertexAttributes.get(v).insertRange(S*m,P,g*S,S*c);continue}const T=a.getAttributeStreamRef(w);this.m_vertexAttributes.get(v).insertRangeFromStream(S*(h+s),T,S*(f+r),n*S,o,S,S*c)}this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.insertRange(h+s,1,n,c),this.m_curveData.m_segmentParamIndex.insertRange(h+s,-1,n,c),s>0&&this.isNonLinearSegment(h+s-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(h+s-1),-1),this.m_curveData.m_segmentFlags.write(h+s-1,1),this.m_curveData.m_segmentParamIndex.write(h+s-1,-1),this.modifyCurveCounter(-1)));for(let v=e+1,b=this.getPathCount();v<=b;v++){const w=this.m_paths.read(v);this.m_paths.write(v,w+n)}this.notifyModifiedFlags(2001)}insertPoint2D(e,s,i){const r=this.getPathCount();e<0&&(e=r),(e>r||e<r&&s>this.getPathSize(e))&&bt(""),e===r&&this.addPathPoint2D(null,0,!0);const n=this.m_pointCount;this.resizeImpl(this.m_pointCount+1),this.verifyAllStreamsAfterSizeChange();const o=this.getPathStart(e),a=s<0?this.getPathSize(e)+o:s+o,l=this.m_vertexAttributes.get(0);if(a===n)this.m_paths.write(e+1,n+1),l.writePoint2D(2*a,i);else{l.insert(2*a,i,2*n);for(let u=1,c=this.m_description.getAttributeCount();u<c;u++){const h=this.m_description.getSemantics(u),m=Zt.getComponentCount(h),f=Zt.getDefaultValue(h);this.m_vertexAttributes.get(u).insertRange(m*a,f,m,m*n)}this.m_curveData&&this.m_curveData.m_segmentFlags&&(this.m_curveData.m_segmentFlags.insertRange(a,1,1,n),this.m_curveData.m_segmentParamIndex.insertRange(a,-1,1,n));for(let u=e+1,c=r;u<=c;u++)this.m_paths.write(u,this.m_paths.read(u)+1)}this.m_curveData&&this.m_curveData.m_segmentFlags&&a>o&&this.isNonLinearSegment(a-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(a-1),-1),this.modifyCurveCounter(-1),this.m_curveData.m_segmentFlags.write(a-1,1),this.m_curveData.m_segmentParamIndex.write(a-1,-1)),this.notifyModifiedFlags(2001)}insertPoint(e,s,i){const r=this.getPathCount();e<0&&(e=r),(e>r||e<r&&s>this.getPathSize(e))&&bt(""),e===r&&this.addPathPoint2D(null,0,!0);const n=this.m_pointCount;this.resizeImpl(this.m_pointCount+1),this.verifyAllStreamsAfterSizeChange();const o=this.getPathStart(e),a=s<0?this.getPathSize(e)+o:s+o;if(a===n)this.m_paths.write(e+1,n+1),this.setPointByVal(a,i);else{const l=i.getDescription();this.m_description!==l&&this.mergeVertexDescription(l);for(let u=0,c=this.m_description.getAttributeCount();u<c;u++){const h=this.m_description.getSemantics(u),m=Zt.getComponentCount(h);if(l.hasAttribute(h))this.m_vertexAttributes.get(u).insertAttributes(m*a,i,h,m*n);else{const f=Zt.getDefaultValue(h);this.m_vertexAttributes.get(u).insertRange(m*a,f,m,m*n)}}this.m_curveData&&this.m_curveData.m_segmentFlags&&(this.m_curveData.m_segmentFlags.insertRange(a,1,1,n),this.m_curveData.m_segmentParamIndex.insertRange(a,-1,1,n));for(let u=e+1,c=r;u<=c;u++)this.m_paths.write(u,this.m_paths.read(u)+1)}this.m_curveData&&this.m_curveData.m_segmentFlags&&a>o&&this.isNonLinearSegment(a-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(a-1),-1),this.modifyCurveCounter(-1),this.m_curveData.m_segmentFlags.write(a-1,1),this.m_curveData.m_segmentParamIndex.write(a-1,-1)),this.notifyModifiedFlags(2001)}removePointFromPath(e,s){const i=this.getPathCount();e<0&&(e=i-1),(e>=i||s>=this.getPathSize(e))&&bt("Multi_path.remove_point");const r=this.getPathStart(e),n=this.isClosedPath(e);s<0&&(s=this.getPathSize(e)-1),s<0&&bt("Multi_path.remove_point");const o=r+s;for(let a=0,l=this.m_description.getAttributeCount();a<l;a++)if(this.m_vertexAttributes.get(a)){const u=this.m_description.getSemantics(a),c=Zt.getComponentCount(u);this.m_vertexAttributes.get(a).eraseRange(c*o,c,c*this.m_pointCount)}if(this.m_curveData&&this.m_curveData.m_segmentFlags){this.checkCompactSegmentParams();let a=0;if(o>r&&this.isNonLinearSegment(o-1))a+=1,this.incCurveType(this.m_curveData.m_segmentFlags.read(o-1),-1),this.m_curveData.m_segmentFlags.write(o-1,1),this.m_curveData.m_segmentParamIndex.write(o-1,-1);else{const l=this.getPathEnd(e);n&&r+1<l&&this.isNonLinearSegment(l-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(l-1),-1),this.m_curveData.m_segmentFlags.write(l-1,1),this.m_curveData.m_segmentParamIndex.write(l-1,-1),a+=1)}this.isNonLinearSegment(o)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(o),-1),a+=1),a>0&&this.modifyCurveCounter(-a),this.m_curveData.m_segmentFlags.eraseRange(o,1,this.m_pointCount),this.m_curveData.m_segmentParamIndex.eraseRange(o,1,this.m_pointCount)}for(let a=i;a>=e+1;a--){const l=this.m_paths.read(a);this.m_paths.write(a,l-1)}this.m_pointCount--,this.m_reservedPointCount--,this.notifyModifiedFlags(2001)}removePoint(e){let s;s=e<0?this.getPathCount()-1:this.getPathIndexFromPointIndex(e),this.removePointFromPath(s,e-this.getPathStart(s))}getNumberOfCurves(e){if(!this.hasNonLinearSegments())return 0;let s=0;for(let i=this.getPathStart(e),r=this.getPathEnd(e);i<r;i++)Va.isNonLinearSegmentFlag(this.m_curveData.m_segmentFlags.read(i))&&++s;return s}getPathCount(){return this.m_paths?this.m_paths.size()-1:0}getPathSize(e){return this.m_paths.read(e+1)-this.m_paths.read(e)}getPathStart(e){return this.m_paths.read(e)}getPathEnd(e){return this.m_paths.read(e+1)}getPathIndexFromPointIndex(e,s=-1){s===-1&&(s=this.m_currentPathIndex);const i=this.getPathCount(),r=Va.getPathIndexFromPointIndexImpl(this.m_paths,i,e,s);return this.m_currentPathIndex=r,r}startPathCoords(e,s){this.startPathPoint(new nt({x:e,y:s}))}startPath(e){this.startPathPoint(new nt({pt:e}))}startPath3D(e){this.startPathPoint(new nt({x:e.x,y:e.y,z:e.z}))}startPath3DCoords(e,s,i){this.startPathPoint(new nt({x:e,y:s,z:i}))}startPathPoint(e){e.isEmpty()&&ee("");const s=e.getDescription();let i;if(this.m_description!==s){this.mergeVertexDescription(s);const r=new nt({vd:this.m_description});e.copyCommonAttributesTo(r),i=r}else i=e;this.m_bPathStarted?this.setPointByVal(this.m_pointCount-1,i):(this.insertPoint(-1,-1,i),this.m_bPathStarted=!0)}beforeNewSegmentHelper2(){this.m_paths=yn(2),this.m_paths.write(0,0),this.m_pathFlags=Oh(2,0),this.m_bPolygon&&this.m_pathFlags.write(0,1)}beforeNewSegmentHelper1(){this.m_paths!==null?(this.m_paths.add(0),this.m_pathFlags.add(0),this.m_bPolygon&&this.m_pathFlags.write(this.m_pathFlags.size()-2,1)):this.beforeNewSegmentHelper2()}beforeNewSegment(e){this.m_pointCount!==0||this.m_bPathStarted||this.startPathCoords(0,0);const s=this.m_pointCount,i=this.m_paths.size()-1,r=s+e;this.m_paths.write(i,r),this.resizeImpl(r),this.m_bPathStarted&&(this.m_bPathStarted=!1)}finishLineTo(){if(this.hasNonLinearSegments()){const e=this.m_curveData.m_segmentFlags.read(this.m_pointCount-1);e!==1&&(this.m_curveData.m_segmentFlags.write(this.m_pointCount-1,1),this.m_curveData.m_segmentParamIndex.write(this.m_pointCount-1,-1),this.modifyCurveCounter(-1),this.incCurveType(e,-1))}}lineToCoords(e,s){if(this.beforeNewSegment(1),this.m_description.getAttributeCount()===1)this.setXYCoords(this.m_pointCount-1,e,s);else{const i=qh(),r=new nt({vd:this.m_description,attribBuffer:i,initDefaultValues:!0});r.setXYCoords(e,s),this.setPointByVal(this.m_pointCount-1,r)}this.finishLineTo()}lineTo(e){this.lineToCoords(e.x,e.y)}lineTo3D(e){this.beforeNewSegment(1);const s=Sx(this.m_description,tC()),i=qh(),r=new nt({vd:s,attribBuffer:i,initDefaultValues:!0});r.setXYZ(e),this.setPointByVal(this.m_pointCount-1,r),this.finishLineTo()}lineTo3DCoords(e,s,i){this.lineTo3D(new gt(e,s,i))}lineToPoint(e){if(this.beforeNewSegment(1),this.m_description===e.getDescription())this.setPointByVal(this.m_pointCount-1,e);else{this.mergeVertexDescription(e.getDescription());const s=qh(),i=new nt({vd:this.m_description,attribBuffer:s,initDefaultValues:!1});e.copyCommonAttributesTo(i),this.setPointByVal(this.m_pointCount-1,i)}this.finishLineTo()}openPathAndDuplicateStartVertex(e){this.m_bPolygon&&Ce("");const s=this.getPathCount();if(e>s&&ee(""),!this.isClosedPath(e))return;this.m_pathFlags||Ce("");const i=this.m_pointCount,r=this.getPathStart(e),n=this.getPathEnd(e);if(n-r!=0){this.resizeImpl(this.m_pointCount+1),this.verifyAllStreamsAfterSizeChange();for(let o=0,a=this.m_description.getAttributeCount();o<a;o++)if(this.m_vertexAttributes.get(o)){const l=this.m_description.getSemantics(o),u=Zt.getComponentCount(l);this.m_vertexAttributes.get(o).insertRangeFromStream(u*n,this.m_vertexAttributes.get(o),u*r,u,!0,1,u*i)}for(let o=s;o>e;o--){const a=this.m_paths.read(o);this.m_paths.write(o,a+1)}this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.insertRange(n,1,1,i),this.m_curveData.m_segmentParamIndex.insertRange(n,-1,1,i)),this.m_pathFlags.clearBits(e,1)}}openPath(e){this.m_bPolygon&&Ce(""),e>this.getPathCount()&&ee(""),this.m_pathFlags||Ce(""),this.m_pathFlags.clearBits(e,1)}isStrongPathStart(e){return!!(2&this.m_pathFlags.read(e))}setStrongPathStart(e,s){s?this.m_pathFlags.setBits(e,2):this.m_pathFlags.clearBits(e,2)}isStrongPathEnd(e){return!!(4&this.m_pathFlags.read(e))}setStrongPathEnd(e,s){s?this.m_pathFlags.setBits(e,4):this.m_pathFlags.clearBits(e,4)}clearStrongPathEnds(){for(let e=0,s=this.getPathCount();e<s;++e)this.m_pathFlags.clearBits(e,6)}openAllPathsAndDuplicateStartVertex(){if(this.m_bPolygon&&Ce(""),this.isEmpty())return;this.m_pathFlags||Ce("");let e=0;const s=this.getPathCount();for(let c=0;c<s;c++)this.isClosedPath(c)&&(this.getPathSize(c)>0?e++:this.m_pathFlags.clearBits(c,1));if(e===0)return;const i=this.hasNonLinearSegments();let r=0;const n=this.getPathCount(),o=this.m_description.getAttributeCount(),a=new Array(o);let l=null,u=null;for(let c=0;c<n;++c){const h=this.getPathStart(c),m=this.getPathSize(c),f=this.isClosedPath(c);if(m>0){const g=h+r;for(let v=0;v<o;v++)if(this.m_vertexAttributes.get(v)){const b=this.m_description.getSemantics(v),w=Zt.getComponentCount(b);if(!a[v]){const S=w*(this.m_pointCount+e),T=rN(b,S);a[v]=T}a[v].writeRange(g*w,m*w,this.m_vertexAttributes.get(v),h*w,!0,1),f&&a[v].writeRange((g+m)*w,w,this.m_vertexAttributes.get(v),h*w,!0,1)}if(i){if(l===null){const v=this.m_pointCount+e;l=Oh(v),u=yn(v)}l.writeRange(g,m,this.m_curveData.m_segmentFlags,h,!0,1),u.writeRange(g,m,this.m_curveData.m_segmentParamIndex,h,!0,1),f&&(l.write(g+m,1),u.write(g+m,-1))}}this.m_paths.write(c,h+r),f&&(this.m_pathFlags.clearBits(c,1),++r)}this.m_paths.write(n,this.m_pointCount+e),this.m_pathFlags.clearBits(n,1);for(let c=0;c<o;c++)this.m_vertexAttributes.get(c)&&this.m_vertexAttributes.set(c,a[c]);i&&(this.m_curveData.m_segmentFlags=l,this.m_curveData.m_segmentParamIndex=u),this.m_pointCount+=e,this.m_reservedPointCount>0&&(this.m_reservedPointCount=this.m_pointCount)}closePathWithLine(e){e===void 0&&(e=this.getPathCount()-1),this.throwIfEmpty(),(e<0||e>=this.getPathCount())&&ee("close_path_with_line"),e===this.getPathCount()-1&&(this.m_bPathStarted=!1);const s=this.m_pathFlags.read(e);if(1&s||this.m_pathFlags.write(e,1|s),this.m_curveData&&this.m_curveData.m_segmentFlags){const i=this.getPathEnd(e)-1,r=this.m_curveData.m_segmentFlags.read(i);r!==1&&(this.m_curveData.m_segmentFlags.write(i,1),this.m_curveData.m_segmentParamIndex.write(i,-1),r!==1&&(this.incCurveType(r,-1),this.modifyCurveCounter(-1)))}this.notifyModifiedFlags(2001)}closeLastPathWithSegment(e){this.closePathWithSegment(this.getPathCount()-1,e)}closePathWithSegment(e,s){if(this.throwIfEmpty(),(e<0||e>=this.getPathCount())&&ee("close_path_with_line"),s.getEndXY().equals(this.getXY(this.getPathStart(e)))||ee("close_path_with_segment: end point mismatch"),e===this.getPathCount()-1)this.m_bPathStarted=!1,this.addSegment(s,!1),--this.m_pointCount,this.m_paths.write(e+1,this.m_pointCount);else{this.mergeVertexDescription(s.getDescription());const r=s.getStartXY(),n=this.getPathEnd(e)-1;r.equals(this.getXY(n))||ee("close_path_with_segment: start point mismatch");const o=s.getGeometryType();if(o===G.enumLine)return void this.closePathWithLine(e);{const a=lL(s);this.initSegmentData(a);const l=Nm.toSegType(o),u=this.m_curveData.m_segmentFlags.read(n);if(u!==l)this.m_curveData.m_segmentParamIndex.write(n,this.m_curveData.m_curveParamWritePoint),s.writeInBufferStream(this.m_curveData.m_segmentParams,this.m_curveData.m_curveParamWritePoint),this.m_curveData.m_curveParamWritePoint+=a,this.incCurveType(l,1),u!==1?this.incCurveType(u,-1):this.modifyCurveCounter(1);else{const c=this.m_curveData.m_segmentParamIndex.read(n);s.writeInBufferStream(this.m_curveData.m_segmentParams,c)}this.m_curveData.m_segmentFlags.write(n,l)}}const i=this.m_pathFlags.read(e);1&i||this.m_pathFlags.write(e,1|i),this.notifyModifiedFlags(2001)}closeAllPaths(){if(this.m_bPolygon||this.isEmptyImpl())return;this.m_bPathStarted=!1;let e=!1;for(let s=0,i=this.m_paths.size()-1;s<i;s++){if(this.isClosedPath(s))continue;const r=this.m_pathFlags.read(s);this.m_pathFlags.write(s,1|r),e=!0}e&&this.notifyModifiedFlags(512)}isClosedPath(e){return!!(1&this.m_pathFlags.read(e))}isClosedPathInXYPlane(e){if(this.isClosedPath(e))return!0;const s=this.getPathStart(e),i=this.getPathEnd(e)-1;if(s>i)return!1;const r=this.getXY(s),n=this.getXY(i);return r.isEqualPoint2D(n)}isClosedPathIn3D(e){return F(0),!1}hasNonLinearSegmentsPath(e){if(!this.hasNonLinearSegments())return!1;for(let s=this.getPathStart(e),i=this.getPathEnd(e);s<i;s++)if(Va.isNonLinearSegmentFlag(this.m_curveData.m_segmentFlags.read(s)))return!0;return!1}isNonLinearSegment(e){return!(1&this.getSegmentFlags(e))}addEnvelope(e,s){if(e.isEmpty())return;const i=this.m_pointCount===0;if(e instanceof X)this.startPathCoords(e.xmin,e.ymin),s?(this.lineToCoords(e.xmax,e.ymin),this.lineToCoords(e.xmax,e.ymax),this.lineToCoords(e.xmin,e.ymax)):(this.lineToCoords(e.xmin,e.ymax),this.lineToCoords(e.xmax,e.ymax),this.lineToCoords(e.xmax,e.ymin));else{const r=e.getDescription(),n=qh(),o=new nt({vd:r,attribBuffer:n,initDefaultValues:!1});for(let a=0,l=4;a<l;a++){const u=s?l-a-1:a;e.queryCornerByVal(u,o),a===0?this.startPathPoint(o):this.lineToPoint(o)}}this.closePathWithLine(),this.m_bPathStarted=!1,i&&!s&&(this.setDirtyFlagProtected(256,!1),this.m_bPolygon&&Math.min(e.width(),e.height())>0&&this.setIsSimple(3,0))}addPathFromClosedSegment(e,s){if(e.isClosed()||ee("add_path_from_closedSegment: segment must be closed"),s){const i=e.getReversed(),r=new nt;i.queryStart(r),this.startPathPoint(r),this.closeLastPathWithSegment(i)}else{const i=new nt;e.queryStart(i),this.startPathPoint(i),this.closeLastPathWithSegment(e)}}addSegment_(e,s){const i=e.getDescription();this.mergeVertexDescription(i);const r=qh(),n=new nt({vd:i,attribBuffer:r,initDefaultValues:!1}),o=e.getGeometryType();if(o===G.enumLine)(s||this.isEmptyImpl())&&(e.queryStart(n),this.startPathPoint(n)),e.queryEnd(n),this.lineToPoint(n);else{let a=!1;if((s||this.isEmptyImpl())&&(a=!0),!a&&(e.getStartXY().equals(this.getXY(this.m_pointCount-1))||ee("add_segment: start point mismatch")),a&&(e.queryStart(n),this.startPathPoint(n)),this.beforeNewSegment(1),e.queryEnd(n),n.getDescription()===this.m_description)this.setPointByVal(this.m_pointCount-1,n);else{const c=qh(),h=new nt({vd:this.m_description,attribBuffer:c,initDefaultValues:!1});n.copyCommonAttributesTo(h),this.setPointByVal(this.m_pointCount-1,h)}const l=lL(e);this.initSegmentData(l),this.m_curveData.m_segmentParamIndex.write(this.m_pointCount-2,this.m_curveData.m_curveParamWritePoint),e.writeInBufferStream(this.m_curveData.m_segmentParams,this.m_curveData.m_curveParamWritePoint),this.m_curveData.m_curveParamWritePoint+=l;const u=Nm.toSegType(o);this.incCurveType(u,1),this.modifyCurveCounter(1),this.m_curveData.m_segmentFlags.write(this.m_pointCount-2,u)}}addSegment(e,s,i){i?s?this.addPathFromClosedSegment(e,!1):this.closeLastPathWithSegment(e):this.addSegment_(e,s)}interpolateAttributesRange(e,s,i,r){for(let a=e;a<i-1;a++)this.isClosedPath(a)&&ee("cannot interpolate across closed paths");const n=this.m_description.getAttributeCount();if(n===1)return;const o=this.calculateSubLength2D(e,s,i,r);if(o!==0)for(let a=1;a<n;a++){const l=this.m_description.getSemantics(a);this.interpolateAttributesSemanticsImpl(l,e,s,i,r,o)}}interpolateAttributesSemantics(e,s,i,r,n){if(e===0)return;this.hasAttribute(e)||ee("does not have the given attribute"),Zt.getInterpolation(e)===2&&ee("angular interpolation");for(let a=s;a<r-1;a++)this.isClosedPath(a)&&ee("cannot interpolate across closed paths");const o=this.calculateSubLength2D(s,i,r,n);o!==0&&this.interpolateAttributesSemanticsImpl(e,s,i,r,n,o)}interpolateAttributesPath(e,s,i){const r=this.m_description.getAttributeCount();if(r===1||s===i)return;const n=this.calculatePathSubLength2D(e,s,i);for(let o=1;o<r;o++){const a=this.m_description.getSemantics(o);this.interpolateAttributesSemanticsPathImpl(a,e,s,i,n)}}interpolateAttributesSemanticsPath(e,s,i,r){if(e===0)return;this.hasAttribute(e)||ee("does not have the given attribute"),Zt.getInterpolation(e)===2&&ee("angular interpolation");const n=this.calculatePathSubLength2D(s,i,r);n!==0&&this.interpolateAttributesSemanticsPathImpl(e,s,i,r,n)}interpolateAttributesSemanticsImpl(e,s,i,r,n,o){const a=this.querySegmentIterator(),l=this.getPathStart(s)+i,u=this.getPathStart(r)+n,c=Zt.getComponentCount(e),h=Me(Zt.maxComponentCount(),Number.NaN);this.queryAttributeAsDbl(e,l,h,c);const m=Me(Zt.maxComponentCount(),Number.NaN);this.queryAttributeAsDbl(e,u,m,c);const f=Me(Zt.maxComponentCount(),Number.NaN);$s(f,h,0,0,c);let g=0;const v=Zt.getDefaultValue(e),b=Zt.getInterpolation(e);a.resetToVertex(l,s);do if(a.hasNextSegment()){if(a.nextSegment(),a.getStartPointIndex()===u)return;this.setAttributeFromArray(e,a.getStartPointIndex(),f,c),a.previousSegment();do{const w=a.nextSegment();if(a.getEndPointIndex()===u)return;g+=w.calculateLength2D(),U3(b,h,m,f,0,c,g/o,v),a.isClosingSegment()||this.setAttributeFromArray(e,a.getEndPointIndex(),f,c)}while(a.hasNextSegment())}while(a.nextPath())}interpolateAttributesSemanticsPathImpl(e,s,i,r,n){const o=this.querySegmentIterator(),a=Zt.getInterpolation(e),l=this.getPathStart(s)+i,u=this.getPathStart(s)+r;if(u===l)return;const c=Zt.getComponentCount(e),h=Me(Zt.maxComponentCount(),Number.NaN);this.queryAttributeAsDbl(e,l,h,c);const m=Me(Zt.maxComponentCount(),Number.NaN);this.queryAttributeAsDbl(e,u,m,c);const f=new Fr(0);o.resetToVertex(l,s),o.setCirculator(this.isClosedPath(s));const g=Zt.getDefaultValue(e),v=Me(Zt.maxComponentCount(),Number.NaN);$s(v,h,0,0,c);const b=n===0;let w=.5;do{const S=o.nextSegment();if(this.setAttributeFromArray(e,o.getStartPointIndex(),v,c),!b){const T=S.calculateLength2D();f.pe(T),w=f.getResult()/n}U3(a,h,m,v,0,c,w,g)}while(o.getEndPointIndex()!==u)}querySegment(e,s,i){const r=this.getPathIndexFromPointIndex(e),n=e-this.getPathStart(r);n>=this.getSegmentCountPath(r)&&ee("get_segment"),this.getSegmentFromPath(r,n,s,i)}getSegment(e,s){const i=new this.m_segmentBufferCTor;return this.getSegmentBuffer(e,i,s),i.releaseSegment()}getSegmentType(e){const s=this.getPathIndexFromPointIndex(e),i=e-this.getPathStart(s);return i>=this.getSegmentCountPath(s)&&ee("get_segment"),this.getSegmentTypeFromPath(s,i)}getSegmentFromPath(e,s,i,r){const n=this.getPathStart(e)+s,o=this.getSegmentFlagsStreamRef();let a=1;switch(o&&(a=31&o.read(n)),a){case 1:i.createLine();break;case 2:i.createCubicBezier();break;case 4:i.createEllipticArc();break;case 8:i.createQuadraticRationalBezier();break;case 16:i.createQuadraticBezier();break;default:Ce("")}const l=i.get();let u,c=null;if(r?(c=Jr(),l.assignVertexDescription(c)):l.assignVertexDescription(this.m_description),u=n===this.getPathEnd(e)-1&&this.isClosedPath(e)?this.getPathStart(e):n+1,M9(l,this.getXY(n)),A9(l,this.getXY(u)),!r)for(let h=1,m=this.m_description.getAttributeCount();h<m;h++){const f=this.m_description.getSemantics(h),g=Zt.getComponentCount(f);for(let v=0;v<g;v++){const b=this.getAttributeAsDbl(f,n,v);l.setStartAttribute(f,v,b);const w=this.getAttributeAsDbl(f,u,v);l.setEndAttribute(f,v,w)}}if(Va.isNonLinearSegmentFlag(a)){const h=this.m_curveData.m_segmentParamIndex.read(n);l.readFromBufferStream(this.m_curveData.m_segmentParams,h)}}replaceLinearEllipticalArcsWithTrueLines(){if(!this.hasNonLinearSegments()||this.m_curveData.m_arcCount===0)return!1;let e=!1;for(let s=0,i=this.getPointCount();s<i;s++)if(this.m_curveData.m_segmentFlags.read(s)===4){const r=this.m_curveData.m_segmentParamIndex.read(s);DKe(this.m_curveData.m_segmentParams,r).isNAN()&&(this.m_curveData.m_segmentFlags.write(s,1),this.m_curveData.m_segmentParamIndex.write(s,-1),this.incCurveType(4,-1),this.modifyCurveCounter(-1),e=!0)}return e&&this.checkCompactSegmentParams(),e}queryPointAlongPath(e,s,i,r=!1){const n={iSegment:-1},o=r?n:{tSegment:0};if(i.setEmpty(),this.isEmpty()||((e<0||e>=this.getPathCount())&&ee("query_point_along_path"),s<0))return n;const a=this.getPathSize(e);if(a===0)return n;if(a===1)return this.getPointByVal(this.getPathStart(e),i),o.tSegment=0,n.iSegment=this.getPathStart(e),n;const l=this.querySegmentIteratorAtVertex(this.getPathStart(e)),u=new Fr(0);for(;l.hasNextSegment();){const c=l.nextSegment(),h=c.calculateLength2D(),m=u.getResult();if(u.add(h),u.getResult()>=s){let f=s-m;f>h&&(f=h);const g=c.lengthToT(f);return c.queryCoord(g,i),o.tSegment=g,n.iSegment=l.getStartPointIndex(),n}}if(this.isClosedPath(e)){const c=this.getPathStart(e);return this.getPointByVal(c,i),o.tSegment=1,n.iSegment=this.getPathEnd(e)-1,n}{const c=this.getPathEnd(e)-1;return this.getPointByVal(c,i),this.getPathSize(e)>1?(o.tSegment=1,n.iSegment=this.getPathEnd(e)-2,n):(o.tSegment=0,n.iSegment=this.getPathStart(e),n)}}queryPointsAlongPath(e,s,i,r,n,o){{let g=0;for(let v=0;v<s;++v)r&&r[v].setEmpty(),n&&(n[v]=-1),o&&(o[v]=0),g>i[v]&&ee("query_points_along"),g=i[v]}const a=this.getPathSize(e);if(s===0||a===0)return 0;if(a===1){const g=this.getPathStart(e);return r&&this.getPointByVal(g,r[0]),o&&(o[0]=0),n&&(n[0]=g),1}const l=this.getPathStart(e),u=new Fr(0),c=this.querySegmentIteratorAtVertex(l);let h=0,m=0,f=i[h];for(;c.hasNextSegment();){const g=c.nextSegment(),v=g.calculateLength2D(),b=u.getResult();for(u.add(v);u.getResult()>=f;){let w=f-b;w>v&&(w=v);const S=g.lengthToT(w);if(r&&g.queryCoord(S,r[m]),o&&(o[m]=S),n&&(n[m]=c.getStartPointIndex()),m++,h++,f=i[h],h===s)return m}}if(this.isClosedPath(e)){const g=this.getPathStart(e),v=0;r&&this.getPointByVal(g,r[m]),o&&(o[m]=v),n&&(n[m]=g),m++}else if(this.getPathSize(e)>1){const g=this.getPathEnd(e)-2,v=1;r&&this.getPointByVal(g+1,r[m]),o&&(o[m]=v),n&&(n[m]=g),m++}return m}queryPointsAlong(e,s,i,r,n){{let m=0;for(let f=0;f<e;++f)i&&i[f].setEmpty(),r&&(r[f]=-1),n&&(n[f]=0),m>s[f]&&ee("query_points_along"),m=s[f]}if(e===0)return 0;const o=new Fr(0),a=this.querySegmentIterator();let l=-1,u=0,c=0,h=s[u];for(;a.nextPath();)for(;a.hasNextSegment();){l=a.getPathIndex();const m=a.nextSegment(),f=m.calculateLength2D(),g=o.getResult();for(o.add(f);o.getResult()>=h;){let v=h-g;v>f&&(v=f);const b=m.lengthToT(v);if(i&&m.queryCoord(b,i[c]),n&&(n[c]=b),r&&(r[c]=a.getStartPointIndex()),c++,u++,h=s[u],u===e)return c}}if(l<0)return 0;if(this.isClosedPath(l)){const m=this.getPathStart(l),f=0;i&&this.getPointByVal(m,i[c]),n&&(n[c]=f),r&&(r[c]=m),c++}else if(this.getPathSize(l)>1){const m=this.getPathEnd(l)-2,f=1;i&&this.getPointByVal(m+1,i[c]),n&&(n[c]=f),r&&(r[c]=m),c++}return c}querySegmentIterator(){return new aL({parent:this})}querySegmentIteratorAtVertex(e){return new aL({parent:this,pointIndex:e})}queryPathEnvelope(e,s){this.queryPathEnvelopeImpl(e,s,!0)}queryLoosePathEnvelope(e,s){this.queryPathEnvelopeImpl(e,s,!1)}queryPathEnvelopeImpl(e,s,i){if(s instanceof Sn&&F(0,"not implemented for Envelope"),s instanceof Ql&&F(0,"not implemented for Envelope3D"),(e>=this.getPathCount()||e<0)&&ee(""),this.isEmpty())return void s.setEmpty();const r=this.getAttributeStreamRef(0),n=X.constructEmpty();n.setEmpty();for(let o=2*this.getPathStart(e),a=2*this.getPathEnd(e);o<a;){const l=a-o;F(!(1&l)),n.mergePointsInterleaved(r,o/2,l/2),o+=l}if(s.setCoords({env2D:n}),this.hasNonLinearSegmentsPath(e)){const o=this.querySegmentIterator();if(o.resetToPath(e),o.nextPath())for(;o.hasNextSegment();){const a=o.nextCurve();if(!a)break;{const l=X.constructEmpty();i?a.queryEnvelope(l):a.queryLooseEnvelope(l),s.mergeEnvelope2D(l)}}else F(0)}}checkCompactSegmentParams(){if(!this.m_curveData||this.m_curveData.m_segmentParams===null||this.m_curveData.m_segmentParams.size()<=this.m_vertexAttributes.get(0).size())return!1;const e=10,s=Al(4)*this.m_curveData.m_arcCount+Al(2)*this.m_curveData.m_bezierCount+Al(8)*this.m_curveData.m_rbezier2Count+Al(16)*this.m_curveData.m_bezier2Count;return this.m_curveData.m_segmentParams.size()>Math.max(3*s>>1,e)?(this.forceCompactSegmentParams(),!0):(this.m_pointCount===0&&(this.m_curveData.m_curveParamWritePoint=0),!1)}forceCompactSegmentParams(){let e=0;for(let r=0,n=this.getPointCount();r<n;r++){const o=this.m_curveData.m_segmentFlags.read(r);Va.isNonLinearSegmentFlag(o)&&(e+=Al(o))}const s=fa(e);let i=0;for(let r=0,n=this.getPointCount();r<n;r++){const o=this.m_curveData.m_segmentFlags.read(r);if(Va.isNonLinearSegmentFlag(o)){let a=this.m_curveData.m_segmentParamIndex.read(r);this.m_curveData.m_segmentParamIndex.write(r,i);const l=Al(o);for(let u=0;u<l;u++)s.write(i,this.m_curveData.m_segmentParams.read(a)),i++,a++}}this.m_curveData.m_segmentParams=s,this.m_curveData.m_curveParamWritePoint=i}setEmpty(){this.m_curveData&&(this.removeAllCurvesFromGlobalCounter(),this.m_curveData=null),this.m_bPathStarted=!1,this.m_paths=null,this.m_pathFlags=null,this.setEmptyImpl()}applyTransformation(e){this.applyTransformationToPath(e,-1)}applyTransformation3D(e){F(0)}getImpl(){return this}reserve(e){this.reserveImpl(e),e>0&&!this.m_paths&&(this.m_paths=yn(0),this.m_pathFlags=Oh(0),this.m_paths.reserve(2),this.m_pathFlags.reserve(2),this.m_paths.resize(1,0),this.m_pathFlags.resize(1,this.m_bPolygon?1:0))}reserveParts(e,s){this.reserveImpl(e),s>0&&(this.m_paths?(this.m_paths.reserve(s+1),this.m_pathFlags.reserve(s+1)):(this.m_paths=yn(0),this.m_pathFlags=Oh(0),this.m_paths.reserve(s+1),this.m_pathFlags.reserve(s+1),this.m_paths.resize(1,0),this.m_pathFlags.resize(1,this.m_bPolygon?1:0)))}clone(){const e=this.createInstance();return this.copyTo(e),e}queryLimitedSegmentIterator(e){return new Mtt(this,e)}getPathStreamRef(){return this.throwIfEmpty(),this.m_paths}setPathStreamRef(e){this.m_paths=e}getSegmentFlagsStreamRef(){return this.throwIfEmpty(),this.m_curveData!=null?this.m_curveData.m_segmentFlags:null}getPathFlagsStreamRef(){return this.throwIfEmpty(),this.m_pathFlags}setPathFlagsStreamRef(e){this.m_pathFlags=e}getSegmentIndexStreamRef(){return this.throwIfEmpty(),this.m_curveData!==null?this.m_curveData.m_segmentParamIndex:null}getSegmentDataStreamRef(){return this.throwIfEmpty(),this.m_curveData!==null?this.m_curveData.m_segmentParams:null}setSegmentData(e,s,i,r){this.m_curveData||(this.m_curveData=new Nm),this.m_curveData.m_segmentFlags=i,this.m_curveData.m_segmentParams=s,this.m_curveData.m_segmentParamIndex=e,this.m_curveData.m_curveParamWritePoint=r}static getPathIndexFromPointIndexImpl(e,s,i,r){if(r>=0&&r<s){if(i>=e.read(r)){if(i<e.read(r+1))return r;r++}else r--;if(r>=0&&r<s&&i>=e.read(r)&&i<e.read(r+1))return r}if(s<5){for(let a=0;a<s;a++)if(i<e.read(a+1))return a;I0e("")}let n=0,o=s-1;for(;o>n;){const a=n+(o-n>>1);if(i<e.read(a))o=a-1;else{if(!(i>=e.read(a+1)))return a;n=a+1}}return n}getHighestPointIndex(e){F(e>=0&&e<this.getPathCount());const s=this.getAttributeStreamRef(0),i=this.getPathEnd(e),r=this.getPathStart(e);let n=-1;const o=new M;o.y=Number.NEGATIVE_INFINITY,o.x=Number.NEGATIVE_INFINITY;for(let a=r+0;a<i;a++){const l=s.readPoint2D(2*a);o.compare(l)===-1&&(n=a,o.setCoordsPoint2D(l))}return n}applyTransformationToPath(e,s){if(s>=this.getPathCount()&&ee("apply_transformation"),this.isEmpty()||e.isIdentity())return;const i=this.m_vertexAttributes.get(0);if(!(s<0?this.hasNonLinearSegments():this.hasNonLinearSegmentsPath(s))){let a,l;return s<0?(a=0,l=this.m_pointCount):(a=this.getPathStart(s),l=this.getPathEnd(s)),i.applyTransformation(e,2*a,l-a),void this.notifyModifiedFlags(2001)}const r=new this.m_segmentBufferCTor,n=this.getPathCount();let o=s<0?0:s;do{const a=this.getPathStart(o),l=this.getPathEnd(o),u=this.isClosedPath(o),c=i.readPoint2D(2*a);if(!this.hasNonLinearSegmentsPath(o)){i.applyTransformation(e,2*a,l-a);continue}const h=M.getNAN();for(let m=a;m<l;++m){if((31&this.m_curveData.m_segmentFlags.read(m))!==1){const g=u&&m+1===l;g&&i.writePoint2D(2*a,c),this.getSegmentBuffer(m,r,!0),r.get().applyTransformation(e);const v=this.m_curveData.m_segmentParamIndex.read(m);r.get().writeInBufferStream(this.m_curveData.m_segmentParams,v),i.writePoint2D(2*m,r.get().getStartXY()),g&&i.writePoint2D(2*a,r.get().getEndXY());continue}const f=2*m;i.queryPoint2D(f,h),e.transformInPlace(h),i.writePoint2D(f,h)}if(o===s)break}while(++o<n);this.notifyModifiedFlags(2001)}calculateSubLength2D(e,s,i,r){const n=this.getPathStart(e)+s,o=this.getPathStart(i)+r;(o<n||n<0||o>this.getPointCount()-1)&&Us("");const a=this.querySegmentIterator();let l=0;a.resetToVertex(n,e);do{for(;a.hasNextSegment();){const u=a.nextSegment();if(a.getStartPointIndex()===o)break;l+=u.calculateLength2D()}if(a.getStartPointIndex()===o)break}while(a.nextPath());return l}calculatePathSubLength2D(e,s,i){const r=this.getPathStart(e)+s,n=this.getPathStart(e)+i;(r<0||n>this.getPointCount()-1)&&Us("");const o=this.querySegmentIterator();if(r>n&&(this.isClosedPath(e)||ee("cannot iterate across an open path"),o.setCirculator(!0)),r===n)return 0;let a=0,l=0;o.resetToVertex(r,e);do l+=a,a=o.nextSegment().calculateLength2D();while(o.getStartPointIndex()!==n);return l}calculateEnvelope2D(e){return this.updateXYImpl(e)}updateXYImpl(e){const s=super.updateXYImpl(e);if(this.hasNonLinearSegments()){const i=X.constructEmpty(),r=this.querySegmentIterator();for(;r.nextPath();)for(;r.hasNextSegment();){const n=r.nextCurve();if(!n)break;e?n.queryEnvelope(i):n.queryLooseEnvelope(i),s.mergeEnvelope2D(i)}}return s}notifyModifiedAllImpl(){this.m_paths!==null&&this.m_paths.size()?this.m_pointCount=this.m_paths.read(this.m_paths.size()-1):this.m_pointCount=0}setDirtyOGCFlags(e){this.setDirtyFlagProtected(16,e)}hasDirtyOGCStartFlags(){return this.hasDirtyFlag(16)}setDirtyRingAreas2D(e){this.setDirtyFlagProtected(1024,e)}hasDirtyRingAreas2D(){return this.hasDirtyFlag(1024)}static isNonLinearSegmentFlag(e){return!(1&e)}addAndExplicitlyOpenAllPaths(e,s){this===e&&ee("Multi_path_impl::add");let i=this.getPathCount();for(let r=0,n=e.getPathCount();r<n;r++)this.addPath(e,r,!s),this.openPathAndDuplicateStartVertex(i),i++}getSegmentFlags(e){return this.m_curveData!==null&&this.m_curveData.m_segmentFlags!==null?this.m_curveData.m_segmentFlags.read(e):1}getSegmentBuffer(e,s,i){const r=this.getPathIndexFromPointIndex(e),n=e-this.getPathStart(r);n>=this.getSegmentCountPath(r)&&ee("getSegmentBuffer"),this.getSegmentFromPath(r,n,s,i)}getSegmentTypeFromPath(e,s){const i=this.getPathStart(e)+s,r=this.getSegmentFlagsStreamRef();let n=1;switch(r&&(n=31&r.read(i)),n){case 1:return G.enumLine;case 2:return G.enumBezier;case 4:return G.enumEllipticArc;case 8:return G.enumRationalBezier2;case 16:return G.enumBezier2;default:Ce("")}}ensureXYMonotoneSegments(){if(!this.m_curveData)return!1;let e=!1;for(let s=0,i=this.getPathCount();s<i;s++){const r=this.getPathStart(s),n=this.getPathEnd(s),o=n-r;for(let a=r;a<n;a++){const l=31&this.m_curveData.m_segmentFlags.read(a);if(l===1)continue;l!==2&&yt("ensure_xy_monotone_segments");const u=(a-r+1)%o+r,c=this.m_curveData.m_segmentParamIndex.read(a),h=ne(M,4);h[0]=this.getXY(a),h[3]=this.getXY(u),h[1].x=this.m_curveData.m_segmentParams.read(c),h[1].y=this.m_curveData.m_segmentParams.read(c+1),h[2].x=this.m_curveData.m_segmentParams.read(c+2),h[2].y=this.m_curveData.m_segmentParams.read(c+3),gR(h)&&(e=!0,this.m_curveData.m_segmentParams.write(c,h[1].x),this.m_curveData.m_segmentParams.write(c+1,h[1].y),this.m_curveData.m_segmentParams.write(c+2,h[2].x),this.m_curveData.m_segmentParams.write(c+3,h[2].y))}}return e&&this.notifyModifiedFlags(2001),e}buildRasterizedGeometryAccelerator(e,s){return!1}buildQuadTreeAccelerator(e){if(this.m_accelerators||(this.m_accelerators=new Nie),this.m_accelerators.getQuadTree()!==null)return!0;this.ensureUniqueAccelerators(),this.m_accelerators.setQuadTree(null);const s=Lb(this);return this.m_accelerators.setQuadTree(s),!0}buildQuadTreeForPathsAccelerator(e){if(this.m_accelerators||(this.m_accelerators=new Nie),this.m_accelerators.getQuadTreeForPaths()!==null)return!0;this.ensureUniqueAccelerators(),this.m_accelerators.setQuadTreeForPaths(null);const s=cKe(this);return this.m_accelerators.setQuadTreeForPaths(s),!0}updateCurveCounter(e){this.modifyCurveCounter(e-this.getCurveCount())}removeAllCurvesFromGlobalCounter(){this.m_curveData&&(Va.st_totalCurveCount-=this.m_curveData.m_curveCount,this.m_curveData.m_curveCount=0,this.m_curveData.m_bezierCount=0,this.m_curveData.m_arcCount=0,this.m_curveData.m_bezier2Count=0,this.m_curveData.m_rbezier2Count=0,this.m_curveData.m_curveParamWritePoint=0)}modifyCurveCounter(e){e&&(this.m_curveData||(this.m_curveData=new Nm),Va.st_totalCurveCount+=e,this.m_curveData.m_curveCount+=e)}getCurveCount(){return this.m_curveData?this.m_curveData.m_curveCount:0}incCurveType(e,s){this.m_curveData||(this.m_curveData=new Nm),2&e?this.m_curveData.m_bezierCount+=s:4&e?this.m_curveData.m_arcCount+=s:8&e?this.m_curveData.m_rbezier2Count+=s:16&e&&(this.m_curveData.m_bezier2Count+=s)}getCurveWritePoint(){return this.m_curveData!==null?this.m_curveData.m_curveParamWritePoint:0}initSegmentData(e){this.m_curveData===null&&(this.m_curveData=new Nm);const s=this.m_reservedPointCount>0?this.m_reservedPointCount:this.m_pointCount;this.m_curveData.m_segmentParamIndex===null&&(this.m_curveData.m_segmentFlags=Oh(s,1),this.m_curveData.m_segmentParamIndex=yn(s,-1));const i=this.m_curveData.m_curveParamWritePoint+e;this.m_curveData.m_segmentParams===null?this.m_curveData.m_segmentParams=fa(i):i!==this.m_curveData.m_segmentParams.size()&&this.m_curveData.m_segmentParams.resize(i,0),this.m_curveData.m_segmentFlags.size()<s&&(this.m_curveData.m_segmentFlags.resize(s,1),this.m_curveData.m_segmentParamIndex.resize(s,-1))}updateCurveWritePoint(e){this.m_curveData===null&&(this.m_curveData=new Nm),this.m_curveData.m_curveParamWritePoint=e}updateOGCFlagsHelper(){const e=this.getPathCount();if(e===0)return;const s=this.m_pathFlags;let i=0;for(let r=0;r<e;r++){const n=this.m_cachedRingAreas2D.read(r);i===0&&(i=di(n)),n*i>0||i===0?s.setBits(r,8):s.clearBits(r,8)}}updateOGCFlagsProtected(){this.hasDirtyFlag(16)&&(this.updateRingAreas2DProtected(),this.updateOGCFlagsHelper(),this.setDirtyFlagProtected(16,!1))}replaceSegment(e,s,i){(e<0||e>=this.getPointCount())&&ee("Multi_path_impl.replace_segment"),F(s.isCurve());const r=this.getPathIndexFromPointIndex(e),n=this.getPathStart(r),o=(e-n+1)%this.getPathSize(r)+n;{const w=this.getXY(e),S=this.getXY(o),T=!w.isEqualPoint2D(s.getStartXY())||!S.isEqualPoint2D(s.getEndXY());F(!T)}const a=s.getDescription();this.mergeVertexDescription(a);const l=Me(32,Number.NaN),u=new nt({vd:a,attribBuffer:l,initDefaultValues:!1}),c=this.m_curveData===null?1:31&this.m_curveData.m_segmentFlags.read(e),h=Al(c),m=lL(s);let f,g=!1;h>=m?(F(this.m_curveData!==null),g=!0,f=this.m_curveData.m_segmentParamIndex.read(e)):(this.initSegmentData(m),g=!1,f=this.m_curveData.m_curveParamWritePoint);const v=s.getGeometryType(),b=Nm.toSegType(v);i||(s.queryStart(u),this.setPointByVal(e,u),s.queryEnd(u),this.setPointByVal(o,u)),this.m_curveData.m_segmentParamIndex.write(e,b!==1?f:-1),this.m_curveData.m_segmentFlags.write(e,b),b!==1&&s.writeInBufferStream(this.m_curveData.m_segmentParams,f),g||(this.m_curveData.m_curveParamWritePoint+=m),c!==b&&(this.incCurveType(c,-1),this.incCurveType(b,1),this.modifyCurveCounter(c===1?1:-1))}setAttributeImpl(e,s,i){if(this.addAttribute(e),!this.isEmpty())if(this.hasNonLinearSegments()&&e===0){(s<0||s>1)&&ee("");const r=new Rt,n=s===0?i:0,o=s===0?0:1;r.setShiftCoords(n,o),s===0?r.xx=0:r.yy=0,this.applyTransformation(r)}else super.setAttributeImpl(e,s,i)}};G9.st_totalCurveCount=0;let Mtt=class{constructor(e,s){this.m_segIter=null,this.m_quadTree=null,this.m_qtIter=null,this.m_extentOfInterest=new X(s),this.m_bfirst=!0,this.m_prevIndex=-100,this.m_parent=e}nextSegment(){return this.m_bfirst&&this.prepare_(),this.m_quadTree?this.nextSegmentQt():this.nextSegmentNoQt()}getPathIndex(){return this.m_segIter.getPathIndex()}getStartPointIndex(){return this.m_segIter.getStartPointIndex()}getEndPointIndex(){return this.m_segIter.getEndPointIndex()}isClosingSegment(){return this.m_segIter.isClosingSegment()}isPathClosed(){return this.m_segIter.isPathClosed()}prepare_(){const e=this.m_parent.getAccelerators();e&&(this.m_quadTree=e.getQuadTree(),this.m_quadTree&&(this.m_qtIter=this.m_quadTree.getSortedIterator(this.m_extentOfInterest,0))),this.m_segIter=this.m_parent.querySegmentIterator()}nextSegmentQt(){this.m_bfirst=!1;const e=this.m_qtIter.next();if(e===-1)return null;const s=this.m_quadTree.getElement(e);return(s!==this.m_prevIndex+1||this.m_segIter.isLastSegmentInPath())&&(this.m_segIter.resetToVertex(s,this.m_segIter.getPathIndex()),this.m_prevIndex=s),this.m_segIter.nextSegment()}nextSegmentNoQt(){for(;;){if(!this.m_bfirst&&this.m_segIter.hasNextSegment()){const e=this.m_segIter.nextSegment(),s=X.constructEmpty();if(e.queryLooseEnvelope(s),!s.isIntersecting(this.m_extentOfInterest))continue;return e}if(this.m_bfirst=!1,!this.m_segIter.nextPath())return null}}},qt=class bG extends G9{constructor(e){e?e.vd?(super({vd:e.vd,bPolygon:!1}),this.m_segmentBufferCTor=ut):e.copy?(super({vd:e.copy.getDescription(),bPolygon:!1}),this.m_segmentBufferCTor=ut,e.copy.copyTo(this)):e.move?(super({move:e.move}),this.m_segmentBufferCTor=ut):e.start?(super({vd:e.start.getDescription(),bPolygon:!1}),this.m_segmentBufferCTor=ut,this.startPathPoint(e.start),this.lineToPoint(e.end)):e.path?(super({bPolygon:!1}),this.m_segmentBufferCTor=ut,this.addPathPoint2D(e.path,e.pointCount,e.bForward)):Ce("bad constructor arg"):(super({bPolygon:!1}),this.m_segmentBufferCTor=ut)}getBoundary(){return Bc(this)}assignCopy(e){return this!==e&&e.copyTo(this),this}assignMove(e){return e.copyTo(this),this}getGeometryType(){return bG.type}getDimension(){return 1}createInstance(){return new bG({vd:this.getDescription()})}equals(e,s){return this.equalsBase(e,s)}};qt.type=G.enumPolyline;var Of=G;function s_(t,e){if(t.isEmpty())return!1;const s=t.getGeometryType();if(s===Of.enumPolygon)return t.calculateArea2D()!==0;if(s===Of.enumPolyline)return V1e(t.getImpl(),e,!0).bNotEmpty;if(s===Of.enumEnvelope)return!0;if(zi(s))return!!t.isClosed();if(Fb(s))return!1;if(s===Of.enumGeometryCollection){const i=t;for(let r=0,n=i.getGeometryCount();r<n;r++)if(s_(i.getGeometry(r),e))return!0;return!1}yt("")}function Bc(t,e){const s=t.getGeometryType();if(s===Of.enumPolygon){const i=new qt({vd:t.getDescription()});return t.isEmpty()||t.copyToUnchecked(i),i}if(s===Of.enumPolyline)return V1e(t.getImpl(),e,!1).boundary;if(s===Of.enumEnvelope){const i=new qt({vd:t.getDescription()});return t.isEmpty()||i.addEnvelope(t,!1),i}if(zi(s)){const i=new pi({vd:t.getDescription()});if(!t.isEmpty()&&!t.isClosed()){const r=new nt;i.reserve(2),t.queryStart(r),i.add(r),t.queryEnd(r),i.add(r)}return i}if(s===Of.enumGeometryCollection){const i=t;let r=null;for(let n=0,o=i.getGeometryCount();n<o;n++){const a=Bc(i.getGeometry(n),e);if(a!==null){r===null&&(r=t.createInstance());const l=a;r.addGeometry(l)}}return r}if(Fb(s))return new nt({vd:t.getDescription()});yt("")}function V1e(t,e,s){const r=t;let n=null;if(s||(n=new pi({vd:r.getDescription()})),!r.isEmpty()){const o=new Qs(0);for(let a=0,l=r.getPathCount();a<l;a++)if(r.getPathSize(a)>0&&!r.isClosedPathInXYPlane(a)){const u=r.getPathStart(a);o.add(u);const c=r.getPathEnd(a)-1;o.add(c)}if(o.size()>0){const a=new Jc,l=r.getAttributeStreamRef(0),u={userSort(g,v,b){const w=M.getNAN(),S=M.getNAN();b.sort(g,v,(T,P)=>(l.queryPoint2D(2*T,w),l.queryPoint2D(2*P,S),w.compare(S)))},getValue:g=>l.read(2*g+1)};a.sort(o,0,o.size(),u);let c=l.readPoint2D(2*o.read(0)),h=0,m=1;const f=new nt;for(let g=1,v=o.size();g<v;g++){const b=l.readPoint2D(2*o.read(g));if(b.isEqualPoint2D(c))o.read(h)>o.read(g)?(o.write(h,co()),h=g):o.write(g,co()),m++;else{if(1&m){if(s)return{bNotEmpty:!0,boundary:new pi({})}}else o.write(h,co());c=b,h=g,m=1}}if(1&m){if(s)return{bNotEmpty:!0,boundary:new pi({})}}else o.write(h,co());if(!s){o.sort(0,o.size());for(let g=0,v=o.size();g<v&&o.read(g)!==co();g++)r.getPointByVal(o.read(g),f),n.add(f)}}}return s?{bNotEmpty:!1,boundary:new pi({})}:{bNotEmpty:!1,boundary:n}}const Att=w9/180,Ntt=180/w9;function Dtt(t){let e=t;return e>=-360&&e<720?(e<0?e+=360:e>=360&&(e-=360),e):(e=og(e,360),e<0&&(e+=360),e)}function q1e(t){let e=t;return e=Dtt(e),e>180&&(e-=360),e}function G1e(t){return t*Att}function oN(t){return t*Ntt}function z1e(t){const e=Gn();let s=t;return s>=-e&&s<2*e?(s<0&&(s+=e),s>=e&&(s-=e),s):(s=og(s,e),s<0&&(s+=e),s)}function ure(t){const e=Lt();let s=t;return s>-e&&s<=e||(s=z1e(s),s>e&&(s-=Gn())),s}function cre(t,e){return q1e(e-t)}var m2=Es;let Kc=class xG extends EP{constructor(e){if(e===void 0||oR(e,"vd"))return super({vd:e==null?void 0:e.vd,XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_semiMajorAxis=0,this.m_minorMajorRatio=1,this.m_rotation=0,this.m_cosr=1,this.m_sinr=0,this.m_center=new M(0,0),this.m_sweepAngle=0,this.m_startAngle=0,this.m_interior=new M(0,0),void(this.m_bits=0);if(e.copy)return super(e),void(this!==e.copy&&(this.m_center=new M(0,0),this.m_interior=new M(0,0),e.copy.copyToImpl(this)));if(e.move)super(e),this.m_semiMajorAxis=e.move.m_semiMajorAxis,this.m_minorMajorRatio=e.move.m_minorMajorRatio,this.m_rotation=e.move.m_rotation,this.m_cosr=e.move.m_cosr,this.m_sinr=e.move.m_sinr,this.m_center=e.move.m_center.clone(),this.m_sweepAngle=e.move.m_sweepAngle,this.m_startAngle=e.move.m_startAngle,this.m_interior=e.move.m_interior.clone(),this.m_bits=e.move.m_bits,this.m_cachedValues=e.move.m_cachedValues,e.move.m_cachedValues=null;else{if(e.fromPoint)return super({XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_center=new M(0,0),this.m_interior=new M(0,0),void this.constructCircularArcThreePoint(e.fromPoint,e.toPoint,e.interiorPoint);if(e.center)return super({XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_center=new M(0,0),this.m_interior=new M(0,0),void this.constructCircleRadius(e.radius,e.center,e.bIsCounterClockwise);if(e.semiMajorAxis)return super({XStart:0,YStart:0,XEnd:0,YEnd:0}),void this.constructEllipticArcEndPoints(e.fromPoint,e.toPoint,e.semiMajorAxis,e.minorMajorRatio,e.axisXRotationRad,e.bBigArc,e.bIsCounterClockwise)}}getBoundary(){return Bc(this)}assignCopy(e){return this!==e&&e.copyTo(this),this}constructCircleRadius(e,s,i=!1){return this.constructEllipse(e,1,s,0,i),this.setProjectionBehavior(0),this.afterCompletedModification(),this}constructCircleCenterAndPoint(e,s,i=!1){const r=M.distance(e,s);return this.constructEllipticArcEndPointsCenter(s,s,r,1,0,!0,i,e),this.setProjectionBehavior(0),this.afterCompletedModification(),this}constructTwoPointCircle(e,s,i=!1){const r=M.lerp(e,s,.5);return this.constructCircleCenterAndPoint(r,e,i),this}constructLineEllipticArc(e,s){return Gl(this,e,s,1),this}constructLineCircularArc(e,s){return Gl(this,e,s,0),this}constructEllipse(e,s,i,r,n=!1){this.m_semiMajorAxis=Math.abs(e),this.m_minorMajorRatio=Math.abs(s),this.m_minorMajorRatio>1&&(this.m_semiMajorAxis*=this.m_minorMajorRatio,this.m_minorMajorRatio=1/this.m_minorMajorRatio);const o=new M(0,this.m_minorMajorRatio*this.m_semiMajorAxis),a=Math.cos(r),l=Math.sin(r);return o.rotateDirect(a,l),o.addThis(i),this.constructEllipticArcEndPointsCenter(o,o,this.m_semiMajorAxis,this.m_minorMajorRatio,r,!0,n,i),this}inflate(e){if(this.isDegenerateToLine())return;let s=this.getSemiMinorAxis()+e;if(s=s<=0?0:(this.getSemiMajorAxis()+e)/this.getSemiMajorAxis(),this.isCircular()){const i=new Rt;i.setShiftCoords(-this.m_center.x,-this.m_center.y),i.scale(s,s),i.shiftCoords(this.m_center.x,this.m_center.y),this.applyTransformation(i)}else{const i=new Rt;this.canonicToWorldTransformation(i);const r=i.clone();r.invertPreciseThis(),r.scale(s,s),r.multiply(i),this.applyTransformation(r)}}constructEnclosingCircle(e,s,i=!1){return Ztt(this,e,s,i),this}constructThreePointCircle(e,s,i,r=!1){if(e.equals(s)||s.equals(i)||e.equals(i)){const n=e.clone(),o=s.clone(),a=i.clone();return n.equals(o)&&o.assign(a),this.constructTwoPointCircle(n,o,r)}{const n=M.calculateCircleCenterFromThreePoints(e,s,i);if(!n.isFinite()||!Number.isFinite(M.distance(e,n))){const o=M.distance(e,s),a=M.distance(e,i);this.constructLineCircularArc(e,o>=a?s:i)}return this.constructCircleCenterAndPoint(n,e,r)}}constructCircularArcThreePoint(e,s,i){const r=new le(e.x),n=new le(s.x),o=new le(i.x),a=new le(e.y),l=new le(s.y),u=new le(i.y),c=new le(.5),h=n.subE(r),m=l.subE(a),f=o.subE(r),g=u.subE(a),v=h.mulE(g).subThisE(m.mulE(f));if(v.scaleError(10),v.isZero()){if(!h.isZero()||!m.isZero())return Gl(this,e,s,0),this;{const ie=e.clone().addThis(s).mulThis(.5).addThis(i).mulThis(.5),se=i.sub(ie).length();this.constructEllipticArcEndPointsCenter(e,s,se,1,0,!0,!1,ie),this.m_interior.assign(i)}return this.setProjectionBehavior(0),this}const b=h.sqr().addThisE(m.sqr()).mulThisE(c),w=f.sqr().addThisE(g.sqr()).mulThisE(c),S=b.mulE(g).subThisE(w.mulE(m)),T=h.mulE(w).subThisE(f.mulE(b));S.divThisE(v),T.divThisE(v);const P=S.sqr().addThisE(T.sqr());P.sqrtThis();const I=S.addE(r),A=T.addE(a);let D=e.x-I.value(),k=e.y-A.value();const R=Math.atan2(k,D);D=s.x-I.value(),k=s.y-A.value();const O=Math.atan2(k,D);D=i.x-I.value(),k=i.y-A.value();const z=Math.atan2(k,D);let q=z-2*Lt();for(;q<R;)q+=2*Lt();let U=O-2*Lt();for(;U<q;)U+=2*Lt();let V=z+2*Lt();for(;V>R;)V-=2*Lt();let B,H=O+2*Lt();for(;H>V;)H-=2*Lt();B=U-R<R-H?U-R:H-R;const W=new M(I.value(),A.value());return this.constructEllipticArcEndPointsCenter(e,s,P.value(),1,0,Math.abs(B)>Lt(),B>0,W),this.m_interior.assign(i),this.setProjectionBehavior(0),this.afterCompletedModification(),this}constructCircularArc(e,s,i,r){return this.constructEllipticArcGeneral(e,1,s,i,r,0),this.setProjectionBehavior(0),this.afterCompletedModification(),this}constructEllipticArcEndPoints(e,s,i,r,n,o,a){return gre(this,e,s,i,r,n,o,a)}constructEllipticArcEndPointsCenter(e,s,i,r,n,o,a,l){return gre(this,e,s,i,r,n,o,a,l)}constructEllipticArcGeneral(e,s,i,r,n,o){this.m_semiMajorAxis=Math.abs(e),this.m_minorMajorRatio=Math.abs(s),this.m_minorMajorRatio>1&&(this.m_semiMajorAxis*=this.m_minorMajorRatio,this.m_minorMajorRatio=1/this.m_minorMajorRatio);const a=ure(o),l=Math.cos(a),u=Math.sin(a),c=new M(this.m_semiMajorAxis,this.m_minorMajorRatio*this.m_semiMajorAxis),h=M.getNAN(),m=ure(r);h.x=c.x*Math.cos(m),h.y=c.y*Math.sin(m),h.rotateDirect(l,u),h.addThis(i);const f=VJe(n,Gn());let g=f;Math.abs(g)===Gn()&&(g=0);const v=M.getNAN();return v.x=c.x*Math.cos(m+g),v.y=c.y*Math.sin(m+g),v.rotateDirect(l,u),v.addThis(i),this.constructEllipticArcEndPointsCenter(h,v,this.m_semiMajorAxis,this.m_minorMajorRatio,a,Math.abs(f)>Lt(),f>0,i)}constructEllipticArcAsNURB(e,s,i,r){return(r>=1||r<0)&&ee("construct_elliptic_arc_as_NURB: weight"),s.isFinite()||ee("construct_elliptic_arc_as_NURB: control_point"),bC([e,s,i],r*r,null,!1,this),this}constructCanonic(e){return this.assignCopy(e),e.isDegenerateToLine()||e.m_center.isEqual(0,0)&&this.m_rotation===0||(this.m_XStart=e.getSemiMajorAxis()*Math.cos(e.m_startAngle),this.m_YStart=e.getSemiMinorAxis()*Math.sin(e.m_startAngle),this.m_XEnd=e.getSemiMajorAxis()*Math.cos(e.getEndAngle()),this.m_YEnd=e.getSemiMinorAxis()*Math.sin(e.getEndAngle()),this.m_center.setCoords(0,0),this.m_rotation=0,this.m_cosr=1,this.m_sinr=0,Vv(this),this.afterCompletedModification(),e!==this&&J0e(this,e)),this}isCircular(){return this.m_minorMajorRatio===1&&this.m_rotation===0&&!this.isDegenerateToLine()}isDegenerateToLineHelper(e){return!!I9(this,[e])&&vs(this)}isDegenerateToLine(){return vs(this)}getCenter(){return this.m_center.clone()}setCenter(e){if(!this.m_center.isNAN()){const s=e.sub(this.m_center);this.m_XStart+=s.x,this.m_YStart+=s.y,this.m_XEnd+=s.x,this.m_YEnd+=s.y,this.m_interior.addThis(s),this.m_center.assign(e),this.endPointModified(),this.normalizeAfterEndpointChange()}}getAxisXRotation(){return this.m_rotation}getSemiAxes(){return M.construct(this.m_semiMajorAxis,this.m_semiMajorAxis*this.m_minorMajorRatio)}getSemiMajorAxis(){return this.m_semiMajorAxis}getSemiMinorAxis(){return this.m_semiMajorAxis*this.m_minorMajorRatio}getMinorMajorRatio(){return this.m_minorMajorRatio}isClockwise(){return!Ub(this)}isMajor(){return H9(this)}getSweepAngle(){return this.m_sweepAngle}getStartAngle(){return this.m_startAngle}getEndAngle(){return this.m_startAngle+this.m_sweepAngle}getGeometryType(){return G.enumEllipticArc}queryEnvelope(e){if(e.m_EnvelopeType===4){e.setEmpty(),e.assignVertexDescription(this.m_description);const s=X.constructEmpty();this.queryEnvelope(s),e.setEnvelope(s);for(let i=1,r=this.m_description.getAttributeCount();i<r;i++){const n=this.m_description.getSemantics(i);for(let o=0,a=m2.getComponentCount(n);i<a;i++){const l=this.queryInterval(n,o);e.setIntervalEnvelope(n,o,l)}}}else e.m_EnvelopeType===2?bre(this,de.unit(),e):yt("3d not impl")}applyTransformation(e){j9(this,e,!1)}createInstance(){return new xG}calculateLength2D(){return Utt(this,0,1)}queryCoord2D(e,s){if(vs(this))D9(e,this.getStartXY(),this.getEndXY(),s);else if(e===0)s.assign(M.construct(this.m_XStart,this.m_YStart));else if(e===1)s.assign(M.construct(this.m_XEnd,this.m_YEnd));else{const i=Iu(this,e),r=new M(this.m_semiMajorAxis*Math.cos(i),this.getSemiMinorAxis()*Math.sin(i));r.rotateDirect(this.m_cosr,this.m_sinr),r.addThis(this.m_center),s.assign(r)}}queryCoord2DE(e,s){Vtt(this,e,s)}getCoordX(e){const s=new M;return this.queryCoord2D(e,s),s.x}getCoordY(e){const s=new M;return this.queryCoord2D(e,s),s.y}cut(e,s,i){const r=new ut;return this.queryCut(e,s,r,i),r.releaseSegment()}queryCut(e,s,i,r){const n=i.createEllipticArc();let o=e===0&&s===1;if(o&&!r)return void this.copyTo(n);const a=M.getNAN();this.queryCoord2D(e,a);const l=M.getNAN();if(this.queryCoord2D(s,l),!o){if(a.equals(l))s-e>.5&&this.isMajor()&&this.isClosed()?(o=!0,e=0,s=1):s===1?e=s:s=e;else if(e>0&&a.isEqual(this.m_XStart,this.m_YStart)&&(e=0),s<1&&l.isEqual(this.m_XEnd,this.m_YEnd)&&(s=1),o=e===0&&s===1,o&&!r)return void this.copyTo(n)}if(n.m_center.assign(this.m_center),n.m_semiMajorAxis=this.m_semiMajorAxis,n.m_minorMajorRatio=this.m_minorMajorRatio,n.m_interior.assign(this.m_interior),n.m_rotation=this.m_rotation,n.m_cosr=this.m_cosr,n.m_sinr=this.m_sinr,n.m_sweepAngle=this.m_sweepAngle,n.m_startAngle=this.m_startAngle,n.m_bits=this.m_bits,Sie(n,a.x,a.y),Eie(n,l.x,l.y),o)return void pL(n,dL(this));n.m_startAngle=Iu(this,e),n.m_sweepAngle=Iu(this,s)-n.m_startAngle,n.m_startAngle=M_(n.m_startAngle),Bb(n,Math.abs(n.m_sweepAngle)>Lt()),n.assignVertexDescription(this.m_description),Vv(n),SG(n);const u=this.m_description.getAttributeCount();if(u>1){for(let c=1;c<u;c++){const h=this.m_description.getSemantics(c),m=m2.getComponentCount(h);for(let f=0;f<m;f++){const g=this.getAttributeAsDbl(e,h,f);n.setStartAttribute(h,f,g)}}for(let c=1;c<u;c++){const h=this.m_description.getSemantics(c),m=m2.getComponentCount(h);for(let f=0;f<m;f++){const g=this.getAttributeAsDbl(s,h,f);n.setEndAttribute(h,f,g)}}}n.afterCompletedModification()}queryDerivative(e,s){Ktt(this,e,s)}cutArcIgnoreAttributes(e,s,i){let r=e===0&&s===1;const n=new M;this.queryCoord2D(e,n);const o=new M;this.queryCoord2D(s,o),r||(n.equals(o)?s-e>.5&&this.isMajor()&&this.isClosed()?(r=!0,e=0,s=1):s===1?e=s:s=e:(e>0&&n.isEqual(this.m_XStart,this.m_YStart)&&(e=0),s<1&&o.isEqual(this.m_XEnd,this.m_YEnd)&&(s=1),r=e===0&&s===1)),i.m_center.assign(this.m_center),i.m_semiMajorAxis=this.m_semiMajorAxis,i.m_minorMajorRatio=this.m_minorMajorRatio,i.m_interior.assign(this.m_interior),i.m_rotation=this.m_rotation,i.m_cosr=this.m_cosr,i.m_sinr=this.m_sinr,i.m_sweepAngle=this.m_sweepAngle,i.m_startAngle=this.m_startAngle,i.m_bits=this.m_bits,Sie(i,n.x,n.y),Eie(i,o.x,o.y),r?pL(i,dL(this)):(i.m_startAngle=Iu(this,e),i.m_sweepAngle=Iu(this,s)-i.m_startAngle,i.m_startAngle=M_(i.m_startAngle),Bb(i,Math.abs(i.m_sweepAngle)>Math.PI),Vv(i),i.afterCompletedModification())}changeEndPoints2D(e,s){fre(this,e,s,!1)}getAttributeAsDbl(e,s,i){if(s===0)return i===0?this.getCoordX(e):this.getCoordY(e);if(e===0)return this.getStartAttributeAsDbl(s,i);if(e===1)return this.getEndAttributeAsDbl(s,i);const r=this.calculateLength2D(),n=r>0?this.tToLength(e)/r:0,o=m2.getInterpolation(s),a=this.getStartAttributeAsDbl(s,i),l=this.getEndAttributeAsDbl(s,i);return _P(o,a,l,n,m2.getDefaultValue(s))}getClosestCoordinate(e,s){return xre(this,e,de.unit(),s)}getClosestCoordinateOnInterval(e,s,i=-1){return xre(this,e,s,!1)}getYMonotonicParts(e,s=!1){e.length<2&&ee("");const i=this.getSemiAxes(),r=Math.atan2(i.y*this.m_cosr,i.x*this.m_sinr),n=r+Lt(),o=Me(3,Number.NaN);let a=0;if(o[0]=vi(this,r),o[0]>0&&o[0]<1&&a++,o[1]=vi(this,n),o[1]>0&&o[1]<1&&(o[a]=o[1],a++),a===0)return 0;o[a]=1,a++,F(e.length>=a);let l=0;for(let u=0;u<a;u++){const c=o[u];this.queryCut(l,c,e[u],s),l=c}return a}getMonotonicParts(e,s){if(e.length<4&&ee(""),this.isDegenerateToLine())return e[0].createEllipticArc().assignCopy(this),s&&e[0].get().dropAllAttributes(),1;const i=this.getSemiAxes(),r=Me(4,Number.NaN);r[0]=Math.atan2(i.y*this.m_cosr,i.x*this.m_sinr),r[1]=r[0]+Lt(),r[2]=Math.atan2(-i.y*this.m_sinr,i.x*this.m_cosr),r[3]=r[2]+Lt();const n=Me(5,Number.NaN);let o=0;for(let l=0;l<4;l++)n[o]=vi(this,r[l]),n[o]>0&&n[o]<1&&o++;if(o===0)return 0;L8(n,o),n[o-1]<1&&(n[o]=1,o++),F(e.length>=o);let a=0;for(let l=0;l<o;l++){const u=n[l];this.queryCut(a,u,e[l],s),a=u}return o}intersectionWithAxis2D(e,s,i,r){if(vs(this))return new pt({start:this.getStartXY(),end:this.getEndXY()}).intersectionWithAxis2D(e,s,i,r);let n,o;const a=new le(s),l=this.getSemiAxes();if(e){if(s>this.m_center.y+l.x||s<this.m_center.y-l.x)return 0;n=new le(l.x).mulThis(this.m_sinr),o=new le(l.y).mulThis(this.m_cosr),a.subThis(this.m_center.y)}else{if(s>this.m_center.x+l.x||s<this.m_center.x-l.x)return 0;n=new le(l.x).mulThis(this.m_cosr),o=new le(l.y).mulThis(-this.m_sinr),a.subThis(this.m_center.x)}const u=n.sqr(),c=o.sqr(),h=u.addE(c),m=o.mulE(a).mulThis(-2),f=a.sqr().subThisE(u),g=m.sqr().subThisE(h.mulE(f).mulThis(4)),v=n.mulE(a).mulThis(-2),b=a.sqr().subThisE(c),w=v.sqr().subThisE(h.mulE(b).mulThis(4));let S=g.eps()*Math.abs(w.value())<=w.eps()*Math.abs(g.value());S?n.isZero()&&(S=!1):o.isZero()&&(S=!0),S||(m.setE(v),f.setE(b));const T=ne(le,2);let P=xa(h,m,f,de.construct(-1,1),!1,T);if(P===0)return 0;const I=[0,0];let A=0;for(let D=0;D<P;D++){const k=new le,R=new le;S?(k.setE(T[D]),R.setE(a.subE(o.mulE(T[D])).divThisE(n))):(R.setE(T[D]),k.setE(a.subE(n.mulE(T[D])).divThisE(o)));const O=vi(this,Math.atan2(k.value(),R.value()));O>=0&&O<=1&&(I[A]=O,A++)}return P=A,P===0?0:(P===2&&I[0]>I[1]&&(I[1]=be(I[0],I[0]=I[1])),r&&$s(r,I,0,0,P),i&&(i[0]=e?this.getCoordX(I[0]):this.getCoordY(I[0]),P>1&&(i[1]=e?this.getCoordX(I[1]):this.getCoordY(I[1]),!r&&i[0]>i[1]&&(i[1]=be(i[0],i[0]=i[1])))),P)}intersectionOfYMonotonicWithAxisX(e,s){if(this.m_YStart===this.m_YEnd)return e===this.m_YStart?s:Number.NaN;if(e===this.m_YStart)return this.m_XStart;if(e===this.m_YEnd)return this.m_XEnd;const i=[0,0];return this.intersectionWithAxis2D(!0,e,i,null)===-1?s:i[0]}isCurve(){return!0}isDegenerate(e){return mR(this,e)}isDegenerate3D(e,s){return F(0),!1}queryLooseEnvelope(e){e.m_EnvelopeType!==3?this.queryLooseEnvelopeOnInterval(new de(0,1),e):yt("3d not impl")}clone(e){const s=new xG;return this.copyTo(s),s}queryInterval(e,s){if(e===0){if(vs(this))return s===0?de.construct(this.getStartX(),this.getEndX()):de.construct(this.getStartY(),this.getEndY());let i;const r=this.getSemiAxes();i=s===0?Math.atan2(-r.y*this.m_sinr,r.x*this.m_cosr):Math.atan2(r.y*this.m_cosr,r.x*this.m_sinr);const n=i+Math.PI,o=[0,0];o[0]=vi(this,i),o[1]=vi(this,n);const a=s===0?de.construct(this.getStartX(),this.getEndX()):de.construct(this.getStartY(),this.getEndY()),l=new M;for(let u=0;u<2;u++){const c=o[u];c>0&&c<1&&(this.queryCoord2D(c,l),a.mergeNeCoordinate(s===0?l.x:l.y))}return a}return super.queryInterval(e,s)}queryLooseEnvelopeOnInterval(e,s){const i=new de(0,1);if(i.intersect(e),i.isEmpty())return void s.setEmpty();if(vs(this))return s.setCoords(this.getCoord2D(i.vmin)),void s.mergeNe(this.getCoord2D(i.vmax));const r=this.getCoord2D(i.vmin),n=this.getCoord2D(i.vmax);if(this.m_minorMajorRatio===1&&Math.abs(this.m_sweepAngle)*i.width()<=Nt){let o=M.lerp(r,n,.5);const a=o.sub(this.m_center);return a.normalize(),o=o.add(a.mul(.5*M.distance(r,n))),s.setCoords(r),s.mergeNe(n),void s.mergeNe(o)}bre(this,i,s)}tToLength(e){return vs(this)?e*M.distance(this.getStartXY(),this.getEndXY()):this.m_minorMajorRatio===1?Math.abs(this.getSweepAngle()*e)*this.m_semiMajorAxis:EG(this,e)}parametricAngleToT(e){return vi(this,e)}tToParametricAngle(e){return Iu(this,e)}lengthToT(e){if(vs(this)){const s=M.distance(this.getStartXY(),this.getEndXY());return s===0?0:e/s}if(this.m_minorMajorRatio===1){const s=Math.abs(this.getSweepAngle())*this.m_semiMajorAxis;return s===0?0:e/s}return Htt(this,e)}calculateWeightedAreaCentroid2D(e){if(vs(this)){const c=new M;return c.setCoords(0,0),c}const s=_re(this),i=this.getStartXY().sub(this.m_center),r=this.getEndXY().sub(this.m_center),n=this.m_semiMajorAxis,o=this.getSemiMinorAxis(),a=this.m_startAngle+this.m_sweepAngle,l=new M;l.x=n*o*(n*this.m_cosr*(-Math.sin(a)+Math.sin(this.m_startAngle))+o*(-Math.cos(a)+Math.cos(this.m_startAngle))*this.m_sinr)/3,l.y=n*o*(o*(Math.cos(a)-Math.cos(this.m_startAngle))*this.m_cosr+n*(-Math.sin(a)+Math.sin(this.m_startAngle))*this.m_sinr)/3;const u=r.add(i).mul(r.crossProduct(i)/6);return l.x-=u.x,l.y-=u.y,l.add(this.m_center.sub(e).mul(s))}calculateWeightedCentroid2D(){const e=new M;if(this.isDegenerate(0))return e.setCoords(0,0),e;if(vs(this))return e.assign(this.getCoord2D(.5).mul(this.calculateLength2D())),e;let s=this.m_startAngle,i=this.m_startAngle+this.m_sweepAngle;if(i<s){const l=s;s=i,i=l}const r=Math.sin(s),n=Math.sin(i),o=Math.cos(s),a=Math.cos(i);if(this.m_minorMajorRatio===1){const l=this.getSemiMajorAxis(),u=l*l,c=u*(n-r),h=u*(o-a);e.setCoords(c,h)}else{const l=this.getSemiMajorAxis(),u=this.getSemiMinorAxis(),c=l*l,h=u*u,m=l*u,f=c-h,g=f/h,v=f/c,b=Math.sqrt(g),w=Math.sqrt(v),S=.5*m*(Math.asinh(b*n)/b+n*Math.sqrt(1+g*n*n))-.5*m*(Math.asinh(b*r)/b+r*Math.sqrt(1+g*r*r)),T=-.5*m*(Math.asin(w*a)/w+a*Math.sqrt(1-v*a*a))- -.5*m*(Math.asin(w*o)/w+o*Math.sqrt(1-v*o*o));e.setCoords(S,T)}return e.rotateDirect(this.m_cosr,this.m_sinr),e.assign(e.add(this.m_center.mul(this.calculateLength2D()))),e}isIntersectingPoint(e,s,i){if(i&&(e.isEqualPoint2D(this.getStartXY())||e.isEqualPoint2D(this.getEndXY())))return!1;if(!vs(this)){const o=M.distance(e,this.m_center),a=this.getSemiAxes();if(o<a.x-s||o>a.y+s)return!1}const r=this.getClosestCoordinate(e,!1),n=new M;return this.queryCoord2D(r,n),M.distance(n,e)<=s}isIntersectingPoint3D(e,s,i,r,n=1){return F(0),!1}getTangent(e){if(vs(this))return this.getEndXY().sub(this.getStartXY());{const s=Iu(this,e),i=new M;return i.setCoords(-this.m_semiMajorAxis*Math.sin(s),this.getSemiMinorAxis()*Math.cos(s)),this.m_rotation&&i.rotateDirect(this.m_cosr,this.m_sinr),i.scale(this.getSweepAngle()),i}}getDerivative(e){if(vs(this))return this.getEndXY().sub(this.getStartXY());{const s=Iu(this,e),i=new M;return i.setCoords(-this.m_semiMajorAxis*Math.sin(s),this.getSemiMinorAxis()*Math.cos(s)),this.m_rotation&&i.rotateDirect(this.m_cosr,this.m_sinr),i.scale(this.getSweepAngle()),i}}normalizeAfterEndpointChange(){return!!Y9(this)&&(vs(this)?(Ed(this),!1):Y1e(this,!1))}projectionBehavior(){return(4&this.m_bits)>>2}setProjectionBehavior(e){this.m_bits=-5&this.m_bits|e<<2}convertToCanonic(e){const s=new M(e.x,e.y);return s.subThis(this.m_center),s.rotateReverse(this.m_cosr,this.m_sinr),s}convertFromCanonic(e){const s=new M(e.x,e.y);return s.rotateDirect(this.m_cosr,this.m_sinr),s.addThis(this.m_center),s}canonicToWorldTransformation(e){e.setRotate(this.m_cosr,this.m_sinr),e.shiftCoords(this.m_center.x,this.m_center.y)}getCurvature(e){const s=Iu(this,e),i=new M,r=this.getSemiMinorAxis();i.setCoords(-this.m_semiMajorAxis*Math.sin(s),r*Math.cos(s));const n=new M;n.setCoords(-this.m_semiMajorAxis*Math.cos(s),-r*Math.sin(s)),this.m_rotation&&(i.rotateDirect(this.m_cosr,this.m_sinr),n.rotateDirect(this.m_cosr,this.m_sinr));const o=i.sqrLength();if(o===0)return Number.NaN;const a=Math.sqrt(o);return i.divThis(a),i.crossProduct(n)/o}getMonotonicPartParams(e,s){const i=Me(6,Number.NaN);i[0]=0;let r=1;if(this.isDegenerateToLine())i[1]=1,r=2;else{const n=this.getSemiAxes(),o=Me(4,Number.NaN);this.m_rotation?(o[0]=Math.atan2(n.y*this.m_cosr,n.x*this.m_sinr),o[1]=o[0]+Math.PI,o[2]=Math.atan2(-n.y*this.m_sinr,n.x*this.m_cosr),o[3]=o[2]+Math.PI):(o[0]=0,o[1]=Math.PI,o[2]=.5*Math.PI,o[3]=GJe());for(let a=0;a<4;a++){const l=vi(this,o[a]);l>0&&l<1&&(i[r]=l,r++)}r>2&&L8(i,r),i[r]=1,r++}if(s){e<r&&ee("");for(let n=0;n<r;n++)s[n]=i[n]}return r}calculateLowerLength2D(){const e=M.distance(this.getStartXY(),this.getEndXY());if(this.isDegenerateToLine())return e;const s=Math.abs(this.m_sweepAngle)*this.getSemiMinorAxis();return Math.max(s,e)}calculateUpperLength2D(){const e=M.distance(this.getStartXY(),this.getEndXY());if(this.isDegenerateToLine())return e;const s=Math.abs(this.m_sweepAngle)*this.getSemiMajorAxis();return Math.max(s,e)}orientBottomUp(){if(this.m_YEnd<this.m_YStart||this.m_YEnd===this.m_YStart&&this.m_XEnd<this.m_XStart){this.m_XEnd=be(this.m_XStart,this.m_XStart=this.m_XEnd),this.m_YEnd=be(this.m_YStart,this.m_YStart=this.m_YEnd);for(let e=0,s=this.m_description.getTotalComponentCount()-2;e<s;e++)this.m_attributes[e+s]=be(this.m_attributes[e],this.m_attributes[e]=this.m_attributes[e+s]);this.m_startAngle=this.m_startAngle+this.m_sweepAngle,this.m_sweepAngle=-this.m_sweepAngle}}isLine(){return vs(this)}copyIgnoreAttributes(e){e.m_XStart=this.m_XStart,e.m_YStart=this.m_YStart,e.m_XEnd=this.m_XEnd,e.m_YEnd=this.m_YEnd,e.m_center.assign(this.m_center),e.m_semiMajorAxis=this.m_semiMajorAxis,e.m_minorMajorRatio=this.m_minorMajorRatio,e.m_interior.assign(this.m_interior),e.m_rotation=this.m_rotation,e.m_cosr=this.m_cosr,e.m_sinr=this.m_sinr,e.m_sweepAngle=this.m_sweepAngle,e.m_startAngle=this.m_startAngle,e.m_bits=this.m_bits,aN(e)}calculateArea2DHelper(){return _re(this)}absNorm(){let e=this.getStartXY().norm(1)+this.getEndXY().norm(1);return this.isDegenerateToLine()||(e+=this.m_center.norm(1),e+=this.m_semiMajorAxis),e}queryEnvelopeW(e,s){if(s.setCoords(this.getCoord2D(e.vmin)),s.mergeNe(this.getCoord2D(e.vmax)),vs(this))return;const i=this.getSemiAxes(),r=Me(8,Number.NaN);{const o=Math.atan2(-i.y*this.m_sinr,i.x*this.m_cosr),a=o+Math.PI,l=Math.atan2(i.y*this.m_cosr,i.x*this.m_sinr),u=l+Math.PI;r[0]=vi(this,o),r[1]=vi(this,a),r[2]=vi(this,l),r[3]=vi(this,u)}{const o=this.m_cosr+this.m_sinr,a=this.m_cosr-this.m_sinr,l=Math.atan2(-i.y*o,i.x*a),u=l+Math.PI,c=Math.atan2(i.y*a,i.x*o),h=c+Math.PI;r[4]=vi(this,l),r[5]=vi(this,u),r[6]=vi(this,c),r[7]=vi(this,h)}const n=M.getNAN();for(let o=0;o<8;o++){const a=r[o];e.containsExclusiveCoordinate(a)&&(this.queryCoord2D(a,n),s.mergeNe(n))}}setSegmentFromCoords(e,s){Btt(this,e,s)}writeInBufferStream(e,s){const i=new Float64Array(10);return i[0]=this.m_bits,i[1]=this.m_semiMajorAxis,i[2]=this.m_minorMajorRatio,i[3]=this.m_rotation,i[4]=this.m_center.x,i[5]=this.m_center.y,i[6]=this.m_sweepAngle,i[7]=this.m_startAngle,i[8]=this.m_interior.x,i[9]=this.m_interior.y,e.writeRangeFromArray(s,i.length,i,!0,1),s+i.length}readFromBufferStream(e,s){const i=new Float64Array(10);e.queryRange(s,i.length,i,!0,1),this.m_bits=i[0],this.m_semiMajorAxis=i[1],this.m_minorMajorRatio=i[2],this.m_rotation=i[3],this.m_center.x=i[4],this.m_center.y=i[5],this.m_sweepAngle=i[6],this.m_startAngle=i[7],this.m_interior.x=i[8],this.m_interior.y=i[9],this.m_cosr=Math.cos(this.m_rotation),this.m_sinr=Math.sin(this.m_rotation),this.m_cachedValues=null}snapControlPoints(e){return!1}needsSnapControlPoints(e){return!1}calculateSpecialPointsForCracking(e,s){return Ce("should not1; be called"),0}ensureXYMonotone(){if(vs(this))return!1;if(this.getStartXY().equals(this.getEndXY()))return Gl(this,this.getStartXY(),this.getEndXY(),this.projectionBehavior()),!0;const e=ne(M,3);let s=X9(this,e);if(s0(e)){let i=!1;if(this.projectionBehavior()===0){const r=new X;r.setCoords({pt:e[0]}),r.mergeNe(e[2]);const n=new M;n.setSub(e[2],e[0]),n.leftPerpendicularThis(),n.normalize(),n.scale(M.distance(e[2],e[0]));const o=M.lerp(e[2],e[0],.5),a=o.sub(n),l=o.add(n);r.clipLine(a,l);const u=M.getClosestCoordinate(a,l,e[1],!1);e[1]=M.lerp(a,l,u);const c=e[2].sub(e[1]),h=e[0].sub(e[1]),m=c.crossProduct(h),f=c.dotProduct(h);s=jn()-Math.abs(.5*Math.atan2(m,f)),i=!0}return bC(e,s*s,null,i,this),!0}return!1}setCoordsForIntersector(e,s,i){fre(this,e,s,i)}getInteriorPoint(){return this.m_interior.clone()}copyToImpl(e){const s=e;s.m_center.assign(this.m_center),s.m_semiMajorAxis=this.m_semiMajorAxis,s.m_minorMajorRatio=this.m_minorMajorRatio,s.m_interior.assign(this.m_interior),s.m_rotation=this.m_rotation,s.m_cosr=this.m_cosr,s.m_sinr=this.m_sinr,s.m_sweepAngle=this.m_sweepAngle,s.m_startAngle=this.m_startAngle,s.m_bits=this.m_bits,pL(s,dL(this))}reverseImpl(){yR(this,!Ub(this)),SG(this),(this.projectionBehavior()!==0||this.getStartXY().equals(this.getEndXY()))&&Vv(this)}equalsImpl(e){const s=e;if(this.m_bits!==s.m_bits||this.m_semiMajorAxis!==s.m_semiMajorAxis||this.m_minorMajorRatio!==s.m_minorMajorRatio||!(this.m_center.isEqualPoint2D(s.m_center)||this.m_center.isNAN()&&s.m_center.isNAN())||this.m_rotation!==s.m_rotation||!this.m_interior.equals(s.m_interior))return!1;const i=s.m_sweepAngle;if(this.m_sweepAngle!==i)return!1;const r=s.m_startAngle;return this.m_startAngle===r}equalsImplTol(e,s){const i=e;if(this.m_bits!==i.m_bits)return!1;if(this.m_center.isNAN()&&i.m_center.isNAN())return!0;if(this.m_center.isNAN()!==i.m_center.isNAN()||!this.getSemiAxes().isEqualPoint2D(i.getSemiAxes(),s)||!this.m_center.isEqualPoint2D(i.m_center,s))return!1;const r=Math.abs(G1e(q1e(oN(this.m_rotation-i.m_rotation)))),n=Math.abs(Lt()-r),o=Math.min(r,n);if(this.m_semiMajorAxis*Math.abs(o)>s)return!1;const a=this.getCoord2D(.5),l=i.getCoord2D(.5);return!!a.isEqualPoint2D(l,s)}swapImpl(e){const s=e;this.m_center=be(s.m_center,s.m_center=this.m_center),this.m_semiMajorAxis=be(s.m_semiMajorAxis,s.m_semiMajorAxis=this.m_semiMajorAxis),this.m_minorMajorRatio=be(s.m_minorMajorRatio,s.m_minorMajorRatio=this.m_minorMajorRatio),this.m_interior=be(s.m_interior,s.m_interior=this.m_interior),this.m_rotation=be(s.m_rotation,s.m_rotation=this.m_rotation),this.m_cosr=be(s.m_cosr,s.m_cosr=this.m_cosr),this.m_sinr=be(s.m_sinr,s.m_sinr=this.m_sinr),this.m_sweepAngle=be(s.m_sweepAngle,s.m_sweepAngle=this.m_sweepAngle),this.m_startAngle=be(s.m_startAngle,s.m_startAngle=this.m_startAngle),this.m_bits=be(s.m_bits,s.m_bits=this.m_bits),Ytt(this,s)}afterCompletedModification(){Ed(this),aN(this)}intersect(e,s,i,r,n){return C0(!1,this,e,s,i,r,n)}intersectPoint(e,s,i){if(s.length<2&&bt(""),vs(this))return new pt({start:this.getStartXY(),end:this.getEndXY()}).intersectPoint(e,s,i);{const o=M.distance(e,this.m_center);if(o>this.m_semiMajorAxis+i||o<this.getSemiMinorAxis()-i)return 0}const r=this.getClosestCoordinate(e,!1),n=M.getNAN();return this.queryCoord2D(r,n),M.distance(n,e)<=i?bs(r,0,1)&&(this.queryCoord2D(r===0?1:0,n),M.distance(n,e)<=i)?(s&&(s[0]=0,s[1]=1),2):(s&&(s[0]=r),1):0}isIntersecting(e,s,i){return Cx(!1,this,e,s,i)!==0}endPointModified(){this.m_bits|=8,aN(this)}clearEndPointModified(){Ed(this)}};function $tt(t,e,s,i){const r=[];return Rtt(e,r),ktt(t,r,e,s)}function Rtt(t,e){e.length=t;for(let s=0;s<e.length;++s)e[s]=s;t>3&&yKe(t,e)}function ktt(t,e,s,i,r){let n=0;const o=[0,0,0];let a=0;const l=3;let u=0;for(let c=0;c<l;++c){let h=!1;for(;u<s;){const m=t.at(e[u]);let f=1;if(n===3?f=M.inCircleRobust(t.at(i[0]),t.at(i[1]),t.at(i[2]),m):n===2?f=M.inCircleRobust3Point(t.at(i[0]),t.at(i[1]),m):n===1&&m.equals(t.at(i[0]))&&(f=0),f<=0){if(f<0&&c+1<l){e[a]=be(e[u],e[u]=e[a]);for(let v=0;v<n;v++)if(i[v]===e[u]){o[v]=u;break}a++}u++;continue}h=!0;let g=0;for(let v=0;v<n;v++)o[v]>u&&(i[g]=i[v],o[g]=o[v],g++);n=g,i[n]=e[u],o[n]=u,n++,n<3?u=a:(M.orientationRobust(t.at(i[0]),t.at(i[1]),t.at(i[2]))===1&&(i[2]=be(i[0],i[0]=i[2]),o[2]=be(o[0],o[0]=o[2])),u++)}if(!h)break;if(c+1<l){a=0;let m=!1;for(let f=0;f<n;f++)for(let g=f+1;g<n;g++)o[f]>o[g]&&(o[g]=be(o[f],o[f]=o[g]),i[g]=be(i[f],i[f]=i[g]),m=!0);for(let f=0;f<n;f++)e[o[f]]=be(e[f],e[f]=e[o[f]]),o[f]=f;m&&n===3&&M.orientationRobust(t.at(i[0]),t.at(i[1]),t.at(i[2]))===1&&(i[2]=be(i[0],i[0]=i[2]),o[2]=be(o[0],o[0]=o[2]))}u=n}return n}Kc.type=G.enumEllipticArc;let wt=class wG extends G9{constructor(e){e?e.vd?(super({vd:e.vd,bPolygon:!0}),this.m_segmentBufferCTor=ut):e.copy?(super({vd:e.copy.getDescription(),bPolygon:!0}),this.m_segmentBufferCTor=ut,e.copy.copyTo(this)):e.move?(super({move:e.move}),this.m_segmentBufferCTor=ut):e.envelope?yt("envelope constructor not impl"):Ce("bad arg to polygon constructor"):(super({bPolygon:!0}),this.m_segmentBufferCTor=ut)}assignMove(e){return e.copyTo(this),this}assignCopy(e){return e.copyTo(this),this}getBoundary(){return Bc(this)}getExteriorRingCount(){return this.getOGCPolygonCount()}getGeometryType(){return wG.type}getDimension(){return 2}createInstance(){return new wG({vd:this.getDescription()})}equals(e,s){return this.equalsBase(e,s)}};function Ftt(t,e,s,i,r,n){return new U1e(0,0,0,null,!1,Qr()).densifyEx(t,e,s,i,!1,n)}function z9(t,e,s,i,r,n,o,a){n&&(n.length=0),o&&(o.length=0);const l=t.getGeometryType();if(l===G.enumLine)return n&&(n.push(t.getStartXY()),n.push(M.getNAN()),n.push(M.getNAN()),n.push(t.getEndXY())),o&&(o.push(0),o.push(1)),1;if(l===G.enumBezier){if(!i)return n&&(n.push(t.getStartXY()),n.push(t.getControlPoint1()),n.push(t.getControlPoint2()),n.push(t.getEndXY())),o&&(o.push(0),o.push(1)),1;const u=Me(9,Number.NaN);let c=t.getMonotonicPartParams(u.length,u);if(u.length=c,c=gE(t,s,u),c===2&&r&&(u[1]=.5,u.push(1),c=3),o&&o.splice(0,0,...u.slice(0,c)),n){const h=new ut;for(let m=1;m<c;m++){const f=u[m-1],g=u[m];t.queryCut(f,g,h,!0);const v=h.get();sD(v),m===1&&n.push(v.getStartXY()),n.push(v.getControlPoint1()),n.push(v.getControlPoint2()),n.push(v.getEndXY())}}return c-1}if(l===G.enumEllipticArc){const u=t;if(u.isDegenerateToLine()||u.isDegenerate(0))return n&&(n.push(t.getStartXY()),n.push(M.getNAN()),n.push(M.getNAN()),n.push(t.getEndXY())),o&&(o.push(0),o.push(1)),1;if(i&&(r||!u.isMonotoneQuickAndDirty())){const c=Me(6,Number.NaN);let h=u.getMonotonicPartParams(c.length,c);c.length=h,h=gE(t,s,c),h===2&&r&&(c[1]=.5,c.push(1),h=3);let m=0;if(h>2){const f=new ut,g=o||[];let v=0;for(let b=1;b<h;b++){const w=c[v],S=c[b];if(u.queryCut(w,S,f,!0),f.get().isDegenerate(0))continue;const T=g.length,P=hre(b===1,f.get(),e,s,i,n,o);F(P>0),m+=P;const I=b===h-1,A=c[v],D=f.get().getSweepAngle()/u.getSweepAngle();for(let k=T,R=g.length;k<R;k++)if(g[k]=!I||k+1<R?A+g[k]*D:1,n){const O=3*k,z=u.getCoord2D(g[k]);n[O].setCoordsPoint2D(z),O>0&&gR(n.slice(O-3))}v=b}return m}}return hre(!0,u,e,s,i,n,o)}if(l===G.enumRationalBezier2){const u=t;if(i&&(r||!u.isMonotoneQuickAndDirty())){const c=Me(6,Number.NaN);let h=u.getMonotonicPartParams(c.length,c);c.length=h,h=gE(t,s,c),h===2&&r&&(c[1]=.5,c.push(1),h=3);let m=0;if(h>2){const f=new ut,g=o||[];for(let v=1;v<h;v++){const b=c[v-1],w=c[v];u.queryCut(b,w,f,!0);const S=g.length;m+=mre(v===1,f.get(),e,s,!1,n,o);const T=v===h-1,P=c[v-1];for(let I=S,A=g.length;I<A;I++)if(g[I]=!T||I+1<A?P+g[I]:1,n){const D=3*I,k=u.getCoord2D(g[I]);n[D].setCoordsPoint2D(k),D>0&&T1e(n.slice(D-3))}}return m}}return mre(!0,u,e,s,i,n,o)}if(l===G.enumBezier2){const u=t,c=ne(M,3);u.queryControlPoints(c);const h=new Hl;return h.constructFromQuadratic(c),z9(h,e,s,i,r,n,o)}yt("")}function rD(t,e,s,i,r,n,o,a,l){const u=t.getGeometryType();if(n&&(n.length=0,o.length=0),a&&(a.length=0),u===G.enumEllipticArc){const m=t;if(m.isDegenerateToLine()||m.isDegenerate(0))return n&&(n.push(t.getStartXY()),n.push(M.getNAN()),n.push(t.getEndXY()),o.push(Number.NaN),o.push(Number.NaN),o.push(Number.NaN)),a&&(a.push(0),a.push(1)),1}const c=Me(9,Number.NaN);let h;if(r)h=t.getMonotonicPartParams(c.length,c),c.length=h,h=gE(t,s,c);else{if(h=2,c[0]=0,c[1]=1,u===Kc.type){const m=t.getSweepAngle();if(m>.9*Math.PI){const f=2*Math.PI/3;Math.min(3,Math.trunc(m/f+.5))>2?(c[0]=0,c[1]=1/3,c[2]=2/3,c[3]=1,h=4):(c[0]=0,c[1]=.5,c[2]=1,h=3)}}else F(u===Oo.type);c.length=h}if(h===2&&i&&(c[1]=.5,c.push(1),h=3),n){const m=new ut;let f=1;for(;f<h;){const g=c[f-1],v=c[f];t.queryCut(g,v,m,!0);const b=ne(M,3),w=[1,1,1];if(u===G.enumEllipticArc){const S=m.get();if(Math.abs(S.getSweepAngle())>.9*Math.PI){const T=(v-g)/3;c.splice(f,0,g+T),c.splice(f+1,0,g+2*T),h+=2;continue}w[1]=X9(S,b)}else{const S=m.get();S.queryControlPoints(b),S.queryWeights(w)}r&&s0(b),f===1&&(n.push(b[0].clone()),o.push(w[0])),n.push(b[1].clone()),n.push(b[2].clone()),o.push(w[1]),o.push(w[2]),f++}}return a&&(a.length=h,$s(a,c,0,0,h)),h-1}wt.type=G.enumPolygon;let U1e=class Ah{static constructDefault(e){return new Ah(0,0,0,e,!1,Qr())}constructor(e,s,i,r,n,o){this.m_segmentBuffer=null,this.m_dummyPoint=new nt,this.m_progressCounter=0,this.m_progressTracker=r,this.m_bSetDensifyFlag=n,this.m_maxLength=e,this.m_maxDeviation=s,this.m_maxAngle=i>jn()?jn():i,this.m_cosMaxAngle=Math.cos(this.m_maxAngle),this.m_bOnlyCurveDensify=this.m_maxAngle>0||this.m_maxDeviation>0,this.m_maxSegmentsPerCurve=o,KE(this.m_maxSegmentsPerCurve>0,"this.m_maxSegmentsPerCurve > 0"),this.m_minStep=1/this.m_maxSegmentsPerCurve}densify(e){return this.densifyGeom(e)}densifySegment(e,s){this.densifySegmentEx(e,null,!0,!1,s)}densifyEx(e,s,i,r,n,o){return this.m_maxLength=s,this.m_maxDeviation=i,this.m_maxAngle=r>jn()?jn():r,this.m_cosMaxAngle=Math.cos(this.m_maxAngle),this.m_bOnlyCurveDensify=this.m_maxAngle>0||this.m_maxDeviation>0,this.m_bSetDensifyFlag=n,this.m_maxSegmentsPerCurve=o,KE(this.m_maxSegmentsPerCurve>0,"this.m_maxSegmentsPerCurve > 0"),this.m_minStep=1/this.m_maxSegmentsPerCurve,this.densifyGeom(e)}densifyGeom(e){if(e.isEmpty()||e.getDimension()<1)return e;const s=e.getGeometryType();return _9(s)?e:xt(s)?this.densifyMultiPath(e):zi(s)?this.densifySegmentImpl(e):s===G.enumEnvelope?this.densifyEnvelope(e):void Ce("")}densifySegmentEx(e,s,i,r,n){const o=e.getGeometryType();if(!(this.m_maxLength>0||this.m_bOnlyCurveDensify&&o!==G.enumLine)&&(!r||i))return void(s?o===G.enumLine?s.addSegment(e,i):(i&&(e.queryStart(this.m_dummyPoint),s.startPathPoint(this.m_dummyPoint)),e.queryEnd(this.m_dummyPoint),s.lineToPoint(this.m_dummyPoint)):(i&&n.push(0),n.push(1)));if(o===G.enumBezier)return void this.densifyCubicBezier(e,s,i,r,n);if(o===G.enumRationalBezier2)return void this.densifyRationalBezier2(e,s,i,r,n);if(o===G.enumBezier2)return void this.densifyBezier2(e,s,i,r,n);if(o===G.enumEllipticArc&&!e.isLine()&&e.getMinorMajorRatio()<.25)return void this.densifyEllipticArc(e,s,i,r,n);let a=1;this.m_maxLength>0&&(a=this.calculateLengthSubdivisionStep(e,this.m_maxLength)),this.m_maxDeviation>0&&(a=Math.min(a,this.calculateDeviationSubdivisionStep(e,this.m_maxDeviation))),this.m_maxAngle>0&&(a=Math.min(a,this.calculateAngularSubdivisionStep(e,this.m_maxAngle))),this.densifySegmentByLength(e,a,s,i,r,n)}densifyMultiPath(e){if(!e.hasNonLinearSegments()){if(e.getDescription().getAttributeCount()===1)return this.densifyMultiPathLinear(e);if(!(this.m_maxLength>0))return e}const s=e.createInstance();s.getGeometryType()===G.enumPolygon&&s.setFillRule(e.getFillRule()),s.reserve(e.getPointCount());const i=e.getImpl().querySegmentIterator();for(;i.nextPath();){let r=!0;for(;i.hasNextSegment();){const n=i.nextSegment(),o=i.isClosingSegment();this.densifySegmentEx(n,s,r,o,null),o&&s.closePathWithLine(),r=!1}}return s}densifySegmentImpl(e){const s=new qt({vd:e.getDescription()}),i=[0];return this.densifySegmentEx(e,s,!0,!1,i),s}densifyEnvelope(e){const s=new wt({vd:e.getDescription()});s.addEnvelope(e,!1);const i=X.constructEmpty();e.queryEnvelope(i);const r=i.width(),n=i.height();return!(this.m_maxLength>0)||r<=this.m_maxLength&&n<=this.m_maxLength?s:this.densifyMultiPath(s)}densifyMultiPathLinear(e){if(!(this.m_maxLength>0))return e;const s=e.createInstance();s.getGeometryType()===G.enumPolygon&&s.setFillRule(e.getFillRule()),s.reserve(e.getPointCount());const i=s.getImpl(),r=e.getImpl(),n=r.getAttributeStreamRef(0),o=new pt;for(let a=0,l=r.getPathCount();a<l;a++){const u=r.isClosedPath(a);if(r.getPathSize(a)===0)continue;const c=r.getPathStart(a),h=n.readPoint2D(2*c),m=h.clone();i.startPath(h);for(let f=c+1,g=r.getPathEnd(a);f<g;f++){const v=n.readPoint2D(2*f),b=M.distance(m,v);if(b>this.m_maxLength){let w=Math.ceil(b/this.m_maxLength);w>Qr()&&(w=Qr());const S=1/w;let T,P,I;m.compare(v)<0?(o.setStartXY(m),o.setEndXY(v),T=0,P=1):(o.setStartXY(v),o.setEndXY(m),T=w-2,P=-1);for(let A=0,D=w-1;A<D;A++,T+=P){this.progress_(),I=S*(T+1);const k=new M;o.queryCoord2D(I,k),i.lineTo(k),this.m_bSetDensifyFlag&&i.setAttribute(10,i.getPointCount()-1,0,1)}}else this.progress_();s.lineTo(v),m.assign(v)}if(u){const f=M.distance(m,h);if(f>this.m_maxLength){const g=h;let v=Math.ceil(f/this.m_maxLength);v>Qr()&&(v=Qr());const b=1/v;let w,S;m.compare(g)<0?(o.setStartXY(m),o.setEndXY(g),w=0,S=1):(o.setStartXY(g),o.setEndXY(m),w=v-2,S=-1);const T=new M(0,0);let P;for(let I=0,A=v-1;I<A;I++,w+=S)this.progress_(),P=b*(w+1),o.queryCoord2D(P,T),i.lineTo(T),this.m_bSetDensifyFlag&&i.setAttribute(10,i.getPointCount()-1,0,1)}i.closePathWithLine()}}return s}densifySegmentByLength(e,s,i,r,n,o){F(e.getGeometryType()!==G.enumBezier);let a=e.getStartXY().compare(e.getEndXY());a===0&&s<1&&(e.getGeometryType()===G.enumEllipticArc?a=e.getSweepAngle()<0?1:-1:yt("densify segment by length"));let l=0;if(r&&(i?(e.queryStart(this.m_dummyPoint),i.startPathPoint(this.m_dummyPoint)):o.push(0),++l),s*this.m_maxSegmentsPerCurve<1&&(s=1/this.m_maxSegmentsPerCurve),s<1){this.m_segmentBuffer||(this.m_segmentBuffer=new ut);let u=Math.ceil(1/s);u>Qr()&&(u=Qr()),s=1/u,this.m_segmentBuffer.create(e.getGeometryType());let c,h,m,f=e;a<0?(c=0,h=1):(e.copyTo(this.m_segmentBuffer.get()),this.m_segmentBuffer.get().reverse(),c=u-2,h=-1,f=this.m_segmentBuffer.get());const g=u-1;for(let v=0;v<g;v++,c+=h)m=s*(c+1),i?(f.queryCoord(m,this.m_dummyPoint),i.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&m!==1&&m!==0&&i.setAttribute(10,i.getPointCount()-1,0,1)):o.push(a>0?1-m:m),this.progress_();m=1,l+=g}(!n||n&&r&&l<2)&&(i?(e.queryEnd(this.m_dummyPoint),i.lineToPoint(this.m_dummyPoint)):o.push(1))}densifyCubicBezier(e,s,i,r,n){const o=new Hl;let a=e;const l=e.calculateUpperLength2D();let u=e.getStartXY().compare(e.getEndXY());if(u===0&&l>0){const b=ne(M,4);e.queryControlPoints(b),u=b[1].compare(b[2]),u===0&&(u=b[1].compare(b[0]))}u>0&&(e.copyTo(o),o.reverse(),a=o);let c=0;i&&(s?(e.queryStart(this.m_dummyPoint),s.startPathPoint(this.m_dummyPoint)):n.push(0),++c);const h=[],m=[],f=Math.trunc(Math.log2(this.m_maxSegmentsPerCurve));let g=!0,v=0;if(u>0)for(h.push([a.getStartXY(),a.getControlPoint1(),a.getControlPoint2(),a.getEndXY(),new M(0,1)]),m.push(0);h.length;){this.progress_();const b=h.at(-1),w=m.at(-1),S=b[4].x,T=b[4].y;if(w<f&&this.bezierNeedsSplit(b)){g&&(v=a.findMinDeriv(),g=!1);let P=.5*(S+T);Math.abs(v-P)<.4*(T-S)&&(P=v);const I=(P-S)/(T-S),A=b[0].mul(1-I).add(b[1].mul(I)),D=b[1].mul(1-I).add(b[2].mul(I)),k=b[2].mul(1-I).add(b[3].mul(I)),R=A.mul(1-I).add(D.mul(I)),O=D.mul(1-I).add(k.mul(I)),z=R.mul(1-I).add(O.mul(I)),q=b[3];b[1]=A,b[2]=R,b[3]=z,b[4].setCoords(S,P);const U=[z,O,k,q,new M(P,T)];h.push(U),m[m.length-1]=w+1,m.push(w+1)}else h.pop(),m.pop(),(h.length>0||!r||r&&i&&c<2)&&(s?(a.queryCoord(S,this.m_dummyPoint),s.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&S!==1&&S!==0&&s.setAttribute(10,s.getPointCount()-1,0,1)):n.push(1-S),++c)}else for(h.push([a.getStartXY(),a.getControlPoint1(),a.getControlPoint2(),a.getEndXY(),new M(0,1)]),m.push(0);h.length;){this.progress_();const b=h.at(-1),w=m.at(-1),S=b[4].x,T=b[4].y;if(w<f&&this.bezierNeedsSplit(b)){g&&(v=a.findMinDeriv(),g=!1);let P=.5*(S+T);Math.abs(v-P)<.4*(T-S)&&(P=v);const I=(P-S)/(T-S),A=b[0].mul(1-I).add(b[1].mul(I)),D=b[1].mul(1-I).add(b[2].mul(I)),k=b[2].mul(1-I).add(b[3].mul(I)),R=A.mul(1-I).add(D.mul(I)),O=D.mul(1-I).add(k.mul(I)),z=R.mul(1-I).add(O.mul(I)),q=b[0];b[0]=z,b[1]=O,b[2]=k,b[4].setCoords(P,T);const U=[q,A,R,z,new M(S,P)];h.push(U),m[m.length-1]=w+1,m.push(w+1)}else h.pop(),m.pop(),(h.length>0||!r||r&&i&&c<2)&&(s?(a.queryCoord(T,this.m_dummyPoint),s.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&T!==1&&T!==0&&s.setAttribute(10,s.getPointCount()-1,0,1)):n.push(T),++c)}}densifyRationalBezier2(e,s,i,r,n){const o=new Oo;let a=e;const l=e.calculateUpperLength2D();let u=e.getStartXY().compare(e.getEndXY());u===0&&l>0&&(u=0),u>0&&(e.copyTo(o),o.reverse(),a=o);let c=0;i&&(s?(e.queryStart(this.m_dummyPoint),s.startPathPoint(this.m_dummyPoint)):n.push(0),++c);const h=Math.trunc(Math.log2(this.m_maxSegmentsPerCurve)),m=new Oo,f=[],g=[];for(f.push(new de(0,1)),g.push(0);f.length;){this.progress_();const v=f.at(-1).clone(),b=g.at(-1);if(b<h&&this.rationalBezier2NeedsSplit(a,m,v.vmin,v.vmax)){const w=v.getCenter();u>0?(f.at(-1).vmax=w,f.push(new de(w,v.vmax))):(f.at(-1).vmin=w,f.push(new de(v.vmin,w))),g[g.length-1]=b+1,g.push(b+1)}else if(f.pop(),g.pop(),f.length>0||!r||r&&i&&c<2){const w=u>0?v.vmin:v.vmax;s?(a.queryCoord(w,this.m_dummyPoint),s.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&w!==1&&w!==0&&s.setAttribute(10,s.getPointCount()-1,0,1)):n.push(u>0?1-w:w),++c}}}densifyBezier2(e,s,i,r,n){const o=new t0;let a=e;const l=e.calculateUpperLength2D();let u=e.getStartXY().compare(e.getEndXY());u===0&&l>0&&(u=0),u>0&&(e.copyTo(o),o.reverse(),a=o);let c=0;i&&(s?(e.queryStart(this.m_dummyPoint),s.startPathPoint(this.m_dummyPoint)):n.push(0),++c);const h=Math.ceil(Math.log2(this.m_maxSegmentsPerCurve)),m=new t0,f=[],g=[];for(f.push(new de(0,1)),g.push(0);f.length;){this.progress_();const v=f.at(-1).clone(),b=g.at(-1);if(b<h&&this.bezier2NeedsSplit(a,m,v.vmin,v.vmax)){const w=v.getCenter();u>0?(f.at(-1).vmax=w,f.push(new de(w,v.vmax))):(f.at(-1).vmin=w,f.push(new de(v.vmin,w))),g[g.length-1]=b+1,g.push(b+1)}else if(f.pop(),g.pop(),f.length>0||!r||r&&i&&c<2){const w=u>0?v.vmin:v.vmax;s?(a.queryCoord(w,this.m_dummyPoint),s.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&w!==1&&w!==0&&s.setAttribute(10,s.getPointCount()-1,0,1)):n.push(u>0?1-w:w),++c}}}densifyEllipticArc(e,s,i,r,n){const o=new Kc;let a=e;const l=e.calculateUpperLength2D();let u=e.getStartXY().compare(e.getEndXY());u===0&&l>0&&(u=e.isClockwise()?0:1),u>0&&(e.copyTo(o),o.reverse(),a=o);let c=0;i&&(s?(e.queryStart(this.m_dummyPoint),s.startPathPoint(this.m_dummyPoint)):n.push(0),++c);const h=Math.trunc(Math.log2(this.m_maxSegmentsPerCurve)),m=new Kc,f=[],g=[];for(f.push(new de(0,1)),g.push(0);f.length;){this.progress_();const v=f.at(-1).clone(),b=g.at(-1);if(b<h&&this.ellipticArcNeedsSplit(a,m,v.vmin,v.vmax)){const w=v.getCenter();u>0?(f.at(-1).vmax=w,f.push(new de(w,v.vmax))):(f.at(-1).vmin=w,f.push(new de(v.vmin,w))),g[g.length-1]=b+1,g.push(b+1)}else if(f.pop(),g.pop(),f.length>0||!r||r&&i&&c<2){const w=u>0?v.vmin:v.vmax;s?(a.queryCoord(w,this.m_dummyPoint),s.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&w!==1&&w!==0&&s.setAttribute(10,s.getPointCount()-1,0,1)):n.push(u>0?1-w:w),++c}}}calculateLengthSubdivisionStep(e,s){const i=e.calculateUpperLength2D();if(!e.isCurve())return i?s/i:1;if(e.getGeometryType()===G.enumEllipticArc){const r=e;if(r.isCircular()||r.isDegenerate(0)||r.isDegenerateToLine()){let n=s/i;return n<this.m_minStep&&(n=this.m_minStep),n}return s/i*r.getSemiAxes().y/r.getSemiAxes().x}e.getGeometryType()===G.enumBezier&&yt(""),yt("")}calculateDeviationSubdivisionStep(e,s){if(!e.isCurve())return 1;if(e.getGeometryType()===G.enumEllipticArc){const i=e;if(i.isDegenerate(0)||i.isDegenerateToLine())return 1;{const r=i.getSemiMajorAxis(),n=1-s/r;let o=Math.PI/2;if(n>0){const l=4*Math.sqrt(s/r*.5);o=Math.min(Math.PI/2,Math.abs(l))}o=Math.max(o,2*Math.PI/this.m_maxSegmentsPerCurve);const a=o*r;return this.calculateLengthSubdivisionStep(e,a)}}yt("")}calculateAngularSubdivisionStep(e,s){if(!e.isCurve())return 1;if(e.getGeometryType()===G.enumEllipticArc){const i=e;return i.isDegenerate(0)||i.isDegenerateToLine()?1:this.calculateLengthSubdivisionStep(e,s*i.getSemiMinorAxis())}yt("")}rationalBezier2NeedsSplit(e,s,i,r){e.cutBezierIgnoreAttributes(i,r,s);let n=!1;if(this.m_maxLength>0&&s.calculateUpperLength2D()>this.m_maxLength)return n=!0,!0;const o=ne(M,3);s.queryControlPoints(o);const a=[0,0,0];return s.queryWeights(a),!n&&this.m_maxDeviation>0&&(n=!Ah.checkRationalBezier2MaxDeviation(o,a,this.m_maxDeviation)),!n&&this.m_maxAngle>0&&(n=!Ah.checkRationalBezier2MaxAngle(o,a,this.m_cosMaxAngle)),n}bezier2NeedsSplit(e,s,i,r){e.cutBezierIgnoreAttributes(i,r,s);let n=!1;if(this.m_maxLength>0&&s.calculateUpperLength2D()>this.m_maxLength)return n=!0,!0;const o=ne(M,3);return s.queryControlPoints(o),!n&&this.m_maxDeviation>0&&(n=!Ah.checkBezier2MaxDeviation(o,this.m_maxDeviation)),!n&&this.m_maxAngle>0&&(n=!Ah.checkBezier2MaxAngle(o,this.m_cosMaxAngle)),n}ellipticArcNeedsSplit(e,s,i,r){e.cutArcIgnoreAttributes(i,r,s);let n=!1;return this.m_maxLength>0&&s.calculateUpperLength2D()>this.m_maxLength?(n=!0,!0):(!n&&this.m_maxDeviation>0&&(n=!Ah.checkEllipticArcMaxDeviation(s,this.m_maxDeviation)),!n&&this.m_maxAngle>0&&(n=!Ah.checkEllipticArcMaxAngle(s,this.m_cosMaxAngle)),n)}bezierNeedsSplit(e){let s=!1;return this.m_maxLength>0&&M.distance(e[0],e[1])+M.distance(e[1],e[2])+M.distance(e[2],e[3])>this.m_maxLength?(s=!0,!0):(!s&&this.m_maxDeviation>0&&(s=!Ah.checkBezierMaxDeviation(e,this.m_maxDeviation)),!s&&this.m_maxAngle>0&&(s=!Ah.checkBezierMaxAngle(e,this.m_cosMaxAngle)),s)}progress_(){}static checkBezierMaxDeviation(e,s){const i=e[3].sub(e[0]);if(i.sqrLength()>0){const r=i.clone();r.leftPerpendicularThis(),r.normalize();const n=r.dotProduct(e[0].sub(e[1])),o=r.dotProduct(e[0].sub(e[2]));if(Math.max(Math.abs(n),Math.abs(o))<=s){const a=new M;ri(e,.5,a,!1);const l=a.sub(e[0]).dotProduct(i);return l>=0&&l<=i.sqrLength()}return!1}return Math.max(e[0].sub(e[1]).sqrLength(),e[0].sub(e[2]).sqrLength())<=s*s}static checkBezierMaxAngle(e,s){if(e[0].equals(e[3]))return!(!e[0].equals(e[1])||!e[1].equals(e[2]));const i=e[3].sub(e[0]);i.normalize();{const r=e[1].sub(e[0]),n=r.dotProduct(i);if(n<0||r.length()*s>n)return!1}{const r=e[2].sub(e[0]),n=r.dotProduct(i);if(n<0||r.length()*s>n)return!1}{const r=e[2].sub(e[1]),n=r.dotProduct(i);if(n<0||r.length()*s>n)return!1}return!0}static checkRationalBezier2MaxDeviation(e,s,i){if(s[1]===0)return!1;const r=e[2].sub(e[0]);if(r.sqrLength()>0){const n=r.clone();n.leftPerpendicularThis(),n.normalize();const o=n.dotProduct(e[0].sub(e[1]));if(Math.abs(o)<=i){const a=e[1].sub(e[0]).dotProduct(r);return a>=0&&a<=r.sqrLength()}return!1}return e[0].sub(e[1]).sqrLength()<=i*i}static checkRationalBezier2MaxAngle(e,s,i){if(s[1]===0)return!1;if(e[0].equals(e[2]))return!!e[0].equals(e[1]);const r=e[2].sub(e[0]);r.normalize();{const n=e[1].sub(e[0]),o=n.dotProduct(r);if(o<0||n.length()*i>o)return!1}return!0}static checkBezier2MaxDeviation(e,s){const i=e[2].sub(e[0]);if(i.sqrLength()>0){const r=i.clone();r.leftPerpendicularThis(),r.normalize();const n=r.dotProduct(e[0].sub(e[1]));if(Math.abs(n)<=s){const o=e[1].sub(e[0]).dotProduct(i);return o>=0&&o<=i.sqrLength()}return!1}return e[0].sub(e[1]).sqrLength()<=s*s}static checkBezier2MaxAngle(e,s){if(e[0].equals(e[2]))return!!e[0].equals(e[1]);const i=e[2].sub(e[0]);i.normalize();{const r=e[1].sub(e[0]),n=r.dotProduct(i);if(n<0||r.length()*s>n)return!1}return!0}static checkEllipticArcMaxDeviation(e,s){if(Math.abs(e.getSweepAngle())<Math.PI){const n=e.getEndXY().sub(e.getStartXY()),o=[0,0];if(Jtt(e,n,o)===1){const a=e.getCoord2D(o[0]),l=M.getClosestCoordinate(e.getStartXY(),e.getEndXY(),a),u=new M;return wi(e.getStartXY(),e.getEndXY(),l,u),M.distance(a,u)<=s}}const i=e.getCoord2D(.5),r=new M;return wi(e.getEndXY(),e.getStartXY(),.5,r),M.distance(i,r)<=s}static checkEllipticArcMaxAngle(e,s){const i=e.getTangent(0),r=e.getTangent(1),n=i.dotProduct(r);return!(n<0)&&!(i.length()*r.length()*s>n)}static checkTypeForReplace(e,s){return e.getGeometryType()===s&&(s!==G.enumEllipticArc||e.isCircular())}};function gE(t,e,s){const i=s.length;if(e<=0||i<=2)return i;let r=0;const n=Me(i-1,Number.NaN);for(let o=1,a=i;o<a;o++){const l=t.tToLength(s[o]);n[o-1]=l-r,r=l}for(;n.length>1;){const o=n.findIndex(u=>u<=2*e);if(o===-1)break;let a=o+1,l=o+1;if(o>0){const u=o-1;(l===n.length||n[u]>n[l])&&(l=u,a--)}n[l]+=n[o],n.splice(o,1),s.splice(a,1)}return s.length}function hre(t,e,s,i,r,n,o,a){const l=e.clone();l.dropAllAttributes();const u=(W,ie,se,Z)=>(ie&&(W&&ie.push(Z.getStartXY()),ie.push(M.getNAN()),ie.push(M.getNAN()),ie.push(Z.getEndXY())),se&&(W&&se.push(0),se.push(1)),1);if(l.isDegenerateToLine()||l.isDegenerate(0))return u(t,n,o,e);const c=l.getStartXY(),h=l.getEndXY(),m=l.getSemiAxes(),f=new Rt;if(l.isCircular())f.setIdentity();else{const W=l.getAxisXRotation();f.setScaleCoords(1,l.getMinorMajorRatio()),f.rotateAngle(W)}const g=l.getCenter();f.shift(g);const v=f.clone();v.invertThis(),l.applyTransformation(v);const b=l.getSweepAngle();if(b===0)return u(t,n,o,e);const w=X.constructEmpty();w.setCoords({center:g,width:2*m.x,height:2*m.x});const S=.05*w.calculateToleranceFromEnvelope(),T=Math.max(s/m.x,S/m.x);let P=4*Math.pow(T/.0741,1/6);P=Math.min(P,Math.PI/2);const I=z1e(l.getStartAngle());let A=b>0?Math.floor(I/P):Math.ceil(I/P);A*=P;const D=b>0?P:-P;A+D===I&&(A+=D);let k=4/3*Math.tan(Math.abs(P)/4);b>0&&(k=-k),o&&t&&o.push(0);const R=P/Math.abs(b);let O=(A-I)/b;const z=c.clone(),q=new M;l.queryCoord2D(0,q);const U=q.clone(),V=1-.01*R;let B=0,H=0;for(;O<1;){let W;if(O+=R,H>0&&O<V)W=k;else{O>=V&&(O=1);const ve=(O-H)*b;W=4/3*Math.tan(Math.abs(ve)/4),b>0&&(W=-W)}l.queryCoord2D(O,q);const ie=new M;f.queryTransform(q,ie);const se=e.getClosestCoordinate(ie,!1);if(e.queryCoord2D(se,ie),O!==1&&(M.distance(z,ie)<=2*i||M.distance(ie,h)<=2*i))continue;z.setCoordsPoint2D(ie);const Z=ne(M,4);Z[0].assign(U),Z[3].assign(q),Z[1].rightPerpendicularOther(U),Z[1].scaleAddThis(W,U),Z[2].leftPerpendicularOther(q),Z[2].scaleAddThis(W,q),f.transformPoints2D(Z,3,Z),Z[3].assign(ie),H===0&&Z[0].setCoordsPoint2D(c),O===1&&Z[3].setCoordsPoint2D(h),r&&gR(Z);let te=!0;for(let ve=1;ve<4;ve++)if(!Z[ve].isEqualPoint2D(Z[0])){te=!1;break}te||(o&&o.push(se),n&&(H===0&&t&&n.push(Z[0].clone()),n.push(Z[1].clone()),n.push(Z[2].clone()),n.push(Z[3].clone())),B++),H=O,U.setCoordsPoint2D(q)}return B}function mre(t,e,s,i,r,n,o,a){e.clone().dropAllAttributes();const l=new X;e.queryLooseEnvelope(l);const u=.05*l.calculateToleranceFromEnvelope(),c=Math.max(s,u);o&&t&&o.push(0);let h=0;const m=ne(M,3);e.queryControlPoints(m);const f=[0,0,0];e.queryWeights(f);const g=[],v=Me(9,Number.NaN);let b=0;r?(b=e.getMonotonicPartParams(v.length,v),v.length=b,b=gE(e,i,v)):(v.length=2,b=2,v[0]=0,v[1]=1);let w=0,S=t;for(let T=1;T<b;T++){const P=v[T];for(g.length=0,g.push(P),g.push(w);g.length>1;){const I=g.at(-1);g.pop();const A=g.at(-1),D=ne(M,3),k=[0,0,0];ug(m,f,I,A,D,k);const R=ne(M,4),O=xet(D,k,R),z=16,q=g.length>z;c>=O||q?(o.push(A),n&&(S&&(n.push(R[0]),S=!1),n.push(R[1]),n.push(R[2]),n.push(R[3])),h++):(g.push(.5*(I+A)),g.push(I))}w=P}return h}function Ott(){return{e2:0,completeE:0}}let Ltt=class{constructor(e,s){this.m_arc=e,this.m_sqrChordLength=s}getMaxDerivative(){return 1}getValue(e,s){return e===0?M.sqrDistance(this.m_arc.getCoord2D(s),this.m_arc.getCoord2D(1-s))-this.m_sqrChordLength:0}getError(e){return 0}};function Vtt(t,e,s){if(vs(t))e1e(new pt({start:t.getStartXY(),end:t.getEndXY()}),e,s);else if(e.value()===0)s.set(t.getStartXY());else if(e.value()===1)s.set(t.getEndXY());else{const i=new le;B1e(t,e,i);const r=new le,n=new le;le.st_cosAndSin(i,r,n);const o=je.constructCoordsE(new le(t.m_semiMajorAxis).mulThisE(r),new le(t.m_semiMajorAxis).mulThis(t.m_minorMajorRatio).mulThisE(n)),a=new le(t.m_rotation);le.st_cosAndSin(a,r,n),o.rotateDirect(r,n),o.addThisE(je.constructPoint2D(t.m_center)),s.setE(o)}}function mL(t,e){return t.convertToCanonic(e)}function qtt(t,e){const s=new de(t.getStartAngle(),t.getEndAngle());s.normalize();const i=Gn(),r=og(e,i);if(r<s.vmin){let n=r+i;for(;n<s.vmin;)n+=i;return s.containsCoordinate(n)?n:s.vmin-r<n-s.vmax?r:n}if(r>s.vmax){let n=r-i;for(;n>s.vmax;)n-=i;return s.containsCoordinate(n)||s.vmin-n<r-s.vmax?n:r}return r}function U9(t,e,s,i){let r=t.m_startAngle,n=t.m_sweepAngle;const o=1e-12;for(;r>Lt();)r-=2*Lt();for(;r<=-Lt();)r+=2*Lt();if(!Number.isNaN(e)){for(;e>Lt();)e-=2*Lt();for(;e<=-Lt();)e+=2*Lt();!s&&e>r&&(e-=2*Lt()),s&&e<r&&(e+=2*Lt()),n=e-r,Math.abs(n)<o&&!i&&(n=s?2*Lt():-2*Lt()),Math.abs(n)>2*Lt()-o&&i&&(n=0)}Math.abs(n)>2*Lt()-o&&(n=n>=0?2*Lt():-2*Lt(),t.setEndXY(t.getStartXY())),Math.abs(n)<o&&(n=0,t.setEndXY(t.getStartXY())),i=Math.abs(n)<=Lt(),n&&(s=n>0),t.m_startAngle=M_(r),t.m_sweepAngle=n,Bb(t,!i),yR(t,s)}function M_(t){let e=t,s=!1;return e<=-Lt()?(e+=Gn(),s=!0):e>Lt()&&(e-=Gn(),s=!0),e<=-Lt()?(e=og(e,Gn()),e<=-Lt()&&(e+=Gn()),s=!0):e>Lt()&&(e=og(e,Gn()),e>Lt()&&(e-=Gn()),s=!0),s&&(e>Lt()||e<=-Lt())&&(e=Lt()),e}function dre(t,e,s){const i=s,r=i.getSemiAxes();let n=new M(r.x*Math.cos(t[0]),r.y*Math.sin(t[0]));return n=i.convertFromCanonic(n),M.sqrDistance(n,i.getStartXY())}function pre(t,e,s){const i=s,r=i.getSemiAxes(),n=t[0]+i.getStartAngle();let o=new M(r.x*Math.cos(n),r.y*Math.sin(n));return o=i.convertFromCanonic(o),M.sqrDistance(o,i.getEndXY())}function SG(t){if(t.m_center.isNAN())return t.m_startAngle=0,void(t.m_sweepAngle=0);const e=t.getStartXY(),s=t.getEndXY(),i=e.equals(s),r=H9(t),n=Ub(t),o=t.projectionBehavior();if(i){const a=t.convertToCanonic(e),l=new M(t.m_semiMajorAxis,t.m_semiMajorAxis*t.m_minorMajorRatio);a.x/=l.x,a.y/=l.y,t.m_startAngle=M_(Math.atan2(a.y,a.x)),t.m_sweepAngle=r?n?Gn():-Gn():0}else{const a=t.convertToCanonic(e),l=new M(t.m_semiMajorAxis,t.m_semiMajorAxis*t.m_minorMajorRatio);a.x/=l.x,a.y/=l.y;const u=t.convertToCanonic(s);u.x/=l.x,u.y/=l.y,t.m_startAngle=Math.atan2(a.y,a.x),t.m_sweepAngle=M.calculateAngle(a,u),n?t.m_sweepAngle<0&&(t.m_sweepAngle+=Gn()):t.m_sweepAngle>0&&(t.m_sweepAngle-=Gn()),t.m_startAngle=M_(t.m_startAngle);let c=dre([t.m_startAngle],1,t);if(c=Math.sqrt(c),c>.25*Bh(t)){const m=t.m_startAngle-1e-4,f=t.m_startAngle+1e-4,g=[0];Die(dre,t,1,[t.m_startAngle],[m],[f],1e-14,g),t.m_startAngle=M_(g[0])}if(c=pre([t.m_sweepAngle],1,t),c=Math.sqrt(c),c>.25*Bh(t)){const m=t.m_sweepAngle-1e-4,f=t.m_sweepAngle+1e-4,g=[0];Die(pre,t,1,[t.m_sweepAngle],[m],[f],1e-14,g),t.m_sweepAngle=g[0]}const h=Math.abs(t.m_sweepAngle)>Lt();if(Bb(t,h),r!==h&&!r&&Math.abs(t.m_sweepAngle)>1.5*Lt()||t.m_sweepAngle===0||n!==t.m_sweepAngle>0)return void Gl(t,e,s,o)}}function vi(t,e){return(qtt(t,e)-t.getStartAngle())/t.getSweepAngle()}function Iu(t,e){return t.m_startAngle+e*t.m_sweepAngle}function B1e(t,e,s){s.assign(new le(t.m_startAngle).addE(e.mulE(new le(t.m_sweepAngle))))}function Gtt(t,e){const s=new le(t.m_cosr).sqrThis(),i=new le(t.m_sinr).sqrThis(),r=new le(t.m_minorMajorRatio),n=new le(1/t.m_minorMajorRatio),o=r.mulE(s).addThisE(n.mulE(i)),a=r.subE(n).mulThis(2*t.m_cosr*t.m_sinr),l=r.mulE(i).addThisE(n.mulE(s));e[0]=o,e[1]=a,e[2]=l,e[3]=new le(-t.m_semiMajorAxis).mulThis(t.m_semiMajorAxis).mulThis(t.m_minorMajorRatio)}function ztt(t,e){const s=new H8;s.a11.setE(t[0]),s.a12=le.st_mulByPower2(t[1],.5),s.a21.setE(s.a12),s.a22.setE(t[2]);const i=[M.getNAN(),M.getNAN()],r=[new le,new le];s.eigenSymmetric(r,i);const n=t[3].clone();return n.negateThis(),n.invThis(),r[0].mulThisE(n),r[1].mulThisE(n),r[0].sqrtThis().invThis(),r[1].sqrtThis().invThis(),e.x=r[0].toDouble(),e.y=r[1].toDouble(),Math.atan2(i[0].y,i[0].x)}function Utt(t,e,s){if(vs(t))return(s-e)*M.distance(t.getStartXY(),t.getEndXY());if(t.m_minorMajorRatio===1)return Math.abs(t.getSweepAngle()*(e-s))*t.m_semiMajorAxis;const i=EG(t,e);return EG(t,s)-i}function dL(t){return t.m_cachedValues}function B9(t){if(t.m_cachedValues)return t.m_cachedValues;const e=Ott();return e.e2=jtt(t),e.completeE=b9(e.e2),t.m_cachedValues=e,e}function fre(t,e,s,i){if(!e.isEqual(t.m_XStart,t.m_YStart)||!s.isEqual(t.m_XEnd,t.m_YEnd)){if(vs(t))return t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=s.x,t.m_YEnd=s.y,Vv(t),void t.afterCompletedModification();if(i&&Math.abs(t.getSweepAngle())<=1.01*jn()){const r=ne(M,3),n=X9(t,r);if(pR(r)){if(r[0].assign(e),r[2].assign(s),s0(r),t.projectionBehavior()===0){let o=0,a=2;M.sqrDistance(r[1],r[0])<M.sqrDistance(r[1],r[2])&&(a=be(o,o=a));const l=r[a].sub(r[o]),u=l.length();l.divThis(u);const c=r[1].sub(r[o]),h=c.length(),m=c.dotProduct(l)/h,f=c.crossProduct(l)/h,g=new M;wi(r[o],r[a],.5,g);const v=.5*u/f*ys(1-m,0,1),b=r[1].side(r[o],r[a]),w=l.clone();b?w.leftPerpendicularThis():w.rightPerpendicularThis();const S=g.sub(w.mul(v));t.constructCircularArcThreePoint(r[0],r[2],S)}else bC(r,n*n,null,!1,t);return}}t.projectionBehavior()===0?est(t,e,s):W1e(t,e,s)}}function Btt(t,e,s){const i=t.projectionBehavior()===0;if(s<=2)return void Gl(t,e[0],e[s-1],i?0:1);if(i){t.constructCircularArcThreePoint(e[0],e[s-1],e[Math.trunc(s/2)]);const g=new M;return t.queryCoord2D(.5,g),void t.m_interior.setCoordsPoint2D(g)}const r=t.getSemiMajorAxis(),n=t.getMinorMajorRatio(),o=t.getAxisXRotation(),a=t.getCenter(),l=new Array(4);l[0]=t.isMajor(),l[1]=!l[0],l[2]=l[0],l[3]=!l[0];const u=new Array(4);u[0]=t.isClockwise(),u[1]=u[0],u[2]=!u[0],u[3]=!u[0];const c=Math.trunc(s<5?1:(s+4)/5),h=ne(Kc,4),m=Me(4,Number.NaN);let f=0;for(let g=0;g<4;g++){h[g].constructEllipticArcEndPointsCenter(e[0],e[s-1],r,n,o,l[g],u[g],a),m[g]=0;let v=0;for(let b=c;b<s-1;b+=c){const w=h[g].getClosestCoordinate(e[b],!1);m[g]+=M.sqrDistance(h[g].getCoord2D(w),e[b]),v++}m[g]/=v,m[g]<m[f]&&(f=g)}t.assignCopy(h[f])}function jtt(t){return 1-Pt(t.m_minorMajorRatio)}function gre(t,e,s,i,r,n,o,a,l){return t.m_bits=0,t.m_rotation=n,M9(t,e),A9(t,s),t.m_cosr=Math.cos(n),t.m_sinr=Math.sin(n),Bb(t,o),yR(t,a),l!==void 0?t.m_center.assign(l):t.m_center.setNAN(),t.setProjectionBehavior(1),t.m_semiMajorAxis=i,t.m_minorMajorRatio=r,Y1e(t,l===void 0)}function Gl(t,e,s,i){t.m_bits=0,t.m_rotation=0,M9(t,e),A9(t,s),t.m_interior.assign(e.add(s).mul(.5)),t.m_startAngle=0,t.m_sweepAngle=0,t.m_cosr=1,t.m_sinr=0,Bb(t,!1),yR(t,!1),t.m_center.setNAN(),t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.setProjectionBehavior(i),t.afterCompletedModification()}function vs(t){return t.m_center.isNAN()}function EG(t,e){if(e===0)return 0;const s=B9(t),i=Iu(t,e),r=jn(),n=j1e(t),o=x9(i+r,s.e2,s.completeE),a=t.m_semiMajorAxis*(o-n);return Math.abs(a)}function Htt(t,e){if(vs(t)){const l=M.distance(t.getStartXY(),t.getEndXY());return l===0?0:e/l}if(t.m_minorMajorRatio===1){const l=Math.abs(t.getSweepAngle()*t.m_semiMajorAxis);return l===0?0:e/l}if(e===0)return 0;const s=t.getSweepAngle();if(s===0)return .5;const i=B9(t),r=jn(),n=j1e(t);s<0&&(e=-e);const o=e/t.m_semiMajorAxis+n;let a=fJe(o,i.e2,i.completeE);return a-=r,a-=t.getStartAngle(),a/s}function j1e(t){const e=B9(t);return x9(t.getStartAngle()+jn(),e.e2,e.completeE)}function j9(t,e,s){if(e.m_TransformationType===2)return void F(0);if(F(!Y9(t)),e.isIdentity())return;aN(t);const i=M.getNAN();i.x=t.m_XStart,i.y=t.m_YStart,e.transformInPlace(i);const r=M.getNAN();if(r.x=t.m_XEnd,r.y=t.m_YEnd,e.transformInPlace(r),vs(t))return t.m_XStart=i.x,t.m_YStart=i.y,t.m_XEnd=r.x,void(t.m_YEnd=r.y);const n=t.m_center.clone();if(e.transformInPlace(n),s||e.isUniformNoRotation()){let o=Ub(t);if(e.isReflective()&&(o=!o),t.projectionBehavior()===0){if(!i.equals(r)){const h=t.m_interior.clone();return e.transformInPlace(h),void t.constructCircularArcThreePoint(i,r,h)}return void H1e(t,i,r,n,o,!1)}const a=new M(t.m_cosr,t.m_sinr);e.transformWithoutTranslateInPlace(a);const l=Math.atan2(a.y,a.x),u=t.getSemiAxes();e.transformWithoutTranslateInPlace(u);const c=t.m_center.clone();return e.transformInPlace(c),void t.constructEllipticArcEndPointsCenter(i,r,u.x,u.y/u.x,l,t.isMajor(),o,c)}{{const h=new Array(4);Gtt(t,h);const m=new H8;if(m.a11.setE(h[0]),m.a12.setE(h[1]),m.a12.mulThisByPower2(.5),m.a21.setE(m.a12),m.a22.setE(h[2]),!m.det().isZero()){const f=new H8;if(f.a11.set(e.xx),f.a12.set(e.xy),f.a21.set(e.yx),f.a22.set(e.yy),f.invertThis()){const g=f.clone();g.transposeThis();const v=m.clone();if(v.mulThis(f),v.mulLeftThis(g),!v.det().isZero()){const b=ne(le,4);b[0].setE(v.a11),b[1].setE(v.a12),b[1].mulThisByPower2(2),b[2].setE(v.a22),b[3].setE(h[3]);const w=M.getNAN(),S=ztt(b,w);let T=Ub(t);return e.isReflective()&&(T=!T),void t.constructEllipticArcEndPointsCenter(i,r,w.x,w.y/w.x,S,t.isMajor(),T,n)}}}}const o=[M.getNAN(),M.getNAN(),M.getNAN()];o[0].setCoords(t.getSemiMajorAxis(),0),o[0].rotateDirect(t.m_cosr,t.m_sinr),o[1].setCoords(t.getSemiMajorAxis(),t.getSemiMinorAxis()),o[1].rotateDirect(t.m_cosr,t.m_sinr),o[2].setCoords(0,t.getSemiMinorAxis()),o[2].rotateDirect(t.m_cosr,t.m_sinr);let a=t.isClockwise();a&&(o[2]=be(o[0],o[0]=o[2]));const l=.5;e.transformWithoutTranslateArray(o,3,o),e.isReflective()&&(a=!a);const u=new M(0,0),c=t.createInstance();bC(o,l,u,!1,c),t.constructEllipticArcEndPointsCenter(i,r,c.getSemiMajorAxis(),c.getMinorMajorRatio(),c.getAxisXRotation(),t.isMajor(),!a,n)}}function H1e(t,e,s,i,r,n){const o=.5*(i.sub(e).length()+i.sub(s).length());t.m_center.assign(i),t.m_startAngle=Math.atan2(e.y-t.m_center.y,e.x-t.m_center.x),U9(t,Math.atan2(s.y-t.m_center.y,s.x-t.m_center.x),r,n);const a=t.constructEllipticArcEndPointsCenter(e,s,o,1,0,Math.abs(t.m_sweepAngle)>Math.PI,t.m_sweepAngle>0,i);return t.setProjectionBehavior(0),a}function pL(t,e){t.m_cachedValues=e}function aN(t){t.m_cachedValues=null}function Ytt(t,e){e.m_cachedValues=be(t.m_cachedValues,t.m_cachedValues=e.m_cachedValues)}function yR(t,e){const s=e?1:0;t.m_bits=-2&t.m_bits|s}function Ub(t){return!!(1&t.m_bits)}function Bb(t,e){const s=e?1:0;t.m_bits=-3&t.m_bits|s<<1}function H9(t){return!!(2&t.m_bits)}function Xtt(t){if(t.m_center.isNAN())return!1;const e=8,s=new je;s.setWithEps(t.getStartXY(),e),s.subThisE(new je().setWithEps(t.m_center,e));const i=new le;i.setWithEps(t.m_rotation,e);const r=new le,n=new le;le.st_cosAndSin(i,r,n),s.rotateReverse(r,n);const o=new je;o.setWithEps(t.getEndXY()),o.subThisE(je.constructPoint2D(t.m_center)),o.rotateReverse(r,n);const a=new le;a.setWithEps(t.m_semiMajorAxis,e);const l=a.clone(),u=new le;u.setWithEps(t.m_minorMajorRatio),l.mulThisE(u),s.x.divThisE(a),s.y.divThisE(l),o.x.divThisE(a),o.y.divThisE(l);const c=s.x.sqr().addThisE(s.y.sqr()).subThisE(Dd),h=o.x.sqr().addThisE(o.y.sqr()).subThisE(Dd);return!c.isZero()||!h.isZero()}function Y9(t){return!!(8&t.m_bits)}function Ed(t){t.m_bits&=-9}function Y1e(t,e){Ed(t);const s=t.getStartXY(),i=t.getEndXY();let r=!1;const n=H9(t),o=Ub(t),a=t.projectionBehavior(),l=s.equals(i);let u=t.m_minorMajorRatio===0||t.m_semiMajorAxis===0;if(Number.isNaN(t.m_minorMajorRatio)&&(t.m_semiMajorAxis===0?t.m_minorMajorRatio=1:I0e("NAN minor major ratio and non-zero major axis")),u||(u=e?l:t.m_center.isNAN()),u)return Gl(t,s,i,a),!0;t.m_semiMajorAxis=Math.abs(t.m_semiMajorAxis),t.m_minorMajorRatio=Math.abs(t.m_minorMajorRatio),t.m_minorMajorRatio>1&&(t.m_semiMajorAxis*=t.m_minorMajorRatio,t.m_minorMajorRatio=1/t.m_minorMajorRatio);const c=new M(t.m_semiMajorAxis,t.m_semiMajorAxis*t.m_minorMajorRatio);if(l){const h=t.convertToCanonic(s);h.x/=c.x,h.y/=c.y;const m=Math.sqrt(Pt(h.x)+Pt(h.y));if(r=m!==1,t.m_semiMajorAxis*=m,c.mulThis(m),t.m_startAngle=M_(Math.atan2(h.y,h.x)),!n)return t.m_interior.assign(s),t.m_sweepAngle=0,t.afterCompletedModification(),r;t.m_sweepAngle=o?Gn():-Gn()}else{let h=t.m_center.isNAN()||Xtt(t);if(!h){const m=t.convertToCanonic(s);m.x/=c.x,m.y/=c.y;const f=new M(1,0);t.m_startAngle=M.calculateAngle(f,m);const g=t.convertToCanonic(i);g.x/=c.x,g.y/=c.y,t.m_sweepAngle=M.calculateAngle(m,g),h=!yre(t)}if(h){r=!0;const m=s.sub(i).mulThis(.5);m.rotateReverse(t.m_cosr,t.m_sinr);let f=Pt(m.x/c.x)+Pt(m.y/c.y);f>1&&(f=Math.sqrt(f),t.m_semiMajorAxis*=f,c.mulThis(f));const g=new M(0,0);{const v=c.x*c.x,b=c.y*c.y,w=v*m.y*m.y+b*m.x*m.x,S=v*b-w;if(S>0){const T=Math.sqrt(S/w);g.setCoords(c.x*m.y/c.y,-c.y*m.x/c.x),g.mulThis(T),n===o&&g.negateThis()}}{const v=new M(g.x,g.y);v.rotateDirect(t.m_cosr,t.m_sinr),v.addThis(s.add(i).mulThis(.5)),t.m_center.assign(v)}}if(SG(t),!yre(t))return Gl(t,s,i,a),!0}return Vv(t),t.afterCompletedModification(),r}function X9(t,e){F(Math.abs(t.getSweepAngle())<15*Math.PI/16);const s=t.getSemiMajorAxis(),i=t.getSemiMinorAxis();let r;if(s===0)return e[0].setCoordsPoint2D(t.getStartXY()),e[1].setCoordsPoint2D(t.getStartXY()),e[2].setCoordsPoint2D(t.getStartXY()),r=1,r;if(i===0)return e[0].setCoordsPoint2D(t.getStartXY()),e[2].setCoordsPoint2D(t.getEndXY()),e[1]=M.lerp(e[0],e[2],.5),r=1,r;const n=t.getSweepAngle(),o=t.getStartAngle(),a=o+n,l=new M(-s*Math.sin(o),i*Math.cos(o)),u=new M(-s*Math.sin(a),i*Math.cos(a));l.normalize(),u.normalize(),l.rotateDirect(t.m_cosr,t.m_sinr),u.rotateDirect(t.m_cosr,t.m_sinr),e[0].setCoordsPoint2D(t.getStartXY()),e[2].setCoordsPoint2D(t.getEndXY()),e[1].setSub(e[2],e[0]);const c=l.crossProduct(u);return e[1].assign(l.mul(e[1].crossProduct(u)/c)),e[1].addThis(e[0]),r=Math.cos(.5*n),r}function bC(t,e,s,i,r){if(i){const W=Math.sqrt(e),ie=Pt(1-.5)+2*W*.5*(1-.5)+Pt(.5),se=t[0].mul(Pt(1-.5)).add(t[1].mul(2*W*.5*(1-.5))).add(t[2].mul(Pt(.5))).divThis(ie);return r.constructCircularArcThreePoint(t[0],t[2],se),!0}const n=t[0].sub(t[1]),o=t[2].sub(t[1]),a=n.crossProduct(o),l=n.dotProduct(o),u=e;F(u<=1),F(u>0);const c=.5/(1-u),h=n.sqrLength(),m=l,f=o.sqrLength(),g=Pt(a),v=n.sub(o).sqrLength();if(g===0||l<=-Math.sqrt(h)*Math.sqrt(f))return Gl(r,t[0],t[2],1),!1;const b=[0,0],w=new de;w.setInfinite();const S=e0(2*g,-(v/u+4*m),2*(1-u)/u,w,!1,b);if(S===0)return Gl(r,t[0],t[2],1),!1;S===1&&(b[1]=b[0]);const T=Math.sqrt(c/b[0]),P=Math.sqrt(c/b[1]),I=.5/u;let A=I-f*b[0],D=I-h*b[0];Math.abs(A)>Math.abs(D)?D=m*b[0]-I+1:A=m*b[0]-I+1;const k=n.mul(A).add(o.mul(D)),R=k.norm(1)<1e-15*T?0:Math.atan2(k.y,k.x)+Math.PI,O=n.add(o),z=s?s.clone():t[1].add(O.mul(c)),q=t[0].sub(z),U=t[2].sub(z),V=q.crossProduct(U)<0,B=!1;return new Kc,r.constructEllipticArcEndPointsCenter(t[0],t[2],T,P/T,R,B,!V,z)}function Wtt(t,e,s,i,r){return bC(t,e,s,i,r)}function yre(t){let e=!1;{const i=new M(t.m_semiMajorAxis*Math.cos(t.m_startAngle),t.getSemiMinorAxis()*Math.sin(t.m_startAngle));i.rotateDirect(t.m_cosr,t.m_sinr),i.addThis(t.m_center),e=M.distance(t.getStartXY(),i)>Bh(t)}let s=!1;if(!e){const i=new M(t.m_semiMajorAxis*Math.cos(t.m_startAngle+t.m_sweepAngle),t.getSemiMinorAxis()*Math.sin(t.m_startAngle+t.m_sweepAngle));i.rotateDirect(t.m_cosr,t.m_sinr),i.addThis(t.m_center),s=M.distance(t.getEndXY(),i)>Bh(t)}return!e&&!s}function Ztt(t,e,s,i){s===0&&ee("construct_enclosing_circle");const r=[0,0,0],n=$tt(e,s,r);if(n===1)t.constructCircleRadius(0,e[r[0]],i);else if(n===2){const o=M.lerp(e[r[0]],e[r[1]],.5),a=M.distance(e[r[0]],o),l=M.distance(e[r[1]],o);t.constructCircleRadius(Math.max(a,l),o,i)}else if(n===3){const o=M.calculateCircleCenterFromThreePoints(e[r[0]],e[r[1]],e[r[2]]),a=M.distance(e[r[0]],o),l=M.distance(e[r[1]],o),u=M.distance(e[r[2]],o);t.constructCircleRadius(Math.max(a,l,u),o,i)}else Ce("unexpected")}function _re(t){if(vs(t)||t.isDegenerate(0))return 0;const e=t.m_semiMajorAxis,s=t.getSemiMinorAxis(),i=e*e+s*s,r=t.getStartAngle(),n=t.getEndAngle(),o=t.m_center.y-t.m_YStart,a=t.m_cosr,l=t.m_sinr;let u=1,c=0;t.m_rotation&&(u=(a-l)*(a+l),c=2*a*l);const h=((-.5*(n-r)+.25*u*(2*Math.cos(n+r)*Math.sin(n-r)))*s+-2*Math.sin(.5*(n+r))*Math.sin(.5*(n-r))*a*o)*e/i;let m=0;return t.m_rotation&&(m=.125*(-2*Math.sin(n+r)*Math.sin(n-r))*c-s*o/i*(2*Math.cos(.5*(n+r))*Math.sin(.5*(n-r)))*l),i*(h+m)+-.5*(t.m_XEnd-t.m_XStart)*(t.m_YEnd-t.m_YStart)}function Vv(t){t.queryCoord2D(.5,t.m_interior)}function vre(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return 2}else if(rl(e,s))return 1;return xC(t,e,s,null,null,null,i,r!==void 0&&r,!0,!1)!==0?4:0}function Qtt(t,e,s,i,r){if(r){if(Ea(e,s)!==0)return 2}else if(rl(e,s))return 1;return X1e(t,e,s,null,null,null,i,r!==void 0&&r,!0,!1)!==0?4:0}function xC(t,e,s,i,r,n,o,a,l,u){if(vs(e))return dR(new pt({start:e.getStartXY(),end:e.getEndXY()}),s,i,r,n,o,a,u);r!==null&&(r.length=0),n!==null&&(n.length=0),i!==null&&(i.length=0);const c=jo(e,s);if(nl(e,s,o=Math.max(c,o)))return 0;const h=s.getStartXY();h.subThis(e.m_center);const m=s.getEndXY();m.subThis(e.m_center),h.rotateReverse(e.m_cosr,e.m_sinr),m.rotateReverse(e.m_cosr,e.m_sinr);const f=m.clone();f.subThis(h);const g=e.m_semiMajorAxis,v=1/g,b=e.getSemiMinorAxis(),w=1/b,S=f.clone();S.leftPerpendicularThis();const T=Math.atan2(b*S.y,g*S.x),P=Me(16,Number.NaN),I=Me(16,Number.NaN);let A=0;const D=[T,T+Math.PI];for(let V=0;V<2;++V){const B=vi(e,D[V]);if(B>=0&&B<=1){P[A]=B;const H=e.getCoord2D(P[A]);I[A]=s.getClosestCoordinate(H,!1),M.distance(H,s.getCoord2D(I[A]))<=o&&A++}}const k=h.x*v,R=h.y*w,O=f.x*v,z=f.y*w;let q=e0(O*O+z*z,2*(k*O+R*z),k*k+R*R-1,de.unit(),!1,I);F(q>=0);for(let V=0;V<q;V++){const B=f.mul(I[V]).add(h);B.x*=v,B.y*=w;const H=vi(e,Math.atan2(B.y,B.x));if(H>=0&&H<=1){P[A]=H;const W=e.getCoord2D(H);I[A]=s.getClosestCoordinate(W,!1),M.distance(W,s.getCoord2D(I[A]))<=o&&A++}}F(A<P.length+4);const U=Me(16,Number.NaN);q=e.intersectPoint(s.getStartXY(),U,o);for(let V=0;V<q;V++,A++)P[A]=U[V],I[A]=0;q=e.intersectPoint(s.getEndXY(),U,o);for(let V=0;V<q;V++,A++)P[A]=U[V],I[A]=1;q=s.intersectPoint(e.getStartXY(),U,o);for(let V=0;V<q;V++,A++)P[A]=0,I[A]=U[V];q=s.intersectPoint(e.getEndXY(),U,o);for(let V=0;V<q;V++,A++)P[A]=1,I[A]=U[V];return A===0?0:ol(t,e,s,P,I,A,i,r,n,o,a,l,u)}function X1e(t,e,s,i,r,n,o,a,l,u){if(vs(e)){const O=new pt({start:e.getStartXY(),end:e.getEndXY()});return xC(t,s,O,i,n,r,o,a,l,!0)}if(vs(s)){const O=new pt({start:s.getStartXY(),end:s.getEndXY()});return xC(t,e,O,i,r,n,o,a,l,u)}const c=jo(e,s);o=Math.max(o,c);let h=!1;{const O=e.getSemiAxes(),z=e.getCenter(),q=s.getSemiAxes(),U=s.getCenter(),V=M.distance(U,z),B=O.x+q.x;if(V>B+o)return 0;if(O.y>q.x){if(V+q.x+o<O.y)return 0}else if(q.y>O.x&&V+O.x+o<q.y)return 0;if(l&&!a){const H=e.m_minorMajorRatio===1&&e.isClosed()&&e.isMajor(),W=s.m_minorMajorRatio===1&&s.isClosed()&&s.isMajor();if(H&&W&&(h=!0,V<=B)&&Math.max(O.x,q.x)<=Math.min(O.x,q.x)+V)return F(!r&&!n),1}}if(!h&&nl(e,s,o))return 0;const m=[],f=[],g=!1,v=!1,b=rD(e,0,0,g,v,m,f,null),w=[],S=[],T=rD(s,0,0,g,v,w,S,null);if(b===1&&T===1){const O=new Oo({points:m,weights:f}),z=new Oo({points:w,weights:S}),q=[],U=[],V=lC(!1,O,z,i,r===null?null:q,n===null?null:U,o,a,l,u);if(V>0&&r!==null||n!==null){r&&(r.length=0),n&&(n.length=0);for(let B=0;B<V;++B){if(r)if(bs(q[B],0,1))r.push(q[B]);else{const H=O.tToLength(q[B]),W=e.lengthToT(H);r.push(W)}if(n)if(bs(U[B],0,1))n.push(U[B]);else{const H=z.tToLength(U[B]),W=s.lengthToT(H);n.push(W)}}}return V}let P=[];const I=[];let A=0;const D=l&&!a;for(let O=0;O<b;O++){const z=new Oo({points:m.slice(2*O,2*O+3),weights:f.slice(2*O,2*O+3)});let q=0;for(let U=0;U<T;U++){I.length<=U&&I.push(new Oo({points:w.slice(2*U,2*U+3),weights:S.slice(2*U,2*U+3)}));const V=[],B=[],H=D?null:V,W=D?null:B,ie=lC(!1,z,I[U],null,H,W,o,!1,D,!1);if(ie>0&&D)return 1;for(let se=0;se<ie;++se){if(V[se]===0&&O===0)V[se]=0;else if(V[se]===1&&O===b-1)V[se]=1;else{const Z=z.tToLength(V[se])+A,te=e.lengthToT(Z);V[se]=te}if(B[se]===0&&U===0)B[se]=0;else if(B[se]===1&&U===T-1)B[se]=1;else{const Z=I[U].tToLength(B[se])+q,te=s.lengthToT(Z);B[se]=te}P.push(Zi(V[se],B[se]))}q+=I[U].calculateLength2D()}A+=z.calculateLength2D()}if(P.length===0)return 0;if(a&&(P=P.filter(O=>!bs(O.first,0,1)||!bs(O.second,0,1)||!e.getCoord2D(O.first).equals(s.getCoord2D(O.second)))),l)return P.length;const k=[],R=[];for(const O of P)k.push(O.first),R.push(O.second);return ol(t,e,s,k,R,k.length,i,r,n,o,a,l,u)}function bre(t,e,s){if(s.setCoords(t.getCoord2D(e.vmin)),s.mergeNe(t.getCoord2D(e.vmax)),vs(t))return;const i=t.getSemiAxes(),r=[0,0,0,0];{const o=Math.atan2(-i.y*t.m_sinr,i.x*t.m_cosr),a=o+Math.PI,l=Math.atan2(i.y*t.m_cosr,i.x*t.m_sinr),u=l+Math.PI;r[0]=vi(t,o),r[1]=vi(t,a),r[2]=vi(t,l),r[3]=vi(t,u)}const n=new M;for(let o=0;o<4;o++){const a=r[o];e.containsExclusiveCoordinate(a)&&(t.queryCoord2D(a,n),s.mergeNe(n))}}function xre(t,e,s,i,r){if(t.m_semiMajorAxis===0)return s.vmin;let n=M.getNAN();t.queryCoord2D(s.vmin,n);let o=M.getNAN();if(t.queryCoord2D(s.vmax,o),vs(t))return new pt({start:n,end:o}).getClosestCoordinate(e,i);const a=mL(t,e);if(n=mL(t,n),o=mL(t,o),t.m_minorMajorRatio===1){if(a.isEqual(0,0))return s.vmin;const A=vi(t,Math.atan2(a.y,a.x));return i||s.containsCoordinate(A)?A:M.distance(a,n)<=M.distance(a,o)?s.vmin:s.vmax}const l=t.getSemiMajorAxis(),u=t.getSemiMinorAxis(),c=(l-u)*(l+u),h=Pt(c),m=a.x,f=a.y,g=Pt(u*f),v=u*c*f*2,b=[new le(g),new le(v),new le(h-Pt(l*m)-g),new le(-v),new le(-h)],w=ne(le,4),S=n1e(b,4,new de(-1,1),!1,w,4);let T=s.vmin,P=M.sqrDistance(a,n);{const A=M.sqrDistance(a,o);A<P&&(T=s.vmax,P=A)}F(!i);let I=Me(8,Number.NaN);for(let A=0;A<S;++A){const D=w[A].value(),k=Math.sqrt(1-D*D),R=Math.atan2(D,k),O=Math.atan2(D,-k);I[2*A]=vi(t,R),I[2*A+1]=vi(t,O)}I=I.slice(0,2*S),xx(I);for(let A=0,D=2*S;A<D;++A)if(I[A]>s.vmin&&I[A]<s.vmax){const k=M.sqrDistance(e,t.getCoord2D(I[A]));P>k&&(P=k,T=I[A])}return T}function Jtt(t,e,s){F(!vs(t));const i=new Rt;i.setRotateAngle(-t.getAxisXRotation());const r=new M;i.queryTransform(e,r);const n=Math.atan2(-r.x*t.getMinorMajorRatio(),r.y),o=n+Lt();let a=vi(t,n),l=vi(t,o);l<a&&(l=be(a,a=l));let u=0;return a>=0&&a<=1&&(s[u++]=a),l>=0&&l<=1&&(s[u++]=l),u}function wre(t,e,s){return t.m_semiMajorAxis===e.m_semiMajorAxis&&t.isMajor()!==e.isMajor()&&!!t.m_center.equals(e.m_center)&&t.m_sinr===e.m_sinr&&t.m_cosr===e.m_cosr&&t.m_minorMajorRatio===e.m_minorMajorRatio&&(s?t.isClockwise()!==e.isClockwise():t.isClockwise()===e.isClockwise())}function Ktt(t,e,s){if(vs(t))s.setE(je.constructPoint2D(t.getEndXY()).subE(je.constructPoint2D(t.getStartXY())));else{const i=new le;B1e(t,e,i);const r=new je;if(r.setCoordsE(new le(t.m_semiMajorAxis).negate().mulE(new le().setSin(i)),new le(t.getSemiMinorAxis()).mulE(new le().setCos(i))),t.m_rotation){const n=new le(t.m_rotation);r.rotateDirect(new le().setCos(n),new le().setSin(n))}r.scaleThis(new le(t.getSweepAngle())),s.setE(r)}}function est(t,e,s,i){const r=t.getStartXY(),n=t.getEndXY(),o=r.equals(n),a=e.equals(s);if(!o&&!a){const v=new Rt;v.setShiftCoords(-t.m_XStart,-t.m_YStart);const b=M.distance(e,s),w=M.distance(r,n),S=b/w;v.scale(S,S);const T=n.sub(r);T.divThis(w);const P=s.sub(e);P.divThis(b);const I=T.crossProduct(P),A=P.dotProduct(T);return v.rotate(A,I),v.shiftCoords(e.x,e.y),j9(t,v,!0),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=s.x,void(t.m_YEnd=s.y)}const l=new M;if(t.queryCoord2D(.5,l),a){if(o){const v=t.m_center.add(e.sub(r));t.constructEllipticArcEndPointsCenter(e,s,t.getSemiMajorAxis(),1,0,!0,!t.isClockwise(),v),t.setProjectionBehavior(0)}else if(t.isMajor()){const v=l.sub(e).getUnitVector().mul(2*t.getSemiMajorAxis()).add(e);t.constructCircularArcThreePoint(e,s,v)}else t.constructCircularArcThreePoint(e,s,e);return}const u=e.add(s).mul(.5),c=s.sub(e);c.rightPerpendicularThis();const h=u.add(c),m=M.getClosestCoordinate(u,h,t.getCenter(),!0),f=new M;wi(u,h,m,f);const g=M.distance(e,f);t.constructEllipticArcEndPointsCenter(e,s,g,1,0,!0,!t.isClockwise(),f),t.setProjectionBehavior(0)}function W1e(t,e,s,i){const r=t.getStartXY(),n=t.getEndXY(),o=r.equals(n),a=e.equals(s);if(!o&&!a){const f=new Rt;return f.initializeFromTwoPoints(r,n,e,s),j9(t,f,!0),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=s.x,t.m_YEnd=s.y,t.endPointModified(),void t.normalizeAfterEndpointChange()}if(!t.isMajor())return void Gl(t,e,s,1);if(o&&a){const f=t.m_center.add(e.sub(r));return void t.constructEllipticArcEndPointsCenter(e,s,t.getSemiMajorAxis(),t.getMinorMajorRatio(),t.getAxisXRotation(),!0,!t.isClockwise(),f)}if(!o){const f=.5*(Gn()-Math.abs(t.getSweepAngle())),g=(t.getSweepAngle()+f*di(t.getSweepAngle()))/t.getSweepAngle(),v=new M;t.queryCoord2D(g,v),t.constructEllipticArcEndPointsCenter(v,v,t.getSemiMajorAxis(),t.getMinorMajorRatio(),t.getAxisXRotation(),!0,!t.isClockwise(),t.getCenter());const b=t.getCenter().add(e.sub(v));return void t.constructEllipticArcEndPointsCenter(e,s,t.getSemiMajorAxis(),t.getMinorMajorRatio(),t.getAxisXRotation(),!0,!t.isClockwise(),b)}const l=M.sqrDistance(e,s);let u=.25,c=.75;if(l<M.sqrDistance(t.getCoord2D(.25),t.getCoord2D(.75))){const f=[0],g=Cg(new Ltt(t,l),de.construct(0,.25),1,f);g>0&&(F(g===1),u=f[0],c=1-f[0])}const h=t.getCoord2D(u),m=t.getCoord2D(c);F(!h.equals(m)),t.constructEllipticArcEndPointsCenter(h,m,t.getSemiMajorAxis(),t.getMinorMajorRatio(),t.getAxisXRotation(),!0,!t.isClockwise(),t.m_center),W1e(t,e,s)}function tst(t,e){let s,i=e,r=null;switch(i||(r=_9(t)?tC():Jr(),i=r),t){case G.enumPoint:s=new nt({vd:i});break;case G.enumLine:s=new pt({vd:i});break;case G.enumBezier:s=new Hl({vd:i});break;case G.enumEllipticArc:s=new Kc({vd:i});break;case G.enumRationalBezier2:s=new Oo({vd:i});break;case G.enumBezier2:s=new t0({vd:i});break;case G.enumEnvelope:s=new Sn({vd:i});break;case G.enumMultiPoint:s=new pi({vd:i});break;case G.enumPolyline:s=new qt({vd:i});break;case G.enumPolygon:s=new wt({vd:i});break;case G.enumMultipatch:yt("multipatch not impl");break;case G.enumGeometryCollection:s=new K0e({vd:i});break;default:ee("Geometry.create")}return s}var Sre=Es;const L=-1,ci=1;let sst=class{constructor(e){this.m_shape=e}userSort(e,s,i){this.m_shape.sortVerticesSimpleByYHelper(i,e,s)}getValue(e){return this.m_shape.getY(e)}};function ist(t){return t.parent!==void 0}let CG=class Z1e{constructor(e){ist(e)?(this.m_parent=e.parent,this.m_geometry=e.geometry,this.m_path=e.path,this.m_vertex=e.vertex,this.m_firstVertex=e.firstVertex,this.m_index=e.selection?0:e.index,this.m_bSkipMultiPoints=e.bSkipMultiPoints,this.m_selection=e.selection,this.m_bOneGeom=e.bOneGeom,this.m_bFirst=!0):(this.m_parent=e.copy.m_parent,this.m_geometry=e.copy.m_geometry,this.m_path=e.copy.m_path,this.m_vertex=e.copy.m_vertex,this.m_index=e.copy.m_index,this.m_bSkipMultiPoints=e.copy.m_bSkipMultiPoints,this.m_firstVertex=e.copy.m_firstVertex,this.m_bFirst=!0,this.m_selection=e.copy.m_selection,this.m_bOneGeom=e.copy.m_bOneGeom)}moveToNextHelper(){for(this.m_path=this.m_parent.getNextPath(this.m_path),this.m_index=0;this.m_geometry!==L;){for(;this.m_path!==L;this.m_path=this.m_parent.getNextPath(this.m_path))if(this.m_vertex=this.m_parent.getFirstVertex(this.m_path),this.m_firstVertex=this.m_vertex,this.m_vertex!==L)return this.m_vertex;if(this.m_bOneGeom)return L;if(this.m_geometry=this.m_parent.getNextGeometry(this.m_geometry),this.m_geometry===L)break;this.m_bSkipMultiPoints&&!xt(this.m_parent.getGeometryType(this.m_geometry))||(this.m_path=this.m_parent.getFirstPath(this.m_geometry))}return L}nextSelection(){for(;this.m_index<this.m_parent.m_selectedVertices.length;){const e=this.m_parent.m_selectedVertices[this.m_index++];if(e!==L&&(this.m_path=this.m_parent.getPathFromVertex(e),!this.m_bOneGeom||this.m_geometry===this.m_parent.getGeometryFromPath(this.m_path)))return this.m_geometry=this.m_parent.getGeometryFromPath(this.m_path),e}return L}next(){return this.m_selection?this.nextSelection():this.m_bFirst?(this.m_bFirst=!1,this.m_vertex):this.m_vertex!==L?(this.m_vertex=this.m_parent.getNextVertex(this.m_vertex),this.m_index++,this.m_vertex!==L&&this.m_vertex!==this.m_firstVertex?this.m_vertex:this.moveToNextHelper()):L}currentGeometry(){return this.m_geometry}currentPath(){return this.m_path}static create_(e,s,i,r,n,o,a,l,u){return new Z1e({parent:e,geometry:s,path:i,vertex:r,firstVertex:n,index:o,bSkipMultiPoints:a,selection:l,bOneGeom:u})}},PG=class{constructor(e){this.parentage=e}equals(e){return this.parentage===e.parentage}},oi=class TG{setPrevPath(e,s){this.m_pathIndexList.setField(e,1,s)}setNextPath(e,s){this.m_pathIndexList.setField(e,2,s)}setPathFlags(e,s){this.m_pathIndexList.setField(e,6,s)}getPathFlags(e){return this.m_pathIndexList.getField(e,6)}setPathGeometry(e,s){this.m_pathIndexList.setField(e,7,s)}getPathIndex(e){return this.m_pathIndexList.getField(e,0)}setNextGeometry(e,s){this.m_geometryIndexList.setField(e,1,s)}setPrevGeometry(e,s){this.m_geometryIndexList.setField(e,0,s)}getGeometryIndex(e){return this.m_geometryIndexList.getField(e,7)}setFirstPath(e,s){this.m_geometryIndexList.setField(e,3,s)}setLastPath(e,s){this.m_geometryIndexList.setField(e,4,s)}newGeometry(e){const s=this.m_geometryIndexList.newElement();return this.m_geometryIndexList.setField(s,2,e),this.m_geometryIndexList.setField(s,5,0),this.m_geometryIndexList.setField(s,6,0),this.m_geometryIndexList.setField(s,7,this.m_geometryIndexList.elementToIndex(s)),s}freeGeometry(e){this.m_geometryIndexList.deleteElement(e)}newPath(e){const s=this.m_pathIndexList.newElement(),i=this.m_pathIndexList.elementToIndex(s);if(this.m_pathIndexList.setField(s,0,i),this.m_pathIndexList.setField(s,3,0),this.m_pathIndexList.setField(s,6,0),this.setPathGeometry(s,e),i>=this.m_pathAreas.length){const r=Math.trunc(i<16?16:3*i/2);this.m_pathAreas.length=r,this.m_pathLengths.length=r}return this.m_pathAreas[i]=0,this.m_pathLengths[i]=0,this.m_pathCount++,s}freePath(e){this.m_pathIndexList.deleteElement(e),this.m_pathCount--}newVertex(e){const s=this.m_vertexIndexList.newElement(),i=e>=0?e:this.m_vertexIndexList.elementToIndex(s);if(this.m_vertexIndexList.setField(s,0,i),e<0){if(i>=this.m_vertices.getPointCount()){const r=Math.trunc(i<16?16:3*i/2);this.m_vertices.reserveRounded(r),this.m_vertices.resizeNoInit(r),this.m_segments!==null&&(this.m_segments.length=r),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0)}this.m_segments&&(this.m_segments[i]=null)}return this.m_pointCount++,s}freeVertex(e){this.unselect(e);const s=this.getVertexIndex(e);this.m_vertexIndexList.deleteElement(e),this.m_pointCount--;for(let i=0,r=this.m_indices.length;i<r;i++){if(i===this.m_selectionIndex)continue;const n=this.m_indices[i];n!==null&&n.size()>s&&n.write(s,-1)}this.m_weights&&this.m_weights.size()>s&&this.m_weights.write(s,1),this.m_ranks&&this.m_ranks.size()>s&&this.m_ranks.write(s,ci),this.m_segmentWeights&&this.m_segmentWeights.size()>s&&this.m_segmentWeights.write(s,1),this.m_segmentRanks&&this.m_segmentRanks.size()>s&&this.m_segmentRanks.write(s,ci),this.m_segments&&this.setSegmentToIndex(s,null)}insertVertex_(e,s,i,r){this.m_hasForceSetEnvelope=0;const n=s!==L?this.getPrevVertex(s):this.getLastVertex(e),o=n!==L?this.getNextVertex(n):L,a=this.newVertex(i===null?this.m_pointCount:-1),l=this.getVertexIndex(a);i!==null&&this.m_vertices.setPointByVal(l,i),this.setPathToVertex(a,e),this.setNextVertex(a,o),this.setPrevVertex(a,n),o!==L&&this.setPrevVertex(o,a),n!==L&&this.setNextVertex(n,a);const u=this.isClosedPath(e),c=this.getFirstVertex(e);s===L&&this.setLastVertex(e,a),s===c&&(u&&r&&c!==L||this.setFirstVertex(e,a)),u&&o===L&&(this.setNextVertex(a,a),this.setPrevVertex(a,a)),this.setPathSize(e,this.getPathSize(e)+1);const h=this.getGeometryFromPath(e);return this.setGeometryVertexCount(h,this.getPointCount(h)+1),a}getHelperPoint(){return this.m_helperPoint||(this.m_helperPoint=new nt({vd:this.m_vertices.getDescription()}),this.m_helperPoint.setXYCoords(0,0)),this.m_helperPoint}addMultiPoint(e,s){const i=this.createGeometry(e.getGeometryType(),e.getDescription());return this.appendMultiPoint(i,e,s),i}addPoint_(e,s){const i=this.createGeometry(G.enumMultiPoint,e.getDescription());return this.appendPoint(i,e,s),i}appendMultiPath_(e,s){if(s.isEmpty())return;const i=s.getImpl();this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+i.getPointCount()),this.m_verticesMp.addPoints(s,0,i.getPointCount()),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0);const r=this.m_segments!==null||i.getSegmentFlagsStreamRef()!==null;this.m_vertexIndexList.setCapacity(this.m_vertexIndexList.size()+i.getPointCount()),this.m_pathIndexList.setCapacity(this.m_pathIndexList.size()+i.getPathCount());for(let n=0,o=i.getPathCount();n<o;n++){if(i.getPathSize(n)===0)continue;const a=this.insertPath(e,L);this.setClosedPath(a,i.isClosedPath(n));for(let l=i.getPathStart(n),u=i.getPathEnd(n);l<u;l++){const c=this.insertVertex_(a,L,null,!1);if(r){const h=this.getVertexIndex(c);if(1&i.getSegmentFlags(l))this.setSegmentToIndex(h,null);else{const m=new ut;i.querySegment(l,m,!0),this.setSegmentToIndex(h,m.releaseSegment())}}}i.isStrongPathStart(n)&&this.setStrongPathStart(a,!0),i.isStrongPathEnd(n)&&this.setStrongPathEnd(a,!0)}}addMultiPath(e,s){const i=this.createGeometry(e.getGeometryType(),e.getDescription());return e.getGeometryType()===G.enumPolygon&&this.setFillRule(i,e.getFillRule()),this.appendMultiPath(i,e,s),i}appendMultiPathPolyline(e,s,i){var a;const r=s.getImpl(),n=this.m_segments!==null||r.getSegmentFlagsStreamRef()!==null,o=new X;s.queryEnvelope(o);{const l=i.clone();let u=r.getPointCount();const c=r.getAccelerators();if(c&&c.getQuadTree()&&(u=c.getQuadTree().getIntersectionCount(l,0,r.getPointCount()+1)),u<s.getPointCount()){if(u===0)return;const h=r.queryLimitedSegmentIterator(l);let m=-1,f=-100,g=-1,v=0,b=-1,w=L,S=!1,T=h.nextSegment();if(T!==null)for(;;T=h.nextSegment()){let P=T===null;const I=T!==null?h.getPathIndex():m,A=T!==null?h.getStartPointIndex():f;if(P||(m===I&&f+1===A?v++:P=!0),P){if(b!==-1){let D=-1,k=-1;if(v===g){this.setClosedPath(w,S);const R=r.getPathEnd(m);this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+R-b),this.m_verticesMp.addPoints(s,b,R),k=r.getPathSize(m),D=R-1}else if(!S||f+1<r.getPathEnd(m))this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+f+2-b),this.m_verticesMp.addPoints(s,b,f+2),k=f-b+2,D=f;else{this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+f+2-b),(a=this.m_verticesMp)==null||a.addPoints(s,b,f+1),D=f,k=f-b+1;const R=r.getPathStart(m);this.m_verticesMp.addPoints(s,R,R+1),k+=1}this.m_xyStream=this.m_vertices.getAttributeStreamRef(0);for(let R=0,O=b;R<k;R++,O++){const z=this.insertVertex_(w,L,null,!1);if(n){const q=this.getVertexIndex(z);if(1&r.getSegmentFlags(O)||O>D)this.setSegmentToIndex(q,null);else{const U=new ut;r.getSegmentBuffer(O,U,!0),this.setSegmentToIndex(q,U.releaseSegment())}}}}if(T===null)break;v=1,b=A,m!==I?(w=this.insertPath(e,L),this.setClosedPath(w,!1),g=r.getSegmentCountPath(I),S=r.isClosedPath(I),m=I):w=this.insertPath(e,L)}f=A}return}}this.appendMultiPath_(e,s)}appendMultiPathPolygon(e,s,i){var I;const r=s.getImpl(),n=this.m_segments!==null||r.getSegmentFlagsStreamRef()!==null,o=X.constructEmpty();s.queryEnvelope(o),F(i.isIntersecting(o)&&!i.containsEnvelope(o));let a=X.construct(Number.NEGATIVE_INFINITY,i.ymin,Number.POSITIVE_INFINITY,i.ymax),l=X.construct(i.xmin,Number.NEGATIVE_INFINITY,i.xmax,Number.POSITIVE_INFINITY);const u=r.getAccelerators();if(u&&u.getQuadTree()){const A=u.getQuadTree(),D=A.getIntersectionCount(a,0,0);D>A.getIntersectionCount(l,0,D+1)&&(l=be(a,a=l))}else a.height()>l.width()&&(l=be(a,a=l));const c=[],h=r.queryLimitedSegmentIterator(a);let m=-1,f=-100,g=-1,v=0,b=-1,w=-1,S=L,T=!0,P=h.nextSegment();if(P!==null)for(;;P=h.nextSegment()){let A=P===null;const D=P!==null?h.getPathIndex():m,k=P!==null?h.getStartPointIndex():f;if(A||(D===m?f+1===k?v++:A=!0:(A=m>=0,m<0&&(m=D,g=r.getSegmentCountPath(m),b=k,S=L,v=1))),A){if(!(c.length===0&&g===v)){c.length!==0&&c[0].first===b||(this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+1),this.m_verticesMp.addPoints(s,b,b+1),w===-1&&(w=b),S===L&&(S=this.insertPath(e,L),this.setClosedPath(S,!0)),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0),this.insertVertex_(S,L,null,!1));for(const{first:R,second:O}of c){w===-1&&(w=R);let z=-1,q=-1;const U=R+O-1;if(O===g){const V=U+1;q=V-R,this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+q),this.m_verticesMp.addPoints(s,R,V),z=U,F(c.length===1)}else if(U+1<r.getPathEnd(m)){const V=U+2;q=V-R,this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+q),this.m_verticesMp.addPoints(s,R,V),z=U}else{const V=r.getPathStart(m),B=V!==w?1:0,H=U+1;q=H-R+B,this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+(H-R)+B),this.m_verticesMp.addPoints(s,R,H),z=U,B>0&&((I=this.m_verticesMp)==null||I.addPoints(s,V,V+1))}this.m_xyStream=this.m_vertices.getAttributeStreamRef(0),S===L&&(S=this.insertPath(e,L),this.setClosedPath(S,!0));for(let V=0,B=R;V<q;V++,B++){const H=this.insertVertex_(S,L,null,!1);if(n){const W=this.getVertexIndex(H);if(1&r.getSegmentFlags(B)||B>z)this.setSegmentToIndex(W,null);else{const ie=new ut;r.getSegmentBuffer(B,ie,!0),this.setSegmentToIndex(W,ie.releaseSegment())}}}}if(c.length===0||c.at(-1).first+c.at(-1).second!==b+v){let R=b+v;R===s.getPathEnd(m)&&(R=s.getPathStart(m)),w!==R&&(this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+1),this.m_verticesMp.addPoints(s,R,R+1),this.insertVertex_(S,L,null,!1))}}c.length=0,T=!0,D!==m&&(m=D,g=r.getSegmentCountPath(m),S=L,w=-1),b=k,v=1}if(!P)break;{const R=X.constructEmpty();P.queryLooseEnvelope(R),l.isIntersecting(R)?(T?c.push(Zi(k,1)):c.at(-1).second++,T=!1):T=!0}f=k}}appendMultiPath(e,s,i){if(i===void 0)return void this.appendMultiPath_(e,s);if(s.isEmpty())return;const r=s.getGeometryType()===G.enumPolygon,n=X.constructEmpty();s.queryEnvelope(n),i.isIntersecting(n)&&(!i.containsEnvelope(n)&&s.getPointCount()>10?r?this.appendMultiPathPolygon(e,s,i):this.appendMultiPathPolyline(e,s,i):this.appendMultiPath_(e,s))}appendPoint(e,s,i){if(s.isEmpty()||i!==void 0&&!i.contains(s.getXY()))return;this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+1),this.m_verticesMp.add(s),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0),this.m_vertexIndexList.setCapacity(this.m_vertexIndexList.size()+1);const r=this.insertPath(e,L);this.insertVertex_(r,L,null,!1)}appendMultiPoint_(e,s){this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+s.getPointCount()),this.m_verticesMp.addPoints(s,0,s.getPointCount()),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0),this.m_vertexIndexList.setCapacity(this.m_vertexIndexList.size()+s.getPointCount());const i=this.insertPath(e,L);for(let r=0,n=s.getPointCount();r<n;r++)this.insertVertex_(i,L,null,!1)}appendMultiPoint(e,s,i){if(i===void 0)return void this.appendMultiPoint_(e,s);const r=s.getAttributeStreamRef(0);let n=0;for(let c=0,h=s.getPointCount();c<h;c++){const m=r.readPoint2D(2*c);i.contains(m)&&n++}this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+n);let o=-1,a=-1,l=0;for(let c=0,h=s.getPointCount();c<h;c++){const m=r.readPoint2D(2*c);i.contains(m)?(o===-1&&(o=c,a=c),a++):o>=0&&(this.m_verticesMp.addPoints(s,o,a-o),o=-1,l++)}if(o>0&&(this.m_verticesMp.addPoints(s,o,a-o),l++),!l)return;this.m_xyStream=this.m_vertices.getAttributeStreamRef(0),this.m_vertexIndexList.setCapacity(this.m_vertexIndexList.size()+n);const u=this.insertPath(e,L);for(let c=0,h=s.getPointCount();c<h;c++){const m=r.readPoint2D(2*c);i.contains(m)&&this.insertVertex_(u,L,null,!1)}}splitSegmentForward(e,s,i,r,n){const o=this.getNextVertex(e);o===L&&ee("Edit_shape.split_segment_forward_");const a=this.getHelperPoint(),l=this.getPathFromVertex(e);let u=e;const c=this.hasSegmentParentage();for(let h=0,m=s.getResultSegmentCount(i);h<m;h++){const f=this.getVertexIndex(u),g=this.getNextVertex(u),v=s.getResultSegment(i,h);let b=null;if(v.getGeometryType()!==G.enumLine&&(b=v.clone(),b.dropAllAttributes()),h===0&&(v.queryStart(a),this.setSegmentToIndex(f,null),this.setPointEx(u,a,s.getResultSegmentStartPointRank(i,h),s.getResultSegmentStartPointWeight(i,h),n)),this.setSegmentRank(u,s.getResultSegmentInteriorRank(i,h)),this.setSegmentWeight(u,s.getResultSegmentInteriorWeight(i,h)),c){const w=s.getResultSegmentSegmentParentage(i,h),S=s.getResultSegmentStartPointIsBreak(i,h);this.setSegmentParentageAndBreak(u,w,S)}if(v.queryEnd(a),h<m-1){this.setSegmentToIndex(f,b);const w=this.insertVertex(l,g,a);this.setWeight(w,s.getResultSegmentEndPointWeight(i,h)),this.setRank(w,s.getResultSegmentEndPointRank(i,h)),this.select(w),u=w}else{this.setPointEx(o,a,s.getResultSegmentEndPointRank(i,h),s.getResultSegmentEndPointWeight(i,h),n);const w=s.getResultSegmentEndPointIsBreak(i,h);this.setSegmentParentageBreakVertex(o,w),this.setSegmentToIndex(f,b)}}}splitSegmentBackward(e,s,i,r,n){const o=this.getNextVertex(e);o===L&&ee("Edit_shape.split_segment_backward_");const a=this.getHelperPoint(),l=this.getPathFromVertex(e);let u=e;const c=this.hasSegmentParentage();for(let h=0,m=s.getResultSegmentCount(i);h<m;h++){const f=m-h-1,g=this.getVertexIndex(u),v=this.getNextVertex(u),b=s.getResultSegment(i,f);let w=null;if(b.getGeometryType()!==G.enumLine&&(w=b.clone(),w.reverse(),w.dropAllAttributes()),h===0&&(b.queryEnd(a),this.setSegmentToIndex(g,null),this.setPointEx(u,a,s.getResultSegmentEndPointRank(i,f),s.getResultSegmentEndPointWeight(i,f),n),this.setSegmentParentageAndBreak(u,s.getResultSegmentSegmentParentage(i,f),s.getResultSegmentEndPointIsBreak(i,f))),b.getGeometryType()===G.enumLine?this.setSegmentToIndex(g,null):this.setSegmentToIndex(g,w),this.setSegmentRank(u,s.getResultSegmentInteriorRank(i,f)),this.setSegmentWeight(u,s.getResultSegmentInteriorWeight(i,f)),b.queryStart(a),h<m-1){const S=this.insertVertex(l,v,a);this.setWeight(S,s.getResultSegmentStartPointWeight(i,f)),this.setRank(S,s.getResultSegmentStartPointRank(i,f)),this.select(S),u=S,c&&this.setSegmentParentageAndBreak(S,s.getResultSegmentSegmentParentage(i,f),s.getResultSegmentEndPointIsBreak(i,f))}else this.setPointEx(o,a,s.getResultSegmentStartPointRank(i,f),s.getResultSegmentStartPointWeight(i,f),n)}}selected_(e){return this.getUserIndex(e,this.m_selectionIndex)>=0}allocateIndex(e=!0){if(this.m_deletedIndices.length){const s=this.m_deletedIndices.pop();return e&&s.setRange(-1,0,s.size()),s}return e?yn(0,-1):yn(0)}recycleUserIndex(e){this.m_deletedIndices.push(e)}allocatePathIndex(){if(this.m_deletedPathIndices.length){const e=this.m_deletedPathIndices.at(-1);return this.m_deletedPathIndices.pop(),e}return yn(0)}recyclePathUserIndex(e){this.m_deletedPathIndices.push(e)}peelALoop_(e,s,i){const r=this.getNextVertex(e),n=this.getNextVertex(s),o=this.getVertexIndex(e),a=this.getVertexIndex(s);if(this.setNextVertex(e,n),this.setPrevVertex(n,e),this.setNextVertex(s,r),this.setPrevVertex(r,s),this.m_segments){const l=this.getSegmentFromIndex(o),u=this.getSegmentFromIndex(a);this.setSegmentToIndex(a,null),this.setSegmentToIndex(o,u),this.setSegmentToIndex(a,l)}if(this.hasSegmentParentage()){let l=this.getSegmentParentage(s),u=this.getSegmentParentage(e);l===-1&&u===-1||(u=be(l,l=u),this.setSegmentParentageAndBreak(e,u),this.setSegmentParentageAndBreak(s,l))}if(i){const l=this.getPathFromVertex(e),u=this.getGeometryFromPath(l),c=[!1],h=this.insertClosedPath(u,L,r,this.getFirstVertex(l),c);c[0]&&this.setFirstVertex(l,n);let m=this.getPathSize(l);return m-=this.getPathSize(h),this.setPathSize(l,m),h}return L}sortVerticesSimpleByYHelper(e,s,i){e.sort(s,i,(r,n)=>{let o=this.compareVerticesSimpleY(r,n);if(o===0){const a=this.getPathInternalIndexFromVertex(r),l=this.getPathInternalIndexFromVertex(n);o=a<l?-1:a>l?1:0}return o})}sortVerticesSimpleByYHelper3D(e,s,i){F(0)}constructor(){this.m_verticesMp=null,this.m_vertices=null,this.m_xyStream=null,this.m_vertexDescription=null,this.m_segments=null,this.m_weights=null,this.m_ranks=null,this.m_segmentWeights=null,this.m_segmentRanks=null,this.m_indices=[],this.m_deletedIndices=[],this.m_pathAreas=[],this.m_pathLengths=[],this.m_pathindices=[],this.m_deletedPathIndices=[],this.m_geometryIndices=[],this.m_selectedVertices=[],this.m_helperPoint=null,this.m_forceSetEnvelope=Ql.constructEmpty(),this.m_hasForceSetEnvelope=0,this.m_workPoint2D=M.getNAN(),this.m_workPoint2_2D=M.getNAN(),this.m_curveStitcher=null,this.m_pathCount=0,this.m_pointCount=0,this.m_firstGeometry=L,this.m_lastGeometry=L,this.m_vertexIndexList=new et(5),this.m_pathIndexList=new et(8),this.m_geometryIndexList=new et(8),this.m_bHasAttributes=!1,this.m_selectedCount=0,this.m_selectionIndex=-1,this.m_selection=!1,this.m_bucketSort=new Jc,this.m_segmentParentageIndex=-1}getTotalPointCount(){return this.m_pointCount}getEnvelope2D(e){if(this.m_hasForceSetEnvelope!==0)return new X(this.m_forceSetEnvelope.xmin,this.m_forceSetEnvelope.ymin,this.m_forceSetEnvelope.xmax,this.m_forceSetEnvelope.ymax);const s=this.hasCurves(),i=X.constructEmpty(),r=this.queryVertexIterator();let n=!0;for(let o=r.next();o!==L;o=r.next()){if(n?i.merge(this.getXY(o)):i.mergeNe(this.getXY(o)),s){const a=this.getSegment(o);if(a!==null){const l=X.constructEmpty();a.queryLooseEnvelope(l),i.mergeEnvelope2D(l)}}n=!1}return i}getEnvelope3D(e){return F(0),Ql.constructEmpty()}forceSetEnvelope2D(e){this.m_hasForceSetEnvelope=1,this.m_forceSetEnvelope.setCoords(e.xmin,e.ymin,0,e.xmax,e.ymax,0)}forceSetEnvelope3D(e){F(0)}forgetForceSetEnvelope(){this.m_hasForceSetEnvelope=0}getGeometryCount(){return this.m_geometryIndexList.size()}addGeometry(e,s){const i=e.getGeometryType();if(xt(i))return this.addMultiPath(e,s);if(i===G.enumMultiPoint)return this.addMultiPoint(e,s);if(i===G.enumPoint)return this.addPoint_(e,s);if(i===G.enumEnvelope){const r=new wt;return r.addEnvelope(e,!1),this.addMultiPath(r,s)}ee("")}appendGeometry(e,s){this.mergeVertexDescription(s.getDescription());const i=s.getGeometryType();xt(i)?this.appendMultiPath(e,s):i!==G.enumMultiPoint?ee(""):this.appendMultiPoint(e,s)}assignRankToGeometryVertices(e,s){s<ci&&(s=ci);const i=this.queryVertexIterator();for(let r=i.next();r!==L;r=i.next())this.setRank(r,s),this.setSegmentRank(r,s)}collapseAllGeometriesToFirst(){this.collapseGeometriesToFirst(G.enumUnknown)}collapseGeometriesToFirst(e){this.dbgVerifyVertexCounts();let s=L,i=-1,r=-1;for(let n=this.getFirstGeometry();n!==L;)if(e!==G.enumUnknown&&this.getGeometryType(n)!==e)n=this.getNextGeometry(n);else{if(s===L){s=n,i=this.getPathCount(s),r=this.getPointCount(s),n=this.getNextGeometry(n);continue}for(let u=this.getFirstPath(n);u!==L;u=this.getNextPath(u))this.setPathGeometry(u,s);i+=this.getPathCount(n),r+=this.getPointCount(n);const o=this.getLastPath(s),a=this.getFirstPath(n);o!==L?this.setNextPath(o,a):this.setFirstPath(s,a),a!==L&&(this.setPrevPath(a,o),this.setLastPath(s,this.getLastPath(n))),this.setFirstPath(n,L),this.setLastPath(n,L);const l=n;n=this.getNextGeometry(n),this.setGeometryVertexCount(l,0),this.removeGeometry(l)}return s!==L&&(this.setGeometryVertexCount(s,r),this.setGeometryPathCount(s,i),this.dbgVerifyVertexCounts()),s}setFillRule(e,s){let i=this.m_geometryIndexList.getField(e,2);i&=-134217729,i|=s===1?134217728:0,this.m_geometryIndexList.setField(e,2,i)}getFillRule(e){return 134217728&this.m_geometryIndexList.getField(e,2)?1:0}setGeometryModified(e,s){let i=this.m_geometryIndexList.getField(e,2);!!(67108864&i)!==s&&(i&=-67108865,i|=s?67108864:0,this.m_geometryIndexList.setField(e,2,i))}getGeometryModified(e){return!!(67108864&this.m_geometryIndexList.getField(e,2))}setGeometryModifiedWithVertex(e,s){const i=this.getPathFromVertex(e),r=this.getGeometryFromPath(i);this.setGeometryModified(r,s)}getGeometryModifiedWithVertex(e){const s=this.getPathFromVertex(e),i=this.getGeometryFromPath(s);return this.getGeometryModified(i)}swapGeometry(e,s){const i=this.getFirstPath(e),r=this.getFirstPath(s),n=this.getLastPath(e),o=this.getLastPath(s);for(let f=this.getFirstPath(e);f!==L;f=this.getNextPath(f))this.setPathGeometry(f,s);for(let f=this.getFirstPath(s);f!==L;f=this.getNextPath(f))this.setPathGeometry(f,e);this.setFirstPath(e,r),this.setFirstPath(s,i),this.setLastPath(e,o),this.setLastPath(s,n);const a=this.getPointCount(e),l=this.getPathCount(e),u=this.getPointCount(s),c=this.getPathCount(s);this.setGeometryVertexCount(e,u),this.setGeometryVertexCount(s,a),this.setGeometryPathCount(e,c),this.setGeometryPathCount(s,l);const h=this.m_geometryIndexList.getField(e,2),m=this.m_geometryIndexList.getField(s,2);this.m_geometryIndexList.setField(e,2,m),this.m_geometryIndexList.setField(s,2,h)}addPathFromMultiPath(e,s,i){const r=this.createGeometry(i?G.enumPolygon:G.enumPolyline,e.getDescription()),n=e.getImpl();if(e.getPathSize(s)<2)return r;this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+e.getPathSize(s)),this.m_verticesMp.addPoints(e,e.getPathStart(s),n.getPathEnd(s)),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0);const o=this.insertPath(r,L);this.setClosedPath(o,n.isClosedPath(s)||i);const a=this.m_segments!==null||n.getSegmentFlagsStreamRef()!==null;for(let l=n.getPathStart(s),u=n.getPathEnd(s);l<u;l++){const c=this.insertVertex_(o,L,null,!1);if(a){const h=this.getVertexIndex(c);if(1&n.getSegmentFlags(l))this.setSegmentToIndex(h,null);else{const m=new ut;n.querySegment(l,m,!0),this.setSegmentToIndex(h,m.releaseSegment())}}}return n.isStrongPathStart(s)&&this.setStrongPathStart(o,!0),n.isStrongPathEnd(s)&&this.setStrongPathEnd(o,!0),r}getGeometry(e){const s=this.getGeometryType(e),i=tst(s,this.m_verticesMp.getDescription()),r=this.getPointCount(e);if(r===0)return i;if(xt(s)){const n=i.getImpl(),o=this.getPathCount(e),a=yn(o+1),l=Oh(o+1,0),u=i.getDescription(),c=this.hasCurves();for(let h=0,m=u.getAttributeCount();h<m;h++){const f=u.getSemantics(h),g=Sre.getComponentCount(f),v=C9(f,r),b=this.m_vertices.getAttributeStreamRef(f);let w=0,S=0,T=0;for(let P=this.getFirstPath(e);P!==L;P=this.getNextPath(P)){let I=0;this.isClosedPath(P)&&(I|=1),this.isExterior(P)&&(I|=8),this.isStrongPathStart(P)&&(I|=2),this.isStrongPathEnd(P)&&(I|=4),I&&l.setBits(S,I);const A=this.getPathSize(P);if(a.write(S++,T),T+=A,f===0){const D=b,k=v;let R;for(let O=this.getFirstVertex(P);w<T;O=this.getNextVertex(O),w++){const z=this.getVertexIndex(O);R=D.readPoint2D(2*z),k.writePoint2D(2*w,R)}}else for(let D=this.getFirstVertex(P);w<T;D=this.getNextVertex(D),w++){const k=this.getVertexIndex(D);for(let R=0;R<g;R++){const O=b.readAsDbl(k*g+R);v.writeAsDbl(w*g+R,O)}}}n.setAttributeStreamRef(f,v),a.write(o,r)}if(n.setPathFlagsStreamRef(l),n.setPathStreamRef(a),n.notifyModifiedFlags(65535),c){let h=0,m=0;for(let f=this.getFirstPath(e);f!==L;f=this.getNextPath(f)){h+=this.getPathSize(f);for(let g=this.getFirstVertex(f);m<h;g=this.getNextVertex(g)){const v=this.getSegment(g);v!==null&&v.isCurve()&&n.replaceSegment(m,v,!0),m++}}}}else if(s===G.enumMultiPoint){const n=i.getImpl(),o=i.getDescription();n.reserve(r),n.resizeNoInit(r);for(let a=0,l=o.getAttributeCount();a<l;a++){const u=o.getSemantics(a),c=Sre.getComponentCount(u),h=n.getAttributeStreamRef(u),m=this.m_vertices.getAttributeStreamRef(u);let f=0;const g=this.getFirstPath(e),v=this.getPathSize(g);for(let b=this.getFirstVertex(g);f<v;b=this.getNextVertex(b),f++){const w=this.getVertexIndex(b);for(let S=0;S<c;S++){const T=m.readAsDbl(w*c+S);h.writeAsDbl(f*c+S,T)}}n.setAttributeStreamRef(u,h)}n.notifyModifiedFlags(65535)}else Ce("getGeometry");return i}queryPointGeometryOnly(e,s){this.getGeometryType(e)!==G.enumMultiPoint&&ee("get_point_geometry_only");const i=this.getPointCount(e);if(i>1&&ee("get_point_geometry_only"),i===0)return s.assignVertexDescription(this.m_vertexDescription),void s.setEmpty();const r=this.getFirstPath(e),n=this.getFirstVertex(r);this.queryPoint(n,s)}removeGeometry(e){for(let r=this.getFirstPath(e);r!==L;r=this.removePath(r));const s=this.getPrevGeometry(e),i=this.getNextGeometry(e);return s!==L?this.setNextGeometry(s,i):this.m_firstGeometry=i,i!==L?this.setPrevGeometry(i,s):this.m_lastGeometry=s,this.freeGeometry(e),i}createGeometry(e,s){s===void 0&&(s=Jr());const i=this.newGeometry(e);return this.m_vertices||(this.m_verticesMp=new pi({vd:s}),this.m_vertices=this.m_verticesMp.getImpl()),this.mergeVertexDescription(s),this.m_firstGeometry===L?(this.m_firstGeometry=i,this.m_lastGeometry=i):(this.setPrevGeometry(i,this.m_lastGeometry),this.setNextGeometry(this.m_lastGeometry,i),this.m_lastGeometry=i),i}getFirstGeometry(){return this.m_firstGeometry}getLastGeometry(){return this.m_lastGeometry}getNextGeometry(e){return this.m_geometryIndexList.getField(e,1)}getPrevGeometry(e){return this.m_geometryIndexList.getField(e,0)}getGeometryType(e){return 16777215&this.m_geometryIndexList.getField(e,2)}setGeometryUserIndex(e,s,i){const r=this.m_geometryIndices[s],n=this.getGeometryIndex(e);n>=r.size()&&r.resize(Math.max(1.25*n,16),-1),r.write(n,i)}getGeometryUserIndex(e,s){const i=this.getGeometryIndex(e),r=this.m_geometryIndices[s];return i<r.size()?r.read(i):-1}createGeometryUserIndex(){for(let s=0;s<this.m_geometryIndices.length;s++)if(this.m_geometryIndices[s]===null)return this.m_geometryIndices[s]=yn(0),s;this.m_geometryIndices.push(yn(0));const e=this.m_geometryIndices.length-1;return F(e>=0&&e<=Number.MAX_SAFE_INTEGER),e}removeGeometryUserIndex(e){for(this.m_geometryIndices[e]=null;this.m_geometryIndices.length>0&&this.m_geometryIndices.at(-1)===null;)this.m_geometryIndices.pop()}getFirstPath(e){return this.m_geometryIndexList.getField(e,3)}getLastPath(e){return this.m_geometryIndexList.getField(e,4)}hasPointFeatures(){for(let e=this.getFirstGeometry();e!==L;e=this.getNextGeometry(e))if(!xt(this.getGeometryType(e)))return!0;return!1}getPointCount(e){return this.m_geometryIndexList.getField(e,5)}getPathCount(e){return this.m_geometryIndexList.getField(e,6)}filterClosePoints(e,s,i,r,n){const o=e*e;let a=0;const l=this.hasCurves(),u=this.hasSegmentParentage();for(let c=n===L?this.getFirstGeometry():n;c!==L;c=n===L?this.getNextGeometry(c):L){const h=this.getGeometryType(c);if(!xt(h)||i&&h!==G.enumPolygon)continue;const m=this.getGeometryType(c)===G.enumPolygon;let f=this.getGeometryModified(c);for(let g=this.getFirstPath(c);g!==L;){let v=0;for(let T=this.getFirstVertex(g);v<Math.trunc(this.getPathSize(g)/2);){const P=this.getNextVertex(T);if(P===L)break;const I=this.getXY(T),A=this.getXY(P);let D=M.sqrDistance(I,A),k=!0;do if(D<=o){if(l){const R=this.getSegment(T);if(R!==null){const O=R.calculateLength2D();if(D=O*O,D>o)break}}if(D===0?a===0&&(a=-1):a=1,P!==this.getLastVertex(g)){const R=u&&(this.getSegmentParentageBreakVertex(T)||this.getSegmentParentageBreakVertex(P));if(this.transferAllDataToTheVertex(P,T),this.removeVertex(P,!1),r&&!f&&(this.setGeometryModified(c,!0),f=!0),u&&T!==P){this.setSegmentParentageBreakVertex(T,R);const O=this.getNextVertex(T);F(O!==L),this.isDiscontinuousSegmentParentage(O)&&this.setSegmentParentageBreakVertex(O,!0)}}k=!1}while(!1);k&&(T=this.getNextVertex(T)),v++}let b=this.getFirstVertex(g);for(let T=this.isClosedPath(g)?b:this.getLastVertex(g);this.getPathSize(g)>0;){const P=this.getPrevVertex(T);if(P===L)break;{const I=this.getXY(P),A=this.getXY(T);let D=M.sqrDistance(I,A),k=!0;do if(D<=o){if(l){const O=this.getSegment(P);if(O!==null){const z=O.calculateLength2D();if(D=z*z,D>o)break}}D===0?a===0&&(a=-1):a=1;const R=u&&(this.getSegmentParentageBreakVertex(T)||this.getSegmentParentageBreakVertex(P));this.removeVertex(P,!0),r&&!f&&(this.setGeometryModified(c,!0),f=!0),u&&P!==T&&(R||this.isDiscontinuousSegmentParentage(T))&&this.setSegmentParentageBreakVertex(T,!0),b===P&&(b=this.getFirstVertex(g)),k=!1}while(!1);if(k&&(T=this.getPrevVertex(T),T===b))break}}const w=this.getPathSize(g);let S=s&&w<(m?3:2);S&&m&&w===2&&l&&(S=!this.pathHasCurves(g)),S?(g=this.removePath(g),a===0&&(a=-1),r&&!f&&(this.setGeometryModified(c,!0),f=!0)):g=this.getNextPath(g)}}return a}filterClosePoints3D(e,s,i,r,n,o){return F(0),0}hasDegenerateSegments(e){for(let s=this.getFirstGeometry();s!==L;s=this.getNextGeometry(s))if(xt(this.getGeometryType(s)))for(let i=this.getFirstPath(s);i!==L;){const r=this.getPathSize(i);if(r===0)return!0;let n=this.getFirstVertex(i);for(let o=0;o<r;o++){const a=this.getNextVertex(n);if(a===L)break;const l=this.getVertexIndex(n),u=this.getSegmentFromIndex(l);let c=0;if(u!==null){if(c=u.calculateLowerLength2D(),c<=e&&(c=u.calculateUpperLength2D(),c<=e||(c=u.calculateLength2D(),c<=e)))return!0}else{const h=this.getVertexIndex(a);if(c=this.m_vertices.getShortestDistance(l,h),c<=e)return!0}n=a}i=this.getNextPath(i)}return!1}hasDegenerateSegments3D(e,s){return F(0),!1}transferAllDataToTheVertex(e,s){const i=this.getVertexIndex(e),r=this.getVertexIndex(s);if(this.m_weights){const o=this.getWeightWithIndex(i);this.setWeightWithIndex(r,o)}if(this.m_ranks){const o=this.getRankWithIndex(i);this.setRankWithIndex(r,o)}if(this.m_segmentWeights){const o=this.getSegmentWeightWithIndex(i);this.setSegmentWeightWithIndex(r,o)}if(this.m_segmentRanks){const o=this.getSegmentRankWithIndex(i);this.setSegmentRankWithIndex(r,o)}for(let o=0,a=this.m_indices.length;o<a;o++)if(o!==this.m_selectionIndex&&this.m_indices[o]!==null){const l=this.getUserIndex(e,o);l!==-1&&this.setUserIndex(s,o,l)}const n=this.selected(e);n!==this.selected(s)&&(n?this.select(s):this.unselect(s))}splitSegmentAxisAware(e,s,i,r,n){let o=0;const a=this.getNextVertex(e);a===L&&ee("");const l=this.getVertexIndex(e),u=this.getVertexIndex(a),c=this.getSegmentFromIndex(l);let h=this.m_vertices.getShortestDistance(l,u);const m=this.getPathFromVertex(e),f=this.m_bHasAttributes;f&&c&&(h=c.calculateLength2D());const g=this.getSegmentParentage(e),v=this.getHelperPoint();if(c){let b=0,w=0,S=L;for(let T=0;T<i;T++){const P=s[T];if(b<P&&P<1){const I=c.cut(b,P);if(r!==null&&(T>0&&I.setStartXY(r[T-1]),I.setEndXY(r[T]),I.normalizeAfterEndpointChange(),w=T),f){const k=h>0?c.calculateSubLengthFromStart(P)/h:0;this.m_vertices.interpolateTwoVertices(l,u,k,v)}v.setXY(I.getEndXY()),S=this.insertVertex(m,a,v),o++;const A=this.getPrevVertex(S),D=this.getVertexIndex(A);this.setSegmentToIndex(D,I),g!==-1&&this.setSegmentParentageAndBreak(S,g,!1),b=P}}if(S!==L){const T=c.cut(b,1);r!==null&&(T.setStartXY(r[w]),T.normalizeAfterEndpointChange());const P=this.getVertexIndex(S);this.setSegmentToIndex(P,T)}}else{let b=0;for(let w=0;w<i;w++){const S=s[w];if(b<S&&S<1){this.m_vertices.interpolateTwoVertices(l,u,S,v);const T=this.insertVertex(m,a,v);o++,g!==-1&&this.setSegmentParentageAndBreak(T,g,!1)}b=S}}return o}splitSegment(e,s,i,r=null){return this.splitSegmentAxisAware(e,s,i,r,-1)}snapControlPoints(e,s,i){this.getNextVertex(e)===L&&ee("");let r=e,n=!1;for(let o=0;o<s;++o){const a=this.getVertexIndex(r),l=this.getSegmentFromIndex(a);if(l){const u=l.snapControlPoints(i);n||(n=u)}r=this.getNextVertex(r)}return n}snapControlPointsOnSelection(e){if(!this.hasCurves())return!1;let s=0;const i=this.queryVertexIteratorOnSelection();for(let r=i.next();r!==L;r=i.next()){const n=this.getVertexIndex(r),o=this.getSegmentFromIndex(n);o&&(s|=o.snapControlPoints(e)?1:0)}return s!==0}calculateSubLength2D(e,s,i){return F(0),0}setPoint(e,s,i){if(this.setPointOnly(e,s),this.m_segments!==null){const r=this.getVertexIndex(e),n=this.getSegmentFromIndex(r);n!==null&&(n.setStartXY(s.getXY()),n.normalizeAfterEndpointChange(),i&&n.ensureXYMonotone());const o=this.getPrevVertex(e);if(o!==L){const a=this.getVertexIndex(o),l=this.getSegmentFromIndex(a);l!==null&&(l.setEndXY(s.getXY()),l.normalizeAfterEndpointChange(),i&&l.ensureXYMonotone())}}}setPointEx(e,s,i,r,n){this.setPoint(e,s,n);const o=this.getVertexIndex(e);this.setWeightWithIndex(o,r),this.setRankWithIndex(o,i)}setPointOnly(e,s){const i=this.getVertexIndex(e);this.m_vertices.setPointByVal(i,s)}setPointOnlyEx(e,s,i,r){F(0)}queryPoint(e,s){const i=this.getVertexIndex(e);this.m_vertices.getPointByVal(i,s)}setXY(e,s){this.setXYCoords(e,s.x,s.y)}setXYCoords(e,s,i){var n;const r=this.getVertexIndex(e);if((n=this.m_vertices)==null||n.setXYCoords(r,s,i),this.m_segments!==null){const o=this.getSegmentFromIndex(r);o!==null&&(o.setStartXYCoords(s,i),o.normalizeAfterEndpointChange());const a=this.getPrevVertex(e);if(a!==L){const l=this.getVertexIndex(a),u=this.getSegmentFromIndex(l);u!=null&&(u.setEndXYCoords(s,i),u.normalizeAfterEndpointChange())}}}setXYMonotonic(e,s,i){const r=this.getVertexIndex(e);if(this.m_vertices.setXYCoords(r,s,i),this.m_segments!==null){const n=this.getSegmentFromIndex(r);if(n!==null){const a=n.getEndXY();n.setCoordsForIntersector(new M(s,i),a,!1),n.ensureXYMonotone()}const o=this.getPrevVertex(e);if(o!==L){const a=this.getVertexIndex(o),l=this.getSegmentFromIndex(a);if(l!==null){const u=l.getStartXY();l.setCoordsForIntersector(u,new M(s,i),!1),l.ensureXYMonotone()}}}}setXYMonotonicPoint2D(e,s){this.setXYMonotonic(e,s.x,s.y)}queryXY(e,s){const i=this.getVertexIndex(e);return this.m_vertices.queryXY(i,s)}getXY(e){const s=this.getVertexIndex(e);return this.m_vertices.getXY(s)}getXYWithIndex(e){return this.m_xyStream.readPoint2D(2*e)}static setSegDefault(e,s,i){F(0)}setXYZ(e,s,i){F(0)}setXYZCoords(e,s,i,r){F(0)}queryXYZ(e,s){F(0)}getXYZ(e){return F(0),gt.getNAN()}getXYZWithIndex(e){return F(0),gt.getNAN()}mergeVertexDescription(e){this.m_verticesMp.mergeVertexDescription(e),this.m_vertexDescription=this.m_verticesMp.getDescription(),this.m_bHasAttributes=this.m_vertexDescription.getAttributeCount()>1}addAttribute(e){F(0)}getAttributeAsDbl(e,s,i){return this.m_vertices.getAttributeAsDbl(e,this.getVertexIndex(s),i)}queryAttributeAsDbl(e,s,i,r){F(0)}setAttribute(e,s,i,r){F(0)}setAttributeInt(e,s,i,r){F(0)}getVertexDescription(){return this.m_vertexDescription}getMinPathVertexY(e){return F(0),0}getVertexIndex(e){return this.m_vertexIndexList.getField(e,0)}getY(e){const s=this.getVertexIndex(e);return this.m_vertices.queryXY(s,this.m_workPoint2D),this.m_workPoint2D.y}getX(e){return this.getXY(e).x}isEqualXY(e,s){return this.queryXY(e,this.m_workPoint2D),this.queryXY(s,this.m_workPoint2_2D),this.m_workPoint2D.isEqualPoint2D(this.m_workPoint2_2D)}isEqualXYPoint2D(e,s){return this.queryXY(e,this.m_workPoint2D),this.m_workPoint2D.isEqualPoint2D(s)}isEqualXYZPoint3D(e,s){return F(0),!1}setWeight(e,s){s<1&&(s=1);const i=s===1;if(this.m_weights==null){if(i)return;this.m_weights=fa(this.m_vertices.getPointCount(),1)}const r=this.getVertexIndex(e);if(r>=this.m_weights.size()){if(i)return;this.m_weights.resize(r+1,1)}this.m_weights.write(r,s)}setWeightWithIndex(e,s){s<1&&(s=1);const i=s===1;if(this.m_weights===null){if(i)return;this.m_weights=fa(this.m_vertices.getPointCount(),1)}if(e>=this.m_weights.size()){if(i)return;this.m_weights.resize(e+1,1)}this.m_weights.write(e,s)}getWeight(e){if(this.m_weights===null)return 1;const s=this.getVertexIndex(e);return s>=this.m_weights.size()?1:this.m_weights.read(s)}getWeightWithIndex(e){return this.m_weights===null||e>=this.m_weights.size()?1:this.m_weights.read(e)}getRank(e){if(this.m_ranks===null)return ci;const s=this.getVertexIndex(e);return s>=this.m_ranks.size()?ci:this.m_ranks.read(s)}getRankWithIndex(e){return this.m_ranks===null||e>=this.m_ranks.size()?ci:this.m_ranks.read(e)}setRank(e,s){s<ci&&(s=ci);const i=s===ci;if(this.m_ranks===null){if(i)return;this.m_ranks=yn(this.m_vertices.getPointCount(),ci)}const r=this.getVertexIndex(e);if(r>=this.m_ranks.size()){if(i)return;this.m_ranks.resize(r+1,ci)}this.m_ranks.write(r,s)}setRankWithIndex(e,s){s<ci&&(s=ci);const i=s===ci;if(this.m_ranks===null){if(i)return;this.m_ranks=yn(this.m_vertices.getPointCount(),ci)}if(e>=this.m_ranks.size()){if(i)return;this.m_ranks.resize(e+1,ci)}this.m_ranks.write(e,s)}setSegmentWeight(e,s){s<1&&(s=1);const i=s===1;if(this.m_segmentWeights===null){if(i)return;this.m_segmentWeights=fa(this.m_vertices.getPointCount(),1)}const r=this.getVertexIndex(e);if(r>=this.m_segmentWeights.size()){if(i)return;this.m_segmentWeights.resize(r+1,1)}this.m_segmentWeights.write(r,s)}setSegmentWeightWithIndex(e,s){s<1&&(s=1);const i=s===1;if(this.m_segmentWeights==null){if(i)return;this.m_segmentWeights=fa(this.m_vertices.getPointCount(),1)}if(e>=this.m_segmentWeights.size()){if(i)return;this.m_segmentWeights.resize(e+1,1)}this.m_segmentWeights.write(e,s)}getSegmentWeight(e){if(this.m_segmentWeights===null)return 1;const s=this.getVertexIndex(e);return s>=this.m_segmentWeights.size()?1:this.m_segmentWeights.read(s)}getSegmentWeightWithIndex(e){return this.m_segmentWeights==null||e>=this.m_segmentWeights.size()?1:this.m_segmentWeights.read(e)}getSegmentRank(e){if(this.m_segmentRanks===null)return TG.st_defaultRank;const s=this.getVertexIndex(e);return s>=this.m_segmentRanks.size()?TG.st_defaultRank:this.m_segmentRanks.read(s)}getSegmentRankWithIndex(e){return this.m_segmentRanks===null||e>=this.m_segmentRanks.size()?ci:this.m_segmentRanks.read(e)}setSegmentRank(e,s){s<ci&&(s=ci);const i=s===ci;if(this.m_segmentRanks===null){if(i)return;this.m_segmentRanks=yn(this.m_vertices.getPointCount(),ci)}const r=this.getVertexIndex(e);if(r>=this.m_segmentRanks.size()){if(i)return;this.m_segmentRanks.resize(r+1,ci)}this.m_segmentRanks.write(r,s)}setSegmentRankWithIndex(e,s){s<ci&&(s=ci);const i=s===ci;if(this.m_segmentRanks===null){if(i)return;this.m_segmentRanks=yn(this.m_vertices.getPointCount(),ci)}if(e>=this.m_segmentRanks.size()){if(i)return;this.m_segmentRanks.resize(e+1,ci)}this.m_segmentRanks.write(e,s)}removeWeights(){this.m_weights=null,this.m_segmentWeights=null}removeRanks(){this.m_ranks=null,this.m_segmentRanks=null}setUserIndex(e,s,i){const r=this.m_indices[s],n=this.getVertexIndex(e);if(r.size()<=n){if(i===-1)return;r.resize(this.m_vertices.getPointCount(),-1)}r.write(n,i)}getUserIndex(e,s){const i=this.getVertexIndex(e),r=this.m_indices[s];return i<r.size()?r.read(i):-1}addToUserIndex(e,s,i){const r=this.m_indices[s],n=this.getVertexIndex(e);r.size()<=n&&r.resize(this.m_vertices.getPointCount(),-1);const o=r.read(n);r.write(n,o+i)}createUserIndex(){for(let s=0;s<this.m_indices.length;s++)if(this.m_indices[s]===null)return this.m_indices[s]=this.allocateIndex(),s;this.m_indices.push(this.allocateIndex());const e=this.m_indices.length-1;return F(e>=0&&e<=Qr()),e}createUserIndexUninitialized(){for(let s=0;s<this.m_indices.length;s++)if(this.m_indices[s]===null)return this.m_indices[s]=this.allocateIndex(!1),s;this.m_indices.push(this.allocateIndex(!1));const e=this.m_indices.length-1;return F(e>=0&&e<=Number.MAX_SAFE_INTEGER),e}fillUserIndexForGeometry(e,s,i){const r=this.m_indices[s],n=r.size();for(let o=this.getFirstPath(e);o!==L;o=this.getNextPath(o)){let a=this.getFirstVertex(o);for(let l=0,u=this.getPathSize(o);l<u;l++,a=this.getNextVertex(a)){const c=this.getVertexIndex(a);c<n&&r.write(c,i)}}}fillUserIndexForSelection(e,s){F(0)}removeUserIndex(e){for(this.recycleUserIndex(this.m_indices[e]),this.m_indices[e]=null;this.m_indices.length>0&&this.m_indices[this.m_indices.length-1]===null;)this.m_indices.pop()}replaceCurveWithLine(e){if(this.m_segments!==null){const s=this.getVertexIndex(e);this.setSegmentToIndex(s,null)}}queryLineConnector(e,s,i=!1){const r=this.getNextVertex(e);if(r===L)return!1;if(!this.m_bHasAttributes||i){const n=this.getXY(e);s.setStartXY(n);const o=this.getXY(r);s.setEndXY(o)}else{const n=new nt({vd:this.getVertexDescription()});this.queryPoint(e,n),s.setStart(n),this.queryPoint(r,n),s.setEnd(n)}return!0}queryLineConnector3D(e,s,i=!1){return F(0),!1}hasCurves(){return this.m_segments!==null}geometryHasCurves(e){return F(0),!1}pathHasCurves(e){if(!this.hasCurves())return!1;const s=this.getFirstVertex(e);if(s===L)return!1;const i=this.getPathSize(e);let r=s;for(let n=0;n<i;n++,r=this.getNextVertex(r)){const o=this.getSegment(r);if(o!==null&&o.getGeometryType()!==G.enumLine)return!0}return!1}insertPath(e,s){let i=L;s!==L?(e!==this.getGeometryFromPath(s)&&ee(""),i=this.getPrevPath(s)):i=this.getLastPath(e);const r=this.newPath(e);return s!==L&&this.setPrevPath(s,r),this.setNextPath(r,s),this.setPrevPath(r,i),i!==L?this.setNextPath(i,r):this.setFirstPath(e,r),s===L&&this.setLastPath(e,r),this.setGeometryPathCount(e,this.getPathCount(e)+1),r}removePath(e){const s=this.getPrevPath(e),i=this.getNextPath(e),r=this.getGeometryFromPath(e);return s!==L?this.setNextPath(s,i):this.setFirstPath(r,i),i!==L?this.setPrevPath(i,s):this.setLastPath(r,s),this.clearPath(e),this.setGeometryPathCount(r,this.getPathCount(r)-1),this.freePath(e),i}clearPath(e){const s=this.getFirstVertex(e);if(s!==L){let i=s;for(let n=0,o=this.getPathSize(e);n<o;n++){const a=i;i=this.getNextVertex(i),this.freeVertex(a)}const r=this.getGeometryFromPath(e);this.setGeometryVertexCount(r,this.getPointCount(r)-this.getPathSize(e))}this.setPathSize(e,0)}getNextPath(e){return this.m_pathIndexList.getField(e,2)}getPrevPath(e){return this.m_pathIndexList.getField(e,1)}getPathSize(e){return this.m_pathIndexList.getField(e,3)}isClosedPath(e){return!!(1&this.getPathFlags(e))}setClosedPath(e,s){if(this.isClosedPath(e)===s)return;if(this.getPathSize(e)>0){const r=this.getFirstVertex(e),n=this.getLastVertex(e);if(s){this.setNextVertex(n,r),this.setPrevVertex(r,n);const o=this.getVertexIndex(n);this.setSegmentToIndex(o,null)}else{this.setNextVertex(n,L),this.setPrevVertex(r,L);const o=this.getVertexIndex(n);this.setSegmentToIndex(o,null)}}const i=(1|this.getPathFlags(e))-1;this.setPathFlags(e,i|(s?1:0))}closeAllPaths(e){F(0)}isStrongPathStart(e){return!!(8&this.getPathFlags(e))}isStrongPathEnd(e){return!!(16&this.getPathFlags(e))}setStrongPathStart(e,s){const i=(8|this.getPathFlags(e))-8;this.setPathFlags(e,i|(s?8:0))}setStrongPathEnd(e,s){const i=(16|this.getPathFlags(e))-16;this.setPathFlags(e,i|(s?16:0))}getGeometryFromPath(e){return this.m_pathIndexList.getField(e,7)}isExterior(e){return!!(2&this.getPathFlags(e))}setExterior(e,s){const i=(2|this.getPathFlags(e))-2;this.setPathFlags(e,i|(s?2:0))}getRingArea(e){if(this.isRingAreaValid(e))return this.m_pathAreas[this.getPathIndex(e)];const s=this.getFirstVertex(e);if(s===L)return 0;const i=this.getXY(s),r=new Fr(0),n=this.getPathSize(e);if(n>2){const a=i.clone(),l=a.x,u=a.y;let c=this.getNextVertex(s);const h=this.getXY(c);c=this.getNextVertex(c);const m=M.getNAN();for(let f=2;f<n;f++,c=this.getNextVertex(c))this.queryXY(c,m),r.pe((m.x-a.x)*(h.y-u)),a.setCoordsPoint2D(h),h.setCoordsPoint2D(m);r.pe((l-a.x)*(h.y-u))}if(this.hasCurves()){let a=s;for(let l=0;l<n;l++,a=this.getNextVertex(a)){const u=this.getSegment(a);if(u===null||u.getGeometryType()===G.enumLine)continue;const c=2*u.calculateArea2DHelper();r.pe(c)}}this.setRingAreaValid(e,!0);const o=.5*r.getResult();return this.m_pathAreas[this.getPathIndex(e)]=o,o}getPathIndexInternal(e){return this.getPathIndex(e)}getPathInternalIndexFromVertex(e){return this.getPathIndex(this.getPathFromVertex(e))}setPathUserIndex(e,s,i){const r=this.m_pathindices[s],n=this.getPathIndex(e);r.size()<this.m_pathAreas.length&&r.resize(this.m_pathAreas.length,-1),r.write(n,i)}getPathUserIndex(e,s){const i=this.getPathIndex(e),r=this.m_pathindices[s];return i<r.size()?r.read(i):-1}createPathUserIndex(){for(let s=0;s<this.m_pathindices.length;s++)if(this.m_pathindices[s]===null)return this.m_pathindices[s]=this.allocatePathIndex(),s;this.m_pathindices.push(this.allocatePathIndex());const e=this.m_pathindices.length-1;return F(e>=0&&e<=Number.MAX_SAFE_INTEGER),e}fillPathUserIndexForGeometry(e,s,i){const r=this.m_pathindices[s],n=r.size();for(let o=this.getFirstPath(e);o!==L;o=this.getNextPath(o)){const a=this.getPathIndex(o);a<n&&r.write(a,i)}}removePathUserIndex(e){for(this.recyclePathUserIndex(this.m_pathindices[e]),this.m_pathindices[e]=null;this.m_pathindices.length>0&&this.m_pathindices.at(-1)===null;)this.m_pathindices.pop()}movePath(e,s,i){if(i===L&&ee(""),s===i)return;const r=this.getNextPath(i);let n=this.getPrevPath(i);const o=this.getGeometryFromPath(i);n===L?this.setFirstPath(o,r):this.setNextPath(n,r),r===L?this.setLastPath(o,n):this.setPrevPath(r,n),this.setGeometryVertexCount(o,this.getPointCount(o)-this.getPathSize(i)),this.setGeometryPathCount(o,this.getPathCount(o)-1),n=s===L?this.getLastPath(e):this.getPrevPath(s),this.setPrevPath(i,n),this.setNextPath(i,s),s===L?this.setLastPath(e,i):this.setPrevPath(s,i),n===L?this.setFirstPath(e,i):this.setNextPath(n,i),this.setGeometryVertexCount(e,this.getPointCount(e)+this.getPathSize(i)),this.setGeometryPathCount(e,this.getPathCount(e)+1),this.setPathGeometry(i,e)}addVertex(e,s){return this.m_vertices.getPointByVal(this.getVertexIndex(s),this.getHelperPoint()),this.insertVertex_(e,L,this.getHelperPoint(),!1)}insertVertex(e,s,i){return this.insertVertex_(e,s,i,!0)}removeVertex(e,s){const i=this.getPathFromVertex(e),r=this.getPrevVertex(e),n=this.getNextVertex(e);r!==L&&this.setNextVertex(r,n);const o=this.getPathSize(i);if(e===this.getFirstVertex(i)&&this.setFirstVertex(i,o>1?n:L),n!==L&&this.setPrevVertex(n,r),e===this.getLastVertex(i)&&this.setLastVertex(i,o>1?r:L),this.hasCurves()&&r!==L&&n!==L){const l=this.getVertexIndex(e),u=this.getVertexIndex(r),c=this.getVertexIndex(n);if(s){const h=this.getSegmentFromIndex(u);if(h!==null){const m=this.m_vertices.getXY(c);h.setEndXY(m),h.normalizeAfterEndpointChange()}this.setSegmentToIndex(l,null)}else{const h=this.getSegmentFromIndex(l);if(this.setSegmentToIndex(l,null),h!==null){const m=this.m_vertices.getXY(u);h.setStartXY(m),h.normalizeAfterEndpointChange()}this.setSegmentToIndex(u,h)}}this.setPathSize(i,o-1);const a=this.getGeometryFromPath(i);return this.setGeometryVertexCount(a,this.getPointCount(a)-1),this.freeVertex(e),n}removeVertices(e,s){F(e!==s);const i=this.getPathFromVertex(e),r=this.getPrevVertex(e),n=this.getPrevVertex(s);r!==L&&this.setNextVertex(r,s);let o=this.getPathSize(i);const a=this.getVertexIndex(e);this.setSegmentToIndex(a,null),this.setPrevVertex(s,r),this.setPrevVertex(e,L),this.setNextVertex(n,L);let l=0,u=e;const c=this.getFirstVertex(i);let h=!1;for(;;){const f=this.getNextVertex(u);if(h||(h=c===u),this.freeVertex(u),l++,u===n)break;u=f}o-=l,h&&this.setFirstVertex(i,o>0?s:L),this.setPathSize(i,o);const m=this.getGeometryFromPath(i);this.setGeometryVertexCount(m,this.getPointCount(m)-l)}getFirstVertex(e){return this.m_pathIndexList.getField(e,4)}getLastVertex(e){return this.m_pathIndexList.getField(e,5)}getNextVertex(e){return this.m_vertexIndexList.getField(e,2)}getPrevVertex(e){return this.m_vertexIndexList.getField(e,1)}getNextVertexEx(e,s){return s>0?this.m_vertexIndexList.getField(e,2):this.m_vertexIndexList.getField(e,1)}getPrevVertexEx(e,s){return s>0?this.m_vertexIndexList.getField(e,1):this.m_vertexIndexList.getField(e,2)}getPathFromVertex(e){return this.m_vertexIndexList.getField(e,3)}addPoint(e,s){return this.insertVertex_(e,L,s,!1)}getGeometryFromVertex(e){return this.getGeometryFromPath(this.getPathFromVertex(e))}replaceNaNs(e,s){this.m_vertexDescription.hasAttribute(e)||Ce(""),this.m_vertices.replaceNaNs(e,s)}removeNaNVertices(){for(let e=this.getFirstGeometry();e!==L;e=this.getNextGeometry(e))for(let s=this.getFirstPath(e);s!==L;s=this.getNextPath(s)){let i=this.getFirstVertex(s);for(let r=0,n=this.getPathSize(s);r<n;r++)i=this.getXY(i).isFinite()?this.getNextVertex(i):this.removeVertex(i,!0)}}queryVertexIterator(e=L){return this.queryVertexIteratorEx(!1,e)}queryVertexIteratorEx(e,s=L){let i=L,r=L,n=L,o=L,a=0,l=!1;for(i=s!==L?s:this.getFirstGeometry();i!==L;i=this.getNextGeometry(i))if(!e||xt(this.getGeometryType(i))){for(r=this.getFirstPath(i);r!==L;r=this.getNextPath(r))if(n=this.getFirstVertex(r),o=n,a=0,n!==L){l=!0;break}if(l||s!==L)break}return l||(i=L),CG.create_(this,i,r,n,o,a,e,!1,s!==L)}queryVertexIteratorOnSelection(e=L){return this.m_selection?CG.create_(this,e,L,L,L,-1,!1,!0,e!==L):this.queryVertexIteratorEx(!1,e)}hasSelection(){return this.m_selection}createEmptySelection(){F(0)}removeSelection(){this.m_selection&&(this.m_selectedVertices.length=0,this.removeUserIndex(this.m_selectionIndex),this.m_selectionIndex=-1,this.m_selection=!1,this.m_selectedCount=0)}select(e){return!!this.selected(e)||(this.setUserIndex(e,this.m_selectionIndex,this.m_selectedVertices.length),this.m_selectedVertices.push(e),this.m_selectedCount++,!1)}unselect(e){if(!this.m_selection)return;const s=this.getUserIndex(e,this.m_selectionIndex);s>=0&&(this.m_selectedVertices[s]=L,this.setUserIndex(e,this.m_selectionIndex,-1),this.m_selectedCount--)}selected(e){return!this.m_selection||this.selected_(e)}getSelectedCount(){return this.m_selection?this.m_selectedCount:this.getTotalPointCount()}createSelectionForCrackingAndClustering(e,s){return F(0),!1}peelALoop(e,s){this.peelALoop_(e,s,!1)}peelALoopIntoAPath(e,s){return this.peelALoop_(e,s,!0)}applyTransformation(e){if(this.m_verticesMp.applyTransformation(e),this.m_segments!==null)for(let s=0,i=this.m_segments.length;s<i;s++)this.m_segments[s]&&this.m_segments[s].applyTransformation(e)}setGeometryType(e,s){this.m_geometryIndexList.setField(e,2,s)}splitSegmentWithIntersector(e,s,i,r,n){r?this.splitSegmentForward(e,s,i,!0,n):this.splitSegmentBackward(e,s,i,!0,n)}setPrevVertex(e,s){this.m_vertexIndexList.setField(e,1,s)}setNextVertex(e,s){this.m_vertexIndexList.setField(e,2,s)}setPathToVertex(e,s){this.m_vertexIndexList.setField(e,3,s)}setPathSize(e,s){this.m_pathIndexList.setField(e,3,s)}setFirstVertex(e,s){this.m_pathIndexList.setField(e,4,s)}setLastVertex(e,s){this.m_pathIndexList.setField(e,5,s)}getSegment(e){if(this.m_segments!=null){const s=this.getVertexIndex(e);return this.getSegmentFromIndex(s)}return null}isCurve(e){return F(0),!1}querySegment(e,s,i=!0,r=!1){const n=this.getNextVertex(e);if(n===L)return!1;const o=this.getSegment(e);if(!o)return!i&&(this.queryLineConnector(e,s.createLine(),r),!0);if(s.copyFrom(o,!0),r)return!0;if(this.m_vertexDescription.getAttributeCount()>1){const a=this.getHelperPoint();this.queryPoint(e,a),s.get().setStart(a),this.queryPoint(n,a),s.get().setEnd(a)}return!0}getSegmentFromIndex(e){return(this.m_segments!==null&&this.m_segments.length>e?this.m_segments[e]:null)||null}getAndClearSegmentFromIndex(e){return(this.m_segments!==null&&this.m_segments.length>e?this.m_segments[e]:null)||null}setSegmentToIndex(e,s){if(this.m_hasForceSetEnvelope=0,this.m_segments===null){if(!s)return;this.m_segments=[],this.m_segments.length=this.m_vertices.getPointCount()}e>=this.m_segments.length&&(this.m_segments.length=e+1),this.m_segments[e]=s}setGeometryPathCount(e,s){this.m_geometryIndexList.setField(e,6,s)}setGeometryVertexCount(e,s){this.m_geometryIndexList.setField(e,5,s)}ringParentageCheckInternal(e,s){return F(0),!1}reverseRingInternal(e){const s=this.hasCurves(),i=this.hasSegmentParentage();let r=null,n=-1,o=e;if(s){const a=this.getVertexIndex(o);r=this.getAndClearSegmentFromIndex(a)}i&&(n=this.getSegmentParentage(o));do{const a=this.getPrevVertex(o),l=this.getNextVertex(o);if(this.setNextVertex(o,a),this.setPrevVertex(o,l),s){const u=this.getVertexIndex(l),c=this.getSegmentFromIndex(u);r&&r.reverse(),this.setSegmentToIndex(u,r),r=c}if(i){const u=this.getSegmentParentage(l);this.setSegmentParentagePreserveBreak(l,n),n=u}o=l}while(o!==e);this.dbgVerifyIntegrity(e)}setTotalPointCount(e){this.m_pointCount=e}removePathOnly(e){const s=this.getPrevPath(e),i=this.getNextPath(e),r=this.getGeometryFromPath(e);s!==L?this.setNextPath(s,i):this.setFirstPath(r,i),i!==L?this.setPrevPath(i,s):this.setLastPath(r,s),this.setFirstVertex(e,L),this.setLastVertex(e,L),this.freePath(e)}insertClosedPath(e,s,i,r,n){const o=this.insertPath(e,L);let a=0,l=i;for(n[0]=!1;;){l===r&&(n[0]=!0),this.setPathToVertex(l,o),a++;const u=this.getNextVertex(l);if(u===i)break;l=u}return this.setClosedPath(o,!0),this.setPathSize(o,a),n[0]&&(i=r),this.setFirstVertex(o,i),this.setLastVertex(o,this.getPrevVertex(i)),this.setRingAreaValid(o,!1),o}findVertex2D(e,s){return F(0),0}findVertex3D(e,s,i){return F(0),0}dbgVerifyMonotone(){}dbgCheckSelection(){}dbgVerifySegment(e){}dbgVerifyIntegrity(e,s=!0){}dbgVerifyVertexCounts(){}dbgVerifyCurves(){}dbgDumpGeometry(e,s){}removeVertexInternal(e,s){const i=this.getPrevVertex(e),r=this.getNextVertex(e);if(i!==L&&this.setNextVertex(i,r),r!==L&&this.setPrevVertex(r,i),this.hasCurves()&&i!==L&&r!==L){const n=this.getVertexIndex(e),o=this.getVertexIndex(i),a=this.getVertexIndex(r);if(s){const l=this.getSegmentFromIndex(o);if(l!==null){const u=this.m_vertices.getXY(a);l.setEndXY(u),l.normalizeAfterEndpointChange()}this.setSegmentToIndex(n,null)}else{const l=this.getSegmentFromIndex(n);if(this.setSegmentToIndex(n,null),l!==null){const u=this.m_vertices.getXY(o);l.setStartXY(u),l.normalizeAfterEndpointChange()}this.setSegmentToIndex(o,l)}}return this.freeVertex(e),r}isRingAreaValid(e){return!!(4&this.getPathFlags(e))}setRingAreaValid(e,s){const i=(4|this.getPathFlags(e))-4;this.setPathFlags(e,i|(s?4:0))}compareVerticesSimpleY(e,s){return this.queryXY(e,this.m_workPoint2D),this.queryXY(s,this.m_workPoint2_2D),this.m_workPoint2D.compare(this.m_workPoint2_2D)}compareVerticesSimpleY3D(e,s){return this.getXYZ(e).compare(this.getXYZ(s))}compareVerticesSimpleX(e,s){return this.getXY(e).compareX(this.getXY(s))}sortVerticesSimpleByYHeapMerge(e,s){F(0)}sortVerticesSimpleByY(e,s,i){this.m_bucketSort.sort(e,s,i,new sst(this))}sortVerticesSimpleByX(e,s,i){F(0)}sortVerticesSimpleByY3D(e,s,i){F(0)}snapVertexForPoleClipping(e,s){const i=this.getPrevVertex(e);i!==L&&this.replaceCurveWithLine(i),this.getNextVertex(e)!==L&&this.replaceCurveWithLine(e);const r=new M;this.queryXY(e,r),r.y=s,this.setXY(e,r)}setSegmentParentageAndBreak(e,s,i=!0){if(this.m_segmentParentageIndex===-1){if(s===-1)return;this.m_segmentParentageIndex=this.createUserIndex()}s>=0&&(F(s<=co()>>1),s<<=1,s|=i?1:0),this.setUserIndex(e,this.m_segmentParentageIndex,s)}setSegmentParentagePreserveBreak(e,s){if(F(s>=-1),this.m_segmentParentageIndex===-1){if(s===-1)return;this.m_segmentParentageIndex=this.createUserIndex()}s>=0&&(F(s<=co()>>1),s<<=1,s|=this.getSegmentParentageBreakVertex(e)?1:0),this.setUserIndex(e,this.m_segmentParentageIndex,s)}getSegmentParentage(e){if(this.m_segmentParentageIndex===-1)return-1;const s=this.getUserIndex(e,this.m_segmentParentageIndex);return s<0?s:s>>1}getOriginalSegmentInfo(e){if(this.m_segmentParentageIndex!==-1){const s=this.getSegmentParentage(e);return new PG(s)}return new PG(-1)}setSegmentParentageBreakVertex(e,s){if(this.m_segmentParentageIndex===-1)return;let i=this.getUserIndex(e,this.m_segmentParentageIndex);i<0||!!(1&i)!==s&&(s?i|=1:i&=co()>>1<<1,this.setUserIndex(e,this.m_segmentParentageIndex,i))}getSegmentParentageBreakVertex(e){if(this.m_segmentParentageIndex===-1)return!0;const s=this.getUserIndex(e,this.m_segmentParentageIndex);return s<0||!!(1&s)}isDiscontinuousSegmentParentage(e){const s=this.getPrevVertex(e);return s===L?!1:this.getSegmentParentage(s)!==this.getSegmentParentage(e)}setCurveStitcherPointer(e){this.m_curveStitcher=e}hasSegmentParentage(){return this.m_segmentParentageIndex!==-1}deleteSegmentParentage(){this.m_segmentParentageIndex!==-1&&(this.removeUserIndex(this.m_segmentParentageIndex),this.m_segmentParentageIndex=-1),this.m_curveStitcher=null}clearSegments(){this.m_segments=null}};function jbt(t){if(t.isEmpty())return new wt({vd:t.getDescription()});const e=t.getImpl(),s=e.getPointCount();if(s<=2){if(s===1||e.getXY(0).equals(e.getXY(1))){const f=new nt({vd:e.getDescription()});return e.getPointByVal(0,f),f}{const f=new nt,g=new qt({vd:e.getDescription()});return e.getPointByVal(0,f),g.startPathPoint(f),e.getPointByVal(1,f),g.lineToPoint(f),g}}const i=e.getAttributeStreamRef(0),r=new Q1e({stream:i,n:s});let n=0,o=1;const a=i.readPoint2D(n<<1),l=new M;for(;o<s&&i.queryPoint2D(o<<1,l).equals(a);)o++;if(r.m_treeHull.addElement(n),o<s){r.m_treeHull.addBiggestElement(o);const f=new M;for(let g=o+1;g<e.getPointCount();g++){i.queryPoint2D(g<<1,f);const v=r.treeHull(f);v!==-1&&r.m_treeHull.setElement(v,g)}}const u=e.getDescription(),c=u.getAttributeCount()>1,h=r.m_treeHull.size();let m=null;if(h>=2){m=h>=3?new wt({vd:u}):new qt({vd:u});const f=m.getImpl();f.reserve(r.m_treeHull.size()),f.addPathPoint2D(null,0,!0);const g=new M;for(let v=r.m_treeHull.getFirst();v!==-1;v=r.m_treeHull.getNext(v))if(c){const b=new nt;e.getPointByVal(r.m_treeHull.getElement(v),b),f.insertPoint(0,-1,b)}else i.queryPoint2D(r.m_treeHull.getElement(v)<<1,g),f.insertPoint2D(0,-1,g)}else if(c){const f=new nt({vd:u});e.getPointByVal(r.m_treeHull.getElement(r.m_treeHull.getFirst()),f),m=f}else{const f=i.readPoint2D(r.m_treeHull.getElement(r.m_treeHull.getFirst())<<1);m=new nt(f)}return m}function Ere(t,e,s){if(e<=262144)return ast(t,e,s);F(0);const i=new Q1e({points:t,n:e}),r=0;let n=1;const o=t[r].clone();for(;n<e&&t[n].equals(o);)n++;if(i.m_treeHull.addElement(r),n<e){i.m_treeHull.addBiggestElement(n);for(let l=n+1;l<e;l++){const u=t[l],c=i.treeHull(u);c!==-1&&i.m_treeHull.setElement(c,l)}}let a=0;for(let l=i.m_treeHull.getFirst();l!==-1;l=i.m_treeHull.getNext(l))s[a++]=i.m_treeHull.getElement(l);return a}function Hbt(t,e,s){const i=t.getImpl(),r=i.getPathStart(e),n=i.getPathEnd(e),o=!i.isClosedPath(e)&&i.isClosedPathInXYPlane(e),a=i.getAttributeStreamRef(0),l=2*r;let u=2*n;if(o&&(u-=2),u-l<6)return!0;const c=a.readPoint2D(l),h=a.readPoint2D(l+2),m=a.readPoint2D(l+4);if(!Lf(M.orientationRobust(h,m,c)))return!1;const f=h.clone(),g=new M;for(let v=l+6;v<u;v+=2)if(g.assign(h),h.assign(m),a.queryPoint2D(v,m),!Lf(M.orientationRobust(h,m,c))||!Lf(M.orientationRobust(f,m,c))||!Lf(M.orientationRobust(h,m,g)))return!1;return!0}function Ybt(t,e,s,i,r){if(s.setNAN(),i.setCoords(1,0),r.setCoords(0,0),t.isEmpty())return;if(t.getGeometryType()===G.enumPoint)return void s.assign(t.getXY());const n=t,o=n.getPointCount();if(o===2){const a=n.getXY(0),l=n.getXY(1);s.assign(a.add(l).mul(.5));const u=l.sub(a);i=Pre(u),r.setCoords(.5*u.length(),0)}else{let a=Number.MAX_VALUE;const l=[0,1,0,0],u=new xJe(4,2);for(u.set(0,0,0),u.set(0,1,1),u.set(1,0,1),u.set(1,1,2);l[0]<o;++l[0],fL(u,0,o)){l[1]===l[0]&&(++l[1],fL(u,1,o));for(let v=1;;++v){for(;;){const b=ust(n.getXY(u.get(0,0)),n.getXY(u.get(0,1)),n.getXY(u.get(v,0)),n.getXY(u.get(v,1)),2^v);if(b>0||(++l[v],fL(u,v,o),b===0))break}if(v===3)break;l[v+1]<l[v]&&(l[v+1]=l[v],u.set(v+1,0,u.get(v,0)),u.set(v+1,1,u.get(v,1)))}const c=n.getXY(u.get(0,0)).add(n.getXY(u.get(2,0))).mul(.5),h=Pre(n.getXY(u.get(0,1)).sub(n.getXY(u.get(0,0)))),m=new M;let f,g;if(m.x=Math.max(0,h.dotProduct(n.getXY(u.get(1,0)).sub(n.getXY(u.get(3,0))))),m.y=Math.max(0,h.crossProduct(n.getXY(u.get(0,0)).sub(n.getXY(u.get(2,0))))),e?(f=m.x*m.y,g=f<a):(f=m.y,g=f<a),g){a=f;const v=n.getXY(u.get(1,0)),b=n.getXY(u.get(3,0)),w=v.add(b).mul(.5).sub(c);s.assign(c.add(h.mul(h.dotProduct(w)))),i.assign(h),r.assign(m)}}r.mulThis(.5),r.x<r.y&&(r.y=be(r.x,r.x=r.y),i.leftPerpendicularThis())}i.y<0?i.negateThis():i.y===0&&(i.x=1)}oi.st_defaultRank=1;let rst=class{constructor(e){this.m_handleP=-1,this.m_handleQ=-1,this.m_currentSupport=-1,this.m_area=0,this.m_bDone=!0,F(0),this.m_convexHull=e,this.m_function=this.done_}next(){return F(0),!1}get_vertex_handle_p(){return F(0),0}get_vertex_handle_q(){return F(0),0}get_current_support(){return F(0),0}getNext(e){return F(0),0}getPrev(e){return F(0),0}intialize_(){return F(0),!1}increment_(){return F(0),!1}increment_q_(){return F(0),!1}increment_p_(){return F(0),!1}parallel_edge_with_q_support_(){return F(0),!1}parallel_edge_with_p_support_(){return F(0),!1}done_(){return F(0),!1}},Q1e=class{nullGetXY(e){return Ce("m_getXY is null"),{}}nullDeleteNode(e){Ce("m_deleteNode is null")}constructor(e){return this.m_treeHull=new Xe,this.m_shape=null,this.m_stream=null,this.m_points=null,this.m_geometryHandle=-1,this.m_pathHandle=-1,this.m_getXY=this.nullGetXY,this.m_deleteNode=this.nullDeleteNode,e?e.stream?(this.m_treeHull.setCapacity(Math.min(20,e.n)),this.m_stream=e.stream,this.m_getXY=this.getXYStream,this.m_deleteNode=this.deleteNodeStream,this.m_points=null,this.m_geometryHandle=L,void(this.m_pathHandle=L)):e.points?(this.m_treeHull.setCapacity(Math.min(20,e.n)),this.m_points=e.points,this.m_getXY=this.getXYPoints,this.m_deleteNode=this.deleteNodePoints,this.m_stream=null,this.m_geometryHandle=L,void(this.m_pathHandle=L)):void Us("unrecognized constructor parameter"):(this.m_treeHull.setCapacity(20),this.m_shape=new oi,this.m_geometryHandle=this.m_shape.createGeometry(G.enumMultiPoint),this.m_pathHandle=this.m_shape.insertPath(this.m_geometryHandle,L),this.m_getXY=this.getXYShape,this.m_deleteNode=this.deleteNodeShape,this.m_stream=null,void(this.m_points=null))}getXYShape(e){return this.m_shape.getXY(e)}getXYStream(e){return this.m_stream.readPoint2D(e<<1)}getXYPoints(e){return F(0),new M}deleteNodeShape(e){const s=this.m_treeHull.getElement(e);this.m_treeHull.deleteNode(e),this.m_shape.removeVertex(s,!1)}deleteNodeStream(e){this.m_treeHull.deleteNode(e)}deleteNodePoints(e){F(0)}addGeometry(e){if(e.isEmpty())return;const s=e.getGeometryType();if(s===G.enumGeometryCollection){const i=e;for(let r=0,n=i.getGeometryCount();r<n;r++)this.addGeometry(i.getGeometry(r))}else zo(s)?this.addMultiVertexGeometry(e):zi(s)?this.addSegment(e):s===G.enumEnvelope?this.addEnvelope(e):s===G.enumPoint?this.addPoint(e):ee("Convex_hull: geometry not supported")}getBoundingGeometry(){const e=new nt,s=this.m_treeHull.getFirst(),i=new wt({vd:this.m_shape.getVertexDescription()});if(this.m_treeHull.size()===0)return i;i.reserve(this.m_treeHull.size()),this.m_shape.queryPoint(this.m_treeHull.getElement(s),e),i.startPathPoint(e);for(let r=this.m_treeHull.getNext(s);r!==-1;r=this.m_treeHull.getNext(r))this.m_shape.queryPoint(this.m_treeHull.getElement(r),e),i.lineToPoint(e);return i}getAntipodalPairsIterator(){return F(0),new rst(this)}getXY(e){return F(0),new M}getXYWithIndex(e){return F(0),new M}getFirst(){return F(0),0}getLast(){return F(0),0}getNext(e){return F(0),0}getPrev(e){return F(0),0}getVertexIndex(e){return F(0),0}getPointCount(){return F(0),0}addMultiVertexGeometry(e){const s=new nt,i=e.getImpl(),r=new M;for(let n=0;n<e.getPointCount();n++){i.queryXY(n,r);const o=this.addPoint2D(r);if(o!==-1){e.getPointByVal(n,s);const a=this.m_shape.addPoint(this.m_pathHandle,s);this.m_treeHull.setElement(o,a)}}}addEnvelope(e){const s=new nt;for(let i=0;i<4;i++){const r=new M;e.queryCorner(i,r);const n=this.addPoint2D(r);if(n!==-1){e.queryCornerByVal(i,s);const o=this.m_shape.addPoint(this.m_pathHandle,s);this.m_treeHull.setElement(n,o)}}}addSegment(e){const s=new nt,i=e.getStartXY(),r=this.addPoint2D(i);if(r!==-1){e.queryStart(s);const a=this.m_shape.addPoint(this.m_pathHandle,s);this.m_treeHull.setElement(r,a)}const n=e.getEndXY(),o=this.addPoint2D(n);if(o!==-1){e.queryEnd(s);const a=this.m_shape.addPoint(this.m_pathHandle,s);this.m_treeHull.setElement(o,a)}}addPoint(e){const s=e.getXY(),i=this.addPoint2D(s);if(i!==-1){const r=this.m_shape.addPoint(this.m_pathHandle,e);this.m_treeHull.setElement(i,r)}}addPoint2D(e){let s=-1;if(this.m_treeHull.size()===0)return s=this.m_treeHull.addElement(-4),s;if(this.m_treeHull.size()===1){const i=this.m_treeHull.getElement(this.m_treeHull.getFirst()),r=this.m_shape.getXY(i);return e.equals(r)||(s=this.m_treeHull.addBiggestElement(-5)),s}return s=this.treeHull(e),s}treeHull(e){let s=-1;do{const i=this.m_treeHull.getFirst(),r=this.m_treeHull.getLast(),n=this.m_treeHull.getElement(i),o=this.m_treeHull.getElement(r),a=this.m_getXY(n),l=this.m_getXY(o),u=M.orientationRobust(l,e,a);if(Lf(u)){s=this.m_treeHull.addBiggestElement(-1);const c=this.treeHullWalkBackward(e,r,i);c!==i&&this.treeHullWalkForward(e,i,this.m_treeHull.getPrev(c));break}if(Cre(u)){let c=this.m_treeHull.getRoot(),h=this.m_treeHull.getFirst(),m=this.m_treeHull.getLast(),f=-1,g=-1,v=-1;for(;h!==this.m_treeHull.getPrev(m);){g=this.m_treeHull.getElement(c);const S=this.m_getXY(g);Cre(M.orientationRobust(S,e,a))?(m=c,c=this.m_treeHull.getLeft(c)):(h=c,c=this.m_treeHull.getRight(c))}c=m,f=h,g=this.m_treeHull.getElement(c),v=this.m_treeHull.getElement(f);const b=this.m_getXY(g),w=this.m_getXY(v);if(f!==i&&!Lf(M.orientationRobust(w,e,b)))break;s=this.m_treeHull.addElementAtPosition(f,c,-2,!0,!1),this.treeHullWalkForward(e,c,r),this.treeHullWalkBackward(e,f,i);break}{const c=lst(e,l,a);if(c===-1){const h=this.m_treeHull.getPrev(r);this.m_treeHull.deleteNode(r),s=this.m_treeHull.addBiggestElement(-3),this.treeHullWalkBackward(e,h,i)}else if(c===1){const h=this.m_treeHull.getNext(i);this.m_treeHull.deleteNode(i),s=this.m_treeHull.addElementAtPosition(-1,h,-3,!0,!1),this.treeHullWalkForward(e,h,r)}break}}while(!1);return s}treeHullWalkForward(e,s,i){if(s===i)return i;let r=s,n=this.m_treeHull.getElement(r),o=this.m_treeHull.getNext(r);const a=this.m_getXY(n);for(;r!==i&&this.m_treeHull.size()>2;){const l=this.m_treeHull.getElement(o),u=this.m_getXY(l);if(Lf(M.orientationRobust(u,e,a)))break;const c=r;r=o,n=l,a.assign(u),o=this.m_treeHull.getNext(r),this.m_deleteNode(c)}return r}treeHullWalkBackward(e,s,i){if(s===i)return i;let r=s,n=this.m_treeHull.getElement(r),o=this.m_treeHull.getPrev(r);const a=this.m_getXY(n);for(;r!==i&&this.m_treeHull.size()>2;){const l=this.m_treeHull.getElement(o),u=this.m_getXY(l);if(Lf(M.orientationRobust(a,e,u)))break;const c=r;r=o,n=l,a.assign(u),o=this.m_treeHull.getPrev(r),this.m_deleteNode(c)}return r}};function nst(t,e,s){const i=e.sub(t),r=s.sub(e);if(i.x===0)return r.x>0?-1:0;if(i.y===0)return r.y>0?1:r.y<0?-1:0;const n=i.crossProduct(r),o=4*Number.EPSILON*(Math.abs(r.x*i.y)+Math.abs(r.y*i.x));return n>o?1:n<-o?-1:M.orientationRobust(t,e,s)}function ost(t,e,s){const i=e.sub(t),r=s.sub(e);if(i.x===0)return r.x<0?-1:0;if(i.y===0)return r.y>0?-1:r.y<0?1:0;const n=i.crossProduct(r),o=4*Number.EPSILON*(Math.abs(r.x*i.y)+Math.abs(r.y*i.x));return n>o?1:n<-o?-1:M.orientationRobust(t,e,s)}function ast(t,e,s){const i=new Qs(0);for(let a=0;a<e;a++)i.add(a);const r={userSort(a,l,u){u.sort(a,l,(c,h)=>t[c].compareX(t[h]))},getValue:a=>t[a].x};Jc.sortEx(i,0,e,r);let n=0;e:for(let a=0;a<e;++a){const l=i.read(a);for(;n>=2;){const u=s[n-2],c=s[n-1];if(t[c].equals(t[l])){i.write(a,-1);continue e}if(!(nst(t[u],t[c],t[l])>=0)){c===i.read(a-1)&&i.write(a-1,-1);break}n--}s[n++]=l,n===2&&t[l].equals(t[s[0]])&&(i.write(1,-1),n--)}const o=n+1;e:for(let a=e-2;a>=0;--a){const l=i.read(a);if(!(l<0)){for(;n>=o;){const u=s[n-2],c=s[n-1];if(t[c].equals(t[l]))continue e;if(!(ost(t[u],t[c],t[l])>=0))break;n--}if(a!==0){const u=s[n-1];s[n++]=l,t[l].equals(t[u])&&n--}}}return n>1&&t[s[0]].equals(t[s[n-1]])&&n--,n}function Lf(t){return t<0}function Cre(t){return t>0}function lst(t,e,s){let i=-1;e.y===s.y?i=0:e.x===s.x?i=1:i=Math.abs(e.x-s.x)>=Math.abs(e.y-s.y)?0:1;let r=-1;return r=e[i]<s[i]?t[i]<e[i]?-1:s[i]<t[i]?1:0:e[i]<t[i]?-1:t[i]<s[i]?1:0,r}function Pre(t){return(t=t.clone()).divThis(Math.max(Math.abs(t.x),Math.abs(t.y))),t.normalize(),t}function fL(t,e,s){t.inc(e,0)===s&&t.set(e,0,0),t.inc(e,1)===s&&t.set(e,1,0)}function ust(t,e,s,i,r){switch(r){case 0:break;case 1:e.rightPerpendicularThis(),t.rightPerpendicularThis();break;case 2:e.negateThis(),t.negateThis();break;case 3:e.leftPerpendicularThis(),t.leftPerpendicularThis();break;default:ee("")}return M.orientationRobustEx(t,e,s,i)}function Cx(t,e,s,i,r){return _R(t,!1,e,s,i,r)}function _R(t,e,s,i,r,n){const o=s.getGeometryType(),a=i.getGeometryType(),l=Math.max(r,jo(s,i));if(o===G.enumLine&&a===G.enumLine)return X8(s,i,l,n);let u=s,c=i,h=s.getStartXY(),m=s.getEndXY();if(h.compare(m)>0&&(u=s.clone().reverse()),h=i.getStartXY(),m=i.getEndXY(),h.compare(m)>0&&(c=i.clone().reverse()),e){if(s.equals(i))return 2;if(vKe(s,i,l))return 4}switch(o){case G.enumLine:switch(a){case G.enumEllipticArc:return vre(t,c,u,l,n);case G.enumBezier:return rre(t,c,u,l,n);case G.enumRationalBezier2:return Hie(t,c,u,l,n);case G.enumBezier2:return ere(t,c,u,l,n);default:Ce("")}break;case G.enumEllipticArc:switch(a){case G.enumLine:return vre(t,u,c,l,n);case G.enumEllipticArc:return Qtt(t,u,c,l,n);case G.enumBezier:return nre(t,c,u,l,n);case G.enumRationalBezier2:return Yie(t,c,u,l,n);case G.enumBezier2:return tre(t,c,u,l,n);default:Ce("")}break;case G.enumBezier:switch(a){case G.enumLine:return rre(t,u,c,l,n);case G.enumEllipticArc:return nre(t,u,c,l,n);case G.enumBezier:return ftt(t,u,c,l,n);case G.enumRationalBezier2:return ore(t,u,c,l,n);case G.enumBezier2:return are(t,u,c,l,n);default:Ce("")}break;case G.enumRationalBezier2:switch(a){case G.enumLine:return Hie(t,u,c,l,n);case G.enumEllipticArc:return Yie(t,u,c,l,n);case G.enumBezier:return ore(t,c,u,l,n);case G.enumRationalBezier2:return Cet(t,u,c,l,n);case G.enumBezier2:return Xie(t,u,c,l,n);default:Ce("")}break;case G.enumBezier2:switch(a){case G.enumLine:return ere(t,u,c,l,n);case G.enumEllipticArc:return tre(t,u,c,l,n);case G.enumBezier:return are(t,c,u,l,n);case G.enumRationalBezier2:return Xie(t,c,u,l,n);case G.enumBezier2:return Get(t,u,c,l,n);default:Ce("")}break;default:Ce("")}}function Ea(t,e,s=!0){if(!s&&!J1e(t,e))return 0;const i=t.isLine()&&e.isLine();if(t.getStartXY().equals(e.getStartXY())&&t.getEndXY().equals(e.getEndXY())){if(i)return 1;const n=t.getGeometryType();if(n!==e.getGeometryType())return 0;if(n===G.enumBezier){const o=t,a=e;return o.getControlPoint1().equals(a.getControlPoint1())&&o.getControlPoint2().equals(a.getControlPoint2())?1:0}if(n===G.enumEllipticArc)return wre(t,e,!1)?1:0;if(n===G.enumRationalBezier2){const o=t,a=e;if(o.getControlPoint1().equals(a.getControlPoint1())&&o.getStandardFormWeight()===a.getStandardFormWeight())return 1}else if(n===G.enumBezier2){const o=e;if(t.getControlPoint1().equals(o.getControlPoint1()))return 1}return 0}if(t.getStartXY().equals(e.getEndXY())&&t.getEndXY().equals(e.getStartXY())){if(i)return-1;const n=t.getGeometryType();if(n!==e.getGeometryType())return 0;if(n===G.enumBezier){const o=t,a=e;return o.getControlPoint1().equals(a.getControlPoint2())&&o.getControlPoint2().equals(a.getControlPoint1())?-1:0}if(n===G.enumEllipticArc)return wre(t,e,!0),-1;if(n===G.enumRationalBezier2){const o=t,a=e;if(o.getControlPoint1().equals(a.getControlPoint1())&&o.getStandardFormWeight()===a.getStandardFormWeight())return-1}else if(n===G.enumBezier2){const o=e;if(t.getControlPoint1().equals(o.getControlPoint1()))return-1}return 0}return 0}function J1e(t,e){const s=t.getGeometryType();return s===e.getGeometryType()&&(s!==G.enumEllipticArc||t.projectionBehavior()===e.projectionBehavior())}function C0(t,e,s,i,r,n,o){!r&&n&&ee("");const a=e.getGeometryType(),l=s.getGeometryType(),u=Math.max(o,jo(e,s));if(i&&(i.length=0),r&&(r.length=0),n&&(n.length=0),a===G.enumLine&&l===G.enumLine)return dR(e,s,i,r,n,u,!1,!1);let c=e,h=s,m=e.getStartXY(),f=e.getEndXY(),g=!1,v=!1;m.compare(f)>0&&(c=e.clone(!0).reverse(),g=!0),m=s.getStartXY(),f=s.getEndXY(),m.compare(f)>0&&(h=s.clone(!0).reverse(),v=!0);let b=0;switch(a){case G.enumLine:switch(l){case G.enumEllipticArc:b=xC(t,h,c,i,n,r,u,!1,!1,!0);break;case G.enumBezier:b=_C(t,h,c,i,n,r,u,!1,!1,!0);break;case G.enumRationalBezier2:b=i0(t,h,c,i,n,r,u,!1,!1,!0);break;case G.enumBezier2:b=pC(t,h,c,i,n,r,u,!1,!1,!0);break;default:Ce("")}break;case G.enumEllipticArc:switch(l){case G.enumLine:b=xC(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumEllipticArc:b=X1e(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumBezier:b=fG(t,h,c,i,n,r,u,!1,!1,!0);break;case G.enumRationalBezier2:b=iG(t,h,c,i,n,r,u,!1,!1,!0);break;case G.enumBezier2:b=dG(t,h,c,i,n,r,u,!1,!1,!0);break;default:Ce("")}break;case G.enumRationalBezier2:switch(l){case G.enumLine:b=i0(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumEllipticArc:b=iG(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumBezier:b=gG(t,h,c,i,n,r,u,!1,!1,!0);break;case G.enumRationalBezier2:b=lC(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumBezier2:b=rG(t,c,h,i,r,n,u,!1,!1,!1);break;default:Ce("")}break;case G.enumBezier2:switch(l){case G.enumLine:b=pC(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumEllipticArc:b=dG(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumBezier:b=yG(t,h,c,i,n,r,u,!1,!1,!0);break;case G.enumRationalBezier2:b=rG(t,h,c,i,n,r,u,!1,!1,!0);break;case G.enumBezier2:b=F9(t,c,h,i,r,n,u,!1,!1,!1);break;default:Ce("")}break;case G.enumBezier:switch(l){case G.enumLine:b=_C(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumEllipticArc:b=fG(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumBezier:b=q9(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumRationalBezier2:b=gG(t,c,h,i,r,n,u,!1,!1,!1);break;case G.enumBezier2:b=yG(t,c,h,i,r,n,u,!1,!1,!1);break;default:Ce("")}break;default:Ce("")}if(g){if(r){for(let w=0;w<b;w++)r[w]=1-r[w];r.reverse()}i&&i.reverse(),n&&n.reverse()}if(v&&n)for(let w=0;w<b;w++)n[w]=1-n[w];return b}function dM(t,e,s){return e===s?0:(e>s&&(s=be(e,e=s)),t.cut(e,s,!0).calculateUpperLength2D())}function cst(t,e,s,i,r){const n=[],o=[],a=[];for(let u=0,c=r;u<c;u++)n.push(t.calculateSubLengthFromStart(s[u])),o.push(e.calculateSubLengthFromStart(i[u])),bs(s[u],0,1)&&bs(i[u],0,1)&&t.getCoord2D(s[u]).equals(e.getCoord2D(i[u]))&&a.push(u);if(a.length===0||a.length===r)return;a.sort((u,c)=>s[u]<s[c]?-1:s[u]>s[c]?1:i[u]<i[c]?-1:i[u]>i[c]?1:0);let l=-1;for(const u of a){if(l>=0&&s[u]===s[l]&&s[u]===s[l]){l=u;continue}l=u;const c=[];c.length=r;for(let h=0;h<c.length;++h)c[h]=h;c.sort((h,m)=>{const f=n[u],g=o[u],v=n[h]-f,b=o[h]-g,w=v*v+b*b,S=n[m]-f,T=o[m]-g,P=S*S+T*T;return w<P?-1:w>P?1:0});for(let h=0;h<r;h++){const m=c[h];if(m===u||s[m]===s[u]&&i[m]===i[u]||bs(s[m],0,1)&&bs(i[m],0,1))continue;const f=(A,D,k,R)=>{const O=new je,z=new le;z.setWithEps(1);const q=new le;q.set(D,z.eps()),t.queryCoord2DE(q,O);const U=new je;t.queryCoord2DE(new le(A),U);let V=!1;return O.eq(U)&&(q.set(R,z.eps()),e.queryCoord2DE(q,O),e.queryCoord2DE(new le(k),U),V=O.eq(U)),!V},g=M.getNAN();t.queryCoord2D(s[m],g);const v=M.getNAN();if(e.queryCoord2D(i[m],v),M.distance(g,v)===0&&f(s[u],s[m],i[u],i[m]))break;const b=new de(i[m],i[u]);b.normalizeNoNAN();const w=new de(s[m],s[u]);w.normalizeNoNAN();let S=-1,T=Number.POSITIVE_INFINITY,P=Number.POSITIVE_INFINITY,I=s[m];g.assign(t.getCoord2D(I));for(let A=0;A<5;A++){const D=e.getClosestCoordinateOnInterval(g,b,-1);v.assign(e.getCoord2D(D));const k=M.distance(g,v);if(I=t.getClosestCoordinateOnInterval(v,w,-1),I===s[u]&&D===i[u]){S=1;break}g.assign(t.getCoord2D(I));const R=M.distance(v,g);if(!(R<P&&k<T)){S=0;break}if(R===0&&k===0){f(s[u],s[m],i[u],i[m])?(s[m]=I,i[m]=D,S=0):S=1;break}P=R,T=k}if(S===-1&&(S=bs(s[m],0,1)||bs(i[m],0,1)?0:1),S!==1)break;s[m]=s[u],i[m]=i[u]}}}function ol(t,e,s,i,r,n,o,a,l,u,c,h,m){if(!n)return 0;const f=(w,S)=>{for(let T=0;T<n;++T){let P=S[T];if(bs(P,0,1)){P=U0e(P);continue}const I=w.getCoord2D(P);P<.5?I.equals(w.getStartXY())&&dM(w,0,P)<=Bh(w)&&(S[T]=0):I.equals(w.getEndXY())&&dM(w,P,1)<=Bh(w)&&(S[T]=1)}};f(e,i),f(s,r),cst(e,s,i,r,n);const g=[];for(let w=0,S=n;w<S;w++)g.push(w);const v=(w,S)=>m?uie(r[w],i[w],r[S],i[S]):uie(i[w],r[w],i[S],r[S]);if(g.length>1){g.sort(v);const w=Math.max(Bh(e),Bh(s));let S=0;for(let T=1,P=g.length;T<P;T++){const I=i[g[S]],A=i[g[T]],D=r[g[S]],k=r[g[T]];if(I!==A||D!==k)if(!(dM(e,I,A)<=w&&dM(s,D,k)<=w)||bs(I,0,1)&&bs(D,0,1)||bs(A,0,1)&&bs(k,0,1))S++,g[S]=g[T];else{const R=M.distance(e.getCoord2D(I),s.getCoord2D(D)),O=M.distance(e.getCoord2D(A),s.getCoord2D(k));if(R<=O)continue;if(O<R){g[S]=g[T];continue}}}if(g.length=S+1,g.length===1&&g[0]!==0&&(i[0]=i[g[0]],r[0]=r[g[0]],g[0]=0),g.length>2){const T=de.constructEmpty(),P=de.constructEmpty();T.setCoords(i[g[0]],i[g.at(-1)]),P.setCoords(r[g[0]],r[g.at(-1)]);let I=!0;for(let A=1,D=g.length-1;A<D;A++)if(!T.containsCoordinate(i[g[A]])||!P.containsCoordinate(r[g[A]])){I=!1;break}if(I){const A=[.5,.2,.7,.1,.3,.4,.6,.8,.9];for(let D=0;D<A.length;D++){let k=zt(T.vmin,T.vmax,A[D]);const R=e.getCoord2D(k);if(!s.isCloserThanDistance(R,P,u)){I=!1;break}k=zt(P.vmin,P.vmax,A[D]);const O=s.getCoord2D(k);if(!e.isCloserThanDistance(O,T,u)){I=!1;break}}}I&&(g[1]=g.at(-1),g.length=2)}}if(g.length===1&&t&&NS(e,s,i[0],r[0],u,1,[0],[0])&&(g.push(1),i[1]=0,r[1]=0,g.sort(v)),c&&g.length===1){let w=!0;for(let S=0,T=g.length;S<T;S++)if(!(bs(i[g[S]],0,1)&&bs(r[g[S]],0,1)&&M.distance(e.getCoord2D(i[g[S]]),s.getCoord2D(r[g[S]]))===0)){w=!1;break}if(w)return 0}let b=0;for(let w=0,S=g.length;w<S;w++){if(a&&a.push(i[g[w]]),l&&l.push(r[g[w]]),o){const T=M.getNAN();e.queryCoord2D(i[g[w]],T),o.push(T)}b++}return b}function pM(t,e,s,i,r,n,o,a,l){if(bs(s,0,1)&&bs(i,0,1)&&M.distance(t.getCoord2D(s),e.getCoord2D(i))===0){const c=new je,h=Number.EPSILON;if(t.queryDerivative(new le(s,h),c),c.isTrueZero()){const b=s===1?-1e-12:1e-12;t.queryDerivative(new le(s,h).add(b),c)}s===1&&c.negateThis();const m=new je;if(e.queryDerivative(new le(i,h),m),m.isTrueZero()){const b=s===1?-1e-12:1e-12;e.queryDerivative(new le(i,h).add(b),m)}i===1&&m.negateThis(),c.isZero()||c.normalize(),m.isZero()||m.normalize();const f=c.dotProduct(m),g=c.crossProduct(m);g.scaleError(3);const v=()=>{if(l)return .001;{const b=t.calculateUpperLength2D(),w=e.calculateUpperLength2D();return Math.min(.01*r/Math.min(b,w),1e-10)}};if(f.ge(bx)&&(g.isZero()||Math.abs(g.value())<v()))return Q0e(t,e,s,i,r,n,o,a)}return 0}function Px(t,e,s,i,r){let n=-1,o=-1,a=-1,l=-1;{const u=[0,e],c=[e,0],h=[0,i],m=[i,0];for(let f=0;f<2&&n===-1;++f)for(let g=0;g<2;++g)if(t[u[f]].equals(s[h[g]])){n=u[f],o=c[f],a=h[g],l=m[g];break}}if(n===-1){const u=new Yn;u.setFromPoints(t,e+1);const c=new Yn;return c.setFromPoints(s,i+1),c.inflate(r),u.isIntersectingW(c)?-1:0}{const u=Me(e+1,Number.NaN),c=Ere(t,e+1,u);F(c>1);let h=0,m=0;for(let k=0;k<c;++k)n===u[k]&&(m=k,h++),o===u[k]&&h++;if(h!==2)return-1;const f=Me(i+1,Number.NaN),g=Ere(s,i+1,f);F(g>1),h=0;let v=0;for(let k=0;k<g;++k)a===f[k]&&(v=k,h++),l===f[k]&&h++;if(h!==2)return-1;const b=t[u[(m+c-1)%c]],w=t[u[(m+1)%c]],S=s[f[(v+g-1)%g]],T=s[f[(v+1)%g]],P=t[n],I=[b,w,S,T],A=[0,1,2,3];A.sort((k,R)=>M.compareVectorsOrigin(P,I[k],I[R]));let D=A[0];for(let k=1;k<4;k++){if(A[k]!==(D+1)%4)return-1;D=A[k]}{const k=b.sub(P),R=T.sub(P),O=R.dotProduct(k);if(O>0){const z=R.crossProduct(k),q=Math.abs(Math.atan2(z,O)),U=q*k.length(),V=q*R.length();if(U<=r||V<=r)return-1}}{const k=w.sub(P),R=S.sub(P),O=R.dotProduct(k);if(O>0){const z=R.crossProduct(k),q=Math.abs(Math.atan2(z,O)),U=q*k.length(),V=q*R.length();if(U<=r||V<=r)return-1}}return 1}}var fM=Es;let pt=class lN extends CKe{constructor(e){super(e||{XStart:0,YStart:0,XEnd:0,YEnd:0})}assignMove(e){return this!==e&&(this.m_description=e.m_description,e.m_description=null,this.m_attributes=e.m_attributes,e.m_attributes=null,this.m_XStart=e.m_XStart,e.m_XStart=Number.NaN,this.m_YStart=e.m_YStart,this.m_XEnd=e.m_XEnd,e.m_XEnd=Number.NaN,this.m_YEnd=e.m_YEnd),this}assignCopy(e){return this!==e&&e.copyTo(this),this}calculateLowerLength3D(){return F(0),0}calculateUpperLength3D(){return F(0),0}changeEndPoints3D(e,s){F(0)}getClosestCoordinate3D(e,s,i){return F(0),0}getBoundary(){return Bc(this)}getAttributeAsDbl(e,s,i){if(s===0)return i===0?nM(this,e):oL(this,e);const r=fM.getInterpolation(s),n=this.getStartAttributeAsDbl(s,i),o=this.getEndAttributeAsDbl(s,i);return _P(r,n,o,e,fM.getDefaultValue(s))}constructFromCoords(e,s,i,r){this.dropAllAttributes(),this.setStartXYCoords(e,s),this.setEndXYCoords(i,r)}construct(e,s){this.dropAllAttributes(),this.setStartXY(e),this.setEndXY(s)}construct3D(e,s){F(0)}constructPoint(e,s){this.assignVertexDescription(e.getDescription()),this.mergeVertexDescription(s.getDescription()),this.setStart(e),this.setEnd(s)}getGeometryType(){return lN.type}queryEnvelope(e){if(e.m_EnvelopeType===4){e.setEmpty(),e.assignVertexDescription(this.m_description);const s=X.constructEmpty();this.queryEnvelope(s),e.setEnvelope(s);for(let i=1,r=this.m_description.getAttributeCount();i<r;i++){const n=this.m_description.getSemantics(i);for(let o=0,a=fM.getComponentCount(n);i<a;i++){const l=this.queryInterval(n,o);e.setIntervalEnvelope(n,o,l)}}}else e.m_EnvelopeType===2?e.setCoords({xmin:this.m_XStart,ymin:this.m_YStart,xmax:this.m_XEnd,ymax:this.m_YEnd}):e.m_EnvelopeType===3?(e.setEmpty(),e.mergeCoords(this.m_XStart,this.m_YStart,$c(this,0,1,0)),e.mergeCoords(this.m_XEnd,this.m_YEnd,$c(this,1,1,0))):yt("env type not impl")}applyTransformation(e){F(e instanceof Rt);const s=new M;s.x=this.m_XStart,s.y=this.m_YStart,e.transformInPlace(s),this.m_XStart=s.x,this.m_YStart=s.y,s.x=this.m_XEnd,s.y=this.m_YEnd,e.transformInPlace(s),this.m_XEnd=s.x,this.m_YEnd=s.y}createInstance(){return new lN({vd:this.m_description})}calculateLength2D(){return Math.sqrt(W8(this))}calculateLength3D(e){return F(0),0}changeEndPoints2D(e,s){this.setStartXY(e),this.setEndXY(s),this.normalizeAfterEndpointChange()}queryCoord2D(e,s){return ga(this,e,s)}queryCoord3D(e,s){F(0)}getCoordZ(e){return PKe(this,e)}queryCoord2DE(e,s){e1e(this,e,s)}getCoordX(e){return nM(this,e)}getCoordY(e){return oL(this,e)}cut(e,s,i){const r=new ut;return this.queryCut(e,s,r,i),r.releaseSegment()}queryCut(e,s,i,r){const n=i.createLine();r&&n.assignVertexDescription(this.m_description);const o=M.getNAN();if(ga(this,e,o),n.setStartXYCoords(o.x,o.y),ga(this,s,o),n.setEndXYCoords(o.x,o.y),!r)for(let a=1,l=this.m_description.getAttributeCount();a<l;a++){const u=this.m_description.getSemantics(a),c=fM.getComponentCount(u);for(let h=0;h<c;h++){const m=this.getAttributeAsDbl(e,u,h);n.setStartAttribute(u,h,m);const f=this.getAttributeAsDbl(s,u,h);n.setEndAttribute(u,h,f)}}}queryDerivative(e,s){TKe(this,e,s)}getClosestCoordinate(e,s){return M.getClosestCoordinate(this.getStartXY(),this.getEndXY(),e,s)}getClosestCoordinateOnInterval(e,s,i=-1){const r=new M;this.queryCoord2D(s.vmin,r);const n=new M;this.queryCoord2D(s.vmax,n);const o=M.getClosestCoordinate(r,n,e,!1);return SP.recalculateParentT(s.vmin,s.vmax,o)}intersectionOfYMonotonicWithAxisX(e,s){const i=this.m_YEnd-this.m_YStart;if(!i)return e===this.m_YEnd?s:Number.NaN;const r=(e-this.m_YStart)/i;let n=nM(this,r);return r===1&&(n=this.m_XEnd),n}isCurve(){return!1}isMonotoneQuickAndDirty(){return!0}isDegenerate(e){const s=this.m_XStart-this.m_XEnd,i=this.m_YStart-this.m_YEnd;return Math.sqrt(s*s+i*i)<=e}isDegenerate3D(e,s){return F(0),!1}queryLooseEnvelope(e){this.queryEnvelope(e)}clone(e){const s=new lN;return this.copyTo(s),s}tToLength(e){return e*this.calculateLength2D()}lengthToT(e){const s=this.calculateLength2D();return s!==0?e/s:0}calculateWeightedAreaCentroid2D(e){const s=new M;return s.setCoords(0,0),s}calculateWeightedCentroid2D(){return this.getCoord2D(.5).mul(this.calculateLength2D())}getTangent(e){const s=M.getNAN();return s.setSub(this.getEndXY(),this.getStartXY()),s}getDerivative(e){const s=new M;return s.setSub(this.getEndXY(),this.getStartXY()),s}getCurvature(e){return 0}isIntersectingPoint(e,s,i){return Lv(this,e,s,i)>=0}isIntersectingPoint3D(e,s,i,r,n=1){return F(0),!1}getYMonotonicParts(e,s){return 0}getMonotonicParts(e,s){return 0}getMonotonicPartParams(e,s){return s&&(e<2&&ee(""),s[0]=0,s[1]=1),2}intersectionWithAxis2D(e,s,i,r){if(e){const n=this.m_YEnd-this.m_YStart;if(!n)return s===this.m_YEnd?-1:0;const o=(s-this.m_YStart)/n;return o<0||o>1?0:(i&&(i[0]=nM(this,o)),r&&(r[0]=o),1)}{const n=this.m_XEnd-this.m_XStart;if(!n)return s===this.m_XEnd?-1:0;const o=(s-this.m_XStart)/n;return o<0||o>1?0:(i&&(i[0]=oL(this,o)),r&&(r[0]=o),1)}}calculateUpperLength2D(){return this.calculateLength2D()}calculateLowerLength2D(){return this.calculateLength2D()}normalizeAfterEndpointChange(){return!1}queryLooseEnvelopeOnInterval(e,s){if(s.m_EnvelopeType===2){let i=ys(e.vmin,0,1);const r=new M;return this.queryCoord2D(i,r),s.setCoords({pt:r}),i=ys(e.vmax,0,1),this.queryCoord2D(i,r),void s.mergeNe(r)}yt("3d dst not impl")}orientBottomUp(){t1e(this)}isLine(){return!0}isDegenerateToLineHelper(e){return!0}copyIgnoreAttributes(e){e.setStartXY(this.getStartXY()),e.setEndXY(this.getEndXY()),e.normalizeAfterEndpointChange()}calculateArea2DHelper(){return 0}absNormXYZ(e){return IKe(this,e)}absNorm(){return this.getStartXY().norm(1)+this.getEndXY().norm(1)}queryEnvelopeW(e,s){s.setCoords(this.getCoord2D(e.vmin)),s.mergeNe(this.getCoord2D(e.vmax))}setSegmentFromCoords(e,s){Iie(this,e[0],e[s-1])}writeInBufferStream(e,s){return F(0),0}readFromBufferStream(e,s){F(0)}snapControlPoints(e){return!1}needsSnapControlPoints(e){return!1}calculateSpecialPointsForCracking(e,s){return 0}ensureXYMonotone(){return!1}setCoordsForIntersector(e,s,i){Iie(this,e,s)}static isIntersectingLineLine(e,s,i,r){return X8(e,s,i,r)}static isIntersectingLineLine_(e,s,i,r){return X8(e,s,i,r)}copyToImpl(e){}reverseImpl(){}equalsImpl(e){return!0}equalsImplTol(e,s){return!0}swapImpl(e){}afterCompletedModification(){}endPointModified(){}clearEndPointModified(){}intersect(e,s,i,r,n){return C0(!1,this,e,s,i,r,n)}intersectPoint(e,s,i){s.length<1&&bt("");const r=Lv(this,e,i,!1);return r>=0?(s&&(s[0]=r),1):0}isIntersecting(e,s,i){return Cx(!1,this,e,s,i)!==0}};pt.type=G.enumLine;let ut=class uN{constructor(e){this.m_seg=null,this.m_curves=null,this.m_lineBuffer=new pt,this.m_mask=0,this.m_active=0,e!==void 0&&(e.copy?e.copy.copyTo(this,!1):e.move?this.assignMove(e.move):e.segment?this.copyFrom(e.segment,!!e.bIgnoreAttributes):Ce("bad constructor params"))}assignCopy(e){return e instanceof uN?this!==e&&e.copyTo(this,!1):this.copyFrom(e,!1),this}assignMove(e){if(e instanceof uN){if(this===e)return this;this.reset(),1&e.m_mask&&(this.m_lineBuffer=e.m_lineBuffer,e.m_lineBuffer=null,this.m_mask=1),this.m_curves=e.m_curves,this.m_mask=e.m_mask,this.m_active=e.m_active,e.reset(),this.m_seg=this.activeSegment(),e.m_seg=null}else{if(this.m_seg===e)return this;this.create(e.getGeometryType()),this.m_seg.swap(e)}return this}activeSegment(){switch(this.m_active){case 0:return null;case 1:return this.line();case 2:return this.arc();case 4:return this.bezier3();case 8:return this.bezier2();case 16:return this.rbezier2();default:Ce("")}}get(){return this.m_seg}reset(){1&this.m_mask&&(this.m_lineBuffer=null),this.m_mask>1&&(this.m_curves=null),this.m_mask=0,this.m_active=0}empty(){return this.m_seg===null}copyTo(e,s){this!==e&&(this.empty()?e.m_seg=null:e.copyFrom(this.m_seg,s))}copyToWithZ(e,s){F(0)}createImpl(e){switch(e){case G.enumLine:1&this.m_mask||(this.m_lineBuffer=new pt,this.m_mask|=1,this.m_active=1);break;case G.enumEllipticArc:2&this.m_mask||(this.m_curves=new Kc,this.m_mask=1&this.m_mask|2,this.m_active=2);break;case G.enumBezier:4&this.m_mask||(this.m_curves=new Hl,this.m_mask=1&this.m_mask|4,this.m_active=4);break;case G.enumBezier2:8&this.m_mask||(this.m_curves=new t0,this.m_mask=1&this.m_mask|8,this.m_active=8);break;case G.enumRationalBezier2:16&this.m_mask||(this.m_curves=new Oo,this.m_mask=1&this.m_mask|16,this.m_active=16);break;default:ee("")}}create(e){e===G.enumLine?this.createLine():e===G.enumEllipticArc?this.createEllipticArc():e===G.enumBezier?this.createCubicBezier():e===G.enumRationalBezier2?this.createQuadraticRationalBezier():e===G.enumBezier2?this.createQuadraticBezier():ee("Segment_buffer.create")}copyFrom(e,s){this.m_seg!==e&&(this.create(e.getGeometryType()),s?e.copyIgnoreAttributes(this.m_seg):e.copyTo(this.m_seg))}copyFromWithZ(e,s){F(0)}line(){return this.m_lineBuffer}arc(){return this.m_curves}bezier3(){return this.m_curves}bezier2(){return this.m_curves}rbezier2(){return this.m_curves}createLine(){return this.createImpl(G.enumLine),this.m_seg=this.line(),this.line()}createEllipticArc(){return this.createImpl(G.enumEllipticArc),this.m_seg=this.arc(),this.arc()}createCubicBezier(){return this.createImpl(G.enumBezier),this.m_seg=this.bezier3(),this.bezier3()}createQuadraticRationalBezier(){return this.createImpl(G.enumRationalBezier2),this.m_seg=this.rbezier2(),this.rbezier2()}createQuadraticBezier(){return this.createImpl(G.enumBezier2),this.m_seg=this.bezier2(),this.bezier2()}releaseSegment(){if(this.m_seg=null,this.m_active===0&&Ce("releaseSegment"),1&this.m_active){const s=this.line();return this.m_mask-=1,this.m_active=0,this.m_lineBuffer=null,s}let e;return 2&this.m_active?e=this.arc():4&this.m_active?e=this.bezier3():8&this.m_active?e=this.bezier2():16&this.m_active?e=this.rbezier2():Ce("releaseSegment"),this.m_mask-=this.m_active,this.m_active=0,this.m_curves=null,e}equals(e){return e instanceof uN?this===e||(this.empty()?e.empty():!e.empty()&&this.get().equals(e.get())):(yt("seg comparison not yet impl"),!1)}};function ps(t,e,s,i,r){return K1e(t,e,null,s,i,r)}function K1e(t,e,s,i,r,n){const o=t.getGeometryType();if(o===G.enumPoint){const c=t.getXY();return e.contains(c)?t:t.createInstance()}if(o===G.enumEnvelope){const c=X.constructEmpty();if(t.queryEnvelope(c),c.intersect(e)){const h=t.clone();return h.setEnvelope(c),h}return t.createInstance()}if(t.isEmpty())return t;if(e.isEmpty())return t.createInstance();const a=e.clone();{const c=new X;if(t.queryLooseEnvelope(c),a.containsEnvelope(c))return t;if(!a.isIntersecting(c))return t.createInstance();r===0&&(c.intersect(a),c.inflate(Math.max(.1*c.maxDimension(),1)),c.intersect(a),a.assign(c))}let l=i;if((s!==null||Number.isNaN(l))&&(l=Ji(s,a,!1).total()),o===G.enumGeometryCollection){const c=t,h=t.createInstance();for(let m=0,f=c.getGeometryCount();m<f;m++){const g=c.getGeometry(m);if(g.isEmpty())continue;const v=ps(g,a,l,r,n);v.isEmpty()||(v===g?h.addGeometry(v.clone()):h.addGeometry(v))}return h}zo(o)||ee("Clip: geometry not supported");const u=t.getImpl().getAccelerators();if(u!==null){const c=u.getRasterizedGeometry();F(c===null)}switch(o){case G.enumMultiPoint:{const c=t;let h;const m=c.getPointCount(),f=c.getImpl().getAttributeStreamRef(0);let g=0;for(let v=0;v<m;v++){const b=f.readPoint2D(2*v);a.contains(b)||(g===0&&(h=c.createInstance()),g<v&&h.addPoints(c,g,v),g=v+1)}return g>0&&h.addPoints(c,g,m),g===0?c:(F(h!==null),h)}case G.enumPolygon:case G.enumPolyline:return mst(t,a,l,r,n);default:Ce("")}}function hst(t,e,s,i,r,n){const o=new eve(e,n),a=new X;return t.queryLooseEnvelope(a),e.containsEnvelope(a)?t:e.isIntersecting(a)?o.clipPolesOut(t,r):t.createInstance()}function mst(t,e,s,i,r){return new eve(e,r).clipMultiPath2(t,s,i)}let eve=class Ec{constructor(e,s){this.m_shape=new oi,this.m_geometry=L,this.m_verticesOnExtentIndex=-1,this.m_verticesOnExtent=[],this.m_progressCounter=0,this.m_extent=new X(e),this.m_progressTracker=s}progress_(){}clipMultiPath2(e,s,i){return e.getGeometryType()===G.enumPolygon?this.clipPolygonOrProjectedPolyline2(e,i):this.clipPolyline(e,s)}clipPolygonOrProjectedPolyline2(e,s){const i=e.getGeometryType()===G.enumPolyline;if(this.m_extent.width()===0||this.m_extent.height()===0)return e.createInstance();const r=X.constructEmpty();e.queryLooseEnvelope(r),this.m_geometry=i?this.m_shape.addGeometry(e):this.m_shape.addGeometry(e,this.m_extent);const n=X.constructEmpty(),o=X.constructEmpty(),a=new M,l=new M,u=Me(9,Number.NaN),c=Me(9,Number.NaN),h=ne(M,9);let m=null;const f=new pt,g=[];let v=!1;for(let w=0;!v&&w<4;w++){let S=!1;const T=!!(1&w);let P=0;switch(w){case 0:P=this.m_extent.xmin,S=r.xmin<=P&&r.xmax>=P;break;case 1:P=this.m_extent.ymin,S=r.ymin<=P&&r.ymax>=P;break;case 2:P=this.m_extent.xmax,S=r.xmin<=P&&r.xmax>=P;break;case 3:P=this.m_extent.ymax,S=r.ymin<=P&&r.ymax>=P}if(S){v=!0;for(let I=this.m_shape.getFirstPath(this.m_geometry);I!==L;){let A=!0,D=-1,k=-1;const R=this.m_shape.getFirstVertex(I);let O=R;do{this.progress_(),m=this.m_shape.getSegment(O);let z=m;if(z===null){const B=this.m_shape.getNextVertex(O);if(B===L){F(i),D===0&&g.push(O);break}this.m_shape.queryXY(O,a),f.setStartXY(a),this.m_shape.queryXY(B,l),f.setEndXY(l),z=f}z.queryLooseEnvelope(n);let q=Ec.checkSegmentIntersection(n,w,P);z.isCurve()&&q===0&&z.isCurve()&&(f.setStartXY(z.getStartXY()),f.setEndXY(z.getEndXY()),this.m_shape.replaceCurveWithLine(O),z=f,f.queryEnvelope(n),q=Ec.checkSegmentIntersection(n,w,P));let U=0,V=L;if(q===-1){const B=z.intersectionWithAxis2D(T,P,u,c);if(B>0){let ie=null;if(z.isCurve()){ie=h,F(B<=9);for(let se=0;se<B;se++)T?h[se].setCoords(u[se],P):h[se].setCoords(P,u[se]);U=this.m_shape.splitSegmentAxisAware(O,c,B,ie,T?1:0)}else U=this.m_shape.splitSegmentAxisAware(O,c,B,null,-1)}else U=0;U+=1;let H=O,W=this.m_shape.getNextVertex(H);z=null;for(let ie=0;ie<U;ie++){this.m_shape.queryXY(H,a),this.m_shape.queryXY(W,l),m=this.m_shape.getSegment(H);let se=m;se===null&&(f.setStartXY(a),f.setEndXY(l),se=f),se.queryEnvelope(o);let Z=Ec.checkSegmentIntersection(o,w,P);se.isCurve()&&Z===0&&(this.m_shape.replaceCurveWithLine(H),f.setStartXY(a),f.setEndXY(l),se=f,se.queryEnvelope(o),Z=Ec.checkSegmentIntersection(o,w,P)),Z===-1&&(T?Math.abs(a.y-P)<Math.abs(l.y-P)?(a.y=P,this.m_shape.setXY(H,a)):(l.y=P,this.m_shape.setXY(W,l)):Math.abs(a.x-P)<Math.abs(l.x-P)?(a.x=P,this.m_shape.setXY(H,a)):(l.x=P,this.m_shape.setXY(W,l)),m=this.m_shape.getSegment(H),se=m,se===null&&(f.setStartXY(a),f.setEndXY(l),se=f),se.queryEnvelope(o),Z=Ec.checkSegmentIntersection(o,w,P),Z===-1&&(Z=Ec.checkSegmentIntersectionLoose(o,w,P)));const te=D;D=Z,k===-1&&(k=D),te===0&&D===1||te===1&&D===0||te===0&&D===0&&g.push(H),D===1&&(v=!1,A=!1),H=W,V=H,W=this.m_shape.getNextVertex(W)}}if(U===0){const B=D;D=q,k===-1&&(k=D),B===0&&D>=1||B>=1&&D===0||B===0&&D===0&&g.push(O),D===1&&(v=!1,A=!1),V=this.m_shape.getNextVertex(O)}if(O=V,g.length>=256){for(let B=1,H=g.length-1;B<H;B++){const W=g[B];i?this.m_shape.snapVertexForPoleClipping(W,P):this.m_shape.removeVertex(W,!1)}g[1]=g.at(-1),g.length=2}}while(O!==R);if(!A){k!==0||!i&&D!==0&&D!==2||g.push(R);for(let z=0,q=g.length;z<q;z++){const U=g[z];i?this.m_shape.snapVertexForPoleClipping(U,P):this.m_shape.removeVertex(U,!1)}}g.length=0,I=A||this.m_shape.getPathSize(I)===0?this.m_shape.removePath(I):this.m_shape.getNextPath(I)}}}if(v)return e.createInstance();m=null,i?this.removeSpikesAlongPoles():this.resolveBoundaryOverlaps(),s>0&&this.densifyAlongClipExtent(s);const b=this.m_shape.getGeometry(this.m_geometry);return b.getGeometryType()===G.enumPolygon&&b.setFillRule(e.getFillRule()),b}clipPolyline(e,s){const i=X.constructEmpty(),r=X.constructEmpty(),n=Me(9,Number.NaN),o=Me(9,Number.NaN),a=new ut;let l=e;const u=X.constructEmpty();e.queryLooseEnvelope(u);for(let c=0;c<4;c++){let h=!1;const m=!!(1&c);let f=0;switch(c){case 0:f=this.m_extent.xmin,h=u.xmin<=f&&u.xmax>=f;break;case 1:f=this.m_extent.ymin,h=u.ymin<=f&&u.ymax>=f;break;case 2:f=this.m_extent.xmax,h=u.xmin<=f&&u.xmax>=f;break;case 3:f=this.m_extent.ymax,h=u.ymin<=f&&u.ymax>=f}if(!h)continue;const g=l;l=e.createInstance();const v=g.getImpl().querySegmentIterator();v.resetToFirstPath();const b=new M,w=new M;for(;v.nextPath();){let S=-1,T=!0;for(;v.hasNextSegment();){this.progress_();const P=v.nextSegment(),I=P.isDegenerate(0);P.queryLooseEnvelope(i);const A=Ec.checkSegmentIntersection(i,c,f);if(A===-1){const D=P.intersectionWithAxis2D(m,f,n,o);let k=0;b.assign(P.getStartXY());for(let R=0;R<=D;R++){const O=R<D?o[R]:1;if(k===O)continue;P.queryCut(k,O,a,!1);const z=a.get();let q=!1;if(z.getStartXY().equals(b)||(z.setStartXY(b),q=!0),R<D&&(m?(w.x=n[R],w.y=f):(w.x=f,w.y=n[R]),z.getEndXY().equals(w)||(z.setEndXY(w),q=!0)),q&&z.normalizeAfterEndpointChange(),!I&&z.isDegenerate(0))continue;z.queryEnvelope(r);let U=Ec.checkSegmentIntersection(r,c,f);if(U===-1){const V=z.getStartXY(),B=z.getEndXY();q=!1,m?Math.abs(V.y-f)<Math.abs(B.y-f)?(V.y=f,z.setStartXY(V),V.equals(z.getStartXY())||(z.setStartXY(V),q=!0)):(B.y=f,B.equals(z.getEndXY())||(z.setEndXY(B),q=!0)):Math.abs(V.x-f)<Math.abs(B.x-f)?(V.x=f,V.equals(z.getStartXY())||(z.setStartXY(V),q=!0)):(B.x=f,B.equals(z.getEndXY())||(z.setEndXY(B),q=!0)),q&&z.normalizeAfterEndpointChange(),z.queryEnvelope(r),U=Ec.checkSegmentIntersection(r,c,f),U===-1&&(U=Ec.checkSegmentIntersectionLoose(r,c,f))}b.assign(z.getEndXY()),k=O,S=U,S>=1?(l.addSegment(z,T),T=!1):T=!0}}else S=A,S>=1?(l.addSegment(P,T),T=!1):T=!0}}}return l}static checkSegmentIntersection(e,s,i){switch(s){case 0:return e.xmin<i&&e.xmax<=i?0:e.xmin>=i?e.xmax===i?2:1:-1;case 1:return e.ymin<i&&e.ymax<=i?0:e.ymin>=i?e.ymax===i?2:1:-1;case 2:return e.xmin>=i&&e.xmax>i?0:e.xmax<=i?e.xmin===i?2:1:-1;case 3:return e.ymin>=i&&e.ymax>i?0:e.ymax<=i?e.ymin===i?2:1:-1}return Ce(""),0}static checkSegmentIntersectionLoose(e,s,i){switch(s){case 0:{const r=Math.abs(e.xmin-i),n=Math.abs(e.xmax-i);return e.xmin<i?r>n?0:1:(Ce(""),1)}case 1:{const r=Math.abs(e.ymin-i),n=Math.abs(e.ymax-i);return e.ymin<i?r>n?0:1:(Ce(""),1)}case 2:{const r=Math.abs(e.xmin-i),n=Math.abs(e.xmax-i);return e.xmax>i?r<n?0:1:(Ce(""),1)}case 3:{const r=Math.abs(e.ymin-i),n=Math.abs(e.ymax-i);return e.ymax>i?r<n?0:1:(Ce(""),1)}}return Ce(""),0}resolveBoundaryOverlaps(){this.m_verticesOnExtentIndex=-1,this.splitSegments(!1,this.m_extent.xmin),this.splitSegments(!1,this.m_extent.xmax),this.splitSegments(!0,this.m_extent.ymin),this.splitSegments(!0,this.m_extent.ymax),this.m_verticesOnExtent.length=0,this.m_verticesOnExtentIndex=this.m_shape.createUserIndex();const e=new M;for(let s=this.m_shape.getFirstPath(this.m_geometry);s!==L;s=this.m_shape.getNextPath(s)){let i=this.m_shape.getFirstVertex(s);for(let r=0,n=this.m_shape.getPathSize(s);r<n;r++,i=this.m_shape.getNextVertex(i))this.progress_(),this.m_shape.queryXY(i,e),this.m_extent.xmin!==e.x&&this.m_extent.xmax!==e.x&&this.m_extent.ymin!==e.y&&this.m_extent.ymax!==e.y||(this.m_shape.setUserIndex(i,this.m_verticesOnExtentIndex,this.m_verticesOnExtent.length),this.m_verticesOnExtent.push(i))}this.dbgCheckPathFirst(),this.resolveOverlaps(!1,this.m_extent.xmin),this.dbgCheckPathFirst(),this.resolveOverlaps(!1,this.m_extent.xmax),this.dbgCheckPathFirst(),this.resolveOverlaps(!0,this.m_extent.ymin),this.dbgCheckPathFirst(),this.resolveOverlaps(!0,this.m_extent.ymax),this.fixPaths()}densifyAlongClipExtent(e){const s=new M(0,0),i=new M(0,0),r=Me(2048,Number.NaN);for(let n=this.m_shape.getFirstPath(this.m_geometry);n!==L;n=this.m_shape.getNextPath(n)){const o=this.m_shape.getFirstVertex(n);let a=o;do{const l=this.m_shape.getNextVertex(a);this.m_shape.queryXY(a,s);let u=-1;if(s.x===this.m_extent.xmin?(this.m_shape.queryXY(l,i),i.x===this.m_extent.xmin&&(u=1)):s.x===this.m_extent.xmax&&(this.m_shape.queryXY(l,i),i.x===this.m_extent.xmax&&(u=1)),s.y===this.m_extent.ymin?(this.m_shape.queryXY(l,i),i.y===this.m_extent.ymin&&(u=0)):s.y===this.m_extent.ymax&&(this.m_shape.queryXY(l,i),i.y===this.m_extent.ymax&&(u=0)),u===-1){a=l;continue}if(this.isCurve(a)){a=l;continue}const c=s.clone(),h=new M(0,0);if(u){const g=s.y-this.m_extent.ymin;h.y=di(i.y-s.y),c.y=e*$d(Math.floor(Math.abs(g)/e),g)+this.m_extent.ymin,h.y<0&&(c.y+=e)}else{const g=s.x-this.m_extent.xmin;h.x=di(i.x-s.x),c.x=e*$d(Math.floor(Math.abs(g)/e),g)+this.m_extent.xmin,h.x<0&&(c.x+=e)}const m=u?i.y-s.y:i.x-s.x,f=Math.abs(m);if(f/e>65536&&Ce(""),f>0){const g=Math.trunc(f/e)+2;r.length<g&&(r.length=g);let v=0;for(let b=0;;b++){const w=c.add(h.mul(b*e)),S=(u?w.y-s.y:w.x-s.x)/m;if(S>=1)break;S<=0||(F(v<=r.length),r[v]=S,v++)}v!==0&&this.m_shape.splitSegment(a,r,v)}a=l}while(a!==o)}}splitSegments(e,s){let i=-1;const r=new M,n=[];for(let g=this.m_shape.getFirstPath(this.m_geometry);g!==L;g=this.m_shape.getNextPath(g)){let v=this.m_shape.getFirstVertex(g),b=L;for(let w=0,S=this.m_shape.getPathSize(g);w<S;w++,v=b)if(this.progress_(),b=this.m_shape.getNextVertex(v),this.m_shape.queryXY(v,r),(e?r.y===s:r.x===s)&&(this.m_shape.queryXY(b,r),e?r.y===s:r.x===s)){if(this.isCurve(v))continue;i===-1&&(i=this.m_shape.createUserIndex()),this.m_shape.getUserIndex(v,i)!==1&&(n.push(v),this.m_shape.setUserIndex(v,i,1)),this.m_shape.getUserIndex(b,i)!==1&&(n.push(b),this.m_shape.setUserIndex(b,i,1))}}if(i!==-1&&this.m_shape.removeUserIndex(i),n.length<3)return;n.sort((g,v)=>this.compareVertices(g,v));const o=new M,a=new M,l=new M;a.setNAN();let u=-1,c=[],h=[];const m=this.m_shape.createUserIndex(),f=this.m_shape.createUserIndex();for(let g=0,v=n.length;g<v;g++){const b=n[g];if(this.m_shape.queryXY(b,r),!r.isEqualPoint2D(a)){if(u===-1){u=g,a.setCoordsPoint2D(r);continue}for(let S=u;S<g;S++){const T=n[S],P=this.m_shape.getNextVertex(T),I=this.m_shape.getPrevVertex(T);let A=!1;this.m_shape.queryXY(P,o),a.compare(o)<0&&(e?o.y===s:o.x===s)&&(this.isCurve(T)||(c.push(T),A=!0,this.m_shape.setUserIndex(T,f,1))),this.m_shape.queryXY(I,o),a.compare(o)<0&&(e?o.y===s:o.x===s)&&(this.isCurve(I)||(A||c.push(T),this.m_shape.setUserIndex(T,m,1)))}for(let S=0,T=c.length;S<T;S++){const P=c[S],I=this.m_shape.getUserIndex(P,m),A=this.m_shape.getUserIndex(P,f);if(I===1){const D=this.m_shape.getPrevVertex(P);this.m_shape.queryXY(D,l);let k=0;if(!l.isEqualPoint2D(r)){const R=M.distance(a,l);k=M.distance(l,r)/R,k===0?k=Number.EPSILON:k===1&&(k=1-Number.EPSILON),this.m_shape.splitSegment(D,[k],1);const O=this.m_shape.getPrevVertex(P);this.m_shape.setXY(O,r),h.push(O),this.m_shape.setUserIndex(O,m,1),this.m_shape.setUserIndex(O,f,-1)}}if(A===1){const D=this.m_shape.getNextVertex(P);this.m_shape.queryXY(D,l);let k=0;if(!l.isEqualPoint2D(r)){const R=M.distance(a,l);k=M.distance(a,r)/R,k===0?k=Number.EPSILON:k===1&&(k=1-Number.EPSILON),this.m_shape.splitSegment(P,[k],1);const O=this.m_shape.getNextVertex(P);this.m_shape.setXY(O,r),h.push(O),this.m_shape.setUserIndex(O,m,-1),this.m_shape.setUserIndex(O,f,1)}}}const w=c;c=h,h=w,h.length=0,u=g,a.setCoordsPoint2D(r)}}this.m_shape.removeUserIndex(m),this.m_shape.removeUserIndex(f)}resolveOverlaps(e,s){const i=new M,r=[];let n=-1;for(let u=0,c=this.m_verticesOnExtent.length;u<c;u++){this.progress_();const h=this.m_verticesOnExtent[u];if(h===L)continue;const m=this.m_shape.getNextVertex(h);if(this.m_shape.queryXY(h,i),(e?i.y===s:i.x===s)&&(this.m_shape.queryXY(m,i),e?i.y===s:i.x===s)){if(this.isCurve(h))continue;n===-1&&(n=this.m_shape.createUserIndex()),this.m_shape.getUserIndex(h,n)!==-2&&(r.push(h),this.m_shape.setUserIndex(h,n,-2)),this.m_shape.getUserIndex(m,n)!==-2&&(r.push(m),this.m_shape.setUserIndex(m,n,-2))}}if(r.length===0)return void(n!==-1&&this.m_shape.removeUserIndex(n));F(n!==-1),r.sort((u,c)=>this.compareVertices(u,c));for(let u=0,c=r.length;u<c;u++){const h=r[u];this.m_shape.setUserIndex(h,n,u)}const o=new M,a=new M;a.setNAN();let l=-1;for(let u=0,c=r.length;u<c;u++){this.progress_();const h=r[u];if(h!==L&&(this.m_shape.queryXY(h,i),!i.isEqualPoint2D(a))){if(l!==-1)for(;;){let m=!1;const f=u;for(let g=l;g<f;g++){const v=r[g];if(v===L)continue;let b=L;const w=this.m_shape.getNextVertex(v);this.m_shape.queryXY(w,o),a.compare(o)<0&&(e?o.y===s:o.x===s)&&(this.isCurve(v)||(b=w));let S=L;const T=this.m_shape.getPrevVertex(v);if(this.m_shape.queryXY(T,o),a.compare(o)<0&&(e?o.y===s:o.x===s)&&(this.isCurve(T)||(S=T)),b===L||S===L){if(b!==L||S!==L){for(let P=g+1;P<u;P++){const I=r[P];if(I===L)continue;const A=this.m_shape.getNextVertex(I);let D=L;this.m_shape.queryXY(A,o),a.compare(o)<0&&(e?o.y===s:o.x===s)&&(this.isCurve(I)||(D=A));const k=this.m_shape.getPrevVertex(I);let R=L;if(this.m_shape.queryXY(k,o),a.compare(o)<0&&(e?o.y===s:o.x===s)&&(this.isCurve(k)||(R=k)),D!==L&&R!==L){this.beforeRemoveVertex(I,r,n),this.m_shape.removeVertex(I,!1),this.beforeRemoveVertex(D,r,n),this.m_shape.removeVertex(D,!1),m=!0;break}if(b!==L&&R!==L){this.removeOverlap(r,v,b,I,R,n),m=!0;break}if(S!==L&&D!==L){this.removeOverlap(r,I,D,v,S,n),m=!0;break}}if(m)break}}else this.beforeRemoveVertex(v,r,n),this.m_shape.removeVertex(v,!1),this.beforeRemoveVertex(b,r,n),this.m_shape.removeVertex(b,!1),m=!0}if(!m)break}l=u,a.setCoordsPoint2D(i)}}this.m_shape.removeUserIndex(n)}beforeRemoveVertex(e,s,i){let r=this.m_shape.getUserIndex(e,i);F(r>=0),s[r]=L,r=this.m_shape.getUserIndex(e,this.m_verticesOnExtentIndex),F(r>=0),this.m_verticesOnExtent[r]=L;const n=this.m_shape.getPathFromVertex(e);n!==L&&this.m_shape.getFirstVertex(n)===e&&(this.m_shape.setFirstVertex(n,L),this.m_shape.setLastVertex(n,L))}removeOverlap(e,s,i,r,n,o){this.m_shape.setNextVertex(s,r),this.m_shape.setPrevVertex(r,s),this.m_shape.setPrevVertex(i,n),this.m_shape.setNextVertex(n,i),this.beforeRemoveVertex(r,e,o),this.m_shape.removeVertexInternal(r,!1),this.beforeRemoveVertex(n,e,o),this.m_shape.removeVertexInternal(n,!0)}removeSpikesAlongPoles(){this.removeSpikesOnPole(this.m_extent.ymin),this.removeSpikesOnPole(this.m_extent.ymax)}removeSpikesOnPole(e){for(let s=this.m_shape.getFirstPath(this.m_geometry);s!==L;s=this.m_shape.getNextPath(s)){const i=this.m_shape.getPathSize(s);if(i<3)continue;let r=this.m_shape.getFirstVertex(s);const n=new M;this.m_shape.queryXY(r,n);let o=n.y===e&&!this.isCurve(r);r=this.m_shape.getNextVertex(r);const a=new M;this.m_shape.queryXY(r,a);let l=a.y===e&&!this.isCurve(r);r=this.m_shape.getNextVertex(r);const u=new M;for(let c=0,h=i-2;c<h;c++,r=this.m_shape.getNextVertex(r)){this.progress_(),this.m_shape.queryXY(r,u);const m=u.y===e;if(l&&o&&m&&(a.x-n.x)*(u.x-a.x)<=0){this.m_shape.removeVertex(this.m_shape.getPrevVertex(r),!1),a.setCoordsPoint2D(u),l=m&&!this.isCurve(r);continue}n.setCoordsPoint2D(a),o=l,a.setCoordsPoint2D(u),l=m&&!this.isCurve(r)}}}fixPaths(){for(let n=0,o=this.m_verticesOnExtent.length;n<o;n++){const a=this.m_verticesOnExtent[n];a!==L&&this.m_shape.setPathToVertex(a,L)}const e=this.m_shape.hasCurves();let s=0,i=0;for(let n=this.m_shape.getFirstPath(this.m_geometry);n!==L;){const o=this.m_shape.getFirstVertex(n);if(o===L||n!==this.m_shape.getPathFromVertex(o)){const u=n;n=this.m_shape.getNextPath(n),this.m_shape.setFirstVertex(u,L),this.m_shape.removePathOnly(u);continue}let a=o,l=0;do this.m_shape.setPathToVertex(a,n),l++,a=this.m_shape.getNextVertex(a);while(a!==o);this.m_shape.setRingAreaValid(n,!1),this.m_shape.setLastVertex(n,this.m_shape.getPrevVertex(o)),this.m_shape.setPathSize(n,l),i+=l,s++,n=this.m_shape.getNextPath(n)}for(let n=0,o=this.m_verticesOnExtent.length;n<o;n++){let a=this.m_verticesOnExtent[n];if(a===L)continue;let l=this.m_shape.getPathFromVertex(a);if(l!==L)continue;l=this.m_shape.insertPath(this.m_geometry,L);let u=!1,c=0;const h=a;do this.m_shape.setPathToVertex(a,l),c++,e&&c<=2&&(u||(u=this.isCurve(a))),a=this.m_shape.getNextVertex(a);while(a!==h);if(u?c===0:c<=2){let m=this.m_shape.getUserIndex(h,this.m_verticesOnExtentIndex);F(m>=0),this.m_verticesOnExtent[m]=L;const f=this.m_shape.removeVertex(h,!1);c===2&&(m=this.m_shape.getUserIndex(f,this.m_verticesOnExtentIndex),m>=0&&(this.m_verticesOnExtent[m]=L),this.m_shape.removeVertex(f,!1));const g=l;l=this.m_shape.getNextPath(l),this.m_shape.setFirstVertex(g,L),this.m_shape.removePathOnly(g)}else this.m_shape.setClosedPath(l,!0),this.m_shape.setPathSize(l,c),this.m_shape.setFirstVertex(l,h),this.m_shape.setLastVertex(l,this.m_shape.getPrevVertex(h)),this.m_shape.setRingAreaValid(l,!1),i+=c,s++}this.m_shape.setGeometryPathCount(this.m_geometry,s),this.m_shape.setGeometryVertexCount(this.m_geometry,i);let r=0;for(let n=this.m_shape.getFirstGeometry();n!==L;n=this.m_shape.getNextGeometry(n))r+=this.m_shape.getPointCount(n);this.m_shape.setTotalPointCount(r)}dbgCheckPathFirst(){}isCurve(e){return this.m_shape.getSegment(e)!==null}compareVertices(e,s){const i=new M;this.m_shape.queryXY(e,i);const r=new M;return this.m_shape.queryXY(s,r),i.compare(r)}clipPolesOut(e,s){return this.clipPolygonOrProjectedPolyline2(e,s)}};class jb{getOperatorType(){return 10004}supportsCurves(){return!0}accelerateGeometry(e,s,i){return!1}canAccelerateGeometry(e){return!1}executeMany(e,s,i,r){return new dst(e,s,i,r)}execute(e,s,i,r){return pst(e,s,i,r)}}let dst=class extends nm{constructor(e,s,i,r){super(),this.m_progressTracker=r,this.m_index=-1,e||ee(""),this.m_envelope=s,this.m_inputGeometryCursor=e,this.m_spatialRefImpl=i,this.m_tolerance=Ji(i,s,!1).total()}next(){let e;return(e=this.m_inputGeometryCursor.next())?(Nd(e),this.m_index=this.m_inputGeometryCursor.getGeometryID(),ps(e,this.m_envelope,this.m_tolerance,0,this.m_progressTracker)):null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}};function pst(t,e,s,i){return K1e(t,e,s,Number.NaN,0,i)}var fst=U1e;let gst=class extends nm{constructor(e,s,i,r,n,o){super(),this.m_densificator=new fst(s,i,r,o,!1,n),this.m_index=-1,this.m_inputGeoms=e}tock(){return!0}getRank(){return 1}next(){let e=null;for(;e=this.m_inputGeoms.next();)return Nd(e),this.m_index=this.m_inputGeoms.getGeometryID(),this.densify(e);return null}getGeometryID(){return this.m_index}densify(e){return this.m_densificator.densify(e)}},i_=class{getOperatorType(){return 10202}accelerateGeometry(e,s,i){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}executeMany(e,s,i,r,n,o=12e3){return new gst(e,s,i,r,o,n)}execute(e,s,i,r,n,o=12e3){return Ftt(e,s,i,r,n,o)}};class o0{constructor(e){if(this.m_geom=this.m_sr=null,e){if(e.move)return this.m_geom=e.move.m_geom,e.move.m_geom=null,this.m_sr=e.move.m_sr,void(e.move.m_sr=null);if(e.copy)return this.m_geom=e.copy.m_geom?e.copy.m_geom.clone():null,void(this.m_sr=e.copy.m_sr);e.geom&&(this.m_geom=e.geom),e.sr&&(this.m_sr=e.sr)}}getGeometry(){return this.m_geom}getSpatialReference(){return this.m_sr}setGeometry(e){this.m_geom=e}setSpatialReference(e){this.m_sr=e}equals(e,s){const i=e;return!(!this.m_sr&&i.m_sr)&&!(this.m_sr&&!i.m_sr)&&!(!this.m_geom&&i.m_geom)&&!(this.m_geom&&!i.m_geom)&&!(this.m_sr&&i.m_sr&&!this.m_sr.equals(i.m_sr))&&!(this.m_geom&&i.m_geom&&!this.m_geom.equals(i.m_geom,s))}clone(){let e=null;return this.m_geom&&(e=this.m_geom.clone()),new o0({geom:e,sr:this.m_sr})}hasGeom(){return!!this.m_geom}}class tve{constructor(e){this.m_factor=1,this.m_wkid=0,this.m_peUnit=null,e&&(this.m_peUnit=e,this.m_factor=e.getUnitFactor(),this.m_wkid=e.getCode(),this.m_wkid<0&&(this.m_wkid=0))}getName(){return this.m_peUnit.getName()}getID(){return this.m_wkid}getConversionFactor(e){return this.getUnitType()!==e.getUnitType()&&ee("unit type mismatch"),this.getUnitToBaseFactor()/e.getUnitToBaseFactor()}getUnitToBaseFactor(){return this.m_factor}getHashCode(){return Wi(kc(this.getUnitType()),kc(this.getUnitToBaseFactor()))}equals(e){return!!e&&this.getUnitType()===e.getUnitType()&&this.getUnitToBaseFactor()===e.getUnitToBaseFactor()&&this.getID()===e.getID()&&this.getName()===e.getName()}static isValidWkid(e){return!1}}class gs{assign(e){this.m_reason=e.m_reason,this.m_vertexIndex1=e.m_vertexIndex1,this.m_vertexIndex2=e.m_vertexIndex2}constructor(e,s,i){e!==void 0?(this.m_reason=e,this.m_vertexIndex1=s,this.m_vertexIndex2=i):(this.m_reason=0,this.m_vertexIndex1=-1,this.m_vertexIndex2=-2)}clear(){this.m_reason=0,this.m_vertexIndex1=-1,this.m_vertexIndex2=-1}}const nD={330:104878,500:104879,1300:104899,1450:104986,2230:104988,3800:104978,5e3:104919,6200:104906,8200:104909,9500:104927,9600:104977,1e4:[104911,104936],11e3:104941,11080:104872,11100:104907,12e3:104920,12400:104995,13e3:104948,14e3:[104923,104989],15e3:[104913,104954],15100:104976,16e3:[104926,104931],18e3:[104922,104982],21e3:104947,21500:104877,27e3:[104950,104957],29e3:104964,3e4:104921,31e3:104949,33e3:104946,4e4:[104914,104967],40600:104897,41900:104937,42e3:104951,43100:104993,49300:104924,50100:104939,54e3:104955,58200:104981,59500:104930,74e3:104961,77e3:104956,79e3:104962,83500:104910,85e3:104917,88800:104934,89200:104985,96e3:104997,104e3:104963,106500:104898,11e4:104938,133e3:104932,135e3:104983,17e4:104965,198200:104987,198630:104935,208e3:104966,235800:104952,249400:104929,252100:104980,255e3:104973,47e4:104972,529800:104942,531e3:104996,56e4:104928,561400:104979,578900:104945,584700:104959,593e3:104970,606e3:104999,718e3:104933,745700:104984,761400:104953,763500:104994,764e3:104940,788900:104958,1188300:104998,1195e3:104969,1352600:104968,1560800:104874,1562090:104915,1737400:104903,1821460:104918,1821490:104876,2409300:104912,2410300:104873,2439400:104974,2439700:104900,2575e3:104943,2631200:104875,2632345:104916,3393400:104904,3396190:[104905,104971],6051e3:104901,6051800:104902,637e4:104128,6370997:[4052,37008],6371e3:4035,6371007:4047,6371228:[4053,10346],6376045:[8042,8043],6376523:[4027,4901,4902],6376896:37007,6378135:[4122,4322,4324,4720,4985,4987],6378136:[4740,4923,7678,7680,9474,9475,104017,104018],6378137:[3823,3824,3888,3889,4017,4019,4023,4031,4040,4046,4055,4074,4075,4080,4081,4121,4126,4130,4133,4140,4141,4148,4151,4152,4163,4166,4167,4170,4171,4172,4173,4176,4180,4189,4190,4258,4269,4283,4318,4319,4326,4463,4466,4469,4470,4480,4482,4483,4490,4557,4558,4612,4617,4619,4624,4627,4659,4661,4667,4669,4670,4674,4686,4687,4693,4694,4702,4737,4742,4747,4749,4750,4755,4756,4757,4758,4759,4761,4762,4763,4764,4765,4883,4885,4887,4889,4893,4895,4898,4907,4909,4921,4925,4927,4929,4931,4933,4935,4937,4939,4941,4943,4945,4947,4949,4951,4953,4955,4957,4959,4961,4963,4965,4967,4971,4975,4977,4979,4981,4983,4989,4997,4999,5012,5013,5245,5246,5251,5252,5263,5264,5323,5324,5340,5342,5353,5354,5359,5360,5364,5365,5370,5371,5372,5373,5380,5381,5392,5393,5488,5489,5545,5546,5592,5593,5885,5886,6134,6135,6310,6311,6318,6319,6321,6322,6324,6325,6364,6365,6667,6668,6705,6706,6782,6783,6980,6982,6983,6987,6989,6990,7034,7035,7036,7037,7038,7039,7040,7041,7042,7072,7073,7084,7085,7086,7087,7133,7135,7136,7138,7139,7372,7373,7657,7659,7661,7663,7665,7685,7686,7797,7798,7816,7843,7844,7880,7881,7885,7886,7900,7901,7902,7903,7904,7905,7906,7907,7908,7909,7910,7911,7912,7915,7917,7919,7921,7923,7925,7927,7929,7931,8085,8086,8231,8232,8235,8237,8239,8240,8244,8246,8248,8249,8251,8252,8254,8255,8399,8403,8426,8427,8449,8542,8544,8545,8684,8685,8698,8699,8817,8818,8860,8888,8899,8900,8901,8902,8906,8907,8916,8918,8920,8922,8924,8926,8928,8930,8932,8934,8936,8938,8940,8942,8944,8946,8948,8949,8972,8973,8974,8975,8976,8977,8978,8979,8980,8981,8982,8983,8984,8985,8986,8987,8988,8989,8990,8991,8992,8993,8994,8995,8996,8997,8998,8999,9e3,9002,9003,9005,9006,9008,9009,9011,9012,9013,9014,9016,9017,9018,9019,9053,9054,9055,9056,9057,9059,9060,9061,9062,9063,9064,9065,9066,9067,9068,9069,9071,9072,9074,9075,9139,9140,9147,9148,9152,9153,9183,9184,9293,9294,9299,9308,9309,9332,9333,9364,9372,9379,9380,9384,9453,9469,9470,9546,9547,9695,9696,9701,9702,9739,9754,9755,9758,9763,9776,9777,9778,9779,9781,9782,9783,9784,9866,9871,9939,9964,9969,9974,9989,9990,10175,10177,10178,10185,10191,10196,10204,10209,10214,10219,10224,10229,10237,10272,10277,10283,10284,10298,10299,10300,10304,10305,10307,10309,10310,10311,10312,10327,10328,10413,10414,10468,10474,10475,10570,10571,10605,10606,10623,10628,20033,20040,20041,20045,20046,104009,104010,104011,104012,104013,104014,104015,104016,104019,104020,104021,104022,104024,104027,104028,104050,104100,104107,104108,104110,104111,104114,104115,104116,104117,104118,104119,104120,104121,104122,104123,104124,104129,104133,104134,104137,104141,104142,104143,104144,104145,104179,104180,104181,104182,104183,104184,104185,104186,104199,104223,104257,104258,104259,104260,104286,104287,104602,104613,104644,104645,104646,104647,104653,104804,104896,104991],6378140:4610,6378145:[4025,4276,4760,4891,37001],6378150:37003,6378155:[37004,37207],6378160:[3821,4003,4021,4036,4202,4203,4237,4238,4291,4618,4708,5527,37231,104023,104136],6378166:37002,6378200:[4020,4229,4286,4303,4706],6378245:[4024,4147,4164,4178,4179,4191,4200,4205,4214,4284,4317,4555,4676,4677,4678,4991,4993,5560,5561,37257,104135],6378270:[4732,37005,37229],6378273:[4054,10345],6378300:[4029,4168,4174],6378388:[4022,4123,4153,4154,4158,4159,4160,4161,4165,4181,4182,4183,4184,4185,4192,4194,4195,4196,4199,4204,4207,4208,4215,4218,4221,4224,4225,4230,4231,4233,4235,4236,4247,4248,4249,4254,4255,4259,4264,4265,4271,4272,4274,4285,4287,4288,4292,4297,4309,4311,4313,4316,4472,4475,4611,4614,4615,4616,4621,4622,4623,4625,4626,4628,4629,4630,4631,4632,4633,4636,4637,4639,4641,4642,4643,4644,4645,4646,4658,4660,4662,4663,4664,4665,4668,4672,4673,4684,4688,4689,4690,4691,4692,4698,4704,4705,4707,4709,4710,4711,4712,4714,4715,4716,4718,4719,4721,4722,4724,4725,4727,4728,4729,4730,4733,4734,4735,4739,4741,4753,4754,4802,4803,4806,4809,4810,4823,4824,4900,5524,6883,8428,8430,8431,9248,9251,9253,9403,9893,10158,10249,10252,37201,37204,37205,37212,37213,37214,37215,37216,37217,37218,37219,37221,37222,37224,37226,37227,37230,37232,37233,37234,37235,37237,37238,37241,37242,37245,37246,37247,37249,37250,37251,37253,37259,104104,104106,104125,104126,104127,104130,104138,104248],6378523:104786,24764e3:104960,25559e3:104944,60268e3:104925,71492e3:104908,6957e5:104975,6377397155e-3:[3819,3906,4004,4120,4124,4125,4149,4150,4156,4162,4211,4219,4257,4262,4280,4289,4294,4295,4301,4306,4308,4312,4314,4613,4666,4745,4746,4801,4804,4805,4808,4813,4814,4815,4818,4820,4904,5132,5228,5229,5681,5830,8351,9267,10268,37255,104101,104102,104105,104131,104648,104696,104697,104990,104992],6377563396e-3:[4001,4188,4277,4278,4279],6377340189e-3:[4002,4299,4300],6377492018e-3:[4005,4273,4817],6377483865280418e-9:[4006,4293],6378293645208759e-9:[4007,4157,4302,4738,5464],63782064e-1:[4008,4127,4128,4129,4135,4136,4137,4138,4139,4169,4216,4242,4253,4267,4608,4609,4638,4675,4683,4695,4717,4723,4726,4995,5451,5467,37220,37239,37243,37252,37260,104e3,104109,104112,104113,104132],6378450047e-3:[4009,4268],6378300789e-3:[4010,4281],63782492e-1:[4011,4014,4155,4193,4206,4213,4223,4226,4227,4228,4252,4261,4266,4275,4282,4296,4304,4310,4315,4671,4807,4811,4816,4821,37223,37225,104139,104140,104261,104304],6378249145e-3:[4012,4013,4132,4134,4142,4143,4175,4197,4198,4201,4209,4210,4212,4220,4222,4232,4234,4246,4250,4251,4256,4260,4263,4270,4305,4307,4600,4601,4602,4603,4604,4605,4606,4607,4620,4679,4680,4696,4697,4699,4700,4701,4703,4713,4731,4736,4743,4744,4812,4819,6881,6882,6892,6894,8694,37206,37208,37211,37228,37240,37254,104025,104026,104103,104305],6377276345e-3:[4015,4131,4144,4239,4240,4244,4682,5233,6207,37202,104256,104664,104693],6377298556e-3:[4016,4298],6377304063e-3:[4018,4245],63782983e-1:[4028,4903],63781362e-1:4032,63781363e-1:4033,6378249144808011e-9:[4034,4241],209229318e-1:[4042,4243],6377301243e-3:[4044,4145,37203],6377299151e-3:[4045,4146],637701927e-2:[4657,10256,10260,10265],63783063696e-4:[4748,4752],6377295664e-3:[4751,37006],63781365e-1:[7682,7683],63710087714e-4:104047,6378418941e-3:[104700,104726,104760],6378586581e-3:[104701,104743],6378505809e-3:104702,6378544823e-3:104703,6378490569e-3:104704,6378470757e-3:[104705,104776],6378403701e-3:[104706,104750],6378434181e-3:[104707,104724,104739,104764],6378454907e-3:104708,6378400653e-3:104709,6378567378e-3:104710,6378546957e-3:[104711,104717,104780],6378476853e-3:[104712,104736],6378411321e-3:[104713,104728],6378647541e-3:[104714,104715],6378514953e-3:[104716,104782],6378421989e-3:[104718,104770],6378481425e-3:[104719,104753,104774,104781],6378518001e-3:[104720,104725],6378521049e-3:[104721,104723,104731,104745,104748],6378464661e-3:104722,6378436619e-3:104727,6378574389e-3:[104729,104730],6378472281e-3:[104732,104756],6378498189e-3:[104733,104746],6378449421e-3:[104734,104766],6378525621e-3:[104735,104754],6378466185e-3:104737,6378496665e-3:104738,6378643579e-3:104740,6378559758e-3:104741,6378414369e-3:[104742,104763,104772],6378441801e-3:104744,6378502761e-3:[104747,104759,104773,104775],6378617061e-3:104749,6378624681e-3:[104751,104765],6378468623e-3:104752,6378445763e-3:[104755,104758,104761],6378670401e-3:104757,6378438753e-3:104762,6378543909e-3:104767,6378605783e-3:104768,6378540861e-3:104769,6378443325e-3:[104771,104784],6378548481e-3:104777,6378463746e-3:104778,6378426561e-3:104779,6378453688e-3:104783,6378530193e-3:104785,6378376271e-3:[104800,104828],637847192e-2:104801,6378472931e-3:104802,6378411351e-3:104803,6378380991e-3:104805,637841496e-2:104806,637834509e-2:[104807,104819,104844,104870],6378412542e-3:104808,6378470401e-3:104809,6378376331e-3:104810,6378379031e-3:104811,6378407621e-3:104812,6378376811e-3:[104813,104827],637831392e-2:104814,637841493e-2:104815,6378413021e-3:104816,6378380381e-3:104817,6378530851e-3:104818,6378591521e-3:104820,6378378881e-3:104821,6378408481e-3:[104822,104832],6378375601e-3:[104823,104838],6378408041e-3:104824,6378655071e-3:104825,6378409151e-3:104826,63783157e-1:[104829,104840,104845,104851],637828586e-2:[104830,104835,104859],6378379301e-3:104831,6378560121e-3:104833,6378531821e-3:104834,63785006e-1:104836,6378376041e-3:104837,6378406601e-3:104839,6378438991e-3:104841,637834542e-2:104842,637859386e-2:104843,6378381271e-3:[104846,104847],6378413671e-3:104848,6378344377e-3:104849,6378563891e-3:104850,6378408091e-3:104852,6378377671e-3:104853,6378472751e-3:104854,6378412511e-3:104855,6378407281e-3:104856,6378534451e-3:104857,6378406051e-3:104858,6378532921e-3:104860,6378380091e-3:104861,6378408941e-3:104862,6378624171e-3:104863,6378377411e-3:104864,6378474591e-3:104865,6378407141e-3:104866,6378376871e-3:104867,6378375251e-3:104868,6378405971e-3:104869,6378437651e-3:104871};function yst(){for(const t in nD)delete nD[t]}class wC extends tve{constructor(e){if(typeof e=="number")return super(),this.m_factor=e,void(this.m_wkid=0);super(e)}getUnitType(){return 1}convertFromRadians(e){return e/this.getUnitToBaseFactor()}convertToRadians(e){return e*this.getUnitToBaseFactor()}}function _st(t){return new Fd}function vst(t){return t.getType()===We.PE_TYPE_LINUNIT?new Fd(t):t.getType()===We.PE_TYPE_ANGUNIT?new wC(t):void ee("peUnit")}function bst(t){const e=Mx(null);return t.getType()===We.PE_TYPE_PROJCS||t.getType()===We.PE_TYPE_GEOGCS?e.reset(t.getUnit()):ee("PE_coord_sys"),e.get()||Ce("cannot create units from coord sys"),vst(e.get())}class ld{constructor(e,s,i){e===void 0?(this.x=new le,this.y=new le,this.z=new le):e instanceof gt?(this.x=new le(e.x),this.y=new le(e.y),this.z=new le(e.z)):e instanceof le?(this.x=e.clone(),this.y=s.clone(),this.z=i.clone()):ee("EPoint3D constructor")}dotProduct(e){return this.x.mulE(e.x).addE(this.y.mulE(e.y)).addE(this.z.mulE(e.z))}crossProduct(e){return new ld(this.y.mulE(e.z).subE(this.z.mulE(e.y)),this.z.mulE(e.x).subE(this.x.mulE(e.z)),this.x.mulE(e.y).subE(this.y.mulE(e.x)))}crossProductVector(e){const s=this.y.mulE(e.z).subE(e.y.mulE(this.z)),i=e.x.mulE(this.z).subE(this.x.mulE(e.z)),r=this.x.mulE(e.y).subE(e.x.mulE(this.y));return new ld(s,i,r)}sqrLength(){return this.x.mulE(this.x).addE(this.y.mulE(this.y)).addE(this.z.mulE(this.z))}length(){return this.sqrLength().sqrt()}static distance(e,s){return e.sub(s).length()}negate(){return new ld(this.x.negate(),this.y.negate(),this.z.negate())}add(e){return new ld(this.x.addE(e.x),this.y.addE(e.y),this.z.addE(e.z))}sub(e){return new ld(this.x.subE(e.x),this.y.subE(e.y),this.z.subE(e.z))}subThis(e){return this.x.subThisE(e.x),this.y.subThisE(e.y),this.z.subThisE(e.z),this}addThis(e){return this.x.addThisE(e.x),this.y.addThisE(e.y),this.z.addThisE(e.z),this}mul(e){return new ld(this.x.mulE(e),this.y.mulE(e),this.z.mulE(e))}div(e){return new ld(this.x.divE(e),this.y.divE(e),this.z.divE(e))}eq(e){return this.x.eq(e.x)&&this.y.eq(e.y)&&this.z.eq(e.z)}isZero(){return this.x.isZero()&&this.y.isZero()&&this.z.isZero()}value(){return gt.construct(this.x.value(),this.y.value(),this.z.value())}}class xst{constructor(e){if(this.m_origin=new gt,this.m_normal=new gt,this.m_axisX=new gt,this.m_axisY=new gt,!e)return this.m_origin=new gt,this.m_normal=new gt(0,0,1),this.m_axisX=new gt(1,0,0),void(this.m_axisY=new gt(0,1,0));e.pt0&&e.pt1&&e.pt2?this.setFromPoints(e.pt0,e.pt1,e.pt2):F(0,`unimplemented constructor options ${JSON.stringify(e)}`)}assign(e){return F(0),this}set(e,s,i,r){F(0)}setFromPoints(e,s,i){let r=s.sub(e);const n=i.sub(e);this.m_normal=r.crossProductVector(n);let o=!0;if(this.m_normal.isZero()){if(o=!1,r.isZero()&&(r=n),r.isZero())return this.m_normal.setCoords(0,0,1),this.m_axisX.setCoords(1,0,0),this.m_axisY.setCoords(0,1,0),this.m_origin=e,!1;this.m_axisX=r.getUnitVector(),this.m_normal=this.m_axisX.createAPerpendicular()}else this.m_normal.normalizeThis(),this.m_axisX=r.getUnitVector();return this.m_axisY=this.m_normal.crossProductVector(this.m_axisX),this.m_origin=e,o}getCoord(e,s){return F(0),{}}getCoord2D(e){return F(0),{}}getCoordX(e,s){return F(0),0}getCoordY(e,s){return F(0),0}getCoordZ(e,s){return F(0),0}setPreferredAxisX(e){F(0)}getOrigin(){return F(0),{}}getNormal(){return F(0),{}}getAxisX(){return this.m_axisX.clone()}getAxisY(){return this.m_axisY.clone()}setAxisX(e,s=!1){F(0)}setAxisY(e,s=!1){F(0)}recalculateAxisY(){F(0)}setOrigin(e){F(0)}setNormal(e,s){F(0)}intersect(e,s){return F(0),!1}intersectLine(e){return F(0),0}intersectLineEx(e,s){return F(0),0}closestCoordinate(e){const s=e.sub(this.m_origin),i=new M;return i.x=s.dotProduct(this.m_axisX),i.y=s.dotProduct(this.m_axisY),i}projectVector(e){return F(0),{}}signedDistance(e){return F(0),0}distance(e){return F(0),0}}function wst(t,e){return!1}function W9(t,e,s,i,r=100,n=wst){let o,a,l,u,c,h,m,f,g;F(i>0);let v,b,w,S=0,T=0;const P=V8();e>s&&(s=be(e,e=s));const I=t(e),A=t(s);I<A?(o=a=l=e,u=c=h=I):(o=a=l=s,u=c=h=A);let D=0;for(;D<r&&(w=.5*(s-e),g=e+w,v=i*(Math.abs(o)+.25),b=2*v,!(n(o,u)||Math.abs(o-g)<=b-w));++D){if(Math.abs(T)>v){const k=(o-a)*(u-h);let R=(o-l)*(u-c),O=(o-l)*R-(o-a)*k;R=2*(R-k),R>0&&(O=-O),R=Math.abs(R);const z=T;T=S,Math.abs(O)>=Math.abs(R*z*.5)||O<=R*(e-o)||O>=R*(s-o)?(T=o>=g?e-o:s-o,S=V8()*T):(S=O/R,f=o+S,(f-e<b||s-f<b)&&(S=g-o<0?-Math.abs(v):Math.abs(v)))}else T=o>=g?e-o:s-o,S=T*P;f=o+S,m=t(f),m<u?(f>=o?e=o:s=o,l=a,a=o,o=f,h=c,c=u,u=m):(f<o?e=f:s=f,m<=c||a===o?(l=a,a=f,h=c,c=m):(m<=h||l===o||l===a)&&(l=f,h=m))}return Zi(o,u)}function IG(t,e,s){return t>s?t-=Math.ceil((t-s)/MS)*MS:t<e&&(t+=Math.ceil((e-t)/MS)*MS),t}function or(t,e,s){return Sst(t,e,s,0)}function Sst(t,e,s,i){const r=s.x,n=s.y;return sve(t,e,Math.cos(r),Math.sin(r),Math.cos(n),Math.sin(n),i)}function Est(t,e,s,i,r,n){return sve(t,e,s,i,r,n,0)}function sve(t,e,s,i,r,n,o){const a=t/Math.sqrt(1-e*n*n),l=a+o,u=l*r*s,c=l*r*i,h=(a*(1-e)+o)*n;return gt.construct(u,c,h)}function oD(t,e,s){const i=new le,r=new le,n=new le,o=new le;i.setCos(s.x),r.setSin(s.x),n.setCos(s.y),o.setSin(s.y);const a=o.negate().mulE(o.mul(e)).add(1).sqrt(),l=new le(t).divE(a),u=l.mulE(n).mulE(i),c=l.mulE(n).mulE(r),h=l.mul(1-e).mulE(o);return new ld(u,c,h)}function Hb(t,e,s){const i=s.x,r=s.y,n=s.z,o=Math.atan2(r,i),a=Math.sqrt(i*i+r*r),l=Math.atan2(n,(1-e)*a);return M.construct(o,l)}function kS(t,e,s){const i=1-e,r=t/Math.sqrt(Pt(s.x)+Pt(s.y)+Pt(s.z)/i);return s.mul(r)}function Cst(t,e,s,i,r){const n=or(t,e,s),o=or(t,e,i);return Hb(t,e,gt.lerp(n,o,r))}function MG(t,e,s){const i=new gt;return i.setCrossProductVector(e,s),Math.abs(Math.atan2(i.length(),e.dotProduct(s)))*t}function Pst(t,e,s,i,r){const n=s.getUnitVector(),o=i.getUnitVector(),a=e.getUnitVector(),l=new gt;if(l.setCrossProductVector(n,o),!l.isZero()){l.normalizeThis();const h=a.sub(l.mul(l.dotProduct(a)));if(!h.isZero()){h.normalizeThis();const m=n.add(o).mul(.5);if(m.dotProduct(h)>m.dotProduct(n)){const f=Math.abs(l.dotProduct(a)),g=Math.asin(f);return r.assign(h.getUnitVector().mul(t)),g*t}}}const u=MG(1,n,a),c=MG(1,o,a);return u<=c?(r.assign(s),u*t):(r.assign(i),c*t)}function Tst(t,e,s,i){const r={stack:[],error:void 0,hasError:!1};try{const n=mo(r,new wn,!1);return Sa.geodeticDistance(t,e,s.x,s.y,i.x,i.y,n,null,null,We.PE_LINETYPE_GEODESIC),n.val}catch(n){r.error=n,r.hasError=!0}finally{Od(r)}}function Ist(t,e,s,i,r){switch(F(s.isFinite()&&i.isFinite()),r){case 0:return Tst(t,e,s,i);case 1:return Ast(t,e,s);case 2:case 3:{const n=or(t,e,s),o=or(t,e,i);return gt.distance(n,o)}default:yt("")}}function FS(t,e,s,i,r,n=0,o){if(n===2||n===3)return Mst(t,e,s,i,r,n===3,o);const a=Hb(t,e,s),l=c=>{const h=Hb(t,e,gt.lerp(i,r,c));return Ist(t,e,a,h,n)},u=gt.distance(i,r);if(u>0){const c=nve(t,u),{first:h,second:m}=W9(l,0,1,c);return o&&o.assign(kS(t,e,gt.lerp(i,r,h))),Zi(h,m)}{const c=l(0);return o&&o.assign(i),Zi(.5,c)}}function Mst(t,e,s,i,r,n=!1,o){const a=kS(t,e,s);if(n){const c=new xst({pt0:new gt(0,0,0),pt1:i,pt2:r}),h=c.closestCoordinate(s),m=c.closestCoordinate(i),f=c.closestCoordinate(r),g=M.getClosestCoordinate(m,f,h),v=kS(t,e,gt.lerp(i,r,g)),b=gt.distance(v,a);return o&&o.assign(v),Zi(g,b)}const l=c=>{const h=kS(t,e,gt.lerp(i,r,c));return gt.distance(h,a)},u=gt.distance(i,r);if(u>0){const c=nve(t,u),{first:h,second:m}=W9(l,0,1,c);return o&&o.assign(kS(t,e,gt.lerp(i,r,h))),Zi(h,m)}{const c=gt.distance(s,i);return o&&o.assign(s),Zi(.5,c)}}function Ast(t,e,s,i){const r={stack:[],error:void 0,hasError:!1};try{const n=mo(r,new wn,!1);return Sa.greatEllipticDistance(t,e,s.x,s.y,s.x,s.y,n,null,null),n.val}catch(n){r.error=n,r.hasError=!0}finally{Od(r)}}function Nst(t,e,s,i,r){if(Math.abs(s.x-i.x)>Math.PI||Math.abs(s.y)>Nt||Math.abs(i.y)>Nt||(Math.abs(s.y)===Nt||Math.abs(i.y)===Nt)&&s.x!==i.x)return Number.NaN;const{first:n,second:o}=cJe(s.x,i.x);let a=r;if(a=IG(a,n,o),!de.construct(s.x,i.x).containsCoordinate(a))return Number.NaN;const l=je.constructPoint2D(s),u=je.constructPoint2D(i),c=oD(1,e,l),h=oD(1,e,u),m=c.crossProductVector(h);if(m.z.isZero())return s.y;const f=m.x.divE(m.z.negate()),g=m.y.divE(m.z.negate()),v=f.mulE(f).addE(g.mulE(g)).sqrt();if(v.isZero()||f.isZero()&&g.isZero())return s.y;const b=Math.atan2(g.value(),f.value());let w=Math.atan2(v.value()*Math.cos(b-a),1-e);const S=or(1,e,M.construct(a,w)),T=gt.construct(S.x,S.y,-S.z),P=m.value().dotProduct(S),I=m.value().dotProduct(T);return Math.abs(I)<Math.abs(P)&&(w=-w),w}function ive(t,e,s,i,r,n){if(n[0]=Number.NaN,n[1]=Number.NaN,Math.abs(s.x-i.x)>Math.PI||Math.abs(s.y)>Nt||Math.abs(i.y)>Nt||(Math.abs(s.y)===Nt||Math.abs(i.y)===Nt)&&s.x!==i.x||Math.abs(r)>=Nt||s.y>0&&i.y>0&&s.y>r&&i.y>r||s.y<0&&i.y<0&&s.y<r&&i.y<r)return 0;const o=je.constructPoint2D(s),a=je.constructPoint2D(i),l=oD(1,e,o),u=oD(1,e,a),c=l.crossProductVector(u);if(c.z.isZero())return de.construct(s.y,i.y).containsCoordinate(r)?(n[0]=s.x,1):0;const h=c.x.divE(c.z.negate()),m=c.y.divE(c.z.negate()),f=h.mulE(h).addE(m.mulE(m)).sqrt();if(f.isZero()||h.isZero()&&m.isZero())return r===0?(n[0]=s.x,n[1]=i.x,2):0;const g=(1-e)*Math.tan(r)/f.value();if(Math.abs(g)>1)return 0;const v=Math.acos(g),b=Math.atan2(m.value(),h.value()),w=b-v;let S=b+v;const T=Math.min(s.x,i.x),P=Math.max(s.x,i.x);IG(w,T,P),r!==0?IG(S,T,P):S=w;let I=0;return T<=w&&w<=P&&(n[I]=w,I++),S!==w&&T<=S&&S<=P&&(n[I]=S,I++),I}function Tre(t,e){e[0]>.5*Math.PI?(t[0]+=Math.PI,e[0]=Math.PI-e[0]):e[0]<.5*-Math.PI&&(t[0]-=Math.PI,e[0]=-Math.PI-e[0]),F(e[0]>=.5*-Math.PI&&e[0]<=.5*Math.PI)}function Dst(t,e){return t*Math.sqrt(1-e)}function $st(t){return 1-t}function Rst(t,e,s,i,r){i=ys(i,-Nt,Nt),r=ys(r,-Nt,Nt);const n=Nt-.03;let o;return o=i>n&&r>n||i<-n&&r<-n?kst(t,i,r):Ire(t,r)-Ire(t,i),.5*(s-e)*o*$st(t)}function kst(t,e,s){let i=1;if(e<0&&(i=-1,e=-e,s=-s),t!==0){const r=t*t,n=r*t,o=[1,(1+11*t)/12,(1+118*t+241*r)/360,(1+1089*t+10419*r+8651*n)/20160,(1+9836*t+318246*r+1027436*n+458881*(n*t))/1814400],a=u=>{let c=0;const h=Pt(u)/(t-1);for(let m=o.length-1;m>=0;--m)c=o[m]+c*h;return c*=-Pt(u/(1-t)),c},l=a(Nt-e);return(a(Nt-s)-l)*i}{const r=Nt-e,n=Nt-s,o=-4*Pt(Math.sin(r/2));return(-4*Pt(Math.sin(n/2))-o)*i}}function Ire(t,e){if(e===0)return 0;const s=Math.sin(e);let i=s,r=s;if(t!==0){i/=1-t*s*s;const n=Math.sqrt(t);r=s*uJe(n*s)}return i+r}function Fst(t,e){return t/Math.sqrt(1-e)}function rve(t,e){return(1-e)*t}function Ost(t,e,s){const i=s/(2*rve(t,e)),r=i*i;return s*(1-r*(.16666666666666666-.008333333333333333*r))}function nve(t,e){if(e!==0){const s=t*EJe()/e;return Math.min(s,1e-10)}return 0}class CP{constructor(e){this.m_currentShift=63n,this.m_currentElt=0n,this.m_iCurrentElt=-1,this.m_parent=e,this.m_aiSetElts=e.m_bits.flatMap((s,i)=>i)}next(){if(this.m_currentShift++,this.m_currentShift===64n){if(this.m_iCurrentElt++,this.m_iCurrentElt===this.m_aiSetElts.length)return CP.npos();this.m_currentShift=0n,this.m_currentElt=this.m_parent.m_bits[this.m_aiSetElts[this.m_iCurrentElt]]}for(;this.m_currentShift<63n&&!(this.m_currentElt&1n<<this.m_currentShift);)this.m_currentShift++;return this.m_currentElt&1n<<this.m_currentShift?64*this.m_aiSetElts[this.m_iCurrentElt]+Number(this.m_currentShift):this.next()}static npos(){return Number.MAX_SAFE_INTEGER}}function gL(t){return 1n<<(0x3fn&BigInt(t))}function yL(t){return t>>6}class ac{constructor(e){this.m_bits=[],e!==void 0&&e.copy&&(this.m_bits=e.copy.m_bits.slice())}assignMove(){return this}assignCopy(){return this}hasBit(e){const s=gL(e),i=yL(e);return this.m_bits[i]!==void 0&&!!(this.m_bits[i]&s)}setBit(e){const s=gL(e),i=yL(e);this.m_bits[i]===void 0&&(this.m_bits[i]=0n),this.m_bits[i]|=s}clearBit(e){}flipBit(e){const s=gL(e),i=yL(e);return this.m_bits[i]===void 0&&(this.m_bits[i]=0n),this.m_bits[i]^=s,(this.m_bits[i]&s)!==0n}clear(){this.m_bits.length=0}isZero(){let e=0;return this.m_bits.forEach(s=>{e|=s?2:1}),!(2&e)}equals(e){if(this===e)return!0;if(this.m_bits.length!==e.m_bits.length)return!1;let s=0;return this.m_bits.forEach((i,r)=>{s|=i===e.m_bits[r]?2:1}),!(1&s)&&(e.m_bits.forEach((i,r)=>{s|=i===this.m_bits[r]?2:1}),!(1&s))}notEquals(e){return!this.equals(e)}assignOr(e){return e.m_bits.forEach((s,i)=>{this.m_bits[i]===void 0?this.m_bits[i]=s:this.m_bits[i]|=s}),this}assignSubtract(e){return e.m_bits.forEach((s,i)=>{this.m_bits[i]!==void 0&&(this.m_bits[i]&=~s)}),this}assignAnd(e){return e.m_bits.forEach((s,i)=>{this.m_bits[i]!==void 0&&(this.m_bits[i]&=s)}),this}assignXor(e){return e.m_bits.forEach((s,i)=>{this.m_bits[i]===void 0?this.m_bits[i]=s:this.m_bits[i]^=s}),this}getHashCode(){return this.m_bits.reduce((e,s)=>$Je(e,s),kc(0))}getUnorderedBitIterator(){return new CP(this)}}class Lst{constructor(e,s){this.m_map=new Map,this.m_hf=e,this.m_ef=s}add(e){const s=this.m_hf(e);if(!this.m_map.has(s))return this.m_map.set(s,e),this;const i=this.m_map.get(s);return i instanceof Array?i.find(r=>this.m_ef(r,e))||i.push(e):this.m_ef(i,e)||this.m_map.set(s,[i,e]),this}clear(){this.m_map.clear()}delete(e){return!1}has(e){const s=this.m_hf(e);if(!this.m_map.has(s))return!1;const i=this.m_map.get(s);return i instanceof Array?i.find(r=>this.m_ef(r,e))!==void 0:this.m_ef(i,e)}get(e){const s=this.m_hf(e),i=this.m_map.get(s);if(i!==void 0)return i instanceof Array?i.find(r=>this.m_ef(r,e)):i}get size(){let e=0;for(const s of this.m_map.values())e+=s instanceof Array?s.length:1;return e}forEach(e,s){}[Symbol.iterator](){return new Set()[Symbol.iterator]()}entries(){return new Set().entries()}keys(){return new Set().keys()}values(){return new Set().values()}get[Symbol.toStringTag](){return"ValueSet"}}class Vst extends E0{constructor(e){super(),this.m_bufferLeft=new ut,this.m_bufferRight=new ut,this.m_intervalLeft=de.constructEmpty(),this.m_intervalRight=de.constructEmpty(),this.m_yScanline=Number.NaN,this.m_helper=e}compare(e,s,i){const r=s,n=e.getElement(i);this.m_helper.querySegmentXY(r,this.m_bufferLeft),this.m_helper.querySegmentXY(n,this.m_bufferRight);const o=this.m_bufferLeft.get(),a=this.m_bufferRight.get();if(this.m_intervalLeft.setCoords(o.getStartX(),o.getEndX()),this.m_intervalRight.setCoords(a.getStartX(),a.getEndX()),this.m_intervalLeft.vmax<this.m_intervalRight.vmin)return-1;if(this.m_intervalLeft.vmin>this.m_intervalRight.vmax)return 1;const l=o.getStartY()===o.getEndY(),u=a.getStartY()===a.getEndY();if(l||u){if(l&&u)return 0;if(o.getStartY()===a.getStartY()&&o.getStartX()===a.getStartX())return l?1:-1;if(o.getEndY()===a.getEndY()&&o.getEndX()===a.getEndX())return l?-1:1}let c=o.intersectionOfYMonotonicWithAxisX(this.m_yScanline,this.m_intervalLeft.vmin),h=a.intersectionOfYMonotonicWithAxisX(this.m_yScanline,this.m_intervalRight.vmin);if(c===h){const m=o.getEndY(),f=a.getEndY(),g=Math.min(m,f);let v=.5*(g+this.m_yScanline);v===this.m_yScanline&&(v=g),c=o.intersectionOfYMonotonicWithAxisX(v,this.m_intervalLeft.vmin),h=a.intersectionOfYMonotonicWithAxisX(v,this.m_intervalRight.vmin)}return c<h?-1:c>h?1:0}setY(e){this.m_yScanline=e}}class qst{constructor(e){this.m_segmentBuffer=new ut,this.m_point=M.getNAN(),this.m_parent=e}setPointXY(e){this.m_point.assign(e)}compare(e,s){const i=e.getElement(s);this.m_parent.querySegmentXY(i,this.m_segmentBuffer);const r=this.m_segmentBuffer.get(),n=new de;if(n.setCoords(r.getStartX(),r.getEndX()),this.m_point.x<n.vmin)return-1;if(this.m_point.x>n.vmax)return 1;const o=r.intersectionOfYMonotonicWithAxisX(this.m_point.y,this.m_point.x);return this.m_point.x<o?-1:this.m_point.x>o?1:0}}var oo,bf;function Mre(t,e){return{parentage:t,rank:e}}function Gst(t,e){const s=t.length;if(s!==e.length)return!1;const i=t[0].parentage;if(i!==e[0].parentage)return!1;if(i===-1)return!0;for(let r=1;r<s;++r)if(t[r].parentage!==e[r].parentage)return!1;return!0}function Are(t,e,s){s.length=0;let i=!1;{let r=t.getHalfEdgeVertexIterator(e);for(;r!==L;){const n=t.getVertexFromVertexIterator(r),o=t.getShape().getSegmentRank(n),a=t.getShape().getSegmentParentage(n);i||(i=a>=0),s.push(Mre(a,o)),r=t.incrementVertexIterator(r)}}{let r=t.getHalfEdgeVertexIterator(t.getHalfEdgeTwin(e));for(;r!==L;){const n=t.getVertexFromVertexIterator(r),o=t.getShape().getSegmentRank(n),a=t.getShape().getSegmentParentage(n);i||(i=a>=0),s.push(Mre(a,o)),r=t.incrementVertexIterator(r)}}i&&s.sort((r,n)=>r.rank>n.rank?-1:r.rank<n.rank?1:r.parentage<n.parentage?-1:r.parentage>n.parentage?1:0),s[0].parentage===-1&&(s.length=1)}function zst(){return new Lst(t=>t.getHashCode(),(t,e)=>t.equals(e))}(function(t){t[t.enumInputModeBuildGraph=0]="enumInputModeBuildGraph",t[t.enumInputModeSimplifyAlternate=1]="enumInputModeSimplifyAlternate",t[t.enumInputModeSimplifyWinding=2]="enumInputModeSimplifyWinding"})(oo||(oo={})),function(t){t[t.enumSegmentParentageBreakNode=1]="enumSegmentParentageBreakNode",t[t.enumPathBreakNode=2]="enumPathBreakNode"}(bf||(bf={}));class Fl{constructor(){this.m_shape=null,this.m_clusterData=new et(8),this.m_clusterVertices=new et(2),this.m_firstCluster=L,this.m_lastCluster=L,this.m_halfEdgeData=new et(8),this.m_chainData=new et(8),this.m_chainAreas=null,this.m_chainPerimeters=null,this.m_universeChain=-1,this.m_simplifiedGeometry=-1,this.m_edgeIndices=[],this.m_clusterIndices=[],this.m_chainIndices=[],this.m_bBuildGeometryParentageSets=!1,this.m_chainBitSetIndex=-1,this.m_edgeBitSetIndex=-1,this.m_edgeBitSetIndexLeft=-1,this.m_emptyBitSet=null,this.m_geometryMapID=null,this.m_uniqueBitSets=null,this.m_chainBitSets=[],this.m_edgeBitSets=[],this.m_checkDirtyPlanesweepTolerance=Number.NaN,this.m_geometryIDIndex=-1,this.m_clusterIndex=-1,this.m_halfEdgeIndex=-1,this.m_tmpHalfEdgeParentageIndex=-1,this.m_tmpHalfEdgeParentageIndexLeft=-1,this.m_tmpHalfEdgeWindingNumberIndex=-1,this.m_tmpHalfEdgeOddEvenNumberIndex=-1,this.m_segmentParentageIndex=-1,this.m_segmentIndexHe=-1,this.m_clusterBreakNodeIndex=-1,this.m_universeGeomID=-1,this.m_pointCount=0,this.m_progressCounter=0,this.m_bBuildChains=!0,this.m_bDirtyCheckFailed=!1}setCheckDirtyPlanesweepTolerance(e){this.m_checkDirtyPlanesweepTolerance=e}dirtyCheckFailed(){return this.m_bDirtyCheckFailed}getShape(){return this.m_shape}setEditShape(e,s,i=!0,r=!1){r?this.setEditShapeImpl3D_(e,oo.enumInputModeBuildGraph,null,s,!1):this.setEditShapeImpl_(e,oo.enumInputModeBuildGraph,null,s,i)}setAndSimplifyEditShapeAlternate(e,s,i=null,r=!1){const n=[];n.push(s),this.m_simplifiedGeometry=s,r?this.setEditShapeImpl3D_(e,oo.enumInputModeSimplifyAlternate,n,i,!1):this.setEditShapeImpl_(e,oo.enumInputModeSimplifyAlternate,n,i,e.getGeometryType(s)===G.enumPolygon)}setAndSimplifyEditShapeWinding(e,s,i=null){const r=[];r.push(s),this.m_simplifiedGeometry=s,this.setEditShapeImpl_(e,oo.enumInputModeSimplifyWinding,r,i,!0)}removeShape(){this.m_shape!==null&&(this.m_geometryIDIndex!==-1&&(this.m_shape.removeGeometryUserIndex(this.m_geometryIDIndex),this.m_geometryIDIndex=-1),this.m_clusterIndex!==-1&&(this.m_shape.removeUserIndex(this.m_clusterIndex),this.m_clusterIndex=-1),this.m_halfEdgeIndex!==-1&&(this.m_shape.removeUserIndex(this.m_halfEdgeIndex),this.m_halfEdgeIndex=-1),this.m_tmpHalfEdgeParentageIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndex),this.m_tmpHalfEdgeParentageIndex=-1),this.m_tmpHalfEdgeParentageIndexLeft!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndexLeft),this.m_tmpHalfEdgeParentageIndexLeft=-1),this.m_tmpHalfEdgeWindingNumberIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeWindingNumberIndex),this.m_tmpHalfEdgeWindingNumberIndex=-1),this.m_tmpHalfEdgeOddEvenNumberIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeOddEvenNumberIndex),this.m_tmpHalfEdgeOddEvenNumberIndex=-1),this.m_segmentParentageIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_segmentParentageIndex),this.m_segmentParentageIndex=-1),this.m_segmentIndexHe!==-1&&(this.deleteUserIndexForHalfEdges(this.m_segmentIndexHe),this.m_segmentIndexHe=-1),this.m_clusterBreakNodeIndex!==-1&&(this.deleteUserIndexForClusters(this.m_clusterBreakNodeIndex),this.m_clusterBreakNodeIndex=-1),this.deleteEdgeBitSets_(),this.deleteChainBitSets_(),this.m_emptyBitSet=null,this.m_geometryMapID=null,this.m_shape=null,this.m_clusterData.deleteAll(!0),this.m_clusterVertices.deleteAll(!0),this.m_firstCluster=L,this.m_lastCluster=L,this.m_halfEdgeData.deleteAll(!0),this.m_edgeIndices.length=0,this.m_clusterIndices.length=0,this.m_chainIndices.length=0,this.m_chainData.deleteAll(!0),this.m_universeChain=L,this.m_chainAreas=null)}getClusterHalfEdge(e){return this.m_clusterData.getField(e,2)}queryXY(e,s){const i=this.getClusterVertexIndex_(e);s.assign(this.m_shape.getXYWithIndex(i))}queryXYZ(e,s){F(0)}getClusterParentage(e){return this.m_clusterData.getField(e,1)}getFirstCluster(){return this.m_firstCluster}getPrevCluster(e){return this.m_clusterData.getField(e,3)}getNextCluster(e){return this.m_clusterData.getField(e,4)}getClusterChain(e){return this.m_clusterData.getField(e,6)}getClusterVertexIterator(e){return this.m_clusterData.getField(e,7)}incrementVertexIterator(e){return this.m_clusterVertices.getField(e,1)}getVertexFromVertexIterator(e){return this.m_clusterVertices.getField(e,0)}getClusterUserIndex(e,s){const i=this.getClusterIndex_(e),r=this.m_clusterIndices[s];return r.size()<=i?-1:r.read(i)}setClusterUserIndex(e,s,i){const r=this.getClusterIndex_(e),n=this.m_clusterIndices[s];n.size()<=r&&n.resize(this.m_clusterData.size(),-1),n.write(r,i)}hasClusterUserIndexFlags(e,s,i){if(s===-1)return!1;const r=this.getClusterUserIndex(e,s);return r!==-1&&!!(i&r)}setClusterUserIndexFlags(e,s,i){const r=this.getClusterIndex_(e),n=this.m_clusterIndices[s];n.size()<=r&&n.resize(this.m_clusterData.size(),-1);let o=n.read(r);o===-1&&(o=0),n.write(r,i|o)}clearClusterUserIndexFlags(e,s,i){const r=this.getClusterIndex_(e),n=this.m_clusterIndices[s];n.size()<=r&&n.resize(this.m_clusterData.size(),-1);let o=n.read(r);o===-1&&(o=0),n.write(r,~i&o)}createUserIndexForClusters(e=-1){const s=new Qs(this.m_clusterData.capacity(),e);for(let i=0,r=this.m_clusterIndices.length;i<r;i++)if(this.m_clusterIndices[i]===null)return this.m_clusterIndices[i]=s,i;return this.m_clusterIndices.push(s),this.m_clusterIndices.length-1}deleteUserIndexForClusters(e){this.m_clusterIndices[e]=null}getHalfEdgeOrigin(e){return this.m_halfEdgeData.getField(e,1)}getHalfEdgeTo(e){return this.getHalfEdgeOrigin(this.getHalfEdgeTwin(e))}getHalfEdgeTwin(e){return this.m_halfEdgeData.getField(e,4)}getHalfEdgePrev(e){return this.m_halfEdgeData.getField(e,5)}getHalfEdgeNext(e){return this.m_halfEdgeData.getField(e,6)}getHalfEdgeChain(e){return this.m_halfEdgeData.getField(e,2)}getHalfEdgeFaceParentage(e){return this.getChainParentage(this.getHalfEdgeChain(e))}getHalfEdgeVertexIterator(e){return this.m_halfEdgeData.getField(e,7)}getHalfEdgeFromXY(e,s){this.queryXY(this.getHalfEdgeOrigin(e),s)}getHalfEdgeToXY(e,s){this.queryXY(this.getHalfEdgeTo(e),s)}isHalfEdgeCurve(e){return this.m_segmentIndexHe!==-1?this.getHalfEdgeUserIndex(e,this.m_segmentIndexHe)!==-1:!1}getHalfEdgeFromXYZ(e,s){F(0)}getHalfEdgeToXYZ(e,s){F(0)}getHalfEdgeParentage(e){return this.m_halfEdgeData.getField(e,3)&Fl.c_EdgeParentageMask}getHalfEdgeUserIndex(e,s){const i=this.getHalfEdgeIndex_(e),r=this.m_edgeIndices[s];return r.size()<=i?-1:r.read(i)}setHalfEdgeUserIndex(e,s,i){const r=this.getHalfEdgeIndex_(e),n=this.m_edgeIndices[s];n.size()<=r&&n.resize(this.m_halfEdgeData.size(),-1),n.write(r,i)}createUserIndexForHalfEdges(e){e===void 0&&(e=-1);const s=new Qs(this.m_halfEdgeData.capacity(),e);for(let r=0,n=this.m_edgeIndices.length;r<n;r++)if(this.m_edgeIndices[r]===null)return this.m_edgeIndices[r]=s,r;this.m_edgeIndices.push(s);const i=this.m_edgeIndices.length-1;return F(i>=0&&i<=Number.MAX_SAFE_INTEGER),i}deleteUserIndexForHalfEdges(e){this.m_edgeIndices[e]=null}deleteEdgesBreakFaces_(e){for(let s=0,i=e.length;s<i;s++){const r=e[s],n=this.getHalfEdgeChain(r),o=this.getHalfEdgeTwin(r),a=this.getHalfEdgeChain(o);this.setChainHalfEdge_(n,L),this.setChainHalfEdge_(a,L),this.updateVertexToHalfEdgeConnection_(r,!0),this.deleteEdgeImpl_(r)}}doesHalfEdgeBelongToAPolygonInterior(e,s){return F(0),!1}doesHalfEdgeBelongToAPolygonExterior(e,s){return F(0),!1}doesHalfEdgeBelongToAPolygonBoundary(e,s){return F(0),!1}doesHalfEdgeBelongToAPolylineInterior(e,s){return F(0),!1}doesHalfEdgeBelongToAPolylineExterior(e,s){return F(0),!1}doesClusterBelongToAPolygonInterior(e,s){return F(0),!1}doesClusterBelongToAPolygonExterior(e,s){return F(0),!1}doesClusterBelongToAPolygonBoundary(e,s){return F(0),!1}getFirstChain(){return this.m_universeChain}getChainHalfEdge(e){return this.m_chainData.getField(e,1)}getChainParentage(e){return this.m_chainData.getField(e,2)}getChainParent(e){return this.m_chainData.getField(e,3)}getChainFirstIsland(e){return this.m_chainData.getField(e,4)}getChainNextInParent(e){return this.m_chainData.getField(e,5)}getChainNext(e){return this.m_chainData.getField(e,7)}getChainArea(e){const s=this.getChainIndex_(e);let i=this.m_chainAreas.read(s);return Number.isNaN(i)&&(this.updateChainAreaAndPerimeter_(e),i=this.m_chainAreas.read(s)),i}getChainPerimeter(e){return F(0),0}getChainUserIndex(e,s){const i=this.getChainIndex_(e),r=this.m_chainIndices[s];return r.size()<=i?-1:r.read(i)}setChainUserIndex(e,s,i){const r=this.getChainIndex_(e),n=this.m_chainIndices[s];n.size()<=r&&n.resize(this.m_chainData.size(),-1),n.write(r,i)}createUserIndexForChains(){const e=new Qs(this.m_chainData.capacity(),-1);for(let s=0,i=this.m_chainIndices.length;s<i;s++)if(this.m_chainIndices[s]===null)return this.m_chainIndices[s]=e,s;return this.m_chainIndices.push(e),this.m_chainIndices.length-1}deleteUserIndexForChains(e){this.m_chainIndices[e]=null}extractPolygonFromChainAndIslands(e,s,i,r){const n=s===L?e.createGeometry(G.enumPolygon):s,o=new ut;this.extractPolygonPathFromChain_(e,n,i,r,o);for(let a=this.getChainFirstIsland(i);a!==L;a=this.getChainNextInParent(a))this.extractPolygonPathFromChain_(e,n,a,r,o);return n}getGeometryID(e){const s=this.m_shape.getGeometryUserIndex(e,this.m_geometryIDIndex);return F(s>=0),1<<Math.min(s,31)}getClusterFromVertex(e){return this.m_shape.getUserIndex(e,this.m_clusterIndex)}getHalfEdgeFromVertex(e){return this.m_shape.getUserIndex(e,this.m_halfEdgeIndex)}buildGeometryParentageSets(){this.m_bBuildGeometryParentageSets=!0}getChainBitSet(e){if(F(this.m_bBuildGeometryParentageSets),this.m_chainBitSetIndex===-1)return this.getEmptySet();const s=this.getChainUserIndex(e,this.m_chainBitSetIndex);F(s>=0);let i=this.m_chainBitSets.at(s);return i||(i=this.getEmptySet()),i}getChainBoundaryBitSet(e){F(this.m_bBuildGeometryParentageSets);const s=new ac,i=r=>{const n=this.getChainHalfEdge(r);let o=n;do{const a=this.getEdgeBitSet_(o);a!==null&&s.assignOr(a);const l=this.getEdgeBitSet_(this.getHalfEdgeTwin(o));l!==null&&s.assignOr(l),o=this.getHalfEdgeNext(o)}while(o!==n)};i(e);for(let r=this.getChainFirstIsland(e);r!==L;r=this.getChainNextInParent(r))i(e);return s}getChainPolygons(e){return F(0),[]}getGeometriesFromBits(e){if(!this.m_bBuildGeometryParentageSets||e===null)return[];if(this.m_geometryMapID===null){this.m_geometryMapID=new Map;for(let r=this.m_shape.getFirstGeometry();r!==L;r=this.m_shape.getNextGeometry(r))this.m_geometryMapID.set(this.m_shape.getGeometryUserIndex(r,this.m_geometryIDIndex),r)}const s=[],i=e.getUnorderedBitIterator();for(let r=i.next();r!==CP.npos();r=i.next())F(this.m_geometryMapID.has(r)),s.push(this.m_geometryMapID.get(r));return s}getVertexDominant(e,s){if(s===L)return e;const i=this.getClusterFromVertex(e);return this.getVertexDominantFromCluster(i,s)}getVertexDominantFromCluster(e,s){if(s!==L){let i=L;for(let r=this.getClusterVertexIterator(e);r!==L;r=this.incrementVertexIterator(r)){const n=this.getVertexFromVertexIterator(r);i===L&&(i=n);const o=this.m_shape.getPathFromVertex(n);if(this.m_shape.getGeometryFromPath(o)===s){i=n;break}}return i}{const i=this.getClusterVertexIterator(e);return i!==L?this.getVertexFromVertexIterator(i):L}}isBreakNode(e){return this.hasClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,bf.enumSegmentParentageBreakNode)}setBreakNode(e,s){F(this.m_clusterBreakNodeIndex!==-1),s?this.setClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,bf.enumSegmentParentageBreakNode):this.clearClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,bf.enumSegmentParentageBreakNode)}isStrongPathNode(e){return this.hasClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,bf.enumPathBreakNode)}setStrongPathNode(e,s){if(this.m_clusterBreakNodeIndex===-1){if(!s)return;this.m_clusterBreakNodeIndex=this.createUserIndexForClusters()}s?this.setClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,bf.enumPathBreakNode):this.clearClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,bf.enumPathBreakNode)}getSegmentParentage(e){if(this.m_segmentParentageIndex===-1)return-1;const s=this.getHalfEdgeUserIndex(e,this.m_segmentParentageIndex);return s>=0?s:-1}isCrossroadAhead(e){const s=this.getHalfEdgeNext(e);if(this.isStrongPathNode(this.getHalfEdgeOrigin(s)))return!0;const i=this.getHalfEdgeTwin(s),r=this.getHalfEdgeNext(i);return e!==this.getHalfEdgeTwin(r)}isCrossroadBehind(e){return F(0),!1}getHalfEdgeConnector(e,s){const i=this.getClusterHalfEdge(e);if(i===L)return L;let r=i,n=L,o=L;do{if(this.getHalfEdgeTo(r)===s)return r;if(n===L){if(n=this.getClusterHalfEdge(s),n===L)return L;o=n}if(this.getHalfEdgeTo(o)===e)return r=this.getHalfEdgeTwin(o),r;r=this.getHalfEdgeNext(this.getHalfEdgeTwin(r)),o=this.getHalfEdgeNext(this.getHalfEdgeTwin(o))}while(r!==i&&o!==n);return L}querySegmentXY(e,s){if(this.m_segmentIndexHe!==-1){let n=this.getHalfEdgeUserIndex(e,this.m_segmentIndexHe);if(n!==-1){if(n!==-2){const o=this.m_shape.getSegmentFromIndex(n);s.copyFrom(o,!0)}else{n=this.getHalfEdgeUserIndex(this.getHalfEdgeTwin(e),this.m_segmentIndexHe);const o=this.m_shape.getSegmentFromIndex(n);s.copyFrom(o,!0),s.get().reverse()}return}}s.createLine();const i=s.get(),r=M.getNAN();this.getHalfEdgeFromXY(e,r),i.setStartXY(r),this.getHalfEdgeToXY(e,r),i.setEndXY(r)}isCurveEdge(e){return this.m_segmentIndexHe!==-1?this.getHalfEdgeUserIndex(e,this.m_segmentIndexHe)!==-1:!1}compareEdgeAnglesCurveHelper_(e,s,i){const r=new ut,n=new ut;this.querySegmentXY(e,r),this.querySegmentXY(s,n);const o=r.get(),a=n.get();if(o.equals(a))return 0;const l=new M;this.getHalfEdgeFromXY(e,l);const u=new M;this.getHalfEdgeToXY(e,u);const c=new M;this.getHalfEdgeToXY(s,c),F(!u.isEqualPoint2D(c));const h=o.getTangent(0),m=a.getTangent(0);return M.compareVectors(h,m)}compareEdgeAnglesHelper_(e,s,i){if(e===s)return 0;if(this.isHalfEdgeCurve(e)||this.isHalfEdgeCurve(s))return this.compareEdgeAnglesCurveHelper_(e,s,i);const r=M.getNAN();this.getHalfEdgeToXY(e,r);const n=M.getNAN();if(this.getHalfEdgeToXY(s,n),r.isEqualPoint2D(n))return 0;const o=M.getNAN();this.getHalfEdgeFromXY(e,o);const a=M.getNAN();a.setSub(r,o);const l=M.getNAN();return l.setSub(n,o),!i||l.y>=0&&a.y>0?M.compareVectors(a,l):0}compareEdgeAngles_(e,s){return this.compareEdgeAnglesHelper_(e,s,!1)}compareEdgeAnglesForPair_(e,s){return this.compareEdgeAnglesHelper_(e,s,!0)}compareEdgeAngles3D_(e,s){return F(0),0}compareEdgeAnglesForPair3D_(e,s){return F(0),0}dbgDumpChains_(){}dbgDumpChainToPolygon_(e,s){}deleteEdgeInternal_(e){const s=this.getHalfEdgeChain(e),i=this.getHalfEdgeTwin(e),r=this.getHalfEdgeChain(i);F(r===s),F(e===this.getHalfEdgeNext(i)||i===this.getHalfEdgeNext(e));let n=this.getHalfEdgeNext(e);n===i&&(n=this.getHalfEdgeNext(n),n===e&&(n=L));const o=this.getChainIndex_(s),a=this.m_chainAreas.read(o);Number.isNaN(a)||(this.setChainArea_(s,Number.NaN),this.setChainPerimeter_(s,Number.NaN));const l=this.getChainHalfEdge(s);l!==e&&l!==i||this.setChainHalfEdge_(s,n),this.updateVertexToHalfEdgeConnection_(e,!0),this.deleteEdgeImpl_(e)}getFirstUnvisitedHalfEdgeOnCluster_(e,s,i){let r=s!==L?s:this.getClusterHalfEdge(e);if(r===L)return L;const n=r;for(;;){if(this.getHalfEdgeUserIndex(r,i)!==1)return r;const o=this.getHalfEdgeNext(this.getHalfEdgeTwin(r));if(o===n)return L;r=o}}removeSpikes_(){let e=!1;const s=this.createUserIndexForHalfEdges();for(let i=this.getFirstCluster();i!==L;i=this.getNextCluster(i)){let r=L;for(;;){let n=this.getFirstUnvisitedHalfEdgeOnCluster_(i,r,s);if(n===L)break;r=this.getHalfEdgeNext(this.getHalfEdgeTwin(n));let o=n;for(;;){const a=this.getHalfEdgeNext(o),l=this.getHalfEdgePrev(o),u=this.getHalfEdgeTwin(o);if(l===u){if(this.deleteEdgeInternal_(o),e=!0,r!==o&&r!==u||(r=L),o===n||l===n){if(n=a,o===n||l===n)break;o=a;continue}}else this.setHalfEdgeUserIndex(o,s,1);if(o=a,o===n)break}}}return this.deleteUserIndexForHalfEdges(s),e}progress_(e,s=!1){}newCluster_(){const e=this.m_clusterData.newElement();return this.m_clusterData.setField(e,1,0),e}newHalfEdgePair_(){const e=this.m_halfEdgeData.newElement();this.m_halfEdgeData.setField(e,2,0),this.m_halfEdgeData.setField(e,3,0);const s=this.m_halfEdgeData.newElement();return this.m_halfEdgeData.setField(s,2,0),this.m_halfEdgeData.setField(s,3,0),this.setHalfEdgeTwin_(e,s),this.setHalfEdgeTwin_(s,e),e}newChain_(){const e=this.m_chainData.newElement();return this.m_chainData.setField(e,2,0),e}deleteChain_(e){return F(0),0}getClusterIndex_(e){return this.m_clusterData.elementToIndex(e)}setClusterVertexIterator_(e,s){this.m_clusterData.setField(e,7,s)}setClusterHalfEdge_(e,s){this.m_clusterData.setField(e,2,s)}setClusterParentage_(e,s){this.m_clusterData.setField(e,1,s)}setPrevCluster_(e,s){this.m_clusterData.setField(e,3,s)}setNextCluster_(e,s){this.m_clusterData.setField(e,4,s)}setClusterVertexIndex_(e,s){this.m_clusterData.setField(e,5,s)}getClusterVertexIndex_(e){return this.m_clusterData.getField(e,5)}setClusterChain_(e,s){this.m_clusterData.setField(e,6,s)}addClusterToExteriorChain_(e,s){this.setClusterChain_(s,e)}getHalfEdgeIndex_(e){return this.m_halfEdgeData.elementToIndex(e)}setHalfEdgeOrigin_(e,s){this.m_halfEdgeData.setField(e,1,s)}setHalfEdgeTwin_(e,s){this.m_halfEdgeData.setField(e,4,s)}setHalfEdgePrev_(e,s){this.m_halfEdgeData.setField(e,5,s)}setHalfEdgeNext_(e,s){this.m_halfEdgeData.setField(e,6,s)}setHalfEdgeChain_(e,s){this.m_halfEdgeData.setField(e,2,s)}setHalfEdgeParentage_(e,s){this.m_halfEdgeData.setField(e,3,s)}getHalfEdgeParentageMask_(e){return this.m_halfEdgeData.getField(e,3)}setHalfEdgeVertexIterator_(e,s){this.m_halfEdgeData.setField(e,7,s)}updateVertexToHalfEdgeConnectionHelper_(e,s){const i=s?L:e;for(let r=this.getHalfEdgeVertexIterator(e);r!==L;r=this.incrementVertexIterator(r)){const n=this.getVertexFromVertexIterator(r);this.m_shape.setUserIndex(n,this.m_halfEdgeIndex,i)}}updateVertexToHalfEdgeConnection_(e,s){e!==L&&(this.updateVertexToHalfEdgeConnectionHelper_(e,s),this.updateVertexToHalfEdgeConnectionHelper_(this.getHalfEdgeTwin(e),s))}getChainIndex_(e){return this.m_chainData.elementToIndex(e)}setChainHalfEdge_(e,s){this.m_chainData.setField(e,1,s)}setChainParentage_(e,s){this.m_chainData.setField(e,2,s)}setChainParent_(e,s){this.m_chainData.setField(e,3,s);const i=this.getChainFirstIsland(s);this.setChainNextInParent_(e,i),this.setChainFirstIsland_(s,e)}setChainFirstIsland_(e,s){this.m_chainData.setField(e,4,s)}setChainNextInParent_(e,s){this.m_chainData.setField(e,5,s)}setChainPrev_(e,s){this.m_chainData.setField(e,6,s)}setChainNext_(e,s){this.m_chainData.setField(e,7,s)}setChainArea_(e,s){const i=this.getChainIndex_(e);this.m_chainAreas.write(i,s)}setChainPerimeter_(e,s){const i=this.getChainIndex_(e);this.m_chainPerimeters.write(i,s)}updateChainAreaAndPerimeter_(e){const s=this.m_shape.hasCurves(),i=new Fr(0),r=new Fr(0),n=this.getChainHalfEdge(e),o=M.getNAN(),a=M.getNAN(),l=M.getNAN();this.getHalfEdgeFromXY(n,o),a.setCoordsPoint2D(o);let u=n;do this.getHalfEdgeToXY(u,l),s&&this.isCurveEdge(u)||r.pe(M.distance(a,l)),this.getHalfEdgeChain(this.getHalfEdgeTwin(u))!==e&&i.pe((l.x-o.x-(a.x-o.x))*(l.y-o.y+(a.y-o.y))*.5),a.setCoordsPoint2D(l),u=this.getHalfEdgeNext(u);while(u!==n);if(s){const h=new ut;u=n;do{this.getHalfEdgeToXY(u,l);const m=this.isCurveEdge(u);if(m&&(this.querySegmentXY(u,h),r.pe(h.get().calculateLength2D())),this.getHalfEdgeChain(this.getHalfEdgeTwin(u))!==e&&m){const f=h.get().calculateArea2DHelper();i.pe(f)}u=this.getHalfEdgeNext(u)}while(u!==n)}const c=this.getChainIndex_(e);this.m_chainAreas.write(c,i.getResult()),this.m_chainPerimeters.write(c,r.getResult())}getChainTopmostEdge_(e){return F(0),0}planeSweepParentage_(e,s){const i=new Vst(this),r=new Xe;r.setCapacity(Math.trunc(this.m_pointCount/2)),r.setComparator(i);const n=[],o=this.createUserIndexForHalfEdges();let a=null;const l=M.getNAN();for(let u=this.getFirstCluster();u!==L;u=this.getNextCluster(u)){this.progress_(s);const c=this.getClusterHalfEdge(u);if(c!==L){if(n.length=0,!this.tryOptimizedInsertion_(r,o,n,u,c)){this.queryXY(u,l),i.setY(l.y);let h=c;do{const m=this.getHalfEdgeUserIndex(h,o);m!==-1&&(r.deleteNode(m),this.setHalfEdgeUserIndex(h,o,et.impossibleIndex2())),h=this.getHalfEdgeNext(this.getHalfEdgeTwin(h))}while(c!==h);h=c;do{if(this.getHalfEdgeUserIndex(h,o)===-1){const m=r.addElement(h);n.push(m)}h=this.getHalfEdgeNext(this.getHalfEdgeTwin(h))}while(c!==h)}for(let h=n.length-1;h>=0;h--){const m=n[h],f=r.getElement(m),g=this.getHalfEdgeTwin(f);this.setHalfEdgeUserIndex(g,o,m),this.planeSweepParentagePropagateParentage_(r,m,e)}}else if(this.getClusterChain(u)===L){a===null&&(a=new qst(this)),this.queryXY(u,l),a.setPointXY(l);const h=r.searchLowerBound(a);let m=this.m_universeChain;if(h!==-1){let f=r.getElement(h);this.getHalfEdgeChain(f)===this.getHalfEdgeChain(this.getHalfEdgeTwin(f))&&(f=this.getLeftSkipPolylines_(r,h)),f!==L&&(m=this.getHalfEdgeChain(f))}this.addClusterToExteriorChain_(m,u)}}this.deleteUserIndexForHalfEdges(o)}planeSweepParentagePropagateParentage_(e,s,i){const r=e.getElement(s),n=this.getHalfEdgeChain(r);if(this.getChainParent(n)!==L)return;const o=this.getLeftSkipPolylines_(e,s),a=this.getHalfEdgeTwin(r),l=this.getHalfEdgeChain(a);let u=this.getChainParent(n),c=this.getChainParent(l);if(o===L)u===L&&(l===n?(this.setChainParent_(l,this.m_universeChain),c=this.m_universeChain,u=c):(c===L&&(this.setChainParent_(l,this.m_universeChain),c=this.m_universeChain),this.setChainParent_(n,l),u=l));else{const h=this.getHalfEdgeChain(o);if(c===L){if(this.getChainArea(h)<=0){const m=this.getChainParent(h);this.setChainParent_(l,m),c=m}else this.setChainParent_(l,h),c=h;l===n&&(u=c)}}u===L&&(this.trySetChainParentFromTwin_(n,l),u=this.getChainParent(n)),F(u!==L),i===oo.enumInputModeBuildGraph?this.propagateParentageBuildGraph_(e,s,r,o):i===oo.enumInputModeSimplifyWinding?this.propagateParentageWinding_(e,s,r,o,a,n,l):i===oo.enumInputModeSimplifyAlternate&&this.propagateParentageAlternate_(e,s,r,o,a,n,l)}propagateParentageBuildGraph_(e,s,i,r){let n,o=s;r===L?(o=e.getNext(o),n=this.getHalfEdgeChain(i)):n=this.getHalfEdgeChain(r);let a=null,l=this.getChainParentage(n);for(this.m_bBuildGeometryParentageSets&&(a=this.getChainBitSet(n));o!==-1;o=e.getNext(o)){const u=e.getElement(o),c=this.getHalfEdgeTwin(u);n=this.getHalfEdgeChain(u);const h=this.getHalfEdgeChain(c);if(this.m_bBuildGeometryParentageSets){let b=this.getChainBitSet(h);b=new ac({copy:b}),b.assignOr(a),this.setChainBitSet_(h,b);let w=this.getChainBitSet(n);const S=this.getLeftEdgeBitSet_(u),T=new ac({copy:a});if(T.assignSubtract(S),T.isZero())break;w=new ac({copy:w}),w.assignOr(T),this.setChainBitSet_(n,w),a=w}const m=this.getChainParentage(h),f=m|l;f!==m&&this.setChainParentage_(h,f);let g=this.getChainParentage(n);const v=l&~this.getHalfEdgeUserIndex(u,this.m_tmpHalfEdgeParentageIndexLeft);if(v&&(g|=v,this.setChainParentage_(n,g)),v===0)break;l=g}}propagateParentageWinding_(e,s,i,r,n,o,a){if(o===a)return;let l=this.getHalfEdgeUserIndex(i,this.m_tmpHalfEdgeWindingNumberIndex);l+=this.getHalfEdgeUserIndex(n,this.m_tmpHalfEdgeWindingNumberIndex);let u=0;const c=[],h=[];h.push(0);for(let m=e.getFirst();m!==s;m=e.getNext(m)){const f=e.getElement(m),g=this.getHalfEdgeTwin(f),v=this.getHalfEdgeChain(f),b=this.getHalfEdgeChain(g);if(v!==b){let w=this.getHalfEdgeUserIndex(f,this.m_tmpHalfEdgeWindingNumberIndex);w+=this.getHalfEdgeUserIndex(g,this.m_tmpHalfEdgeWindingNumberIndex),u+=w;let S=!1;c.length!==0&&c.at(-1)===b&&(h.pop(),c.pop(),S=!0),F(this.getChainParent(b)!==L),S&&this.getChainParent(b)===v||(h.push(u),c.push(v))}}if(u+=l,c.length!==0&&c.at(-1)===a&&(h.pop(),c.pop()),u!==0){if(h.at(-1)===0){const m=this.m_simplifiedGeometry,f=this.getGeometryID(m);this.setChainParentage_(o,f)}}else if(h.at(-1)!==0){const m=this.m_simplifiedGeometry,f=this.getGeometryID(m);this.setChainParentage_(o,f)}}propagateParentageAlternate_(e,s,i,r,n,o,a){const l=this.m_simplifiedGeometry,u=this.getGeometryID(l);if(r===L)this.setChainParentage_(a,this.m_universeGeomID),1&this.getHalfEdgeUserIndex(i,this.m_tmpHalfEdgeOddEvenNumberIndex)?this.setChainParentage_(o,u):this.setChainParentage_(o,this.m_universeGeomID);else{const c=this.getChainParentage(a);if(c===0){const h=this.getHalfEdgeChain(r),m=this.getChainParentage(h);this.setChainParentage_(a,m),1&this.getHalfEdgeUserIndex(i,this.m_tmpHalfEdgeOddEvenNumberIndex)?this.setChainParentage_(o,m===u?this.m_universeGeomID:u):this.setChainParentage_(o,m)}else 1&this.getHalfEdgeUserIndex(i,this.m_tmpHalfEdgeOddEvenNumberIndex)?this.setChainParentage_(o,c===u?this.m_universeGeomID:u):this.setChainParentage_(o,c)}}tryOptimizedInsertion_(e,s,i,r,n){let o=n,a=-1,l=L,u=0;do{if(u===2)return!1;const c=this.getHalfEdgeUserIndex(o,s);if(c!==-1){if(a!==-1)return!1;a=c}else{if(l!==L)return!1;l=o}u++,o=this.getHalfEdgeNext(this.getHalfEdgeTwin(o))}while(n!==o);return l!==L&&a!==-1&&(this.setHalfEdgeUserIndex(e.getElement(a),s,et.impossibleIndex2()),e.setElement(a,l),i.push(a),!0)}trySetChainParentFromTwin_(e,s){const i=this.getChainArea(e);if(i===0)return!1;const r=this.getChainArea(s);if(i>0&&r<0||i<0&&r>0)return this.setChainParent_(e,s),!0;{const n=this.getChainParent(s);if(n!==L)return this.setChainParent_(e,n),!0}return!1}createHalfEdges_(e,s){this.m_halfEdgeIndex=this.m_shape.createUserIndex();for(let i=0,r=s.size();i<r;i++){const n=s.read(i),o=this.m_shape.getUserIndex(n,this.m_clusterIndex),a=this.m_shape.getPathFromVertex(n),l=this.m_shape.getGeometryFromPath(a),u=this.m_shape.getGeometryType(l);if(xt(u)){const c=this.m_shape.getNextVertex(n);if(c===L)continue;const h=this.m_shape.getUserIndex(c,this.m_clusterIndex);if(o===h)continue;const m=this.newHalfEdgePair_(),f=this.getHalfEdgeTwin(m),g=this.m_clusterVertices.newElement();this.m_clusterVertices.setField(g,0,n),this.m_clusterVertices.setField(g,1,-1),this.setHalfEdgeVertexIterator_(m,g),this.m_shape.setUserIndex(n,this.m_halfEdgeIndex,m),this.setHalfEdgeOrigin_(m,o);const v=this.getClusterHalfEdge(o);if(v===L)this.setClusterHalfEdge_(o,m),this.setHalfEdgePrev_(m,f),this.setHalfEdgeNext_(f,m);else{const T=this.getHalfEdgePrev(v);this.setHalfEdgePrev_(v,f),this.setHalfEdgeNext_(f,v),this.setHalfEdgeNext_(T,m),this.setHalfEdgePrev_(m,T)}this.setHalfEdgeOrigin_(f,h);const b=this.getClusterHalfEdge(h);if(b===L)this.setClusterHalfEdge_(h,f),this.setHalfEdgeNext_(m,f),this.setHalfEdgePrev_(f,m);else{const T=this.getHalfEdgePrev(b);this.setHalfEdgePrev_(b,m),this.setHalfEdgeNext_(m,b),this.setHalfEdgeNext_(T,f),this.setHalfEdgePrev_(f,T)}const w=this.getGeometryID(l);if(e===oo.enumInputModeBuildGraph){const T=u===G.enumPolygon?w:0;if(this.setHalfEdgeUserIndex(f,this.m_tmpHalfEdgeParentageIndex,0),this.setHalfEdgeUserIndex(m,this.m_tmpHalfEdgeParentageIndex,T),this.setHalfEdgeUserIndex(f,this.m_tmpHalfEdgeParentageIndexLeft,T),this.setHalfEdgeUserIndex(m,this.m_tmpHalfEdgeParentageIndexLeft,0),this.m_bBuildGeometryParentageSets){const P=new ac,I=this.m_shape.getGeometryUserIndex(l,this.m_geometryIDIndex);P.setBit(I),this.setEdgeBitSet_(m,P),this.setEdgeBitSet_(f,null),this.setLeftEdgeBitSet_(f,P),this.setLeftEdgeBitSet_(m,null)}}else if(e===oo.enumInputModeSimplifyWinding){const T=this.m_shape.getXY(n),P=this.m_shape.getXY(c);let I=0,A=0;T.compare(P)<0?I=1:A=-1,this.setHalfEdgeUserIndex(m,this.m_tmpHalfEdgeWindingNumberIndex,I),this.setHalfEdgeUserIndex(f,this.m_tmpHalfEdgeWindingNumberIndex,A)}else e===oo.enumInputModeSimplifyAlternate&&(this.setHalfEdgeUserIndex(m,this.m_tmpHalfEdgeOddEvenNumberIndex,1),this.setHalfEdgeUserIndex(f,this.m_tmpHalfEdgeOddEvenNumberIndex,1));const S=u===G.enumPolygon?Fl.c_EdgeBitMask:0;this.setHalfEdgeParentage_(m,w|S),this.setHalfEdgeParentage_(f,w|S)}}if(this.m_shape.hasCurves()){this.m_segmentIndexHe=this.createUserIndexForHalfEdges();for(let i=0,r=s.size();i<r;i++){const n=s.read(i);if(this.m_shape.getSegment(n)){const o=this.m_shape.getUserIndex(n,this.m_halfEdgeIndex);o!==L&&(this.setHalfEdgeUserIndex(o,this.m_segmentIndexHe,this.m_shape.getVertexIndex(n)),this.setHalfEdgeUserIndex(this.getHalfEdgeTwin(o),this.m_segmentIndexHe,-2))}}}}mergeVertexListsOfEdges_(e,s){{const n=this.getHalfEdgeVertexIterator(s);if(n!==L){const o=this.getHalfEdgeVertexIterator(e);this.m_clusterVertices.setField(n,1,o),this.setHalfEdgeVertexIterator_(e,n),this.setHalfEdgeVertexIterator_(s,L)}}const i=this.getHalfEdgeTwin(e),r=this.getHalfEdgeTwin(s);{const n=this.getHalfEdgeVertexIterator(r);if(n!==L){const o=this.getHalfEdgeVertexIterator(i);this.m_clusterVertices.setField(n,1,o),this.setHalfEdgeVertexIterator_(i,n),this.setHalfEdgeVertexIterator_(r,L)}}if(this.m_segmentIndexHe!==-1){let n=this.getHalfEdgeUserIndex(e,this.m_segmentIndexHe);if(n!==-1){if(n===-2){const o=this.getHalfEdgeUserIndex(s,this.m_segmentIndexHe);this.setHalfEdgeUserIndex(e,this.m_segmentIndexHe,o)}if(n=this.getHalfEdgeUserIndex(i,this.m_segmentIndexHe),n===-2){const o=this.getHalfEdgeUserIndex(r,this.m_segmentIndexHe);this.setHalfEdgeUserIndex(i,this.m_segmentIndexHe,o)}}}}sortHalfEdgesByAngle_(e){const s=[];for(let i=this.getFirstCluster();i!==L;i=this.getNextCluster(i)){s.length=0;const r=this.getClusterHalfEdge(i);if(r!==L){let n=r;do s.push(n),n=this.getHalfEdgeNext(this.getHalfEdgeTwin(n));while(n!==r);if(s.length>1){let o=!0;s.length>2?(s.sort((m,f)=>this.compareEdgeAngles_(m,f)),s.push(s[0])):this.compareEdgeAnglesForPair_(s[0],s[1])>0?s[1]=be(s[0],s[0]=s[1]):o=!1;let a=s[0],l=a,u=this.getHalfEdgeTo(l),c=this.getHalfEdgeTwin(l),h=L;for(let m=1,f=s.length;m<f;m++){const g=s[m],v=this.getHalfEdgeTwin(g),b=this.getHalfEdgeOrigin(v);if(b!==u||g===l)this.updateVertexToHalfEdgeConnection_(h,!1),h=L,l=g,u=b,c=v;else{if(e===oo.enumInputModeBuildGraph){const w=this.getHalfEdgeParentageMask_(l)|this.getHalfEdgeParentageMask_(g);if(this.setHalfEdgeParentage_(l,w),this.setHalfEdgeParentage_(c,w),this.setHalfEdgeUserIndex(l,this.m_tmpHalfEdgeParentageIndex,this.getHalfEdgeUserIndex(l,this.m_tmpHalfEdgeParentageIndex)|this.getHalfEdgeUserIndex(g,this.m_tmpHalfEdgeParentageIndex)),this.setHalfEdgeUserIndex(c,this.m_tmpHalfEdgeParentageIndex,this.getHalfEdgeUserIndex(c,this.m_tmpHalfEdgeParentageIndex)|this.getHalfEdgeUserIndex(v,this.m_tmpHalfEdgeParentageIndex)),this.setHalfEdgeUserIndex(l,this.m_tmpHalfEdgeParentageIndexLeft,this.getHalfEdgeUserIndex(l,this.m_tmpHalfEdgeParentageIndexLeft)|this.getHalfEdgeUserIndex(g,this.m_tmpHalfEdgeParentageIndexLeft)),this.setHalfEdgeUserIndex(c,this.m_tmpHalfEdgeParentageIndexLeft,this.getHalfEdgeUserIndex(c,this.m_tmpHalfEdgeParentageIndexLeft)|this.getHalfEdgeUserIndex(v,this.m_tmpHalfEdgeParentageIndexLeft)),this.m_bBuildGeometryParentageSets){let S,T,P;S=this.getEdgeBitSet_(l),T=this.getEdgeBitSet_(g),P=new ac({copy:S}),P.assignOr(T),this.setEdgeBitSet_(l,P),S=this.getEdgeBitSet_(c),T=this.getEdgeBitSet_(v),P=new ac({copy:S}),P.assignOr(T),this.setEdgeBitSet_(c,P),S=this.getLeftEdgeBitSet_(l),T=this.getLeftEdgeBitSet_(g),P=new ac({copy:S}),P.assignOr(T),this.setLeftEdgeBitSet_(l,P),S=this.getLeftEdgeBitSet_(c),T=this.getLeftEdgeBitSet_(v),P=new ac({copy:S}),P.assignOr(T),this.setLeftEdgeBitSet_(c,P)}}else if(this.m_tmpHalfEdgeWindingNumberIndex!==-1){const w=this.getHalfEdgeUserIndex(l,this.m_tmpHalfEdgeWindingNumberIndex)+this.getHalfEdgeUserIndex(g,this.m_tmpHalfEdgeWindingNumberIndex),S=this.getHalfEdgeUserIndex(c,this.m_tmpHalfEdgeWindingNumberIndex)+this.getHalfEdgeUserIndex(v,this.m_tmpHalfEdgeWindingNumberIndex);this.setHalfEdgeUserIndex(l,this.m_tmpHalfEdgeWindingNumberIndex,w),this.setHalfEdgeUserIndex(c,this.m_tmpHalfEdgeWindingNumberIndex,S)}else if(this.m_tmpHalfEdgeOddEvenNumberIndex!==-1){const w=this.getHalfEdgeUserIndex(l,this.m_tmpHalfEdgeOddEvenNumberIndex)+this.getHalfEdgeUserIndex(g,this.m_tmpHalfEdgeOddEvenNumberIndex),S=this.getHalfEdgeUserIndex(c,this.m_tmpHalfEdgeOddEvenNumberIndex)+this.getHalfEdgeUserIndex(v,this.m_tmpHalfEdgeOddEvenNumberIndex);this.setHalfEdgeUserIndex(l,this.m_tmpHalfEdgeOddEvenNumberIndex,w),this.setHalfEdgeUserIndex(c,this.m_tmpHalfEdgeOddEvenNumberIndex,S)}this.mergeVertexListsOfEdges_(l,g),this.deleteEdgeImpl_(g),h=l,s[m]=L,g===a&&(s[0]=L,a=L)}}if(this.updateVertexToHalfEdgeConnection_(h,!1),h=L,!o){a=L;for(let m=0,f=s.length;m<f;m++){const g=s[m];if(g!==L){a=g;break}}r!==a&&this.setClusterHalfEdge_(i,a);continue}a=L;for(let m=0,f=s.length;m<f;m++){const g=s[m];if(g===L)continue;if(a===L){a=g,l=a,u=this.getHalfEdgeTo(l),c=this.getHalfEdgeTwin(l);continue}if(g===l)continue;const v=this.getHalfEdgeTwin(g),b=this.getHalfEdgeOrigin(v);this.setHalfEdgeNext_(c,g),this.setHalfEdgePrev_(g,c),l=g,u=b,c=v}this.setClusterHalfEdge_(i,a)}}}}sortHalfEdgesByAngle3D_(e){F(0)}buildChains_(e){this.m_universeChain=this.newChain_(),this.setChainHalfEdge_(this.m_universeChain,L);let s=this.m_universeChain;const i=this.createUserIndexForHalfEdges();for(let r=this.getFirstCluster();r!==L;r=this.getNextCluster(r)){const n=this.getClusterHalfEdge(r);if(n!==L){let o=n;do{if(this.getHalfEdgeUserIndex(o,i)!==1){const a=this.newChain_();this.setChainHalfEdge_(a,o),this.setChainPrev_(a,s),this.setChainNext_(s,a);let l=null;this.m_bBuildGeometryParentageSets&&(l=new ac),s=a;let u=0,c=o;do this.m_tmpHalfEdgeParentageIndex!==-1&&(u|=this.getHalfEdgeUserIndex(c,this.m_tmpHalfEdgeParentageIndex)),this.m_bBuildGeometryParentageSets&&l.assignOr(this.getEdgeBitSet_(c)),this.setHalfEdgeChain_(c,a),this.setHalfEdgeUserIndex(c,i,1),c=this.getHalfEdgeNext(c);while(c!==o);this.m_bBuildGeometryParentageSets&&this.setChainBitSet_(a,l),this.setChainParentage_(a,u)}o=this.getHalfEdgeNext(this.getHalfEdgeTwin(o))}while(o!==n)}}this.m_chainAreas=new ag(this.m_chainData.size(),Number.NaN),this.m_chainPerimeters=new ag(this.m_chainData.size(),Number.NaN),this.setChainArea_(this.m_universeChain,Number.POSITIVE_INFINITY),this.setChainPerimeter_(this.m_universeChain,Number.POSITIVE_INFINITY),this.deleteUserIndexForHalfEdges(i)}simplify_(e){F(0)}simplifyAlternate_(){F(0)}simplifyWinding_(){F(0)}setEditShapeImpl_(e,s,i,r,n){this.removeShape(),this.m_bBuildChains=n,this.m_shape=e,this.m_geometryIDIndex=this.m_shape.createGeometryUserIndex();let o=this.m_shape.getTotalPointCount();if(i){o=0;for(let f=0,g=i.length;f<g;f++)o+=this.m_shape.getPointCount(i[f])}const a=new Qs(0);let l=0,u=0;{let f=i!=null?i[0]:this.m_shape.getFirstGeometry(),g=1;for(;f!==L;){this.m_shape.setGeometryUserIndex(f,this.m_geometryIDIndex,u++);for(let v=this.m_shape.getFirstPath(f);v!==L;v=this.m_shape.getNextPath(v)){let b=this.m_shape.getFirstVertex(v);for(let w=0,S=this.m_shape.getPathSize(v);w<S;w++)a.add(b),b=this.m_shape.getNextVertex(b)}Fb(this.m_shape.getGeometryType(f))||(l+=this.m_shape.getPathCount(f)),i!=null?(f=g<i.length?i[g]:L,g++):f=this.m_shape.getNextGeometry(f)}}this.m_universeGeomID=1<<Math.min(u,31),this.m_pointCount=a.size(),this.m_shape.sortVerticesSimpleByY(a,0,this.m_pointCount),this.m_clusterVertices.setCapacity(this.m_pointCount),this.progress_(r,!0),this.m_clusterData.setCapacity(this.m_pointCount+10),this.m_halfEdgeData.setCapacity(2*this.m_pointCount+32),this.m_chainData.setCapacity(Math.max(32,l)),this.m_clusterIndex=this.m_shape.createUserIndex();const c=M.getNAN();let h=0;const m=M.getNAN();for(let f=0;f<=this.m_pointCount;f++){if(f<this.m_pointCount){const g=a.read(f);this.m_shape.queryXY(g,m)}else m.setNAN();if(!c.isEqualPoint2D(m)){if(h<f){const g=this.newCluster_();let v=L,b=-1;for(let w=h;w<f;w++){b=a.read(w),this.m_shape.setUserIndex(b,this.m_clusterIndex,g);const S=this.m_clusterVertices.newElement();this.m_clusterVertices.setField(S,0,b),this.m_clusterVertices.setField(S,1,v),v=S;const T=this.m_shape.getPathFromVertex(b),P=this.m_shape.getGeometryFromPath(T),I=this.getGeometryID(P);this.setClusterParentage_(g,this.getClusterParentage(g)|I)}this.setClusterVertexIterator_(g,v),this.setClusterVertexIndex_(g,this.m_shape.getVertexIndex(b)),this.m_lastCluster!==L&&this.setNextCluster_(this.m_lastCluster,g),this.setPrevCluster_(g,this.m_lastCluster),this.m_lastCluster=g,this.m_firstCluster===L&&(this.m_firstCluster=g)}h=f,c.setCoordsPoint2D(m)}}if(this.m_shape.hasSegmentParentage()){this.m_clusterBreakNodeIndex===-1&&(this.m_clusterBreakNodeIndex=this.createUserIndexForClusters());for(let f=0;f<this.m_pointCount;f++){const g=a.read(f);if(this.m_shape.getSegmentParentageBreakVertex(g)){const v=this.getClusterFromVertex(g);this.setBreakNode(v,!0)}}}this.progress_(r,!0);{let f=i!=null?i[0]:this.m_shape.getFirstGeometry(),g=1;for(;f!==L;){for(let v=this.m_shape.getFirstPath(f);v!==L;v=this.m_shape.getNextPath(v)){if(this.m_shape.isStrongPathStart(v)){const b=this.m_shape.getFirstVertex(v),w=this.getClusterFromVertex(b);this.setStrongPathNode(w,!0)}if(this.m_shape.isStrongPathEnd(v)){const b=this.m_shape.isClosedPath(v)?this.m_shape.getFirstVertex(v):this.m_shape.getLastVertex(v),w=this.getClusterFromVertex(b);this.setStrongPathNode(w,!0)}}i!=null?(f=g<i.length?i[g]:L,g++):f=this.m_shape.getNextGeometry(f)}}if(s===oo.enumInputModeBuildGraph&&(this.m_tmpHalfEdgeParentageIndex=this.createUserIndexForHalfEdges(),this.m_tmpHalfEdgeParentageIndexLeft=this.createUserIndexForHalfEdges()),s===oo.enumInputModeSimplifyWinding&&(this.m_tmpHalfEdgeWindingNumberIndex=this.createUserIndexForHalfEdges()),s===oo.enumInputModeSimplifyAlternate&&(this.m_tmpHalfEdgeOddEvenNumberIndex=this.createUserIndexForHalfEdges()),this.createHalfEdges_(s,a),this.dbgNavigate_(),this.sortHalfEdgesByAngle_(s),!Number.isNaN(this.m_checkDirtyPlanesweepTolerance)&&!this.checkStructureAfterDirtySweep_())return this.m_bDirtyCheckFailed=!0,void this.cleanSetEditShapeImpl_();this.buildChains_(s),this.m_tmpHalfEdgeParentageIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndex),this.m_tmpHalfEdgeParentageIndex=-1),this.m_bBuildChains&&this.planeSweepParentage_(s,r),this.m_tmpHalfEdgeParentageIndexLeft!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndexLeft),this.m_tmpHalfEdgeParentageIndexLeft=-1),this.dbgChkChainParents_(),this.dbgDumpChains_(),this.mergeSegmentParentage_(),this.dbgNavigate_(),this.dbgDumpChains_(),this.cleanSetEditShapeImpl_()}setEditShapeImpl3D_(e,s,i,r,n){F(0)}cleanSetEditShapeImpl_(){this.m_tmpHalfEdgeParentageIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndex),this.m_tmpHalfEdgeParentageIndex=-1),this.m_tmpHalfEdgeParentageIndexLeft!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndexLeft),this.m_tmpHalfEdgeParentageIndexLeft=-1),this.m_tmpHalfEdgeWindingNumberIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeWindingNumberIndex),this.m_tmpHalfEdgeWindingNumberIndex=-1),this.m_tmpHalfEdgeOddEvenNumberIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeOddEvenNumberIndex),this.m_tmpHalfEdgeOddEvenNumberIndex=-1)}cleanSetEditShapeImpl3D_(){F(0)}dbgNavigate_(){}dbgChkChainParents_(){}deleteEdgeImpl_(e){const s=this.getHalfEdgeNext(e),i=this.getHalfEdgePrev(e),r=this.getHalfEdgeTwin(e),n=this.getHalfEdgeNext(r),o=this.getHalfEdgePrev(r);s!==r&&(this.setHalfEdgeNext_(o,s),this.setHalfEdgePrev_(s,o)),i!==r&&(this.setHalfEdgeNext_(i,n),this.setHalfEdgePrev_(n,i));const a=this.getHalfEdgeOrigin(e);this.getClusterHalfEdge(a)===e&&(n!==e?this.setClusterHalfEdge_(a,n):this.setClusterHalfEdge_(a,L));const l=this.getHalfEdgeOrigin(r);this.getClusterHalfEdge(l)===r&&(s!==r?this.setClusterHalfEdge_(l,s):this.setClusterHalfEdge_(l,L)),this.m_halfEdgeData.deleteElement(e),this.m_halfEdgeData.deleteElement(r)}getLeftSkipPolylines_(e,s){let i=s;for(;;){if(i=e.getPrev(i),i===-1)return L;{const r=e.getElement(i);if(this.getHalfEdgeChain(r)!==this.getHalfEdgeChain(this.getHalfEdgeTwin(r)))return r}}}checkStructureAfterDirtySweep_(){const e=Pt(this.m_checkDirtyPlanesweepTolerance),s=new M,i=new M,r=new M,n=new M,o=new M;for(let a=this.getFirstCluster();a!==L;a=this.getNextCluster(a)){const l=this.getClusterHalfEdge(a);if(l!==L){let u=l;this.getHalfEdgeFromXY(u,s),this.getHalfEdgeToXY(u,i),r.setSub(i,s);let c=r.sqrLength();do{const h=u;if(u=this.getHalfEdgeNext(this.getHalfEdgeTwin(u)),u!==h){this.getHalfEdgeToXY(u,n),o.setSub(n,s);const m=o.sqrLength(),f=o.crossProduct(r),g=f*f/(m*c);if(Math.min(m,c)*g<=e&&o.dotProduct(r)>=0)return!1;r.assign(o),c=m,i.assign(n)}}while(u!==l)}}return!0}extractPolygonPathFromChain_(e,s,i,r,n){const o=this.m_shape.hasSegmentParentage(),a=this.getChainHalfEdge(i);let l=a,u=L;const c=new nt;do{const h=this.getHalfEdgeTwin(l);if(this.getHalfEdgeChain(h)!==i){let m=L;const f=this.getHalfEdgeOrigin(l);if(r===L){const v=this.getClusterVertexIterator(f);m=this.getVertexFromVertexIterator(v)}else for(let v=this.getClusterVertexIterator(f);v!==L;v=this.incrementVertexIterator(v)){const b=this.getVertexFromVertexIterator(v);m===L&&(m=b);const w=this.m_shape.getPathFromVertex(b);if(this.m_shape.getGeometryFromPath(w)===r){m=b;break}}let g;if(u===L&&(u=e.insertPath(s,L),e.setClosedPath(u,!0)),this.m_shape===e?g=e.addVertex(u,m):(this.m_shape.queryPoint(m,c),g=e.addPoint(u,c)),this.isHalfEdgeCurve(l)&&(this.querySegmentXY(l,n),e.setSegmentToIndex(e.getVertexIndex(g),n.get().clone())),o){const v=this.getSegmentParentage(l);e.setSegmentParentageAndBreak(g,v,this.isBreakNode(f))}}l=this.getHalfEdgeNext(l)}while(l!==a)}mergeSegmentParentage_(){if(!this.m_shape.hasSegmentParentage())return;F(this.m_clusterBreakNodeIndex!==-1),F(this.m_segmentParentageIndex===-1);for(let r=this.getFirstCluster();r!==L;r=this.getNextCluster(r)){let n=0;const o=this.getClusterHalfEdge(r);if(o!==L){let a=o;do n++,a=this.getHalfEdgeNext(this.getHalfEdgeTwin(a));while(a!==o&&n<3)}n!==2&&this.setBreakNode(r,!0)}let e=[],s=[];this.m_segmentParentageIndex=this.createUserIndexForHalfEdges();const i=this.createUserIndexForHalfEdges();for(let r=this.getFirstCluster();r!==L;r=this.getNextCluster(r)){const n=this.getClusterHalfEdge(r);if(n!==L){let o=!1,a=n;do{let l=a;for(;this.getHalfEdgeUserIndex(l,i)===-1;){const u=this.getHalfEdgeNext(l),c=this.getHalfEdgeTwin(l);Are(this,l,s);const h=s.at(-1).parentage;if(!o){const f=this.getHalfEdgeOrigin(l);if(!this.isBreakNode(f)){const g=this.getHalfEdgePrev(l);l!==g&&(Are(this,g,e),o=!0)}}if(o&&!Gst(s,e)){const f=this.getHalfEdgeOrigin(l);this.setBreakNode(f,!0)}e=be(s,s=e),o=!0;const m=this.getHalfEdgeOrigin(u);this.isBreakNode(m)&&(o=!1),this.setHalfEdgeUserIndex(l,this.m_segmentParentageIndex,h),this.setHalfEdgeUserIndex(c,this.m_segmentParentageIndex,h),this.setHalfEdgeUserIndex(l,i,1),this.setHalfEdgeUserIndex(c,i,1),l=u}a=this.getHalfEdgeNext(this.getHalfEdgeTwin(a))}while(a!==n)}}this.deleteUserIndexForHalfEdges(i)}registerNewBitSet(e){return this.m_uniqueBitSets===null&&(this.m_uniqueBitSets=zst(),this.m_uniqueBitSets.add(this.getEmptySet())),e===null?this.getEmptySet():this.m_uniqueBitSets.has(e)?this.m_uniqueBitSets.get(e):(this.m_uniqueBitSets.add(e),e)}getLeftEdgeBitSet_(e){const s=this.getHalfEdgeUserIndex(e,this.m_edgeBitSetIndexLeft);return F(s>=0),F(this.m_edgeBitSets.at(s)),this.m_edgeBitSets.at(s)}getEdgeBitSet_(e){const s=this.getHalfEdgeUserIndex(e,this.m_edgeBitSetIndex);return F(s>=0),this.m_edgeBitSets.at(s)}setEdgeBitSet_(e,s){F(this.m_bBuildGeometryParentageSets),s=this.registerNewBitSet(s),this.m_edgeBitSetIndex===-1&&(this.m_edgeBitSetIndex=this.createUserIndexForHalfEdges());const i=this.getHalfEdgeUserIndex(e,this.m_edgeBitSetIndex);i!==-1?this.m_edgeBitSets[i]=s:(this.setHalfEdgeUserIndex(e,this.m_edgeBitSetIndex,this.m_edgeBitSets.length),this.m_edgeBitSets.push(s))}setLeftEdgeBitSet_(e,s){F(this.m_bBuildGeometryParentageSets),s=this.registerNewBitSet(s),this.m_edgeBitSetIndexLeft===-1&&(this.m_edgeBitSetIndexLeft=this.createUserIndexForHalfEdges());const i=this.getHalfEdgeUserIndex(e,this.m_edgeBitSetIndexLeft);i!==-1?this.m_edgeBitSets[i]=s:(this.setHalfEdgeUserIndex(e,this.m_edgeBitSetIndexLeft,this.m_edgeBitSets.length),this.m_edgeBitSets.push(s))}setChainBitSet_(e,s){F(this.m_bBuildGeometryParentageSets),s=this.registerNewBitSet(s),this.m_chainBitSetIndex===-1&&(this.m_chainBitSetIndex=this.createUserIndexForChains());const i=this.getChainUserIndex(e,this.m_chainBitSetIndex);i!==-1?this.m_chainBitSets[i]=s:(this.setChainUserIndex(e,this.m_chainBitSetIndex,this.m_chainBitSets.length),this.m_chainBitSets.push(s))}getEmptySet(){return this.m_emptyBitSet||(this.m_emptyBitSet=new ac),this.m_emptyBitSet}deleteEdgeBitSets_(){this.m_edgeBitSetIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_edgeBitSetIndex),this.m_edgeBitSetIndex=-1),this.m_edgeBitSetIndexLeft!==-1&&(this.deleteUserIndexForHalfEdges(this.m_edgeBitSetIndexLeft),this.m_edgeBitSetIndexLeft=-1),this.m_edgeBitSets.length=0,this.m_uniqueBitSets=null}deleteChainBitSets_(){this.m_chainBitSetIndex!==-1&&(this.deleteUserIndexForChains(this.m_chainBitSetIndex),this.m_chainBitSetIndex=-1,this.m_chainBitSets.length=0)}dbgPrintEdge_(e){}dbgVerifyEdgeSegment(e){}}Fl.c_EdgeParentageMask=2147483647,Fl.c_EdgeBitMask=1<<31;class ds{freeNode_(e){this.m_listNodes.deleteElement(e)}newNode_(){return this.m_listNodes.newElement()}freeList_(e){this.m_lists.deleteElement(e)}newList_(){return this.m_lists.newElement()}Init_(e){F(0)}constructor(e){this.m_listNodes=new et(2),this.m_listOfLists=ds.st_nullNode(),this.m_bAllowNavigationBetweenLists=!0,e===void 0&&(e=!0),this.m_bAllowNavigationBetweenLists=e,this.m_lists=new et(this.m_bAllowNavigationBetweenLists?4:2)}createList(){const e=this.newList_();return this.m_bAllowNavigationBetweenLists&&(this.m_lists.setField(e,3,this.m_listOfLists),this.m_listOfLists!==ds.st_nullNode()&&this.m_lists.setField(this.m_listOfLists,2,e),this.m_listOfLists=e),e}deleteList(e){let s=this.getFirst(e);for(;s!==ds.st_nullNode();){const i=s;s=this.getNext(s),this.freeNode_(i)}if(this.m_bAllowNavigationBetweenLists){const i=this.m_lists.getField(e,2),r=this.m_lists.getField(e,3);i!==ds.st_nullNode()?this.m_lists.setField(i,3,r):this.m_listOfLists=r,r!==ds.st_nullNode()&&this.m_lists.setField(r,2,i)}this.freeList_(e)}reserveLists(e){this.m_lists.setCapacity(e)}addElement(e,s){this.m_lists.getField(e,0);const i=this.m_lists.getField(e,1),r=this.newNode_();return i!==ds.st_nullNode()?(this.m_listNodes.setField(i,1,r),this.m_lists.setField(e,1,r)):(this.m_lists.setField(e,0,r),this.m_lists.setField(e,1,r)),this.m_listNodes.setField(r,0,s),r}reserveNodes(e){this.m_listNodes.setCapacity(e)}deleteElementDirect(e,s,i){s!==ds.st_nullNode()?(this.m_listNodes.setField(s,1,this.m_listNodes.getField(i,1)),this.m_lists.getField(e,1)===i&&this.m_lists.setField(e,1,s)):(this.m_lists.setField(e,0,this.m_listNodes.getField(i,1)),this.m_lists.getField(e,1)===i&&this.m_lists.setField(e,1,ds.st_nullNode())),this.freeNode_(i)}deleteElementSearch(e,s){let i=-1,r=this.getFirst(e);for(;r!==s;)i=r,r=this.getNext(r);this.deleteElementDirect(e,i,s)}concatenateLists(e,s){const i=this.m_lists.getField(e,1),r=this.m_lists.getField(s,0);if(r!==ds.st_nullNode()&&(i!==ds.st_nullNode()?(this.m_listNodes.setField(i,1,r),this.m_lists.setField(e,1,this.m_lists.getField(s,1))):(this.m_lists.setField(e,0,r),this.m_lists.setField(e,1,this.m_lists.getField(s,1)))),this.m_bAllowNavigationBetweenLists){const n=this.m_lists.getField(s,2),o=this.m_lists.getField(s,3);n!==ds.st_nullNode()?this.m_lists.setField(n,3,o):this.m_listOfLists=o,o!==ds.st_nullNode()&&this.m_lists.setField(o,2,n)}return this.freeList_(s),e}getElement(e){return this.m_listNodes.getField(e,0)}getData(e){return this.getElement(e)}setElement(e,s){F(0)}getNext(e){return this.m_listNodes.getField(e,1)}getFirst(e){return this.m_lists.getField(e,0)}getFirstElement(e){const s=this.getFirst(e);return this.getElement(s)}static st_nullNode(){return-1}clear(){this.m_listNodes.deleteAll(!0),this.m_lists.deleteAll(!0),this.m_listOfLists=ds.st_nullNode()}isEmpty(e){return F(0),!1}getNodeCount(){return this.m_listNodes.size()}getListCount(){return this.m_lists.size()}getFirstList(){return this.m_listOfLists}getNextList(e){return this.m_lists.getField(e,3)}}function _L(t=-1){return{m_value:t,m_line:new pt,m_segment:null,m_segmentInfo:new PG(-1),m_env:new de(0,0),m_dxdy:55555555,m_bHorizontal:!1,m_bCurve:!1}}const Ust=67;class ove extends E0{constructor(e,s,i){super(!0),this.m_bIntersectionDetected=!1,this.m_nonSimpleResult=new gs,this.m_tempSimpleEdge1=_L(),this.m_tempSimpleEdge2=_L(),this.m_prev1=L,this.m_prev2=L,this.m_vertex1=L,this.m_vertex2=L,this.m_currentNode=-1,this.m_prevX1=Number.NaN,this.m_prevX2=Number.NaN,this.m_prevY=Number.NaN,this.m_prevX=0,this.m_sweepY=Number.NaN,this.m_sweepX=0,this.m_ptSweep=new M,this.m_simpleEdgesCache=[],this.m_simpleEdgesRecycle=[],this.m_cOutstandingConstructedEdges=0,this.m_shape=e,this.m_bShapeHasSegments=this.m_shape.hasCurves(),this.m_tolerance=s,this.m_tolerance10=10*s,this.m_bIsSimple=i;const r=Math.trunc(Math.min(3*e.getTotalPointCount()/2,Ust)),n=Math.min(7,r);this.m_simpleEdgesCache.length=n}tryGetCachedEdge_(e){const s=this.m_simpleEdgesCache[(e&co())%this.m_simpleEdgesCache.length];return s&&s.m_value===e?s:null}tryDeleteCachedEdge_(e){const s=(e&co())%this.m_simpleEdgesCache.length,i=this.m_simpleEdgesCache[s];i&&i.m_value===e&&(this.m_simpleEdgesRecycle.push(i),this.m_simpleEdgesCache[s]=null)}tryCreateCachedEdge_(e){const s=(e&co())%this.m_simpleEdgesCache.length;let i=this.m_simpleEdgesCache[s];return i?null:(this.m_simpleEdgesRecycle.length===0?(i=_L(),this.m_cOutstandingConstructedEdges++):i=this.m_simpleEdgesRecycle.pop(),i.m_value=e,this.m_simpleEdgesCache[s]=i,i)}initSimpleEdge_(e,s){this.m_bShapeHasSegments&&this.initSimpleEdgeHelper_(e,s)||e.m_bCurve||(this.m_shape.queryLineConnector(s,e.m_line,!0),e.m_segment=e.m_line,e.m_env.setCoordsNoNAN(e.m_line.getStartX(),e.m_line.getEndX()),e.m_env.vmax+=this.m_tolerance,e.m_line.orientBottomUp(),e.m_bHorizontal=e.m_line.getEndY()===e.m_line.getStartY(),e.m_bHorizontal||(e.m_dxdy=(e.m_line.getEndX()-e.m_line.getStartX())/(e.m_line.getEndY()-e.m_line.getStartY())))}initSimpleEdgeHelper_(e,s){if(e.m_segment=this.m_shape.getSegment(s),e.m_segmentInfo=this.m_shape.getOriginalSegmentInfo(s),e.m_bCurve=e.m_segment!==null,e.m_bCurve){const i=e.m_segment.clone();return i.orientBottomUp(),e.m_segment=i,e.m_env=e.m_segment.queryInterval(0,0),e.m_env.vmax+=this.m_tolerance,!0}return!1}compareTwoSegments_(e,s){const i=e.getStartXY(),r=e.getEndXY(),n=s.getStartXY(),o=s.getEndXY();if(this.m_ptSweep.setCoords(this.m_sweepX,this.m_sweepY),i.isEqualPoint2D(n)&&this.m_sweepY===i.y){this.m_ptSweep.assign(r.compare(o)<0?r:o);const h=e.intersectionOfYMonotonicWithAxisX(this.m_ptSweep.y,this.m_ptSweep.x),m=s.intersectionOfYMonotonicWithAxisX(this.m_ptSweep.y,this.m_ptSweep.x);if(Math.abs(h-m)>this.m_tolerance)return h<m?-1:1}const a=i.compare(n)<0?n:i,l=r.compare(o)<0?r:o;let u=0,c=0;for(let h=1;h<5;h++){wi(a,l,h/5,this.m_ptSweep);const m=e.intersectionOfYMonotonicWithAxisX(this.m_ptSweep.y,this.m_ptSweep.x),f=s.intersectionOfYMonotonicWithAxisX(this.m_ptSweep.y,this.m_ptSweep.x),g=Math.abs(m-f);g>u&&(u=g,c=m<f?-1:1)}return c===0?this.errorCracking():c}compareNonHorizontal_(e,s){if(e.m_line.getStartY()===s.m_line.getStartY()&&e.m_line.getStartX()===s.m_line.getStartX())return e.m_line.getEndY()===s.m_line.getEndY()&&e.m_line.getEndX()===s.m_line.getEndX()?this.m_bIsSimple?this.errorCoincident():0:this.compareNonHorizontalUpperEnd_(e,s);if(e.m_line.getEndY()===s.m_line.getEndY()&&e.m_line.getEndX()===s.m_line.getEndX())return this.compareNonHorizontalLowerEnd_(e,s);const i=this.compareNonHorizontalLowerEnd_(e,s),r=this.compareNonHorizontalUpperEnd_(e,s);return i<0&&r<0?-1:i>0&&r>0?1:this.errorCracking()}compareHorizontal1Case1_(e,s){if(e.getEndX()>s.getEndX()){if(s.getEndX()>s.getStartX()&&s.getEndY()-s.getStartY()<2*this.m_tolerance&&e.isIntersectingPoint(s.getEndXY(),this.m_tolerance,!0))return this.errorCracking()}else if((s.getEndY()-s.getStartY())/(s.getEndX()-s.getStartX())*(e.getEndX()-e.getStartX())<this.m_tolerance10&&s.isIntersectingPoint(e.getEndXY(),this.m_tolerance,!0))return this.errorCracking();return 1}compareHorizontal1Case2_(e,s){if(e.getStartX()<s.getStartX()){if(s.getEndX()>s.getStartX()&&s.getEndY()-s.getStartY()<2*this.m_tolerance&&e.isIntersectingPoint(s.getEndXY(),this.m_tolerance,!0))return this.errorCracking()}else if((s.getEndY()-s.getStartY())/(s.getEndX()-s.getStartX())*(e.getStartX()-e.getEndX())<this.m_tolerance10&&s.isIntersectingPoint(e.getStartXY(),this.m_tolerance,!0))return this.errorCracking();return-1}compareHorizontal1Case3_(e,s){const i=M.getNAN();i.setSub(s.getEndXY(),s.getStartXY()),i.rightPerpendicularThis(),i.normalize();const r=M.getNAN();r.setSub(e.getStartXY(),s.getStartXY());const n=M.getNAN();n.setSub(e.getEndXY(),s.getStartXY());const o=r.dotProduct(i),a=n.dotProduct(i),l=Math.abs(o),u=Math.abs(a);if(l<u){if(l<this.m_tolerance10&&s.isIntersectingPoint(e.getStartXY(),this.m_tolerance,!0))return this.errorCracking()}else if(u<this.m_tolerance10&&s.isIntersectingPoint(e.getEndXY(),this.m_tolerance,!0))return this.errorCracking();return o<0&&a<0?-1:o>0&&a>0?1:this.errorCracking()}compareHorizontal1_(e,s){return e.getStartY()===s.getStartY()&&e.getStartX()===s.getStartX()?this.compareHorizontal1Case1_(e,s):e.getEndY()===s.getEndY()&&e.getEndX()===s.getEndX()?this.compareHorizontal1Case2_(e,s):this.compareHorizontal1Case3_(e,s)}compareHorizontal2_(e,s){return e.getEndY()===s.getEndY()&&e.getEndX()===s.getEndX()&&e.getStartY()===s.getStartY()&&e.getStartX()===s.getStartX()?this.m_bIsSimple?this.errorCoincident():0:this.errorCracking()}compareNonHorizontalLowerEnd_(e,s){let i=1;if(e.m_line.getStartY()<s.m_line.getStartY()){i=-1;const u=e;e=s,s=u}const r=e.m_line,n=s.m_line,o=r.getStartX()-n.getStartX(),a=s.m_dxdy*(r.getStartY()-n.getStartY()),l=this.m_tolerance10;return o<a-l?-i:o>a+l?i:n.isIntersectingPoint(r.getStartXY(),this.m_tolerance,!0)?this.errorCracking():o<a?-i:i}compareNonHorizontalUpperEnd_(e,s){let i=1;if(s.m_line.getEndY()<e.m_line.getEndY()){i=-1;const u=e;e=s,s=u}const r=e.m_line,n=s.m_line,o=r.getEndX()-n.getStartX(),a=s.m_dxdy*(r.getEndY()-n.getStartY()),l=this.m_tolerance10;return o<a-l?-i:o>a+l?i:n.isIntersectingPoint(r.getEndXY(),this.m_tolerance,!0)?this.errorCracking():o<a?-i:i}errorCoincident(){this.m_bIntersectionDetected=!0;const e=7;return this.m_nonSimpleResult=new gs(e,this.m_vertex1,this.m_vertex2),-1}errorCracking(){return this.m_bIntersectionDetected=!0,this.m_bIsSimple?this.m_nonSimpleResult=new gs(6,this.m_vertex1,this.m_vertex2):(this.m_prev1=L,this.m_prev2=L,this.m_vertex1=L,this.m_vertex2=L),-1}compareSegments_(e,s,i,r){if(i.m_env.vmax<r.m_env.vmin)return-1;if(r.m_env.vmax<i.m_env.vmin)return 1;if(!i.m_bCurve&&!r.m_bCurve){let u=i.m_bHorizontal?1:0;return u|=r.m_bHorizontal?2:0,u===0?this.compareNonHorizontal_(i,r):u===1?this.compareHorizontal1_(i.m_line,r.m_line):u===2?-1*this.compareHorizontal1_(r.m_line,i.m_line):this.compareHorizontal2_(i.m_line,r.m_line)}if(this.m_bIntersectionDetected)return-1;const n=this.m_prevY===this.m_sweepY&&this.m_prevX===this.m_sweepX;let o,a;if(n&&e===this.m_prev1?o=this.m_prevX1:(o=Number.NaN,this.m_prev1=L),n&&s===this.m_prev2?a=this.m_prevX2:(a=Number.NaN,this.m_prev2=L),this.m_prevY=this.m_sweepY,this.m_prevX=this.m_sweepX,Number.isNaN(o)){this.m_prev1=e;const u=i.m_segment.intersectionOfYMonotonicWithAxisX(this.m_sweepY,this.m_sweepX);o=u,this.m_prevX1=u}if(Number.isNaN(a)){this.m_prev2=s;const u=r.m_segment.intersectionOfYMonotonicWithAxisX(this.m_sweepY,this.m_sweepX);a=u,this.m_prevX2=u}const l=_R(!0,!0,i.m_segment,r.m_segment,this.m_tolerance,!0);return l!==0?l===2?this.m_bIsSimple?this.errorCoincident():i.m_segmentInfo.equals(r.m_segmentInfo)?0:this.errorCracking():this.errorCracking():Math.abs(o-a)<=this.m_tolerance?this.compareTwoSegments_(i.m_segment,r.m_segment):o<a?-1:o>a?1:0}clearIntersectionDetectedFlag(){this.m_bIntersectionDetected=!1}intersectionDetected(){return this.m_bIntersectionDetected}getLastComparedNode(){return this.m_currentNode}getResult(){return this.m_nonSimpleResult}setSweepY(e,s){this.m_sweepY=e,this.m_sweepX=s,this.m_prev1=L,this.m_prev2=L,this.m_vertex1=L,this.m_vertex2=L}compare(e,s,i){if(this.m_bIntersectionDetected)return-1;const r=e.getElement(i),n=s;return this.m_currentNode=i,this.compareSegments(n,n,r,r)}compareSegments(e,s,i,r){let n=this.tryGetCachedEdge_(e);n===null?this.m_vertex1===s?n=this.m_tempSimpleEdge1:(this.m_vertex1=s,n=this.tryCreateCachedEdge_(e),n===null&&(n=this.m_tempSimpleEdge1,this.m_tempSimpleEdge1.m_value=e),this.initSimpleEdge_(n,s)):this.m_vertex1=s;let o=this.tryGetCachedEdge_(i);return o===null?this.m_vertex2===r?o=this.m_tempSimpleEdge2:(this.m_vertex2=r,o=this.tryCreateCachedEdge_(i),o===null&&(o=this.m_tempSimpleEdge2,this.m_tempSimpleEdge2.m_value=i),this.initSimpleEdge_(o,r)):this.m_vertex2=r,this.compareSegments_(s,r,n,o)}onDelete(e){this.tryDeleteCachedEdge_(e)}onSet(e){this.tryDeleteCachedEdge_(e)}onEndSearch(e){this.tryDeleteCachedEdge_(e)}onAddUniqueElementFailed(e){this.tryDeleteCachedEdge_(e)}}class ave{constructor(e,s){this.m_bIntersectionDetected=!1,this.m_pointOfInterest=M.getNAN(),this.m_line1=new pt,this.m_seg1=null,this.m_env=de.constructEmpty(),this.m_vertex1=-1,this.m_currentNode=-1,this.m_minDist=Number.MAX_VALUE,this.m_shape=e,this.m_tolerance=s}getCurrentNode(){return this.m_currentNode}clearIntersectionDetectedFlag(){this.m_bIntersectionDetected=!1,this.m_minDist=Number.MAX_VALUE}intersectionDetected(){return this.m_bIntersectionDetected}setPoint(e){this.m_pointOfInterest.assign(e)}compare(e,s){const i=e.getElement(s);return this.compareVertex(e,s,i)}compareVertex(e,s,i){let r,n=this.m_shape.getSegment(i),o=!0;if(n==null)this.m_shape.queryLineConnector(i,this.m_line1,!0),this.m_env.setCoordsNoNAN(this.m_line1.getStartX(),this.m_line1.getEndX()),n=this.m_line1,r=this.m_line1.getStartY()===this.m_line1.getEndY();else{const l=X.constructEmpty();n.queryLooseEnvelope(l),l.queryIntervalX(this.m_env),r=l.height()===0,o=!1}if(this.m_pointOfInterest.x+this.m_tolerance<this.m_env.vmin)return-1;if(this.m_pointOfInterest.x-this.m_tolerance>this.m_env.vmax)return 1;if(r)return this.m_currentNode=s,this.m_bIntersectionDetected=!0,0;let a=0;if(o){t1e(this.m_line1);const l=this.m_line1.getStartXY(),u=new M;u.setSub(this.m_line1.getEndXY(),l),u.rightPerpendicularThis();const c=new M;c.setSub(this.m_pointOfInterest,l),a=u.dotProduct(c),a/=u.length()}else a=n.intersectionOfYMonotonicWithAxisX(this.m_pointOfInterest.y,this.m_pointOfInterest.x)-this.m_pointOfInterest.x;return a<10*-this.m_tolerance?-1:a>10*this.m_tolerance?1:(n.isIntersectingPoint(this.m_pointOfInterest,this.m_tolerance)&&(Math.abs(a)<this.m_minDist&&(this.m_currentNode=s,this.m_minDist=a),this.m_bIntersectionDetected=!0),a<0?-1:a>0?1:0)}}class qv{constructor(e,s){this.m_lists=new ds(!1),this.m_hash=s,this.m_hashBuckets=new Int32Array(e),this.m_hashBuckets.fill(qv.st_nullNode()),this.m_bitFilter=new Int32Array(10*e+31>>5)}reserveElements(e){this.m_lists.reserveLists(Math.min(this.m_hashBuckets.length,e)),this.m_lists.reserveNodes(e)}addElement(e,s){s===void 0&&(s=this.m_hash.getHash(e));const i=s%(this.m_bitFilter.length<<5);this.m_bitFilter[i>>5]|=1<<(31&i);const r=s%this.m_hashBuckets.length;let n=this.m_hashBuckets[r];return n===ds.st_nullNode()&&(n=this.m_lists.createList(),this.m_hashBuckets[r]=n),this.m_lists.addElement(n,e)}deleteElement(e,s){s===void 0&&(s=this.m_hash.getHash(e));const i=s%this.m_hashBuckets.length,r=this.m_hashBuckets[i];r===ds.st_nullNode()&&ee("");let n=this.m_lists.getFirst(r),o=ds.st_nullNode();for(;n!==ds.st_nullNode();){const a=this.m_lists.getData(n),l=this.m_lists.getNext(n);a===e?(this.m_lists.deleteElementDirect(r,o,n),this.m_lists.getFirst(r)===ds.st_nullNode()&&(this.m_lists.deleteList(r),this.m_hashBuckets[i]=ds.st_nullNode())):o=n,n=l}}getFirstInBucket(e){const s=e%(this.m_bitFilter.length<<5);if(!(this.m_bitFilter[s>>5]&1<<(31&s)))return ds.st_nullNode();const i=e%this.m_hashBuckets.length,r=this.m_hashBuckets[i];return r===ds.st_nullNode()?ds.st_nullNode():this.m_lists.getFirst(r)}getNextInBucket(e){return this.m_lists.getNext(e)}findNode(e){const s=this.m_hash.getHash(e);let i=this.getFirstInBucket(s);for(;i!==ds.st_nullNode();){const r=this.m_lists.getData(i);if(this.m_hash.equal(r,e))return i;i=this.m_lists.getNext(i)}return ds.st_nullNode()}deleteNode(e){const s=this.getElement(e),i=this.m_hash.getHash(s)%this.m_hashBuckets.length,r=this.m_hashBuckets[i];r===ds.st_nullNode()&&ee(""),this.m_lists.deleteElementSearch(r,e),this.m_lists.getFirst(r)===ds.st_nullNode()&&(this.m_lists.deleteList(r),this.m_hashBuckets[i]=ds.st_nullNode())}getElement(e){return this.m_lists.getData(e)}static st_nullNode(){return ds.st_nullNode()}clear(){F(0)}size(){return this.m_lists.getNodeCount()}dbgPrintBucketHistogram(){}}function lve(t,e,s,i,r){const n=new hve(r);return n.m_shape=t,n.m_sqrTolerance=e*e,n.m_cellSize=2*e,n.m_invCellSize=1/n.m_cellSize,n.m_geometry=s,n.m_bTrackChanges=i,n.m_bHasSegmentParentage=t.hasSegmentParentage(),n.clusterNonReciprocal()}function Z9(t,e,s,i,r){const n=t-s,o=e-i;return n*n+o*o<=r}function Bst(){return{pt:new M,weight:0,rank:0,bMerged:!1}}function uve(t,e,s,i,r,n){const o=Bst(),a=s+r;let l=!1,u=t.x;t.x!==e.x&&(i===n&&(u=(t.x*s+e.x*r)/a),l=!0);let c=t.y;return t.y!==e.y&&(i===n&&(c=(t.y*s+e.y*r)/a),l=!0),i!==n?i>n?(o.rank=i,o.weight=s,o.pt=t):(o.rank=n,o.weight=r,o.pt=e):(o.pt.setCoords(u,c),o.weight=a,o.rank=i),o.bMerged=l,o}function jst(t,e,s,i,r,n,o,a,l){const u=t.equals(e);if(i>n)return o.assignCopy(t),l[0]=i,a[0]=s,u;if(n>i)return o=e,l[0]=n,a[0]=r,u;o.assignCopy(t);const c=uve(t.getXY(),e.getXY(),s,i,r,n);return o.setXY(c.pt),a[0]=c.weight,l[0]=c.rank,u}function Hst(t,e,s,i,r){const n=new hve(r);return n.m_shape=t,n.m_sqrTolerance=e*e,n.m_cellSize=2*e,n.m_invCellSize=1/n.m_cellSize,n.m_geometry=s,n.m_bTrackChanges=!1,n.needsClustering()}function cve(t,e){const s=G0e(t);return RJe(s,e)}class Nre{constructor(e,s,i,r,n){this.m_workPt=new M,this.m_shape=e,this.m_sqrTolerance=i,this.m_invCellSize=r,this.m_origin=s.clone(),this.m_hashValues=n}getHash(e){return this.m_shape.getUserIndex(e,this.m_hashValues)}calculateHashFromVertex(e){this.m_shape.queryXY(e,this.m_workPt);const s=this.m_workPt.x-this.m_origin.x,i=Math.trunc(s*this.m_invCellSize+.5),r=this.m_workPt.y-this.m_origin.y;return cve(i,Math.trunc(r*this.m_invCellSize+.5))}equal(e,s){return F(0),!1}}class hve{constructor(e){this.m_origin=M.getNAN(),this.m_sqrTolerance=0,this.m_cellSize=0,this.m_invCellSize=0,this.m_geometry=L,this.m_bucketArray=Me(4,Number.NaN),this.m_bucketHash=Me(4,Number.NaN),this.m_dbgCandidateCheckCount=0,this.m_nsr=new gs,this.m_hashValues=-1,this.m_newClusters=-1,this.m_bTrackChanges=!1,this.m_bHasSegmentParentage=!1,this.m_shape=null,this.m_clusters=new ds,this.m_hashFunction=null,this.m_hashTable=null,this.m_progressCounter=0,this.m_progressTracker=e}progress_(){}collectClusterCandidates(e,s){const i=M.getNAN();this.m_shape.queryXY(e,i);const r=(i.x-this.m_origin.x)*this.m_invCellSize,n=(i.y-this.m_origin.y)*this.m_invCellSize,o=Math.trunc(r),a=Math.trunc(n);let l=0;for(let u=0;u<=1;u+=1)for(let c=0;c<=1;c+=1){const h=cve(o+u,a+c),m=this.m_hashTable.getFirstInBucket(h);m!==qv.st_nullNode()&&(this.m_bucketArray[l]=m,this.m_bucketHash[l]=h,l++)}for(let u=l-1;u>=1;u--){const c=this.m_bucketArray[u];for(let h=u-1;h>=0;h--)if(c===this.m_bucketArray[h]){this.m_bucketHash[h]=-1,l--,u!==l&&(this.m_bucketHash[u]=this.m_bucketHash[l],this.m_bucketArray[u]=this.m_bucketArray[l]);break}}for(let u=0;u<l;u++)this.collectNearestNeighbourCandidates(e,this.m_bucketHash[u],i,this.m_bucketArray[u],s)}collectNearestNeighbourCandidates(e,s,i,r,n){const o=M.getNAN();for(let a=r;a!==qv.st_nullNode();a=this.m_hashTable.getNextInBucket(a)){const l=this.m_hashTable.getElement(a);e===l||s!==-1&&this.m_shape.getUserIndex(l,this.m_hashValues)!==s||(this.m_shape.queryXY(l,o),Z9(i.x,i.y,o.x,o.y,this.m_sqrTolerance)&&n.push(a))}}mergeClusters(e,s,i){let r=this.m_shape.getUserIndex(e,this.m_newClusters);const n=this.m_shape.getUserIndex(s,this.m_newClusters);r===-1&&(r=this.m_clusters.createList(),this.m_clusters.addElement(r,e),this.m_shape.setUserIndex(e,this.m_newClusters,r)),n===-1?this.m_clusters.addElement(r,s):this.m_clusters.concatenateLists(r,n),this.m_shape.setUserIndex(s,this.m_newClusters,et.impossibleIndex2());const o=this.mergeVertices(e,s);if(i){const a=this.m_hashFunction.calculateHashFromVertex(e);this.m_shape.setUserIndex(e,this.m_hashValues,a)}return o}mergeVertices(e,s){const i=M.getNAN();this.m_shape.queryXY(e,i);const r=M.getNAN();this.m_shape.queryXY(s,r);const n=this.m_shape.getRank(e),o=this.m_shape.getRank(s),a=this.m_shape.getWeight(e),l=this.m_shape.getWeight(s);let u,c,h,m,f=!1;if(n===o?(u=n,c=a+l,h=i.x,i.x!==r.x&&(h=(i.x*a+r.x*l)/c,f=!0),m=i.y,i.y!==r.y&&(m=(i.y*a+r.y*l)/c,f=!0)):(n>o?(h=i.x,m=i.y,c=a,u=n):(h=r.x,m=r.y,c=l,u=o),f=!i.equals(r)),f&&(this.m_shape.setXYMonotonic(e,h,m),this.m_bTrackChanges&&this.m_shape.setGeometryModifiedWithVertex(e,!0),this.m_bHasSegmentParentage)){const g=this.m_shape.getSegmentParentageBreakVertex(e)||this.m_shape.getSegmentParentageBreakVertex(s);this.m_shape.setSegmentParentageBreakVertex(e,g),this.m_shape.setSegmentParentageBreakVertex(s,g)}return this.m_shape.setWeight(e,c),this.m_shape.setRank(e,u),f}needsClustering(){const e={stack:[],error:void 0,hasError:!1};try{mo(e,k0e(()=>{this.m_hashTable=null,this.m_hashFunction=null,this.m_shape.removeUserIndex(this.m_hashValues),this.m_shape.removeUserIndex(this.m_newClusters)}),!1);const s=this.m_shape.getSelectedCount(),i=this.m_shape.getEnvelope2D(this.m_progressTracker);this.m_origin.assign(i.getLowerLeft());const r=Math.max(i.height(),i.width())/(Qr()-1);this.m_cellSize<r&&(this.m_cellSize=r,this.m_invCellSize=1/this.m_cellSize),this.m_clusters.clear(),this.m_clusters.reserveLists(this.m_shape.getSelectedCount()/3+1),this.m_clusters.reserveNodes(this.m_shape.getSelectedCount()/3+1),this.m_hashValues=this.m_shape.createUserIndex(),this.m_newClusters=this.m_shape.createUserIndex(),this.m_hashFunction=new Nre(this.m_shape,this.m_origin,this.m_sqrTolerance,this.m_invCellSize,this.m_hashValues),this.m_hashTable=new qv(4*s/3,this.m_hashFunction),this.m_hashTable.reserveElements(this.m_shape.getSelectedCount());let n=!1;for(let o=0;o<2;o++){const a=[],l=this.m_shape.queryVertexIteratorOnSelection(this.m_geometry);for(let u=l.next();u!==L;u=l.next()){if(this.progress_(),o>0&&this.m_shape.getUserIndex(u,this.m_newClusters)===et.impossibleIndex2())continue;let c;if(o===0?(c=this.m_hashFunction.calculateHashFromVertex(u),this.m_shape.setUserIndex(u,this.m_hashValues,c)):c=this.m_shape.getUserIndex(u,this.m_hashValues),this.collectClusterCandidates(u,a),a.length!==0){for(let h=0,m=a.length;h<m;h++){this.progress_();const f=a[h],g=this.m_hashTable.getElement(f);if(this.m_hashTable.deleteNode(f),!this.m_shape.isEqualXY(u,g))return this.m_nsr=new gs(5,this.m_shape.getVertexIndex(u),this.m_shape.getVertexIndex(g)),n=!0,n;this.mergeClusters(u,g,!1)}a.length=0}o===0&&this.m_hashTable.addElement(u,c)}}return n}catch(s){e.error=s,e.hasError=!0}finally{Od(e)}}clusterNonReciprocal(){const e=this.m_shape.getSelectedCount(),s=this.m_shape.getEnvelope2D(this.m_progressTracker);this.m_origin=s.getLowerLeft();const i=Math.max(s.height(),s.width())/(Qr()-1);this.m_cellSize<i&&(this.m_cellSize=i,this.m_invCellSize=1/this.m_cellSize),this.m_clusters.clear(),this.m_clusters.reserveLists(Math.trunc(this.m_shape.getSelectedCount()/3+1)),this.m_clusters.reserveNodes(Math.trunc(this.m_shape.getSelectedCount()/3+1)),this.m_hashValues=this.m_shape.createUserIndex(),this.m_newClusters=this.m_shape.createUserIndex(),this.m_hashFunction=new Nre(this.m_shape,this.m_origin,this.m_sqrTolerance,this.m_invCellSize,this.m_hashValues),this.m_hashTable=new qv(Math.trunc(4*e/3),this.m_hashFunction),this.m_hashTable.reserveElements(this.m_shape.getSelectedCount());let r=!1;{const n=this.m_shape.queryVertexIteratorOnSelection(this.m_geometry);for(let o=n.next();o!==L;o=n.next()){this.progress_();const a=this.m_hashFunction.calculateHashFromVertex(o);this.m_shape.setUserIndex(o,this.m_hashValues,a),this.m_hashTable.addElement(o,a)}}{const n=[],o=this.m_shape.queryVertexIteratorOnSelection(this.m_geometry);for(let a=o.next();a!==L;a=o.next()){if(this.m_shape.getUserIndex(a,this.m_newClusters)===et.impossibleIndex2())continue;let l=this.m_shape.getUserIndex(a,this.m_hashValues);this.m_hashTable.deleteElement(a,l);let u=!1;for(;this.collectClusterCandidates(a,n),n.length!==0;){let c=0;for(let h=0,m=n.length;h<m;h++){this.progress_();const f=n[h],g=this.m_hashTable.getElement(f);this.m_hashTable.deleteNode(f);const v=h+1===m;c|=this.mergeClusters(a,g,v)?1:0}if(u||(u=c!==0),r||(r=c!==0),n.length=0,!c)break}u&&(l=this.m_shape.getUserIndex(a,this.m_hashValues)),this.m_hashTable.addElement(a,l)}n.length=0}return r&&this.applyClusterPositions_(),this.m_hashTable=null,this.m_hashFunction=null,this.m_shape.removeUserIndex(this.m_hashValues),this.m_shape.removeUserIndex(this.m_newClusters),r}applyClusterPositions_(){const e=M.getNAN();for(let s=this.m_clusters.getFirstList();s!==ds.st_nullNode();s=this.m_clusters.getNextList(s)){let i=this.m_clusters.getFirst(s);const r=this.m_clusters.getElement(i);this.m_shape.queryXY(r,e);const n=this.m_shape.getRank(r),o=this.m_shape.getWeight(r);for(i=this.m_clusters.getNext(i);i!==ds.st_nullNode();i=this.m_clusters.getNext(i)){const a=this.m_clusters.getElement(i);if(this.m_bTrackChanges?this.m_shape.isEqualXYPoint2D(a,e)||(this.m_shape.setXYMonotonicPoint2D(a,e),this.m_shape.setGeometryModifiedWithVertex(a,!0)):this.m_shape.setXYMonotonicPoint2D(a,e),this.m_bHasSegmentParentage){const l=this.m_shape.getSegmentParentageBreakVertex(r)||this.m_shape.getSegmentParentageBreakVertex(a);this.m_shape.setSegmentParentageBreakVertex(r,l),this.m_shape.setSegmentParentageBreakVertex(a,l)}this.m_shape.setWeight(a,o),this.m_shape.setRank(a,n)}}}}class ha{constructor(){this.m_inputParts=[],this.m_resultParts1=[],this.m_resultParts2=[],this.m_resultSegments=[],this.m_freeSegments=[],this.m_inputSegments=[],this.m_param1=[],this.m_param2=[],this.m_tolerance=0,this.m_toleranceZ=0,this.m_point=new nt,this.m_pointWeight=1,this.m_maxDensifyLimit=0,this.m_pointRank=0,this.m_changed1=!1,this.m_changed2=!1,this.m_adaptiveDensify=!1}clear(){this.freeAllResultSegments(),this.m_inputSegments.length=0,this.m_inputParts.length=0,this.m_resultParts1.length=0,this.m_resultParts2.length=0,this.m_param1.length=0,this.m_param2.length=0,this.m_adaptiveDensify=!1,this.m_changed1=!1,this.m_changed2=!1}newIntersectionPart_(e,s,i,r,n,o,a,l,u,c){return Xst(e,s,i,r,n,o,a,l,u,c)}pushSegment(e,s,i,r,n,o,a,l,u,c){return this.m_inputParts.push(this.newIntersectionPart_(this.m_inputSegments.length,s,i,r,n,o,a,l,u,c)),this.m_inputSegments.push(e),this.m_inputParts.length-1}getResultSegmentCount(e){return this.m_adaptiveDensify?e===0?this.m_param1.length-1:this.m_param2.length-1:e===0?this.m_resultParts1.length:this.m_resultParts2.length}getResultPart_(e,s){return e===0?this.m_resultParts1[s]:this.m_resultParts2[s]}getResultSegment(e,s){return this.m_resultSegments[this.getResultPart_(e,s).segmentIndex].get()}getSegmentChanged(e){return e===0?this.m_changed1:this.m_changed2}getResultSegmentStartPointWeight(e,s){return this.getResultPart_(e,s).weightStart}getResultSegmentStartPointRank(e,s){return this.getResultPart_(e,s).rankStart}getResultSegmentSegmentParentage(e,s){return this.getResultPart_(e,s).segmentParentage}getResultSegmentStartPointIsBreak(e,s){return this.getResultPart_(e,s).u.bBreakStart}getResultSegmentEndPointWeight(e,s){return this.getResultPart_(e,s).weightEnd}getResultSegmentEndPointRank(e,s){return this.getResultPart_(e,s).rankEnd}getResultSegmentEndPointIsBreak(e,s){return this.getResultPart_(e,s).u.bBreakEnd}getResultSegmentInteriorRank(e,s){return this.getResultPart_(e,s).rankInterior}getResultSegmentInteriorWeight(e,s){return this.getResultPart_(e,s).weightInterior}getResultPoint(){return this.m_point}getResultPointWeight(){return this.m_pointWeight}getResultPointRank(){return this.m_pointRank}getResultPointChanged(){return this.m_changed2}intersectLines(e,s){this.m_inputSegments.length!==2&&Ce(""),this.m_changed1=!1,this.m_changed2=!1,this.m_tolerance=e;const i=Pt(e*ha.c_smallToleranceFactor);let r=!1;const n=this.m_inputParts[0],o=this.m_inputParts[1],a=this.m_inputSegments[n.segmentIndex],l=this.m_inputSegments[o.segmentIndex];if(s||5&Cx(!0,a,l,e,!0)){const u=C0(!0,a,l,null,this.m_param1,this.m_param2,e);u===0&&Ce("");const c=new Array(u);for(let A=0;A<u;++A)c[A]=M.getNAN();const h=new Float64Array(u),m=new Int32Array(u),f=new Array(u),g=new Array(u);for(let A=0;A<u;++A)f[A]=aD(),g[A]=aD();for(let A=0;A<u;A++){const D=this.m_param1[A],k=this.m_param2[A];let R,O=n.rankInterior,z=n.weightInterior;D===0?(O=n.rankStart,z=n.weightStart,R=n.u.bBreakStart):D===1?(O=n.rankEnd,z=n.weightEnd,R=n.u.bBreakEnd):(this.m_changed1=!0,R=!1);let q,U=o.rankInterior,V=o.weightInterior;k===0?(U=o.rankStart,V=o.weightStart,q=o.u.bBreakStart):k===1?(U=o.rankEnd,V=o.weightEnd,q=o.u.bBreakEnd):(this.m_changed2=!0,q=!1);const B=O,H=U;let W=1,ie=0,se=M.getNAN();if(B===H){const Z=a.getCoord2D(D),te=l.getCoord2D(k);W=z+V,ie=O,wi(Z,te,V/W,se);const ve=M.sqrDistance(se,Z),ke=M.sqrDistance(se,te);f[A].bBigMove=ve>i,g[A].bBigMove=ke>i,this.m_changed1||Z.equals(se)||(this.m_changed1=!0),this.m_changed2||te.equals(se)||(this.m_changed2=!0)}else if(B>H){se=a.getCoord2D(D);const Z=l.getCoord2D(k);W=z,ie=O;const te=M.sqrDistance(se,Z);f[A].bBigMove=!1,g[A].bBigMove=te>i,this.m_changed2||Z.equals(se)||(this.m_changed2=!0)}else{se=l.getCoord2D(k),W=V,ie=U;const Z=a.getCoord2D(D),te=M.sqrDistance(se,Z);f[A].bBigMove=te>i,g[A].bBigMove=!1,this.m_changed1||Z.equals(se)||(this.m_changed1=!0)}c[A].assign(se),h[A]=W,m[A]=ie,f[A].bIsBreak=R||q,g[A].bIsBreak=R||q,r||(r=f[A].bBigMove||g[A].bBigMove)}const v=n.rankInterior,b=n.weightInterior;let w=0,S=-1;for(let A=0;A<=u;A++){const D=A<u?this.m_param1[A]:1;if(D!==w){const k=this.allocResultSegment(),R=this.m_resultSegments[k];let O,z,q,U;a.queryCut(w,D,R,!1),R.get().snapControlPoints(e*e);let V=!1,B=!1,H=!1,W=!1,ie=!1,se=M.getNAN(),Z=M.getNAN();S!==-1?(z=m[S],O=h[S],V=f[S].bBigMove,se.assign(c[S]),H=f[S].bIsBreak,ie=!0):(O=n.weightStart,z=n.rankStart,se=R.get().getStartXY(),H=n.u.bBreakStart),A<u?(U=m[A],q=h[A],B=f[A].bBigMove,Z.assign(c[A]),W=f[A].bIsBreak,ie=!0):(q=n.weightEnd,U=n.rankEnd,Z=R.get().getEndXY(),W=n.u.bBreakEnd),ie&&R.get().setCoordsForIntersector(se,Z,!0),this.m_resultParts1.push(this.newIntersectionPart_(k,O,z,q,U,b,v,H,W,n.segmentParentage));const te=this.m_resultParts1.at(-1);te.u.bBigMoveStart=V,te.u.bBigMoveEnd=B,w=D,S=A}else S===-1&&(S=A)}const T=Me(u,0);for(let A=0;A<u;A++)T[A]=A;u>2?(T.sort((A,D)=>this.m_param2[A]<this.m_param2[D]?-1:this.m_param2[A]>this.m_param2[D]?1:0),xx(this.m_param2)):u===2&&this.m_param2[0]>this.m_param2[1]&&(this.m_param2[1]=be(this.m_param2[0],this.m_param2[0]=this.m_param2[1]),T[1]=be(T[0],T[0]=T[1]));const P=o.rankInterior,I=o.weightInterior;w=0,S=-1;for(let A=0;A<=u;A++){const D=A<u?this.m_param2[A]:1;if(D!==w){const k=this.allocResultSegment(),R=this.m_resultSegments[k];let O,z,q,U;l.queryCut(w,D,R,!1),R.get().snapControlPoints(e*e);let V=M.getNAN(),B=M.getNAN(),H=!1,W=!1,ie=!1,se=!1,Z=!1;if(S!==-1){const ve=T[S];O=h[ve],z=m[ve],V.assign(c[ve]),ie=g[ve].bBigMove,H=g[ve].bIsBreak,Z=!0}else O=o.weightStart,z=o.rankStart,V=R.get().getStartXY(),H=o.u.bBreakStart;if(A!==u){const ve=T[A];q=h[ve],U=m[ve],B.assign(c[ve]),se=g[ve].bBigMove,W=g[ve].bIsBreak,Z=!0}else q=o.weightEnd,U=o.rankEnd,B=R.get().getEndXY(),W=o.u.bBreakEnd;Z&&R.get().setCoordsForIntersector(V,B,!0),this.m_resultParts2.push(this.newIntersectionPart_(k,O,z,q,U,I,P,H,W,o.segmentParentage));const te=this.m_resultParts2.at(-1);te.u.bBigMoveStart=ie,te.u.bBigMoveEnd=se,w=D,S=A}else S===-1&&(S=A)}return r?3:2}return 0}intersectLines3D(e,s,i,r){return F(0),1}intersect2D(e,s){const i=this.m_inputParts[0],r=this.m_inputParts[1],n=this.m_inputSegments[i.segmentIndex].getGeometryType(),o=this.m_inputSegments[r.segmentIndex].getGeometryType();return n!==G.enumLine||o!==G.enumLine?new Wst(this).intersectCurves(e,s):this.intersectLines(e,s)}intersect2DEx(e,s,i,r,n){this.m_point.assignCopy(s),this.m_inputSegments.length!==1&&Ce(""),this.m_tolerance=e,this.m_changed1=!1,this.m_changed2=!1;const o=Pt(e*ha.c_smallToleranceFactor);let a=!1;const l=this.m_inputParts[0],u=this.m_inputSegments[l.segmentIndex];if(n||u.isIntersectingPoint(s.getXY(),e,!0)){this.m_param1=Me(16,Number.NaN);const c=u.getClosestCoordinate(s.getXY(),!1);this.m_param1[0]=c;let h=l.rankInterior,m=l.weightInterior;c===0?(h=l.rankStart,m=l.weightStart):c===1?(h=l.rankEnd,m=l.weightEnd):this.m_changed1=!0;let f=h;const g=i,v=r;f===g&&u.isCurve()&&(f=g+1);let b=1,w=0;const S=new M;if(f===g){const A=u.getCoord2D(c),D=s.getXY();b=m+v,w=h,wi(A,D,v/b,S),this.m_changed1||A.equals(S)||(this.m_changed1=!0),this.m_changed2||D.equals(S)||(this.m_changed2=!0),a=M.sqrDistance(S,A)>o}else f>g?(S.assign(u.getCoord2D(c)),b=m,w=h,this.m_changed2||S.equals(s.getXY())||(this.m_changed2=!0)):(S.assign(u.getCoord2D(c)),b=v,w=g,this.m_changed1||S.equals(s.getXY())||(this.m_changed1=!0),a=M.sqrDistance(S,s.getXY())>o);let T=0,P=-1;const I=1;for(let A=0;A<=I;A++){const D=A<I?this.m_param1[0]:1;if(D!==T){const k=this.allocResultSegment(),R=this.m_resultSegments[k];u.queryCut(T,D,R),R.get().snapControlPoints(e*e);let O=l.weightStart,z=l.weightEnd,q=l.rankStart,U=l.rankEnd;const V=l.rankInterior,B=l.weightInterior;let H=l.u.bBreakStart,W=l.u.bBreakEnd;P!==-1&&(O=b,q=w,H=!0,R.get().setCoordsForIntersector(S,R.get().getEndXY(),!0)),A!==I&&(z=b,U=w,W=!0,R.get().setCoordsForIntersector(R.get().getStartXY(),S,!0)),T=D,this.m_resultParts1.push(this.newIntersectionPart_(k,O,q,z,U,B,V,H,W,l.segmentParentage))}P=A}return this.m_point.setXY(S),this.m_pointWeight=b,this.m_pointRank=w,a?3:2}return 0}intersect3D(e,s,i,r){return F(0),1}intersect3DEx(e,s,i,r,n,o,a){return F(0),1}getTolerance(){return this.m_tolerance}freeAllResultSegments(){this.m_resultSegments.length=0,this.m_freeSegments.length=0}freeResultSegment(e){this.m_freeSegments.push(e)}allocResultSegment(){if(this.m_freeSegments.length)return this.m_freeSegments.pop();const e=new ut,s=this.m_resultSegments.length;return this.m_resultSegments.push(e),s}allocResultSegmentFromBuffer(e){if(this.m_freeSegments.length)return this.m_freeSegments.pop();const s=new ut({copy:e}),i=this.m_resultSegments.length;return this.m_resultSegments.push(s),i}allocResultSegmentFromSegment(e){if(this.m_freeSegments.length)return this.m_freeSegments.pop();const s=new ut({segment:e}),i=this.m_resultSegments.length;return this.m_resultSegments.push(s),i}}function Yst(t,e){return{bBigMoveStart:!1,bBigMoveEnd:!1,bBreakStart:t,bBreakEnd:e}}function Xst(t,e,s,i,r,n,o,a,l,u){return{segmentIndex:t,weightStart:e,rankStart:s,weightEnd:i,rankEnd:r,weightInterior:n,rankInterior:o,segmentParentage:u,u:Yst(a,l)}}function aD(){return{bBigMove:!1,bIsBreak:!1}}ha.maxWeight=.1*Number.MAX_VALUE,ha.c_smallToleranceFactor=.01,ha.c_maxGeometryTypeToRankDelta=8;let Dre=class{constructor(){this.start=null,this.end=null,this.equalEdge=null,this.segmentIndex=-1,this.segmentParentage=-1,this.weight=0,this.rank=0}hasSegment(){return this.segmentIndex>=0}transferAttributes(t,e,s){if(e.getDescription().getAttributeCount()===1)return;const i=t.parent.m_resultSegments[this.segmentIndex].get().getStartXY(),r=t.parent.m_resultSegments[this.segmentIndex].get().getEndXY(),n=new nt;e.queryStart(n),s?(n.setXY(i),t.parent.m_resultSegments[this.segmentIndex].get().setStart(n)):(n.setXY(r),t.parent.m_resultSegments[this.segmentIndex].get().setEnd(n)),e.queryEnd(n),s?(n.setXY(r),t.parent.m_resultSegments[this.segmentIndex].get().setEnd(n)):(n.setXY(i),t.parent.m_resultSegments[this.segmentIndex].get().setStart(n))}copyFromWhenOverlap(t,e,s){this.equalEdge=e,e.equalEdge=this,this.segmentIndex=t.parent.allocResultSegmentFromBuffer(t.parent.m_resultSegments[e.segmentIndex]),this.segmentParentage=e.segmentParentage,this.weight=e.weight,this.rank=e.rank,s?(this.start.copyFrom(e.start),this.end.copyFrom(e.end)):(this.start.copyFrom(e.end),this.end.copyFrom(e.start),t.parent.m_resultSegments[this.segmentIndex].get().reverse())}getEnd(){return this.end}getNextInChain(){return this.end.nextInChain}getPrevInChain(){return this.start.prevInChain}};class $re{constructor(){this.hash=0,this.pt=new M,this.prevInChain=null,this.nextInChain=null,this.prevInHash=null,this.nextInHash=null,this.prevEqual=null,this.nextEqual=null,this.weight=0,this.rank=0,this.bBigMove=!1,this.bIsBreak=!1}copyFrom(e){this.pt.assign(e.pt),this.weight=e.weight,this.rank=e.rank,this.bBigMove=e.bBigMove,this.bIsBreak=e.bIsBreak}nextNode(){return this.nextInChain?this.nextInChain.end:null}prevNode(){return this.prevInChain?this.prevInChain.start:null}equalListHead(){let e=this;for(;e.prevEqual!==null;e=e.prevEqual);return e}}function Ap(t,e,s,i){return{edge1:t,edge2:e,recursion:s,bIsIntersecting:i}}class Wst{constructor(e){this.m_pairs=[],this.m_chainOrigin1=null,this.m_chainOrigin2=null,this.m_newNodes=[],this.m_hashTableOfEquals=[],this.m_hashTableOfEqualsSize=0,this.m_origin=new M,this.m_cell=new M,this.parent=e}addSegment(e,s,i,r,n,o,a,l,u,c,h){const m=this.newNode(this.parent.m_resultSegments[e].get().getStartXY(),i,r,u),f=this.newNode(this.parent.m_resultSegments[e].get().getEndXY(),n,o,c);this.newEdge(m,f,e,a,l,h),this.m_chainOrigin1===null?this.m_chainOrigin1=m:this.m_chainOrigin2===null?this.m_chainOrigin2=m:F(0)}intersectCurvesHelper(e,s,i,r,n){var se,Z,te,ve,ke,Fe,Pe,Ve,Ke,He,Rs,Cr,Js,as,er,fi,Ks,dt;const o=this.getSegment(e).get(),a=this.getSegment(s).get();if(o.isDegenerate(0)||a.isDegenerate(0))return 0;const l=this.tryOverlapIntersectCurves(e,s,i,r);if(l!==0)return l;const u=Pt(.01*i);let c=!1,h=this.processSharpCorners(o,a,i,n>4);const m=h>0;if(!m){if(!(r||5&_R(!0,!1,o,a,i,!0)))return 0;h=C0(!0,o,a,null,this.parent.m_param1,this.parent.m_param2,i)}h===0&&Ce("");const f=o.getGeometryType(),g=a.getGeometryType(),v=ne(M,h),b=ne(M,h),w=Me(h,Number.NaN),S=Me(h,Number.NaN),T=Me(h,Number.NaN),P=Me(h,Number.NaN),I=cie(aD,h),A=cie(aD,h);let D=!1,k=!1;for(let De=0;De<h;De++){const ks=this.parent.m_param1[De],Pr=this.parent.m_param2[De];let Ui=e.rank,tr=e.weight,Ho=!0,Ai=!1;ks===0?(Ui=e.start.rank,tr=e.start.weight,Ai=e.start.bIsBreak):ks===1?(Ui=e.end.rank,tr=e.end.weight,Ai=e.end.bIsBreak):(D=!0,Ho=!1);let Wn=s.rank,an=s.weight,mr=!1,Si=!0;Pr===0?(Wn=s.start.rank,an=s.start.weight,mr=s.start.bIsBreak):Pr===1?(Wn=s.end.rank,an=s.end.weight,mr=s.end.bIsBreak):(k=!0,Si=!1);let Ei=Ui,Cs=Wn;if(Ei===Cs&&(Ei*=ha.c_maxGeometryTypeToRankDelta,Cs*=ha.c_maxGeometryTypeToRankDelta,Ei+=N1(f,o,!1),Cs+=N1(g,a,!1)),Ho&&Si&&Cs===Ei){const Hu=o.getCoord2D(ks),jd=a.getCoord2D(Pr);Hu.equals(jd)&&(Cs=Ei-1)}let ln=1,Yo=0,Tr=1,su=0;const Vr=new M,Pn=new M,Xo=o.getCoord2D(ks),yo=a.getCoord2D(Pr);if(m&&M.distance(Xo,yo)>i)Vr.setCoordsPoint2D(Xo),Pn.setCoordsPoint2D(yo),ln=tr,Tr=an,Yo=Ui,su=Wn,I[De].bBigMove=!1,A[De].bBigMove=!1,Ai=!0,mr=!0;else if(Ei===Cs){Tr=ln=tr+an,su=Yo=Ui,wi(Xo,yo,an/ln,Vr),Pn.setCoordsPoint2D(Vr);const Hu=M.sqrDistance(Vr,Xo),jd=M.sqrDistance(Vr,yo);I[De].bBigMove=Hu>u,A[De].bBigMove=jd>u,D||Xo.equals(Vr)||(D=!0),k||yo.equals(Pn)||(k=!0)}else if(Ei>Cs){Vr.setCoordsPoint2D(Xo),Pn.setCoordsPoint2D(Vr),Tr=ln=tr,su=Yo=Ui;const Hu=M.sqrDistance(Vr,yo);I[De].bBigMove=!1,A[De].bBigMove=Hu>u,k||yo.equals(Pn)||(k=!0)}else{Pn.setCoordsPoint2D(yo),Vr.setCoordsPoint2D(Pn),Tr=ln=an,su=Yo=Wn;const Hu=M.sqrDistance(Vr,Xo);I[De].bBigMove=Hu>u,A[De].bBigMove=!1,D||Xo.equals(Vr)||(D=!0)}v[De].assign(Vr),b[De].assign(Pn),w[De]=ln,S[De]=Tr,T[De]=Yo,P[De]=su,I[De].bIsBreak=Ai||mr,A[De].bIsBreak=Ai||mr,c||(c=I[De].bBigMove||A[De].bBigMove),De>0&&(ks!==this.parent.m_param1[De-1]&&Pr!==this.parent.m_param2[De-1]||(T[De]<=T[De-1]?(v[De].assign(b[De-1]),w[De]=S[De-1],T[De]=P[De-1],b[De].assign(b[De-1]),S[De]=S[De-1],P[De]=P[De-1],(se=I[De]).bBigMove||(se.bBigMove=I[De-1].bBigMove),(Z=A[De]).bBigMove||(Z.bBigMove=A[De-1].bBigMove),(te=I[De]).bIsBreak||(te.bIsBreak=I[De-1].bIsBreak),(ve=A[De]).bIsBreak||(ve.bIsBreak=A[De-1].bIsBreak)):(v[De-1].assign(v[De]),w[De-1]=w[De],T[De-1]=T[De],b[De-1].assign(b[De]),S[De-1]=S[De],P[De-1]=P[De],(ke=I[De-1]).bBigMove||(ke.bBigMove=I[De].bBigMove),(Fe=A[De-1]).bBigMove||(Fe.bBigMove=A[De].bBigMove),(Pe=I[De-1]).bIsBreak||(Pe.bIsBreak=I[De].bIsBreak),(Ve=A[De-1]).bIsBreak||(Ve.bIsBreak=A[De].bIsBreak))))}if(!(D||k||h!==2||f===G.enumLine&&g===G.enumLine)){if(this.processDoublyConnectedEdges(e,s,n+1,i))return this.parent.m_changed1=!0,this.parent.m_changed2=!0,2;F(0)}(Ke=this.parent).m_changed1||(Ke.m_changed1=D),(He=this.parent).m_changed2||(He.m_changed2=k);let R=e,O=e.end.weight,z=e.end.rank,q=e.end.bBigMove,U=e.end.bIsBreak,V=0,B=-1;for(let De=0;De<=h;De++){const ks=De<h?this.parent.m_param1[De]:1;if(ks!==V){const Pr=this.parent.allocResultSegment(),Ui=this.parent.m_resultSegments[Pr];let tr,Ho,Ai,Wn;o.queryCut(V,ks,Ui,!1),Ui.get().snapControlPoints(i*i);let an=!1,mr=!1,Si=!1,Ei=!1;const Cs=new M,ln=new M;B!==-1?(Ho=T[B],tr=w[B],Si=I[B].bBigMove,an=I[B].bIsBreak,Cs.assign(v[B])):(tr=e.start.weight,Ho=e.start.rank,Si=e.start.bBigMove,an=e.start.bIsBreak,Cs.assign(Ui.get().getStartXY())),De<h?(Wn=T[De],Ai=w[De],Ei=I[De].bBigMove,mr=I[De].bIsBreak,ln.assign(v[De])):(Ai=O,Wn=z,Ei=q,mr=U,ln.assign(Ui.get().getEndXY()));let Yo=R;ks<1&&(this.splitEdgeInPlace(R),Yo=R.getNextInChain()),this.updateSegmentOnly(R,Pr),R.start.hash===0||R.start.pt.equals(Cs)||(this.m_newNodes.push(R.start),this.removeNodeFromHash(R.start),R.start.hash=0),R.end.hash===0||R.end.pt.equals(ln)||(this.m_newNodes.push(R.end),this.removeNodeFromHash(R.end),R.end.hash=0),R.start.pt.assign(Cs),R.end.pt.assign(ln),(Rs=R.start).bBigMove||(Rs.bBigMove=Si),(Cr=R.end).bBigMove||(Cr.bBigMove=Ei),(Js=R.start).bIsBreak||(Js.bIsBreak=an),(as=R.end).bIsBreak||(as.bIsBreak=mr),R.start.weight=tr,R.start.rank=Ho,R.end.weight=Ai,R.end.rank=Wn,R=Yo,V=ks,B=De}else B===-1&&(B=De)}const H=R.getNextInChain(),W=[];W.length=h;for(let De=0;De<h;De++)W[De]=De;h>2?(W.sort((De,ks)=>em(this.parent.m_param2[De],this.parent.m_param2[ks])),this.parent.m_param2.sort(em)):h===2&&this.parent.m_param2[0]>this.parent.m_param2[1]&&(this.parent.m_param2[1]=be(this.parent.m_param2[0],this.parent.m_param2[0]=this.parent.m_param2[1]),W[1]=be(W[0],W[0]=W[1])),R=s,O=s.end.weight,z=s.end.rank,q=s.end.bBigMove,U=s.end.bIsBreak,V=0,B=-1;for(let De=0;De<=h;De++){const ks=De<h?this.parent.m_param2[De]:1;if(ks!==V){const Pr=this.parent.allocResultSegment(),Ui=this.parent.m_resultSegments[Pr];let tr,Ho,Ai,Wn;a.queryCut(V,ks,Ui,!1),Ui.get().snapControlPoints(i*i);const an=new M,mr=new M;let Si=!1,Ei=!1,Cs=!1,ln=!1;if(B!==-1){const Tr=W[B];tr=S[Tr],Ho=P[Tr],an.assign(b[Tr]),Cs=A[Tr].bBigMove,Si=A[Tr].bIsBreak}else tr=s.start.weight,Ho=s.start.rank,Cs=s.start.bBigMove,Si=s.start.bIsBreak,an.assign(Ui.get().getStartXY());if(De!==h){const Tr=W[De];Ai=S[Tr],Wn=P[Tr],mr.assign(b[Tr]),ln=A[Tr].bBigMove,Ei=A[Tr].bIsBreak}else Ai=O,Wn=z,ln=q,Ei=U,mr.assign(Ui.get().getEndXY());let Yo=R;ks<1&&(this.splitEdgeInPlace(R),Yo=R.getNextInChain()),this.updateSegmentOnly(R,Pr),R.start.hash===0||R.start.pt.equals(an)||(this.m_newNodes.push(R.start),this.removeNodeFromHash(R.start),R.start.hash=0),R.end.hash===0||R.end.pt.equals(mr)||(this.m_newNodes.push(R.end),this.removeNodeFromHash(R.end),R.end.hash=0),R.start.pt.assign(an),R.end.pt.assign(mr),(er=R.start).bBigMove||(er.bBigMove=Cs),(fi=R.end).bBigMove||(fi.bBigMove=ln),(Ks=R.start).bIsBreak||(Ks.bIsBreak=Si),(dt=R.end).bIsBreak||(dt.bIsBreak=Ei),R.start.weight=tr,R.start.rank=Ho,R.end.weight=Ai,R.end.rank=Wn,R=Yo,V=ks,B=De}else B===-1&&(B=De)}const ie=R.getNextInChain();return this.postProcessResultPartsForCurves(e,H,s,ie,n+1),c?3:2}intersectCurves(e,s){this.parent.m_inputSegments.length!==2&&Ce(""),this.parent.m_changed1=!1,this.parent.m_changed2=!1,this.parent.m_tolerance=e,this.m_hashTableOfEqualsSize=0,this.m_hashTableOfEquals=fE(16);const i=X.constructEmpty();for(let o=0;o<2;o++){const a=this.parent.allocResultSegmentFromSegment(this.parent.m_inputSegments[this.parent.m_inputParts[o].segmentIndex]),l=X.constructEmpty();this.parent.m_inputSegments[this.parent.m_inputParts[o].segmentIndex].queryLooseEnvelope(l),i.mergeEnvelope2D(l);const u=this.parent.m_inputParts[o];this.addSegment(a,0,u.weightStart,u.rankStart,u.weightEnd,u.rankEnd,u.weightInterior,u.rankInterior,u.u.bBreakStart,u.u.bBreakEnd,u.segmentParentage)}i.inflateCoords(100*e,100*e),this.m_origin.assign(i.getLowerLeft()),this.m_cell.setCoords(2*e,2*e),this.m_pairs.push(Ap(this.m_chainOrigin1.nextInChain,this.m_chainOrigin2.nextInChain,0,s));let r=0,n=!0;for(;this.m_pairs.length;){const o=this.m_pairs.at(-1);this.m_pairs.pop(),F(o.recursion>=0),F(o.recursion<=256),this.clusterNodes(e);const a=this.intersectCurvesHelper(o.edge1,o.edge2,e,o.bIsIntersecting,o.recursion);n&&(n=!1,r=a)}for(let o=0;o<2;o++){const a=o===0?this.parent.m_resultParts1:this.parent.m_resultParts2;for(let l=(o===0?this.m_chainOrigin1:this.m_chainOrigin2).nextInChain;l!=null;l=l.getNextInChain())a.push(this.parent.newIntersectionPart_(l.segmentIndex,l.start.weight,l.start.rank,l.end.weight,l.end.rank,l.weight,l.rank,l.start.bIsBreak,l.end.bIsBreak,l.segmentParentage)),a.at(-1).u.bBigMoveStart=l.start.bBigMove,a.at(-1).u.bBigMoveEnd=l.end.bBigMove}return r}tryOverlapIntersectCurves(e,s,i,r){const n=this.parent.m_resultSegments[e.segmentIndex].get(),o=this.parent.m_resultSegments[s.segmentIndex].get(),a=n.getStartXY().equals(o.getStartXY())&&n.getEndXY().equals(o.getEndXY()),l=n.getStartXY().equals(o.getEndXY())&&n.getEndXY().equals(o.getStartXY());if(!a&&!l)return 0;const u=Ea(n,o,!0);if(u!==0&&J1e(n,o)&&e.segmentParentage===s.segmentParentage){let g=!1;if(u>0)g=n.equals(o);else{F(u===-1);const v=new ut({segment:o});v.get().reverse(),g=n.equals(v.get())}if(g)return 1}const c=i*ha.c_smallToleranceFactor;let h=!1;if(u===0){const g=[.5,.25,.75,.125,.375,.625,.875,.5625,.3125];for(let v=0,b=g.length;v<b;++v){const w=g[v],S=new M;n.queryCoord2D(w,S);const T=o.getClosestCoordinate(S,!1),P=new M;o.queryCoord2D(T,P);const I=M.distance(S,P);if(I>i)return 0;h||(h=I>c)}for(let v=0,b=g.length;v<b;++v){const w=g[v],S=new M;o.queryCoord2D(w,S);const T=n.getClosestCoordinate(S,!1),P=new M;n.queryCoord2D(T,P);const I=M.distance(S,P);if(I>i)return 0;h||(h=I>c)}}let m=e.rank,f=s.rank;return m===f&&(m*=ha.c_maxGeometryTypeToRankDelta,f*=ha.c_maxGeometryTypeToRankDelta,m+=N1(n.getGeometryType(),n,!0),f+=N1(o.getGeometryType(),o,!0)),m>f?(s.copyFromWhenOverlap(this,e,a),s.transferAttributes(this,n,a)):f>m?(e.copyFromWhenOverlap(this,s,a),e.transferAttributes(this,o,a)):e.segmentParentage<=s.segmentParentage?(e.weight=e.weight+s.weight,s.copyFromWhenOverlap(this,e,a),s.transferAttributes(this,n,a)):(s.weight=e.weight+s.weight,e.copyFromWhenOverlap(this,s,a),e.transferAttributes(this,o,a)),h?3:2}postProcessResultPartsForCurves(e,s,i,r,n){n===mie()&&Ce("curve_helper");for(let o=e;o!==s;o=o.getNextInChain())this.updateSegmentToNodes(o);for(let o=i;o!==r;o=o.getNextInChain())this.updateSegmentToNodes(o);for(let o=e;o!==s;o=o.getNextInChain()){const a=o.end.pt.sub(o.start.pt);for(let l=i;l!==r;l=l.getNextInChain()){let u=0;if(o.start.pt.equals(l.start.pt)&&o.end.pt.equals(l.end.pt)?u=1:o.start.pt.equals(l.end.pt)&&o.end.pt.equals(l.start.pt)&&(u=-1),!u){let v=o.start.pt.equals(l.start.pt)?1:0;if(v||(v=o.end.pt.equals(l.end.pt)?2:0,v||(v=o.end.pt.equals(l.start.pt)?3:0,v||(v=o.start.pt.equals(l.end.pt)?4:0))),v){const b=l.end.pt.sub(l.start.pt),w=a.dotProduct(b);let S;switch(v){case 1:case 2:S=w>0;break;case 3:case 4:S=w<0;break;default:Ce("post_process_result_parts_for_curves_")}S&&this.m_pairs.push(Ap(o,l,n,!1))}continue}const c=this.parent.m_resultSegments[o.segmentIndex],h=this.parent.m_resultSegments[l.segmentIndex],m=[.5,.25,.75];for(let v=0,b=m.length;v<b;++v){const w=m[v],S=new M;c.get().queryCoord2D(w,S);const T=h.get().getClosestCoordinate(S,!1),P=new M;if(h.get().queryCoord2D(T,P),M.distance(S,P)>this.parent.m_tolerance){u=0;break}}if(!u){this.m_pairs.push(Ap(o,l,n,!1));continue}for(let v=0,b=m.length;v<b;++v){const w=m[v],S=new M;h.get().queryCoord2D(w,S);const T=c.get().getClosestCoordinate(S,!1),P=new M;if(c.get().queryCoord2D(T,P),M.distance(S,P)>this.parent.m_tolerance){u=0;break}}if(!u){this.m_pairs.push(Ap(o,l,n,!1));continue}o.equalEdge=l,l.equalEdge=o;let f=o.rank,g=l.rank;f===g&&(f*=ha.c_maxGeometryTypeToRankDelta,g*=ha.c_maxGeometryTypeToRankDelta,f+=N1(c.get().getGeometryType(),c.get(),!0),g+=N1(h.get().getGeometryType(),h.get(),!0)),f>g||f===g&&o.segmentParentage<=l.segmentParentage?(c.copyTo(h,!1),l.segmentParentage=o.segmentParentage,u===-1&&h.get().reverse()):(h.copyTo(c,!1),o.segmentParentage=l.segmentParentage,u===-1&&c.get().reverse());break}}this.updateAttachedEdgesAfterNodeChange(e.start),s&&this.updateAttachedEdgesAfterNodeChange(s.start),this.updateAttachedEdgesAfterNodeChange(i.start),r&&this.updateAttachedEdgesAfterNodeChange(r.start)}processDoublyConnectedEdges(e,s,i,r){i===mie()&&Ce("curve_helper");const n=this.getSegment(e).get(),o=this.getSegment(s).get(),a=n.getStartXY().equals(o.getStartXY())&&n.getEndXY().equals(o.getEndXY())?1:n.getEndXY().equals(o.getStartXY())&&n.getStartXY().equals(o.getEndXY())?-1:0;if(a!==0){const l=new ut;n.queryCut(0,.5,l),l.get().snapControlPoints(r*r);const u=new ut;n.queryCut(.5,1,u),u.get().snapControlPoints(r*r),this.splitEdgeInPlace(e),e.end.pt=l.get().getEndXY(),e.segmentIndex=this.parent.allocResultSegmentFromBuffer(l),e.getNextInChain().segmentIndex=this.parent.allocResultSegmentFromBuffer(u);let c=o.getClosestCoordinate(e.end.pt,!1);return Math.abs(c-.5)>.2&&(c=.5),o.queryCut(0,c,l),l.get().snapControlPoints(r*r),o.queryCut(c,1,u),u.get().snapControlPoints(r*r),this.splitEdgeInPlace(s),s.end.pt=l.get().getEndXY(),s.segmentIndex=this.parent.allocResultSegmentFromBuffer(l),s.getNextInChain().segmentIndex=this.parent.allocResultSegmentFromBuffer(u),a>0?(this.m_pairs.push(Ap(e,s,i,!1)),this.m_pairs.push(Ap(e.getNextInChain(),s.getNextInChain(),i,!1))):(this.m_pairs.push(Ap(e,s.getNextInChain(),i,!1)),this.m_pairs.push(Ap(e.getNextInChain(),s,i,!1))),!0}return!1}newNode(e,s,i,r){const n=new $re;return this.m_newNodes.push(n),n.pt=e,n.rank=i,n.weight=s,n.bIsBreak=r,n}newEdge(e,s,i,r,n,o){const a=new Dre;return a.start=e,a.end=s,e.nextInChain=a,s.prevInChain=a,a.segmentIndex=i,a.segmentParentage=o,a.rank=n,a.weight=r,a}splitEdgeInPlace(e){e.segmentIndex=-1;const s=new Dre,i=new $re;this.m_newNodes.push(i),i.pt.setNAN(),i.nextInChain=s,i.prevInChain=e,i.prevInHash=null,i.nextInHash=null,i.prevEqual=null,i.nextEqual=null,i.weight=e.weight,i.rank=e.rank,i.bIsBreak=!1,i.bBigMove=!1,s.start=i,s.segmentIndex=-1,s.end=e.end,s.end.prevInChain=s,s.rank=e.rank,s.weight=e.weight,s.segmentParentage=e.segmentParentage,e.end=i,e.equalEdge&&(e.equalEdge.equalEdge=null),e.equalEdge=null}updateSegmentOnly(e,s){e.segmentIndex=s}updateAttachedEdgesAfterNodeChange(e){for(let s=e.equalListHead();s!==null;s=s.nextEqual)this.updateAttachedEdgesAfterNodeChangeImpl(s)}updateAttachedEdgesAfterNodeChangeImpl(e){const s=e.prevInChain;if(s&&s.hasSegment()){const r=this.getSegment(s).get();e.pt.equals(r.getEndXY())||(r.setCoordsForIntersector(s.start.pt,s.end.pt,!1),r.ensureXYMonotone())}const i=e.nextInChain;if(i&&i.hasSegment()){const r=this.getSegment(i).get();e.pt.equals(r.getStartXY())||(r.setCoordsForIntersector(i.start.pt,i.end.pt,!1),r.ensureXYMonotone())}}updateSegmentToNodes(e){const s=this.getSegment(e).get();e.start.pt.equals(s.getStartXY())&&e.end.pt.equals(s.getEndXY())||(s.setCoordsForIntersector(e.start.pt,e.end.pt,!1),s.ensureXYMonotone()),this.updateAttachedEdgesAfterNodeChange(e.start),this.updateAttachedEdgesAfterNodeChange(e.end)}getSegment(e){return this.parent.m_resultSegments[e.segmentIndex]}clusterNodes(e){let s=!1;const i=[],r=[],n=[];for(let o=0,a=this.m_newNodes.length;o<a;o++){const l=this.m_newNodes[o];if(l===null)continue;let u=l;for(let c=o+1;c<a;c++){const h=this.m_newNodes[c];h!==null&&l.pt.equals(h.pt)&&(u.nextInHash=h,h.prevInHash=u,u=h,this.m_newNodes[c]=null)}}for(let o=0,a=this.m_newNodes.length;o<a;o++){const l=this.m_newNodes[o];if(l==null)continue;for(l.hash=this.calculateHash(l.pt);;){const f=fE(4),g=this.hashTableBinsToCheck(l,f);for(let b=0;b<g;b++)if(f[b]!==null)for(let w=f[b];w!==null;){const S=w.nextInHash;M.distance(l.pt,w.pt)<=e&&(i.push(w),this.removeNodeFromHash(w),w.hash=0,n.push(w),r.push(w)),w=S}let v=!1;for(const b of i)if(!l.pt.equals(b.pt)){const w=uve(l.pt,b.pt,l.weight,l.rank,b.weight,b.rank);l.pt.assign(w.pt),l.weight=w.weight,l.rank=w.rank,v=!0,s=!0}if(i.length=0,!v)break;l.hash=this.calculateHash(l.pt)}n.push(l),r.push(l);for(let f=l.nextInHash;f!==null;){f.prevInHash=null;const g=f.nextInHash;f.nextInHash=null,n.push(f),r.push(f),f=g}const u=l.hash;let c=null,h=null;for(const f of r)l!==f&&(f.hash=u,f.pt.assign(l.pt),f.rank=l.rank,f.weight=l.weight),f.prevInHash=c,c&&(c.nextInHash=f),f.prevEqual=h,f.nextEqual=null,h&&(h.nextEqual=f),h=f,c=f;const m=u%this.m_hashTableOfEquals.length;c.nextInHash=this.m_hashTableOfEquals[m],this.m_hashTableOfEquals[m]!==null&&(this.m_hashTableOfEquals[m].prevInHash=c),this.m_hashTableOfEquals[m]=r[0],this.m_hashTableOfEqualsSize+=r.length,r.length=0,this.rehashIfNeeded()}if(this.m_newNodes.length=0,s)for(const o of n)this.updateAttachedEdgesAfterNodeChange(o)}rehashIfNeeded(){if(2*this.m_hashTableOfEqualsSize>this.m_hashTableOfEquals.length){const e=this.m_hashTableOfEquals;this.m_hashTableOfEquals=fE(2*e.length),this.m_hashTableOfEqualsSize=0;for(const s of e){let i=s;for(;i;){const r=i.nextInHash;i.nextInHash=null,i.prevInHash=null,this.addNodeToHashImpl(i),i=r}}}}addNodeToHashImpl(e){const s=e.hash%this.m_hashTableOfEquals.length,i=this.m_hashTableOfEquals[s];e.nextInHash=i,i!==null&&(i.prevInHash=e),this.m_hashTableOfEquals[s]=e,this.m_hashTableOfEqualsSize++}removeNodeFromHash(e){const s=e.hash%this.m_hashTableOfEquals.length,i=e.prevInHash,r=e.nextInHash;i?i.nextInHash=r:this.m_hashTableOfEquals[s]=r,r&&(r.prevInHash=i),this.m_hashTableOfEqualsSize--,e.prevInHash=null,e.nextInHash=null}hashTableBinsToCheck(e,s){const i=(e.pt.x-this.m_origin.x)/this.m_cell.x,r=(e.pt.y-this.m_origin.y)/this.m_cell.y,n=Qr()-1,o=Math.round(ys(i,-2147483646,n)),a=Math.round(ys(r,-2147483646,n));let l=o|a<<32;l=kc(l),s[0]=this.m_hashTableOfEquals[l%this.m_hashTableOfEquals.length];let u=o+1|a<<32;u=kc(u);let c=1;s[1]=this.m_hashTableOfEquals[u%this.m_hashTableOfEquals.length],s[1]!==s[0]&&(c=2);let h=o+1|a+1<<32;h=kc(h),s[c]=this.m_hashTableOfEquals[h%this.m_hashTableOfEquals.length];for(let f=0;f<c;f++)if(s[c]===s[f]){c--;break}c++;let m=o|a+1<<32;m=kc(m),s[c]=this.m_hashTableOfEquals[m%this.m_hashTableOfEquals.length];for(let f=0;f<c;f++)if(s[c]===s[f]){c--;break}return c++,c}calculateHash(e){const s=(e.x-this.m_origin.x)/this.m_cell.x,i=(e.y-this.m_origin.y)/this.m_cell.y,r=Qr()-1;let n=Math.round(ys(s,-2147483646,r))|Math.round(ys(i,-2147483646,r))<<32;return n=kc(n),n===0&&(n=1),n}processSharpCorners(e,s,i,r){if(this.parent.m_param1.length=0,this.parent.m_param2.length=0,e.getStartXY().equals(s.getStartXY())){const n=[0,0],o=[0,0],a=pM(e,s,0,0,i,2,n,o,r);if(a){this.parent.m_param1.push(0),this.parent.m_param2.push(0);for(let l=0;l<a;l++)this.parent.m_param1.push(n[l]),this.parent.m_param2.push(o[l]);return a+1}}if(e.getEndXY().equals(s.getEndXY())){const n=[0,0],o=[0,0],a=pM(e,s,1,1,i,2,n,o,r);if(a){for(let l=0;l<a;l++)this.parent.m_param1.push(n[l]),this.parent.m_param2.push(o[l]);return this.parent.m_param1.push(1),this.parent.m_param2.push(1),a+1}}if(e.getStartXY().equals(s.getEndXY())){const n=[0,0],o=[0,0],a=pM(e,s,0,1,i,2,n,o,r);if(a){this.parent.m_param1.push(0),this.parent.m_param2.push(1);for(let l=0;l<a;l++)this.parent.m_param1.push(n[l]),this.parent.m_param2.push(o[l]);return a+1}}if(e.getEndXY().equals(s.getStartXY())){const n=[0,0],o=[0,0],a=pM(e,s,1,0,i,2,n,o,r);if(a){for(let l=0;l<a;l++)this.parent.m_param1.push(n[l]),this.parent.m_param2.push(o[l]);return this.parent.m_param1.push(1),this.parent.m_param2.push(0),a+1}}return 0}}function N1(t,e,s){let i=0;switch(t){case G.enumLine:i=0;break;case G.enumBezier:i=2;break;case G.enumRationalBezier2:i=3;break;case G.enumBezier2:i=1;break;case G.enumEllipticArc:i=e.projectionBehavior()===0?5:4;break;default:Ce("")}return s?5-i:i}class Zst extends ove{constructor(e){super(e.m_shape,e.m_tolerance,!1),this.m_parent=e}compare(e,s,i){if(this.m_bIntersectionDetected)return-1;const r=e.getElement(i),n=this.m_parent.getEdgeOriginVertices(s),o=this.m_parent.m_edgeVertices.getFirstElement(n),a=this.m_parent.getEdgeOriginVertices(r),l=this.m_parent.m_edgeVertices.getFirstElement(a);return this.m_currentNode=i,this.compareSegments(s,o,r,l)}}class Qst extends ave{constructor(e){super(e.m_shape,e.m_tolerance),this.m_parent=e}compare(e,s){if(this.m_bIntersectionDetected)return-1;const i=e.getElement(s),r=this.m_parent.getEdgeOriginVertices(i),n=this.m_parent.m_edgeVertices.getFirstElement(r);return this.m_currentNode=s,this.compareVertex(e,s,n)}}class Jst extends E0{constructor(e){super(),this.pt1=M.getNAN(),this.pt2=M.getNAN(),this.m_shape=e}compare(e,s,i){this.m_shape.queryXY(s,this.pt1);const r=e.getElement(i);return this.m_shape.queryXY(r,this.pt2),this.pt1.compare(this.pt2)}}class Kst{constructor(e){this.m_point=M.getNAN(),this.m_pt=M.getNAN(),this.m_shape=e}setPoint(e){this.m_point.setCoordsPoint2D(e)}compare(e,s){const i=e.getElement(s);return this.m_shape.queryXY(i,this.m_pt),this.m_point.compare(this.m_pt)}}class AG{constructor(e,s){this.m_shape=null,this.m_progressTracker=null,this.m_edges=new et(8),this.m_clusters=new et(5),this.m_clusterVertices=new ds(!1),this.m_edgeVertices=new ds(!1),this.m_helperPoint=new nt,this.m_eventQ=new Xe,this.m_sweepStructure=new Xe,this.m_bComplications=!1,this.m_sweepComparator=null,this.m_tempEdgeBuffer=[],this.m_modifiedClusters=[],this.m_edgesToInsertInSweepStructure=[],this.m_prevNeighbour=-1,this.m_nextNeighbour=-1,this.m_bContinuingSegmentChainOptimization=!1,this.m_progressCounter=0,this.m_segmentIntersector=new ha,this.m_segBuf1=new ut,this.m_segBuf2=new ut,this.m_sweepPoint=new M(0,0),this.m_tolerance=0,this.m_toleranceSqr=0,this.m_sweepPointCluster=-1,this.m_vertexClusterIndex=-1,this.m_bCracked=!1,this.m_bSweepPointClusterWasModified=!1,this.m_progressTracker=e,this.m_bTrackChanges=s}hadComplications(){return this.m_bComplications}sweep(e,s){const i=new Rt;i.setSwapCoordinates(),e.applyTransformation(i),this.setEditShape_(e),this.m_bCracked=!1,this.m_tolerance=s,this.m_toleranceSqr=s*s;let r=this.sweepImpl_();return e.applyTransformation(i),r||(this.fillEventQueuePass2(),r=this.sweepImpl_()||r),this.m_shape.removeUserIndex(this.m_vertexClusterIndex),this.m_shape=null,this.m_bCracked}sweepVertical(e,s){this.setEditShape_(e),this.m_bCracked=!1,this.m_tolerance=s,this.m_toleranceSqr=s*s,this.m_bComplications=!1;let i=this.sweepImpl_();if(!this.m_bComplications){const r=e.filterClosePoints(s,!0,!1,this.m_bTrackChanges,L);this.m_bComplications=r===1,i||(i=r===1)}return this.m_vertexClusterIndex!==-1&&(this.m_shape.removeUserIndex(this.m_vertexClusterIndex),this.m_vertexClusterIndex=-1),this.m_shape=null,i}getEdgeCluster(e,s){return this.m_edges.getField(e,0+s)}setEdgeCluster_(e,s,i){this.m_edges.setField(e,0+s,i)}getEdgeOriginVertices(e){return this.m_edges.getField(e,2)}setEdgeOriginVertices_(e,s){this.m_edges.setField(e,2,s)}getNextEdgeEx(e,s){return this.m_edges.getField(e,3+s)}setNextEdgeEx_(e,s,i){this.m_edges.setField(e,3+s,i)}getEdgeSweepNode(e){return this.m_edges.getField(e,7)}setEdgeSweepNode_(e,s){this.m_edges.setField(e,7,s)}getNextEdge(e,s){const i=this.getEdgeEnd(e,s);return this.m_edges.getField(e,3+i)}setNextEdge_(e,s,i){const r=this.getEdgeEnd(e,s);this.m_edges.setField(e,3+r,i)}getPrevEdge(e,s){const i=this.getEdgeEnd(e,s);return this.m_edges.getField(e,5+i)}setPrevEdge_(e,s,i){const r=this.getEdgeEnd(e,s);this.m_edges.setField(e,5+r,i)}getClusterVertices(e){return this.m_clusters.getField(e,0)}setClusterVertices_(e,s){this.m_clusters.setField(e,0,s)}getClusterSweepEdgeList(e){return this.m_clusters.getField(e,2)}setClusterSweepEdgeList_(e,s){this.m_clusters.setField(e,2,s)}getClusterFirstEdge(e){return this.m_clusters.getField(e,1)}setClusterFirstEdge_(e,s){this.m_clusters.setField(e,1,s)}getClusterEventQNode(e){return this.m_clusters.getField(e,3)}setClusterEventQNode_(e,s){this.m_clusters.setField(e,3,s)}newCluster_(e){const s=this.m_clusters.newElement(),i=this.m_clusterVertices.createList();return this.setClusterVertices_(s,i),e!==L&&(this.m_clusterVertices.addElement(i,e),this.m_shape.setUserIndex(e,this.m_vertexClusterIndex,s)),s}deleteCluster_(e){this.m_clusters.deleteElement(e)}addVertexToCluster_(e,s){const i=this.getClusterVertices(e);this.m_clusterVertices.addElement(i,s),this.m_shape.setUserIndex(s,this.m_vertexClusterIndex,e)}newEdge_(e){const s=this.m_edges.newElement(),i=this.m_edgeVertices.createList();return this.setEdgeOriginVertices_(s,i),e!==-1&&this.m_edgeVertices.addElement(i,e),s}addVertexToEdge_(e,s){const i=this.getEdgeOriginVertices(e);this.m_edgeVertices.addElement(i,s)}deleteEdge_(e){this.m_edges.deleteElement(e);const s=this.m_edgesToInsertInSweepStructure.findIndex(i=>i===e);s>=0&&_Je(this.m_edgesToInsertInSweepStructure,s)}addEdgeToCluster(e,s){this.getEdgeCluster(e,0)===-1?this.setEdgeCluster_(e,0,s):this.getEdgeCluster(e,1)===-1?this.setEdgeCluster_(e,1,s):Ce(""),this.addEdgeToClusterImpl_(e,s)}addEdgeToClusterImpl_(e,s){const i=this.getClusterFirstEdge(s);if(i!==-1){const r=this.getNextEdge(i,s);this.setPrevEdge_(r,s,e),this.setNextEdge_(e,s,r),this.setNextEdge_(i,s,e),this.setPrevEdge_(e,s,i)}else this.setPrevEdge_(e,s,e),this.setNextEdge_(e,s,e),this.setClusterFirstEdge_(s,e)}getEdgeEnd(e,s){return this.getEdgeCluster(e,0)===s?0:1}mergeClusters_(e,s){this.dbgCheckCluster_(e),this.dbgCheckCluster_(s);const i=this.getClusterEventQNode(s);i!==-1&&(this.m_eventQ.deleteNode(i),this.setClusterEventQNode_(s,-1));let r=this.getClusterFirstEdge(e),n=this.getClusterFirstEdge(s);if(n!==-1){let l=n,u=n,c=!1;do{this.dbgCheckEdge_(l),c=!1;const h=this.getEdgeEnd(l,s),m=this.getNextEdgeEx(l,h);if(this.getEdgeCluster(l,h+1&1)===e){this.disconnectEdge_(l);const f=this.getEdgeOriginVertices(l);if(this.m_edgeVertices.deleteList(f),this.deleteEdge_(l),l===m){n=-1;break}n===l&&(n=this.getClusterFirstEdge(s),u=m,c=!0)}l=m}while(l!==u||c);if(n!==-1){do{const h=this.getEdgeEnd(l,s),m=this.getNextEdgeEx(l,h);this.setEdgeCluster_(l,h,e),l=m}while(l!==u);if(r=this.getClusterFirstEdge(e),r!==-1){const h=this.getNextEdge(r,e),m=this.getNextEdge(n,e);h===r?(this.setClusterFirstEdge_(e,n),this.addEdgeToClusterImpl_(r,e),this.setClusterFirstEdge_(e,r)):m===n&&this.addEdgeToClusterImpl_(n,e),this.setNextEdge_(n,e,h),this.setPrevEdge_(h,e,n),this.setNextEdge_(r,e,m),this.setPrevEdge_(m,e,r)}else this.setClusterFirstEdge_(e,n)}}const o=this.getClusterVertices(e),a=this.getClusterVertices(s);for(let l=this.m_clusterVertices.getFirst(a);l!==-1;l=this.m_clusterVertices.getNext(l)){const u=this.m_clusterVertices.getElement(l);this.m_shape.setUserIndex(u,this.m_vertexClusterIndex,e)}this.m_clusterVertices.concatenateLists(o,a),this.deleteCluster_(s),this.dbgCheckCluster_(e)}mergeEdges_(e,s){this.dbgCheckEdge_(e),this.dbgCheckEdge_(s);const i=this.getEdgeCluster(e,0),r=this.getEdgeCluster(e,1),n=this.getEdgeCluster(s,0),o=this.getEdgeCluster(s,1),a=this.getEdgeOriginVertices(e),l=this.getEdgeOriginVertices(s);if(this.m_edgeVertices.concatenateLists(a,l),s===this.getClusterFirstEdge(i)&&this.setClusterFirstEdge_(i,e),s===this.getClusterFirstEdge(r)&&this.setClusterFirstEdge_(r,e),this.disconnectEdge_(s),this.deleteEdge_(s),!(i===n&&r===o||r===n&&i===o)){const u=this.getClusterXY(i),c=this.getClusterXY(n);u.isEqualPoint2D(c)?(i!==n&&this.mergeClusters_(i,n),r!==o&&this.mergeClusters_(r,o)):(r!==n&&this.mergeClusters_(r,n),i!==o&&this.mergeClusters_(i,o))}this.dbgCheckEdge_(e)}disconnectEdge_(e){const s=this.getEdgeCluster(e,0),i=this.getEdgeCluster(e,1);this.disconnectEdgeFromCluster_(e,s),this.disconnectEdgeFromCluster_(e,i)}disconnectEdgeFromCluster_(e,s){const i=this.getNextEdge(e,s),r=this.getPrevEdge(e,s),n=this.getClusterFirstEdge(s);i!==e?(this.setNextEdge_(r,s,i),this.setPrevEdge_(i,s,r),n===e&&this.setClusterFirstEdge_(s,i)):this.setClusterFirstEdge_(s,-1)}applyIntersectorToEditShape_(e,s,i){let r=this.m_edgeVertices.getFirst(e);const n=this.m_edgeVertices.getElement(r),o=this.getClusterFromVertex(n),a=this.m_shape.getNextVertex(n),l=this.getClusterFromVertex(a),u=this.m_shape.getXY(n),c=this.m_shape.getXY(a);let h=!1,m=!1;const f=s.getResultSegment(i,0).getStartXY(),g=s.getResultSegment(i,s.getResultSegmentCount(i)-1).getEndXY();u.equals(f)||(h=!0),c.equals(g)||(m=!0),this.m_shape.splitSegmentWithIntersector(n,s,i,!0,!0);const v=this.m_bTrackChanges&&s.getSegmentChanged(i);for(v&&this.m_shape.setGeometryModifiedWithVertex(n,!0),r=this.m_edgeVertices.getNext(r);r!==-1;r=this.m_edgeVertices.getNext(r)){const b=this.m_edgeVertices.getElement(r),w=this.getClusterFromVertex(b)===o;this.m_shape.splitSegmentWithIntersector(b,s,i,w,!0),v&&this.m_shape.setGeometryModifiedWithVertex(b,!0)}if(h&&this.updateClusterXY(!0,o,f,s.getResultSegmentStartPointWeight(i,0),s.getResultSegmentStartPointRank(i,0)),m){const b=s.getResultSegmentCount(i)-1;this.updateClusterXY(!0,l,g,s.getResultSegmentEndPointWeight(i,b),s.getResultSegmentEndPointRank(i,b))}}createEdgesAndClustersFromSplitEdge_(e,s,i){this.dbgCheckNewEdgesArray_();const r=this.getEdgeOriginVertices(e),n=this.getEdgeCluster(e,0),o=this.getEdgeCluster(e,1);let a=this.newEdge_(-1);this.m_edgesToInsertInSweepStructure.push(a);const l=et.impossibleIndex3();this.setEdgeSweepNode_(a,l),this.m_tempEdgeBuffer.push(a),this.addEdgeToCluster(a,n);const u=s.getResultSegmentCount(i);for(let c=1;c<u;c++){const h=this.newCluster_(-1);this.m_modifiedClusters.push(h),this.m_tempEdgeBuffer.push(h),this.addEdgeToCluster(a,h);const m=this.newEdge_(-1);this.m_edgesToInsertInSweepStructure.push(m),this.setEdgeSweepNode_(m,l),this.m_tempEdgeBuffer.push(m),this.addEdgeToCluster(m,h),a=m}this.addEdgeToCluster(a,o);for(let c=this.m_edgeVertices.getFirst(r);c!==-1;c=this.m_edgeVertices.getNext(c)){let h=this.m_edgeVertices.getElement(c);if(this.getClusterFromVertex(h)===n){let m=0;const f=this.m_tempEdgeBuffer.length;do{if(m>0){const v=this.m_tempEdgeBuffer[m-1];this.addVertexToCluster_(v,h)}const g=this.m_tempEdgeBuffer[m];m+=2,this.addVertexToEdge_(g,h),h=this.m_shape.getNextVertex(h)}while(m<f)}else{let m=this.m_tempEdgeBuffer.length-1;do{if(m<this.m_tempEdgeBuffer.length-2){const g=this.m_tempEdgeBuffer[m+1];this.addVertexToCluster_(g,h)}const f=this.m_tempEdgeBuffer[m];m-=2,this.addVertexToEdge_(f,h),h=this.m_shape.getNextVertex(h)}while(m>=0)}}this.m_tempEdgeBuffer.length=0,this.dbgCheckNewEdgesArray_()}getVertexFromClusterIndex(e){const s=this.getClusterVertices(e);return this.m_clusterVertices.getFirstElement(s)}getClusterFromVertex(e){return this.m_shape.getUserIndex(e,this.m_vertexClusterIndex)}processSplitHelper1_(e,s,i){const r=this.getEdgeCluster(s,0),n=this.getClusterXY(r),o=this.getEdgeCluster(s,1),a=this.getClusterXY(o),l=i.getResultSegmentCount(e);let u=i.getResultSegment(e,0);const c=u.getStartXY();if(n.isEqualPoint2D(c)||(this.m_bComplications||n.compare(this.m_sweepPoint)*c.compare(this.m_sweepPoint)<0&&(this.m_bComplications=!0),this.getAffectedEdges(r,this.m_tempEdgeBuffer),this.m_modifiedClusters.push(r)),!this.m_bComplications&&l>1){const m=n.compare(a),f=u.getEndXY();(n.compare(f)!==m||f.compare(a)!==m||f.compare(this.m_sweepPoint)<0)&&(this.m_bComplications=!0)}u=i.getResultSegment(e,l-1);const h=u.getEndXY();a.isEqualPoint2D(h)||(this.m_bComplications||a.compare(this.m_sweepPoint)*h.compare(this.m_sweepPoint)<0&&(this.m_bComplications=!0),this.getAffectedEdges(o,this.m_tempEdgeBuffer),this.m_modifiedClusters.push(o)),this.m_tempEdgeBuffer.push(s);for(let m=0,f=this.m_tempEdgeBuffer.length;m<f;m++){const g=this.m_tempEdgeBuffer[m],v=this.getEdgeSweepNode(g);et.isValidElement(v)&&(this.m_sweepStructure.deleteNode(v),this.setEdgeSweepNode_(g,-1));const b=et.impossibleIndex3();g!==s&&this.getEdgeSweepNode(g)!==b&&(this.m_edgesToInsertInSweepStructure.push(g),this.setEdgeSweepNode_(g,b))}this.m_tempEdgeBuffer.length=0}checkAndFixIntersection_(e,s){const i=this.m_sweepStructure.getElement(e);return this.m_sweepComparator.compare(this.m_sweepStructure,i,s),!!this.m_sweepComparator.intersectionDetected()&&(this.m_sweepComparator.clearIntersectionDetectedFlag(),this.fixIntersection_(e,s),!0)}fixIntersection_(e,s){this.m_bCracked=!0;const i=this.m_sweepStructure.getElement(e),r=this.m_sweepStructure.getElement(s);let n=null,o=null;const a=this.getEdgeOriginVertices(i),l=this.m_edgeVertices.getFirstElement(a),u=this.getEdgeOriginVertices(r),c=this.m_edgeVertices.getFirstElement(u),h=this.m_shape.querySegment(l,this.m_segBuf1,!1,!1);F(h),n=this.m_segBuf1.get();const m=this.m_shape.getNextVertex(l),f=this.m_shape.getWeight(l),g=this.m_shape.getSegmentParentageBreakVertex(l),v=this.m_shape.getWeight(m),b=this.m_shape.getSegmentParentageBreakVertex(m),w=this.m_shape.getSegmentWeight(l),S=this.m_shape.getRank(l),T=this.m_shape.getRank(m),P=this.m_shape.getSegmentRank(l),I=this.m_shape.getSegmentParentage(l),A=this.m_shape.querySegment(c,this.m_segBuf2,!1,!1);F(A),o=this.m_segBuf2.get();const D=this.m_shape.getNextVertex(c),k=this.m_shape.getWeight(c),R=this.m_shape.getSegmentParentageBreakVertex(c),O=this.m_shape.getWeight(D),z=this.m_shape.getSegmentParentageBreakVertex(D),q=this.m_shape.getSegmentWeight(c),U=this.m_shape.getRank(c),V=this.m_shape.getRank(D),B=this.m_shape.getSegmentRank(c),H=this.m_shape.getSegmentParentage(c);this.m_segmentIntersector.pushSegment(n,f,S,v,T,w,P,g,b,I),this.m_segmentIntersector.pushSegment(o,k,U,O,V,q,B,R,z,H),this.m_segmentIntersector.intersect2D(this.m_tolerance,!0)===3&&(this.m_bComplications=!0),this.splitEdge_(i,r,-1,this.m_segmentIntersector),this.m_segmentIntersector.clear()}fixIntersectionPointSegment_(e,s){this.m_bCracked=!0;const i=this.m_sweepStructure.getElement(s);let r=null;const n=this.getEdgeOriginVertices(i),o=this.m_edgeVertices.getFirstElement(n),a=this.m_shape.querySegment(o,this.m_segBuf1,!1,!1);F(a),r=this.m_segBuf1.get();const l=this.m_shape.getNextVertex(o),u=this.m_shape.getWeight(o),c=this.m_shape.getSegmentParentageBreakVertex(o),h=this.m_shape.getWeight(l),m=this.m_shape.getSegmentParentageBreakVertex(l),f=this.m_shape.getSegmentWeight(o),g=this.m_shape.getRank(o),v=this.m_shape.getRank(l),b=this.m_shape.getSegmentRank(o),w=this.m_shape.getSegmentParentage(o),S=this.getClusterFirstVertex(e);this.m_segmentIntersector.pushSegment(r,u,g,h,v,f,b,c,m,w),this.m_shape.queryPoint(S,this.m_helperPoint);const T=this.m_shape.getWeight(S),P=this.m_shape.getRank(S);this.m_segmentIntersector.intersect2DEx(this.m_tolerance,this.m_helperPoint,P,T,!0),this.splitEdge_(i,-1,e,this.m_segmentIntersector),this.m_segmentIntersector.clear()}insertNewEdges_(){if(this.m_edgesToInsertInSweepStructure.length===0)return!0;this.dbgCheckNewEdgesArray_();let e=!0,s=0;const i=this.m_edgesToInsertInSweepStructure.length,r=Math.max(2*i+200,this.m_sweepStructure.size()+200);for(;this.m_edgesToInsertInSweepStructure.length;){if(this.m_edgesToInsertInSweepStructure.length>Math.max(100,this.m_shape.getTotalPointCount())||s>r){this.m_edgesToInsertInSweepStructure.length=0,this.m_bComplications=!0,e=!1;break}const n=this.m_edgesToInsertInSweepStructure.at(-1);this.m_edgesToInsertInSweepStructure.pop(),this.setEdgeSweepNode_(n,-1);const o=this.isEdgeOnSweepLine_(n);et.isValidElement(o)?(this.insertNewEdgeToSweepStructure_(n,o),s++):o!==et.impossibleIndex2()&&(e=!1),this.m_bContinuingSegmentChainOptimization=!1}return e}insertNewEdgeToSweepStructure_(e,s){let i;if(this.m_bContinuingSegmentChainOptimization?(i=this.m_sweepStructure.addElementAtPosition(this.m_prevNeighbour,this.m_nextNeighbour,e,!0,!0),this.m_bContinuingSegmentChainOptimization=!1):i=this.m_sweepStructure.addUniqueElement(e),i===-1){const r=this.m_sweepStructure.getDuplicateElement(),n=this.m_sweepStructure.getElement(r);return this.mergeEdges_(n,e),!1}if(this.setEdgeSweepNode_(e,i),this.m_sweepComparator.intersectionDetected()){this.m_sweepComparator.clearIntersectionDetectedFlag();const r=this.m_sweepComparator.getLastComparedNode();return this.m_prevNeighbour===r&&(this.m_prevNeighbour=-1),this.m_nextNeighbour===r&&(this.m_nextNeighbour=-1),this.fixIntersection_(r,i),!0}return!1}isEdgeOnSweepLine_(e){const s=this.getEdgeCluster(e,0),i=this.getEdgeCluster(e,1),r=this.getClusterXY(s),n=this.getClusterXY(i);if(M.sqrDistance(r,n)<=this.m_toleranceSqr)return this.m_bComplications=!0,-1;const o=r.compare(this.m_sweepPoint),a=n.compare(this.m_sweepPoint);return o<=0&&a>0?i:a<=0&&o>0?s:o>0&&a>0?et.impossibleIndex2():-1}fillEventQueue(){const e=new Qs(0),s=this.m_shape.queryVertexIteratorOnSelection();for(let n=s.next();n!==L;n=s.next())this.m_shape.getUserIndex(n,this.m_vertexClusterIndex)!==-1&&e.add(n);this.m_shape.sortVerticesSimpleByY(e,0,e.size()),this.progress_(!0),this.m_eventQ.clear(),this.m_eventQ.setCapacity(e.size()),this.m_eventQ.setComparator(new Jst(this.m_shape));const i=M.getNAN();i.setNAN();let r=-1;for(let n=0,o=e.size();n<o;n++){const a=e.read(n);if(this.m_shape.getXY(a).isEqualPoint2D(i)){const u=this.m_shape.getUserIndex(a,this.m_vertexClusterIndex);this.mergeClusters_(r,u);continue}r=this.getClusterFromVertex(a),this.m_shape.queryXY(a,i);const l=this.m_eventQ.addBiggestElement(a);this.setClusterEventQNode_(r,l)}}fillEventQueuePass2(){const e=new Qs(0);for(let s=this.m_eventQ.getFirst();s!==-1;s=this.m_eventQ.getNext(s)){const i=this.m_eventQ.getElement(s);e.add(i)}this.m_eventQ.clear(),this.m_shape.sortVerticesSimpleByY(e,0,e.size()),this.progress_(!0);for(let s=0,i=e.size();s<i;s++){const r=e.read(s),n=this.getClusterFromVertex(r),o=this.m_eventQ.addBiggestElement(r);this.setClusterEventQNode_(n,o)}}getAffectedEdges(e,s){const i=this.getClusterFirstEdge(e);if(i===-1)return;let r=i;do{const n=this.getEdgeSweepNode(r);et.isValidElement(n)&&s.push(r),r=this.getNextEdge(r,e)}while(r!==i)}updateClusterXY(e,s,i,r,n){const o=this.getClusterVertices(s);for(let a=this.m_clusterVertices.getFirst(o);a!==-1;a=this.m_clusterVertices.getNext(a)){const l=this.m_clusterVertices.getElement(a);this.m_shape.setXYMonotonicPoint2D(l,i),this.m_shape.setWeight(l,r),this.m_shape.setRank(l,n),e&&this.m_bTrackChanges&&this.m_shape.setGeometryModifiedWithVertex(l,!0),this.m_shape.setSegmentParentageBreakVertex(l,!0)}}splitEdge_(e,s,i,r){this.dbgCheckEdge_(e),s!==-1&&this.dbgCheckEdge_(s),this.disconnectEdge_(e),s!==-1&&this.disconnectEdge_(s),this.processSplitHelper1_(0,e,r),s!==-1&&this.processSplitHelper1_(1,s,r),i!==-1&&r.getResultPointChanged()&&this.m_modifiedClusters.push(i);for(let a=0,l=this.m_modifiedClusters.length;a<l;a++){const u=this.m_modifiedClusters[a],c=this.getClusterEventQNode(u);c!==-1&&(this.m_eventQ.deleteNode(c),this.setClusterEventQNode_(u,-1))}const n=this.getEdgeOriginVertices(e),o=s!==-1?this.getEdgeOriginVertices(s):-1;if(this.applyIntersectorToEditShape_(n,r,0),o!==-1)this.applyIntersectorToEditShape_(o,r,1);else{const a=r.getResultPoint().getXY();this.updateClusterXY(r.getResultPointChanged(),i,a,r.getResultPointWeight(),r.getResultPointRank())}this.createEdgesAndClustersFromSplitEdge_(e,r,0),s!==-1&&this.createEdgesAndClustersFromSplitEdge_(s,r,1),this.m_edgeVertices.deleteList(n),this.deleteEdge_(e),s!==-1&&(this.m_edgeVertices.deleteList(o),this.deleteEdge_(s));for(let a=0,l=this.m_modifiedClusters.length;a<l;a++){const u=this.m_modifiedClusters[a];u===this.m_sweepPointCluster&&(this.m_bSweepPointClusterWasModified=!0);let c=this.getClusterEventQNode(u);if(c===-1){const h=this.getClusterFirstVertex(u);if(c=this.m_eventQ.addUniqueElement(h),c===-1){const m=this.m_eventQ.getDuplicateElement(),f=this.m_eventQ.getElement(m),g=this.getClusterFromVertex(f);this.mergeClusters_(g,u)}else this.setClusterEventQNode_(u,c)}}this.m_modifiedClusters.length=0}getClusterXY(e){const s=this.getClusterFirstVertex(e);return this.m_shape.getXY(s)}getClusterFirstVertex(e){const s=this.getClusterVertices(e);return this.m_clusterVertices.getFirstElement(s)}dbgCheckEdge_(e){}dbgCheckCluster_(e){}dbgCheckNewEdgesArray_(){}dbgSaveSweepStructure_(e){}sweepImpl_(){this.progress_(!0),this.m_bSweepPointClusterWasModified=!1,this.m_sweepPointCluster=-1,this.m_sweepComparator===null&&(this.m_sweepStructure.disableBalancing(),this.m_sweepComparator=new Zst(this),this.m_sweepStructure.setComparator(this.m_sweepComparator));const e=[];let s=null,i=null;this.m_prevNeighbour=-1,this.m_nextNeighbour=-1,this.m_bContinuingSegmentChainOptimization=!1;const r=et.impossibleIndex2(),n=et.impossibleIndex3();for(let o=this.m_eventQ.getFirst();o!==-1;){this.progress_(),this.dbgCheckSweepStructure_(),this.m_bContinuingSegmentChainOptimization=!1,this.m_prevNeighbour=-1,this.m_nextNeighbour=-1;const a=this.m_eventQ.getElement(o);this.m_sweepPointCluster=this.getClusterFromVertex(a),this.m_shape.queryXY(a,this.m_sweepPoint),this.m_sweepComparator.setSweepY(this.m_sweepPoint.y,this.m_sweepPoint.x);let l=!1;{const c=this.getClusterFirstEdge(this.m_sweepPointCluster);if(l=c===-1,!l){let h=c;do{const m=this.getEdgeSweepNode(h);m===-1?(this.m_edgesToInsertInSweepStructure.push(h),this.setEdgeSweepNode_(h,n)):m!==n&&e.push(m),h=this.getNextEdge(h,this.m_sweepPointCluster)}while(h!==c)}}if(!this.m_sweepStructure.isAutoBalancing()&&(this.m_sweepStructure.getMaxDepthEver()>4||this.m_edgesToInsertInSweepStructure.length>10)&&this.m_sweepStructure.enableBalancing(),e.length>0){this.m_bContinuingSegmentChainOptimization=e.length===1&&this.m_edgesToInsertInSweepStructure.length===1;for(let m=0,f=e.length;m<f;m++){const g=this.m_sweepStructure.getElement(e[m]);this.setEdgeSweepNode_(g,r)}let c=r,h=r;for(let m=0,f=e.length;m<f;m++){const g=e[m];if(c===r){const v=this.m_sweepStructure.getPrev(g);if(v!==-1){const b=this.m_sweepStructure.getElement(v);this.getEdgeSweepNode(b)!==r&&(c=v)}else c=-1}if(h===r){const v=this.m_sweepStructure.getNext(g);if(v!==-1){const b=this.m_sweepStructure.getElement(v);this.getEdgeSweepNode(b)!==r&&(h=v)}else h=-1}if(c!==r&&h!==r)break}for(let m=0,f=e.length;m<f;m++){const g=e[m],v=this.m_sweepStructure.getElement(g);this.m_sweepStructure.deleteNode(g),this.setEdgeSweepNode_(v,-1)}e.length=0,this.m_prevNeighbour=c,this.m_nextNeighbour=h,c!==-1&&h!==-1?this.m_bContinuingSegmentChainOptimization||this.checkAndFixIntersection_(c,h):c===-1&&h===-1&&(this.m_bContinuingSegmentChainOptimization=!1)}else l&&(s===null&&(s=new Qst(this)),s.setPoint(this.m_sweepPoint),this.m_sweepStructure.searchUpperBound(s),s.intersectionDetected()&&(s.clearIntersectionDetectedFlag(),this.fixIntersectionPointSegment_(this.m_sweepPointCluster,s.getCurrentNode())));const u=this.m_bContinuingSegmentChainOptimization;!this.insertNewEdges_()&&u&&this.m_prevNeighbour!==-1&&this.m_nextNeighbour!==-1&&this.checkAndFixIntersection_(this.m_prevNeighbour,this.m_nextNeighbour),this.m_bSweepPointClusterWasModified?(this.m_bSweepPointClusterWasModified=!1,i===null&&(i=new Kst(this.m_shape)),i.setPoint(this.m_sweepPoint),o=this.m_eventQ.searchUpperBound(i)):o=this.m_eventQ.getNext(o)}return this.m_bCracked}setEditShape_(e){this.m_shape=e,this.m_vertexClusterIndex=this.m_shape.createUserIndex(),this.m_edges.setCapacity(e.getSelectedCount()+32),this.m_clusters.setCapacity(e.getSelectedCount()),this.m_clusterVertices.reserveLists(e.getSelectedCount()),this.m_clusterVertices.reserveNodes(e.getSelectedCount()),this.m_edgeVertices.reserveLists(e.getSelectedCount()+32),this.m_edgeVertices.reserveNodes(e.getSelectedCount()+32);for(let s=this.m_shape.getFirstGeometry();s!==L;s=this.m_shape.getNextGeometry(s))if(xt(this.m_shape.getGeometryType(s)))for(let i=this.m_shape.getFirstPath(s);i!==L;i=this.m_shape.getNextPath(i)){const r=this.m_shape.getPathSize(i),n=this.m_shape.getFirstVertex(i);if(n===L)continue;let o=this.m_shape.getNextVertex(n);if(o===L||o===n)continue;let a=-1;e.selected(n)&&(a=this.newCluster_(n));let l=-1;a!==-1&&e.selected(o)&&(l=this.newEdge_(n),this.addEdgeToCluster(l,a));let u=l;for(let c=0,h=r-2;c<h;c++){const m=this.m_shape.getNextVertex(o);let f=-1;if(this.m_shape.selected(o)){const g=this.newCluster_(o);u!==-1&&this.addEdgeToCluster(u,g),this.m_shape.selected(m)&&(f=this.newEdge_(o),this.addEdgeToCluster(f,g))}u=f,o=m}if(this.m_shape.isClosedPath(i)){const c=this.m_shape.getNextVertex(o);if(this.m_shape.selected(o)){const h=this.newCluster_(o);if(u!==-1&&this.addEdgeToCluster(u,h),this.m_shape.selected(c)){const m=this.newEdge_(o);this.addEdgeToCluster(m,h),this.addEdgeToCluster(m,a)}}}else{let c=-1;this.m_shape.selected(o)&&(c=this.newCluster_(o),u!==-1&&this.addEdgeToCluster(u,c))}}else for(let i=this.m_shape.getFirstPath(s);i!==L;i=this.m_shape.getNextPath(i)){let r=this.m_shape.getFirstVertex(i);for(let n=0,o=this.m_shape.getPathSize(i);n<o;n++)this.m_shape.selected(r)&&this.newCluster_(r),r=this.m_shape.getNextVertex(r)}this.fillEventQueue()}progress_(e=!1){}dbgCheckSweepStructure_(){}}function eit(t,e,s,i){s>0&&lve(t,s,e,!1,i),new tit(i).executeImpl_(t,e)}function Rre(t,e,s){return{vertex0:t,vertex1:e,dir:s}}class tit{constructor(e){this.m_shape=null,this.m_spikes=[],this.m_points=new Qs(0),this.m_pointsIndex=-1,this.m_dissolvedEdges=0,this.m_progressTracker=e}executeImpl_(e,s){if(this.m_shape=e,e.getPathCount(s)<2&&e.getPointCount(s)<6)return;this.m_points.resize(0);for(let h=e.getFirstPath(s);h!==L;h=e.getNextPath(h)){let m=e.getFirstVertex(h);for(let f=0,g=e.getPathSize(h);f<g;f++,m=e.getNextVertex(m))this.m_points.add(m)}this.m_pointsIndex=e.createUserIndex();for(let h=0,m=this.m_points.size();h<m;++h)e.setUserIndex(this.m_points.read(h),this.m_pointsIndex,h);e.sortVerticesSimpleByY(this.m_points,0,this.m_points.size());let i=this.m_points.read(0);const r=e.getXY(i);let n=1,o=0;const a=[];for(let h=1;h<this.m_points.size();h++){const m=this.m_points.read(h);if(m===L||e.getUserIndex(m,this.m_pointsIndex)===-1)continue;const f=e.getXY(m);if(f.isEqualPoint2D(r))n++;else{if(n>1){for(let g=o;g<h;g++){const v=this.m_points.read(g);if(e.getUserIndex(v,this.m_pointsIndex)===-1)continue;const b=e.getNextVertex(v),w=e.getPrevVertex(v);if(v!==b&&!e.isEqualXYPoint2D(b,r)){const S=Rre(v,b,1);a.push(S)}if(v!==w&&w!==b&&!e.isEqualXYPoint2D(w,r)){const S=Rre(v,w,-1);a.push(S)}}a.length>0&&this.processBunch_(a,r)}i=m,r.assign(f),n=1,o=h}}if(this.m_dissolvedEdges===0)return e.removeUserIndex(this.m_pointsIndex),void(this.m_pointsIndex=-1);let l=e.getPointCount(s);for(let h=0;h<this.m_points.size();h++){const m=this.m_points.read(h);if(m===L)continue;if(e.getUserIndex(m,this.m_pointsIndex)!==-1){e.setUserIndex(m,this.m_pointsIndex,-1);continue}const f=e.getPathFromVertex(m);e.getFirstVertex(f)===m&&e.setFirstVertex(f,L),e.freeVertex(m),this.m_points.write(h,L),l--}const u=e.createPathUserIndex();let c=e.getPathCount(s);for(let h=0,m=this.m_points.size();h<m;++h){if(this.m_points.read(h)===L)continue;let f=this.m_points.read(h);if(e.getUserIndex(f,this.m_pointsIndex)!==-1)continue;let g=e.getPathFromVertex(f),v=-1;if(e.getPathUserIndex(g,u)===2){g=L;for(let T=e.getNextVertex(f);T!==f;T=e.getNextVertex(T)){const P=e.getPathFromVertex(T);if(e.getPathUserIndex(P,u)!==2){g=P,f=T;break}}g===L&&(g=e.insertPath(s,L),e.setClosedPath(g,!0),c++),F(g!==L)}e.setPathUserIndex(g,u,2),v=e.getFirstVertex(g);let b=0,w=!1,S=f;do{v===S&&(w=!0),e.setUserIndex(S,this.m_pointsIndex,1);const T=e.getPathFromVertex(S);T!==g&&(e.getPathUserIndex(T,u)!==2&&(e.setPathUserIndex(T,u,1),e.setFirstVertex(T,L)),e.setPathToVertex(S,g)),b++,S=e.getNextVertex(S)}while(S!==f);w||e.setFirstVertex(g,f),e.setPathSize(g,b)}for(let h=e.getFirstPath(s);h!==L;){const m=e.getNextPath(h);e.getPathUserIndex(h,u)!==1&&e.getFirstVertex(h)!==L||(e.removePathOnly(h),c--),h=m}e.setGeometryVertexCount(s,l),e.setGeometryPathCount(s,c),e.removePathUserIndex(u),e.removeUserIndex(this.m_pointsIndex),this.m_pointsIndex=-1,e.dbgVerifyVertexCounts(),e.filterClosePoints(0,!0,!1,!1,s)}processBunch_(e,s){e.sort((a,l)=>{const u=this.m_shape.getXY(a.vertex1).sub(s),c=this.m_shape.getXY(l.vertex1).sub(s),h=M.compareVectors(u,c);return h===0?a.dir<l.dir?-1:1:h});let i=0;const r=this.m_shape.getXY(e[0].vertex1);let n=1;const o=this.m_shape.hasCurves();for(let a=1,l=e.length;a<l;a++){const u=this.m_shape.getXY(e[a].vertex1);if(!(u.isEqualPoint2D(r)&&(n++,a+1<l))){if(n===2){const c=e[i],h=e[i+1],m=c.dir;if(m!==h.dir){let f=!0;if(o&&(f=!this.m_shape.isCurve(c.dir===1?c.vertex0:c.vertex1)&&!this.m_shape.isCurve(h.dir===1?h.vertex0:h.vertex1)),f){if(m===1){const g=c.vertex0,v=h.vertex0;this.m_shape.setNextVertex(g,v),this.m_shape.setPrevVertex(v,g),this.m_shape.getPrevVertex(g)===v&&(this.m_shape.setUserIndex(g,this.m_pointsIndex,-1),this.m_shape.setUserIndex(v,this.m_pointsIndex,-1));const b=c.vertex1,w=h.vertex1;this.m_shape.setPrevVertex(b,w),this.m_shape.setNextVertex(w,b),this.m_shape.getNextVertex(b)===w&&(this.m_shape.setUserIndex(b,this.m_pointsIndex,-1),this.m_shape.setUserIndex(w,this.m_pointsIndex,-1))}else{const g=c.vertex0,v=h.vertex0;this.m_shape.setPrevVertex(g,v),this.m_shape.setNextVertex(v,g),this.m_shape.getNextVertex(g)===v&&(this.m_shape.setUserIndex(g,this.m_pointsIndex,-1),this.m_shape.setUserIndex(v,this.m_pointsIndex,-1));const b=c.vertex1,w=h.vertex1;this.m_shape.setNextVertex(b,w),this.m_shape.setPrevVertex(w,b),this.m_shape.getPrevVertex(b)===w&&(this.m_shape.setUserIndex(b,this.m_pointsIndex,-1),this.m_shape.setUserIndex(w,this.m_pointsIndex,-1))}this.m_dissolvedEdges+=2}}}r.assign(u),i=a,n=1}}e.length=0}}function mve(t){for(let e=t.getFirstGeometry();e!==L;e=t.getNextGeometry(e))if(xt(t.getGeometryType(e)))return!0;return!1}function sit(t,e,s,i){if(!mve(t))return!1;const r=new a0(i);r.m_shape=t,r.m_tolerance=e,r.m_bTrackChanges=s;let n=!1;const o=t.hasCurves()?5:15;return n=t.getTotalPointCount()<o?r.crackBruteForce_():r.crackerPlaneSweep_(),n}function Q9(t,e,s,i,r){if(!mve(e))return!1;let n=new a0(r);if(n.m_shape=e,n.m_tolerance=s,n.m_bAllowCoincident=t,n.m_bNeedsNonSimpleResult=i!==null,n.needsCrackingImpl_())return i&&i.assign(n.m_nonSimpleResult),!0;const o=new Rt;o.setSwapCoordinates(),e.applyTransformation(o),n=new a0(r),n.m_shape=e,n.m_tolerance=s,n.m_bAllowCoincident=t,n.m_bNeedsNonSimpleResult=i!==null;const a=n.needsCrackingImpl_();return e.applyTransformation(o),!!a&&(i&&i.assign(n.m_nonSimpleResult),!0)}function iit(t,e,s,i){const r=e.getGeometryType();if(xt(r))return new a0(i).crackAWithBMultiPath_(t,e,s);yt("crack_A_with_B")}function kre(t,e){return{t,index:e}}class a0{crackBruteForce_(){let e=this.crackBruteForceImpl_();if(!e&&this.m_shape.hasCurves()){const s=new Rt;s.setSwapCoordinates(),this.m_shape.applyTransformation(s),e=this.crackBruteForceImpl_(),this.m_shape.applyTransformation(s)}return e}crackBruteForceImpl_(){let e=!1;const s=new ut,i=new ut,r=X.constructEmpty(),n=X.constructEmpty(),o=!1,a=new nt,l=new ha,u=this.m_shape.getTotalPointCount(),c=u*u*2,h=this.m_shape.queryVertexIteratorOnSelection();for(let m=h.next();m!==L;m=h.next()){const f=this.m_shape.getGeometryType(h.currentGeometry());let g=1,v=1,b=1,w=0,S=0,T=0;const P=this.m_shape.getSegmentParentage(m);let I=!1,A=!1,D=null,k=!1;if(Fb(f))g=this.m_shape.getWeight(m),w=this.m_shape.getRank(m);else{if(D=this.getSegment_(m,s),D===null)continue;const q=this.m_shape.getVertexIndex(m);g=this.m_shape.getWeightWithIndex(q),w=this.m_shape.getRankWithIndex(q),b=this.m_shape.getSegmentWeightWithIndex(q),T=this.m_shape.getSegmentRankWithIndex(q),I=this.m_shape.getSegmentParentageBreakVertex(m);{const U=this.m_shape.getNextVertex(m);v=this.m_shape.getWeight(U),S=this.m_shape.getRank(U),A=this.m_shape.getSegmentParentageBreakVertex(U)}if(D.queryLooseEnvelope(r),r.inflateCoords(this.m_tolerance,this.m_tolerance),D.isDegenerate(this.m_tolerance)){if(!D.isDegenerate(0))continue;k=!0,D=null}}const R=new CG({copy:h});let O=R.next();O!==L&&(O=R.next());let z=0;for(;O!==L;O=R.next()){if(z!==0){z--;continue}if(this.m_shape.getTotalPointCount()>c)return e;this.progress_();const q=this.m_shape.getGeometryType(R.currentGeometry());let U=null,V=!1,B=0,H=0,W=0,ie=0,se=0,Z=0,te=!1,ve=!1;const ke=this.m_shape.getSegmentParentage(O);if(Fb(q))B=this.m_shape.getWeight(O),ie=this.m_shape.getRank(O);else{if(U=this.getSegment_(O,i),U===null)continue;const Ve=this.m_shape.getVertexIndex(O);B=this.m_shape.getWeightWithIndex(Ve),ie=this.m_shape.getRankWithIndex(Ve),W=this.m_shape.getSegmentWeightWithIndex(Ve),Z=this.m_shape.getSegmentRankWithIndex(Ve),te=this.m_shape.getSegmentParentageBreakVertex(O);{const Ke=this.m_shape.getNextVertex(O);H=this.m_shape.getWeight(Ke),se=this.m_shape.getRank(Ke),ve=this.m_shape.getSegmentParentageBreakVertex(Ke)}if(U.queryLooseEnvelope(n),U.isDegenerate(this.m_tolerance)){if(!U.isDegenerate(0))continue;V=!0,U=null}}let Fe=0,Pe=0;if(D!==null&&U!==null)r.isIntersectingNe(n)&&_R(!0,!0,D,U,this.m_tolerance,!0)!==0&&(l.pushSegment(D,g,w,v,S,b,T,I,A,P),l.pushSegment(U,B,ie,H,se,W,Z,te,ve,ke),l.intersect2D(this.m_tolerance,!0),e||(e=l.getSegmentChanged(0)||l.getSegmentChanged(1)),Fe=l.getResultSegmentCount(0),Pe=l.getResultSegmentCount(1),Fe+Pe>0&&(this.m_shape.splitSegmentWithIntersector(m,l,0,!0,!0),this.m_shape.splitSegmentWithIntersector(O,l,1,!0,!0),this.m_bTrackChanges&&(l.getSegmentChanged(0)&&this.m_shape.setGeometryModifiedWithVertex(m,!0),l.getSegmentChanged(1)&&this.m_shape.setGeometryModifiedWithVertex(O,!0))),Pe>1&&(z+=Pe-1),l.clear());else if(D!==null){const Ve=this.m_shape.getXY(O);if(r.contains(Ve)){if(l.pushSegment(D,g,w,v,S,b,T,I,A,P),this.m_shape.queryPoint(O,a),l.intersect2DEx(this.m_tolerance,a,ie,B,o),e||(e=l.getSegmentChanged(0)||l.getResultPointChanged()),Fe=l.getResultSegmentCount(0),Fe>0)if(this.m_bTrackChanges&&(l.getSegmentChanged(0)&&this.m_shape.setGeometryModifiedWithVertex(m,!0),l.getSegmentChanged(1)&&this.m_shape.setGeometryModifiedWithVertex(O,!0)),this.m_shape.splitSegmentWithIntersector(m,l,0,!0,!0),V){let Ke=L;for(let He=this.m_shape.getNextVertex(O);He!==L&&He!==O&&(U=this.getSegment_(He,i),Ke=He,U!=null&&U.isDegenerate(0));He=this.m_shape.getNextVertex(He));for(let He=O;He!==L&&(this.m_shape.setPoint(He,l.getResultPoint(),!0),He!==Ke);He=this.m_shape.getNextVertex(He));}else this.m_shape.setPoint(O,l.getResultPoint(),!0);l.clear()}}else{if(U===null)continue;{const Ve=this.m_shape.getXY(m);if(n.inflateCoords(this.m_tolerance,this.m_tolerance),n.contains(Ve)){if(l.pushSegment(U,B,ie,H,se,W,Z,te,ve,ke),this.m_shape.queryPoint(m,a),l.intersect2DEx(this.m_tolerance,a,w,g,o),e||(e=l.getSegmentChanged(0)||l.getResultPointChanged()),Pe=l.getResultSegmentCount(0),Pe>0)if(this.m_bTrackChanges&&(l.getSegmentChanged(0)&&this.m_shape.setGeometryModifiedWithVertex(O,!0),l.getSegmentChanged(1)&&this.m_shape.setGeometryModifiedWithVertex(m,!0)),this.m_shape.splitSegmentWithIntersector(O,l,0,!0,!0),z+=Pe-1,k){let Ke=L;for(let He=this.m_shape.getNextVertex(m);He!==L&&He!==m&&(U=this.getSegment_(He,i),Ke=He,U!=null&&U.isDegenerate(0));He=this.m_shape.getNextVertex(He));for(let He=m;He!==L&&(this.m_shape.setPoint(He,l.getResultPoint(),!0),He!==Ke);He=this.m_shape.getNextVertex(He));}else this.m_shape.setPoint(m,l.getResultPoint(),!0);l.clear()}}}if(Fe+Pe!==0&&Fe!==0){let Ve=!1;for(;D=this.getSegment_(m,s),D!=null&&(D.queryEnvelope(r),D.isDegenerate(this.m_tolerance));){if(!(Fe>1)){Ve=!0;break}m=h.next(),Fe--,F(m!==L)}if(Ve)break}}}return e}crackerPlaneSweep_(){return this.planesweep_()}planesweep_(){return new AG(this.m_progressTracker,this.m_bTrackChanges).sweep(this.m_shape,this.m_tolerance)}needsCrackingImpl_(){let e=!1;const s=new Qs(0);s.resize(this.m_shape.getSelectedCount());const i=this.m_shape.queryVertexIteratorOnSelection();for(let h=0,m=i.next();m!==L;++h,m=i.next())s.write(h,m);this.m_shape.sortVerticesSimpleByY(s,0,s.size()),s.add(L);const r=this.m_shape.createUserIndex(),n=this.m_shape.createUserIndex();this.m_sweepComparator=new ove(this.m_shape,this.m_tolerance,!this.m_bAllowCoincident),this.m_sweepStructure.setComparator(this.m_sweepComparator);let o=null;const a=[],l=[];let u=0;const c=new M;for(let h=s.read(u++);h!==L;){this.m_shape.queryXY(h,c);let m=!1;do{let w=this.m_shape.getNextVertex(h),S=this.m_shape.getPrevVertex(h);m||(m=w!==L||S!==L),w===L||this.m_shape.selected(w)||(w=L),S===L||this.m_shape.selected(S)||(S=L),w!==L&&this.m_shape.compareVerticesSimpleY(h,w)<0&&(l.push(h),l.push(w)),S!==L&&this.m_shape.compareVerticesSimpleY(h,S)<0&&(l.push(S),l.push(S));const T=this.m_shape.getUserIndex(h,r);T!==-1&&(a.push(T),this.m_shape.setUserIndex(h,r,-1));const P=this.m_shape.getUserIndex(h,n);P!==-1&&(a.push(P),this.m_shape.setUserIndex(h,n,-1)),h=s.read(u++)}while(h!==L&&this.m_shape.isEqualXYPoint2D(h,c));if(!m&&(o===null&&(o=new ave(this.m_shape,this.m_tolerance)),o.setPoint(c),this.m_sweepStructure.searchUpperBound(o),o.intersectionDetected())){e=!0,this.m_bNeedsNonSimpleResult&&(Ce("needsCrackingIMpl_"),this.m_nonSimpleResult=new gs(6,-1,-1));break}let f=a.length===1&&l.length===2;a.length>32&&xx(a);let v=-1,b=-1;if(!f)for(let w=0,S=a.length;w<S;w++){const T=a[w],P=this.m_sweepStructure.getPrev(T);if(P!==-1&&a.indexOf(P)===-1)if(v===-1)v=P;else{if(e=!0,!this.m_bNeedsNonSimpleResult)break;this.m_nonSimpleResult=new gs(6,-1,-1)}const I=this.m_sweepStructure.getNext(T);if(I!==-1&&a.indexOf(I)===-1)if(b===-1)b=I;else{if(e=!0,!this.m_bNeedsNonSimpleResult)break;this.m_nonSimpleResult=new gs(6,-1,-1)}if(v!==-1&&b!==-1)break}if(e&&!this.m_bNeedsNonSimpleResult)break;if(this.m_sweepComparator.setSweepY(c.y,c.x),!f){for(let w=0,S=a.length;w<S;w++){const T=a[w];this.m_sweepStructure.deleteNode(T)}a.length=0}if(!f&&v!==-1&&b!==-1&&this.checkForIntersections_(v,b)){e=!0,this.m_bNeedsNonSimpleResult&&(this.m_nonSimpleResult=this.m_sweepComparator.getResult());break}for(let w=0,S=l.length;w<S;w+=2){const T=l[w],P=l[w+1];let I;if(f?(I=this.m_sweepStructure.replaceElementAtPosition(a[0],T,!0,!0),a.length=0,f=!1):I=this.m_sweepStructure.addElement(T),this.m_sweepComparator.intersectionDetected()){this.m_bNeedsNonSimpleResult&&(this.m_nonSimpleResult=this.m_sweepComparator.getResult()),e=!0;break}this.m_shape.getUserIndex(P,r)===-1?this.m_shape.setUserIndex(P,r,I):this.m_shape.setUserIndex(P,n,I)}if(e)break;l.length=0}return this.m_shape.removeUserIndex(r),this.m_shape.removeUserIndex(n),e}checkForIntersections_(e,s){const i=this.m_sweepStructure.getElement(e);this.m_sweepComparator.compare(this.m_sweepStructure,i,s);const r=this.m_sweepComparator.intersectionDetected();return this.m_sweepComparator.clearIntersectionDetectedFlag(),r}getSegment_(e,s){return a0.st_getSegment(this.m_shape,e,s)}static st_getSegment(e,s,i){return e.querySegment(s,i,!1,!1)?i.get():null}dbgPrintSweepEdge(e){}dbgPrintSweepStructure(){}dbgSaveSweepStructure(e=null){}dbgCheckSweepStructure(){}progress_(e=!1){this.m_progressCounter++}crackAWithBMultiPath_(e,s,i){const r=X.constructEmpty();e.queryLooseEnvelope(r);const n=X.constructEmpty();if(s.queryLooseEnvelope(n),n.inflateCoords(i,i),!n.isIntersecting(r))return e;const o=e.getImpl(),a=o.getAccelerators();let l=null,u=null;a&&(u=a.getQuadTree()),rit(e,QE(s))&&(l=Lb(o,n),u=l);const c=u?u.getIteratorForQT():null,h=s.querySegmentIterator(),m=e.querySegmentIterator(),f=Me(15,Number.NaN),g=[];for(;h.nextPath();)for(;h.hasNextSegment();){const P=h.nextSegment();if(u){c.resetIterator(P,i);for(let I=c.next();I!==-1;I=c.next()){this.progress_();const A=u.getElement(I);if(m.resetToVertex(A,-1),m.hasNextSegment()){const D=m.nextSegment().intersect(P,null,f,null,i);for(let k=0;k<D;k++){const R=f[k];if(R===0||R===1)continue;const O=kre(R,m.getStartPointIndex());g.push(O)}}}}else{const I=X.constructEmpty();if(P.queryLooseEnvelope(I),I.inflateCoords(i,i),!r.isIntersecting(I))continue;for(m.resetToFirstPath();m.nextPath();)for(;m.hasNextSegment();){const A=m.nextSegment(),D=X.constructEmpty();if(A.queryLooseEnvelope(D),!D.isIntersecting(I))continue;const k=A.intersect(P,null,f,null,i);for(let R=0;R<k;R++){const O=f[R];if(O===0||O===1)continue;const z=kre(O,m.getStartPointIndex());g.push(z)}}}}if(g.length===0)return e;g.sort((P,I)=>P.index<I.index?-1:P.index>I.index?1:P.t<I.t?-1:P.t>I.t?1:0);const v=e.createInstance();for(v.getGeometryType()===G.enumPolygon&&v.setFillRule(e.getFillRule()),m.resetToFirstPath();m.nextPath()&&!m.hasNextSegment(););F(m.hasNextSegment());let b=m.nextSegment();const w=new ut;let S=-1;for(let P=0,I=g.length;P<I;){const A=g[P].index;let D=P+1;for(;D<I&&g[D].index===A;)++D;for(;m.getStartPointIndex()<A;){this.progress_();const O=m.hasNextSegment(),z=m.getPathIndex();if((O||!m.isClosingSegment()||m.isCurve())&&(F(b!==null),v.addSegment(b,S!==z)),S=z,!O){for(m.isPathClosed();m.nextPath()&&!m.hasNextSegment(););F(m.hasNextSegment())}b=m.nextSegment()}let k=0;for(let O=P;O<D;O++){const z=g[O].t;if(z===k)continue;F(b!==null),b.queryCut(k,z,w),k=z;const q=m.getPathIndex();v.addSegment(w.get(),S!==q),S=q}const R=m.hasNextSegment();if((R||!m.isClosingSegment()||m.isCurve())&&(F(b!=null),b.queryCut(k,1,w),v.addSegment(w.get(),!1)),R)b=m.nextSegment();else{for(;m.nextPath()&&!m.hasNextSegment(););b=m.hasNextSegment()?m.nextSegment():null}P=D}if(b!==null){const P=m.getPathIndex();(m.hasNextSegment()||!m.isClosingSegment()||m.isCurve())&&v.addSegment(b,S!==P),S=P}let T=m.hasNextSegment();for(;;){if(!T){for(;m.nextPath()&&(T=m.hasNextSegment(),!T););if(!T)break}b=m.nextSegment();const P=m.getPathIndex();T=m.hasNextSegment(),(T||!m.isClosingSegment()||m.isCurve())&&v.addSegment(b,S!==P),S=P}return v}constructor(e){this.m_shape=null,this.m_progressTracker=null,this.m_nonSimpleResult=new gs,this.m_tolerance=0,this.m_sweepComparator=null,this.m_progressCounter=0,this.m_bTrackChanges=!1,this.m_bNeedsNonSimpleResult=!1,this.m_bAllowCoincident=!0,this.m_sweepStructure=new Xe,this.m_progressTracker=e}}function rit(t,e){const s=t.getPointCount();return s<16?!1:2*s+1*(Math.log(s)/Math.log(2))*e<1*s*e}a0.s_bForceBruteForce=!0;class dve{constructor(e,s){this.m_monotoneParts=ne(ut,16),this.m_xOrds=Me(16,Number.NaN),this.m_inputPoint=M.getNAN(),this.m_miny=0,this.m_maxy=0,this.m_windnum=0,this.m_bAlternate=e,this.m_tolerance=s,this.m_toleranceSqr=s*s,this.m_bTestBorder=!!s,this.m_bBreak=!1}_DoOne(e){if(!this.m_bTestBorder&&(this.m_bAlternate&&this.m_inputPoint.equals(e.getStartXY())||this.m_inputPoint.equals(e.getEndXY())))return void(this.m_bBreak=!0);if(e.getStartY()===this.m_inputPoint.y&&e.getStartY()===e.getEndY()){if(this.m_bAlternate&&!this.m_bTestBorder){const r=Math.min(e.getStartX(),e.getEndX()),n=Math.max(e.getStartX(),e.getEndX());this.m_inputPoint.x>r&&this.m_inputPoint.x<n&&(this.m_bBreak=!0)}return}let s=!1;const i=Math.max(e.getStartX(),e.getEndX());if(this.m_inputPoint.x>i)s=!0;else if(this.m_inputPoint.x>=Math.min(e.getStartX(),e.getEndX())){const r=e.intersectionOfYMonotonicWithAxisX(this.m_inputPoint.y,i);s=!Number.isNaN(r)&&r<=this.m_inputPoint.x}if(s){if(this.m_inputPoint.y===e.getStartY()){if(this.m_inputPoint.y<e.getEndY())return}else if(this.m_inputPoint.y===e.getEndY()&&this.m_inputPoint.y<e.getStartY())return;this.m_bAlternate?this.m_windnum^=1:this.m_windnum+=e.getStartY()>e.getEndY()?1:-1}}_Result(){return!!this.m_windnum}testBorder(e){const s=e.getClosestCoordinate(this.m_inputPoint,!1),i=e.getCoord2D(s);return M.sqrDistance(i,this.m_inputPoint)<=this.m_toleranceSqr}setInputPoint(e){this.m_inputPoint.setCoordsPoint2D(e),this.m_miny=e.y-this.m_tolerance,this.m_maxy=e.y+this.m_tolerance}processSegment(e){const s=e.queryInterval(0,1);if(s.vmin>this.m_maxy||s.vmax<this.m_miny)return!1;if(this.m_bTestBorder&&this.testBorder(e))return!0;if(s.vmin>this.m_inputPoint.y||s.vmax<this.m_inputPoint.y)return!1;let i=0;if(e.isCurve()&&(this.m_monotoneParts.length===0&&(this.m_monotoneParts.length=128),i=e.getMonotonicParts(this.m_monotoneParts,!0),F(this.m_monotoneParts.length>=i)),i>0)for(let r=0;r<i;r++){const n=this.m_monotoneParts[r].get(),o=de.construct(n.getStartY(),n.getEndY());if(!(o.vmin>this.m_inputPoint.y||o.vmax<this.m_inputPoint.y)&&(this._DoOne(n),this.m_bBreak))return!0}else if(this._DoOne(e),this.m_bBreak)return!0;return!1}result(){return F(0),2}}function nit(t,e,s,i){const r=new X;t.queryLooseEnvelope(r),r.inflateCoords(i,i);const n=t.getFillRule()===0,o=new dve(n,i);o.setInputPoint(s);const a=r.clone();a.xmax=s.x+i,a.ymin=s.y-i,a.ymax=s.y+i;const l=t.getImpl().querySegmentIterator(),u=e.getIterator(a,i);for(let c=u.next();c!==-1;c=u.next())if(l.resetToVertex(e.getElement(c),-1),l.hasNextSegment()){const h=l.nextSegment();if(o.processSegment(h))return-1}return o._Result()?1:0}function oit(t,e,s){const i=t.getFillRule()===0,r=new dve(i,s);r.setInputPoint(e);const n=t.getImpl().querySegmentIterator();for(;n.nextPath();)for(;n.hasNextSegment();){const o=n.nextSegment();if(r.processSegment(o))return-1}return r._Result()?1:0}function ait(t,e,s){return e.isEmpty()?0:lD(t,e.getXY(),s)}function lD(t,e,s){if(t.isEmpty())return 0;const i=X.constructEmpty();if(t.queryLooseEnvelope(i),i.inflateCoords(s,s),!i.contains(e))return 0;const r=t.getImpl().getAccelerators();if(r){r.getRasterizedGeometry()&&F(0);const n=r.getQuadTree();if(n)return nit(t,n,e,s)}return oit(t,e,s)}function cg(t,e){const s=t.getPointCount();return s<16?!1:2*s+1*(Math.log(s)/Math.log(2))*e<1*s*e}function lit(t,e,s,i,r){const n=new pve(r);return n.m_shape=t,n.m_geometry=e,n.m_sortedVertices=s,n.m_bFixSelfTangency=i,n.fixRingOrientation_()}function uit(t,e,s){const i=new pve(s);return i.m_shape=t,i.m_geometry=e,i.m_sortedVertices=null,i.m_bFixSelfTangency=!1,i.fixRingOrientationForMp2sp_()}class cit{getDirection_(e){return this.m_shape.getNextVertex(this.getEnd1(e))===this.getEnd2(e)}getEnd_(e){const s=this.getEnd1(e),i=this.getEnd2(e);return this.m_shape.getNextVertex(s)===i?i:s}constructor(e){this.m_end1Nodes=[],this.m_end2Nodes=[],this.m_directions=[],this.m_shape=e,this.m_firstFree=-1}getSegment(e){return this.m_shape.getSegment(this.getStart(e))}isBottomUp(e){let s=this.getEnd1(e),i=this.getEnd2(e);this.m_shape.getPrevVertex(s)===i&&(i=be(s,s=i));const r=M.getNAN(),n=M.getNAN();return this.m_shape.queryXY(s,r),this.m_shape.queryXY(i,n),F(!r.equals(n)),r.y<n.y}getStart(e){const s=this.getEnd1(e),i=this.getEnd2(e);return this.m_shape.getNextVertex(s)===i?s:i}getEnd1(e){return this.m_end1Nodes[e]}getEnd2(e){return this.m_end2Nodes[e]}freeEdge(e){this.m_end1Nodes[e]=this.m_firstFree,this.m_firstFree=e}newEdge(e){if(this.m_firstFree!==-1){const i=this.m_firstFree;return this.m_firstFree=this.m_end1Nodes[i],this.m_end1Nodes[i]=e,this.m_end2Nodes[i]=this.m_shape.getNextVertex(e),i}const s=this.m_end1Nodes.length;return this.m_end1Nodes.push(e),this.m_end2Nodes.push(this.m_shape.getNextVertex(e)),s}getShape(){return this.m_shape}getPath(e){return this.m_shape.getPathFromVertex(this.getEnd1(e))}}let hit=class extends E0{constructor(t){super(),this.m_line1=new pt,this.m_line2=new pt,this.m_leftElm=-1,this.m_leftx=0,this.m_seg1=null,this.m_helper=t}compare(t,e,s){const i=t.getElement(s),r=this.m_helper.m_edges;let n;this.m_leftElm===e?n=this.m_leftx:(this.m_seg1=r.getSegment(e),this.m_seg1?n=this.m_seg1.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0):(r.getShape().queryLineConnector(r.getStart(e),this.m_line1,!0),this.m_seg1=this.m_line1,n=this.m_line1.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0)),this.m_leftx=n,this.m_leftElm=e);let o,a=r.getSegment(i);if(a?o=a.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0):(r.getShape().queryLineConnector(r.getStart(i),this.m_line2,!0),a=this.m_line2,o=this.m_line2.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0)),n===o){const l=r.isBottomUp(e),u=r.isBottomUp(i),c=l?this.m_seg1.getEndY():this.m_seg1.getStartY(),h=u?a.getEndY():a.getStartY(),m=Math.min(c,h);let f=.5*(m+this.m_helper.m_yScanline);f===this.m_helper.m_yScanline&&(f=m),n=this.m_seg1.intersectionOfYMonotonicWithAxisX(f,0),o=a.intersectionOfYMonotonicWithAxisX(f,0),n===o&&R8("")}return n<o?-1:n>o?1:0}reset(){this.m_leftElm=-1}};class Fre{constructor(e){this.m_node=-1,this.m_index=0,this.m_sortedVertices=e.m_sortedVertices,this.m_sortedVerticesArray=e.m_sortedVerticesArray,this.m_sortedVertices&&(this.m_node=this.m_sortedVertices.getFirst(this.m_sortedVertices.getFirstList()))}next(){if(this.m_sortedVertices){const e=this.m_node;if(e===-1)return L;const s=this.m_sortedVertices.getData(e);return this.m_node=this.m_sortedVertices.getNext(e),s}if(this.m_index<this.m_sortedVerticesArray.size()){const e=this.m_sortedVerticesArray.read(this.m_index);return this.m_index++,e}return L}}class pve{constructor(e){this.m_edges=null,this.m_shape=null,this.m_AET=new Xe,this.m_yScanline=0,this.m_geometry=L,this.m_unknownRingOrientationCount=-1,this.m_sortedVertices=null,this.m_sortedVerticesArray=null,this.m_unknownNodes=[],this.m_node1UserIndex=-1,this.m_node2UserIndex=-1,this.m_pathOrientationIndex=-1,this.m_pathParentageIndex=-1,this.m_pathParentsIndex=-1,this.m_progressCounter=0,this.m_bFixSelfTangency=!1,this.m_progressTracker=e,this.m_AET.disableBalancing(),this.m_sweepComparator=new hit(this),this.m_AET.setComparator(this.m_sweepComparator)}fixRingOrientation_(){const e=this.fixRingOrientationImplMain_();return this.m_pathOrientationIndex===-1||this.fixRingOrientationImplSimplify_(),e}fixRingOrientationForMp2sp_(){return this.fixRingOrientationImplMain_(),this.m_pathOrientationIndex===-1?-1:this.fixRingOrientationImplMp2sp_()}processBunchForRingOrientationTest_(e){return this.processBunchForRingOrientationTestOddEven_(e)}processBunchForRingOrientationTestOddEven_(e){let s=!1;if(this.m_edges||(this.m_edges=new cit(this.m_shape)),this.m_unknownNodes.length=0,this.processBunchForRingOrientationRemoveEdges_(e),!this.m_AET.isAutoBalancing()){let i=0;for(let r=0,n=e.length;r<n;r++)e[r]!==-1&&i++;(i>10||this.m_AET.getMaxDepthEver()>4)&&this.m_AET.enableBalancing()}for(let i=0,r=e.length;i<r;i++){const n=e[i];n!==L&&this.insertEdge_(n,-1)}for(let i=0;i<this.m_unknownNodes.length&&this.m_unknownRingOrientationCount>0;i++){const r=this.m_unknownNodes[i],n=this.m_AET.getElement(r),o=this.m_edges.getPath(n),a=this.m_shape.getPathUserIndex(o,this.m_pathOrientationIndex);let l=L;if(a===0){let u=this.m_AET.getPrev(r),c=r,h=!1;for(;u!==Xe.st_nullNode();){const m=this.m_AET.getElement(u),f=this.m_edges.getPath(m);if(this.m_shape.getPathUserIndex(f,this.m_pathOrientationIndex)!==0){l=f;break}c=u,u=this.m_AET.getPrev(u)}if(u===Xe.st_nullNode())h=!0,u=c;else{const m=this.m_AET.getElement(u);h=this.m_edges.isBottomUp(m),u=this.m_AET.getNext(u),h=!h}do{const m=this.m_AET.getElement(u),f=this.m_edges.getPath(m);if(this.m_shape.getPathUserIndex(f,this.m_pathOrientationIndex)===0){if(h!==this.m_edges.isBottomUp(m)){const g=this.m_shape.getFirstVertex(f);this.m_shape.reverseRingInternal(g),this.m_shape.setLastVertex(f,this.m_shape.getPrevVertex(g)),s=!0}if(this.m_shape.setPathUserIndex(f,this.m_pathOrientationIndex,h?3:2),!h){let g=this.m_shape.getPathUserIndex(l,this.m_pathOrientationIndex);g===2&&(l=this.m_shape.getPathUserIndex(l,this.m_pathParentsIndex),g=this.m_shape.getPathUserIndex(l,this.m_pathOrientationIndex)),F(g===3);const v=this.m_shape.getPathUserIndex(l,this.m_pathParentageIndex);this.m_shape.setPathUserIndex(l,this.m_pathParentageIndex,f),this.m_shape.setPathUserIndex(f,this.m_pathParentageIndex,v),this.m_shape.setPathUserIndex(f,this.m_pathParentsIndex,l)}if(this.m_unknownRingOrientationCount--,!this.m_unknownRingOrientationCount)return s}l=f,c=u,u=this.m_AET.getNext(u),h=!h}while(c!==r)}}return s}processBunchForRingOrientationRemoveEdges_(e){for(let s=0,i=e.length;s<i;s++){const r=e[s],n=this.m_shape.getUserIndex(r,this.m_node1UserIndex),o=this.m_shape.getUserIndex(r,this.m_node2UserIndex);if(n!==-1){const l=this.m_AET.getElement(n);this.m_edges.freeEdge(l),this.m_shape.setUserIndex(r,this.m_node1UserIndex,-1)}if(o!==-1){const l=this.m_AET.getElement(o);this.m_edges.freeEdge(l),this.m_shape.setUserIndex(r,this.m_node2UserIndex,-1)}let a=-1;n!==-1&&o!==-1?(this.m_AET.deleteNode(n),this.m_AET.deleteNode(o),e[s]=L):a=n!==-1?n:o,a!==-1&&(this.insertEdge_(r,a)||this.m_AET.deleteNode(a),e[s]=L)}}dbgVerifyRingOrientation_(){}insertEdge_(e,s){const i=M.getNAN(),r=M.getNAN();this.m_shape.queryXY(e,i);const n=this.m_shape.getNextVertex(e);this.m_shape.queryXY(n,r);let o=!1;if(i.y<r.y){o=!0;const l=this.m_edges.newEdge(e);let u;s===-1?u=this.m_AET.addElement(l):(u=s,this.m_AET.setElement(u,l)),this.m_shape.getUserIndex(n,this.m_node1UserIndex)===-1?this.m_shape.setUserIndex(n,this.m_node1UserIndex,u):this.m_shape.setUserIndex(n,this.m_node2UserIndex,u);const c=this.m_shape.getPathFromVertex(e);this.m_shape.getPathUserIndex(c,this.m_pathOrientationIndex)===0&&this.m_unknownNodes.push(u)}const a=this.m_shape.getPrevVertex(e);if(this.m_shape.queryXY(a,r),i.y<r.y){o=!0;const l=this.m_edges.newEdge(a);let u;s===-1?u=this.m_AET.addElement(l):(u=s,this.m_AET.setElement(u,l)),this.m_shape.getUserIndex(a,this.m_node1UserIndex)===-1?this.m_shape.setUserIndex(a,this.m_node1UserIndex,u):this.m_shape.setUserIndex(a,this.m_node2UserIndex,u);const c=this.m_shape.getPathFromVertex(e);this.m_shape.getPathUserIndex(c,this.m_pathOrientationIndex)===0&&this.m_unknownNodes.push(u)}return o}fixRingSelfTangency_(){const e=[],s=[];let i=-1,r=-1;const n=new M;let o=L,a=L,l=-1;const u=new Fre(this);for(let c=u.next();c!==L;c=u.next()){const h=new M;this.m_shape.queryXY(c,h);const m=this.m_shape.getPathFromVertex(c);n.equals(h)&&a===m?(r===-1&&(i=this.m_shape.createPathUserIndex(),this.m_shape.fillPathUserIndexForGeometry(this.m_geometry,i,-1),r=this.m_shape.createUserIndex(),this.m_shape.fillUserIndexForGeometry(this.m_geometry,r,-1)),l===-1&&(l=s.length,this.m_shape.setUserIndex(o,r,l),s.push(1),this.m_shape.getPathUserIndex(m,i)===-1&&(this.m_shape.setPathUserIndex(m,i,o),e.push(m))),this.m_shape.setUserIndex(c,r,l),s[s.length-1]++):(l=-1,n.assign(h)),o=c,a=m}if(e.length===0)return!1;F(i!==-1);for(let c=0,h=e.length;c<h;c++){const m=e[c];let f=this.m_shape.getPathUserIndex(m,i);const g=this.m_shape.getUserIndex(f,r),v=[],b=[];v.push(f),b.push(g);for(let w=this.m_shape.getNextVertex(f);w!==f;w=this.m_shape.getNextVertex(w)){const S=w,T=this.m_shape.getUserIndex(S,r);if(T!==-1){if(b.length===0){b.push(T),v.push(S);continue}if(b.at(-1)===T){const P=v.at(-1);this.m_shape.peelALoopIntoAPath(P,S),this.m_shape.setUserIndex(w,r,-1),s[T]--,s[T]===1&&(s[T]=0,b.pop(),v.pop()),f=P,w=P}else v.push(w),b.push(T)}}}return this.m_shape.removePathUserIndex(i),this.m_shape.removeUserIndex(r),this.m_shape.dbgVerifyVertexCounts(),!0}progress_(e=!1){}fixRingOrientationImplMain_(){const e={stack:[],error:void 0,hasError:!1};try{let s,i=!1;const r=mo(e,k0e(()=>{this.m_sortedVerticesArray=null}),!1);if(this.m_sortedVertices===null){const l=this.m_shape.getPointCount(this.m_geometry);s=new Qs(0);for(let u=this.m_shape.getFirstPath(this.m_geometry);u!==L;u=this.m_shape.getNextPath(u)){let c=this.m_shape.getFirstVertex(u);for(let h=0,m=this.m_shape.getPathSize(u);h<m;h++)s.add(c),c=this.m_shape.getNextVertex(c)}this.m_shape.sortVerticesSimpleByY(s,0,l),this.progress_(!0),this.m_sortedVerticesArray=s}else r.bForget=!0;if(this.m_bFixSelfTangency&&(i=this.fixRingSelfTangency_()),this.m_shape.getPathCount(this.m_geometry)===1){const l=this.m_shape.getFirstPath(this.m_geometry),u=this.m_shape.getRingArea(l);if(this.m_shape.setExterior(l,!0),u<0){const c=this.m_shape.getFirstVertex(l);return this.m_shape.reverseRingInternal(c),this.m_shape.setLastVertex(l,this.m_shape.getPrevVertex(c)),!0}return!1}this.m_shape.dbgVerifyCurves(),this.m_pathOrientationIndex=this.m_shape.createPathUserIndex(),this.m_pathParentageIndex=this.m_shape.createPathUserIndex(),this.m_pathParentsIndex=this.m_shape.createPathUserIndex();for(let l=this.m_shape.getFirstPath(this.m_geometry);l!==L;l=this.m_shape.getNextPath(l))this.m_shape.setPathUserIndex(l,this.m_pathOrientationIndex,0),this.m_shape.setPathUserIndex(l,this.m_pathParentageIndex,-1),this.m_shape.setPathUserIndex(l,this.m_pathParentsIndex,-1);const n=[];this.m_yScanline=Number.NaN;const o=M.getNAN();this.m_unknownRingOrientationCount=this.m_shape.getPathCount(this.m_geometry),this.m_node1UserIndex=this.m_shape.createUserIndexUninitialized(),this.m_shape.fillUserIndexForGeometry(this.m_geometry,this.m_node1UserIndex,-1),this.m_node2UserIndex=this.m_shape.createUserIndexUninitialized(),this.m_shape.fillUserIndexForGeometry(this.m_geometry,this.m_node2UserIndex,-1);const a=new Fre(this);for(let l=a.next();l!==L&&(this.progress_(),this.m_shape.queryXY(l,o),o.y!==this.m_yScanline&&n.length&&(i=this.processBunchForRingOrientationTest_(n)||i,this.m_sweepComparator.reset(),n.length=0),n.push(l),this.m_yScanline=o.y,this.m_unknownRingOrientationCount!==0);l=a.next());return this.m_unknownRingOrientationCount>0&&(i=this.processBunchForRingOrientationTest_(n)||i,n.length=0),this.m_shape.removeUserIndex(this.m_node1UserIndex),this.m_shape.removeUserIndex(this.m_node2UserIndex),this.dbgVerifyRingOrientation_(),i}catch(s){e.error=s,e.hasError=!0}finally{Od(e)}}fixRingOrientationImplSimplify_(){const e=[];for(let s=this.m_shape.getFirstPath(this.m_geometry);s!==L;)if(this.progress_(),this.m_shape.getPathUserIndex(s,this.m_pathOrientationIndex)===3){this.m_shape.setExterior(s,!0);for(let n=this.m_shape.getPathUserIndex(s,this.m_pathParentageIndex);n!==L;){const o=this.m_shape.getPathUserIndex(n,this.m_pathParentageIndex);e.push(n),this.m_shape.setExterior(n,!1),this.m_shape.setPathUserIndex(n,this.m_pathParentageIndex,s),n=o}let i=s,r=e.length;for(let n=this.m_shape.getNextPath(s);r>0&&n!==L;n=this.m_shape.getNextPath(n),--r){if(this.m_shape.getPathUserIndex(n,this.m_pathParentageIndex)!==s){i=L;break}i=n}if(r!==0){i=s;for(let n=0,o=e.length;n<o;n++){const a=e[n];this.m_shape.setPathUserIndex(a,this.m_pathParentageIndex,Ov),this.m_shape.movePath(this.m_geometry,this.m_shape.getNextPath(i),a),i=a}}e.length=0,s=this.m_shape.getNextPath(i)}else s=this.m_shape.getNextPath(s);this.m_shape.removePathUserIndex(this.m_pathOrientationIndex),this.m_shape.removePathUserIndex(this.m_pathParentageIndex),this.m_shape.removePathUserIndex(this.m_pathParentsIndex)}fixRingOrientationImplMp2sp_(){const e=this.m_shape.createPathUserIndex();let s=0;const i=[];for(let r=this.m_shape.getFirstPath(this.m_geometry);r!==L;)if(this.progress_(),this.m_shape.getPathUserIndex(r,this.m_pathOrientationIndex)===3){this.m_shape.setExterior(r,!0),this.m_shape.setPathUserIndex(r,e,s),s++;for(let l=this.m_shape.getPathUserIndex(r,this.m_pathParentageIndex);l!==L;){const u=this.m_shape.getPathUserIndex(l,this.m_pathParentageIndex);i.push(l),this.m_shape.setExterior(l,!1),this.m_shape.setPathUserIndex(l,this.m_pathParentageIndex,r),l=u}let n=r,o=i.length,a=s;for(let l=this.m_shape.getNextPath(r);o>0&&l!==L;l=this.m_shape.getNextPath(l),--o){if(this.m_shape.getPathUserIndex(l,this.m_pathParentageIndex)!==r){n=L;break}n=l,this.m_shape.setPathUserIndex(l,e,-a),a++}if(o!==0){n=r,a=s;for(let l=0,u=i.length;l<u;l++){const c=i[l];this.m_shape.setPathUserIndex(c,e,-a),a++,this.m_shape.setPathUserIndex(c,this.m_pathParentageIndex,Ov)}n=r}s=a,i.length=0,r=this.m_shape.getNextPath(n)}else r=this.m_shape.getNextPath(r);return this.m_shape.removePathUserIndex(this.m_pathOrientationIndex),this.m_shape.removePathUserIndex(this.m_pathParentageIndex),this.m_shape.removePathUserIndex(this.m_pathParentsIndex),e}}function _d(t,e,s,i,r,n){const o=new mit(n);return o.m_shape=t,o.m_geometry=e,o.m_knownSimpleResult=s,o.m_bFixSelfTangency=i,o.m_polylineDegeneracies=r,o.m_bHasSegmentParentage=t.hasSegmentParentage(),o.m_bHasSegments=t.hasCurves(),o.simplify_()}class mit{constructor(e){this.m_shape=null,this.m_geometry=L,this.m_sortedVertices=new Wr,this.m_bunchEdgeEndPoints=[],this.m_bunchEdgeCenterPoints=[],this.m_bunchEdgeIndices=[],this.m_knownSimpleResult=-1,this.m_sortedVerticesListIndex=-1,this.m_polylineDegeneracies=L,this.m_userIndexSortedIndexToVertex=-1,this.m_userIndexSortedAngleIndexToVertex=-1,this.m_nextVertexToProcess=-1,this.m_firstCoincidentVertex=-1,this.m_progressCounter=0,this.m_bFixSelfTangency=!1,this.m_bHasSegmentParentage=!1,this.m_bHasSegments=!1,this.m_progressTracker=e}compareAngles_(e,s){if(this.m_bHasSegments)return this.compareAnglesCurves_(e,s);const i=this.m_bunchEdgeEndPoints[e],r=new M;this.m_shape.queryXY(i,r);const n=new M,o=this.m_bunchEdgeEndPoints[s];if(this.m_shape.queryXY(o,n),r.equals(n))return 0;const a=this.m_bunchEdgeCenterPoints[e],l=new M;this.m_shape.queryXY(a,l);const u=this.m_bunchEdgeCenterPoints[s],c=new M;this.m_shape.queryXY(u,c);const h=new M;h.setSub(r,l);const m=new M;return m.setSub(n,c),(h.isZero()||m.isZero())&&R8(""),M.compareVectors(h,m)}compareAnglesCurves_(e,s){const i=this.m_bunchEdgeEndPoints[e],r=this.m_bunchEdgeEndPoints[s],n=this.m_bunchEdgeCenterPoints[e],o=this.m_bunchEdgeCenterPoints[s],a=this.m_shape.getNextVertex(n)===i,l=this.m_shape.getNextVertex(o)===r,u=new ut,c=new M;a?(this.m_shape.querySegment(n,u,!1,!0),c.assign(u.get().getTangent(0))):(this.m_shape.querySegment(i,u,!1,!0),c.assign(u.get().getTangent(1)),c.negateThis());const h=new M;return l?(this.m_shape.querySegment(o,u,!1,!0),h.assign(u.get().getTangent(0))):(this.m_shape.querySegment(r,u,!1,!0),h.assign(u.get().getTangent(1)),h.negateThis()),(c.isZero()||h.isZero())&&R8(""),M.compareVectors(c,h)}beforeRemoveVertex_(e,s){const i=this.m_shape.getUserIndex(e,this.m_userIndexSortedIndexToVertex);if(this.m_nextVertexToProcess===i&&(this.m_nextVertexToProcess=this.m_sortedVertices.getNext(this.m_nextVertexToProcess)),this.m_firstCoincidentVertex===i&&(this.m_firstCoincidentVertex=this.m_sortedVertices.getNext(this.m_firstCoincidentVertex)),this.m_sortedVertices.deleteElement(this.m_sortedVerticesListIndex,i),this.removeAngleSortInfo_(e),s){const r=this.m_shape.getPathFromVertex(e);if(r!==L&&this.m_shape.getFirstVertex(r)===e){const n=this.m_shape.getNextVertex(e);if(n!==e){if(this.m_shape.getPathFromVertex(n)===r)return void this.m_shape.setFirstVertex(r,n);{const o=this.m_shape.getPrevVertex(e);if(o!==e&&this.m_shape.getPathFromVertex(o)===r)return void this.m_shape.setFirstVertex(r,o)}}this.m_shape.setFirstVertex(r,L),this.m_shape.setLastVertex(r,L)}}}processBunch_(){let e=!1;const s=new M(0,0);for(;;){this.m_bunchEdgeEndPoints.length=0,this.m_bunchEdgeCenterPoints.length=0,this.m_bunchEdgeIndices.length=0;let i=this.m_firstCoincidentVertex,r=0,n=!0;for(;i!==this.m_nextVertexToProcess;){const a=this.m_sortedVertices.getData(i);n&&(this.m_shape.queryXY(a,s),n=!1);const l=this.m_shape.getPrevVertex(a),u=this.m_shape.getNextVertex(a);this.m_shape.getUserIndex(l,this.m_userIndexSortedAngleIndexToVertex)!==Ov&&(this.m_bunchEdgeEndPoints.push(l),this.m_shape.setUserIndex(l,this.m_userIndexSortedAngleIndexToVertex,Ov),this.m_bunchEdgeCenterPoints.push(a),this.m_bunchEdgeIndices.push(r++)),this.m_shape.getUserIndex(u,this.m_userIndexSortedAngleIndexToVertex)!==Ov&&(this.m_bunchEdgeEndPoints.push(u),this.m_shape.setUserIndex(u,this.m_userIndexSortedAngleIndexToVertex,Ov),this.m_bunchEdgeCenterPoints.push(a),this.m_bunchEdgeIndices.push(r++)),i=this.m_sortedVertices.getNext(i)}if(this.m_bunchEdgeEndPoints.length<2){this.m_bunchEdgeEndPoints.length===1&&this.m_shape.setUserIndex(this.m_bunchEdgeEndPoints[0],this.m_userIndexSortedAngleIndexToVertex,-1);break}this.m_bunchEdgeIndices.sort((a,l)=>this.compareAngles_(a,l));for(let a=0,l=this.m_bunchEdgeIndices.length;a<l;a++){const u=this.m_bunchEdgeIndices[a],c=this.m_bunchEdgeEndPoints[u];this.m_shape.setUserIndex(c,this.m_userIndexSortedAngleIndexToVertex,a)}const o=this.processCrossOvers_(s);for(let a=0,l=this.m_bunchEdgeIndices.length;a<l;a++){const u=this.m_bunchEdgeIndices[a];if(u===-1)continue;const c=this.m_bunchEdgeEndPoints[u];this.m_shape.setUserIndex(c,this.m_userIndexSortedAngleIndexToVertex,-1)}if(!o)break;e=!0}return e}processCrossOvers_(e){let s=!1,i=!0;for(;i;){i=!1;let r=0;this.m_bunchEdgeIndices[r]===-1&&(r=this.getNextEdgeIndex_(r));let n=this.getNextEdgeIndex_(r);for(let o=0,a=this.m_bunchEdgeIndices.length;o<a&&r!==-1&&n!==-1&&r!==n;o++){const l=this.m_bunchEdgeIndices[r],u=this.m_bunchEdgeIndices[n],c=this.m_bunchEdgeEndPoints[l],h=this.m_bunchEdgeEndPoints[u];let m=this.m_shape.getNextVertex(c),f=!1;this.m_shape.isEqualXYPoint2D(m,e)||(m=this.m_shape.getPrevVertex(c),f=!0);let g=this.m_shape.getNextVertex(h),v=!1;this.m_shape.isEqualXYPoint2D(g,e)||(g=this.m_shape.getPrevVertex(h),v=!0);const b=f?this.m_shape.getPrevVertex(m):this.m_shape.getNextVertex(m),w=v?this.m_shape.getPrevVertex(g):this.m_shape.getNextVertex(g);let S=!1;(this.removeSpike_(m)||this.removeSpike_(g)||this.removeSpike_(c)||this.removeSpike_(h)||this.removeSpike_(b)||this.removeSpike_(w))&&(S=!0),m!==g&&(!S&&this.m_shape.isEqualXY(c,h)&&(S=this.resolveOverlap_(f,v,m,c,g,h)),!S&&this.m_shape.isEqualXY(b,w)&&(S=this.resolveOverlap_(!f,!v,m,b,g,w)),!S&&this.m_shape.isEqualXY(c,w)&&(S=this.resolveOverlap_(f,!v,m,c,g,w)),!S&&this.m_shape.isEqualXY(b,h)&&(S=this.resolveOverlap_(!f,v,m,b,g,h))),S&&(s=!0),i||(i=S),r=S?this.getNextEdgeIndex_(r):n,n=this.getNextEdgeIndex_(r)}}if(!s){let r=0;this.m_bunchEdgeIndices[r]===-1&&(r=this.getNextEdgeIndex_(r));let n=this.getNextEdgeIndex_(r);for(let o=0,a=this.m_bunchEdgeIndices.length;o<a&&r!==-1&&n!==-1&&r!==n;o++){const l=this.m_bunchEdgeIndices[r],u=this.m_bunchEdgeIndices[n],c=this.m_bunchEdgeEndPoints[l],h=this.m_bunchEdgeEndPoints[u];let m=this.m_shape.getNextVertex(c);this.m_shape.isEqualXYPoint2D(m,e)||(m=this.m_shape.getPrevVertex(c));let f=this.m_shape.getNextVertex(h);this.m_shape.isEqualXYPoint2D(f,e)||(f=this.m_shape.getPrevVertex(h));const g=this.getDirection_(m,c),v=this.getDirection_(f,h),b=g?this.m_shape.getPrevVertex(m):this.m_shape.getNextVertex(m),w=v?this.m_shape.getPrevVertex(f):this.m_shape.getNextVertex(f),S=this.detectAndResolveCrossOver_(g,v,c,m,b,h,f,w);S!==1?S===0?(r=this.getNextEdgeIndex_(r),n=this.getNextEdgeIndex_(r)):(r=this.getPrevEdgeIndex_(r),n=this.getNextEdgeIndex_(r)):s=!0}}return s}simplify_(){this.m_shape.getGeometryType(this.m_geometry)===G.enumPolygon&&this.m_shape.getFillRule(this.m_geometry)===1&&new wa(this.m_progressTracker).planarSimplifyNoCrackingAndCluster(this.m_bFixSelfTangency,this.m_shape,this.m_geometry,0);let e=!1;this.m_userIndexSortedIndexToVertex=-1,this.m_userIndexSortedAngleIndexToVertex=-1,this.m_userIndexSortedAngleIndexToVertex=this.m_shape.createUserIndexUninitialized();const s=this.m_shape.getPointCount(this.m_geometry),i=new Qs(0);this.m_shape.dbgVerifyMonotone();for(let o=this.m_shape.getFirstPath(this.m_geometry);o!==L;o=this.m_shape.getNextPath(o)){let a=this.m_shape.getFirstVertex(o);for(let l=0,u=this.m_shape.getPathSize(o);l<u;l++)this.m_shape.setUserIndex(a,this.m_userIndexSortedAngleIndexToVertex,-1),i.add(a),a=this.m_shape.getNextVertex(a)}this.m_shape.sortVerticesSimpleByY(i,0,s),this.progress_(!0),this.m_userIndexSortedIndexToVertex=this.m_shape.createUserIndexUninitialized(),this.m_sortedVertices.reserveNodes(s),this.m_sortedVerticesListIndex=this.m_sortedVertices.createList(0);for(let o=0;o<s;o++){const a=i.read(o),l=this.m_sortedVertices.addElement(this.m_sortedVerticesListIndex,a);this.m_shape.setUserIndex(a,this.m_userIndexSortedIndexToVertex,l)}this.m_nextVertexToProcess=-1,this.cleanupSpikes_()&&(e=!0);let r=0,n=!1;do{n=!1,this.m_nextVertexToProcess=-1,this.m_firstCoincidentVertex=this.m_sortedVertices.getFirst(this.m_sortedVerticesListIndex);const o=new M(0,0);this.m_firstCoincidentVertex!==Wr.st_nullNode()&&this.m_shape.queryXY(this.m_sortedVertices.getData(this.m_firstCoincidentVertex),o);let a=0,l=this.m_firstCoincidentVertex;for(;l!==Wr.st_nullNode()&&(l=this.m_sortedVertices.getNext(l),l!==Wr.st_nullNode());){this.progress_();const u=this.m_sortedVertices.getData(l),c=M.getNAN();if(this.m_shape.queryXY(u,c),o.equals(c))a++;else{if(a>0){this.m_nextVertexToProcess=l;const h=this.processBunch_();l=this.m_nextVertexToProcess,l!==Wr.st_nullNode()&&this.m_shape.queryXY(this.m_sortedVertices.getData(l),c),h&&(n=!0)}o.setCoordsPoint2D(c),this.m_firstCoincidentVertex=l,a=0}}this.m_nextVertexToProcess=-1,a>0&&this.processBunch_()&&(n=!0),r++>10&&Ce(""),n&&this.fixOrphanVertices_(),this.cleanupSpikes_()&&(n=!0),e||(e=n)}while(n);return this.m_shape.dbgVerifyMonotone(),this.m_shape.dbgVerifyCurves(),this.m_shape.removeUserIndex(this.m_userIndexSortedIndexToVertex),this.m_shape.removeUserIndex(this.m_userIndexSortedAngleIndexToVertex),e=lit(this.m_shape,this.m_geometry,this.m_sortedVertices,this.m_bFixSelfTangency,this.m_progressTracker)||e,this.m_shape.dbgVerifyCurves(),e}getDirection_(e,s){return this.m_shape.getNextVertex(s)!==e}detectAndResolveCrossOver_(e,s,i,r,n,o,a,l){if(r===a)return this.removeAngleSortInfo_(i),this.removeAngleSortInfo_(o),-1;const u=this.m_shape.getUserIndex(i,this.m_userIndexSortedAngleIndexToVertex),c=this.m_shape.getUserIndex(n,this.m_userIndexSortedAngleIndexToVertex),h=this.m_shape.getUserIndex(o,this.m_userIndexSortedAngleIndexToVertex),m=this.m_shape.getUserIndex(l,this.m_userIndexSortedAngleIndexToVertex),f=Me(8,Number.NaN),g=Me(4,Number.NaN);f[0]=0,g[0]=u,f[1]=0,g[1]=c,f[2]=1,g[2]=h,f[3]=1,g[3]=m;for(let b=1;b<4;b++){const w=g[b],S=f[b];let T=b-1;for(;T>=0&&g[T]>w;)g[T+1]=g[T],f[T+1]=f[T],T--;g[T+1]=w,f[T+1]=S}let v=0;if(f[0]&&(v|=1),f[1]&&(v|=2),f[2]&&(v|=4),f[3]&&(v|=8),v!==5&&v!==10)return 0;if(e!==s&&(l=be(o,o=l)),e)this.m_shape.setNextVertex(l,r),this.m_shape.setPrevVertex(r,l),this.m_shape.setNextVertex(n,a),this.m_shape.setPrevVertex(a,n),this.m_bHasSegmentParentage&&(this.m_shape.setSegmentParentageBreakVertex(r,!0),this.m_shape.setSegmentParentageBreakVertex(a,!0));else{if(this.m_shape.setPrevVertex(l,r),this.m_shape.setNextVertex(r,l),this.m_shape.setPrevVertex(n,a),this.m_shape.setNextVertex(a,n),this.m_bHasSegmentParentage){const b=this.m_shape.getSegmentParentage(r),w=this.m_shape.getSegmentParentage(a);this.m_shape.setSegmentParentageAndBreak(r,w,!0),this.m_shape.setSegmentParentageAndBreak(a,b,!0)}if(this.m_bHasSegments){const b=this.m_shape.getVertexIndex(r),w=this.m_shape.getVertexIndex(a),S=this.m_shape.getSegmentFromIndex(b);this.m_shape.setSegmentToIndex(b,null);const T=this.m_shape.getSegmentFromIndex(w);this.m_shape.setSegmentToIndex(w,null),this.m_shape.setSegmentToIndex(b,T),this.m_shape.setSegmentToIndex(w,S)}}return 1}resolveOverlap_(e,s,i,r,n,o){return this.resolveOverlapOddEven_(e,s,i,r,n,o)}resolveOverlapOddEven_(e,s,i,r,n,o){if(e!==s){e||(n=be(i,i=n),o=be(r,r=o));const a=this.m_shape.getNextVertex(n),l=this.m_shape.getNextVertex(i);if(this.m_shape.setNextVertex(i,a),this.m_shape.setPrevVertex(a,i),this.m_shape.setNextVertex(n,l),this.m_shape.setPrevVertex(l,n),this.m_bHasSegments){const u=this.m_shape.getVertexIndex(i),c=this.m_shape.getVertexIndex(n),h=this.m_shape.getSegmentFromIndex(u);this.m_shape.setSegmentToIndex(u,null);const m=this.m_shape.getSegmentFromIndex(c);this.m_shape.setSegmentToIndex(c,null),this.m_shape.setSegmentToIndex(u,m),this.m_shape.setSegmentToIndex(c,h)}if(this.m_bHasSegmentParentage){const u=this.m_shape.getSegmentParentage(i),c=this.m_shape.getSegmentParentage(n);this.m_shape.setSegmentParentageAndBreak(i,c,!0),this.m_shape.setSegmentParentageAndBreak(n,u,!0),this.m_shape.setSegmentParentageBreakVertex(r,!0),this.m_shape.setSegmentParentageBreakVertex(o,!0)}this.removeSpike_(n)}else{const a=e?i:r,l=s?n:o,u=e?r:i,c=s?o:n;let h=null;if(this.m_bHasSegments){const S=this.m_shape.getVertexIndex(c);h=this.m_shape.getSegmentFromIndex(S),this.m_shape.setSegmentToIndex(S,null);const T=this.m_shape.getVertexIndex(l);this.m_shape.setSegmentToIndex(T,null);const P=this.m_shape.getVertexIndex(a);this.m_shape.setSegmentToIndex(P,null)}let m=-1;this.m_bHasSegmentParentage&&(m=this.m_shape.getSegmentParentage(c));let f=!1;this.m_shape.setNextVertex(a,l),this.m_shape.setNextVertex(l,a),this.m_shape.setPrevVertex(u,c),this.m_shape.setPrevVertex(c,u);let g=c;for(;g!==l;){const S=this.m_shape.getPrevVertex(g),T=this.m_shape.getNextVertex(g);if(this.m_shape.setPrevVertex(g,T),this.m_shape.setNextVertex(g,S),f||(f=g===a),this.m_bHasSegments&&g!==a){const P=this.m_shape.getVertexIndex(T),I=h;h=this.m_shape.getSegmentFromIndex(P),I!==null&&I.reverse(),this.m_shape.setSegmentToIndex(P,I)}if(this.m_bHasSegmentParentage){const P=this.m_shape.getSegmentParentage(T);this.m_shape.setSegmentParentagePreserveBreak(T,m),m=P}g=T}let v=null;if(!f){const S=this.m_shape.getPrevVertex(l),T=this.m_shape.getNextVertex(l);if(this.m_shape.setPrevVertex(l,T),this.m_shape.setNextVertex(l,S),this.m_bHasSegments){const P=this.m_shape.getVertexIndex(l);v=this.m_shape.getSegmentFromIndex(P),this.m_shape.setSegmentToIndex(P,null)}}let b=-1,w=-1;if(this.m_bHasSegmentParentage&&(b=f?this.m_shape.getSegmentParentage(a):this.m_shape.getSegmentParentage(l),w=this.m_shape.getSegmentParentage(u)),this.transferVertexData_(l,a),this.beforeRemoveVertex_(l,!0),this.m_shape.removeVertexInternal(l,!0),this.removeAngleSortInfo_(a),this.transferVertexData_(c,u),this.beforeRemoveVertex_(c,!0),this.m_shape.removeVertexInternal(c,!0),this.removeAngleSortInfo_(u),this.m_bHasSegmentParentage&&(this.m_shape.setSegmentParentageAndBreak(a,b,!0),this.m_shape.setSegmentParentageAndBreak(u,w,!0)),v){const S=this.m_shape.getVertexIndex(a);this.m_shape.setSegmentToIndex(S,v)}}return!0}cleanupSpikes_(){let e=!1;for(let s=this.m_shape.getFirstPath(this.m_geometry);s!==L;){const i=this.m_shape.getNextPath(s);let r=this.m_shape.getFirstVertex(s);for(let n=0,o=this.m_shape.getPathSize(s);n<o&&o>1;){this.progress_();const{v:a,bModified:l}=this.checkAndCleanupSpike_(s,r);if(a===L)break;l?(e=!0,r=a,n=0,o=this.m_shape.getPathSize(s)):(r=a,n++)}s=i}return e}checkAndCleanupSpike_(e,s){const i={v:L,bModified:!1};let r=this.m_shape.getPrevVertex(s),n=this.m_shape.getNextVertex(s),o=L,a=L;for(;this.m_shape.isEqualXY(r,n)&&(o=r,a=n,n!==s);)r=this.m_shape.getPrevVertex(r),n=this.m_shape.getNextVertex(n);if(o===L)return i.v=n,i;i.bModified=!0;for(let l=this.m_shape.getNextVertex(o);this.beforeRemoveVertex_(l,!1),l!==a;l=this.m_shape.getNextVertex(l));if(o===s)return this.m_polylineDegeneracies!==L?this.m_shape.movePath(this.m_polylineDegeneracies,L,e):this.m_shape.removePath(e),i.v=L,i;{const l=this.m_shape.peelALoopIntoAPath(o,a);this.m_polylineDegeneracies!==L?this.m_shape.movePath(this.m_polylineDegeneracies,L,l):this.m_shape.removePath(l)}return i.v=o,i}removeSpike_(e){let s=this.m_shape.getPrevVertex(e),i=this.m_shape.getNextVertex(e),r=L,n=L;for(;this.m_shape.isEqualXY(s,i)&&(r=s,n=i,i!==e);)s=this.m_shape.getPrevVertex(s),i=this.m_shape.getNextVertex(i);if(r===L)return!1;if(this.m_shape.peelALoop(r,n),this.m_bHasSegmentParentage&&(this.m_shape.setSegmentParentageBreakVertex(r,!0),this.m_shape.setSegmentParentageBreakVertex(n,!0)),this.removeAngleSortInfo_(r),this.m_polylineDegeneracies===L)for(let o=this.m_shape.getNextVertex(n);;){const a=this.m_shape.getNextVertex(o);if(this.removeAngleSortInfo_(o),this.beforeRemoveVertex_(o,!0),this.m_shape.setSegmentToIndex(this.m_shape.getVertexIndex(o),null),this.m_shape.removeVertexInternal(o,!1),o===n)break;o=a}else{for(let a=n;;){const l=this.m_shape.getNextVertex(a);if(this.removeAngleSortInfo_(a),this.beforeRemoveVertex_(a,!1),a=l,a===n)break}const o=[!1];this.m_shape.insertClosedPath(this.m_polylineDegeneracies,L,n,n,o)}return!0}fixOrphanVertices_(){let e=0;for(let r=this.m_sortedVertices.getFirst(this.m_sortedVertices.getFirstList());r!==-1;r=this.m_sortedVertices.getNext(r)){const n=this.m_sortedVertices.getData(r);this.m_shape.setPathToVertex(n,L)}let s=0;for(let r=this.m_shape.getFirstPath(this.m_geometry);r!==L;){const n=this.m_shape.getFirstVertex(r);if(n===L||this.m_shape.getPathFromVertex(n)!==L){const a=r;r=this.m_shape.getNextPath(r),this.m_shape.removePathOnly(a);continue}this.m_shape.setPathToVertex(n,r);let o=1;for(let a=this.m_shape.getNextVertex(n);a!==n;a=this.m_shape.getNextVertex(a))this.m_shape.setPathToVertex(a,r),o++;this.m_shape.setRingAreaValid(r,!1),this.m_shape.setPathSize(r,o),this.m_shape.setLastVertex(r,this.m_shape.getPrevVertex(n)),s+=o,e++,r=this.m_shape.getNextPath(r)}for(let r=this.m_sortedVertices.getFirst(this.m_sortedVertices.getFirstList());r!==-1;r=this.m_sortedVertices.getNext(r)){const n=this.m_sortedVertices.getData(r);if(this.m_shape.getPathFromVertex(n)!==L)continue;const o=[!1],a=this.m_shape.insertClosedPath(this.m_geometry,L,n,n,o);s+=this.m_shape.getPathSize(a),e++}this.m_shape.setGeometryPathCount(this.m_geometry,e),this.m_shape.setGeometryVertexCount(this.m_geometry,s);let i=0;for(let r=this.m_shape.getFirstGeometry();r!==L;r=this.m_shape.getNextGeometry(r))i+=this.m_shape.getPointCount(r);this.m_shape.setTotalPointCount(i)}getNextEdgeIndex_(e){if(e===-1)return-1;for(let s=0,i=this.m_bunchEdgeIndices.length-1;s<i;s++)if(e=(e+1)%this.m_bunchEdgeIndices.length,this.m_bunchEdgeIndices[e]!==-1)return e;return-1}getPrevEdgeIndex_(e){if(e===-1)return-1;for(let s=0,i=this.m_bunchEdgeIndices.length-1;s<i;s++)if(e=(this.m_bunchEdgeIndices.length+e-1)%this.m_bunchEdgeIndices.length,this.m_bunchEdgeIndices[e]!==-1)return e;return-1}transferVertexData_(e,s){const i=this.m_shape.getUserIndex(s,this.m_userIndexSortedIndexToVertex),r=this.m_shape.getUserIndex(s,this.m_userIndexSortedAngleIndexToVertex);this.m_shape.transferAllDataToTheVertex(e,s),this.m_shape.setUserIndex(s,this.m_userIndexSortedIndexToVertex,i),this.m_shape.setUserIndex(s,this.m_userIndexSortedAngleIndexToVertex,r)}removeAngleSortInfo_(e){const s=this.m_shape.getUserIndex(e,this.m_userIndexSortedAngleIndexToVertex);s!==-1&&(this.m_bunchEdgeIndices[s]=-1,this.m_shape.setUserIndex(e,this.m_userIndexSortedAngleIndexToVertex,-1))}progress_(e=!1){}}function Jl(t,e,s,i,r,n=!0){switch(fve(i)){case 0:break;case 1:ee("relation string length has to be 9 characters");break;default:ee("relation string")}if(n){const m=bit(i,t.getDimension(),e.getDimension());if(m!==0)return gd(t,e,s,m,r)}let o=0;if(typeof s=="number")o=s;else{const m=X.constructEmpty();t.queryEnvelope(m);const f=X.constructEmpty();e.queryEnvelope(f);const g=X.constructEmpty();g.setCoords({env2D:m}),g.mergeEnvelope2D(f),o=Eg(s,g,!1)}const a=Ure(t,o),l=Ure(e,o);if(a.isEmpty()||l.isEmpty())return vit(a,l,i);const u=a.getGeometryType(),c=l.getGeometryType();let h=!1;switch(u){case G.enumPolygon:switch(c){case G.enumPolygon:h=fit(a,l,o,i,r);break;case G.enumPolyline:h=Ore(a,l,o,i,r);break;case G.enumPoint:h=qre(a,l,o,i);break;case G.enumMultiPoint:h=Lre(a,l,o,i,r)}break;case G.enumPolyline:switch(c){case G.enumPolygon:h=Ore(l,a,o,D1(i),r);break;case G.enumPolyline:h=git(a,l,o,i,r);break;case G.enumPoint:h=Gre(a,l,o,i,r);break;case G.enumMultiPoint:h=Vre(a,l,o,i,r)}break;case G.enumPoint:switch(c){case G.enumPolygon:h=qre(l,a,o,D1(i));break;case G.enumPolyline:h=Gre(l,a,o,D1(i),r);break;case G.enumPoint:h=_it(a,l,o,i);break;case G.enumMultiPoint:h=zre(l,a,o,D1(i))}break;case G.enumMultiPoint:switch(c){case G.enumPolygon:h=Lre(l,a,o,D1(i),r);break;case G.enumPolyline:h=Vre(l,a,o,D1(i),r);break;case G.enumMultiPoint:h=yit(a,l,o,i,r);break;case G.enumPoint:h=zre(a,l,o,i)}break;default:h=!1}return h}function dit(t,e,s,i){const r=new ih;r.resetMatrix_(),r.setPredicates_("T*****F**"),r.setAreaAreaPredicates_();const n=X.constructEmpty(),o=X.constructEmpty();t.queryEnvelope(n),e.queryEnvelope(o);let a=!1;if(om(n,o,s)&&(r.areaAreaDisjointPredicates_(t,e),a=!0),a||Kt(t,e),a)return fo(r.m_matrix,r.m_scl);let l=new oi,u=l.addGeometry(t),c=l.addGeometry(e),h=null,m=0;if(t.hasNonLinearSegments()||e.hasNonLinearSegments()){h=new Ha;const b=ja(s,l.getEnvelope2D(i));m=Vc(b,0),Ol(l,b,s,12e3,h,null,i)}Ac(l,new Uo(s,0).add(m),i,!1,!1);const f=l.getGeometry(c).getBoundary();if(l.filterClosePoints(0,!0,!0,!1,L),_d(l,u,-1,!1,L,i),l.getPointCount(u)===0)return!1;_d(l,c,-1,!1,L,i),r.setEditShape_(l,i);const g=l.getPointCount(c)===0;if(!g){r.computeMatrixTopoGraphHalfEdges_(u,c),r.m_topoGraph.removeShape();const b=fo(r.m_matrix,r.m_scl);if(!b)return b}const v=l.getGeometry(u);return l=new oi,u=l.addGeometry(v),c=l.addGeometry(f),r.setEditShape_(l,i),r.m_predicateCount=0,r.resetMatrix_(),r.setPredicates_(g?"T*****F**":"******F**"),r.setAreaLinePredicates_(),r.computeMatrixTopoGraphHalfEdges_(u,c),r.m_topoGraph.removeShape(),fo(r.m_matrix,r.m_scl)}function pit(t,e,s,i){const r=new ih;r.resetMatrix_(),r.setPredicates_("T*****F**"),r.setAreaLinePredicates_();const n=X.constructEmpty(),o=X.constructEmpty();t.queryEnvelope(n),e.queryEnvelope(o);let a=!1;if(om(n,o,s)&&(r.areaLineDisjointPredicates_(t,e),a=!0),a||Kt(t,e),a)return fo(r.m_matrix,r.m_scl);const l=new oi,u=l.addGeometry(t),c=l.addGeometry(e);return r.setEditShapeCrackAndCluster_(l,new Uo(s,0),i),l.getPointCount(u)===0?!1:(r.computeMatrixTopoGraphHalfEdges_(u,c),r.m_topoGraph.removeShape(),fo(r.m_matrix,r.m_scl))}function fve(t){if(t.length!==9)return 1;for(let e=0;e<9;e++){const s=t[e];if(s!=="*"&&s!=="T"&&s!=="F"&&s!=="0"&&s!=="1"&&s!=="2")return 2}return 0}function fit(t,e,s,i,r){const n=new ih;n.resetMatrix_(),n.setPredicates_(i),n.setAreaAreaPredicates_();const o=X.constructEmpty(),a=X.constructEmpty();t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(om(o,a,s)&&(n.areaAreaDisjointPredicates_(t,e),l=!0),l||Kt(t,e),!l){const u=new oi,c=u.addGeometry(t),h=u.addGeometry(e);n.setEditShapeCrackAndCluster_(u,new Uo(s,0),r),n.computeMatrixTopoGraphHalfEdges_(c,h),n.m_topoGraph.removeShape()}return fo(n.m_matrix,n.m_scl)}function Ore(t,e,s,i,r){const n=new ih;n.resetMatrix_(),n.setPredicates_(i),n.setAreaLinePredicates_();const o=X.constructEmpty(),a=X.constructEmpty();t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(om(o,a,s)&&(n.areaLineDisjointPredicates_(t,e),l=!0),l||Kt(t,e),!l){const u=new oi,c=u.addGeometry(t),h=u.addGeometry(e);n.setEditShapeCrackAndCluster_(u,new Uo(s,0),r),n.m_clusterIndexB=n.m_topoGraph.createUserIndexForClusters(),uD(h,n.m_topoGraph,n.m_clusterIndexB),n.computeMatrixTopoGraphHalfEdges_(c,h),n.m_topoGraph.deleteUserIndexForClusters(n.m_clusterIndexB),n.m_topoGraph.removeShape()}return fo(n.m_matrix,n.m_scl)}function Lre(t,e,s,i,r){const n=new ih;n.resetMatrix_(),n.setPredicates_(i),n.setAreaPointPredicates_();const o=X.constructEmpty(),a=X.constructEmpty();t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(om(o,a,s)&&(n.areaPointDisjointPredicates_(t),l=!0),l||Kt(t,e),!l){const u=new oi,c=u.addGeometry(t),h=u.addGeometry(e);n.setEditShapeCrackAndCluster_(u,new Uo(s,0),r),n.computeMatrixTopoGraphClusters_(c,h),n.m_topoGraph.removeShape()}return fo(n.m_matrix,n.m_scl)}function git(t,e,s,i,r){const n=new ih;n.resetMatrix_(),n.setPredicates_(i),n.setLineLinePredicates_();const o=X.constructEmpty(),a=X.constructEmpty();t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(om(o,a,s)&&(n.lineLineDisjointPredicates_(t,e),l=!0),l||Kt(t,e),!l){const u=new oi,c=u.addGeometry(t),h=u.addGeometry(e);n.setEditShapeCrackAndCluster_(u,new Uo(s,0),r),n.m_clusterIndexA=n.m_topoGraph.createUserIndexForClusters(),n.m_clusterIndexB=n.m_topoGraph.createUserIndexForClusters(),uD(c,n.m_topoGraph,n.m_clusterIndexA),uD(h,n.m_topoGraph,n.m_clusterIndexB),n.computeMatrixTopoGraphHalfEdges_(c,h),n.m_topoGraph.deleteUserIndexForClusters(n.m_clusterIndexA),n.m_topoGraph.deleteUserIndexForClusters(n.m_clusterIndexB),n.m_topoGraph.removeShape()}return fo(n.m_matrix,n.m_scl)}function Vre(t,e,s,i,r){const n=new ih;n.resetMatrix_(),n.setPredicates_(i),n.setLinePointPredicates_();const o=X.constructEmpty(),a=X.constructEmpty();t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(om(o,a,s)&&(n.linePointDisjointPredicates_(t),l=!0),l||Kt(t,e),!l){const u=new oi,c=u.addGeometry(t),h=u.addGeometry(e);n.setEditShapeCrackAndCluster_(u,new Uo(s,0),r),n.m_clusterIndexA=n.m_topoGraph.createUserIndexForClusters(),uD(c,n.m_topoGraph,n.m_clusterIndexA),n.computeMatrixTopoGraphClusters_(c,h),n.m_topoGraph.deleteUserIndexForClusters(n.m_clusterIndexA),n.m_topoGraph.removeShape()}return fo(n.m_matrix,n.m_scl)}function yit(t,e,s,i,r){const n=new ih;n.resetMatrix_(),n.setPredicates_(i),n.setPointPointPredicates_();const o=new X,a=new X;t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(om(o,a,s)&&(n.pointPointDisjointPredicates_(),l=!0),!l){const u=new oi,c=u.addGeometry(t),h=u.addGeometry(e);n.setEditShapeCrackAndCluster_(u,new Uo(s,0),r),n.computeMatrixTopoGraphClusters_(c,h),n.m_topoGraph.removeShape()}return fo(n.m_matrix,n.m_scl)}function qre(t,e,s,i,r){const n=new ih;n.resetMatrix_(),n.setPredicates_(i),n.setAreaPointPredicates_();const o=X.constructEmpty();t.queryEnvelope(o);const a=e.getXY();let l=!1;if(vR(a,o,s)&&(n.areaPointDisjointPredicates_(t),l=!0),!l){const u=Bo(t,a,s);if(u===1)n.m_matrix[0]=0,n.m_matrix[2]=2,n.m_matrix[3]=-1,n.m_matrix[5]=1,n.m_matrix[6]=-1;else if(u===2)if(n.m_matrix[6]=-1,t.calculateArea2D()!==0)n.m_matrix[0]=-1,n.m_matrix[3]=0,n.m_matrix[2]=2,n.m_matrix[5]=1;else{n.m_matrix[0]=0,n.m_matrix[3]=-1,n.m_matrix[5]=-1;const c=X.constructEmpty();t.queryEnvelope(c),n.m_matrix[2]=c.height()||c.width()?1:-1}else n.areaPointDisjointPredicates_(t)}return fo(n.m_matrix,i)}function Gre(t,e,s,i,r){const n=new ih;n.resetMatrix_(),n.setPredicates_(i),n.setLinePointPredicates_();const o=X.constructEmpty();t.queryEnvelope(o);let a=!1;if(vR(e.getXY(),o,s)&&(n.linePointDisjointPredicates_(t),a=!0),!a){let l=null,u=!1,c=!1;if((n.m_performPredicates[0]||n.m_performPredicates[6])&&(gd(t,e,s,4,r)?(n.m_matrix[0]=-1,n.m_matrix[6]=0):(n.m_performPredicates[0]&&(l=Bc(t),c=!gd(l,e,s,4,r),u=!0,n.m_matrix[0]=c?-1:0),n.m_matrix[6]=-1)),n.m_performPredicates[3]&&(l!==null&&l.isEmpty()?n.m_matrix[3]=-1:(u||(l==null&&(l=Bc(t)),c=!gd(l,e,s,4,r),u=!0),n.m_matrix[3]=c?0:-1)),n.m_performPredicates[5])if(l!==null&&l.isEmpty())n.m_matrix[5]=-1;else if(u&&!c)n.m_matrix[5]=0;else{l===null&&(l=Bc(t));const h=gd(l,e,s,3,r);n.m_matrix[5]=h?-1:0}if(n.m_performPredicates[2])if(t.calculateLength2D()!==0)n.m_matrix[2]=1;else{const h=new pi({vd:t.getDescription()});h.addPoints(t,0,t.getPointCount());const m=gd(h,e,s,3,r);n.m_matrix[2]=m?-1:0}}return fo(n.m_matrix,n.m_scl)}function zre(t,e,s,i,r){const n=new ih;n.resetMatrix_(),n.setPredicates_(i),n.setPointPointPredicates_();const o=X.constructEmpty();t.queryEnvelope(o);const a=e.getXY(),l=new M;let u=!1;if(vR(a,o,s)&&(n.pointPointDisjointPredicates_(),u=!0),!u){let c=!1,h=!0;const m=s*s;for(let f=0;f<t.getPointCount()&&(t.queryXY(f,l),M.sqrDistance(l,a)<=m?c=!0:h=!1,!c||h);f++);c?(n.m_matrix[0]=0,n.m_matrix[2]=h?-1:0,n.m_matrix[6]=-1):(n.m_matrix[0]=-1,n.m_matrix[2]=0,n.m_matrix[6]=0)}return fo(n.m_matrix,i)}function _it(t,e,s,i,r){const n=t.getXY(),o=e.getXY(),a=Me(9,-1);return M.sqrDistance(n,o)<=s*s?a[0]=0:(a[2]=0,a[6]=0),a[8]=2,fo(a,i)}function fo(t,e){for(let s=0;s<9;s++)switch(e[s]){case"T":if(t[s]===-1)return!1;break;case"F":if(t[s]!==-1)return!1;break;case"0":if(t[s]!==0)return!1;break;case"1":if(t[s]!==1)return!1;break;case"2":if(t[s]!==2)return!1}return!0}function vit(t,e,s){const i=Me(9,-1);if(t.isEmpty()&&e.isEmpty())return fo(i,s);let r,n=!1;t.isEmpty()?(r=e,n=!0):r=t,i[0]=-1,i[1]=-1,i[3]=-1,i[4]=-1,i[6]=-1,i[7]=-1,i[8]=2;const o=r.getGeometryType();if(xt(o))if(o===G.enumPolygon)if(r.calculateArea2D()!==0)i[2]=2,i[5]=1;else{i[5]=-1;const a=X.constructEmpty();r.queryEnvelope(a),i[2]=a.height()||a.width()?1:0}else{const a=r.calculateLength2D()!==0;i[2]=a?1:0,i[5]=s_(r)?0:-1}else i[2]=0,i[5]=-1;return n&&gve(i),fo(i,s)}function bit(t,e,s){return xit(t)?3:wit(t)?4:Sit(t,e,s)?8:Eit(t,e,s)?16:Pit(t)?64:Cit(t)?1:Tit(t,e,s)?32:0}function xit(t){return t==="T*F**FFF*"}function wit(t){return t==="FF*FF****"}function Sit(t,e,s){return(e!==0||s!==0)&&(e===2&&s===2?t==="F***T****":(e===2||e===1)&&s===0&&t==="F**T*****")}function Eit(t,e,s){return e>s?t==="T*****T**":e===1&&s===1&&t==="0********"}function Cit(t){return t==="T*****FF*"}function Pit(t){return t==="T**FF*FF*"}function Tit(t,e,s){return e===s&&(e!==1?t==="T*T***T**":t==="1*T***T**")}function uD(t,e,s){const i=e.getGeometryID(t);for(let r=e.getFirstCluster();r!==L;r=e.getNextCluster(r)){if(!(e.getClusterParentage(r)&i))continue;const n=e.getClusterHalfEdge(r);if(n===L){e.setClusterUserIndex(r,s,0);continue}let o=n,a=0;do{const l=o;e.getHalfEdgeParentage(l)&i&&a++,o=e.getHalfEdgeNext(e.getHalfEdgeTwin(l))}while(o!==n);e.setClusterUserIndex(r,s,a)}}class ih{nullFunc(){return Ce("should not be called"),!1}constructor(){this.m_clusterIndexA=-1,this.m_clusterIndexB=-1,this.m_visitedIndex=-1,this.m_topoGraph=new Fl,this.m_matrix=Me(9,0),this.m_maxDim=Me(9,0),this.m_performPredicates=Me(9,!1),this.m_scl="",this.m_predicateCount=0,this.m_predicatesHalfEdge=this.nullFunc,this.m_predicatesCluster=this.nullFunc}resetMatrix_(){this.m_matrix.fill(-2),this.m_maxDim.fill(-2)}setPredicates_(e){this.m_scl=e;for(let s=0;s<9;s++)this.m_scl[s]!=="*"?(this.m_performPredicates[s]=!0,this.m_predicateCount++):this.m_performPredicates[s]=!1}setRemainingPredicatesToFalse_(){for(let e=0;e<9;e++)this.m_performPredicates[e]&&this.m_matrix[e]===-2&&(this.m_matrix[e]=-1,this.m_performPredicates[e]=!1)}isPredicateKnown_(e){return this.m_matrix[e]!==-2&&(this.m_matrix[e]===-1?(this.m_performPredicates[e]=!1,this.m_predicateCount--,!0):this.m_scl[e]!=="T"&&this.m_scl[e]!=="F"?!(this.m_matrix[e]<this.m_maxDim[e])&&(this.m_performPredicates[e]=!1,this.m_predicateCount--,!0):(this.m_performPredicates[e]=!1,this.m_predicateCount--,!0))}setAreaAreaPredicates_(){this.m_predicatesHalfEdge=this.areaAreaPredicates_,this.m_maxDim[0]=2,this.m_maxDim[1]=1,this.m_maxDim[2]=2,this.m_maxDim[3]=1,this.m_maxDim[4]=1,this.m_maxDim[5]=1,this.m_maxDim[6]=2,this.m_maxDim[7]=1,this.m_maxDim[8]=2,this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}setAreaLinePredicates_(){this.m_predicatesHalfEdge=this.areaLinePredicates_,this.m_predicatesCluster=this.areaPointPredicates_,this.m_maxDim[0]=1,this.m_maxDim[1]=0,this.m_maxDim[2]=2,this.m_maxDim[3]=1,this.m_maxDim[4]=0,this.m_maxDim[5]=1,this.m_maxDim[6]=1,this.m_maxDim[7]=0,this.m_maxDim[8]=2,this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}setLineLinePredicates_(){this.m_predicatesHalfEdge=this.lineLinePredicates_,this.m_predicatesCluster=this.linePointPredicates_,this.m_maxDim[0]=1,this.m_maxDim[1]=0,this.m_maxDim[2]=1,this.m_maxDim[3]=0,this.m_maxDim[4]=0,this.m_maxDim[5]=0,this.m_maxDim[6]=1,this.m_maxDim[7]=0,this.m_maxDim[8]=2,this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}setAreaPointPredicates_(){this.m_predicatesCluster=this.areaPointPredicates_,this.m_maxDim[0]=0,this.m_maxDim[1]=-1,this.m_maxDim[2]=2,this.m_maxDim[3]=0,this.m_maxDim[4]=-1,this.m_maxDim[5]=1,this.m_maxDim[6]=0,this.m_maxDim[7]=-1,this.m_maxDim[8]=2,this.m_performPredicates[1]&&(this.m_matrix[1]=-1,this.m_performPredicates[1]=!1,this.m_predicateCount--),this.m_performPredicates[4]&&(this.m_matrix[4]=-1,this.m_performPredicates[4]=!1,this.m_predicateCount--),this.m_performPredicates[7]&&(this.m_matrix[7]=-1,this.m_performPredicates[7]=!1,this.m_predicateCount--),this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}setLinePointPredicates_(){this.m_predicatesCluster=this.linePointPredicates_,this.m_maxDim[0]=0,this.m_maxDim[1]=-1,this.m_maxDim[2]=1,this.m_maxDim[3]=0,this.m_maxDim[4]=-1,this.m_maxDim[5]=0,this.m_maxDim[6]=0,this.m_maxDim[7]=-1,this.m_maxDim[8]=2,this.m_performPredicates[1]&&(this.m_matrix[1]=-1,this.m_performPredicates[1]=!1,this.m_predicateCount--),this.m_performPredicates[4]&&(this.m_matrix[4]=-1,this.m_performPredicates[4]=!1,this.m_predicateCount--),this.m_performPredicates[7]&&(this.m_matrix[7]=-1,this.m_performPredicates[7]=!1,this.m_predicateCount--),this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}setPointPointPredicates_(){this.m_predicatesCluster=this.pointPointPredicates_,this.m_maxDim[0]=0,this.m_maxDim[1]=-1,this.m_maxDim[2]=0,this.m_maxDim[3]=-1,this.m_maxDim[4]=-1,this.m_maxDim[5]=-1,this.m_maxDim[6]=0,this.m_maxDim[7]=-1,this.m_maxDim[8]=2,this.m_performPredicates[1]&&(this.m_matrix[1]=-1,this.m_performPredicates[1]=!1,this.m_predicateCount--),this.m_performPredicates[3]&&(this.m_matrix[3]=-1,this.m_performPredicates[3]=!1,this.m_predicateCount--),this.m_performPredicates[4]&&(this.m_matrix[4]=-1,this.m_performPredicates[4]=!1,this.m_predicateCount--),this.m_performPredicates[5]&&(this.m_matrix[5]=-1,this.m_performPredicates[5]=!1,this.m_predicateCount--),this.m_performPredicates[7]&&(this.m_matrix[7]=-1,this.m_performPredicates[7]=!1,this.m_predicateCount--),this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}areaAreaDisjointPredicates_(e,s){this.m_matrix[0]=-1,this.m_matrix[1]=-1,this.m_matrix[3]=-1,this.m_matrix[4]=-1,this.areaGeomContainsOrDisjointPredicates_(e,this.m_performPredicates[2]?2:-1,this.m_scl[2],this.m_performPredicates[5]?5:-1,this.m_scl[5]),this.areaGeomContainsOrDisjointPredicates_(s,this.m_performPredicates[6]?6:-1,this.m_scl[6],this.m_performPredicates[7]?7:-1,this.m_scl[7])}areaGeomContainsOrDisjointPredicates_(e,s,i,r,n){const o=s!==-1,a=r!==-1;if(o||a){if(!(i!=="T"&&i!=="F"&&o||n!=="T"&&n!=="F"&&a)||e.calculateArea2D()!==0)o&&(this.m_matrix[s]=2),a&&(this.m_matrix[r]=1);else if(a&&(this.m_matrix[r]=-1),o){const l=X.constructEmpty();e.queryEnvelope(l),this.m_matrix[s]=l.height()||l.width()?1:0}}}areaAreaContainsPredicates_(e){this.m_matrix[2]=2,this.m_matrix[3]=-1,this.m_matrix[4]=-1,this.m_matrix[5]=1,this.m_matrix[6]=-1,this.m_matrix[7]=-1,this.areaGeomContainsOrDisjointPredicates_(e,this.m_performPredicates[0]?0:-1,this.m_scl[0],this.m_performPredicates[1]?1:-1,this.m_scl[1])}areaAreaWithinPredicates_(e){this.areaAreaContainsPredicates_(e),gve(this.m_matrix)}areaLineDisjointPredicates_(e,s){if(this.m_matrix[0]=-1,this.m_matrix[1]=-1,this.m_matrix[3]=-1,this.m_matrix[4]=-1,this.m_performPredicates[6]){const i=this.m_scl[6],r=i==="T"||i==="F"||s.calculateLength2D()!==0;this.m_matrix[6]=r?1:0}if(this.m_performPredicates[7]){const i=s_(s);this.m_matrix[7]=i?0:-1}this.areaGeomContainsOrDisjointPredicates_(e,this.m_performPredicates[2]?2:-1,this.m_scl[2],this.m_performPredicates[5]?5:-1,this.m_scl[5])}areaLineContainsPredicates_(e,s){if(this.m_performPredicates[0]){const i=this.m_scl[0],r=i==="T"||i==="F"||s.calculateLength2D()!==0;this.m_matrix[0]=r?1:0}if(this.m_performPredicates[1]){const i=s_(s);this.m_matrix[1]=i?0:-1}this.m_matrix[2]=2,this.m_matrix[3]=-1,this.m_matrix[4]=-1,this.m_matrix[5]=1,this.m_matrix[6]=-1,this.m_matrix[7]=-1}areaPointDisjointPredicates_(e){this.m_matrix[0]=-1,this.m_matrix[3]=-1,this.m_matrix[6]=0,this.areaGeomContainsOrDisjointPredicates_(e,this.m_performPredicates[2]?2:-1,this.m_scl[2],this.m_performPredicates[5]?5:-1,this.m_scl[5])}areaPointContainsPredicates_(e){this.m_matrix[0]=0,this.m_matrix[2]=2,this.m_matrix[3]=-1,this.m_matrix[5]=1,this.m_matrix[6]=-1}lineLineDisjointPredicates_(e,s){if(this.m_matrix[0]=-1,this.m_matrix[1]=-1,this.m_matrix[3]=-1,this.m_matrix[4]=-1,this.m_performPredicates[2]){const i=this.m_scl[2],r=i==="T"||i==="F"||e.calculateLength2D()!==0;this.m_matrix[2]=r?1:0}if(this.m_performPredicates[5]){const i=s_(e);this.m_matrix[5]=i?0:-1}if(this.m_performPredicates[6]){const i=this.m_scl[6],r=i==="T"||i==="F"||s.calculateLength2D()!==0;this.m_matrix[6]=r?1:0}if(this.m_performPredicates[7]){const i=s_(s);this.m_matrix[7]=i?0:-1}}linePointDisjointPredicates_(e){if(this.m_matrix[0]=-1,this.m_matrix[3]=-1,this.m_performPredicates[2]){const s=this.m_scl[2],i=s==="T"||s==="F"||e.calculateLength2D()!==0;this.m_matrix[2]=i?1:0}if(this.m_performPredicates[5]){const s=s_(e);this.m_matrix[5]=s?0:-1}this.m_matrix[6]=0}pointPointDisjointPredicates_(){this.m_matrix[0]=-1,this.m_matrix[2]=0,this.m_matrix[6]=0}areaAreaPredicates_(e,s,i){let r=!0;if(this.m_performPredicates[0]){this.interiorAreaInteriorArea_(e,s,i);const n=this.isPredicateKnown_(0);r&&(r=n)}if(this.m_performPredicates[1]){this.interiorAreaBoundaryArea_(e,s,1);const n=this.isPredicateKnown_(1);r&&(r=n)}if(this.m_performPredicates[2]){this.interiorAreaExteriorArea_(e,s,i,2);const n=this.isPredicateKnown_(2);r&&(r=n)}if(this.m_performPredicates[3]){this.interiorAreaBoundaryArea_(e,i,3);const n=this.isPredicateKnown_(3);r&&(r=n)}if(this.m_performPredicates[4]){this.boundaryAreaBoundaryArea_(e,s,i);const n=this.isPredicateKnown_(4);r&&(r=n)}if(this.m_performPredicates[5]){this.boundaryAreaExteriorArea_(e,s,i,5);const n=this.isPredicateKnown_(5);r&&(r=n)}if(this.m_performPredicates[6]){this.interiorAreaExteriorArea_(e,i,s,6);const n=this.isPredicateKnown_(6);r&&(r=n)}if(this.m_performPredicates[7]){this.boundaryAreaExteriorArea_(e,i,s,7);const n=this.isPredicateKnown_(7);r&&(r=n)}return r}areaLinePredicates_(e,s,i){let r=!0;if(this.m_performPredicates[0]){this.interiorAreaInteriorLine_(e,s,i);const n=this.isPredicateKnown_(0);r&&(r=n)}if(this.m_performPredicates[1]){this.interiorAreaBoundaryLine_(e,s,i,this.m_clusterIndexB);const n=this.isPredicateKnown_(1);r&&(r=n)}if(this.m_performPredicates[2]){this.interiorAreaExteriorLine_(e,s,i);const n=this.isPredicateKnown_(2);r&&(r=n)}if(this.m_performPredicates[3]){this.boundaryAreaInteriorLine_(e,s,i,this.m_clusterIndexB);const n=this.isPredicateKnown_(3);r&&(r=n)}if(this.m_performPredicates[4]){this.boundaryAreaBoundaryLine_(e,s,i,this.m_clusterIndexB);const n=this.isPredicateKnown_(4);r&&(r=n)}if(this.m_performPredicates[5]){this.boundaryAreaExteriorLine_(e,s,i);const n=this.isPredicateKnown_(5);r&&(r=n)}if(this.m_performPredicates[6]){this.exteriorAreaInteriorLine_(e,s);const n=this.isPredicateKnown_(6);r&&(r=n)}if(this.m_performPredicates[7]){this.exteriorAreaBoundaryLine_(e,s,i,this.m_clusterIndexB);const n=this.isPredicateKnown_(7);r&&(r=n)}return r}lineLinePredicates_(e,s,i){let r=!0;if(this.m_performPredicates[0]){this.interiorLineInteriorLine_(e,s,i,this.m_clusterIndexA,this.m_clusterIndexB);const n=this.isPredicateKnown_(0);r&&(r=n)}if(this.m_performPredicates[1]){this.interiorLineBoundaryLine_(e,s,i,this.m_clusterIndexA,this.m_clusterIndexB,1);const n=this.isPredicateKnown_(1);r&&(r=n)}if(this.m_performPredicates[2]){this.interiorLineExteriorLine_(e,s,i,2);const n=this.isPredicateKnown_(2);r&&(r=n)}if(this.m_performPredicates[3]){this.interiorLineBoundaryLine_(e,i,s,this.m_clusterIndexB,this.m_clusterIndexA,3);const n=this.isPredicateKnown_(3);r&&(r=n)}if(this.m_performPredicates[4]){this.boundaryLineBoundaryLine_(e,s,i,this.m_clusterIndexA,this.m_clusterIndexB);const n=this.isPredicateKnown_(4);r&&(r=n)}if(this.m_performPredicates[5]){this.boundaryLineExteriorLine_(e,s,i,this.m_clusterIndexA,5);const n=this.isPredicateKnown_(5);r&&(r=n)}if(this.m_performPredicates[6]){this.interiorLineExteriorLine_(e,i,s,6);const n=this.isPredicateKnown_(6);r&&(r=n)}if(this.m_performPredicates[7]){this.boundaryLineExteriorLine_(e,i,s,this.m_clusterIndexB,7);const n=this.isPredicateKnown_(7);r&&(r=n)}return r}areaPointPredicates_(e,s,i){let r=!0;if(this.m_performPredicates[0]){this.interiorAreaInteriorPoint_(e,s);const n=this.isPredicateKnown_(0);r&&(r=n)}if(this.m_performPredicates[2]){this.interiorAreaExteriorPoint_(e,s);const n=this.isPredicateKnown_(2);r&&(r=n)}if(this.m_performPredicates[3]){this.boundaryAreaInteriorPoint_(e,s,i);const n=this.isPredicateKnown_(3);r&&(r=n)}if(this.m_performPredicates[5]){this.boundaryAreaExteriorPoint_(e,s);const n=this.isPredicateKnown_(5);r&&(r=n)}if(this.m_performPredicates[6]){this.exteriorAreaInteriorPoint_(e,s);const n=this.isPredicateKnown_(6);r&&(r=n)}return r}linePointPredicates_(e,s,i){let r=!0;if(this.m_performPredicates[0]){this.interiorLineInteriorPoint_(e,s,i,this.m_clusterIndexA);const n=this.isPredicateKnown_(0);r&&(r=n)}if(this.m_performPredicates[2]){this.interiorLineExteriorPoint_(e,s,i,this.m_clusterIndexA);const n=this.isPredicateKnown_(2);r&&(r=n)}if(this.m_performPredicates[3]){this.boundaryLineInteriorPoint_(e,s,i,this.m_clusterIndexA);const n=this.isPredicateKnown_(3);r&&(r=n)}if(this.m_performPredicates[5]){this.boundaryLineExteriorPoint_(e,s,i,this.m_clusterIndexA);const n=this.isPredicateKnown_(5);r&&(r=n)}if(this.m_performPredicates[6]){this.exteriorLineInteriorPoint_(e,s,i);const n=this.isPredicateKnown_(6);r&&(r=n)}return r}pointPointPredicates_(e,s,i){let r=!0;if(this.m_performPredicates[0]){this.interiorPointInteriorPoint_(e,s,i);const n=this.isPredicateKnown_(0);r&&(r=n)}if(this.m_performPredicates[2]){this.interiorPointExteriorPoint_(e,s,i,2);const n=this.isPredicateKnown_(2);r&&(r=n)}if(this.m_performPredicates[6]){this.interiorPointExteriorPoint_(e,i,s,6);const n=this.isPredicateKnown_(6);r&&(r=n)}return r}interiorAreaInteriorArea_(e,s,i){if(this.m_matrix[0]===2)return;const r=this.m_topoGraph.getHalfEdgeFaceParentage(e);r&s&&r&i&&(this.m_matrix[0]=2)}interiorAreaBoundaryArea_(e,s,i){if(this.m_matrix[i]===1)return;const r=this.m_topoGraph.getHalfEdgeFaceParentage(e),n=this.m_topoGraph.getHalfEdgeFaceParentage(this.m_topoGraph.getHalfEdgeTwin(e));r&s&&n&s&&(this.m_matrix[i]=1)}interiorAreaExteriorArea_(e,s,i,r){if(this.m_matrix[r]===2)return;const n=this.m_topoGraph.getHalfEdgeFaceParentage(e);n&s&&!(n&i)&&(this.m_matrix[r]=2)}boundaryAreaBoundaryArea_(e,s,i){if(this.m_matrix[4]===1)return;const r=this.m_topoGraph.getHalfEdgeParentage(e);if(r&s&&r&i)this.m_matrix[4]=1;else if(this.m_matrix[4]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const n=this.m_topoGraph.getHalfEdgeTo(e),o=this.m_topoGraph.getClusterParentage(n);if(o&s&&o&i)return void(this.m_matrix[4]=0)}}boundaryAreaExteriorArea_(e,s,i,r){if(this.m_matrix[r]===1)return;const n=this.m_topoGraph.getHalfEdgeFaceParentage(e),o=this.m_topoGraph.getHalfEdgeFaceParentage(this.m_topoGraph.getHalfEdgeTwin(e));n&i||o&i||(this.m_matrix[r]=1)}interiorAreaInteriorLine_(e,s,i){if(this.m_matrix[0]===1)return;const r=this.m_topoGraph.getHalfEdgeFaceParentage(e),n=this.m_topoGraph.getHalfEdgeFaceParentage(this.m_topoGraph.getHalfEdgeTwin(e));r&s&&n&s&&(this.m_matrix[0]=1)}interiorAreaBoundaryLine_(e,s,i,r){if(this.m_matrix[1]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const n=this.m_topoGraph.getHalfEdgeTo(e),o=this.m_topoGraph.getClusterParentage(n);if(!(o&s)&&this.m_topoGraph.getHalfEdgeFaceParentage(e)&s){const a=this.m_topoGraph.getClusterUserIndex(n,r);if(o&i&&a%2!=0)return void(this.m_matrix[1]=0)}}}interiorAreaExteriorLine_(e,s,i){this.m_matrix[2]!==2&&this.m_topoGraph.getHalfEdgeParentage(e)&s&&(this.m_matrix[2]=2)}boundaryAreaInteriorLine_(e,s,i,r){if(this.m_matrix[3]===1)return;const n=this.m_topoGraph.getHalfEdgeParentage(e);if(n&s&&n&i)this.m_matrix[3]=1;else if(this.m_matrix[3]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const o=this.m_topoGraph.getHalfEdgeTo(e),a=this.m_topoGraph.getClusterParentage(o);if(a&s){const l=this.m_topoGraph.getClusterUserIndex(o,r);if(a&i&&l%2==0)return void(this.m_matrix[3]=0)}}}boundaryAreaBoundaryLine_(e,s,i,r){if(this.m_matrix[4]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const n=this.m_topoGraph.getHalfEdgeTo(e),o=this.m_topoGraph.getClusterParentage(n);if(o&s){const a=this.m_topoGraph.getClusterUserIndex(n,r);if(o&i&&a%2!=0)return void(this.m_matrix[4]=0)}}}boundaryAreaExteriorLine_(e,s,i){if(this.m_matrix[5]===1)return;const r=this.m_topoGraph.getHalfEdgeParentage(e);r&s&&!(r&i)&&(this.m_matrix[5]=1)}exteriorAreaInteriorLine_(e,s){if(this.m_matrix[6]===1)return;const i=this.m_topoGraph.getHalfEdgeFaceParentage(e),r=this.m_topoGraph.getHalfEdgeFaceParentage(this.m_topoGraph.getHalfEdgeTwin(e));i&s||r&s||(this.m_matrix[6]=1)}exteriorAreaBoundaryLine_(e,s,i,r){if(this.m_matrix[7]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const n=this.m_topoGraph.getHalfEdgeTo(e),o=this.m_topoGraph.getClusterParentage(n);if(!(o&s)&&!(this.m_topoGraph.getHalfEdgeFaceParentage(e)&s)){const a=this.m_topoGraph.getClusterUserIndex(n,r);if(o&i&&a%2!=0)return void(this.m_matrix[7]=0)}}}interiorLineInteriorLine_(e,s,i,r,n){if(this.m_matrix[0]===1)return;const o=this.m_topoGraph.getHalfEdgeParentage(e);if(o&s&&o&i)this.m_matrix[0]=1;else if(this.m_matrix[0]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const a=this.m_topoGraph.getHalfEdgeTo(e),l=this.m_topoGraph.getClusterParentage(a);if(l&s&&l&i){const u=this.m_topoGraph.getClusterUserIndex(a,r),c=this.m_topoGraph.getClusterUserIndex(a,n);if(u%2==0&&c%2==0)return void(this.m_matrix[0]=0)}}}interiorLineBoundaryLine_(e,s,i,r,n,o){if(this.m_matrix[o]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const a=this.m_topoGraph.getHalfEdgeTo(e),l=this.m_topoGraph.getClusterParentage(a);if(l&s&&l&i){const u=this.m_topoGraph.getClusterUserIndex(a,r),c=this.m_topoGraph.getClusterUserIndex(a,n);if(u%2==0&&c%2!=0)return void(this.m_matrix[o]=0)}}}interiorLineExteriorLine_(e,s,i,r){if(this.m_matrix[r]===1)return;const n=this.m_topoGraph.getHalfEdgeParentage(e);n&s&&!(n&i)&&(this.m_matrix[r]=1)}boundaryLineBoundaryLine_(e,s,i,r,n){if(this.m_matrix[4]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const o=this.m_topoGraph.getHalfEdgeTo(e),a=this.m_topoGraph.getClusterParentage(o);if(a&s&&a&i){const l=this.m_topoGraph.getClusterUserIndex(o,r),u=this.m_topoGraph.getClusterUserIndex(o,n);if(l%2!=0&&u%2!=0)return void(this.m_matrix[4]=0)}}}boundaryLineExteriorLine_(e,s,i,r,n){if(this.m_matrix[n]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const o=this.m_topoGraph.getHalfEdgeTo(e);if(!(this.m_topoGraph.getClusterParentage(o)&i)&&this.m_topoGraph.getClusterUserIndex(o,r)%2!=0)return void(this.m_matrix[n]=0)}}interiorAreaInteriorPoint_(e,s){if(this.m_matrix[0]!==0&&!(this.m_topoGraph.getClusterParentage(e)&s)){const i=this.m_topoGraph.getClusterChain(e);if(this.m_topoGraph.getChainParentage(i)&s)return void(this.m_matrix[0]=0)}}interiorAreaExteriorPoint_(e,s){this.m_matrix[2]!==2&&this.m_topoGraph.getClusterParentage(e)&s&&(this.m_matrix[2]=2)}boundaryAreaInteriorPoint_(e,s,i){if(this.m_matrix[3]===0)return;const r=this.m_topoGraph.getClusterParentage(e);r&s&&r&i&&(this.m_matrix[3]=0)}boundaryAreaExteriorPoint_(e,s){this.m_matrix[5]!==1&&this.m_topoGraph.getClusterParentage(e)&s&&(this.m_matrix[5]=1)}exteriorAreaInteriorPoint_(e,s){if(this.m_matrix[6]!==0&&!(this.m_topoGraph.getClusterParentage(e)&s)){const i=this.m_topoGraph.getClusterChain(e);if(!(this.m_topoGraph.getChainParentage(i)&s))return void(this.m_matrix[6]=0)}}interiorLineInteriorPoint_(e,s,i,r){if(this.m_matrix[0]===0)return;const n=this.m_topoGraph.getClusterParentage(e);if(n&s&&n&i&&this.m_topoGraph.getClusterUserIndex(e,r)%2==0)return void(this.m_matrix[0]=0)}interiorLineExteriorPoint_(e,s,i,r){if(this.m_matrix[2]!==1)if(this.m_topoGraph.getClusterHalfEdge(e)===-1){if(this.m_matrix[2]!==0&&!(this.m_topoGraph.getClusterParentage(e)&i))return void(this.m_matrix[2]=0)}else this.m_matrix[2]=1}boundaryLineInteriorPoint_(e,s,i,r){if(this.m_matrix[3]===0)return;const n=this.m_topoGraph.getClusterParentage(e);if(n&s&&n&i&&this.m_topoGraph.getClusterUserIndex(e,r)%2!=0)return void(this.m_matrix[3]=0)}boundaryLineExteriorPoint_(e,s,i,r){if(this.m_matrix[5]===0)return;const n=this.m_topoGraph.getClusterParentage(e);if(n&s&&!(n&i)&&this.m_topoGraph.getClusterUserIndex(e,r)%2!=0)return void(this.m_matrix[5]=0)}exteriorLineInteriorPoint_(e,s,i){if(this.m_matrix[6]===0)return;const r=this.m_topoGraph.getClusterParentage(e);r&s||!(r&i)||(this.m_matrix[6]=0)}interiorPointInteriorPoint_(e,s,i){if(this.m_matrix[0]===0)return;const r=this.m_topoGraph.getClusterParentage(e);r&s&&r&i&&(this.m_matrix[0]=0)}interiorPointExteriorPoint_(e,s,i,r){if(this.m_matrix[r]===0)return;const n=this.m_topoGraph.getClusterParentage(e);!(n&s)||n&i||(this.m_matrix[r]=0)}computeMatrixTopoGraphHalfEdges_(e,s){let i=!1;const r=this.m_topoGraph.getGeometryID(e),n=this.m_topoGraph.getGeometryID(s);this.m_visitedIndex=this.m_topoGraph.createUserIndexForHalfEdges();for(let o=this.m_topoGraph.getFirstCluster();o!==L;o=this.m_topoGraph.getNextCluster(o)){const a=this.m_topoGraph.getClusterHalfEdge(o);if(a===L){if(this.m_predicatesCluster!==null&&(i=this.m_predicatesCluster(o,r,n),i))break;continue}let l=a;do{let u=l;if(this.m_topoGraph.getHalfEdgeUserIndex(u,this.m_visitedIndex)!==1)do{if(i=this.m_predicatesHalfEdge(u,r,n),i)break;this.m_topoGraph.setHalfEdgeUserIndex(u,this.m_visitedIndex,1),u=this.m_topoGraph.getHalfEdgeNext(u)}while(u!==l&&!i);if(i)break;l=this.m_topoGraph.getHalfEdgeNext(this.m_topoGraph.getHalfEdgeTwin(u))}while(l!==a);if(i)break}i||this.setRemainingPredicatesToFalse_(),this.m_topoGraph.deleteUserIndexForHalfEdges(this.m_visitedIndex)}computeMatrixTopoGraphClusters_(e,s){let i=!1;const r=this.m_topoGraph.getGeometryID(e),n=this.m_topoGraph.getGeometryID(s);for(let o=this.m_topoGraph.getFirstCluster();o!==L&&(i=this.m_predicatesCluster(o,r,n),!i);o=this.m_topoGraph.getNextCluster(o));i||this.setRemainingPredicatesToFalse_()}setEditShape_(e,s){this.m_topoGraph.setEditShape(e,s)}setEditShapeCrackAndCluster_(e,s,i){let r=0;if(e.hasCurves()){const n=new Ha,o=e.getEnvelope2D(i),a=ja(s.total(),o);r=Vc(a,0),Ol(e,a,s.total(),12e3,n,null,i),n.clearStitcher(e)}Ac(e,s.add(r),i,!1,!1),e.filterClosePoints(0,!0,!0,!1,L);for(let n=e.getFirstGeometry();n!==L;n=e.getNextGeometry(n))e.getGeometryType(n)===G.enumPolygon&&_d(e,n,-1,!1,L,i);this.setEditShape_(e,i)}}function gve(t){const e=t[1],s=t[2],i=t[5];t[1]=t[3],t[2]=t[6],t[5]=t[7],t[3]=e,t[6]=s,t[7]=i}function Ure(t,e,s){const i=t.getGeometryType();if(zi(i)){const r=new qt({vd:t.getDescription()});return r.addSegment(t,!0),r}if(i===G.enumEnvelope){const r=t,n=X.constructEmpty();if(t.queryEnvelope(n),n.height()<=e&&n.width()<=e){const a=new nt({vd:t.getDescription()});return r.getCenter(a),a}if(n.height()<=e||n.width()<=e){const a=new qt({vd:t.getDescription()}),l=new nt;return r.queryCornerByVal(0,l),a.startPathPoint(l),r.queryCornerByVal(2,l),a.lineToPoint(l),a}const o=new wt({vd:t.getDescription()});return o.addEnvelope(r,!1),o}return t}function D1(t){return`${t[0]}${t[3]}${t[6]}${t[1]}${t[4]}${t[7]}${t[2]}${t[5]}${t[8]}`}class al{nullFunc(){return Ce("should not be called"),!1}constructor(e,s,i,r=!1){this.m_bDone=!1,this.m_tolerance=0,this.m_elementHandle=-1,this.m_query=X.constructEmpty(),this.m_envInter=X.constructEmpty(),this.m_quadTree=null,this.m_intersector=null,this.m_function=this.nullFunc;const n=e.getAccelerators();let o=null;n!=null&&(o=r?n.getQuadTreeForPaths():n.getQuadTree());const a=s.getAccelerators();let l=null;if(a!=null&&(l=r?a.getQuadTreeForPaths():a.getQuadTree()),o===null&&l===null&&!r){const u=e.getPointCount(),c=s.getPointCount();if(u>10&&c>10){const h=X.constructEmpty(),m=X.constructEmpty(),f=X.constructEmpty();e.queryLooseEnvelope(h),s.queryLooseEnvelope(m),h.inflateCoords(i,i),m.inflateCoords(i,i),f.setCoords({env2D:h}),f.intersect(m),u>=c?o=xt(e.getGeometryType())?Lb(e,f):xie(e,f):l=xt(s.getGeometryType())?Lb(s,f):xie(s,f)}}this.construct_(e,o,s,l,i,r)}next(){if(this.m_bQuadTree){if(this.m_bDone)return!1;for(;this.m_function(););return!this.m_bDone}return!!this.m_intersector&&this.m_intersector.next()}getRedElement(){return this.m_bQuadTree?this.m_bSwapElements?this.m_quadTree.getElement(this.m_elementHandle):xt(this.m_queryType)?this.m_bPaths?this.m_pathIndex:this.m_segIter.getStartPointIndex():this.m_pointIndex:this.m_bSwapElements?this.m_intersector.getBlueElement(this.m_intersector.getHandleB()):this.m_intersector.getRedElement(this.m_intersector.getHandleA())}getBlueElement(){return this.m_bQuadTree?this.m_bSwapElements?xt(this.m_queryType)?this.m_bPaths?this.m_pathIndex:this.m_segIter.getStartPointIndex():this.m_pointIndex:this.m_quadTree.getElement(this.m_elementHandle):this.m_bSwapElements?this.m_intersector.getRedElement(this.m_intersector.getHandleA()):this.m_intersector.getBlueElement(this.m_intersector.getHandleB())}getRedEnvelope(){return this.m_bPaths||Us(""),this.m_bQuadTree?this.m_bSwapElements?this.m_quadTree.getElementExtent(this.m_elementHandle):this.m_query:this.m_bSwapElements?this.m_intersector.getBlueEnvelope(this.m_intersector.getHandleB()):this.m_intersector.getRedEnvelope(this.m_intersector.getHandleA())}getBlueEnvelope(){return this.m_bPaths||Us(""),this.m_bQuadTree?this.m_bSwapElements?this.m_query:this.m_quadTree.getElementExtent(this.m_elementHandle):this.m_bSwapElements?this.m_intersector.getRedEnvelope(this.m_intersector.getHandleA()):this.m_intersector.getBlueEnvelope(this.m_intersector.getHandleB())}construct_(e,s,i,r,n,o){const a=X.constructEmpty(),l=X.constructEmpty();e.queryLooseEnvelope(a),i.queryLooseEnvelope(l),a.inflateCoords(n,n),l.inflateCoords(n,n),this.m_envInter.setCoords({env2D:a}),this.m_envInter.intersect(l),this.m_multiVertexImplA=e,this.m_multiVertexImplB=i;const u=e.getGeometryType(),c=i.getGeometryType();this.m_bPaths=o,this.m_pathIndex=-1,this.m_pointIndex=-1,this.m_bSwapElements=!1,this.m_queryType=G.enumUnknown,this.m_bQuadTree=!1,s!==null&&(this.m_bDone=!1,this.m_tolerance=n,this.m_quadTree=s,this.m_qtIter=this.m_quadTree.getIteratorForQT(),this.m_bQuadTree=!0,this.m_bSwapElements=!0,xt(c)?(this.m_queryType=c,this.m_function=this.nextPath_,o?this.m_pathIndex=i.getPathCount():this.m_segIter=i.querySegmentIterator()):(this.m_queryType=c,this.m_function=this.nextPoint_,this.m_pointIndex=i.getPointCount())),this.m_bQuadTree||r!==null&&(this.m_bDone=!1,this.m_tolerance=n,this.m_quadTree=r,this.m_qtIter=this.m_quadTree.getIteratorForQT(),this.m_bQuadTree=!0,this.m_bSwapElements=!1,xt(u)?(this.m_queryType=u,this.m_function=this.nextPath_,o?this.m_pathIndex=e.getPathCount():this.m_segIter=e.querySegmentIterator()):(this.m_queryType=u,this.m_function=this.nextPoint_,this.m_pointIndex=e.getPointCount())),this.m_bQuadTree||(o&&xt(u)&&xt(c)?this.m_intersector=lKe(e,i,n):xt(u)&&xt(c)?(this.m_intersector=aKe(e,i,n),this.m_bSwapElements=!1):xt(u)&&!xt(c)?(this.m_intersector=bie(e,i,n),this.m_bSwapElements=!1):!xt(u)&&xt(c)?(this.m_intersector=bie(i,e,n),this.m_bSwapElements=!0):(this.m_intersector=uKe(e,i,n),this.m_bSwapElements=!1))}nextPath_(){return this.m_bPaths?--this.m_pathIndex==-1?(this.m_bDone=!0,!1):(this.m_bSwapElements?this.m_multiVertexImplB.queryPathEnvelope(this.m_pathIndex,this.m_query):this.m_multiVertexImplA.queryPathEnvelope(this.m_pathIndex,this.m_query),this.m_qtIter.resetIterator(this.m_query,this.m_tolerance),this.m_function=this.iterate_,!0):this.m_segIter.nextPath()?(this.m_function=this.nextSegment_,!0):(this.m_bDone=!0,!1)}nextSegment_(){if(!this.m_segIter.hasNextSegment())return this.m_function=this.nextPath_,!0;const e=this.m_segIter.nextSegment(),s=new X;return e.queryLooseEnvelope(s),!s.isIntersecting(this.m_envInter)||(this.m_qtIter.resetIterator(e,this.m_tolerance),this.m_function=this.iterate_,!0)}nextPoint_(){if(--this.m_pointIndex==-1)return this.m_bDone=!0,!1;const e=new M;if(this.m_bSwapElements){const s=this.m_multiVertexImplB.getXY(this.m_pointIndex);e.setCoordsPoint2D(s)}else{const s=this.m_multiVertexImplA.getXY(this.m_pointIndex);e.setCoordsPoint2D(s)}return!this.m_envInter.contains(e)||(this.m_qtIter.resetIterator(X.construct(e.x,e.y,e.x,e.y),this.m_tolerance),this.m_function=this.iterate_,!0)}iterate_(){return this.m_elementHandle=this.m_qtIter.next(),this.m_elementHandle===-1&&(xt(this.m_queryType)?(this.m_function=this.m_bPaths?this.nextPath_:this.nextSegment_,!0):(this.m_function=this.nextPoint_,!0))}}function vL(t){return t===2?1:t===1?2:t===128?64:t===64?128:t}function Iit(t,e,s){let i;if(t instanceof Bd||t===null){const r=X.constructEmpty();r.setCoords({pt:e}),r.mergeEnvelope2D(s),i=Eg(t,r,!1)}else i=t;return i}function yve(t,e,s){let i;if(t instanceof Bd||t===null){const r=X.constructEmpty();r.setCoords({env2D:e}),r.mergeEnvelope2D(s),i=Eg(t,r,!1)}else i=t;return i}function gd(t,e,s,i,r){if(t.isEmpty()||e.isEmpty())return i===4;Nd(t),Nd(e);let n=t.getGeometryType(),o=e.getGeometryType();if(n===G.enumEnvelope){if(o===G.enumEnvelope)return Mit(t,e,s,i);if(o===G.enumPoint)return Bre(e,t,s,vL(i))}else if(n===G.enumPoint){if(o===G.enumEnvelope)return Bre(t,e,s,i);if(o===G.enumPoint)return Ait(t,e,s,i)}const a=X.constructEmpty();t.queryEnvelope(a);const l=X.constructEmpty();e.queryEnvelope(l);const u=yve(s,a,l);if(om(a,l,u))return i===4;let c=!1,h=null,m=null,f=null,g=null;switch(zi(n)?(h=new qt({vd:t.getDescription()}),h.addSegment(t,!0),f=h,n=G.enumPolyline):f=t,zi(o)?(m=new qt({vd:e.getDescription()}),m.addSegment(e,!0),g=m,o=G.enumPolyline):g=e,n!==G.enumEnvelope&&o!==G.enumEnvelope?(f.getDimension()<g.getDimension()||n===G.enumPoint&&o===G.enumMultiPoint)&&(i=vL(i)):n!==G.enumPolygon&&o!==G.enumEnvelope&&(i=vL(i)),n){case G.enumPolygon:switch(o){case G.enumPolygon:c=Nit(f,g,u,i,r);break;case G.enumPolyline:c=jre(f,g,u,i,r);break;case G.enumPoint:c=Hre(f,g,u,i);break;case G.enumMultiPoint:c=Yre(f,g,u,i);break;case G.enumEnvelope:c=Xre(f,g,u,i,r)}break;case G.enumPolyline:switch(o){case G.enumPolygon:c=jre(g,f,u,i,r);break;case G.enumPolyline:c=Dit(f,g,u,i,r);break;case G.enumPoint:c=Wre(f,g,u,i);break;case G.enumMultiPoint:c=Zre(f,g,u,i);break;case G.enumEnvelope:c=Qre(f,g,u,i,r)}break;case G.enumPoint:switch(o){case G.enumPolygon:c=Hre(g,f,u,i);break;case G.enumPolyline:c=Wre(g,f,u,i);break;case G.enumMultiPoint:c=Jre(g,f,u,i)}break;case G.enumMultiPoint:switch(o){case G.enumPolygon:c=Yre(g,f,u,i);break;case G.enumPolyline:c=Zre(g,f,u,i);break;case G.enumMultiPoint:c=$it(f,g,u,i);break;case G.enumPoint:c=Jre(f,g,u,i);break;case G.enumEnvelope:c=Kre(f,g,u,i)}break;case G.enumEnvelope:switch(o){case G.enumPolygon:c=Xre(g,f,u,i,r);break;case G.enumPolyline:c=Qre(g,f,u,i,r);break;case G.enumMultiPoint:c=Kre(g,f,u,i)}}return c}function Mit(t,e,s,i,r){if(t.isEmpty()||e.isEmpty())return i===4;const n=X.constructEmpty();t.queryEnvelope(n);const o=X.constructEmpty();e.queryEnvelope(o);const a=yve(s,n,o);switch(i){case 4:return om(n,o,a);case 2:return gM(o,n,a,!1);case 128:return gM(o,n,a,!0);case 1:return gM(n,o,a,!1);case 64:return gM(n,o,a,!0);case 3:return Ud(n,o,a);case 8:return Prt(n,o,a);case 32:return Trt(n,o,a);case 16:return!1}return!1}function Bre(t,e,s,i,r){if(t.isEmpty()||e.isEmpty())return i===4;const n=t.getXY(),o=X.constructEmpty();e.queryEnvelope(o);const a=Iit(s,n,o);switch(i){case 4:return vR(n,o,a);case 2:case 128:return Crt(n,o,a);case 1:case 64:return!1;case 3:return Srt(n,o,a);case 8:return Ert(n,o,a)}return!1}function Ait(t,e,s,i,r){if(t.isEmpty()||e.isEmpty())return i===4;const n=t.getXY(),o=e.getXY();let a;if(s instanceof Bd||s===null){const l=X.constructEmpty();l.setCoords({pt:n}),l.merge(o),a=Eg(s,l,!1)}else a=s;switch(i){case 4:return wrt(n,o,a);case 2:case 128:return une(o,n,a);case 1:case 64:return une(n,o,a);case 3:return wve(n,o,a)}return!1}function om(t,e,s){const i=X.constructEmpty();return i.setCoords({env2D:e}),i.inflateCoords(s,s),!t.isIntersecting(i)}function Kt(t,e,s,i=!1){const r=t.getGeometryType(),n=e.getGeometryType();if(zo(r)){const o=t.getImpl().getAccelerators();if(o!==null){const a=o.getRasterizedGeometry();F(a===null)}}if(zo(n)){const o=e.getImpl().getAccelerators();if(o!==null){const a=o.getRasterizedGeometry();F(a===null)}}return 0}function vR(t,e,s,i){const r=X.constructEmpty();return r.setCoords({env2D:e}),r.inflateCoords(s,s),!r.contains(t)}function Nit(t,e,s,i,r){switch(i){case 4:return Rit(t,e,s);case 2:return ene(e,t,s,r);case 128:return tne(e,t,s);case 1:return ene(t,e,s,r);case 64:return tne(t,e,s);case 3:return _ve(t,e,s,r);case 8:return kit(t,e,s);case 32:return Fit(t,e,s,r)}return!1}function jre(t,e,s,i,r){switch(i){case 4:return Oit(t,e,s);case 1:return Vit(t,e,s,r);case 64:return qit(t,e,s);case 8:return vve(t,e,s,r);case 16:return Lit(t,e,s)}return!1}function Hre(t,e,s,i,r){switch(i){case 4:return Git(t,e,s);case 1:case 64:return Uit(t,e,s);case 8:return zit(t,e,s)}return!1}function Yre(t,e,s,i,r){switch(i){case 4:return Bit(t,e,s);case 1:return sne(t,e,s,!1);case 64:return sne(t,e,s,!0);case 8:return jit(t,e,s);case 16:return Hit(t,e,s)}return!1}function Xre(t,e,s,i,r){if(Xit(t,e,s))return i===4;if(i===4)return!1;switch(i){case 2:return ine(t,e,s,!1);case 128:return ine(t,e,s,!0);case 1:return rne(t,e,s,!1,r);case 64:return rne(t,e,s,!0,r);case 3:return Yit(t,e,s,r);case 8:return Wit(t,e,s,r);case 32:return Zit(t,e,s,r);case 16:return!1}return!1}function Dit(t,e,s,i,r){switch(i){case 4:return Jit(t,e,s);case 2:return nne(e,t,s,r);case 128:return one(e,t,s,r);case 1:return nne(t,e,s,r);case 64:return one(t,e,s,r);case 3:return Qit(t,e,s,r);case 8:return Kit(t,e,s,r);case 32:return trt(t,e,s,r);case 16:return ert(t,e,s,r)}return!1}function Wre(t,e,s,i,r){switch(i){case 4:return srt(t,e,s);case 1:case 64:return rrt(t,e,s);case 8:return irt(t,e,s)}return!1}function Zre(t,e,s,i,r){switch(i){case 4:return nrt(t,e,s);case 1:case 64:return lrt(t,e,s);case 8:return ort(t,e,s);case 16:return art(t,e,s)}return!1}function Qre(t,e,s,i,r){if(crt(t,e,s))return i===4;if(i===4)return!1;switch(i){case 2:return ane(t,e,s,!1);case 128:return ane(t,e,s,!0);case 1:case 64:case 32:return!1;case 3:return urt(t,e,s);case 8:return hrt(t,e,s,r);case 16:return mrt(t,e,s)}return!1}function $it(t,e,s,i,r){switch(i){case 4:return prt(t,e,s);case 2:case 128:return l0(e,t,s);case 1:case 64:return l0(t,e,s);case 3:return drt(t,e,s);case 32:return frt(t,e,s)}return!1}function Jre(t,e,s,i,r){switch(i){case 4:return xve(t,e,s);case 2:case 128:return grt(t,e,s);case 1:case 64:return yrt(t,e,s);case 3:return bve(t,e,s)}return!1}function Kre(t,e,s,i,r){switch(i){case 4:return vrt(t,e,s);case 2:return lne(t,e,s,!1);case 128:return lne(t,e,s,!0);case 1:case 64:return!1;case 3:return _rt(t,e,s);case 8:return brt(t,e,s);case 16:return xrt(t,e,s)}return!1}function _ve(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();if(t.queryEnvelope(r),e.queryEnvelope(n),!Ud(r,n,s))return!1;if(Kt(t,e),Eve(t,e,s))return!0;const o=t.calculateLength2D(),a=e.calculateLength2D(),l=Math.max(t.getPointCount(),e.getPointCount());return Math.abs(o-a)>4*l*s?!1:t.hasNonLinearSegments()||e.hasNonLinearSegments()?Jl(t,e,s,"**F**FFF*",i,!1):Cve(t,e,s,!0)}function Rit(t,e,s,i){return Kt(t,e,s,!0),PP(t,e,s,!0)===1}function kit(t,e,s,i){return Kt(t,e),Ave(t,e,s,null)}function Fit(t,e,s,i){return Kt(t,e),Nve(t,e,s,i)}function ene(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),!!cr(r,n,s)&&(Kt(t,e),Dve(t,e,s,i))}function tne(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),!!cr(r,n,s)&&(Kt(t,e),PP(t,e,s,!1)===2)}function Oit(t,e,s,i){return Kt(t,e,s,!0),PP(t,e,s,!0)===1}function vve(t,e,s,i){return Kt(t,e),Nrt(t,e,s,i)}function Lit(t,e,s,i){return Kt(t,e),Drt(t,e,s,null)}function Vit(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),!!cr(r,n,s)&&(Kt(t,e),$rt(t,e,s,i))}function qit(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),!!cr(r,n,s)&&(Kt(t,e),PP(t,e,s,!1)===2)}function Git(t,e,s,i){return kve(t,e,s)===0}function zit(t,e,s,i){return krt(t,e.getXY(),s)}function Uit(t,e,s,i){return Rrt(t,e.getXY(),s)}function Bit(t,e,s,i,r){return Kt(t,e),Irt(t,e,s)===1}function jit(t,e,s,i){Kt(t,e);const r=X.constructEmpty();t.queryEnvelope(r),r.inflateCoords(s,s);const n=new M;let o=!1;const a=t.getImpl(),l=new wt;let u=t,c=!1;for(let h=0;h<e.getPointCount();h++){if(e.queryXY(h,n),r.contains(n)){const m=Bo(u,n,s);if(m===2)o=!0;else if(m===1)return!1}c||(!cg(t,e.getPointCount()-1)||a.getAccelerators()!==null&&a.getAccelerators().getQuadTree()!==null?u=t:(t.copyTo(l),l.getImpl().buildQuadTreeAccelerator(1),u=l),c=!0)}return!!o}function Hit(t,e,s,i){Kt(t,e);const r=new X,n=new X,o=new X;t.queryEnvelope(r),e.queryEnvelope(o),n.setCoords({env2D:r}),n.inflateCoords(s,s);let a=!1,l=!1;const u=new M,c=t.getImpl(),h=new wt;let m=t,f=!1;for(let g=0;g<e.getPointCount();g++){if(e.queryXY(g,u),n.contains(u)){const v=Bo(m,u,s);v===0?l=!0:v===1&&(a=!0)}else l=!0;if(a&&l)return!0;f||(!cg(t,e.getPointCount()-1)||c.getAccelerators()!==null&&c.getAccelerators().getQuadTree()!==null?m=t:(t.copyTo(h),h.getImpl().buildQuadTreeAccelerator(1),m=h),f=!0)}return!1}function sne(t,e,s,i,r){const n=X.constructEmpty(),o=X.constructEmpty();if(t.queryEnvelope(n),e.queryEnvelope(o),!cr(n,o,s))return!1;Kt(t,e);let a=!1;const l=new M,u=t.getImpl(),c=new wt;let h=t,m=!1;for(let f=0;f<e.getPointCount();f++){if(e.queryXY(f,l),!n.contains(l))return!1;const g=Bo(h,l,s);if(g===1)a=!0;else if(g===0)return!1;if(i&&g===2)return!1;m||(!cg(t,e.getPointCount()-1)||u.getAccelerators()!==null&&u.getAccelerators().getQuadTree()!==null?h=t:(t.copyTo(c),c.getImpl().buildQuadTreeAccelerator(1),h=c),m=!0)}return a}function Yit(t,e,s,i){const r=new X,n=new X;if(t.queryEnvelope(r),e.queryEnvelope(n),!Ud(r,n,s))return!1;const o=new wt;return o.addEnvelope(e,!1),_ve(t,o,s,i)}function Xit(t,e,s,i){Kt(t,e);const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),cr(n,r,s)?!1:Bo(t,n.getLowerLeft(),0)===0&&!n.contains(t.getXY(0))&&!Mve(t,n,s)}function Wit(t,e,s,i){Kt(t,e);const r=new X,n=new X;if(t.queryEnvelope(r),e.queryEnvelope(n),cr(n,r,s)||n.height()<=s||n.width()<=s)return!1;const o=new wt;return o.addEnvelope(e,!1),Ave(t,o,s,i)}function Zit(t,e,s,i){Kt(t,e);const r=new X,n=new X;if(t.queryEnvelope(r),e.queryEnvelope(n),cr(n,r,s)||n.height()<=s||n.width()<=s)return!1;const o=new wt;return o.addEnvelope(e,!1),Nve(t,o,s,i)}function ine(t,e,s,i,r){const n=X.constructEmpty(),o=X.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(o),i?bR(o,n,s):cr(o,n,s)}function rne(t,e,s,i,r){const n=X.constructEmpty(),o=X.constructEmpty();if(t.queryEnvelope(n),e.queryEnvelope(o),!cr(n,o,s))return!1;Kt(t,e);const a=new wt;return a.addEnvelope(e,!1),i?PP(t,a,s,!1)===2:Dve(t,a,s,r)}function Qit(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),Ud(r,n,s)?(Kt(t,e),Eve(t,e,s)?!0:t.hasNonLinearSegments()||e.hasNonLinearSegments()?Jl(t,e,s,"**F**FFF*",i,!1):Cve(t,e,s,!1)):!1}function Jit(t,e,s,i){Kt(t,e);const r=t.getImpl(),n=e.getImpl();return!new al(r,n,s,!0).next()||!Pve(t,e,s)}function Kit(t,e,s,i){Kt(t,e);const r=[],n=K9(t,e,s,r);if(n===-2){const u=X.constructEmpty(),c=X.constructEmpty(),h=X.constructEmpty();let m,f;if(t.queryEnvelope(u),e.queryEnvelope(c),u.inflateCoords(1e3*s,1e3*s),c.inflateCoords(1e3*s,1e3*s),h.setCoords({env2D:u}),h.intersect(c),t.getPointCount()>10){if(m=ps(t,h,s,0,i),m.isEmpty())return!1}else m=t;if(e.getPointCount()>10){if(f=ps(e,h,s,0,i),f.isEmpty())return!1}else f=e;return Jl(m,f,s,"F********",i,!1)}if(n!==0)return!1;const o=new pi;for(let u=0;u<r.length;u+=2){const c=r[u],h=r[u+1];o.addXY(c,h)}const a=t.getBoundary(),l=e.getBoundary();return a.addPoints(l,0,l.getPointCount()),!a.isEmpty()&&l0(a,o,s)}function ert(t,e,s,i){Kt(t,e);const r=[],n=K9(t,e,s,r);if(n===-2){const u=X.constructEmpty(),c=X.constructEmpty(),h=X.constructEmpty();let m,f;if(t.queryEnvelope(u),e.queryEnvelope(c),u.inflateCoords(1e3*s,1e3*s),c.inflateCoords(1e3*s,1e3*s),h.setCoords({env2D:u}),h.intersect(c),t.getPointCount()>10){if(m=ps(t,h,s,0,i),m.isEmpty())return!1}else m=t;if(e.getPointCount()>10){if(f=ps(e,h,s,0,i),f.isEmpty())return!1}else f=e;return Jl(m,f,s,"0********",i,!1)}if(n!==0)return!1;const o=new pi;for(let u=0;u<r.length;u+=2){const c=r[u],h=r[u+1];o.addXY(c,h)}const a=t.getBoundary(),l=e.getBoundary();return a.addPoints(l,0,l.getPointCount()),!!a.isEmpty()||!l0(a,o,s)}function trt(t,e,s,i){Kt(t,e);const r=X.constructEmpty(),n=X.constructEmpty();t.queryEnvelope(r),e.queryEnvelope(n);const o=SC(r,n,s),a=SC(n,r,s),l=t.hasNonLinearSegments(),u=e.hasNonLinearSegments(),c=K9(t,e,s,null);if(c===-1)return!1;if(c===1){if(o&&a)return!0;if(!l&&!u)return o&&!a?!p_(e,t,s,!1):a&&!o?!p_(t,e,s,!1):!p_(t,e,s,!1)&&!p_(e,t,s,!1)}const h=X.constructEmpty(),m=X.constructEmpty(),f=X.constructEmpty();let g,v;h.setCoords({env2D:r}),h.inflateCoords(1e3*s,1e3*s),m.setCoords({env2D:n}),m.inflateCoords(1e3*s,1e3*s),f.setCoords({env2D:h}),f.intersect(m);let b="";if(b+="1*",o){if(e.getPointCount()>10){if(v=ps(e,f,s,0,i),v.isEmpty())return!1}else v=e;b+="****"}else v=e,b+="T***";if(a){if(t.getPointCount()>10){if(g=ps(t,f,s,0,i),g.isEmpty())return!1}else g=t;b+="***"}else g=t,b+="T**";return Jl(g,v,s,b,i,!1)}function nne(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),cr(r,n,s)?(Kt(t,e),t.hasNonLinearSegments()||e.hasNonLinearSegments()?Jl(t,e,s,"******FF*",i,!1):p_(e,t,s,!1)):!1}function one(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),cr(r,n,s)?(Kt(t,e),Jl(t,e,s,"T**FF*FF*",i,!1)):!1}function srt(t,e,s,i){return Kt(t,e),!Ive(t,e.getXY(),s)}function irt(t,e,s,i){return Kt(t,e),Rve(t,e.getXY(),s)}function rrt(t,e,s,i){return Kt(t,e),Art(t,e.getXY(),s)}function nrt(t,e,s,i){return Kt(t,e),!Tve(t,e,s,!1)}function ort(t,e,s,i){Kt(t,e);const r=t.getImpl(),n=e.getImpl(),o=new pi,a=new al(r,n,s,!1),l=r.querySegmentIterator();let u=!1;for(;a.next();){const h=a.getRedElement(),m=a.getBlueElement();l.resetToVertex(h,-1);const f=l.nextSegment(),g=n.getXY(m);f.isIntersectingPoint(g,s)&&(u=!0,o.addPoint2D(g))}if(!u)return!1;const c=t.getBoundary();return!c.isEmpty()&&l0(c,o,s)}function art(t,e,s,i){Kt(t,e);const r=t.getImpl(),n=e.getImpl(),o=n.getPointCount(),a=Me(o,!1),l=new al(r,n,s,!1),u=r.querySegmentIterator();let c=!1;for(;l.next();){const g=l.getRedElement(),v=l.getBlueElement();u.resetToVertex(g,-1);const b=u.nextSegment(),w=n.getXY(v);b.isIntersectingPoint(w,s)&&(c=!0,a[v]=!0)}if(!c)return!1;let h=!1;for(let g=0;g<o;g++)if(!a[g]){h=!0;break}if(!h)return!1;const m=t.getBoundary();if(m.isEmpty())return!0;const f=new pi;for(let g=0;g<o;g++)a[g]&&f.addPoint2D(n.getXY(g));return!l0(m,f,s)}function lrt(t,e,s,i,r){const n=X.constructEmpty(),o=X.constructEmpty();if(t.queryEnvelope(n),e.queryEnvelope(o),!cr(n,o,s))return!1;Kt(t,e);const a=Tve(t,e,s,!0);if(!a)return a;const l=t.getBoundary();return l.isEmpty()?a:!l0(l,e,s)}function urt(t,e,s,i){const r=new X,n=new X;return t.queryEnvelope(r),e.queryEnvelope(n),!(n.height()>s&&n.width()>s)&&Ud(r,n,s)}function crt(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();t.queryEnvelope(r),e.queryEnvelope(n);const o=Frt(n,r,s);return o===0?!Mve(t,n,s):o===4}function hrt(t,e,s,i){const r=new X,n=new X;if(t.queryEnvelope(r),e.queryEnvelope(n),n.height()<=s||n.width()<=s)return!1;const o=new X,a=new X;if(o.setCoords({env2D:n}),a.setCoords({env2D:n}),o.inflateCoords(s,s),a.inflateCoords(-s,-s),a.containsEnvelope(r)||!r.isIntersecting(o))return!1;const l=t.getImpl().querySegmentIterator();l.stripAttributes();const u=t.getImpl().getAccelerators();let c=null,h=null;u!==null&&(c=u.getQuadTree(),c!==null&&(h=c.getIterator(n,s))),h||l.nextPath()||Ce("relational_operations");let m=!1,f=null;const g=new M,v=new M,b=t.hasNonLinearSegments();let w=!1;for(;;){if(h!==null){const T=h.next();if(T===-1)break;l.resetToVertex(c.getElement(T),-1),f=l.nextSegment()}else{for(;!l.hasNextSegment()&&l.nextPath(););if(!l.hasNextSegment())break;f=l.nextSegment()}if(b&&f.getGeometryType()!==G.enumLine){const T=new X;if(f.queryEnvelope(T),a.containsEnvelope(T))return!1;if(o.isIntersecting(T)){w=!0;break}}else{g.assign(f.getStartXY()),v.assign(f.getEndXY());let T=a.clipLine(g,v);if(T!==0)return!1;m||(T=o.clipLine(g,v),T!==0&&(m=!0))}}if(!w)return m;const S=new wt;return S.addEnvelope(n,!1),vve(S,t,s,i)}function ane(t,e,s,i,r){const n=X.constructEmpty(),o=X.constructEmpty();if(t.queryEnvelope(n),e.queryEnvelope(o),o.height()<=s||o.width()<=s)return!1;if(i)return bR(o,n,s);if(!cr(o,n,s))return!1;const a=X.constructEmpty();a.setCoords({env2D:o}),a.inflateCoords(-s,-s);const l=X.constructEmpty();if(l.setCoords({env2D:o}),l.inflateCoords(s,s),a.containsEnvelope(n))return!0;const u=t.getImpl().querySegmentIterator();u.stripAttributes(),u.nextPath()||Ce("relational_operations");let c,h,m,f,g,v,b=!1;const w=t.hasNonLinearSegments();for(w&&(m=new pt,f=new pt,g=new pt,v=new pt,a.querySide(0,m),a.querySide(1,f),a.querySide(2,g),a.querySide(3,v));;){for(;!u.hasNextSegment()&&u.nextPath(););if(!u.hasNextSegment())break;const S=u.nextSegment();if(w&&S.getGeometryType()!==G.enumLine){if(S.isIntersecting(m,s)){b=!0;break}if(S.isIntersecting(f,s)){b=!0;break}if(S.isIntersecting(g,s)){b=!0;break}if(S.isIntersecting(v,s)){b=!0;break}}else if(c=S.getStartXY(),h=S.getEndXY(),a.clipLine(c,h)!==0){b=!0;break}}return b}function mrt(t,e,s,i){const r=new X,n=new X;if(t.queryEnvelope(r),e.queryEnvelope(n),n.height()<=s||n.width()<=s)return!1;const o=new X;if(o.setCoords({env2D:n}),o.inflateCoords(s,s),o.containsEnvelope(r))return!1;const a=!0,l=new X;if(l.setCoords({env2D:n}),l.inflateCoords(-s,-s),!l.isIntersecting(r))return!1;const u=t.getImpl().querySegmentIterator();u.stripAttributes();const c=t.getImpl().getAccelerators();let h=null,m=null;if(c!==null&&(h=c.getQuadTree(),h!==null&&(m=h.getIterator(n,s))),!m){const I=u.nextPath();F(I)}let f=!1,g=null;const v=new M,b=new M;let w=null,S=null,T=null,P=null;for(t.hasNonLinearSegments()&&(w=new pt,S=new pt,T=new pt,P=new pt,l.querySide(0,w),l.querySide(1,S),l.querySide(2,T),l.querySide(3,P));;){if(m!==null){const I=m.next();if(I===-1)break;u.resetToVertex(h.getElement(I),-1),g=u.nextSegment()}else{for(;!u.hasNextSegment()&&u.nextPath(););if(!u.hasNextSegment())break;g=u.nextSegment()}if(g.getGeometryType()===G.enumLine){if(v.assign(g.getStartXY()),b.assign(g.getEndXY()),l.clipLine(v,b)!==0){f=!0;break}}else{if(w.isIntersecting(g,s)){f=!0;break}if(S.isIntersecting(g,s)){f=!0;break}if(T.isIntersecting(g,s)){f=!0;break}if(P.isIntersecting(g,s)){f=!0;break}}}return f&&a}function drt(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),!!Ud(r,n,s)&&(!!Mrt(t,e,s)||J9(t,e,s,!1,!0,!1))}function prt(t,e,s,i){const r=t,n=e,o=new al(r,n,s,!1),a=s*s,l=new M,u=new M;for(;o.next();){const c=o.getRedElement(),h=o.getBlueElement();if(r.queryXY(c,l),n.queryXY(h,u),M.sqrDistance(l,u)<=a)return!1}return!0}function frt(t,e,s,i){return J9(t,e,s,!1,!1,!0)}function l0(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),!!cr(r,n,s)&&J9(e,t,s,!0,!1,!1)}function bve(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(n),Ud(r,n,s)}function xve(t,e,s,i){return $ve(t,e.getXY(),s)}function grt(t,e,s,i){return bve(t,e,s)}function yrt(t,e,s,i){return!xve(t,e,s)}function _rt(t,e,s,i){const r=new X,n=new X;return t.queryEnvelope(r),e.queryEnvelope(n),!(n.height()>s||n.width()>s)&&Ud(r,n,s)}function vrt(t,e,s,i){const r=X.constructEmpty(),n=X.constructEmpty();if(t.queryEnvelope(r),e.queryEnvelope(n),cr(n,r,s))return!1;const o=X.constructEmpty();o.setCoords({env2D:n}),o.inflateCoords(s,s);const a=new M;for(let l=0;l<t.getPointCount();l++)if(t.queryXY(l,a),o.contains(a))return!1;return!0}function brt(t,e,s,i){const r=new X,n=new X,o=new X;if(e.queryEnvelope(r),r.height()<=s||r.width()<=s)return!1;n.setCoords({env2D:r}),o.setCoords({env2D:r}),n.inflateCoords(s,s),o.inflateCoords(-s,-s);const a=new M;let l=!1;for(let u=0;u<t.getPointCount();u++)if(t.queryXY(u,a),n.contains(a)){if(o.containsExclusive(a))return!1;l=!0}return l}function lne(t,e,s,i,r){const n=X.constructEmpty(),o=X.constructEmpty();if(t.queryEnvelope(n),e.queryEnvelope(o),o.height()<=s||o.width()<=s)return!1;if(i)return bR(o,n,s);if(!cr(o,n,s))return!1;let a=!1;const l=X.constructEmpty(),u=X.constructEmpty();l.setCoords({env2D:o}),u.setCoords({env2D:o}),l.inflateCoords(-s,-s),u.inflateCoords(s,s);const c=new M;for(let h=0;h<t.getPointCount();h++){if(t.queryXY(h,c),!u.contains(c))return!1;l.containsExclusive(c)&&(a=!0)}return a}function xrt(t,e,s,i){const r=new X,n=new X;if(t.queryEnvelope(r),e.queryEnvelope(n),cr(n,r,s)||n.height()<=s||n.width()<=s)return!1;const o=new X,a=new X;o.setCoords({env2D:n}),o.inflateCoords(-s,-s),a.setCoords({env2D:n}),a.inflateCoords(s,s);const l=new M;let u=!1,c=!1;for(let h=0;h<t.getPointCount();h++)if(t.queryXY(h,l),!u&&o.containsExclusive(l)&&(u=!0),c||a.contains(l)||(c=!0),u&&c)return!0;return!1}function wve(t,e,s,i){return M.sqrDistance(t,e)<=s*s}function wrt(t,e,s,i){return M.sqrDistance(t,e)>s*s}function une(t,e,s,i){return wve(t,e,s)}function Srt(t,e,s,i){const r=new X;return r.setCoords({pt:t}),Ud(r,e,s)}function Ert(t,e,s,i){if(e.height()<=s||e.width()<=s)return!1;const r=new X,n=new X;return r.setCoords({env2D:e}),r.inflateCoords(s,s),!!r.contains(t)&&(n.setCoords({env2D:e}),n.inflateCoords(-s,-s),!n.containsExclusive(t))}function Crt(t,e,s,i){if(e.height()<=s||e.width()<=s)return!1;const r=X.constructEmpty();return r.setCoords({env2D:e}),r.inflateCoords(-s,-s),r.containsExclusive(t)}function Ud(t,e,s,i){return cr(t,e,s)&&cr(e,t,s)}function Prt(t,e,s,i){if(t.height()<=s||t.width()<=s||e.height()<=s||e.width()<=s)return!1;const r=new X;return r.setCoords({env2D:t}),r.inflateCoords(-s,-s),r.intersect(e),!(!r.isEmpty()&&r.height()>s&&r.width()>s)&&(r.setCoords({env2D:t}),r.inflateCoords(s,s),r.intersect(e),!r.isEmpty())}function Trt(t,e,s,i){if(t.height()<=s||t.width()<=s||e.height()<=s||e.width()<=s||cr(t,e,s)||cr(e,t,s))return!1;const r=new X;return r.setCoords({env2D:t}),r.inflateCoords(-s,-s),r.intersect(e),!r.isEmpty()&&(r.height()>s||r.width()>s)}function gM(t,e,s,i,r){if(t.height()<=s||t.width()<=s)return!1;if(i)return bR(t,e,s);if(!cr(t,e,s))return!1;const n=X.constructEmpty();return n.setCoords({env2D:t}),n.inflateCoords(-s,-s),n.intersect(e),!n.isEmpty()}function PP(t,e,s,i,r){const n=new M,o=new M,a=X.constructEmpty(),l=X.constructEmpty(),u=t.getImpl(),c=e.getImpl(),h=c.getGeometryType(),m=new al(u,c,s,!0);if(!m.next())return 1;if(Pve(t,e,s))return i?4:0;const f=new wt;let g=t;const v=new wt;let b=null;h===G.enumPolygon&&(b=e);const w=h===G.enumPolygon?Me(u.getPathCount(),!1):[],S=Me(c.getPathCount(),!1);let T=!1,P=!1,I=!1,A=!1,D=!1,k=!1;do{if(I&&D||A&&k||I&&A)break;const R=m.getRedElement(),O=m.getBlueElement();if(!S[O]&&(o.assign(e.getXY(e.getPathStart(O))),a.setCoords({env2D:m.getRedEnvelope()}),a.inflateCoords(s,s),a.contains(o))){if(Bo(g,o,0)!==0){if(A=!0,i)return 4}else k=!0;S[O]=!0}if(h===G.enumPolygon&&!w[R]&&(n.assign(t.getXY(t.getPathStart(R))),l.setCoords({env2D:m.getBlueEnvelope()}),l.inflateCoords(s,s),l.contains(n))){if(Bo(b,n,0)!==0){if(I=!0,i)return 4}else D=!0;w[R]=!0}if(T||(!cg(t,e.getPathCount()-1)||u.getAccelerators()!==null&&u.getAccelerators().getQuadTree()!==null?g=t:(t.copyTo(f),f.getImpl().buildQuadTreeAccelerator(1),g=f),T=!0),h===G.enumPolygon&&!P){const z=e;!cg(z,t.getPathCount()-1)||c.getAccelerators()!==null&&c.getAccelerators().getQuadTree()!==null?b=e:(z.copyTo(v),v.getImpl().buildQuadTreeAccelerator(1),b=v),P=!0}}while(m.next());if(!I&&!A)return 1;if(!D||!k){if(h===G.enumPolygon){for(let R=0,O=u.getPathCount();R<O;R++)if(!w[R]){D=!0;break}}for(let R=0,O=c.getPathCount();R<O;R++)if(!S[R]){k=!0;break}}return I&&D||A&&k||I&&A?4:A?2:3}function Irt(t,e,s,i,r){const n=X.constructEmpty();t.queryEnvelope(n),n.inflateCoords(s,s);const o=new M,a=t.getImpl(),l=new wt;let u=t,c=!1,h=!1,m=!1;for(let f=0;f<e.getPointCount();f++){if(e.queryXY(f,o),n.contains(o)){const g=Bo(u,o,s);if(g===1)return h=!0,4;if(g===2)return 4;m=!0}else m=!0;c||(!cg(t,e.getPointCount()-1)||a.getAccelerators()!==null&&a.getAccelerators().getQuadTree()!=null?u=t:(t.copyTo(l),l.getImpl().buildQuadTreeAccelerator(1),u=l),c=!0)}return h?m?4:2:1}function Sve(t,e,s,i,r){i[0]=!1;const n=t.getImpl(),o=e.getImpl(),a=n.querySegmentIterator(),l=o.querySegmentIterator(),u=[0,0],c=[0,0],h=new al(n,o,s);let m=!1;for(;h.next();){const f=h.getRedElement(),g=h.getBlueElement();a.resetToVertex(f,-1),l.resetToVertex(g,-1);const v=a.nextSegment(),b=l.nextSegment();let w=0;if(Tx(v,b)?!m&&b.isIntersecting(v,s)&&(m=!0):w=b.intersect(v,null,c,u,s),w!==0&&(m=!0,w===1)){const S=u[0],T=c[0];if(S>0&&S<1&&T>0&&T<1)return i[0]=!0,!1}}if(!m){i[0]=!0;const f=X.constructEmpty();t.queryEnvelope(f),f.inflateCoords(s,s);const g=new wt;let v=t,b=!1;for(let A=0,D=e.getPathCount();A<D;A++)if(e.getPathSize(A)>0){const k=X.constructEmpty();if(e.queryPathEnvelope(A,k),!f.isIntersecting(k))return!1;{const R=lD(v,e.getXY(e.getPathStart(A)),0);if(F(R!==-1),R===0)return!1}b||(!cg(t,e.getPathCount()-1)||n.getAccelerators()!==null&&n.getAccelerators().getQuadTree()!==null?v=t:(t.copyTo(g),g.getImpl().buildQuadTreeAccelerator(1),v=g),b=!0)}if(t.getPathCount()===1||e.getGeometryType()===G.enumPolyline)return!0;const w=e,S=X.constructEmpty();w.queryEnvelope(S),S.inflateCoords(s,s);const T=new wt;let P=w,I=!1;for(let A=0,D=t.getPathCount();A<D;A++)if(t.getPathSize(A)>0){const k=X.constructEmpty();if(t.queryPathEnvelope(A,k),S.isIntersecting(k)){const R=lD(P,t.getXY(t.getPathStart(A)),0);if(F(R!==-1),R===1)return!1}I||(!cg(w,t.getPathCount()-1)||o.getAccelerators()!==null&&o.getAccelerators().getQuadTree()!==null?P=w:(w.copyTo(T),T.getImpl().buildQuadTreeAccelerator(1),P=T),I=!0)}return!0}return!1}function cr(t,e,s){const i=X.constructEmpty();return i.setCoords({env2D:t}),i.inflateCoords(s,s),i.containsEnvelope(e)}function bR(t,e,s){const i=X.constructEmpty();return i.setCoords({env2D:e}),i.inflateCoords(s,s),t.containsExclusiveEnvelope(i)}function SC(t,e,s){const i=X.constructEmpty();return i.setCoords({env2D:e}),i.inflateCoords(s,s),!i.contains(t.getLowerLeft())||!i.contains(t.getLowerRight())||!i.contains(t.getUpperLeft())||!i.contains(t.getUpperRight())}function Eve(t,e,s,i){if(t.getPathCount()!==e.getPathCount()||t.getPointCount()!==e.getPointCount())return!1;if(t.hasNonLinearSegments()||e.hasNonLinearSegments())return t.equals(e);const r=new M,n=new M;let o=!0;const a=s*s;for(let l=0;l<t.getPathCount();l++){if(t.getPathEnd(l)!==e.getPathEnd(l)){o=!1;break}for(let u=t.getPathStart(l);u<e.getPathEnd(l);u++)if(t.queryXY(u,r),e.queryXY(u,n),M.sqrDistance(r,n)>a){o=!1;break}if(!o)break}return!!o}function Mrt(t,e,s,i){if(t.getPointCount()!==e.getPointCount())return!1;const r=new M,n=new M;let o=!0;const a=s*s;for(let l=0;l<t.getPointCount();l++)if(t.queryXY(l,r),e.queryXY(l,n),M.sqrDistance(r,n)>a){o=!1;break}return!!o}function J9(t,e,s,i,r,n,o){const a=t.getImpl(),l=e.getImpl(),u=a.getPointCount(),c=l.getPointCount(),h=Me(u,!1),m=r||n?Me(c,!1):[],f=s*s,g=new al(a,l,s);for(;g.next();){const T=g.getRedElement(),P=g.getBlueElement(),I=a.getXY(T),A=l.getXY(P);M.sqrDistance(I,A)<=f&&(h[T]=!0,(r||n)&&(m[P]=!0))}let v=!1,b=!1;for(let T=0;T<u;T++){const P=h[T];if(v||(v=!P),b||(b=P),(r||i)&&v)return!1}if(i)return!0;let w=!1,S=!1;for(let T=0;T<c;T++){const P=m[T];if(w||(w=!P),S||(S=P),r&&w)return!1}return!!r||v&&b&&w&&S}function Cve(t,e,s,i){return p_(t,e,s,i)&&p_(e,t,s,i)}function p_(t,e,s,i){if(JE(t),JE(e),e.isEmpty())return!1;let r=!0;const n=Me(2,Number.NaN),o=Me(2,Number.NaN),a=[],l=new Lrt;let u;const c=X.constructEmpty(),h=X.constructEmpty(),m=X.constructEmpty();t.queryEnvelope(c),e.queryEnvelope(h),c.inflateCoords(s,s),h.inflateCoords(s,s),m.setCoords({env2D:c}),m.intersect(h);const f=t.getImpl().querySegmentIterator(),g=e.getImpl().querySegmentIterator(),v=e.getImpl().getAccelerators();let b=null,w=null,S=null,T=null;if(v!==null&&(b=v.getQuadTree(),w=v.getQuadTreeForPaths(),w!==null&&(T=w.getIteratorForQT())),b===null){const P=t.getPointCount(),I=e.getPointCount();P>10&&I>10&&(b=Lb(e.getImpl(),m))}for(b!==null&&(S=b.getIteratorForQT());f.nextPath();)for(;f.hasNextSegment();){let P=f.nextSegment();if(P.queryEnvelope(c),!c.isIntersecting(m))return r=!1,!1;if(T!==null&&(T.resetIterator(c,s),T.next()===-1))continue;let I=0,A=null;if(S!=null)S.resetIterator(P,s);else if(g.resetToFirstPath(),!g.nextPath())return r=!1,!1;do if(I=0,S!==null){const V=S.next();if(V===-1)return r=!1,!1;g.resetToVertex(b.getElement(V),-1),A=g.nextSegment(),I=P.intersect(A,null,n,o,s)}else{for(;!g.hasNextSegment();)if(!g.nextPath())return r=!1,!1;A=g.nextSegment(),A.queryEnvelope(h),h.inflateCoords(s,s),c.isIntersecting(h)&&(I=P.intersect(A,null,n,o,s))}while(I!==2||n[0]!==0||i&&!(o[0]<=o[1]));let D=Number.NaN,k=!1;do{let V=!1;if(n[1]===1){if(!f.hasNextSegment()){k=!0;break}P=f.nextSegment(),V=!0}if(o[1]===1&&o[0]<=o[1]){if(D===-1||(D=1,!g.hasNextSegment()))break;A=g.nextSegment(),V=!0}if(o[1]===0&&o[0]>o[1]){if(D===1)break;if(Number.isNaN(D)){if(!g.hasPreviousSegment())break;g.previousSegment(),D=-1}if(!g.hasPreviousSegment())break;A=g.previousSegment(),V=!0}if(!V)break;I=P.intersect(A,null,n,o,s)}while(I===2&&(!i||o[0]<=o[1]));if(k)continue;const R=P.calculateLength2D();P.queryEnvelope(c),a.length=0,l.m_overlapEvents.length=0;let O=!1,z=!1,q=0;const U=Eg(null,c,!0);for(S!==null?S.resetIterator(P,s):(g.resetToFirstPath(),g.nextPath()||Ce("relational_operations"));;){if(I=0,S!==null){const V=S.next();if(V===-1)break;g.resetToVertex(b.getElement(V),-1),A=g.nextSegment(),I=P.intersect(A,null,n,o,s)}else{for(;!g.hasNextSegment()&&g.nextPath(););if(!g.hasNextSegment())break;A=g.nextSegment(),A.queryEnvelope(h),h.inflateCoords(s,s),c.isIntersecting(h)&&(I=P.intersect(A,null,n,o,s))}if(I===2&&(!i||o[0]<=o[1])){const V=f.getStartPointIndex(),B=f.getPathIndex(),H=g.getStartPointIndex(),W=g.getPathIndex();if(u=Ort(V,B,n[0],n[1],H,W,o[0],o[1]),l.m_overlapEvents.push(u),a.push(a.length),!(O||u.m_scalarA0<q&&u.m_scalarA1<q)){if(q===0&&R*(u.m_scalarA0-q)>s)O=!0;else if(q!==0&&R*(u.m_scalarA0-q)>U)O=!0;else if(q=u.m_scalarA1,R*(1-q)<=s||q===1){z=!0;break}}}}if(!z){if(!O)return r=!1,!1;a.length>1&&a.sort((V,B)=>l.compareOverlapEvents(V,B)),q=0;for(let V=0;V<l.m_overlapEvents.length;V++)if(u=l.m_overlapEvents[a[V]],!(u.m_scalarA0<q&&u.m_scalarA1<q)){if(q===0&&R*(u.m_scalarA0-q)>s||q!==0&&R*(u.m_scalarA0-q)>U)return r=!1,!1;if(q=u.m_scalarA1,R*(1-q)<=s||q===1)break}if(R*(1-q)>s)return r=!1,!1;a.length=0,l.m_overlapEvents.length=0}}return r}function Pve(t,e,s){const i=t.getImpl(),r=e.getImpl(),n=i.querySegmentIterator(),o=r.querySegmentIterator(),a=new al(i,r,s);for(;a.next();){const l=a.getRedElement(),u=a.getBlueElement();n.resetToVertex(l,-1),o.resetToVertex(u,-1);const c=n.nextSegment();if(o.nextSegment().isIntersecting(c,s))return!0}return!1}function K9(t,e,s,i){const r=t.getImpl(),n=e.getImpl(),o=r.querySegmentIterator(),a=n.querySegmentIterator(),l=Me(2,Number.NaN),u=new al(r,n,s);let c=!1,h=-1;for(;u.next();){const m=u.getRedElement(),f=u.getBlueElement();o.resetToVertex(m,-1),a.resetToVertex(f,-1);const g=o.nextSegment(),v=a.nextSegment();let b=0;if(Tx(g,v)){if(v.isIntersecting(g,s))return-2}else b=g.intersect(v,null,l,null,s);if(b){if(b===2){const w=g.calculateLength2D(),S=l[0];if(w*(l[1]-S)>s)return h=1,h;c=!0}else if(h=0,i){const w=l[0],S=new M;g.queryCoord2D(w,S),i.push(S.x),i.push(S.y)}}}return c?-2:h}function Tve(t,e,s,i){const r=t.getImpl(),n=e,o=n.getPointCount(),a=i?Me(o,!1):[],l=new al(r,n,s,!1),u=r.querySegmentIterator();for(;l.next();){const c=l.getRedElement(),h=l.getBlueElement();u.resetToVertex(c,-1);const m=u.nextSegment(),f=n.getXY(h);if(m.isIntersectingPoint(f,s)){if(!i)return!0;a[h]=!0}}if(!i)return!1;for(let c=0;c<o;c++)if(!a[c])return!1;return!0}function Ive(t,e,s){const i=new M,r=s*s,n=t.querySegmentIterator(),o=t.getImpl().getAccelerators();if(o!==null){const l=o.getQuadTree();if(l!==null){const u=X.constructEmpty();u.setCoords({pt:e});const c=l.getIterator(u,s);for(let h=c.next();h!==-1;h=c.next())if(n.resetToVertex(l.getElement(h),-1),n.hasNextSegment()){const m=n.nextSegment(),f=m.getClosestCoordinate(e,!1);if(m.queryCoord2D(f,i),M.sqrDistance(e,i)<=r)return!0}return!1}}const a=X.constructEmpty();for(;n.nextPath();)for(;n.hasNextSegment();){const l=n.nextSegment();if(l.queryEnvelope(a),a.inflateCoords(s,s),!a.contains(e))continue;const u=l.getClosestCoordinate(e,!1);if(l.queryCoord2D(u,i),M.sqrDistance(e,i)<=r)return!0}return!1}function Art(t,e,s){return Ive(t,e,s)&&!Rve(t,e,s)}function Mve(t,e,s,i){const r=t.querySegmentIterator(),n=t.getImpl().getAccelerators(),o=t.hasNonLinearSegments();let a=null,l=null,u=null,c=null;if(n!==null){const h=n.getQuadTree();if(h!==null){const m=h.getIterator(e,s);o&&(a=new pt,l=new pt,u=new pt,c=new pt,e.querySide(0,a),e.querySide(1,l),e.querySide(2,u),e.querySide(3,c));const f=X.constructEmpty();f.setCoords({env2D:e}),f.inflateCoords(s,s);for(let g=m.next();g!==-1;g=m.next())if(r.resetToVertex(h.getElement(g),-1),r.hasNextSegment()){const v=r.nextSegment();if(v.getGeometryType()===G.enumLine){const b=v.getStartXY(),w=v.getEndXY();if(f.clipLine(b,w))return!0;continue}if(e.contains(v.getStartXY())||e.contains(v.getEndXY())||v.isIntersecting(a,s)||v.isIntersecting(l,s)||v.isIntersecting(u,s)||v.isIntersecting(c,s))return!0}return!1}}if(o){a=new pt,l=new pt,u=new pt,c=new pt,e.querySide(0,a),e.querySide(1,l),e.querySide(2,u),e.querySide(3,c);const h=t.querySegmentIterator();for(;h.nextPath();)for(;h.hasNextSegment();){const m=h.nextSegment();if(e.contains(m.getStartXY())||e.contains(m.getEndXY())||m.isIntersecting(a,s)||m.isIntersecting(l,s)||m.isIntersecting(u,s)||m.isIntersecting(c,s))return!0}}else{const h=X.constructEmpty();h.setCoords({env2D:e}),h.inflateCoords(s,s);const m=t.getImpl(),f=m.getAttributeStreamRef(0),g=new M;for(let v=0,b=m.getPathCount();v<b;v++){let w=!0;const S=new M,T=new M,P=new M,I=m.getPathStart(v),A=new M;for(let D=I,k=m.getPathEnd(v);D<k;D++)if(w)f.queryPoint2D(2*D,S),A.assign(S),w=!1;else{if(f.queryPoint2D(2*D,g),T.setCoordsPoint2D(S),P.setCoordsPoint2D(g),h.clipLine(T,P))return!0;S.assign(g)}if(m.isClosedPath(v)&&!w&&(T.setCoordsPoint2D(S),P.setCoordsPoint2D(A),h.clipLine(T,P)))return!0}}return!1}function Ave(t,e,s,i){const r=t.getImpl(),n=e.getImpl(),o=[0],a=tm(r.getIsSimple(0,o))&&tm(n.getIsSimple(0,o)),l=r.querySegmentIterator(),u=n.querySegmentIterator(),c=Me(2,0),h=Me(2,0),m=new al(r,n,s);let f=!1;for(;m.next();){const T=m.getRedElement(),P=m.getBlueElement();l.resetToVertex(T,-1),u.resetToVertex(P,-1);const I=l.nextSegment(),A=u.nextSegment();let D=0;if(Tx(I,A)){if(A.isIntersecting(I,s)){f=!0;break}}else D=A.intersect(I,null,h,c,s);if(D===2){const k=c[0],R=c[1],O=I.calculateLength2D();if(a&&(R-k)*O>s)return!1;f=!0}else if(D){const k=c[0],R=h[0];if(k>0&&k<1&&R>0&&R<1)return!1;f=!0}}if(!f)return!1;const g=X.constructEmpty(),v=X.constructEmpty(),b=X.constructEmpty();let w,S;if(t.queryEnvelope(g),e.queryEnvelope(v),g.inflateCoords(1e3*s,1e3*s),v.inflateCoords(1e3*s,1e3*s),b.setCoords({env2D:g}),b.intersect(v),t.getPointCount()>10){if(w=ps(t,b,s,0,i),w.isEmpty())return!1}else w=t;if(e.getPointCount()>10){if(S=ps(e,b,s,0,i),S.isEmpty())return!1}else S=e;return Jl(w,S,s,"F********",i,!1)}function Nve(t,e,s,i){const r=t.getImpl(),n=e.getImpl(),o=[0],a=tm(r.getIsSimple(0,o))&&tm(n.getIsSimple(0,o)),l=X.constructEmpty(),u=X.constructEmpty(),c=X.constructEmpty();t.queryEnvelope(l),e.queryEnvelope(u);let h=!1;const m=SC(l,u,s),f=SC(u,l,s),g=r.querySegmentIterator(),v=n.querySegmentIterator(),b=Me(2,Number.NaN),w=Me(2,Number.NaN),S=new al(r,n,s);for(;S.next();){const k=S.getRedElement(),R=S.getBlueElement();g.resetToVertex(k,-1),v.resetToVertex(R,-1);const O=g.nextSegment(),z=v.nextSegment();let q=0;if(Tx(O,z)){if(z.isIntersecting(O,s))break}else q=z.intersect(O,null,w,b,s);if(q===2){const U=b[0],V=b[1],B=O.calculateLength2D();if(a&&(V-U)*B>s&&(h=!0,m&&f))return!0}else if(q){const U=b[0],V=w[0];if(U>0&&U<1&&V>0&&V<1)return!0}}const T=X.constructEmpty(),P=X.constructEmpty();let I,A;T.setCoords({env2D:l}),T.inflateCoords(1e3*s,1e3*s),P.setCoords({env2D:u}),P.inflateCoords(1e3*s,1e3*s),c.setCoords({env2D:T}),c.intersect(P);let D="";if(D+=h?"**":"T*",m){if(e.getPointCount()>10){if(A=ps(e,c,s,0,i),A.isEmpty())return!1}else A=e;D+="****"}else A=e,D+="T***";if(f){if(t.getPointCount()>10){if(I=ps(t,c,s,0,i),I.isEmpty())return!1}else I=t;D+="***"}else I=t,D+="T**";return Jl(I,A,s,D,i,!1)}function Dve(t,e,s,i){const r=[!1],n=Sve(t,e,s,r);if(r[0])return n;const o=X.constructEmpty();let a;if(e.queryEnvelope(o),o.inflateCoords(1e3*s,1e3*s),t.getPointCount()>10){if(a=ps(t,o,s,0,i),a.isEmpty())return!1}else a=t;return dit(a,e,s,i)}function Nrt(t,e,s,i){const r=t.getImpl(),n=e.getImpl(),o=r.querySegmentIterator(),a=n.querySegmentIterator(),l=Me(2,Number.NaN),u=Me(2,Number.NaN),c=new al(r,n,s);let h=!1;for(;c.next();){const w=c.getRedElement(),S=c.getBlueElement();o.resetToVertex(w,-1),a.resetToVertex(S,-1);const T=o.nextSegment(),P=a.nextSegment();let I=0;if(Tx(T,P)?!h&&P.isIntersecting(T,s)&&(h=!0):I=P.intersect(T,null,u,l,s),I===2)h=!0;else if(I){const A=l[0],D=u[0];if(A>0&&A<1&&D>0&&D<1)return!1;h=!0}}if(!h)return!1;const m=X.constructEmpty(),f=X.constructEmpty(),g=X.constructEmpty();let v,b;if(t.queryEnvelope(m),e.queryEnvelope(f),m.inflateCoords(1e3*s,1e3*s),f.inflateCoords(1e3*s,1e3*s),g.setCoords({env2D:m}),g.intersect(f),t.getPointCount()>10){if(v=ps(t,g,s,0,i),v.isEmpty())return!1}else v=t;if(e.getPointCount()>10){if(b=ps(e,g,s,0,i),b.isEmpty())return!1}else b=e;return Jl(v,b,s,"F********",i,!1)}function Drt(t,e,s,i){const r=t.getImpl(),n=e.getImpl(),o=r.querySegmentIterator(),a=n.querySegmentIterator(),l=Me(2,Number.NaN),u=Me(2,Number.NaN),c=new al(r,n,s);let h=!1;for(;c.next();){const w=c.getRedElement(),S=c.getBlueElement();o.resetToVertex(w,-1),a.resetToVertex(S,-1);const T=o.nextSegment(),P=a.nextSegment();let I=0;if(Tx(T,P)?!h&&P.isIntersecting(T,s)&&(h=!0):I=P.intersect(T,null,u,l,s),I===2)h=!0;else if(I){const A=l[0],D=u[0];if(A>0&&A<1&&D>0&&D<1)return!0;h=!0}}if(!h)return!1;const m=X.constructEmpty(),f=X.constructEmpty(),g=X.constructEmpty(),v=X.constructEmpty(),b=X.constructEmpty();if(t.queryEnvelope(m),e.queryEnvelope(f),SC(f,m,s)){let w,S;if(g.setCoords({env2D:m}),g.inflateCoords(1e3*s,1e3*s),v.setCoords({env2D:f}),v.inflateCoords(1e3*s,1e3*s),b.setCoords({env2D:g}),b.intersect(v),t.getPointCount()>10){if(w=ps(t,b,s,0,i),w.isEmpty())return!1}else w=t;if(e.getPointCount()>10){if(S=ps(e,b,s,0,i),S.isEmpty())return!1}else S=e;return Jl(w,S,s,"T********",i,!1)}return Jl(t,e,s,"T*****T**",i,!1)}function $rt(t,e,s,i){const r=[!1],n=Sve(t,e,s,r);if(r[0])return n;const o=X.constructEmpty();let a;if(e.queryEnvelope(o),o.inflateCoords(1e3*s,1e3*s),t.getPointCount()>10){if(a=ps(t,o,s,0,i),a.isEmpty())return!1}else a=t;return pit(a,e,s,i)}function Rrt(t,e,s,i){return Bo(t,e,s)===1}function krt(t,e,s,i){return Bo(t,e,s)===2}function $ve(t,e,s,i){const r=new M,n=s*s;for(let o=0;o<t.getPointCount();o++)if(t.queryXY(o,r),M.sqrDistance(r,e)<=n)return!1;return!0}function Rve(t,e,s){const i=t.getBoundary();return!i.isEmpty()&&!$ve(i,e,s)}function Frt(t,e,s){const i=X.constructEmpty();return i.setCoords({env2D:t}),i.inflateCoords(s,s),i.containsEnvelope(e)?1073741824:i.isIntersecting(e)?t.isIntersecting(e)?t.xmin<e.xmin&&e.xmax<t.xmax?e.ymin<t.ymin&&e.ymax>t.ymax?0:1073741824:t.ymin<e.ymin&&e.ymax<t.ymax?e.xmin<t.xmin&&e.xmax>t.xmax?0:1073741824:0:0:4}function Tx(t,e){return t.getGeometryType()!==G.enumLine||e.getGeometryType()!==G.enumLine}function Ort(t,e,s,i,r,n,o,a){return{m_ivertexA:t,m_ipathA:e,m_scalarA0:s,m_scalarA1:i,m_ivertexB:r,m_ipathB:n,m_scalarB0:o,m_scalarB1:a}}class Lrt{constructor(){this.m_overlapEvents=[]}compareOverlapEvents(e,s){const i=this.m_overlapEvents[e],r=this.m_overlapEvents[s];return i.m_ipathA<r.m_ipathA||i.m_ipathA===r.m_ipathA&&(i.m_ivertexA<r.m_ivertexA||i.m_ivertexA===r.m_ivertexA&&(i.m_scalarA0<r.m_scalarA0||i.m_scalarA0===r.m_scalarA0&&(i.m_scalarA1<r.m_scalarA1||i.m_scalarA1===r.m_scalarA1&&i.m_ivertexB<r.m_ivertexB)))?-1:1}}function kve(t,e,s){const i=ait(t,e,s);return i?i===1?1:2:0}function Bo(t,e,s){const i=lD(t,e,s);return i?i===1?1:2:0}function Vrt(t,e,s,i,r){for(let n=0;n<s;n++)r[n]=Bo(t,e[n],i)}function eB(t,e,s,i,r){if(t.getGeometryType()===G.enumPolygon)Vrt(t,e,s,i,r);else if(t.getGeometryType()===G.enumEnvelope){const n=X.constructEmpty();t.queryEnvelope(n),qrt(n,e,s,i,r)}else Us("")}function Fve(t,e,s,i,r){const n=t.getGeometryType();n===G.enumPolyline?Brt(t,e,s,i,r):zi(n)?Urt():Us("")}function qrt(t,e,s,i,r){if(t.isEmpty()){for(let a=0;a<s;a++)r[a]=0;return}const n=t.clone();n.inflateCoords(.5*-i,.5*-i);const o=t.clone();o.inflateCoords(.5*i,.5*i);for(let a=0;a<s;a++)n.contains(e[a])?r[a]=1:o.contains(e[a])?r[a]=2:r[a]=0}function Grt(t){if(t.isEmpty())return 0;switch(t.getGeometryType()){case G.enumMultiPoint:return t.getImpl().getPointCount();case G.enumPolyline:return t.getImpl().getPathCount();case G.enumPolygon:return t.getImpl().getOGCPolygonCount();case G.enumGeometryCollection:return t.getGeometryCount()}return 1}function zrt(t,e,s){if(s.reset(),e<3)return;const i=t[0].clone(),r=i.x,n=i.y,o=t[1].clone(),a=new M;for(let l=2;l<e;l++)a.assign(t[l]),s.pe((a.x-i.x)*(o.y-n)),i.assign(o),o.assign(a);s.pe((r-i.x)*(o.y-n))}function Urt(t,e,s,i,r){F(0)}function Brt(t,e,s,i,r){const n=t.getImpl(),o=n.getAccelerators();let a=null;o&&(a=o.getRasterizedGeometry());let l=s;for(let u=0;u<s;u++)r[u]=1,a&&F(0);if(l){if(o){let c=null;o!==null&&o.getQuadTree()!==null&&(c=o.getQuadTree());const h=n.getPointCount();if(c===null&&h>20&&h*s>4*h+Math.log(h)*s&&(c=Lb(n)),c){let m=null;const f=n.querySegmentIterator(),g=new X;for(let v=0;v<s&&l;v++)if(r[v]===1){g.setCoords(e[v]),m===null?m=c.getIterator(g,i):m.resetIterator(g,i);let b=-1;for(let w=m.next();w!==-1;w=m.next()){if(f.resetToVertex(c.getElement(w),b),b=f.getPathIndex(),f.nextSegment().isIntersectingPoint(e[v],i)){r[v]=2,l--;break}r[v]=0}}return}}const u=n.querySegmentIterator();for(;u.nextPath()&&l;)for(;u.hasNextSegment()&&l;){const c=u.nextSegment();for(let h=0;h<s&&l;h++)r[h]===1&&c.isIntersectingPoint(e[h],i)&&(r[h]=2,l--)}}for(let u=0;u<s;u++)r[u]===1&&(r[u]=0)}function jrt(t,e,s,i,r){const n=Bh(e),o=Math.max(4*n,s);return new cD(e,null,o,Number.NaN,r).approximateWithCirclesImpl(t,i)}function Hrt(){return Number.isNaN(this.radius.value())}function Yrt(){return{ptStart:new M,ptEnd:new M,center:new je,radius:new le,fcenter:new zs,fradius2:new Ae,maxError:Number.NaN,isLine:Hrt}}const Xrt=5,Wrt=1/8;function d2(t,e,s,i){return{pt:t.clone(),t:e,err:s,checkCount:i}}class cD{constructor(e,s,i,r,n){this.m_left=e,this.m_tracker=n,this.m_eps=i,this.m_trackerCounter=0,this.m_tolerance=r,this.m_circleCheckCounter=0,this.m_bReversedLeft=!1,this.m_leftArc=Yrt()}closeToCircularArc(e,s,i,r,n,o){if(this.m_circleCheckCounter++,o.maxError=0,!cD.checkSweepAngle(e,s))return!1;if(o.ptStart.setCoordsPoint2D(i),o.ptEnd.setCoordsPoint2D(n),e.isCircular()){const I=e;return o.fradius2=Ae.constructDouble(I.getSemiMajorAxis()).mulDouble(I.getSemiMajorAxis()),o.radius.set(I.getSemiMajorAxis()),o.fcenter.assignPoint2D(I.getCenter()),o.center.set(I.getCenter()),!0}const a=o.ptEnd.sub(o.ptStart).clone();if(a.leftPerpendicularThis(),a.normalize(),Math.abs(a.dotProduct(r.sub(o.ptStart)))<=this.m_eps)return!!this.confirmIsLine(o,a)&&(o.radius.set(Number.NaN),o.center.setCoords(0,0),!0);{const I=o.ptEnd.sub(o.ptStart),A=r.sub(o.ptStart),D=I.crossProduct(A);if(D===0)return!1;const k=.5*I.sqrLength(),R=.5*A.sqrLength();let O=k*A.y-R*I.y;O/=D;let z=I.x*R-A.x*k;z/=D;const q=Math.sqrt(O*O+z*z);if(4*Number.EPSILON*q>this.m_eps)return!1;const U=O+o.ptStart.x,V=z+o.ptStart.y;o.radius.set(q),o.center.setCoords(U,V);const B=this.maxCircleApproximationError(e,s,o);if(B>this.m_eps)return o.maxError=B,!1}const l=new zs().assignPoint2D(o.ptStart),u=new zs().assignPoint2D(o.ptEnd).sub(l),c=new zs().assignPoint2D(r).sub(l),h=u.crossProduct(c);if(h.isZero())return!1;const m=u.sqrLength().mulDouble(.5),f=c.sqrLength().mulDouble(.5),g=m.mul(c.y).sub(f.mul(u.y)),v=u.x.mul(f).sub(c.x.mul(m)),b=g.mul(g).add(v.mul(v)),w=h.clone();w.invertThis(),o.fradius2=b.mul(w).mul(w),o.fcenter.setCoords(g.mul(w).add(l.x),v.mul(w).add(l.y)),o.center.setWithEps(o.fcenter.asPoint2D()),o.radius.setWithEps(Math.sqrt(o.fradius2.toDouble()));const S=je.constructPoint2D(o.ptStart).subE(o.center),T=je.constructPoint2D(o.ptEnd).subE(o.center);if(!S.dotProduct(T).gt(bx))return!1;const P=this.maxCircleApproximationError(e,s,o);return o.maxError=P,P<=this.m_eps}static checkSweepAngle(e,s){if(e.getGeometryType()===G.enumEllipticArc){const i=e,r=Iu(i,s.vmin),n=Iu(i,s.vmax);return!(Math.abs(n-r)>.5*Nt)}return!0}confirmIsLine(e,s){const i=e.ptEnd.sub(e.ptStart);return!(Math.abs(s.dotProduct(i.mul(.25)))>this.m_eps)&&!(Math.abs(s.dotProduct(i.mul(.75)))>this.m_eps)}maxCircleApproximationError(e,s,i){const r=[.25,.75],n=[.1,.25,.75,.9];let o,a;e.getGeometryType()===G.enumEllipticArc?(o=r,a=r.length):(o=n,a=n.length);let l=0;for(let u=0;u<a;++u){const c=new M;e.queryCoord2D(zt(s.vmin,s.vmax,o[u]),c);const h=c.sub(i.center.value()).length(),m=Math.abs(h-i.radius.value());m>l&&(l=m)}return l}approximateWithCirclesImpl(e,s){let i=1;s&&s.push(0);const r=Me(9,Number.NaN);let n;e?n=this.m_left.getMonotonicPartParams(r.length,r):(r[0]=0,r[1]=1,n=2);const o=[],a=[],l=new M(0,0);for(let u=1;u<n;u++){const c=new de(r[u-1],r[u]);for(this.m_bReversedLeft=!cD.goodOrientation(this.m_left,c),this.m_bReversedLeft?(o.push(d2(l,c.vmin,0,0)),o.push(d2(l,c.vmax,0,0))):(o.push(d2(l,c.vmax,0,0)),o.push(d2(l,c.vmin,0,0))),o[0].pt=this.m_left.getCoord2D(o[0].t),o[1].pt=this.m_left.getCoord2D(o[1].t);o.length>1;){this.progress_();const h=o.at(-1);let m=h.checkCount,f=h.err;const g=h.pt.clone(),v=h.t,b=o[o.length-2].t,w=.5*(v+b),S=this.m_left.getCoord2D(w);if(f<=this.m_eps||m>=Xrt){const T=new de;if(T.setCoords(v,b),this.closeToCircularArc(this.m_left,T,g,S,o[o.length-2].pt,this.m_leftArc)){s&&(this.m_bReversedLeft?a.push(v):s.push(b)),i++,o.pop();continue}m=0,f=this.m_leftArc.maxError}h.t=w,h.pt.setCoordsPoint2D(S),f*=Wrt,m++,h.err=f,h.checkCount=m,o.push(d2(g,v,f,m))}this.m_bReversedLeft&&s&&(s.length=s.length+a.length,$s(s,a.reverse(),s.length-a.length,0,a.length),a.length=0),o.length=0}return i}approximateWithCirclesImplPolyline(e){const s=new qt,i=[];if(!this.approximateWithCirclesImpl(!0,i))return s;let r=0;const n=this.m_left.getStartXY();s.startPath(n);for(let o=1;o<i.length;++o)if(e)s.lineTo(this.m_left.getCoord2D(i[o]));else{const a=new M;this.m_left.queryCoord2D(i[o],a);const l=new M;this.m_left.queryCoord2D(.5*(i[o]+r),l);const u=new Kc;u.constructCircularArcThreePoint(n,a,l),s.addSegment(u,!1),n.assign(a),r=i[o]}return s}static goodOrientation(e,s){const i=e.getCoord2D(s.vmin),r=e.getCoord2D(s.vmax);return i.compare(r)<0}progress_(e=!1){}}function Ol(t,e,s,i,r,n,o){Qrt(t,e,s,r,n,o)}function Zrt(t,e,s,i){if(!xt(t.getGeometryType()))return t;const r=t.getImpl();if(!r.hasNonLinearSegments())return t;const n=t.createInstance();n.getGeometryType()===G.enumPolygon&&n.setFillRule(t.getFillRule()),new oi;const o=new nt,a=new ut,l=[],u=[],c=[],h=t.getDescription().getAttributeCount()>1,m=r.querySegmentIterator();for(;m.nextPath();){let f=!0;for(;m.hasNextSegment();){const g=m.isClosingSegment(),v=m.nextSegment();if(!v.isCurve()){n.addSegment(v,f,g),f=!1;continue}let b,w=!1;const S=!0,T=!0;switch(v.getGeometryType()){case G.enumEllipticArc:case G.enumRationalBezier2:b=rD(v,e,s,S,T,u,c,l),w=!0;break;default:b=z9(v,e,s,!0,S,u,l)}const P=w?2:3;u[1].isNAN()?(a.createLine(),a.get().construct(u[0],u[P])):w?(a.createQuadraticRationalBezier(),a.get().constructArrayWeights(u,c)):(a.createCubicBezier(),a.get().constructPoints(u)),h&&f&&(v.queryCoord(l[0],o),a.get().setStart(o)),h&&(v.queryCoord(l[1],o),a.get().setEnd(o)),n.addSegment(a.get(),f,g&&b===1),f=!1;for(let I=1,A=b,D=P;I<A;++I,D+=P)u[D+1].isNAN()?(a.createLine(),a.get().construct(u[D],u[D+P])):w?(a.createQuadraticRationalBezier(),a.get().constructArrayWeights(u.slice(D),c.slice(D))):(a.createCubicBezier(),a.get().constructPoints(u.slice(D))),h&&(v.queryCoord(l[I+1],o),a.get().setEnd(o)),n.addSegment(a.get(),!1,g&&I+1===A)}}return n}function Qrt(t,e,s,i,r,n){t.hasCurves()?(t.setCurveStitcherPointer(i),i.m_impl=new Cf(n,!1,null),i.m_impl.buildMonotonicCurveParentage(t,e,s,r)):i.m_impl=null}function Ove(t,e,s,i,r,n,o,a){t.hasCurves()?(t.setCurveStitcherPointer(n),n.m_impl=new Cf(a,!0,r),n.m_impl.buildMonotonicCurveParentage(t,e,s,o),int(t,s,a)):n.m_impl=null}function Jrt(t){if(!t.hasSegmentParentage())return;const e=new Qs(0),s=t.queryVertexIteratorOnSelection();for(let o=s.next();o!==L;o=s.next())e.add(o);if(e.size()===0)return;t.sortVerticesSimpleByY(e,0,e.size()),e.add(L);const i=M.getNAN();t.queryXY(e.read(0),i);let r=0;const n=M.getNAN();for(let o=1,a=e.size();o<a;o++){{const l=e.read(o);l!==L?t.queryXY(l,n):n.setNAN()}if(!n.isEqualPoint2D(i)){let l=!1,u=-2;for(let c=r;c<o;++c){const h=e.read(c);if(t.getSegmentParentageBreakVertex(h)){l=!0;break}let m=t.getSegmentParentage(h);const f=t.getPrevVertex(h);if(f!==L){let g=t.getSegmentParentage(f);if(m===-1&&(m=g),g===-1&&(g=m),m!==g){l=!0;break}}if(u!==-2&&m!==u){l=!0;break}u=m}if(l)for(let c=r;c<o;++c)t.setSegmentParentageBreakVertex(e.read(c),!0);i.setCoordsPoint2D(n),r=o}}}function Krt(t,e){let s=e.isEmpty()?t:Ji(null,e,!0).total();return s>t&&(s=t),.125*s}function ja(t,e){return e||(e=X.constructEmpty()),Krt(t,e)}function Oc(t,e){return .125*t}function Vc(t,e){return 3*t+3*e}class Ha{constructor(){this.m_impl=null}stitchCurves(e,s,i,r){this.m_impl&&(this.m_impl.stitchCurves(e,s,i),r&&this.clearStitcher(e))}clearStitcher(e){this.m_impl&&(this.m_impl.clearStitcher(e),this.m_impl=null)}getOriginalVertexIndex(e,s){return this.m_impl.getOriginalVertexIndex(e,s)}getOriginalSegmentTypeInfo(e){return this.m_impl.getOriginalSegmentTypeInfo(e)}}class Cf{constructor(e,s,i){this.m_originalPlanarSegments=[],this.m_progressTracker=null,this.m_nsr=null,this.m_progressTracker=e,this.m_nsr=i,this.m_tolerance=0,this.m_originalVertexIndex=-1,this.m_type=0,this.m_progressCounter=0,this.m_bIsSimple=s}buildMonotonicCurveParentage(e,s,i,r){if(!e.hasCurves())return;F(!e.hasSegmentParentage()),this.m_type=1,this.m_originalPlanarSegments.length=0,this.m_bIsSimple&&(this.m_originalVertexIndex=e.createUserIndex()),this.m_tolerance=i;const a=new nt,l=new ut,u=[],c=[],h=[];for(let m=e.getFirstGeometry();m!==L;m=e.getNextGeometry(m))for(let f=e.getFirstPath(m);f!==L;f=e.getNextPath(f)){let g=e.getPathSize(f),v=e.getFirstVertex(f),b=0,w=-1;for(let S=0;S<g;S++){let T=e.getNextVertex(v);if(!e.querySegment(v,l,!0,!1)){v=T;continue}if(b===0){w=e.getVertexIndex(v);const R=Cf.regularizeCurve(e,l.get(),v,i);if(R>=0){this.m_nsr&&this.m_nsr.m_reason===0&&this.m_nsr.assign(new gs(13,w,-1)),b=R,g=e.getPathSize(f),T=e.getNextVertex(v);const O=e.querySegment(v,l,!0,!1);F(O)}}else b--;const P=e.getVertexIndex(v);let I;this.m_originalVertexIndex!==-1&&e.setUserIndex(v,this.m_originalVertexIndex,w),e.setSegmentToIndex(P,null);let A=!1;switch(l.get().getGeometryType()){case G.enumEllipticArc:case G.enumRationalBezier2:I=rD(l.get(),s,i,!1,!0,c,h,u),A=!0;break;default:{const R=!this.m_bIsSimple||!l.get().isMonotoneQuickAndDirty();I=z9(l.get(),s,i,R,!1,c,u)}}const D=this.m_originalPlanarSegments.length;if(e.setSegmentParentageAndBreak(v,D,!0),!c[1].isNAN()){let R=null;R=A?new Oo({points:c,weights:h}):new Hl({cp:c}),R.snapControlPoints(i*i),e.setSegmentToIndex(P,R)}const k=A?2:3;for(let R=1,O=I,z=k;R<O;++R,z+=k){l.get().queryCoord(u[R],a);const q=e.insertVertex(f,T,a);if(this.m_originalVertexIndex!==-1&&e.setUserIndex(q,this.m_originalVertexIndex,w),!c[z+1].isNAN())if(A){const U=new Oo({points:c.slice(z),weights:h.slice(z)});U.snapControlPoints(i*i),e.setSegmentToIndex(e.getVertexIndex(q),U)}else{const U=new Hl({cp:c.slice(z)});U.snapControlPoints(i*i),e.setSegmentToIndex(e.getVertexIndex(q),U)}e.setSegmentParentageAndBreak(q,D,!1)}I>1&&(S+=I-1,g=e.getPathSize(f)),this.m_originalPlanarSegments.push(l.releaseSegment()),v=T}}}stitchCurves(e,s,i){Cf.st_stitchCurvesImpl(this,e,s,i,!1)}clearStitcher(e){this.m_originalPlanarSegments.length=0,this.m_originalVertexIndex!==-1&&(e.removeUserIndex(this.m_originalVertexIndex),this.m_originalVertexIndex=-1),e.deleteSegmentParentage()}static st_verifyParentage(e){Cf.st_stitchCurvesImpl(null,e,L,0,!0)}getOriginalVertexIndex(e,s){return this.m_originalVertexIndex!==-1&&s!==L?e.getUserIndex(s,this.m_originalVertexIndex):-1}getOriginalSegmentTypeInfo(e){if(e!==-1){const s=this.m_originalPlanarSegments[e];switch(s.getGeometryType()){case G.enumEllipticArc:return s.projectionBehavior()===0?0:1;case G.enumBezier:return 2;case G.enumBezier2:return 3;case G.enumLine:return-1;case G.enumRationalBezier2:return 4;default:yt("")}}return-1}progress_(e=!1){this.m_progressCounter++}processSpan_(e,s,i,r,n,o,a){if(s===i&&r===0)return F(e.getNextVertex(s)===L),e.setSegmentToIndex(e.getVertexIndex(s),null),void e.setSegmentParentageAndBreak(s,-1);const l=e.getNextVertex(s);{let h=2;for(let m=l;m!==i;m=e.getNextVertex(m))h++;F(h===r)}if(n===null){e.setSegmentToIndex(e.getVertexIndex(s),null);for(let h=l;h!==i;)h=e.removeVertex(h,!0);return}const u=e.getXY(s),c=e.getXY(i);if(n.isClosed()){if(u.isEqualPoint2D(c)&&u.isEqualPoint2D(n.getStartXY())){let h;if(h=this.verifySegmentFitness(e,s,i,r,n,o,a)){const m=n.clone();return m.dropAllAttributes(),h<0&&m.reverse(),this.removeSpan(e,s,i),void e.setSegmentToIndex(e.getVertexIndex(s),m)}}}else if(u.isEqualPoint2D(n.getStartXY())){if(c.isEqualPoint2D(n.getEndXY())){const h=n.clone();if(h.dropAllAttributes(),this.verifySegmentFitness(e,s,i,r,h,o,a))return this.removeSpan(e,s,i),void e.setSegmentToIndex(e.getVertexIndex(s),h)}}else if(c.isEqualPoint2D(n.getStartXY())&&u.isEqualPoint2D(n.getEndXY())){const h=n.getReversed();if(h.dropAllAttributes(),this.verifySegmentFitness(e,s,i,r,h,o,a))return this.removeSpan(e,s,i),void e.setSegmentToIndex(e.getVertexIndex(s),h)}this.processSpanSplitSegment(e,s,i,r,n,o,a)}processSpanSplitSegment(e,s,i,r,n,o,a){if(n.isLine()||this.fitSegmentToSpan(e,s,i,r,n,o,a))return;const l=a*a;let u=r,c=s;const h=e.getXY(s);let m=n.getClosestCoordinate(h,!1);const f=n.getCoord2D(m);let g=!1;const v=M.sqrDistance(h,f);if(v>l){const D=e.getNextVertex(s);if(this.approximateSpanSection(e,s,n,o,a),D===i)return;c=D,g=!0,u-=1}let b=i;const w=e.getXY(i);m=n.getClosestCoordinate(w,!1);const S=n.getCoord2D(m);let T=!1;const P=M.sqrDistance(w,S);if(P>l){const D=e.getPrevVertex(i);if(this.approximateSpanSection(e,D,n,o,a),D===c)return;b=D,T=!0,u-=1}if((g||T)&&this.fitSegmentToSpan(e,c,b,u,n,o,a))return;let I=!1;if(!g&&v>0){const D=e.getNextVertex(s);if(this.approximateSpanSection(e,s,n,o,a),D===b)return;c=D,g=!0,I=!0,u-=1}if(!T&&P>0){const D=e.getPrevVertex(i);if(this.approximateSpanSection(e,D,n,o,a),D===c)return;b=D,T=!0,I=!0,u-=1}if(I&&this.fitSegmentToSpan(e,c,b,u,n,o,a))return;let A=c;for(;;){const D=e.getNextVertex(A);if(this.approximateSpanSection(e,A,n,o,a),A=D,A===b)return}}fitSegmentToSpan(e,s,i,r,n,o,a){const l=this.m_type===0,u=[];if(u.push(e.getXY(s)),l){let m=s;const f=32;if(r>f){const g=BigInt(r-1),v=BigInt(f-1);let b=v,w=0n;for(let S=1;S<r;S++,b+=v)if(m=e.getNextVertex(m),b>=w+g){w+=g;const T=e.getXY(m);u.push(T)}F(m===i)}else{for(let g=1;g<r;g++){m=e.getNextVertex(m);const v=e.getXY(m);u.push(v)}F(m===i)}}else{let m=s;const f=new ut;for(;;){e.querySegment(m,f,!1,!0);const g=[.1,.25,.4,.5,.6,.75,.9,1];let v=0;for(const b of g)(r===2||1&v)&&u.push(f.get().getCoord2D(b)),v++;if(m=e.getNextVertex(m),m===i)break}}const c=(()=>{let m=u[0].compare(u.at(-1));if(m===0){const f=new Fr(0);zrt(u,u.length,f),m=f.getResult()>=0?-1:1}return m>0})();c&&u.reverse();const h=n.clone();if(h.dropAllAttributes(),h.setSegmentFromCoords(u,u.length),c&&h.reverse(),h.snapControlPoints(this.m_tolerance*this.m_tolerance),this.verifySegmentFitness(e,s,i,r,h,o,a)){this.removeSpan(e,s,i);const m=e.getVertexIndex(s);return e.setSegmentToIndex(m,h),!0}return!1}approximateSpanSection(e,s,i,r,n){const o=new ut;if(!e.querySegment(s,o,!0,!1))return;const a=i.getGeometryType();if(a!==o.get().getGeometryType()){if(a===G.enumEllipticArc){if(o.get().getGeometryType()!==G.enumRationalBezier2)return;if(i.projectionBehavior()===0){const l=[];jrt(!1,o.get(),n,l,this.m_progressTracker);const u=e.getNextVertex(s),c=e.getPathFromVertex(s),h=new nt;let m=s;for(let f=1,g=l.length;f<g;f++){const v=l[f],b=o.get().getCoord2D(l[f-1]),w=o.get().getCoord2D(zt(l[f-1],v,.5));o.get().queryCoord(v,h);const S=h.getXY(),T=new Kc;T.constructCircularArcThreePoint(b,S,w);let P=L;v<1&&(P=e.insertVertex(c,u,h)),e.setSegmentToIndex(e.getVertexIndex(m),T),m=P}return}{const l=ne(M,3);o.get().queryControlPoints(l);const u=[0,0,0];o.get().queryWeights(u);const c=zu(u),h=new Kc;return Wtt(l,c*c,null,!1,h),void e.setSegmentToIndex(e.getVertexIndex(s),h)}}Ce("approximate_span_section_")}}verifySegmentFitness(e,s,i,r,n,o,a){return this.m_type===0?this.verifySegmentFitnessLines(e,s,i,r,n,o,a):this.verifySegmentFitnessCurves(e,s,i,r,n,o,a)}verifySegmentFitnessCurves(e,s,i,r,n,o,a){const l=e.getXY(s),u=e.getXY(i);if(!l.isEqualPoint2D(n.getStartXY())||!u.isEqualPoint2D(n.getEndXY()))return 0;let c=0;if(n.isClosed()){const S=n.getCoord2D(.1).sub(l);c=n.getCoord2D(.7).sub(l).crossProduct(S)>=0?1:-1}const h=Me(SP.s_maxMonotonicPartParams,Number.NaN);let m=n.getMonotonicPartParams(h.length,h);m--;const f=new pt,g=[1,.5,.75,.25];let v=0,b=s;const w=l.clone();for(;;){const S=e.getNextVertex(b);let T=e.getSegment(b);T===null&&(e.queryLineConnector(b,f,!0),T=f);for(let P=S===i?1:0;P<g.length;P++){const I=T.getCoord2D(g[P]);if(!n.isCloserThanDistance(I,de.unit(),a))return 0}if(m>1)for(let P=1;P<m;){const I=n.getCoord2D(h[P]);T.isCloserThanDistance(I,de.unit(),a)?(h[m-1]=be(h[P],h[P]=h[m-1]),m--):P++}if(c){const P=T.getCoord2D(.25);v+=P.sub(l).crossProduct(w.sub(l)),w.assign(P),P.assign(T.getCoord2D(.75)),v+=P.sub(l).crossProduct(w.sub(l)),w.assign(P)}if(b=S,b===i)return m>1?0:c?v<0?-c:c:1}}verifySegmentFitnessLines(e,s,i,r,n,o,a){return F(0),0}removeSpan(e,s,i){e.setSegmentToIndex(e.getVertexIndex(s),null);const r=e.getNextVertex(s);r!==i&&e.removeVertices(r,i)}static st_stitchCurvesImpl(e,s,i,r,n){if(s.hasSegmentParentage())return s.hasCurves()?Cf.st_stitchCurvesFromCurvesImpl(e,s,i,r,n):Cf.st_stitchCurvesFromLinesImpl(e,s,i,r,n)}static st_stitchCurvesFromLinesImpl(e,s,i,r,n){let o=i===L?s.getFirstGeometry():i;for(;o!==L;){for(let a=s.getFirstPath(o);a!==L;a=s.getNextPath(a)){let l=s.getPathSize(a);s.isClosedPath(a)&&(l+=1);let u=!0,c=!1;const h=s.getFirstVertex(a);let m=h;for(let f=0;f<l&&m!==L;){let g=s.getSegmentParentage(m);if(g===-1||u){u=!1,f++,m=s.getNextVertex(m),c=!0;continue}let v,b,w=0;if(c?(v=s.getPrevVertex(m),b=m,F(v!==L),F(b!==v),F(s.getSegmentParentage(v)===-1||h===v)):(v=m,b=s.getNextVertex(v),f++,F(b!==L),F(b!==v),g=s.getSegmentParentage(b)),w=2,c=!1,g===-1||s.getSegmentParentageBreakVertex(b)){m=b;continue}let S=s.getNextVertex(b);for(f++;f<l&&S!==L;){b=S,w++;const T=s.getSegmentParentage(S);if(T===-1||s.getSegmentParentageBreakVertex(S))break;F(T===g),f++,S=s.getNextVertex(S)}if(!n){const T=e.m_originalPlanarSegments[g];e.processSpan_(s,v,b,w,T,g,r)}m=b}}if(i!==L)break;o=s.getNextGeometry(o)}}static st_stitchCurvesFromCurvesImpl(e,s,i,r,n){let o=i===L?s.getFirstGeometry():i;for(;o!==L;)if(UQe(s.getGeometryType(o))){for(let a=s.getFirstPath(o);a!==L;a=s.getNextPath(a)){let l=s.getPathSize(a);const u=s.isClosedPath(a);u&&(l+=1);let c=s.getFirstVertex(a);if(u){if(s.getSegmentParentage(c)!==-1){let m=c;for(let f=0;!s.getSegmentParentageBreakVertex(m);f++){if(f===l){c=s.getFirstVertex(a),s.setSegmentParentageBreakVertex(m,!0);break}m=s.getPrevVertex(m)}}}else F(s.getSegmentParentage(c)===-1||s.getSegmentParentageBreakVertex(c));let h=c;for(let m=0;m<l&&h!==L;){const f=s.getSegmentParentage(h);if(f===-1){m++,h=s.getNextVertex(h);continue}let g=0,v=L;const b=h;g=1;let w=s.getNextVertex(b);for(;m<l&&w!==L;){m++,v=w,g++;const S=s.getSegmentParentage(w);if(S===-1||s.getSegmentParentageBreakVertex(w))break;F(S===f),w=s.getNextVertex(w)}if(v===L)break;if(!n){const S=e.m_originalPlanarSegments[f];e.processSpan_(s,b,v,g,S,f,r)}h=v}}if(i!==L)break;o=s.getNextGeometry(o)}else o=i===L?s.getNextGeometry(o):L}static regularizeCurve(e,s,i,r){let n=s.snapControlPoints(r*r);if(n){const o=e.getVertexIndex(i),a=s.clone();e.setSegmentToIndex(o,a)}if(s.getGeometryType()===Hl.type){const o=[],a=s.calculateSpecialPointsForCracking(r,o);if(a>0){e.splitSegment(i,o,a),n=e.snapControlPoints(i,a+1,r*r)||n;for(let l=0;l<a;l++)i=e.getNextVertex(i),e.setSegmentParentageBreakVertex(i,!0);return a}}return n?0:-1}}function Ac(t,e,s,i,r){return new xR(t,s,e,i,r).do_()}function ent(t,e,s){const i=il(t);return Z9(e.getX(),e.getY(),s.getX(),s.getY(),Pt(i))}function tnt(t,e,s=1,i=1,r=1,n=1){if(i>n)return t;if(n>i)return e;const o=[0],a=[0],l=new nt;return jst(t,e,s,i,r,n,l,a,o),l}function snt(t,e,s){const i=il(e),r=T9(e);return!!Hst(t,i,L,null,s)||Q9(!0,t,r,null,s)}function int(t,e,s){return xR.fixCurveTwoPointLoops(t,e,s)}function Lve(t){return il(t)}class xR{constructor(e,s,i,r,n){this.m_shape=e,this.m_progressTracker=s,this.m_tolerance=i,this.m_bFilterDegenerateSegments=r,this.m_bTrackChanges=n,this.m_progressCounter=0}do_(){const e=new Uo(this.m_tolerance.tolerance,this.m_tolerance.resolution),s=1e-5,i=1e-6,r=Lve(e);let n=T9(e);const o=n*(1+s);n*=1+i;let a=!1;const l=this.m_shape.getTotalPointCount()+10>30?1e3:(this.m_shape.getTotalPointCount()+10)*(this.m_shape.getTotalPointCount()+10),u=this.m_shape.hasPointFeatures();for(let c=0;;c++){this.m_shape.dbgCheckSelection(),c>l&&Ce("crack_and_cluster_iteration_exceeded"),this.m_shape.dbgVerifyMonotone();let h=-1;c===0&&(h=this.firstCrack_(),a||(a=h>0));const m=this.cluster_(r);if(this.m_shape.dbgVerifyMonotone(),a||(a=m),this.m_bFilterDegenerateSegments){const v=this.m_shape.filterClosePoints(r,!0,!1,this.m_bTrackChanges,L)!==0;a||(a=v),this.m_shape.dbgVerifyMonotone()}const f=this.m_shape.snapControlPointsOnSelection(o*o);a||(a=f),this.m_shape.dbgCheckSelection();let g=!1;if((c===0&&h===-1||u||Q9(!0,this.m_shape,n,null,this.m_progressTracker))&&(g=this.crack_(o),a||(a=g),this.m_shape.dbgVerifyMonotone()),!g&&!xR.fixCurveTwoPointLoops(this.m_shape,r,this.m_progressTracker)){this.m_shape.dbgVerifyMonotone();break}}return a&&Jrt(this.m_shape),a}cluster_(e){return lve(this.m_shape,e,L,this.m_bTrackChanges,this.m_progressTracker)}crack_(e){return sit(this.m_shape,e,this.m_bTrackChanges,this.m_progressTracker)}static fixCurveTwoPointLoops(e,s,i){if(!e.hasCurves())return!1;e.dbgVerifyCurves();const r=e.createUserIndexUninitialized(),n=new Qs(0),o=e.queryVertexIteratorOnSelection();for(let h=o.next();h!==L;h=o.next())n.add(h),e.setUserIndex(h,r,-1);if(n.size()===0)return!1;n.add(L),e.sortVerticesSimpleByY(n,0,n.size()-1);let a=0;const l=e.getXY(n.read(a)),u=new M(Number.NaN,Number.NaN),c=[];for(let h=1,m=n.size();h<m;++h){const f=n.read(h),g=f!==L?e.getXY(f):u;if(g.equals(l))continue;const v=[];for(let b=a;b<h;b++){const w=n.read(b),S=e.getPrevVertex(w);if(S!==L&&e.getUserIndex(S,r)===-1){const P=bL(e.getXY(S),e.getSegment(S));M.sqrDistance(l,P.otherPt)!==0&&(P.vert=S,P.dir=-1,v.push(P)),e.setUserIndex(S,r,1)}const T=e.getNextVertex(w);if(T!==L&&e.getUserIndex(w,r)===-1){const P=bL(e.getXY(T),e.getSegment(w));M.sqrDistance(l,P.otherPt)!==0&&(P.vert=w,P.dir=1,v.push(P)),e.setUserIndex(w,r,1)}}if(v.length>1){v.sort((S,T)=>ont(S,T));const b=bL(u.clone(),null);v.push(b);let w=0;for(let S=1,T=v.length;S<T;S++)if(!v[S].otherPt.equals(v[S-1].otherPt)){if(S-w>1&&v[w].seg!==null){let P=!1;const I=w;for(let A=w+1;A<S;A++)if(!rnt(v[I],v[A])){P=!0;break}if(P)for(let A=w;A<S&&v[A].seg!==null;A++)c.push(v[A].vert)}w=S}}a=h,l.setCoordsPoint2D(g)}for(const h of c){const m=e.getSegment(h);F(m!==null);const f=e.getXY(h),g=e.getXY(e.getNextVertex(h));if(M.distance(f,g)<3*s)e.setSegmentToIndex(e.getVertexIndex(h),null);else{const v=m.lengthToT(.5*m.calculateLength2D());e.splitSegment(h,[v],1)}}return e.removeUserIndex(r),c.length>0}firstCrack_(){const e=this.m_shape.getEnvelope2D(this.m_progressTracker),s=Ji(null,e,!0).total();if(4*s<this.m_tolerance.total()){let i=!1;const r=1.1*s,n=s,o=this.cluster_(r);i||(i=o);let a=0;this.m_bFilterDegenerateSegments&&(a=this.m_shape.filterClosePoints(0,!0,!1,this.m_bTrackChanges,L));const l=this.crack_(n);return i||(i=l),i?1:a?2:0}return-1}progress_(e=!1){this.m_progressCounter++,!e&&4095&this.m_progressCounter||(this.m_progressCounter=0)}}function bL(t,e){return{otherPt:t,seg:e,vert:-1,dir:0}}function rnt(t,e){if(F(t.otherPt.equals(e.otherPt)),t.seg===null)return e.seg===null;if(e.seg===null)return!1;const s=t.seg.getGeometryType();if(s!==e.seg.getGeometryType())return!1;if(s===G.enumBezier){const i=t.seg,r=e.seg;let n=i.getControlPoint1(),o=i.getControlPoint2();t.dir===-1&&(o=be(n,n=o));let a=r.getControlPoint1(),l=r.getControlPoint2();return e.dir===-1&&(l=be(a,a=l)),n.equals(a)&&o.equals(l)}if(s===G.enumRationalBezier2){const i=t.seg,r=e.seg,n=i.getControlPoint1(),o=r.getControlPoint1();if(!n.equals(o))return!1;const a=[0,0,0];i.queryWeights(a),t.dir===-1&&(a[2]=be(a[0],a[0]=a[2]));const l=[0,0,0];return r.queryWeights(l),e.dir===-1&&(l[2]=be(l[0],l[0]=l[2])),a[0]===l[0]&&a[1]===l[1]&&a[2]===l[2]}Ce("")}function nnt(t,e){if(t.seg===null||e.seg===null)return t.seg!==null?-1:e.seg!==null?1:0;const s=t.seg.getGeometryType(),i=e.seg.getGeometryType();return s<i?-1:s>i?1:0}function ont(t,e){const s=t.otherPt.compare(e.otherPt);return s!==0?s:nnt(t,e)}var wR=xt,ant=zi,yM=ca;function lnt(t){switch(t){case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 0:return 0;default:F(0,"unrecognized cut side")}return 3}function ry(){return{unsplitBehavior:0,allCrossRoadsImpassable:!1,ogcRule:!1}}function unt(t,e,s,i){return new wa(i).autoCompleteImpl(t,e,s)}function NG(t,e,s,i,r,n,o){const a=new wa(r);a.m_bOGCOutput=!0;const l=t.getGeometryType()===G.enumPolygon&&t.getFillRule()===1&&!tm(i);return a.planarSimplifyImpl_(t,e,l,s,i,r,n,o)}function hD(t,e,s,i,r,n,o,a){return new wa(n).planarSimplifyImpl_(t,e,s,i,r,n,o,a)}function cnt(t,e,s,i){const r=new wa(i),n=new oi,o=n.addGeometry(e),a=r.planarSimplifyNoCrackingAndCluster(t,n,o,s);return F(a,"planar_simplify_no_cracking_and_cluster"),n.getGeometry(o)}function hnt(t,e,s,i,r,n,o){return F(0),{}}function mnt(t,e,s,i){return F(0),{}}function cne(t,e,s){return bnt(t,e,s)}function dnt(t,e,s,i){if(t.isEmpty()||e.isEmpty()||t.getDimension()>e.getDimension())return Ya(Qi(t),t,e,"-");const r=new X;t.queryEnvelope(r);const n=new X;e.queryEnvelope(n);const o=new X;o.setCoords({env2D:r}),o.mergeEnvelope2D(n);const a=Ji(s,o,!0),l=n.clone(),u=il(a);if(l.inflateCoords(u,u),!r.isIntersecting(l))return Ya(Qi(t),t,e,"-");const c=new wa(i),h=new oi,m=h.addGeometry(Qi(t)),f=h.addGeometry(Qi(e));let g=0,v=0,b=null;if(h.hasCurves()){b=new Ha;const T=h.getEnvelope2D(i);v=Oc(a.total());const P=ja(a.total(),T);g=Vc(P,v),Ol(h,P,a.total(),12e3,b,null,i)}c.setEditShapeCrackAndCluster(h,a.add(g));const w=c.difference(m,f);b!==null&&b.stitchCurves(h,w,v,!0);const S=Ya(h.getGeometry(w),t,e,"-");return wR(S.getGeometryType())&&(S.getImpl().setIsSimple(4,a.total()),S.getGeometryType()===G.enumPolygon&&S.getImpl().updateOGCFlagsProtected()),S}function pnt(t,e,s,i){if(t.getDimension()>e.getDimension())return Ya(Qi(t),t,e,"^");if(t.getDimension()<e.getDimension()||t.isEmpty())return Ya(Qi(e),t,e,"^");if(e.isEmpty())return Ya(Qi(t),t,e,"^");const r=new X;t.queryEnvelope(r);const n=new X;e.queryEnvelope(n);const o=new X;o.setCoords({env2D:r}),o.mergeEnvelope2D(n);const a=Ji(s,o,!0),l=new wa(i),u=new oi,c=u.addGeometry(Qi(t)),h=u.addGeometry(Qi(e));let m=0,f=null;if(u.hasCurves()){f=new Ha;const b=u.getEnvelope2D(i);m=Oc(a.total()),Ol(u,ja(a.total(),b),a.total(),12e3,f,null,i)}l.setEditShapeCrackAndCluster(u,a);const g=l.symmetricDifference(c,h);f!==null&&f.stitchCurves(u,g,m,!0);const v=Ya(u.getGeometry(g),t,e,"^");return wR(v.getGeometryType())&&(v.getImpl().setIsSimple(4,a.total()),v.getGeometryType()===G.enumPolygon&&v.getImpl().updateOGCFlagsProtected()),v}function hne(t,e,s){return vnt(t,e,s,!0)}function fnt(t,e,s){return t.isEmpty()||e.isEmpty()?t.createInstance():ent(s,t,e)?new nt({copy:tnt(t,e)}):t.createInstance()}function gnt(t,e,s,i){const r=X.constructEmpty();t.queryEnvelope(r);const n=X.constructEmpty();e.queryEnvelope(n);const o=X.constructEmpty();o.setCoords({env2D:r}),o.mergeEnvelope2D(n);const a=Ji(s,o,!0),l=new X(n),u=il(a);if(l.inflateCoords(u,u),!r.isIntersecting(l)){if(t.getDimension()<=e.getDimension())return Ya(Qi(t.createInstance()),t,e,"&");if(t.getDimension()>e.getDimension())return Ya(Qi(e.createInstance()),t,e,"&")}const c=new wa(i),h=new oi,m=h.addGeometry(Qi(t)),f=h.addGeometry(Qi(e));let g=0,v=0,b=null;if(h.hasCurves()){b=new Ha;const T=h.getEnvelope2D(i);v=Oc(a.total());const P=ja(a.total(),T);g=Vc(P,v),Ol(h,P,a.total(),12e3,b,null,i)}c.setEditShapeCrackAndCluster(h,a.add(g));const w=c.intersection(m,f);b!==null&&b.stitchCurves(h,w,v,!0);const S=Ya(h.getGeometry(w),t,e,"&");return wR(S.getGeometryType())&&(S.getImpl().setIsSimple(4,a.total()),S.getGeometryType()===G.enumPolygon&&S.getImpl().updateOGCFlagsProtected()),S}function ynt(t,e,s,i){const r=new Array(3),n=X.constructEmpty();t.queryEnvelope(n);const o=X.constructEmpty();e.queryEnvelope(o);const a=X.constructEmpty();a.setCoords({env2D:n}),a.mergeEnvelope2D(o);const l=Ji(s,a,!0),u=new X(o),c=il(l);if(u.inflateCoords(c,c),!n.isIntersecting(u)){if(t.getDimension()<=e.getDimension()){const T=Ya(Qi(t.createInstance()),t,e,"&");return r[T.getDimension()]=T,r}if(t.getDimension()>e.getDimension()){const T=Ya(Qi(e.createInstance()),t,e,"&");return r[T.getDimension()]=T,r}}const h=new wa(i),m=new oi,f=m.addGeometry(Qi(t)),g=m.addGeometry(Qi(e));let v=0,b=0,w=null;if(m.hasCurves()){w=new Ha;const T=m.getEnvelope2D(i);b=Oc(l.total());const P=ja(l.total(),T);v=Vc(P,b),Ol(m,P,l.total(),12e3,w,null,i)}h.setEditShapeCrackAndCluster(m,l.add(v)),m.dbgVerifyCurves();const S=h.intersectionEx(f,g);for(const T of S){w!==null&&w.stitchCurves(m,T,b,!1);const P=Ya(m.getGeometry(T),t,e,"&");wR(P.getGeometryType())&&(P.getImpl().setIsSimple(4,l.total()),P.getGeometryType()===G.enumPolygon&&P.getImpl().updateOGCFlagsProtected()),r[P.getDimension()]=P}return w!==null&&w.clearStitcher(m),r}function xL(t,e,s,i,r,n=!1){e===0&&ee("not enough geometries to dissolve");let o=0;for(let g=0,v=e;g<v;g++)o=Math.max(t[g].getDimension(),o);if(o===2||o===1)return new wa(i).dissolveMultiPaths_(o,!1,t,e,s,r,n);let a=0,l=-1;for(let g=0,v=e;g<v;g++)t[g].getDimension()===o&&(l===-1&&(l=g),t[g].isEmpty()||(l=g,a++));if(a<2)return Qi(t[l]);const u=Ql.constructEmpty(),c=new oi;let h=L;for(let g=0,v=e;g<v;g++)if(t[g].getDimension()===o&&!t[g].isEmpty()){h===L?h=c.addGeometry(Qi(t[g])):c.appendGeometry(h,Qi(t[g]));const b=Ql.constructEmpty();t[g].queryLooseEnvelope(b),u.mergeEnv3D(b)}const m=Ji(s,u.getEnvelope2D(),!0),f=new wa(i);if(n){const g=sC(s,u.getEnvelopeZs(),!0);return f.planarSimplify3DImpl_(c,m,g,0,!0)}return f.m_bOGCOutput=!0,f.planarSimplifyMultiPoints(c,m,!1,-1)}function _nt(t,e,s,i,r,n=!1){e<2&&ee("not enough geometries to dissolve");let o=0;for(let v=0,b=e;v<b;v++)o=Math.max(t[v].getDimension(),o);if(o===2||o===1)return new wa(i).dissolveMultiPaths_(o,!0,t,e,s,r,n);const a=Ql.constructEmpty(),l=new oi;let u=L,c=0,h=-1;for(let v=0,b=e;v<b;v++)if(t[v].getDimension()===o&&(h===-1&&(h=v),!t[v].isEmpty())){h=v,u===L?u=l.addGeometry(Qi(t[v])):l.appendGeometry(u,Qi(t[v]));const w=Ql.constructEmpty();t[v].queryLooseEnvelope(w),a.mergeEnv3D(w),c++}if(c<2)return Qi(t[h]);const m=o===0?s:null,f=Ji(m,a.getEnvelope2D(),!0),g=new wa(i);if(n){const v=sC(m,a.getEnvelopeZs(),!0);return g.m_bOGCOutput=!0,g.planarSimplify3DImpl_(l,f,v,0,!0)}return g.planarSimplifyMultiPoints(l,f,!0,-1)}class wa{constructor(e){this.m_topoGraph=null,this.m_maskLookup=[],this.m_dummyPt1=M.getNAN(),this.m_dummyPt2=M.getNAN(),this.m_fromEdgeForPolylines=L,this.m_progressCounter=0,this.m_bOGCOutput=!1,this.m_progressTracker=e}linesToPolygonsImpl(e,s){let i=0,r=0,n=null;if(e.hasCurves()){n=new Ha;const u=e.getEnvelope2D(this.m_progressTracker);r=Oc(s.total());const c=ja(s.total(),u);i=Vc(c,r),Ol(e,c,s.total(),12e3,n,null,this.m_progressTracker)}this.setEditShapeCrackAndCluster(e,s.add(i));const o=this.m_topoGraph.createUserIndexForChains(),a=this.m_topoGraph.getFirstChain();this.m_topoGraph.setChainUserIndex(a,o,1);for(let u=this.m_topoGraph.getChainFirstIsland(a);u!==L;u=this.m_topoGraph.getChainNextInParent(u))this.m_topoGraph.setChainUserIndex(u,o,1);const l=[];for(let u=this.m_topoGraph.getFirstChain();u!==L;u=this.m_topoGraph.getChainNext(u)){if(this.m_topoGraph.getChainUserIndex(u,o)===1)continue;this.m_topoGraph.setChainUserIndex(u,o,1);for(let m=this.m_topoGraph.getChainFirstIsland(u);m!==L;m=this.m_topoGraph.getChainNextInParent(m))this.m_topoGraph.setChainUserIndex(m,o,1);if(this.m_topoGraph.getChainArea(u)===0)continue;const c=this.m_topoGraph.extractPolygonFromChainAndIslands(e,L,u,L);n!=null&&n.stitchCurves(e,c,r,!1);const h=e.getGeometry(c);l.push(h)}return new kd(l)}autoCompleteImpl(e,s,i){let r=0,n=0,o=null;if(e.hasCurves()){o=new Ha;const h=e.getEnvelope2D(this.m_progressTracker);n=Oc(i.total());const m=ja(i.total(),h);r=Vc(m,n),Ol(e,m,i.total(),12e3,o,null,this.m_progressTracker)}this.setEditShapeCrackAndCluster(e,i.add(r));const a=this.m_topoGraph.getGeometryID(s),l=this.m_topoGraph.createUserIndexForChains(),u=this.m_topoGraph.getFirstChain();this.m_topoGraph.setChainUserIndex(u,l,1);for(let h=this.m_topoGraph.getChainFirstIsland(u);h!==L;h=this.m_topoGraph.getChainNextInParent(h))this.m_topoGraph.setChainUserIndex(h,l,1);const c=[];for(let h=this.m_topoGraph.getFirstChain();h!==L;h=this.m_topoGraph.getChainNext(h)){if(this.m_topoGraph.getChainUserIndex(h,l)===1)continue;this.m_topoGraph.setChainUserIndex(h,l,1);for(let w=this.m_topoGraph.getChainFirstIsland(h);w!==L;w=this.m_topoGraph.getChainNextInParent(w))this.m_topoGraph.setChainUserIndex(w,l,1);if(this.m_topoGraph.getChainParentage(h)!==0)continue;const m=this.m_topoGraph.getChainHalfEdge(h);let f=m,g=!1;do{const w=this.m_topoGraph.getHalfEdgeTwin(f);if(this.m_topoGraph.getHalfEdgeChain(w)!==h&&this.m_topoGraph.getHalfEdgeParentage(f)&a){g=!0;break}f=this.m_topoGraph.getHalfEdgeNext(f)}while(f!==m);if(!g||this.m_topoGraph.getChainArea(h)===0)continue;const v=this.m_topoGraph.extractPolygonFromChainAndIslands(e,L,h,L);o!==null&&o.stitchCurves(e,v,n,!1);const b=e.getGeometry(v);c.push(b)}return new kd(c)}setEditShape(e,s=!1){this.m_topoGraph===null&&(this.m_topoGraph=new Fl),this.m_topoGraph.setEditShape(e,this.m_progressTracker,!0,s)}setEditShapeCrackAndCluster(e,s){Ac(e,s,this.m_progressTracker,!0,!1);for(let i=e.getFirstGeometry();i!==L;i=e.getNextGeometry(i))e.getGeometryType(i)===G.enumPolygon&&_d(e,i,-1,this.m_bOGCOutput,L,this.m_progressTracker);this.setEditShape(e)}setHalfEdgeOrientations_(e,s){const i=this.m_topoGraph.getShape();for(let r=i.getFirstGeometry();r!==L;r=i.getNextGeometry(r))if(r===s)for(let n=i.getFirstPath(r);n!==L;n=i.getNextPath(n)){let o=i.getFirstVertex(n);if(o===L)continue;let a=i.getNextVertex(o);for(;a!==L;){const l=this.m_topoGraph.getClusterFromVertex(o),u=this.m_topoGraph.getClusterFromVertex(a),c=this.m_topoGraph.getHalfEdgeConnector(l,u);if(c!==L){const h=this.m_topoGraph.getHalfEdgeTwin(c);this.m_topoGraph.setHalfEdgeUserIndex(c,e,1),this.m_topoGraph.setHalfEdgeUserIndex(h,e,2)}o=a,a=i.getNextVertex(o)}}}flushVertices_(e,s){const i=this.m_topoGraph.getShape(),r=i.hasSegmentParentage(),n=new ut,o=i.insertPath(e,L);s.push(s[0]);const a=s.length;let l=L;for(let u=0;u<a;u++){const c=s[u];if(l=i.addVertex(o,c),!r)continue;const h=this.m_topoGraph.getClusterFromVertex(c);if(u>0&&this.m_topoGraph.isBreakNode(h)&&i.setSegmentParentageBreakVertex(l,!0),u<a-1){const m=this.m_topoGraph.getHalfEdgeConnector(h,this.m_topoGraph.getClusterFromVertex(s[u+1])),f=this.m_topoGraph.getSegmentParentage(m);i.setSegmentParentageAndBreak(l,f,u>0||this.m_topoGraph.isBreakNode(h)),this.m_topoGraph.isHalfEdgeCurve(m)&&(this.m_topoGraph.querySegmentXY(m,n),i.setSegmentToIndex(i.getVertexIndex(l),n.get().clone()))}}if(r){const u=this.m_topoGraph.getClusterFromVertex(s[a-1]);this.m_topoGraph.isBreakNode(u)&&i.setSegmentParentageBreakVertex(l,!0)}i.setClosedPath(o,!0)}processPolygonCuts_(e,s,i,r){const n=this.m_topoGraph.getGeometryID(i),o=this.m_topoGraph.getGeometryID(r),a=[],l=this.m_topoGraph.getShape(),u=this.m_topoGraph.createUserIndexForHalfEdges();for(let c=this.m_topoGraph.getFirstCluster();c!==L;c=this.m_topoGraph.getNextCluster(c)){const h=this.m_topoGraph.getClusterHalfEdge(c);if(h===L)continue;let m=h;do{if(this.m_topoGraph.getHalfEdgeUserIndex(m,u)!==1){let f=m,g=m,v=!1,b=0;do{if(this.m_topoGraph.setHalfEdgeUserIndex(f,u,1),!v&&this.m_topoGraph.getHalfEdgeParentage(f)&o&&this.m_topoGraph.getHalfEdgeFaceParentage(f)&n&&(g=f,v=!0),v){const w=this.m_topoGraph.getHalfEdgeOrigin(f),S=this.m_topoGraph.getClusterVertexIterator(w),T=this.m_topoGraph.getVertexFromVertexIterator(S);a.push(T),e!==-1&&this.m_topoGraph.getHalfEdgeParentage(f)&o&&(b|=this.m_topoGraph.getHalfEdgeUserIndex(f,e))}f=this.m_topoGraph.getHalfEdgeNext(f)}while(f!==g);if(v&&this.m_topoGraph.getChainArea(this.m_topoGraph.getHalfEdgeChain(g))>0){const w=l.createGeometry(G.enumPolygon);this.flushVertices_(w,a),s!==-1&&l.setGeometryUserIndex(w,s,b)}a.length=0}m=this.m_topoGraph.getHalfEdgeNext(this.m_topoGraph.getHalfEdgeTwin(m))}while(m!==h)}this.m_topoGraph.deleteUserIndexForHalfEdges(u)}cutPolygonPolyline_(e,s,i,r){this.m_topoGraph.removeSpikes_();let n=-1;e!==-1&&(n=this.m_topoGraph.createUserIndexForHalfEdges(),this.setHalfEdgeOrientations_(n,i)),this.processPolygonCuts_(n,e,s,i),n!==-1&&(this.m_topoGraph.deleteUserIndexForHalfEdges(n),n=-1);const o=this.m_topoGraph.getShape();for(let a=o.getFirstGeometry();a!==L;a=o.getNextGeometry(a))a!==s&&a!==i&&r.push(a);r.sort((a,l)=>{const u=o.getFirstPath(a),c=o.getRingArea(u),h=o.getFirstPath(l),m=o.getRingArea(h);return c<m?-1:c>m?1:0})}cut(e,s,i,r,n){const o=this.m_topoGraph.getShape().getGeometryType(i),a=this.m_topoGraph.getShape().getGeometryType(r),l=ca(o),u=ca(a);l!==2||u!==1?l!==1||u!==1?Ce(""):new xnt(this,e,s,i,r,n).Do():this.cutPolygonPolyline_(s,i,r,n)}progress_(e=!1){}isGoodParentage(e){return e>=0&&e<this.m_maskLookup.length&&this.m_maskLookup[e]}normalizeInputGeometry(e){const s=e.getGeometryType();if(s===G.enumEnvelope){const i=new wt({vd:e.getDescription()});return e.isEmpty()||i.addEnvelope(e,!1),i}if(s===G.enumPoint){const i=new pi({vd:e.getDescription()});return e.isEmpty()||i.add(e),i}if(zi(s)){const i=new qt({vd:e.getDescription()});return e.isEmpty()||i.addSegment(e,!0),i}return s!==G.enumMultiPoint&&s!==G.enumPolyline&&s!==G.enumPolygon&&ee("Unexpected geometry type"),e}dissolveNonSimplePolygons(e,s,i,r){F(s>0);const n=new oi;let o=0,a=-1;for(let l=0,u=s;l<u;l++)e[l].getDimension()===2&&(a===-1&&(a=l),e[l].isEmpty()||(o++,n.addGeometry(e[l])));return o===0?(F(a>=0),this.normalizeInputGeometry(e[a])):this.planarSimplifyPolygons(n,i,!0,!1,-1,!0)}dissolveMultiPaths_(e,s,i,r,n,o,a){F(e>=1&&e<=2),F(r>0);const l=8&o?1:2,u=Ql.constructEmpty();let c=0,h=-1,m=!0;for(let V=0,B=r;V<B;V++)if(i[V].getDimension()===e&&(h===-1&&(h=V),!i[V].isEmpty())){h=V,c++;const H=Ql.constructEmpty();if(i[V].queryLooseEnvelope(H),u.mergeEnv3D(H),e===2&&m&&i[V].getGeometryType()===G.enumPolygon)if(16&o){const W=[0],ie=i[V].getImpl().getIsSimple(0,W),se=this.m_bOGCOutput?ie===5:Hf(ie);m&&(m=se)}else{const W=rKe(i[V],0);m&&(m=W)}}if(c<2&&(F(h>=0),c===0||!(16&o)))return this.normalizeInputGeometry(i[h]);if(!m){const V=Ji(s?null:n,u.getEnvelope2D(),!0);return this.dissolveNonSimplePolygons(i,r,V,o)}const f=i.slice(0,r),g=Ji(n,u.getEnvelope2D(),!0),v=10*il(g);let b=new Uo(0,0);if(a&&(b=sC(n,u.getEnvelopeZs(),!0)),c===1&&e===1&&l===2&&!s)return a?hnt():this.m_bOGCOutput?NG(f[h],g,!1,-1,this.m_progressTracker,l,!1):hD(f[h],g,!1,!1,-1,this.m_progressTracker,l,!1);const w=new wP;w.startConstruction();let S=e===2?3:4,T=0;for(let V=0,B=r;V<B;V++){if(f[V].getDimension()!==e||f[V].isEmpty())continue;let H=f[V].getGeometryType();if(H!==G.enumEnvelope){if(zi(H)?(f[V]=this.normalizeInputGeometry(f[V]),H=G.enumPolyline):F(xt(H)),e===1){F(H===G.enumPolyline);let ie=-1;if(a)F(0,"3d not implemented yet");else{const se=[0];ie=f[V].getImpl().getIsSimple(g.total(),se)}if(this.m_bOGCOutput?ie!==5:!Hf(ie))if(s)S=-1;else{a?F(0,"3d not implemented yet"):this.m_bOGCOutput?f[V]=NG(f[V],g,!1,-1,this.m_progressTracker,l,!1):f[V]=hD(f[V],g,!1,!1,-1,this.m_progressTracker,l,!1);const se=[0];F(Hf(f[V].getImpl().getIsSimple(g.total(),se)))}}else{F(H===G.enumPolygon);const ie=[0],se=f[V].getImpl().getIsSimple(0,ie);F(tm(se))}const W=f[V].getImpl();for(let ie=0,se=W.getPathCount();ie<se;ie++){const Z=X.constructEmpty();W.queryLoosePathEnvelope(ie,Z),Z.inflateCoords(v,v),w.addEnvelope(T,Z),T++}}else{F(H===G.enumEnvelope);const W=X.constructEmpty();f[V].queryLooseEnvelope(W),W.inflateCoords(v,v),w.addEnvelope(T,W),T++,S=-1}}w.endConstruction();const P=T,I=Me(P,-2147483647),A=Me(P,-1);let D=0;h=-1,T=0;for(let V=0,B=r;V<B;V++){if(f[V].getDimension()!==e||(h===-1&&(h=V),f[V].isEmpty()))continue;h=V,D++;const H=f[V].getGeometryType();if(xt(H))for(let W=0,ie=f[V].getPathCount();W<ie;W++)A[T]=V,I[T]=-W-1,T++;else F(H===G.enumEnvelope),A[T]=V,I[T]=-1,T++}if(D<2&&e===2)return F(h>=0),this.normalizeInputGeometry(f[h]);let k=P;for(;w.next()&&k>0;){this.progress_();const V=w.getHandleA(),B=w.getHandleB(),H=w.getElement(V),W=w.getElement(B);A[H]!==A[W]&&(I[H]<0&&(k--,I[H]=-(I[H]+1)),I[W]<0&&(k--,I[W]=-(I[W]+1)))}const R=new oi;let O=!1,z=0;for(let V=0,B=r;V<B;V++){if(f[V].getDimension()!==e||f[V].isEmpty())continue;const H=f[V].getGeometryType(),W=z;let ie=0,se=0;const Z=xt(H)?f[V]:null;for(let te=W,ve=I.length;te<ve&&A[te]===V;te++)I[te]>=0&&(ie++,se+=Z?Z.getPathSize(I[te]):QE(f[V])),z++;if(se>.95*QE(f[V])){R.addGeometry(this.normalizeInputGeometry(f[V]));for(let te=W;te<z;te++)I[te]<0&&(I[te]=-(I[te]+1))}else{if(ie===0){O=!0;continue}{O=!0,F(xt(H)),F(Z!=null);const te=new wt({vd:f[V].getDescription()}),ve=new qt({vd:f[V].getDescription()}),ke=H===G.enumPolygon?te:ve;for(let Fe=W;Fe<z;Fe++)I[Fe]>=0&&ke.addPath(Z,I[Fe],!0);R.addGeometry(ke)}}}let q;if(R.getFirstGeometry()!==L){const V=e===2,B=s?Ji(null,u.getEnvelope2D(),!0):g;let H=new Uo(0,0);if(a&&(H=s?sC(null,u.getEnvelopeZs(),!0):b),e===2&&!(2&o)){R.collapseAllGeometriesToFirst();let W=0,ie=null;if(R.hasCurves()&&!R.hasSegmentParentage()){ie=new Ha;const se=R.getEnvelope2D(this.m_progressTracker);W=Oc(B.total()),Ol(R,ja(B.total(),se),B.total(),12e3,ie,null,this.m_progressTracker)}eit(R,R.getFirstGeometry(),B.total(),this.m_progressTracker),ie!==null&&ie.stitchCurves(R,L,W,!0)}if(a)q=this.planarSimplify3DImpl_(R,B,H,l,!0);else if(e===2)q=this.planarSimplifyPolygons(R,B,V,s,-1,!1);else{const W=ry();W.ogcRule=this.m_bOGCOutput,W.allCrossRoadsImpassable=!0,W.unsplitBehavior=l,q=this.planarSimplifyPolylines(R,B,s,W,-1)}if(!O){const W=[0];S=q.getImpl().getIsSimple(B.total(),W)}}else F(O),F(h>=0),q=e===2?new wt({vd:f[h].getDescription()}):new qt({vd:f[h].getDescription()});if(O){let V=0;for(let B=0,H=I.length;B<H;B++){const W=A[B];if(!(W<0)&&I[B]<0){const ie=f[W].getGeometryType(),se=xt(ie)?f[W]:null;if(se){const Z=-(I[B]+1);V+=se.getPathSize(Z)}else V+=4}}q.reserve(q.getPointCount()+V);for(let B=0,H=I.length;B<H;B++){const W=A[B];if(!(W<0)&&I[B]<0){const ie=f[W].getGeometryType(),se=xt(ie)?f[W]:null;if(se){const Z=-(I[B]+1);q.addPath(se,Z,!0)}else ie===G.enumEnvelope?q.addEnvelope(f[W],!1):(F(zi(ie)),q.addSegment(f[W],!0))}}}let U=0;if(e===2?S!==-1&&(S=3,U=s?0:g.total()):(F(e===1),s||S===-1||(U=g.total())),a||q.getImpl().setIsSimple(S,U),!s&&O)if(e===2){if(!a)return new Xh().execute(q,n,!1,this.m_progressTracker);F(0,"3d not yet implemented")}else e===1&&l!==1&&(q=a?mnt():cnt(this.m_bOGCOutput,q,l,this.m_progressTracker),q.getImpl().setIsSimple(S,U));return q}dissolveTopoGraphCommonEdges_(){const e=this.m_topoGraph.createUserIndexForHalfEdges(),s=[];for(let i=this.m_topoGraph.getFirstCluster();i!==L;i=this.m_topoGraph.getNextCluster(i)){const r=this.m_topoGraph.getClusterHalfEdge(i);let n=r;if(r!==L)do{if(this.progress_(),this.m_topoGraph.getHalfEdgeUserIndex(n,e)!==1){const o=this.m_topoGraph.getHalfEdgeTwin(n);this.m_topoGraph.setHalfEdgeUserIndex(o,e,1),this.m_topoGraph.setHalfEdgeUserIndex(n,e,1);const a=this.m_topoGraph.getHalfEdgeFaceParentage(n);if(this.isGoodParentage(a)){const l=this.m_topoGraph.getHalfEdgeFaceParentage(o);this.isGoodParentage(l)&&s.push(n)}}n=this.m_topoGraph.getHalfEdgeNext(this.m_topoGraph.getHalfEdgeTwin(n))}while(n!==r)}this.m_topoGraph.deleteUserIndexForHalfEdges(e),this.m_topoGraph.deleteEdgesBreakFaces_(s)}chooseVertexByOrder(e,s,i,r){let n=co(),o=L;for(let l=this.m_topoGraph.getClusterVertexIterator(e);l!==L;l=this.m_topoGraph.incrementVertexIterator(l)){const u=this.m_topoGraph.getVertexFromVertexIterator(l),c=s.getUserIndex(u,i);c>=0&&c<n&&(n=c,o=u)}F(o!==L);let a=s.getUserIndex(o,r);return a>0&&(s.setUserIndex(o,r,--a),a===0&&s.setUserIndex(o,i,-1)),o}chooseVertexFromCluster_(e,s){return this.m_topoGraph.getVertexDominantFromCluster(e,s)}chooseVertexFromVertexCluster_(e,s){return this.m_topoGraph.getVertexDominant(e,s)}collectPolygonPathsPreservingFrom_(e,s,i,r,n){const o=this.m_topoGraph.getShape();if(o.getGeometryType(e)!==G.enumPolygon)return;const a=o.hasSegmentParentage(),l=new ut;for(let u=o.getFirstPath(e);u!==L;u=o.getNextPath(u)){const c=o.getFirstVertex(u);this.m_topoGraph.getClusterFromVertex(c);const h=this.m_topoGraph.getHalfEdgeFromVertex(c);if(h===L)continue;const m=this.m_topoGraph.getHalfEdgeUserIndex(h,i);if(m===1||m===2)continue;const f=this.m_topoGraph.getHalfEdgeFaceParentage(h);if(!this.isGoodParentage(f)){this.m_topoGraph.setHalfEdgeUserIndex(h,i,2);continue}this.m_topoGraph.setHalfEdgeUserIndex(h,i,1);const g=o.insertPath(s,L);o.setClosedPath(g,!0);let v=h,b=c,w=this.m_topoGraph.getClusterFromVertex(b),S=1;do{this.progress_();const T=this.chooseVertexFromVertexCluster_(b,n),P=o.addVertex(g,T);if(this.m_topoGraph.isHalfEdgeCurve(v)&&(this.m_topoGraph.querySegmentXY(v,l),o.setSegmentToIndex(o.getVertexIndex(P),l.get().clone())),a){const k=this.m_topoGraph.getSegmentParentage(v);o.setSegmentParentageAndBreak(P,k,this.m_topoGraph.isBreakNode(w))}let I,A;r!==-1&&this.m_topoGraph.setClusterUserIndex(w,r,1),this.m_topoGraph.setHalfEdgeUserIndex(v,i,1),v=this.m_topoGraph.getHalfEdgeNext(v);do I=S===1?o.getNextVertex(b):o.getPrevVertex(b),A=I!==L?this.m_topoGraph.getClusterFromVertex(I):L;while(A===w);const D=this.m_topoGraph.getHalfEdgeOrigin(v);if(D!==A){do I=S===1?o.getPrevVertex(b):o.getNextVertex(b),A=I!==L?this.m_topoGraph.getClusterFromVertex(I):L;while(A===w);if(D!==A){A=D;const k=this.m_topoGraph.getClusterVertexIterator(A);I=this.m_topoGraph.getVertexFromVertexIterator(k)}else S=-S}w=A,b=I}while(v!==h)}}topoOperationPolygonPolygonHelper_(e,s,i,r,n,o){this.progress_(!0),e!==L&&this.collectPolygonPathsPreservingFrom_(e,i,n,o,r),s!==L&&this.collectPolygonPathsPreservingFrom_(s,i,n,o,r);const a=new ut,l=this.m_topoGraph.getShape();l.dbgVerifyCurves();const u=l.hasSegmentParentage();for(let c=this.m_topoGraph.getFirstCluster();c!==L;c=this.m_topoGraph.getNextCluster(c)){const h=this.m_topoGraph.getClusterHalfEdge(c);if(h===L)continue;let m=h;do{this.progress_();const f=this.m_topoGraph.getHalfEdgeUserIndex(m,n);if(f!==1&&f!==2){const g=this.m_topoGraph.getHalfEdgeFaceParentage(m);if(this.isGoodParentage(g)){const v=l.insertPath(i,L);l.setClosedPath(v,!0);let b=m;do{const w=this.m_topoGraph.getHalfEdgeVertexIterator(b);let S=L;if(w!==L)S=this.m_topoGraph.getVertexFromVertexIterator(w);else{const I=this.m_topoGraph.getHalfEdgeVertexIterator(this.m_topoGraph.getHalfEdgeTwin(b));S=this.m_topoGraph.getVertexFromVertexIterator(I),S=l.getNextVertex(S)}const T=this.chooseVertexFromVertexCluster_(S,r),P=l.addVertex(v,T);if(u){const I=this.m_topoGraph.getSegmentParentage(b),A=this.m_topoGraph.getHalfEdgeOrigin(b);l.setSegmentParentageAndBreak(P,I,this.m_topoGraph.isBreakNode(A))}if(this.m_topoGraph.isHalfEdgeCurve(b)&&(this.m_topoGraph.querySegmentXY(b,a),l.setSegmentToIndex(l.getVertexIndex(P),a.get().clone())),this.m_topoGraph.setHalfEdgeUserIndex(b,n,1),o!==-1){const I=this.m_topoGraph.getClusterFromVertex(T);this.m_topoGraph.setClusterUserIndex(I,o,1)}b=this.m_topoGraph.getHalfEdgeNext(b)}while(b!==m)}else this.m_topoGraph.setHalfEdgeUserIndex(m,n,2)}m=this.m_topoGraph.getHalfEdgeNext(this.m_topoGraph.getHalfEdgeTwin(m))}while(m!==h)}}topoOperationPolygonPolygon_(e,s,i,r=!1){this.dissolveTopoGraphCommonEdges_();const n=this.m_topoGraph.getShape(),o=n.createGeometry(G.enumPolygon),a=this.m_topoGraph.createUserIndexForHalfEdges();return this.topoOperationPolygonPolygonHelper_(e,s,o,i,a,-1),this.m_topoGraph.deleteUserIndexForHalfEdges(a),r||_d(n,o,3,this.m_bOGCOutput,L,this.m_progressTracker),o}topoOperationPolyline_(e,s){const i=ry();return i.allCrossRoadsImpassable=!1,i.ogcRule=s,i.unsplitBehavior=0,this.topoOperationPolylineSimplifyOrPolylineTopoHelper_(L,e,!1,i).first}topoOperationMultiPoint_(){const e=this.m_topoGraph.getShape(),s=e.createGeometry(G.enumMultiPoint),i=e.insertPath(s,L);for(let r=this.m_topoGraph.getFirstCluster();r!==L;r=this.m_topoGraph.getNextCluster(r)){const n=this.m_topoGraph.getClusterParentage(r);if(this.isGoodParentage(n)){let o=L;for(let a=this.m_topoGraph.getClusterVertexIterator(r);a!==L;a=this.m_topoGraph.incrementVertexIterator(a)){const l=this.m_topoGraph.getVertexFromVertexIterator(a);o===L&&(o=l);const u=e.getGeometryFromPath(e.getPathFromVertex(l)),c=this.m_topoGraph.getGeometryID(u);if(this.isGoodParentage(c)){o=l;break}}e.addVertex(i,o)}}return s}intersection(e,s){const i=this.m_topoGraph.getShape().getGeometryType(e),r=this.m_topoGraph.getShape().getGeometryType(s),n=ca(i),o=ca(r),a=this.m_topoGraph.getGeometryID(e),l=this.m_topoGraph.getGeometryID(s);F(a>=0),F(l>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=1+(a|l),this.m_maskLookup[a|l]=!0;let u=L;return this.m_topoGraph.getShape().getVertexDescription().getAttributeCount()>1&&(u=e),n===2&&o===2?this.topoOperationPolygonPolygon_(e,s,u):n===1&&o>0||o===1&&n>0?this.topoOperationPolyline_(u,this.m_bOGCOutput):n===0||o===0?this.topoOperationMultiPoint_():void Ce("")}topoOperationPolygonPolygonEx(e,s,i){const r=this.m_topoGraph.getShape(),n=r.createGeometry(G.enumPolygon),o=r.createGeometry(G.enumPolyline),a=r.createGeometry(G.enumMultiPoint);this.dissolveTopoGraphCommonEdges_();let l=L;const u=this.m_topoGraph.createUserIndexForHalfEdges(),c=this.m_topoGraph.createUserIndexForClusters();r.dbgVerifyCurves(),this.topoOperationPolygonPolygonHelper_(e,s,n,i,u,c),r.dbgVerifyCurves();const h=r.hasSegmentParentage(),m=new ut;for(let g=this.m_topoGraph.getFirstCluster();g!==L;g=this.m_topoGraph.getNextCluster(g)){const v=this.m_topoGraph.getClusterHalfEdge(g);if(v===L)continue;let b=v;do{let w=this.m_topoGraph.getHalfEdgeUserIndex(b,u),S=this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgeTwin(b),u),T=w|S;if(T===2){let P=this.m_topoGraph.getHalfEdgeParentage(b);if(this.isGoodParentage(P)){const I=r.insertPath(o,L);let A=b;const D=this.chooseVertexFromCluster_(g,i);let k=r.addVertex(I,D);if(h){const R=this.m_topoGraph.getSegmentParentage(b),O=this.m_topoGraph.getHalfEdgeOrigin(b);r.setSegmentParentageAndBreak(k,R,this.m_topoGraph.isBreakNode(O))}this.m_topoGraph.isHalfEdgeCurve(b)&&(this.m_topoGraph.querySegmentXY(b,m),r.setSegmentToIndex(r.getVertexIndex(k),m.get().clone())),this.m_topoGraph.setClusterUserIndex(g,c,1);do{this.progress_();const R=this.m_topoGraph.getHalfEdgeTo(A),O=this.chooseVertexFromCluster_(R,i);if(k=r.addVertex(I,O),h){const z=this.m_topoGraph.getSegmentParentage(b),q=this.m_topoGraph.getHalfEdgeOrigin(b);r.setSegmentParentageAndBreak(k,z,this.m_topoGraph.isBreakNode(q))}if(this.m_topoGraph.setHalfEdgeUserIndex(A,u,1),this.m_topoGraph.setHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgeTwin(A),u,1),this.m_topoGraph.setClusterUserIndex(R,c,1),A=this.m_topoGraph.getHalfEdgeNext(A),w=this.m_topoGraph.getHalfEdgeUserIndex(A,u),S=this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgeTwin(A),u),T=w|S,T!==2)break;if(P=this.m_topoGraph.getHalfEdgeParentage(A),!this.isGoodParentage(P)){this.m_topoGraph.setHalfEdgeUserIndex(A,u,1),this.m_topoGraph.setHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgeTwin(A),u,1);break}this.m_topoGraph.isHalfEdgeCurve(b)&&A!==b&&(this.m_topoGraph.querySegmentXY(b,m),r.setSegmentToIndex(r.getVertexIndex(k),m.get().clone()))}while(A!==b)}else this.m_topoGraph.setHalfEdgeUserIndex(b,u,1),this.m_topoGraph.setHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgeTwin(b),u,1)}b=this.m_topoGraph.getHalfEdgeNext(this.m_topoGraph.getHalfEdgeTwin(b))}while(b!==v)}for(let g=this.m_topoGraph.getFirstCluster();g!==L;g=this.m_topoGraph.getNextCluster(g)){if(this.progress_(),this.m_topoGraph.getClusterUserIndex(g,c)===1)continue;const v=this.m_topoGraph.getClusterParentage(g);if(this.isGoodParentage(v)){l===L&&(l=r.insertPath(a,L));const b=this.m_topoGraph.getClusterVertexIterator(g);let w=L;if(b!==L){w=this.m_topoGraph.getVertexFromVertexIterator(b);const S=this.chooseVertexFromVertexCluster_(w,i);r.addVertex(l,S)}}}this.m_topoGraph.deleteUserIndexForClusters(c),this.m_topoGraph.deleteUserIndexForHalfEdges(u),r.dbgVerifyCurves(),_d(r,n,3,this.m_bOGCOutput,L,this.m_progressTracker);const f=[L,L,L];return f[0]=a,f[1]=o,f[2]=n,f}topoOperationPolylinePolylineOrPolygonEx(e,s){const i=ry();return i.allCrossRoadsImpassable=!1,i.ogcRule=s,i.unsplitBehavior=0,this.topoOperationPolylineSimplifyOrPolylineTopoHelper_(L,e,!0,i)}topoOperationMultiPoint(){const e=this.m_topoGraph.getShape(),s=e.createGeometry(G.enumMultiPoint),i=e.insertPath(s,L);for(let r=this.m_topoGraph.getFirstCluster();r!==L;r=this.m_topoGraph.getNextCluster(r)){const n=this.m_topoGraph.getClusterParentage(r);if(this.isGoodParentage(n)){let o=L;for(let a=this.m_topoGraph.getClusterVertexIterator(r);a!==L;a=this.m_topoGraph.incrementVertexIterator(a)){const l=this.m_topoGraph.getVertexFromVertexIterator(a);o===L&&(o=l);const u=e.getGeometryFromPath(e.getPathFromVertex(l)),c=this.m_topoGraph.getGeometryID(u);if(this.isGoodParentage(c)){o=l;break}}e.addVertex(i,o)}}return s}intersectionEx(e,s){const i=this.m_topoGraph.getShape().getGeometryType(e),r=this.m_topoGraph.getShape().getGeometryType(s),n=yM(i),o=yM(r),a=this.m_topoGraph.getGeometryID(e),l=this.m_topoGraph.getGeometryID(s);F(a>=0),F(l>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=1+(a|l),this.m_maskLookup[a|l]=!0;let u=L;if(this.m_topoGraph.getShape().getVertexDescription().getAttributeCount()>1&&(u=e),n===2&&o===2)return this.topoOperationPolygonPolygonEx(e,s,u);if(n===1&&o>0||o===1&&n>0){const{first:c,second:h}=this.topoOperationPolylinePolylineOrPolygonEx(u,this.m_bOGCOutput);return[h,c]}if(n===0||o===0){const c=[];return c.push(this.topoOperationMultiPoint()),c}Ce("")}getCombinedHalfEdgeParentage(e){return this.m_topoGraph.getHalfEdgeParentage(e)|this.m_topoGraph.getHalfEdgeFaceParentage(e)|this.m_topoGraph.getHalfEdgeFaceParentage(this.m_topoGraph.getHalfEdgeTwin(e))}prevailingDirection(e,s){const i=this.getCombinedHalfEdgeParentage(s),r=this.m_topoGraph.getHalfEdgeOrigin(s),n=this.m_topoGraph.getHalfEdgeTo(s);let o=0,a=0;for(let l=this.m_topoGraph.getClusterVertexIterator(r);l!==L;l=this.m_topoGraph.incrementVertexIterator(l)){const u=this.m_topoGraph.getVertexFromVertexIterator(l),c=e.getPathFromVertex(u),h=e.getGeometryFromPath(c),m=this.m_topoGraph.getGeometryID(h),f=e.getFirstVertex(c),g=!!(m&i);g&&f===u&&(this.m_fromEdgeForPolylines=s);const v=e.getNextVertex(u);if(v!==L&&this.m_topoGraph.getClusterFromVertex(v)===n){if(o++,g){if(this.m_fromEdgeForPolylines===L&&f===v){const b=this.m_topoGraph.getHalfEdgeNext(s);this.isGoodParentage(this.getCombinedHalfEdgeParentage(b))&&(this.m_fromEdgeForPolylines=b)}a++}}else{const b=e.getPrevVertex(u);if(b!==L&&this.m_topoGraph.getClusterFromVertex(b)===n&&(o--,g)){if(this.m_fromEdgeForPolylines===L&&f===b){const w=this.m_topoGraph.getHalfEdgeNext(s);this.isGoodParentage(this.getCombinedHalfEdgeParentage(w))&&(this.m_fromEdgeForPolylines=w)}a--}}}return this.m_topoGraph.queryXY(r,this.m_dummyPt1),this.m_topoGraph.queryXY(n,this.m_dummyPt2),(a!==0?a:o)*M.distance(this.m_dummyPt1,this.m_dummyPt2)}tryMoveThroughCrossroadBackwards(e,s){const i=this.m_topoGraph.getHalfEdgePrev(e),r=this.m_topoGraph.getHalfEdgeTwin(i);if(!s){if(this.m_topoGraph.isStrongPathNode(this.m_topoGraph.getHalfEdgeOrigin(e)))return L;const a=this.m_topoGraph.getHalfEdgeTwin(e);if(r===this.m_topoGraph.getHalfEdgeNext(a))return i}let n=r,o=L;for(;n!==e;){const a=this.getCombinedHalfEdgeParentage(n);if(this.isGoodParentage(a)){if(o!==L)return L;o=this.m_topoGraph.getHalfEdgeTwin(n)}n=this.m_topoGraph.getHalfEdgeTwin(this.m_topoGraph.getHalfEdgePrev(n))}return o}tryMoveThroughCrossroadForward(e,s){const i=this.m_topoGraph.getHalfEdgeNext(e),r=this.m_topoGraph.getHalfEdgeTwin(i);if(!s){const a=this.m_topoGraph.getHalfEdgeTwin(e);if(this.m_topoGraph.isStrongPathNode(this.m_topoGraph.getHalfEdgeOrigin(a)))return L;if(r===this.m_topoGraph.getHalfEdgePrev(a))return i}let n=r,o=L;for(;n!==e;){const a=this.getCombinedHalfEdgeParentage(n);if(this.isGoodParentage(a)){if(o!==L)return L;o=this.m_topoGraph.getHalfEdgeTwin(n)}n=this.m_topoGraph.getHalfEdgeTwin(this.m_topoGraph.getHalfEdgeNext(n))}return o}isOnALoop(e,s){let i=e;const r=2*this.m_topoGraph.getShape().getTotalPointCount()+10;for(let n=0;n<r;n++){if(this.m_topoGraph.getHalfEdgeUserIndex(i,s)===1)return!1;const o=this.m_topoGraph.getHalfEdgeNext(i);if(o===this.m_topoGraph.getHalfEdgeTwin(i))return!1;if(i=o,i===e)return!0}Ce("is_on_a_loop_")}restorePolylineParts(e,s,i,r,n,o,a,l,u,c){F(n===L&&o>=0&&a>=0||o===-1&&a===-1),F(l===-1&&c.unsplitBehavior!==1||l!==-1&&c.unsplitBehavior===1);const h=c.ogcRule,m=c.allCrossRoadsImpassable,f=c.unsplitBehavior===1,g=c.unsplitBehavior===0,v=this.m_topoGraph.getShape(),b=v.hasSegmentParentage();let w=e,S=this.m_topoGraph.getHalfEdgeTwin(w);const T=new ut;this.m_fromEdgeForPolylines=L;let P=this.prevailingDirection(v,w),I=w,A=L,D=!1,k=!1,R=!1;if(!f)for(;;){const Fe=this.m_topoGraph.getHalfEdgePrev(w);if(Fe===S){R=!0;break}const Pe=this.m_topoGraph.getHalfEdgeNext(S);if(this.m_topoGraph.isStrongPathNode(this.m_topoGraph.getHalfEdgeOrigin(Pe))){D=!0;break}if(this.m_topoGraph.getHalfEdgeTwin(Fe)!==Pe){if(m){D=!0;break}if(w=this.tryMoveThroughCrossroadBackwards(w,!0),w===L){D=!0;break}S=this.m_topoGraph.getHalfEdgeTwin(w)}else w=Fe,S=Pe;if(this.m_topoGraph.getHalfEdgeUserIndex(w,i)===1){R=!0;break}if(w===e){A=e,k=!0;break}const Ve=this.getCombinedHalfEdgeParentage(w);if(!this.isGoodParentage(Ve))break;I=w,P+=this.prevailingDirection(v,w)}if(A===L){for(w=e,S=this.m_topoGraph.getHalfEdgeTwin(w),A=w;;){const Pe=this.m_topoGraph.getHalfEdgeNext(w),Ve=this.m_topoGraph.isStrongPathNode(this.m_topoGraph.getHalfEdgeOrigin(Pe));if(Ve){D=!0;break}if(Pe===S){R=!0;break}if(l!==-1){const Rs=this.m_topoGraph.getHalfEdgeOrigin(S);if(this.m_topoGraph.getClusterUserIndex(Rs,l)===1){D=!0;break}}const Ke=this.m_topoGraph.getHalfEdgePrev(S);if(this.m_topoGraph.getHalfEdgeTwin(Pe)!==Ke){if(Ve||m){D=!0;break}if(w=this.tryMoveThroughCrossroadForward(w,!0),w===L){D=!0;break}S=this.m_topoGraph.getHalfEdgeTwin(w)}else w=Pe,S=Ke;if(this.m_topoGraph.getHalfEdgeUserIndex(w,i)===1){R=!0;break}const He=this.getCombinedHalfEdgeParentage(w);if(!this.isGoodParentage(He))break;A=w,P+=this.prevailingDirection(v,w)}const Fe=this.m_topoGraph.getHalfEdgeOrigin(I);k=this.m_topoGraph.getHalfEdgeTo(A)===Fe}else if(this.m_fromEdgeForPolylines!==L){I=e,A=this.tryMoveThroughCrossroadBackwards(I,!1),F(A!==L);const Fe=this.m_topoGraph.getHalfEdgeTwin(I);this.m_topoGraph.getHalfEdgeNext(Fe)}let O=k;k||R||u&&(O=this.isOnALoop(e,i),O||(O=this.isOnALoop(S,i)));const z=P>=0;let q=!1;O&&D&&(k?(q=h,z&&(q||f||g)&&I!==e&&(F(!f),I=e,q=!1)):(f||z&&g)&&(I=e));let U=0;for(w=I;S=this.m_topoGraph.getHalfEdgeTwin(w),this.m_topoGraph.setHalfEdgeUserIndex(w,i,1),this.m_topoGraph.setHalfEdgeUserIndex(S,i,1),U++,w!==A;)w=m?this.m_topoGraph.getHalfEdgeNext(w):this.tryMoveThroughCrossroadForward(w,!1);z||(A=be(I,I=A),A=this.m_topoGraph.getHalfEdgeTwin(A),I=this.m_topoGraph.getHalfEdgeTwin(I));let V=v.insertPath(s,L);w=I;const B=this.m_topoGraph.getHalfEdgeOrigin(I);let H;H=o!==-1?this.chooseVertexByOrder(B,v,o,a):this.chooseVertexFromCluster_(B,n),this.m_topoGraph.isStrongPathNode(B)&&v.setStrongPathStart(V,!0);let W=v.addVertex(V,H),ie=W;r!==-1&&this.m_topoGraph.setClusterUserIndex(B,r,1);let se=0;const Z=q?Math.trunc((U+1)/2):-1;let te=L,ve=!0,ke=L;for(;;){if(b){const Ke=this.m_topoGraph.getSegmentParentage(w),He=this.m_topoGraph.getHalfEdgeOrigin(w);v.setSegmentParentageAndBreak(ie,Ke,ve||this.m_topoGraph.isBreakNode(He))}ve=!1,this.m_topoGraph.isHalfEdgeCurve(w)&&(this.m_topoGraph.querySegmentXY(w,T),v.setSegmentToIndex(v.getVertexIndex(ie),T.get().clone())),te!==L&&a!==-1&&v.addToUserIndex(te,a,-1);const Fe=m?this.m_topoGraph.getHalfEdgeNext(w):this.tryMoveThroughCrossroadForward(w,!1),Pe=this.m_topoGraph.getHalfEdgeTo(w);let Ve;if(Ve=o!==-1?this.chooseVertexByOrder(Pe,v,o,a):this.chooseVertexFromCluster_(Pe,n),W=v.addVertex(V,Ve),ke=Pe,r!==-1&&this.m_topoGraph.setClusterUserIndex(Pe,r,1),b&&this.m_topoGraph.isBreakNode(Pe)&&v.setSegmentParentageBreakVertex(W,!0),te=Ve,se++,q&&se===Z&&(V=v.insertPath(s,L),W=v.addVertex(V,Ve),ve=!0,a!==-1&&v.addToUserIndex(Ve,a,-1),te=L),w===A)break;w=Fe,ie=W}ke!==L&&this.m_topoGraph.isStrongPathNode(ke)&&v.setStrongPathEnd(V,!0)}topoOperationPolylineSimplify_(e,s){return this.topoOperationPolylineSimplifyOrPolylineTopoHelper_(e,L,!1,s).first}topoOperationPolylineSimplifyOrPolylineTopoHelper_(e,s,i,r){F(s===L||e===L);const n=this.m_topoGraph.getShape(),o=g=>g=e===L?g===L?n.getFirstGeometry():n.getNextGeometry(g):g===L?e:L,a=n.createGeometry(G.enumPolyline);let l=-1;i&&(l=this.m_topoGraph.createUserIndexForClusters());const u=this.m_topoGraph.createUserIndexForHalfEdges(),c=s===L?n.createUserIndex():-1,h=s===L?n.createUserIndex():-1;let m=-1;if(r.unsplitBehavior===1){m=this.m_topoGraph.createUserIndexForClusters();for(let g=o(L);g!==L;g=o(g))for(let v=n.getFirstPath(g);v!==L;v=n.getNextPath(v)){{const b=n.getFirstVertex(v),w=this.m_topoGraph.getClusterFromVertex(b);this.m_topoGraph.setClusterUserIndex(w,m,1)}if(!n.isClosedPath(v)){const b=n.getLastVertex(v),w=this.m_topoGraph.getClusterFromVertex(b);this.m_topoGraph.setClusterUserIndex(w,m,1)}}}if(s===L){let g=0;for(let v=o(L);v!==L;v=o(v))for(let b=n.getFirstPath(v);b!==L;b=n.getNextPath(b))if(n.isClosedPath(b)){let w=n.getFirstVertex(b);for(let S=0,T=n.getPathSize(b);S<T;S++,w=n.getNextVertex(w))n.setUserIndex(w,c,g++),n.setUserIndex(w,h,2)}else{const w=n.getFirstVertex(b);n.setUserIndex(w,c,g++),n.setUserIndex(w,h,1);let S=n.getNextVertex(w);for(let T=1,P=n.getPathSize(b)-1;T<P;++T)n.setUserIndex(S,c,g++),n.setUserIndex(S,h,2),S=n.getNextVertex(S);n.setUserIndex(S,c,g++),n.setUserIndex(S,h,1)}}for(let g=o(L);g!==L;g=o(g))for(let v=n.getFirstPath(g);v!==L;v=n.getNextPath(v)){let b=n.getFirstVertex(v);for(let w=0,S=n.getPathSize(v);w<S;w++,b=n.getNextVertex(b)){const T=this.m_topoGraph.getHalfEdgeFromVertex(b);if(T===L||this.m_topoGraph.getHalfEdgeUserIndex(T,u)===1)continue;const P=this.getCombinedHalfEdgeParentage(T);if(this.isGoodParentage(P)){const I=w===0;this.restorePolylineParts(T,a,u,l,s,c,h,m,I,r)}}}let f=L;if(i){f=n.createGeometry(G.enumMultiPoint);let g=L;for(let v=this.m_topoGraph.getFirstCluster();v!==L;v=this.m_topoGraph.getNextCluster(v))if(this.progress_(),this.m_topoGraph.getClusterUserIndex(v,l)!==1){const b=this.m_topoGraph.getClusterParentage(v);if(this.isGoodParentage(b)){g===L&&(g=n.insertPath(f,L));const w=this.m_topoGraph.getClusterVertexIterator(v);if(w!==L){let S;this.m_topoGraph.getVertexFromVertexIterator(w),S=c!==-1?this.chooseVertexByOrder(v,n,c,h):this.chooseVertexFromCluster_(v,s),n.addVertex(g,S)}}}}return h!==-1&&n.removeUserIndex(h),c!==-1&&n.removeUserIndex(c),l!==-1&&n.removeUserIndex(l),this.m_topoGraph.deleteUserIndexForHalfEdges(u),Zi(a,f)}difference(e,s){const i=this.m_topoGraph.getShape().getGeometryType(e),r=this.m_topoGraph.getShape().getGeometryType(s),n=ca(i),o=ca(r);if(n>o)return e;const a=this.m_topoGraph.getGeometryID(e),l=this.m_topoGraph.getGeometryID(s);if(this.m_maskLookup.length=0,this.m_maskLookup.length=1+(a|l),this.m_maskLookup[a]=!0,n===2&&o===2){let u=L;return this.m_topoGraph.getShape().getVertexDescription().getAttributeCount()>1&&(u=e),this.topoOperationPolygonPolygon_(e,s,u)}if(n===1&&o===2){const u=ry();return u.allCrossRoadsImpassable=!1,u.ogcRule=this.m_bOGCOutput,u.unsplitBehavior=0,this.topoOperationPolylineSimplifyOrPolylineTopoHelper_(e,L,!1,u).first}if(n===1&&o===1){const u=ry();return u.allCrossRoadsImpassable=!0,u.ogcRule=this.m_bOGCOutput,u.unsplitBehavior=0,this.topoOperationPolylineSimplifyOrPolylineTopoHelper_(e,L,!1,u).first}if(n===0)return this.topoOperationMultiPoint_();Ce("")}symmetricDifference(e,s){const i=this.m_topoGraph.getShape().getGeometryType(e),r=this.m_topoGraph.getShape().getGeometryType(s),n=yM(i),o=yM(r),a=this.m_topoGraph.getGeometryID(e),l=this.m_topoGraph.getGeometryID(s);return F(a>=0),F(l>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=1+(a|l),this.m_maskLookup[a]=!0,this.m_maskLookup[a]=!0,this.m_maskLookup[l]=!0,n===2&&o===2?this.topoOperationPolygonPolygon_(e,s,L):n===1&&o===1?this.topoOperationPolyline_(L,this.m_bOGCOutput):n===0&&o===0?this.topoOperationMultiPoint():void Ce("")}planarSimplifyNoCrackingAndCluster(e,s,i,r){this.m_bOGCOutput=e,this.m_topoGraph=new Fl;const n=s.getFillRule(i),o=s.getGeometryType(i);if(n!==1||o===G.enumMultiPoint?this.m_topoGraph.setAndSimplifyEditShapeAlternate(s,i,this.m_progressTracker):this.m_topoGraph.setAndSimplifyEditShapeWinding(s,i,this.m_progressTracker),this.m_topoGraph.dirtyCheckFailed())return!1;this.m_topoGraph.setCheckDirtyPlanesweepTolerance(Number.NaN);const a=this.m_topoGraph.getGeometryID(i);if(F(a>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=a+1,this.m_maskLookup[a]=!0,s.getGeometryType(i)===G.enumPolygon||n===1&&s.getGeometryType(i)!==G.enumMultiPoint){s.setFillRule(i,0);const l=this.topoOperationPolygonPolygon_(i,L,L);if(s.swapGeometry(l,i),s.removeGeometry(l),n===1&&this.m_bOGCOutput)return this.planarSimplifyNoCrackingAndCluster(e,s,i,r)}else if(s.getGeometryType(i)===G.enumPolyline){const l=ry();l.ogcRule=this.m_bOGCOutput,l.allCrossRoadsImpassable=!0,l.unsplitBehavior=r;const u=this.topoOperationPolylineSimplify_(s.getFirstGeometry(),l);s.swapGeometry(u,i),s.removeGeometry(u)}else if(s.getGeometryType(i)===G.enumMultiPoint){const l=this.topoOperationMultiPoint_();s.swapGeometry(l,i),s.removeGeometry(l)}else Ce("");return!0}unsplitPolylineExact(e){return F(0),new qt}planarSimplifyPolylines(e,s,i,r,n){for(let f=e.getFirstGeometry();f!==L;f=e.getNextGeometry(f)){const g=e.getGeometryType(f);F(g===G.enumPolyline)}let o=0,a=0,l=null;if(e.hasCurves()&&!e.hasSegmentParentage()){l=new Ha;const f=e.getEnvelope2D(this.m_progressTracker);a=Oc(s.total());const g=ja(s.total(),f);o=Vc(g,a),Ol(e,g,s.total(),12e3,l,null,this.m_progressTracker)}{const f=Lve(s.add(o));e.filterClosePoints(f,!1,!1,!1,L)}if(this.m_topoGraph=new Fl,n!==4&&n!==5)if(l===null&&i){const f=new AG(this.m_progressTracker,!1);f.sweepVertical(e,s.total()),f.hadComplications()?(Ac(e,s,this.m_progressTracker,!0,!1),i=!1):this.m_topoGraph.setCheckDirtyPlanesweepTolerance(s.total())}else Ac(e,s.add(o),this.m_progressTracker,!0,!1),i=!1;else i=!1;e.removeSelection(),e.collapseAllGeometriesToFirst();const u=e.getFirstGeometry();if(this.m_topoGraph.setAndSimplifyEditShapeAlternate(e,u,this.m_progressTracker),this.m_topoGraph.dirtyCheckFailed())return F(i&&l===null),this.m_topoGraph.removeShape(),this.m_topoGraph=null,this.planarSimplifyPolylines(e,s,!1,r,-1);this.m_topoGraph.setCheckDirtyPlanesweepTolerance(Number.NaN);const c=this.m_topoGraph.getGeometryID(u);F(c>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=c+1,this.m_maskLookup[c]=!0;const h=this.topoOperationPolylineSimplify_(e.getFirstGeometry(),r);l!==null&&l.stitchCurves(e,h,a,!0);const m=e.getGeometry(h);return i||m.getImpl().setIsSimple(4,s.total()),m}planarSimplifyMultiPoints(e,s,i,r){for(let u=e.getFirstGeometry();u!==L;u=e.getNextGeometry(u)){const c=e.getGeometryType(u);F(c===G.enumMultiPoint)}this.m_topoGraph=new Fl,r!==4&&r!==5&&Ac(e,s,this.m_progressTracker,!0,!1),i=!1,e.removeSelection(),e.collapseAllGeometriesToFirst();const n=e.getFirstGeometry();if(this.m_topoGraph.setAndSimplifyEditShapeAlternate(e,n,this.m_progressTracker),this.m_topoGraph.dirtyCheckFailed())return F(i),this.m_topoGraph.removeShape(),this.m_topoGraph=null,this.planarSimplifyMultiPoints(e,s,!1,-1);this.m_topoGraph.setCheckDirtyPlanesweepTolerance(Number.NaN);const o=this.m_topoGraph.getGeometryID(n);F(o>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=o+1,this.m_maskLookup[o]=!0;const a=this.topoOperationMultiPoint(),l=e.getGeometry(a);return i||l.getImpl().setIsSimple(4,s.total()),l}planarSimplifyPolygons(e,s,i,r,n,o){for(let b=e.getFirstGeometry();b!==L;b=e.getNextGeometry(b)){const w=e.getGeometryType(b);F(w===G.enumPolygon||w===G.enumPolyline&&i)}let a=0,l=0,u=null;if(e.hasCurves()&&!e.hasSegmentParentage()){u=new Ha;const b=e.getEnvelope2D(this.m_progressTracker);l=Oc(s.total());const w=ja(s.total(),b);a=Vc(w,l),Ol(e,w,s.total(),12e3,u,null,this.m_progressTracker)}if(o){Ac(e,s.add(a),this.m_progressTracker,!0,!1);for(let b=e.getFirstGeometry();b!==L;b=e.getNextGeometry(b))e.getGeometryType(b)===G.enumPolygon&&_d(e,b,-1,!1,L,this.m_progressTracker)}if(this.m_topoGraph=new Fl,o||n===4||n===5)r=!1;else if(u===null&&r){const b=new AG(this.m_progressTracker,!1);b.sweepVertical(e,s.total()),b.hadComplications()?(Ac(e,s,this.m_progressTracker,!0,!1),r=!1):this.m_topoGraph.setCheckDirtyPlanesweepTolerance(s.total())}else Ac(e,s.add(a),this.m_progressTracker,!0,!1),r=!1;e.removeSelection(),e.collapseAllGeometriesToFirst();const c=e.getFirstGeometry();if(i?this.m_topoGraph.setAndSimplifyEditShapeWinding(e,c,this.m_progressTracker):this.m_topoGraph.setAndSimplifyEditShapeAlternate(e,c,this.m_progressTracker),this.m_topoGraph.dirtyCheckFailed())return F(r&&u===null),this.m_topoGraph.removeShape(),this.m_topoGraph=null,this.planarSimplifyPolygons(e,s,i,!1,-1,!1);this.m_topoGraph.setCheckDirtyPlanesweepTolerance(Number.NaN);const h=this.m_topoGraph.getGeometryID(c);F(h>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=h+1,this.m_maskLookup[h]=!0,e.setFillRule(c,0);const m=this.m_bOGCOutput&&i,f=m;let g=this.topoOperationPolygonPolygon_(c,L,L,f);m&&(this.m_topoGraph.removeShape(),this.m_topoGraph=null,e.removeGeometry(c),this.m_topoGraph=new Fl,this.m_topoGraph.setAndSimplifyEditShapeAlternate(e,g,this.m_progressTracker),g=this.topoOperationPolygonPolygon_(g,L,L,!1)),u!==null&&u.stitchCurves(e,g,l,!0);const v=e.getGeometry(g);return v.setFillRule(0),r?v.getImpl().setIsSimple(3,0):(v.getImpl().setIsSimple(4,s.total()),v.getImpl().updateOGCFlagsProtected()),v}planarSimplify3DImpl_(e,s,i,r,n){return F(0),{}}planarSimplifyImpl_(e,s,i,r,n,o,a,l){if(e.isEmpty())return e.clone();const u=e.getGeometryType(),c=new oi,h=c.addGeometry(e);if(tm(n)&&u===G.enumPolygon&&(i=!1,c.setFillRule(h,0)),l&&(e.hasAttribute(1)&&c.replaceNaNs(1,0),c.removeNaNVertices()),u===G.enumPolygon||u===G.enumPolyline&&i)return this.planarSimplifyPolygons(c,s,i,r,n,!1);if(u===qt.type){const m=ry();return m.allCrossRoadsImpassable=!0,m.ogcRule=this.m_bOGCOutput,m.unsplitBehavior=a,this.planarSimplifyPolylines(c,s,r,m,n)}if(u===G.enumMultiPoint)return this.planarSimplifyMultiPoints(c,s,r,n);Ce("what else?")}}function vnt(t,e,s,i){if(t.isEmpty())return t.createInstance();if(e.isEmpty())return i?t.createInstance():new nt({copy:t});const r=[new M],n=[0],o=e.getDimension()===2;return e.getDimension()!==1&&e.getDimension()!==2&&Ce(""),r[0]=t.getXY(),o?eB(e,r,1,s.total(),n):Fve(e,r,1,s.total(),n),n[0]===0?t.createInstance():t}function bnt(t,e,s,i){const r=t.createInstance(),n=ne(M,100),o=new Array(100),a=t.getPointCount();let l=!0;const u=e.getDimension()===2;e.getDimension()!==1&&e.getDimension()!==2&&Ce("");for(let c=0;c<a;){const h=t.queryCoordinates(n,n.length,c,-1)-c;u?eB(e,n,h,s.total(),o):Fve(e,n,h,s.total(),o);let m=0;for(let f=0;f<h;f++)o[f]===0&&(l&&(l=!1,r.addPoints(t,0,c)),m!==f&&r.addPoints(t,c+m,c+f),m=f+1);l||m===h||r.addPoints(t,c+m,c+h),c+=h}return l?t:r}function Ya(t,e,s,i){const r=t.getGeometryType();if(r===G.enumEnvelope){const n=new wt({vd:t.getDescription()});return t.isEmpty()||n.addEnvelope(t,!1),n}if(r===G.enumPoint&&(i==="|"||i==="^")){const n=new pi({vd:t.getDescription()});return t.isEmpty()||n.add(t),n}if(r===G.enumLine){const n=new qt({vd:t.getDescription()});return t.isEmpty()||n.addSegment(t,!0),n}if(r===G.enumMultiPoint&&i==="-"&&e.getGeometryType()===G.enumPoint){const n=new nt({vd:t.getDescription()});return t.isEmpty()||t.getPointByVal(0,n),n}if(r===G.enumMultiPoint&&i==="&"&&e.getGeometryType()===G.enumPoint){const n=new nt({vd:t.getDescription()});return t.isEmpty()||t.getPointByVal(0,n),n}return t}function Qi(t){const e=t.getGeometryType();if(e===G.enumEnvelope){const s=new wt({vd:t.getDescription()});return t.isEmpty()||s.addEnvelope(t,!1),s}if(e===G.enumPoint){const s=new pi({vd:t.getDescription()});return t.isEmpty()||s.add(t),s}if(ant(e)){const s=new qt({vd:t.getDescription()});return t.isEmpty()||s.addSegment(t,!0),s}return e!==G.enumMultiPoint&&e!==G.enumPolyline&&e!==G.enumPolygon&&ee("Unexpected geometry type"),t}function wL(t,e,s,i){const r=s===L?t.getClusterHalfEdge(e):s;let n=r;F(t.getHalfEdgeOrigin(r)===e);do i(n),n=t.getHalfEdgeNext(t.getHalfEdgeTwin(n));while(n!==r)}class xnt{constructor(e,s,i,r,n,o){this.m_rParent=e,this.m_rTopoGraph=e.m_topoGraph,this.m_rShape=this.m_rTopoGraph.getShape(),this.m_IDCuttee=this.m_rTopoGraph.getGeometryID(r),this.m_IDCutter=this.m_rTopoGraph.getGeometryID(n),this.m_IDBoth=this.m_IDCuttee|this.m_IDCutter,this.m_bConsiderTouch=s,this.m_sideIndex=i,this.m_cuttee=r,this.m_cutter=n,this.m_rCutHandles=o,this.m_cutteeBreadcrumbsIndex=this.m_rShape.createUserIndexUninitialized(),this.m_clusterParentageIndex=this.m_rShape.createUserIndexUninitialized();for(let a=this.m_rShape.getFirstPath(this.m_cuttee);a!==L;a=this.m_rShape.getNextPath(a)){let l=0;const u=this.m_rShape.getPathSize(a);for(let c=this.m_rShape.getFirstVertex(a);l<u;l++,c=this.m_rShape.getNextVertex(c))this.m_rShape.setUserIndex(c,this.m_clusterParentageIndex,this.m_rTopoGraph.getClusterParentage(this.m_rTopoGraph.getClusterFromVertex(c)))}}Do(){this.cutPolylinePolyline_(),this.m_rShape.removeUserIndex(this.m_cutteeBreadcrumbsIndex),this.m_rShape.removeUserIndex(this.m_clusterParentageIndex)}setTbd(e){return 8|e}classifyStandardCut(e,s,i,r){const n=this.m_rShape.getPrevVertex(e),o=this.m_rShape.getNextVertex(e),a=n===L?L:this.m_rTopoGraph.getHalfEdgeConnector(s,this.m_rTopoGraph.getClusterFromVertex(n)),l=o===L?L:this.m_rTopoGraph.getHalfEdgeConnector(s,this.m_rTopoGraph.getClusterFromVertex(o)),u=this.m_rTopoGraph.getHalfEdgeConnector(s,this.m_rTopoGraph.getClusterFromVertex(i)),c=this.m_rTopoGraph.getHalfEdgeConnector(s,this.m_rTopoGraph.getClusterFromVertex(r));let h=1,m=32,f=32;if(wL(this.m_rTopoGraph,s,c,g=>{g===u&&(h=2),g===a&&(m=h),g===l&&(f=h)}),this.m_bConsiderTouch)m!==32&&this.m_rShape.setUserIndex(n,this.m_cutteeBreadcrumbsIndex,this.m_rShape.getUserIndex(n,this.m_cutteeBreadcrumbsIndex)|m),f!==32&&this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex)|f);else{if(m===32||f===32||m===f&&!(a===u||a===c||l===u||l===c))return 1;this.m_rShape.setUserIndex(n,this.m_cutteeBreadcrumbsIndex,this.m_rShape.getUserIndex(n,this.m_cutteeBreadcrumbsIndex)|m),this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex)|f)}return 0}classifyTouchCut(e,s,i,r){const n=this.m_rShape.getPrevVertex(e),o=this.m_rShape.getNextVertex(e),a=n===L?L:this.m_rTopoGraph.getHalfEdgeConnector(s,this.m_rTopoGraph.getClusterFromVertex(n)),l=o===L?L:this.m_rTopoGraph.getHalfEdgeConnector(s,this.m_rTopoGraph.getClusterFromVertex(o)),u=i===L?L:this.m_rTopoGraph.getHalfEdgeConnector(s,this.m_rTopoGraph.getClusterFromVertex(i)),c=r===L?L:this.m_rTopoGraph.getHalfEdgeConnector(s,this.m_rTopoGraph.getClusterFromVertex(r));if(!this.m_bConsiderTouch){let h;return(h=u===a||c===a)?this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex))):(h=u===l||c===l)&&this.m_rShape.setUserIndex(n,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(n,this.m_cutteeBreadcrumbsIndex))),h?0:1}if(a===L)return this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex))),0;if(l===L)return this.m_rShape.setUserIndex(n,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(n,this.m_cutteeBreadcrumbsIndex))),0;if(a===l)return this.m_rShape.setUserIndex(n,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(n,this.m_cutteeBreadcrumbsIndex))),this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex))),0;if(c!==L){if(a===c)return this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex))),0;if(l===c)return this.m_rShape.setUserIndex(n,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(n,this.m_cutteeBreadcrumbsIndex))),0;let h=1;wL(this.m_rTopoGraph,s,c,m=>{if(m===a){const f=this.m_rShape.getUserIndex(n,this.m_cutteeBreadcrumbsIndex)|h;this.m_rShape.setUserIndex(n,this.m_cutteeBreadcrumbsIndex,f),h=2}else if(m===l){const f=this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex)|h;this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,f),h=2}})}else{if(a===u)return this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex))),0;if(l===u)return this.m_rShape.setUserIndex(n,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(n,this.m_cutteeBreadcrumbsIndex))),0;let h=2;wL(this.m_rTopoGraph,s,u,m=>{if(m===a){const f=this.m_rShape.getUserIndex(n,this.m_cutteeBreadcrumbsIndex)|h;this.m_rShape.setUserIndex(n,this.m_cutteeBreadcrumbsIndex,f),h=1}else if(m===l){const f=this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex)|h;this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,f),h=1}})}return 0}classifyCutVertex(e,s){let i=0,r=0;for(let n=this.m_rTopoGraph.getClusterVertexIterator(s);n!==L;n=this.m_rTopoGraph.incrementVertexIterator(n)){const o=this.m_rTopoGraph.getVertexFromVertexIterator(n);if(this.m_rShape.getGeometryFromVertex(o)===this.m_cutter){r++;const a=this.m_rShape.getPrevVertex(o),l=this.m_rShape.getNextVertex(o);i+=a===L||l===L?this.classifyTouchCut(e,s,a,l):this.classifyStandardCut(e,s,a,l)}}r&&i===r&&!this.m_bConsiderTouch&&this.m_rShape.setUserIndex(e,this.m_clusterParentageIndex,this.m_IDCuttee)}cutPolylinePolyline_(){this.m_rShape.getGeometryType(this.m_cuttee),this.m_rShape.getGeometryType(this.m_cutter),this.m_rParent.m_maskLookup.length=0,this.m_rParent.m_maskLookup.length=this.m_IDBoth+1,this.m_rParent.m_maskLookup[this.m_IDBoth]=!0;for(let a=this.m_rShape.getFirstPath(this.m_cuttee);a!==L;a=this.m_rShape.getNextPath(a)){const l=this.m_rShape.getPathSize(a);let u=this.m_rShape.getFirstVertex(a);for(let c=0;c<l;++c,u=this.m_rShape.getNextVertex(u))this.m_rShape.setUserIndex(u,this.m_cutteeBreadcrumbsIndex,0);u=this.m_rShape.getFirstVertex(a);for(let c=0;c<l;++c,u=this.m_rShape.getNextVertex(u)){const h=this.m_rTopoGraph.getClusterFromVertex(u);this.m_rTopoGraph.getClusterParentage(h)===this.m_IDBoth&&this.classifyCutVertex(u,h)}}const e=(a,l)=>{let u=this.m_rShape.getUserIndex(a,this.m_cutteeBreadcrumbsIndex);const c=this.m_rTopoGraph.getHalfEdgeConnector(this.m_rTopoGraph.getClusterFromVertex(a),this.m_rTopoGraph.getClusterFromVertex(l));return(this.m_rTopoGraph.getHalfEdgeParentage(c)&this.m_IDBoth)===this.m_IDBoth&&(u|=4),u};for(let a=this.m_rShape.getFirstPath(this.m_cuttee);a!==L;a=this.m_rShape.getNextPath(a)){let l=this.m_rShape.getFirstVertex(a);const u=this.m_rShape.isClosedPath(a),c=this.m_rShape.getPathSize(a)+(u?1:0);let h=1,m=32;for(let g=this.m_rShape.getNextVertex(l);h<c;++h,l=g,g=this.m_rShape.getNextVertex(g)){const v=e(l,g);this.m_rShape.getUserIndex(l,this.m_clusterParentageIndex)===this.m_IDBoth&&(m=v),m!==32&&this.m_rShape.setUserIndex(l,this.m_cutteeBreadcrumbsIndex,m|v)}l=this.m_rShape.getLastVertex(a);let f=32;h=1;for(let g=this.m_rShape.getPrevVertex(l);h<c;++h,l=g,g=this.m_rShape.getPrevVertex(g)){const v=e(g,l);this.m_rShape.getUserIndex(l,this.m_clusterParentageIndex)===this.m_IDBoth&&(f=v),f!==32&&this.m_rShape.setUserIndex(g,this.m_cutteeBreadcrumbsIndex,f|v)}}let s=L,i=L,r=32;const n=this.m_rShape.hasSegmentParentage(),o=new ut;for(let a=this.m_rShape.getFirstPath(this.m_cuttee);a!==L;a=this.m_rShape.getNextPath(a)){const l=this.m_rShape.isClosedPath(a),u=this.m_rShape.getPathSize(a)+(l?1:0);let c=1,h=this.m_rShape.getFirstVertex(a),m=L,f=!0;for(let g=this.m_rShape.getNextVertex(h);c<u;++c,g=this.m_rShape.getNextVertex(g)){let v=this.m_rShape.getUserIndex(h,this.m_cutteeBreadcrumbsIndex);v===8?v=3:(v&=-9,4&v?v=4:3&~v||(v=3)),v!==r?(s!==L&&(m=this.m_rShape.addVertex(i,h),n&&this.m_rTopoGraph.isBreakNode(this.m_rTopoGraph.getClusterFromVertex(h))&&this.m_rShape.setSegmentParentageBreakVertex(m,!0),this.m_rCutHandles.push(s),this.m_rShape.setGeometryUserIndex(s,this.m_sideIndex,r)),s=this.m_rShape.createGeometry(G.enumPolyline),i=this.m_rShape.insertPath(s,L),r=v,f=!0):this.m_rShape.getUserIndex(h,this.m_clusterParentageIndex)===this.m_IDBoth&&v!==4&&(m=this.m_rShape.addVertex(i,h),n&&this.m_rTopoGraph.isBreakNode(this.m_rTopoGraph.getClusterFromVertex(h))&&this.m_rShape.setSegmentParentageBreakVertex(m,!0),i=this.m_rShape.insertPath(s,L),f=!0),m=this.m_rShape.addVertex(i,h);const b=this.m_rTopoGraph.getClusterFromVertex(h);!f&&n&&this.m_rTopoGraph.isBreakNode(b)&&this.m_rShape.setSegmentParentageBreakVertex(m,!0);const w=this.m_rTopoGraph.getHalfEdgeFromVertex(h);if(n){const S=this.m_rTopoGraph.getSegmentParentage(w);this.m_rShape.setSegmentParentageAndBreak(m,S,f||this.m_rTopoGraph.isBreakNode(b))}this.m_rTopoGraph.isHalfEdgeCurve(w)&&(this.m_rTopoGraph.querySegmentXY(w,o),this.m_rShape.setSegmentToIndex(this.m_rShape.getVertexIndex(m),o.get().clone())),h=g,f=!1}m=this.m_rShape.addVertex(i,h),n&&this.m_rTopoGraph.isBreakNode(this.m_rTopoGraph.getClusterFromVertex(h))&&this.m_rShape.setSegmentParentageBreakVertex(m,!0),this.m_rCutHandles.push(s),this.m_rShape.setGeometryUserIndex(s,this.m_sideIndex,r),s=L,i=L,r=32}}}function wnt(t,e,s){return new wa(s).linesToPolygonsImpl(t,e)}function Snt(t,e,s,i,r){if(i&&(i.m_reason=0,i.m_vertexIndex1=-1,i.m_vertexIndex2=-1),t.isEmpty())return 5;const n=t.getGeometryType();if(n===G.enumPoint)return TP(t,i);const o=ba(e,t,!1).total();if(n===G.enumEnvelope){const h=t,m=new X;return h.queryEnvelope(m),m.isDegenerate(o)?(i&&(i.m_reason=4,i.m_vertexIndex1=-1,i.m_vertexIndex2=-1),0):5}if(zi(n)){const h=t,m=new qt({vd:h.getDescription()});return m.addSegment(h,!0),tB(m,e,s,i,r)}const a=[0],l=t.getImpl().getIsSimple(o,a);let u=s?-1:l;if(Hf(u)||u===0)return u;const c=new Du(t,e,u,r,!1);return n===G.enumMultiPoint||n===G.enumPolyline||n===G.enumPolygon?u=c.isSimplePlanarImpl():Ce(""),t.getImpl().setIsSimple(u,o),i&&i.assign(c.m_nonSimpleResult),u}function Vve(t,e,s,i,r){if(i&&(i.m_reason=0,i.m_vertexIndex1=-1,i.m_vertexIndex2=-1),t.isEmpty())return 5;const n=t.getGeometryType();if(n===G.enumPoint)return TP(t,i);const o=ba(e,t,!1).total();if(n===G.enumEnvelope){const h=t,m=new X;return h.queryEnvelope(m),m.isDegenerate(o)?(i&&(i.m_reason=4,i.m_vertexIndex1=-1,i.m_vertexIndex2=-1),0):5}if(zi(n)){const h=t,m=new qt({vd:h.getDescription()});return m.addSegment(h,!0),Vve(m,e,s,i,r)}nR(n),zo(n)||yt("OGC simplify is not implemented for this geometry type");const a=[0],l=t.getImpl().getIsSimple(o,a);let u=s?-1:l;if(u===5||u===0)return u;const c=new Du(t,e,u,r,!0);return n===G.enumMultiPoint||n===G.enumPolyline||n===G.enumPolygon?(u=c.isSimplePlanarImpl(),Hf(u)&&(u=5)):Ce(""),t.getImpl().setIsSimple(u,o),i&&i.assign(c.m_nonSimpleResult),u}function tB(t,e,s,i,r){if(i&&(i.m_reason=0,i.m_vertexIndex1=-1,i.m_vertexIndex2=-1),t.isEmpty())return 5;const n=t.getGeometryType();if(n===G.enumPoint)return TP(t,i);const o=ba(e,t,!1).total();if(n===G.enumEnvelope){const h=t,m=X.constructEmpty();return h.queryEnvelope(m),m.isDegenerate(o)?(i&&(i.m_reason=4,i.m_vertexIndex1=-1,i.m_vertexIndex2=-1),0):5}if(zi(n)){const h=t,m=new qt({vd:h.getDescription()});return m.addSegment(h,!0),tB(m,e,s,i,r)}const a=[0],l=t.getImpl().getIsSimple(o,a);let u=s?-1:l;if(u!==-1)return u;const c=new Du(t,e,u,r,!1);return n===G.enumMultiPoint?u=c.multipointIsSimpleAsFeature():n===G.enumPolyline?u=c.polylineIsSimpleAsFeature():n===G.enumPolygon?u=c.polygonIsSimpleAsFeature():Ce(""),t.getImpl().setIsSimple(u,o),i&&i.assign(c.m_nonSimpleResult),u}function qve(t,e,s,i){if(t.isEmpty())return t;const r=t.getGeometryType();if(r===G.enumPoint){const h=new gs;if(TP(t,h),h.m_reason===3){const m=t.clone();return m.replaceNaNs(1,0),m}return h.m_reason===2?t.createInstance():t}if(r===G.enumEnvelope){const h=ba(e,t,!0).total(),m=t,f=X.constructEmpty();return m.queryEnvelope(f),f.isDegenerate(h)?m.createInstance():t}if(zi(r)){const h=t,m=new qt({vd:h.getDescription()});return m.addSegment(h,!0),qve(m,e,s,i)}nR(r);const n=ba(e,t,!1).total(),o=[0],a=t.getImpl().getIsSimple(n,o),l=s?-1:a;if(Hf(l)){if(r===G.enumPolygon&&t.getFillRule()!==0){const h=t.clone();return h.setFillRule(0),h}return t}if((r===G.enumMultiPoint||r===G.enumPolyline)&&l>=1)return t;const u=new Du(t,e,l,i,!1);let c;return r===G.enumMultiPoint?c=u.multipointSimplifyAsFeature():r===G.enumPolyline?c=u.polylineSimplifyAsFeature():r===G.enumPolygon?c=u.polygonSimplifyAsFeature():Ce(""),c}function Gve(t,e,s,i){if(t.isEmpty())return t;const r=t.getGeometryType();if(r===G.enumPoint){const u=new gs;if(TP(t,u),u.m_reason===3){const c=t.clone();return c.replaceNaNs(1,0),c}return u.m_reason===2?t.createInstance():t}if(r===G.enumEnvelope){const u=t,c=new X;u.queryEnvelope(c);const h=ba(e,t,!0).total();return c.isDegenerate(h)?u.createInstance():t}if(zi(r)){const u=t,c=new qt({vd:u.getDescription()});return c.addSegment(u,!0),Gve(c,e,s,i)}nR(r),zo(r)||yt("OGC simplify is not implemented for this geometry type");const n=ba(e,t,!1).total(),o=[0],a=t.getImpl().getIsSimple(n,o),l=s?-1:a;if(l===5){if(r===G.enumPolygon&&t.getFillRule()!==0){const u=t.clone();return u.setFillRule(0),u}return t}return NG(t,ba(e,t,!0),!1,l,i,0,!0)}function TP(t,e){const s=t.getX(),i=t.getY();if(!Number.isFinite(s)||!Number.isFinite(i))return e&&(e.m_reason=2,e.m_vertexIndex1=-1,e.m_vertexIndex2=-1),0;if(t.hasAttribute(1)){const r=t.getZ();if(!Number.isFinite(r))return e&&(e.m_reason=Number.isNaN(r)?3:2,e.m_vertexIndex1=-1,e.m_vertexIndex2=-1),0}return 5}class mne{constructor(){this.m_segment=null,this.m_vertexIndex=-1,this.m_pathIndex=-1,this.m_flags=0}setReversed(e){this.m_flags&=-2,this.m_flags=this.m_flags|(e?1:0)}getReversed(){return!!(1&this.m_flags)}getRightSide(){return this.getReversed()?0:1}}function Ent(){return{x:-1,y:-1,ipath:-1,ivertex:-1,ipolygon:-1}}function Cnt(t,e,s,i,r){return{x:t,y:e,ipath:s,ivertex:i,ipolygon:r}}function Pnt(t,e){return t.x===e.x&&t.y===e.y&&t.ipath===e.ipath&&t.ivertex===e.ivertex&&t.ipolygon===e.ipolygon}function Tnt(t,e){t.x=e.x,t.y=e.y,t.ipath=e.ipath,t.ivertex=e.ivertex,t.ipolygon=e.ipolygon}function Int(){return{x:-1,y:-1,ipath:-1,ivertex:-1,bBoundary:!1,bEndPoint:!1}}function Mnt(t,e,s,i,r,n){return{x:t,y:e,ipath:s,ivertex:i,bBoundary:r,bEndPoint:n}}function Ant(t,e){t.x=e.x,t.y=e.y,t.ipath=e.ipath,t.ivertex=e.ivertex,t.bBoundary=e.bBoundary,t.bEndPoint=e.bEndPoint}class Nnt extends E0{constructor(e){super(),this.m_helper=e}compare(e,s,i){const r=e.getElement(i),n=this.m_helper.m_xy.read(2*s)-this.m_helper.m_xy.read(2*r);return n<0?-1:n>0?1:0}}class Dnt extends E0{constructor(e){super(),this.m_helper=e}compare(e,s,i){const r=e.getElement(i),n=this.m_helper.m_edges[s],o=this.m_helper.m_edges[r],a=n.getReversed(),l=o.getReversed();let u=n.m_segment.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0),c=o.m_segment.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0);if(u===c){const h=a?n.m_segment.getStartY():n.m_segment.getEndY(),m=l?o.m_segment.getStartY():o.m_segment.getEndY(),f=Math.min(h,m);let g=.5*(f-this.m_helper.m_yScanline)+this.m_helper.m_yScanline;g===this.m_helper.m_yScanline&&(g=f),u=n.m_segment.intersectionOfYMonotonicWithAxisX(g,0),c=o.m_segment.intersectionOfYMonotonicWithAxisX(g,0)}return u<c?-1:u>c?1:0}}class Du{constructor(e,s,i,r,n){this.m_multiVertexGeom=null,this.m_edges=[],this.m_freeEdges=[],this.m_lineEdgesRecycle=[],this.m_newEdges=[],this.m_recycledSegIter=null,this.m_crossOverHelperList=new Wr,this.m_progressTracker=null,this.m_progressCounter=0,this.m_AET=new Xe,this.m_xyToNode1=null,this.m_xyToNode2=null,this.m_pathOrientations=null,this.m_pathParentage=null,this.m_xy=null,this.m_pairs=[],this.m_pairIndices=null,this.m_pathsForOGCTests=[],this.m_curveStitcher=null,this.m_editShape=null,this.m_multiPathStitcher=null,this.m_nonSimpleResult=new gs,this.m_progressCounter=0,this.m_progressTracker=r,this.m_geometry=e,this.m_knownSimpleResult=i,this.m_sr=s;const o=ba(s,e,!1);this.m_toleranceIsSimple=o,this.m_toleranceIsSimpleClustering=il(o),this.m_toleranceIsSimpleCracking=T9(o),this.m_toleranceSimplify=ba(s,e,!0),this.m_description=this.m_geometry.getDescription(),this.m_attributeCount=this.m_description.getAttributeCount(),this.m_bOGCRestrictions=n,this.m_bPlanarSimplify=this.m_bOGCRestrictions,this.m_unknownOrientationPathCount=-1,this.m_yScanline=0,this.m_progressCounter=0}isSimplePlanarImpl(){if(this.m_bPlanarSimplify=!0,!this.checkStructure())return 0;const e=this.m_geometry.getGeometryType();return xt(e)&&!this.checkDegenerateSegments(!1)?0:this._CheckClustering()?xt(e)?this._CheckCracking()?this.m_geometry.getGeometryType()===G.enumPolyline?this.checkSelfIntersectionsPolylinePlanar()?4:0:this._CheckSelfIntersections()?this._CheckValidRingOrientation():0:0:5:0}isSimplePlanarImpl3D(){return F(0),7}generateSortedPairs(e){let s=null;xt(e.getGeometryType())&&(s=e);const i=(this.m_bPlanarSimplify||this.m_bOGCRestrictions)&&s!==null,r=e.getPointCount();this.m_xy=e.getAttributeStreamRef(0),this.m_pairs.length=0,this.m_pairIndices=new Qs(0),i&&(this.m_pathsForOGCTests.length=0);let n=0;for(let l=0;l<r;l++)if(this.m_pairs.push(2*l),this.m_pairs.push(2*l+1),this.m_pairIndices.add(2*l),this.m_pairIndices.add(2*l+1),i){for(;l>=s.getPathEnd(n);)n++;this.m_pathsForOGCTests.push(n)}const o=new Jc,a={parent:this,workPt:new M,userSort(l,u,c){c.sort(l,u,(h,m)=>this.parent.compareVerticesForPlanarClustering(h,m,i))},getValue(l){const u=this.parent.m_pairs[l],c=u>>1;return this.parent.m_xy.queryPoint2D(2*c,this.workPt),this.workPt.y+(1&u?this.parent.m_toleranceIsSimpleClustering:-this.parent.m_toleranceIsSimpleClustering)}};o.sort(this.m_pairIndices,0,2*r,a)}_TestToleranceDistancePlanar(e,s){const i=this.m_xy.read(2*e),r=this.m_xy.read(2*e+1),n=this.m_xy.read(2*s),o=this.m_xy.read(2*s+1);return Z9(i,r,n,o,this.m_toleranceIsSimpleClustering*this.m_toleranceIsSimpleClustering)?this.m_geometry.getDimension()===0?!1:i===n&&r===o:!0}checkStructure(){const e=this.m_geometry.getGeometryType();if(xt(e)){const s=this.m_geometry.getImpl(),i=this.m_geometry.getGeometryType()===G.enumPolygon?3:2;for(let r=0,n=s.getPathCount();r<n;r++)if(s.getPathSize(r)<i){if(s.hasNonLinearSegments()&&s.hasNonLinearSegmentsPath(r)&&s.getPathSize(r)>0)continue;return this.m_nonSimpleResult=new gs(1,r,0),!1}}if(zo(e)){const s=this.m_geometry.getImpl(),i=s.getAttributeStreamRef(0);for(let r=0,n=s.getPointCount();r<n;r++)if(!i.readPoint2D(2*r).isFinite())return this.m_nonSimpleResult=new gs(2,r,0),!1;if(this.m_geometry.hasAttribute(1)){const r=s.getAttributeStreamRef(1);for(let n=0,o=s.getPointCount();n<o;n++){const a=r.read(n);if(!Number.isFinite(a))return Number.isNaN(a)?this.m_nonSimpleResult=new gs(3,n,0):this.m_nonSimpleResult=new gs(2,n,0),!1}}}return!0}checkDegenerateSegments(e){const s=this.m_geometry.getImpl(),i=s.querySegmentIterator(),r=s.hasAttribute(1),n=r?vie(this.m_sr,s,!1).total():0,o=s.hasNonLinearSegments(),a=this.m_toleranceIsSimple.total();for(;i.nextPath();)for(;i.hasNextSegment();){const l=i.nextSegment();let u=l.calculateLowerLength2D();if(!(u>a)&&!(o&&l.isCurve()&&(u=l.calculateLength2D(),u>a))){if(e&&r){const c=l.getStartAttributeAsDbl(1,0),h=l.getEndAttributeAsDbl(1,0);if(Math.abs(h-c)>n)continue}return this.m_nonSimpleResult=new gs(4,i.getStartPointIndex(),-1),!1}}return!0}checkDegenerateSegments3D(){return F(0),!1}_CheckClustering(){const e=this.m_geometry.getImpl();this.generateSortedPairs(e);const s=e.getPointCount();this.m_AET.clear(),this.m_AET.setComparator(new Nnt(this)),this.m_AET.setCapacity(s);for(let i=0,r=2*s;i<r;i++){this.progress_();const n=this.m_pairIndices.read(i),o=this.m_pairs[n],a=o>>1;if(1&o){const l=this.m_AET.search(a),u=this.m_AET.getPrev(l),c=this.m_AET.getNext(l);if(this.m_AET.deleteNode(l),u!==Xe.st_nullNode()&&c!==Xe.st_nullNode()&&!this._TestToleranceDistancePlanar(this.m_AET.getElement(u),this.m_AET.getElement(c)))return this.m_nonSimpleResult=new gs(5,this.m_AET.getElement(u),this.m_AET.getElement(c)),!1}else{const l=this.m_AET.addElement(a),u=this.m_AET.getPrev(l);if(u!==Xe.st_nullNode()&&!this._TestToleranceDistancePlanar(this.m_AET.getElement(u),a))return this.m_nonSimpleResult=new gs(5,a,this.m_AET.getElement(u)),!1;const c=this.m_AET.getNext(l);if(c!==Xe.st_nullNode()&&!this._TestToleranceDistancePlanar(this.m_AET.getElement(c),a))return this.m_nonSimpleResult=new gs(5,a,this.m_AET.getElement(c)),!1}}return!0}_CheckCracking(){const e=this.m_geometry.getImpl(),s=e.getPointCount();return!e.hasNonLinearSegments()&&s<10?this._CheckCrackingBrute():this._CheckCrackingPlanesweep()}_CheckCrackingPlanesweep(){if(this.m_editShape=new oi,this.m_editShape.addGeometry(this.m_geometry),this.m_editShape.hasCurves()){this.m_curveStitcher=new Ha;const s=X.constructEmpty();this.m_geometry.queryEnvelope(s);const i=ja(this.m_toleranceSimplify.total(),s),r=new gs;if(Ove(this.m_editShape,i,this.m_toleranceSimplify.total(),12e3,r,this.m_curveStitcher,null,this.m_progressTracker),r.m_reason!==0)return this.m_editShape=null,this.m_nonSimpleResult.assign(r),!1}const e=new gs;return Q9(!1,this.m_editShape,this.m_toleranceIsSimpleCracking,e,this.m_progressTracker)?(this.m_curveStitcher!=null?(e.m_vertexIndex1=this.m_curveStitcher.getOriginalVertexIndex(this.m_editShape,e.m_vertexIndex1),e.m_vertexIndex2=this.m_curveStitcher.getOriginalVertexIndex(this.m_editShape,e.m_vertexIndex2),this.m_curveStitcher=null):(e.m_vertexIndex1=this.m_editShape.getVertexIndex(e.m_vertexIndex1),e.m_vertexIndex2=this.m_editShape.getVertexIndex(e.m_vertexIndex2)),this.m_editShape=null,this.m_nonSimpleResult.assign(e),!1):(this.m_curveStitcher==null&&(this.m_editShape=null),!0)}_CheckCrackingBrute(){const e=this.m_geometry.getImpl(),s=e.querySegmentIterator(),i=e.querySegmentIterator();for(;s.nextPath();)for(;s.hasNextSegment();){const r=s.nextSegment();if(!s.isLastSegmentInPath()||!s.isLastPath()){i.resetTo(s);do for(;i.hasNextSegment();){const n=i.nextSegment(),o=Cx(!0,r,n,this.m_toleranceIsSimpleCracking,!0);if(o){const a=o===2?7:6;return this.m_nonSimpleResult=new gs(a,s.getStartPointIndex(),i.getStartPointIndex()),!1}}while(i.nextPath())}}return!0}_CheckSelfIntersections(){let e=this.m_geometry.getImpl();this.m_curveStitcher!==null&&(this.m_multiPathStitcher=this.m_editShape.getGeometry(this.m_editShape.getFirstGeometry()),e=this.m_multiPathStitcher.getImpl(),this.generateSortedPairs(e)),this.m_edges.length=0,this.m_lineEdgesRecycle.length=0,this.m_recycledSegIter=e.querySegmentIterator(),this.m_recycledSegIter.setCirculator(!0);const s=[],i=e.getPointCount();let r=Number.NaN,n=0;for(let o=0,a=2*i;o<a;o++){this.progress_();const l=this.m_pairIndices.read(o),u=this.m_pairs[l];if(1&u)continue;const c=u>>1,h=this.m_xy.read(2*c),m=this.m_xy.read(2*c+1);if(s.length&&(h!==r||m!==n)){if(!this.processBunchForSelfIntersectionTest(s))return!1;s.length=0}s.push(c),r=h,n=m}return!!this.processBunchForSelfIntersectionTest(s)}checkSelfIntersectionsPolylinePlanar(){const e=this.m_geometry.getImpl(),s=[];for(let a=0,l=e.getPathCount();a<l;a++)s.push(e.isClosedPathInXYPlane(a));const i=Int();let r,n,o;{const a=this.m_pairIndices.read(0),l=this.m_pairs[a]>>1,u=this.m_xy.readPoint2D(2*l),c=this.m_pathsForOGCTests[l];r=s[c],n=e.getPathStart(c),o=e.getPathEnd(c)-1,i.bEndPoint=l===n||l===o,this.m_bOGCRestrictions?i.bBoundary=!r&&i.bEndPoint:i.bBoundary=i.bEndPoint,i.ipath=c,i.x=u.x,i.y=u.y,i.ivertex=l}for(let a=1,l=this.m_pairIndices.size();a<l;a++){const u=this.m_pairIndices.read(a),c=this.m_pairs[u];if(1&c)continue;const h=c>>1,m=this.m_xy.readPoint2D(2*h),f=this.m_pathsForOGCTests[h];let g;f!==i.ipath&&(r=s[f],n=e.getPathStart(f),o=e.getPathEnd(f)-1);const v=h===n||h===o;g=this.m_bOGCRestrictions?!r&&v:v;const b=Mnt(m.x,m.y,f,h,g,v);if(b.x===i.x&&b.y===i.y){if(this.m_bOGCRestrictions){if(!(b.bBoundary&&i.bBoundary||b.ipath===i.ipath&&b.bEndPoint&&i.bEndPoint))return this.m_nonSimpleResult=new gs(10,b.ivertex,i.ivertex),!1}else if(!b.bEndPoint||!i.bEndPoint)return this.m_nonSimpleResult=new gs(7,b.ivertex,i.ivertex),!1}Ant(i,b)}return!0}checkSelfIntersectionsPolylinePlanar3D(e){return F(0),!1}checkSelfIntersectionsPolygonsOGC(){const e=this.m_geometry.getImpl(),s=[];let i=-1,r=!1;for(let h=0,m=e.getPathCount();h<m;h++)e.isExteriorRingOGC(h)&&(r=!1,i++,h<m-1&&(e.isExteriorRingOGC(h+1)||(r=!0))),s.push(r?i:-1);const n=Ent();{const h=this.m_pairIndices.read(0),m=this.m_pairs[h]>>1,f=this.m_xy.readPoint2D(2*m),g=this.m_pathsForOGCTests[m];n.ipath=g,n.x=f.x,n.y=f.y,n.ivertex=m,n.ipolygon=s[g]}const o=[];for(let h=1,m=this.m_pairIndices.size();h<m;h++){const f=this.m_pairIndices.read(h),g=this.m_pairs[f];if(1&g)continue;const v=g>>1,b=this.m_xy.readPoint2D(2*v),w=this.m_pathsForOGCTests[v],S=Cnt(b.x,b.y,w,v,s[w]);if(S.x===n.x&&S.y===n.y){if(S.ipath===n.ipath)return this.m_nonSimpleResult=new gs(11,S.ivertex,n.ivertex),!1;s[S.ipath]>=0&&s[S.ipath]===s[n.ipath]&&(o.length!==0&&Pnt(o.at(-1),n)||o.push({...n}),o.push(S))}Tnt(n,S)}if(o.length===0)return!0;const a=new Wr(!0);s.fill(-1);let l=-1;const u=new M;for(let h=0,m=o.length;h<m;h++){const f=o[h];f.x===u.x&&f.y===u.y||(l=a.createList(0),u.x=f.x,u.y=f.y);let g=s[f.ipath];g===-1&&(g=a.createList(2),s[f.ipath]=g),a.addElement(g,l),a.addElement(l,g)}const c=[];for(let h=a.getFirstList();h!==-1;h=a.getNextList(h)){const m=a.getListData(h);if(1&m||!(2&m))continue;let f=-1;for(c.push(h),c.push(-1);c.length;){const g=c.at(-1);c.pop();const v=c.at(-1);c.pop();const b=a.getListData(v);if(1&b){f=2&b?v:g;break}a.setListData(v,1|b);for(let w=a.getFirst(v);w!==-1;w=a.getNext(w)){const S=a.getData(w);S!==g&&(c.push(S),c.push(v))}}if(f!==-1){const g=s.indexOf(f);return this.m_nonSimpleResult=new gs(12,g,-1),!1}}return!0}_CheckValidRingOrientation(){const e=this.m_multiPathStitcher!==null?this.m_multiPathStitcher.getImpl():this.m_geometry.getImpl();if(e.calculateArea2D()<=0)return this.m_nonSimpleResult=new gs(8,e.getPathCount()===1?1:-1,-1),0;if(e.getPathCount()===1)return this.m_bOGCRestrictions&&!this.checkSelfIntersectionsPolygonsOGC()?0:4;this.m_pathOrientations=new Ob(e.getPathCount(),0),this.m_pathParentage=new Qs(e.getPathCount(),-1);let s=-1,i=0;for(let o=0,a=e.getPathCount();o<a;o++){const l=e.calculateRingArea2D(o);if(this.m_pathOrientations.write(o,l<0?0:8),l>0)s=o,i=l;else{if(l===0)return this.m_nonSimpleResult=new gs(8,o,-1),0;if((s<0||i<Math.abs(l))&&(this.m_nonSimpleResult=new gs(9,o,-1),this.m_bOGCRestrictions))return 0;this.m_pathParentage.write(o,s)}}this.m_unknownOrientationPathCount=e.getPathCount(),this.m_newEdges.length=0;const r=e.getPointCount();this.m_yScanline=Number.NaN;const n=[];this.m_xyToNode1=new Qs(r,Xe.st_nullNode()),this.m_xyToNode2=new Qs(r,Xe.st_nullNode()),this.m_freeEdges.length=0,this.m_AET.clear(),this.m_AET.setComparator(new Dnt(this));for(let o=0,a=2*r;this.m_unknownOrientationPathCount>0&&o<a;o++){const l=this.m_pairIndices.read(o),u=this.m_pairs[l];if(1&u)continue;const c=u>>1,h=this.m_xy.read(2*c+1);if(h!==this.m_yScanline&&n.length){if(!this.processBunchForRingOrientationTest(n))return 0;n.length=0}n.push(c),this.m_yScanline=h}return this.m_unknownOrientationPathCount>0&&!this.processBunchForRingOrientationTest(n)?0:this.m_bOGCRestrictions?this.m_nonSimpleResult.m_reason!==0?0:this.checkSelfIntersectionsPolygonsOGC()?5:0:this.m_nonSimpleResult.m_reason===0?4:3}processBunchForSelfIntersectionTest(e){if(e.length===1)return!0;for(let a=0,l=e.length;a<l;a++){const u=e[a];this.m_recycledSegIter.resetToVertex(u,-1);const c=this.m_recycledSegIter.previousSegment();this.m_edges.push(this.createEdge(c,u,this.m_recycledSegIter.getPathIndex(),!0)),this.m_recycledSegIter.nextSegment();const h=this.m_recycledSegIter.nextSegment();this.m_edges.push(this.createEdge(h,u,this.m_recycledSegIter.getPathIndex(),!1))}this.m_edges.sort((a,l)=>this.edgeAngleCompare(a,l));let s=this.m_crossOverHelperList.getFirstList();s===-1&&(s=this.m_crossOverHelperList.createList(0)),this.m_crossOverHelperList.reserveNodes(this.m_edges.length);for(let a=0,l=this.m_edges.length;a<l;a++)this.m_crossOverHelperList.addElement(s,a);let i=!0,r=-1,n=-1;for(;i;){i=!1;let a=this.m_crossOverHelperList.getFirst(s);if(a===-1)break;let l=this.m_crossOverHelperList.getNext(a);for(;l!==-1;){const u=this.m_crossOverHelperList.getData(a),c=this.m_crossOverHelperList.getData(l);if(r=this.m_edges[u].m_vertexIndex,n=this.m_edges[c].m_vertexIndex,r!==n)a=l,l=this.m_crossOverHelperList.getNext(a);else if(i=!0,this.m_crossOverHelperList.deleteElement(s,a),a=this.m_crossOverHelperList.getPrev(l),l=this.m_crossOverHelperList.deleteElement(s,l),l===-1||a===-1)break}}const o=this.m_crossOverHelperList.getListSize(s);if(this.m_crossOverHelperList.clear(s),o>0)return this.m_nonSimpleResult=new gs(7,r,n),!1;for(let a=0,l=e.length;a<l;a++)this.recycleEdge(this.m_edges[a]);return this.m_edges.length=0,!0}processBunchForRingOrientationTest(e){for(let s=0,i=e.length;s<i;s++){const r=e[s];let n=this.m_xyToNode1.read(r);if(n!==Xe.st_nullNode()){const o=this.m_AET.getElement(n);this.m_freeEdges.push(o),this.m_AET.deleteNode(n),this.recycleEdge(this.m_edges[o]),this.m_edges[o]=null,this.m_xyToNode1.write(r,Xe.st_nullNode())}if(n=this.m_xyToNode2.read(r),n!==Xe.st_nullNode()){const o=this.m_AET.getElement(n);this.m_freeEdges.push(o),this.m_AET.deleteNode(n),this.recycleEdge(this.m_edges[o]),this.m_edges[o]=null,this.m_xyToNode2.write(r,Xe.st_nullNode())}}for(let s=0,i=e.length;s<i;s++){const r=e[s];this.m_recycledSegIter.resetToVertex(r,-1);const n=this.m_recycledSegIter.previousSegment();if(n.getStartY()>n.getEndY()){const a=this.m_recycledSegIter.getStartPointIndex(),l=this.createEdge(n,r,this.m_recycledSegIter.getPathIndex(),!0);let u;this.m_freeEdges.length>0?(u=this.m_freeEdges.at(-1),this.m_freeEdges.pop(),this.m_edges[u]=l):(u=this.m_edges.length,this.m_edges.push(l));const c=this.m_AET.addElement(u);this.m_xyToNode1.read(a)===Xe.st_nullNode()?this.m_xyToNode1.write(a,c):this.m_xyToNode2.write(a,c),3&this.m_pathOrientations.read(this.m_recycledSegIter.getPathIndex())||this.m_newEdges.push(c)}this.m_recycledSegIter.nextSegment();const o=this.m_recycledSegIter.nextSegment();if(o.getStartY()<o.getEndY()){const a=this.m_recycledSegIter.getEndPointIndex(),l=this.createEdge(o,r,this.m_recycledSegIter.getPathIndex(),!1);let u;this.m_freeEdges.length>0?(u=this.m_freeEdges.at(-1),this.m_freeEdges.pop(),this.m_edges[u]=l):(u=this.m_edges.length,this.m_edges.push(l));const c=this.m_AET.addElement(u);this.m_xyToNode1.read(a)===Xe.st_nullNode()?this.m_xyToNode1.write(a,c):this.m_xyToNode2.write(a,c),3&this.m_pathOrientations.read(this.m_recycledSegIter.getPathIndex())||this.m_newEdges.push(c)}}for(let s=0,i=this.m_newEdges.length;s<i&&this.m_unknownOrientationPathCount>0;s++){const r=this.m_newEdges[s],n=this.m_AET.getElement(r),o=this.m_edges[n].m_pathIndex;if(!(3&this.m_pathOrientations.read(o))){let a=-1,l=this.m_AET.getPrev(r),u=r,c=0;{let h=-1,m=null,f=-1,g=0;for(;l!==Xe.st_nullNode()&&(h=this.m_AET.getElement(l),m=this.m_edges[h],f=m.m_pathIndex,g=this.m_pathOrientations.read(f),!(3&g));)u=l,l=this.m_AET.getPrev(l);l===Xe.st_nullNode()?(c=1,l=u):(a=(3&g)==1?f:this.m_pathParentage.read(f),c=m.getRightSide()?0:1,l=this.m_AET.getNext(l))}do{const h=this.m_AET.getElement(l),m=this.m_edges[h],f=m.m_pathIndex;let g=this.m_pathOrientations.read(f);if(!(3&g)){if(c!==m.getRightSide())return this.m_nonSimpleResult=new gs(8,f,-1),!1;const v=c&&!m.getReversed()?1:2;if(g=-4&g|v,this.m_pathOrientations.write(f,g),v===2&&this.m_nonSimpleResult.m_reason===0){const b=this.m_pathParentage.read(f);if(b!==a&&(this.m_nonSimpleResult=new gs(9,f,b),this.m_bOGCRestrictions))return!1}if(this.m_unknownOrientationPathCount--,!this.m_unknownOrientationPathCount)return!0}a=(3&g)==1?f:this.m_pathParentage.read(f),u=l,l=this.m_AET.getNext(l),c=c?0:1}while(u!==r)}}return this.m_newEdges.length=0,!0}createEdge(e,s,i,r){let n;return e.getGeometryType()===G.enumLine?n=this.createEdgeLine(e):(n=new mne,n.m_segment=e.clone()),n.m_vertexIndex=s,n.m_pathIndex=i,n.m_flags=0,n.setReversed(r),n}createEdgeLine(e){let s;return this.m_lineEdgesRecycle.length>0?(s=this.m_lineEdgesRecycle.at(-1),this.m_lineEdgesRecycle.pop(),e.copyTo(s.m_segment)):(s=new mne,s.m_segment=e.clone()),s}recycleEdge(e){e.m_segment.getGeometryType()===G.enumLine&&this.m_lineEdgesRecycle.push(e)}static isShortSegment(e,s,i,r){let n=e.calculateLowerLength2D();if(n<=i){let o=!0;if(e.isCurve()&&(n=e.calculateLength2D(),o=n<=i),o){if(s){let a=e.getEndAttributeAsDbl(1,0);Number.isNaN(a)&&(a=0);let l=e.getStartAttributeAsDbl(1,0);return Number.isNaN(l)&&(l=0),Math.abs(l-a)<=r}return!0}return!1}return!1}static isShortSegmentPoints(e,s,i,r,n){if(i){const o=e.getXYZ(),a=s.getXYZ();return nKe(o,a,r,n)}{const o=e.getXY(),a=s.getXY();return M.sqrDistance(o,a)<=r*r}}removeDegenerateSegmentsFromCurvedPath(e,s,i,r){const n=e.hasAttribute(1),o=e.querySegmentIterator();o.resetToPath(s),F(o.nextPath());const a=this.m_toleranceSimplify.total();let l=!1,u=!0;const c=new nt,h=new nt,m=new M;for(;o.hasNextSegment();){this.progress_();const v=o.nextSegment();if(Du.isShortSegment(v,n,a,i))if(l){if(v.queryEnd(h),Du.isShortSegmentPoints(c,h,n,a,i))continue;u&&(r.startPathPoint(c),u=!1),v.queryEnd(c),r.lineToPoint(c),l=!1}else m.assign(v.getStartXY()),v.queryStart(c),l=!0;else if(l)if(v.isCurve()){const b=v.clone();if(b.setCoordsForIntersector(m,v.getEndXY(),!1),b.setStart(c),Du.isShortSegment(b,n,a,i))continue;r.addSegment(b,u),u=!1,l=!1}else{if(v.queryEnd(h),Du.isShortSegmentPoints(c,h,n,a,i))continue;u&&(r.startPathPoint(c),u=!1),r.lineToPoint(h),l=!1}else r.addSegment(v,u),u=!1}if(u||!l)return;e.isClosedPath(s)?e.getPointByVal(e.getPathStart(s),c):e.getPointByVal(e.getPathEnd(s)-1,c);const f=r.querySegmentIterator();f.resetToLastPath(),f.resetToLastSegment();const g=r.getDescription().getAttributeCount()>1;for(F(f.previousPath());f.hasPreviousSegment();){const v=f.previousSegment();if(v.isCurve()){const b=v.clone();if(b.setCoordsForIntersector(v.getStartXY(),c.getXY(),!1),!Du.isShortSegment(b,n,a,i)){g&&b.setEnd(c);const w=f.getEndPointIndex();for(let S=r.getPointCount()-1;S>=w;S--)r.removePoint(S);return void r.addSegment(b,!1)}}else if(v.queryStart(h),!Du.isShortSegmentPoints(h,c,n,a,i)){const b=f.getEndPointIndex();for(let w=r.getPointCount()-1;w>=b;w--)r.removePoint(w);return void r.lineToPoint(c)}}r.removePath(r.getPathCount()-1)}multipointIsSimpleAsFeature(){if(!this.checkStructure())return 0;const e=this.m_geometry.getImpl();this.m_multiVertexGeom=e;const s=e.getPointCount(),i=Me(s,0);for(let r=0;r<s;r++)i[r]=r;i.sort((r,n)=>this.compareVerticesMultiPoint(r,n));for(let r=1;r<s;r++)if(this.compareVerticesMultiPoint(i[r-1],i[r])===0)return this.m_nonSimpleResult=new gs(5,i[r-1],i[r]),0;return 1}polylineIsSimpleAsFeature(){return this.checkStructure()&&this.checkDegenerateSegments(!0)?1:0}polygonIsSimpleAsFeature(){return this.isSimplePlanarImpl()}multipointSimplifyAsFeature(){let e=this.m_geometry.getImpl();const s=Du.hasNanZs(e);let i,r=this.m_geometry;s&&(i=this.m_geometry.clone(),e=i.getImpl(),i.replaceNaNs(1,Es.getDefaultValue(1)),r=i),this.m_multiVertexGeom=e;const n=e.getPointCount(),o=Me(n,0);for(let m=0;m<n;m++)o[m]=m;o.sort((m,f)=>this.compareVerticesMultiPoint(m,f));const a=new Array(n);a.fill(!1);let l=-1;for(let m=0;m<n;m++){const f=o[m];e.getXY(f).isFinite()&&((l<0||this.compareVerticesMultiPoint(l,f)!==0)&&(a[f]=!0),l=f)}const u=this.m_geometry.createInstance();let c=0,h=0;for(let m=0;m<n;m++)a[m]?h=m+1:(c<h&&u.addPoints(r,c,h),c=m+1);return c<h&&u.addPoints(r,c,h),u.getImpl().setIsSimple(1,this.m_toleranceSimplify.total()),u}polylineSimplifyAsFeature(){const e=this.m_geometry.getImpl(),s=e.querySegmentIterator(),i=e.querySegmentIterator(),r=this.m_geometry.createInstance(),n=this.m_geometry,o=e.hasAttribute(1),a=o?vie(this.m_sr,e,!0).total():0,l=[],u=[];let c=null;o&&(c=e.getAttributeStreamRef(1));const h=new nt,m=e.hasNonLinearSegments(),f=this.m_toleranceSimplify.total();for(;s.nextPath();){if(i.nextPath(),e.getPathSize(s.getPathIndex())<2)continue;if(m&&e.hasNonLinearSegmentsPath(s.getPathIndex())){this.removeDegenerateSegmentsFromCurvedPath(e,s.getPathIndex(),a,r);continue}i.resetToLastSegment();let g=0,v=0,b=!0,w=!0;for(;s.hasNextSegment();){this.progress_();const S=s.nextSegment(),T=i.previousSegment();if(s.getStartPointIndex()>i.getStartPointIndex())break;if(b){const P=s.getStartPointIndex();e.getXY(P).isNAN()||(b=!1,l.push(P))}if(w){const P=i.getEndPointIndex();e.getXY(P).isNAN()||(u.push(P),w=!1)}if(!b){const P=l.at(-1),I=s.getEndPointIndex();if(I-P>1){const A=new M;A.setSub(e.getXY(P),e.getXY(I)),g=A.length()}else g=S.calculateLength2D();if(g>f)l.push(I),g=0;else if(o){let A=c.read(P);Number.isNaN(A)&&(A=0);let D=c.read(I);Number.isNaN(D)&&(D=0),Math.abs(D-A)>a&&(l.push(I),g=0)}}if(!w){const P=u.at(-1),I=i.getStartPointIndex();if(I-P>1){const A=new M;A.setSub(e.getXY(P),e.getXY(I)),v=A.length()}else v=T.calculateLength2D();if(v>f)u.push(I),v=0;else if(o){let A=c.read(P);Number.isNaN(A)&&(A=0);let D=c.read(I);Number.isNaN(D)&&(D=0),Math.abs(D-A)>a&&(u.push(I),v=0)}}}if(l.length>0&&u.length>0&&(l.at(-1)<u.at(-1)?l.length>u.length?l.pop():u.pop():(l.at(-1)===u.at(-1)||u.pop(),u.pop())),u.length+l.length>=2){let S=!1;for(let T=0,P=l.length;T<P;T++)n.getPointByVal(l[T],h),S?r.lineToPoint(h):(r.startPathPoint(h),S=!0);for(let T=u.length-1;T>0;T--)n.getPointByVal(u[T],h),S?r.lineToPoint(h):(r.startPathPoint(h),S=!0);n.isClosedPath(s.getPathIndex())?r.closePathWithLine():u.length>0&&(n.getPointByVal(u[0],h),r.lineToPoint(h))}l.length=0,u.length=0}return o&&r.replaceNaNs(1,0),r.getImpl().setIsSimple(1,f),r}polygonSimplifyAsFeature(){return this.simplifyPlanar()}simplifyPlanar(){if(this.m_geometry.getFillRule()===1&&!tm(this.m_knownSimpleResult))return hD(this.m_geometry,this.m_toleranceSimplify,!0,!1,this.m_knownSimpleResult,this.m_progressTracker,0,!0);const e=new oi;if(e.addGeometry(this.m_geometry),this.m_geometry.hasAttribute(1)&&e.replaceNaNs(1,0),e.removeNaNVertices(),e.getTotalPointCount()!==0){let i=null,r=0,n=0;if(e.hasCurves()){i=new Ha;const o=X.constructEmpty();this.m_geometry.queryEnvelope(o);const a=ja(this.m_toleranceSimplify.total(),o);r=Oc(this.m_toleranceSimplify.total()),n=Vc(a,r),Ol(e,a,this.m_toleranceSimplify.total(),12e3,i,null,this.m_progressTracker)}tm(this.m_knownSimpleResult)||Ac(e,this.m_toleranceSimplify.add(n),this.m_progressTracker,!0,!1),this.m_geometry.getGeometryType()===G.enumPolygon&&_d(e,e.getFirstGeometry(),this.m_knownSimpleResult,!1,-1,this.m_progressTracker),i!==null&&i.stitchCurves(e,e.getFirstGeometry(),r,!0)}const s=e.getGeometry(e.getFirstGeometry());return s.getGeometryType()===G.enumPolygon&&(s.getImpl().updateOGCFlagsProtected(),s.setFillRule(0)),s.getImpl().setIsSimple(4,this.m_toleranceSimplify.total()),s}progress_(){}static hasNanZs(e){if(e.hasAttribute(1)){const s=e.getAttributeStreamRef(1);for(let i=0,r=e.getPointCount();i<r;i++){const n=s.read(i);if(Number.isNaN(n))return!0}}return!1}compareVerticesForPlanarClustering(e,s,i){if(e===s)return 0;const r=this.m_pairs[e],n=this.m_pairs[s],o=r>>1,a=n>>1,l=this.m_xy.readPoint2D(2*o);l.y+=1&r?this.m_toleranceIsSimpleClustering:-this.m_toleranceIsSimpleClustering;const u=this.m_xy.readPoint2D(2*a);u.y+=1&n?this.m_toleranceIsSimpleClustering:-this.m_toleranceIsSimpleClustering;const c=l.compare(u);if(c===0&&i){const h=this.m_pathsForOGCTests[o]-this.m_pathsForOGCTests[a];return di(h)}return c}compareVerticesMultiPoint(e,s){if(e===s)return 0;const i=this.m_multiVertexGeom.getXY(e),r=this.m_multiVertexGeom.getXY(s),n=!i.isFinite(),o=!r.isFinite();if(n||o)return n<o?-1:n>o?1:0;if(i.y<r.y)return-1;if(i.y>r.y)return 1;if(i.x<r.x)return-1;if(i.x>r.x)return 1;for(let a=1;a<this.m_attributeCount;a++){const l=this.m_description.getSemantics(a),u=Es.getComponentCount(l);for(let c=0;c<u;c++){const h=this.m_multiVertexGeom.getAttributeAsDbl(l,e,c),m=this.m_multiVertexGeom.getAttributeAsDbl(l,s,c),f=PJe(h,m);if(f!==0)return f}}return 0}edgeAngleCompare(e,s){if(e===s)return 0;const i=e.m_segment.getTangent(e.getReversed()?1:0);e.getReversed()&&i.negateThis();const r=s.m_segment.getTangent(s.getReversed()?1:0);s.getReversed()&&r.negateThis();const n=i.getQuarter(),o=r.getQuarter();if(o===n){const a=i.crossProduct(r);return a<0?1:a>0?-1:0}return n<o?-1:1}}class Xh{getOperatorType(){return 10103}accelerateGeometry(e,s,i){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}isSimpleAsFeature(e,s,i,r,n){const o=tB(e,s,i,r,n);return oKe(e.getGeometryType(),o)}isSimplePlanarDONOTUSE(e,s,i,r,n){const o=Snt(e,s,i,r,n);return Hf(o)}executeMany(e,s,i,r){return new $nt(e,s,i,r)}execute(e,s,i,r){const n=new kd([e]),o=this.executeMany(n,s,i,r).next();return o||Ce("null geometry"),o}}class $nt extends nm{constructor(e,s,i,r){super(),this.m_progressTracker=r,this.m_bForceSimplify=i,this.m_index=-1,this.m_inputGeometryCursor=e,this.m_spatialReference=s}next(){const e=this.m_inputGeometryCursor.next();return e?(this.m_index=this.m_inputGeometryCursor.getGeometryID(),this.simplify(e)):null}getGeometryID(){return this.m_index}tock(){return!1}getRank(){return 1}simplify(e){if(e||ee(""),e.getGeometryType()===G.enumGeometryCollection){const s=EKe(e,-1),i=new Xh().executeMany(s,this.m_spatialReference,this.m_bForceSimplify,this.m_progressTracker),r=e.createInstance();for(let n=i.next();n!=null;n=i.next())r.addGeometry(n);return r}return qve(e,this.m_spatialReference,this.m_bForceSimplify,this.m_progressTracker)}}function Rnt(t,e,s){const i=new X;t.queryEnvelope(i);const r=new X;e.queryEnvelope(r);const n=new X(r);if(n.inflate(2*s),!n.isIntersecting(i))return 4;const o=t.getGeometryType(),a=e.getGeometryType();if(o===G.enumEnvelope&&i.containsEnvelope(n))return 1;if(a===G.enumEnvelope){const l=new X(i);if(l.inflate(2*s),r.containsEnvelope(l))return 2}return 0}class A_{constructor(e,s,i,r){this.m_intersectorGeom=null,this.m_sr=null,this.m_dimensionMask=-1,this.m_progressTracker=null,this.m_intersectorGeomType=G.enumUnknown,this.m_geomIntersectorEmptyGeom=null,this.m_intersectorGeom=e,this.m_sr=s,this.m_dimensionMask=i,this.m_progressTracker=r,this.m_intersectorGeomType=e.getGeometryType()}intersect(e){const s=this.tryFastImplementation(e);if(s!==null)return s;const i=sM(this.m_intersectorGeom,e),r=Ji(this.m_sr,i,!0).total(),n=X.constructEmpty();this.m_intersectorGeom.queryEnvelope(n);const o=X.constructEmpty();e.queryEnvelope(o),n.inflateCoords(2*r,2*r),n.intersect(o),n.inflateCoords(100*r,100*r);const a=0;let l=ps(this.m_intersectorGeom,n,a,0,this.m_progressTracker),u=ps(e,n,a,0,this.m_progressTracker);return e.getDimension()>this.m_intersectorGeom.getDimension()&&(l=be(u,u=l)),gnt(u,l,this.m_sr,this.m_progressTracker)}intersectEx(e){const s=this.tryFastImplementation(e);if(s!==null){const h=[];return h.length=3,h[s.getDimension()]=s,this.prepareVector(e.getDescription(),this.m_dimensionMask,h)}const i=sM(this.m_intersectorGeom,e),r=Ji(this.m_sr,i,!0).total(),n=X.constructEmpty();this.m_intersectorGeom.queryEnvelope(n);const o=X.constructEmpty();e.queryEnvelope(o),n.inflateCoords(2*r,2*r),n.intersect(o),n.inflateCoords(100*r,100*r);const a=0;let l=ps(this.m_intersectorGeom,n,a,0,this.m_progressTracker),u=ps(e,n,a,0,this.m_progressTracker);e.getDimension()>this.m_intersectorGeom.getDimension()&&(l=be(u,u=l));const c=ynt(u,l,this.m_sr,this.m_progressTracker);return this.prepareVector(e.getDescription(),this.m_dimensionMask,c)}init(e,s,i,r=null){F(0)}static intersectPoints(e,s,i){const r=sM(e,s);return fnt(e,s,Ji(i,r,!0))}tryFastImplementation(e){const s=e.getGeometryType();if(this.m_intersectorGeomType===G.enumPoint&&s===G.enumPoint){const l=A_.intersectPoints(e,this.m_intersectorGeom,this.m_sr);if(this.m_dimensionMask!==-1){const u=new pi({vd:l.getDescription()});return l.isEmpty()||u.add(l),u}return l}if(s===G.enumEnvelope&&this.m_intersectorGeomType===G.enumEnvelope&&(this.m_dimensionMask===-1||this.m_dimensionMask===4)){const l=e,u=this.m_intersectorGeom,c=new Sn({copy:l});return c.intersect(u),c}const i=sM(e,this.m_intersectorGeom),r=Ji(this.m_sr,i,!0),n=e.isEmpty(),o=this.m_intersectorGeom.isEmpty();let a=n||o;if(!a){const l=Rnt(this.m_intersectorGeom,e,r.total());if(l===4)a=!0;else{if(2&l)return this.m_intersectorGeom;if(1&l)return e}}if(a){const l=ca(s),u=ca(this.m_intersectorGeomType);return l<u?A_.ReturnEmpty(e,n):l>u||l===0&&s===G.enumMultiPoint&&this.m_intersectorGeomType===G.enumPoint?this.ReturnEmptyIntersector():A_.ReturnEmpty(e,n)}if(s===G.enumEnvelope&&ca(this.m_intersectorGeomType)===0||this.m_intersectorGeomType===G.enumEnvelope&&ca(s)===0){const l=s===G.enumEnvelope?e:this.m_intersectorGeom,u=s===G.enumEnvelope?this.m_intersectorGeom:e,c=X.constructEmpty();return l.queryEnvelope(c),ps(u,c,r.total(),0,this.m_progressTracker)}if(ca(s)===0&&ca(this.m_intersectorGeomType)>0||ca(s)>0&&ca(this.m_intersectorGeomType)===0){if(s===G.enumMultiPoint)return cne(e,this.m_intersectorGeom,r);if(s===G.enumPoint)return hne(e,this.m_intersectorGeom,r);if(this.m_intersectorGeomType===G.enumMultiPoint)return cne(this.m_intersectorGeom,e,r);if(this.m_intersectorGeomType===G.enumPoint)return hne(this.m_intersectorGeom,e,r);Ce("")}return null}ReturnEmptyIntersector(){return this.m_geomIntersectorEmptyGeom===null&&(this.m_geomIntersectorEmptyGeom=this.m_intersectorGeom.createInstance()),this.m_geomIntersectorEmptyGeom}static ReturnEmpty(e,s){return s?e:e.createInstance()}prepareVector(e,s,i){let r=0;return 1&s?(i[0]||(i[0]=new pi({vd:e})),r++):i.shift(),2&s?(i[r]||(i[r]=new qt({vd:e})),r++):i.splice(r,1),4&s?i[r]||(i[r]=new wt({vd:e})):i.splice(r,1),new kd(i)}}class knt extends nm{constructor(e,s,i,r,n){super(),this.m_smallCursor=null,this.m_progressTracker=r,this.m_geomIntersector=s.next(),this.m_intersector=new A_(this.m_geomIntersector,i,n,r),this.m_index=-1,this.m_inputGeoms=e,this.m_dimensionMask=n,this.m_dimensionMask!==-1&&(this.m_dimensionMask<=0||this.m_dimensionMask>7)&&ee("bad dimension mask")}next(){if(!this.m_geomIntersector)return null;let e;if(this.m_smallCursor!==null){if(e=this.m_smallCursor.next(),e)return e;this.m_smallCursor=null}for(;e=this.m_inputGeoms.next();)return Nd(e),this.m_index=this.m_inputGeoms.getGeometryID(),this.m_dimensionMask===-1?this.m_intersector.intersect(e):(this.m_smallCursor=this.m_intersector.intersectEx(e),this.m_smallCursor.next());return null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}}class u0{getOperatorType(){return 1e4}accelerateGeometry(e,s,i){if(!this.canAccelerateGeometry(e))return!1;ba(s,e,!0);let r=0;return e.getGeometryType()!==G.enumPolygon&&e.getGeometryType()!==G.enumPolyline||!Z3(e)||i===0||(r|=e.getImpl().buildQuadTreeAccelerator(i)?1:0),!!r}canAccelerateGeometry(e){return Z3(e)}supportsCurves(){return!0}executeMany(e,s,i,r,n=-1){return new knt(e,s,i,r,n)}execute(e,s,i,r){if(e.getGeometryType()===G.enumPoint&&s.getGeometryType()===G.enumPoint)return A_.intersectPoints(e,s,i);const n=new kd([e]),o=new kd([s]),a=this.executeMany(n,o,i,r,-1).next();return a||Ce("null output"),a}}function zve(t,e,s){return e.m_projector.project(t,s)}function Fnt(t,e,s,i,r){t.m_projector.transformInPlaceZ(e,null,s,i,null,r);const n=i.slice(0,s).filter(o=>!o.isNAN());for(let o=0,a=n.length;o<a;++o)i[o].assign(n[o]);return n.length}function sB(t,e,s,i,r){return t.m_projector.transformInPlaceZ(e,null,s,i,null,r)}function DG(t,e,s,i){if(t&&e&&e.isPannable()||ee("fold_into_360_range_geodetic"),t.isEmpty())return t;if(s===4)return mD(t,e,i);let r=t;const n=r.getGeometryType();if(xt(n)){r=Ix(t,e);const o=new X;r.queryEnvelope(o);const a=Ji(e,o,!1).total(),l=e.getPannableExtent();let u=Math.floor((o.xmin-l.xmin)/l.width())*l.width()+l.xmin,c=r;for(;u<o.xmax;)u>o.xmin+a&&u<o.xmax-a&&(c=tbe(c,e,s,!0,u)),u+=l.width();r=c}else{if(n===G.enumEnvelope){const o=new wt({vd:r.getDescription()});return o.addEnvelope(r,!1),DG(o,e,s,i)}if(zi(n)){const o=new qt({vd:r.getDescription()});return o.addSegment(r,!0),DG(o,e,s,i)}}return mD(r,e,i)}function mD(t,e,s){if(t&&e&&e.isPannable()||ee(""),t.isEmpty())return t;let i;const r=t.getGeometryType();if(r===G.enumEnvelope){const o=new wt({vd:t.getDescription()});o.addEnvelope(t,!1),i=o}else if(zi(r)){const o=new qt({vd:t.getDescription()});o.addSegment(t,!0),i=o}else i=t;const n=Ix(i,e);return n.isEmpty()?n:Yb(n,e,0,n!==t,0,s)}function Ont(t,e,s){if(!e.isPannable()||t.isEmpty())return t;const i=e.getPannableExtent().width(),r=.5*i,n=t.queryInterval(0,0);if(n.width()<r||!zo(t.getGeometryType())){if(Number.isNaN(s))return t;const w=n.getCenter();if(Math.abs(w-s)<=r)return t;{const S=new Rt,T=J_((s-w)/i)*i;S.setShiftCoords(T,0);const P=t.clone();return P.applyTransformation(S),P}}const o=t.getGeometryType(),a=t,l=a.getAttributeStreamRef(0),u=t.clone(),c=u.getAttributeStreamRef(0);let h=0,m=0,f=0,g=xt(o)?0:-1;const v=de.constructEmpty();let b=!1;for(let w=0,S=a.getPointCount();w<S;w++){const T=l.read(2*w);w===m&&(xt(o)?(g===0&&Number.isNaN(s)&&(b=!0),g>0&&Number.isNaN(s)&&(s=v.getCenter(),b=!1),m=a.getPathEnd(g),g++):m=a.getPointCount(),Number.isNaN(s)?f=T:(f=s,h=0));let P=T-f;Math.abs(P)>r&&(P=J_(P/i)*i,h-=P,Math.abs(h)<.1*i&&(h=0));const I=T+h;c.write(2*w,I),b&&v.mergeCoordinate(I),f=T}return u.notifyModified(),u}const Lnt="missing implementation";function Vnt(t,e,s,i){const r=e.getCoordinateSystemType();if(r===0){const a=new Vn;return e.queryPrecisionDescriptor(a),dne(t,a,e,s)}let n=t;i!==2&&i!==3||!e.isPannable()||(n=mD(n,e,s));const o=new Vn;if(e.queryPrecisionDescriptor(o),n=dne(n,o,e,s),i===0||n.isEmpty())return n;if(r===1){if(i===1){const a=new X;n.queryLooseEnvelope(a);const l=e.getPannableExtent(),u=.01*l.width();return l.xmin=a.xmin-u,l.xmax=a.xmax+u,new jb().execute(n,l,e,s)}return n}if(r===2){const a=e.getPCSHorizon();if(i===1||i===2){const l=new u0().execute(n,a,e,s);return l===a?l.clone():l}return n}if(r===3)return n;Ce(Lnt)}function dne(t,e,s,i){const r=e.getXYGridRange(),n=t.hasAttribute(1),o=t.hasAttribute(2);let a=new de,l=new de;n&&(a=e.getZGridRange()),o&&(l=e.getMGridRange());let u=new jb().execute(t,r,s,i);if(n){const c=u.queryInterval(1,0);a.contains(c)||(t===u&&(u=u.clone()),G8(u,a,1,0))}if(o){const c=u.queryInterval(2,0);l.contains(c)||(t===u&&(u=u.clone()),G8(u,l,2,0))}return u}class qnt{constructor(e){this.m_inputPCSHorizonClipOption=0,this.m_outputPCSHorizonClipOption=0,this.m_bDontGeonormalizePolygon=!1,this.m_bClipOutCurvedPoles=!1,this.m_bNormalizeOutputGeometry=!1,this.m_bDontHackPolesInGeogToGeog=!1,this.m_centralMeridianOfOutputGCS=0,this.m_densificationStepInput=0,e||ee(""),this.m_projTransform=e,this.m_bClipOutCurvedPoles=!1;const s=this.m_projTransform.getExtendedParamsImpl();this.m_bNormalizeOutputGeometry=s.normalizeResultGeometry,this.m_bNormalizeOutputGeometry&&(s.legacyHorizonClipping?this.m_bNormalizeOutputGeometry=!1:this.m_projTransform.getOutputSR().isPannable()||(this.m_bNormalizeOutputGeometry=!1)),s.clipWithInputHorizon?(this.m_inputPCSHorizonClipOption=0,!s.legacyHorizonClipping&&this.m_projTransform.getInputSR().isPannable()&&(this.m_inputPCSHorizonClipOption=this.m_bNormalizeOutputGeometry?4:2)):this.m_inputPCSHorizonClipOption=1,s.clipWithOutputHorizon?(this.m_outputPCSHorizonClipOption=0,!s.legacyHorizonClipping&&this.m_projTransform.getOutputSR().isPannable()&&(this.m_outputPCSHorizonClipOption=this.m_bNormalizeOutputGeometry?4:2)):this.m_outputPCSHorizonClipOption=1,this.m_centralMeridianOfOutputGCS=s.centralMeridianOfOutputGCS,this.m_densificationStepInput=s.densificationStep;const i=this.m_projTransform.getExtendedParamsInternal();this.m_bDontGeonormalizePolygon=i.hasFlag(2147483648),this.m_bDontHackPolesInGeogToGeog=i.hasFlag(1073741824),this.m_bClipOutCurvedPoles=i.hasFlag(536870912)}project(e,s){if(this.m_projTransform.isIdentity()||e.isEmpty())return e;const i=e.getGeometryType();if(i===G.enumPoint)return this.projectPoint(e,s);const r=this.m_projTransform.getInputSR().getCoordinateSystemType(),n=this.m_projTransform.getOutputSR().getCoordinateSystemType(),o=this.m_projTransform.getInputSR(),a=this.m_projTransform.getOutputSR();if(r===0&&r===n){const l=pne(o,a),u=e.clone();return u.applyTransformation(l),u}switch(i){case G.enumPolyline:case G.enumPolygon:return this.projectMultiPath(e,s);case G.enumMultiPoint:return this.projectMultiPoint(e,s);case G.enumEnvelope:return this.projectEnvelope(e,s);case G.enumGeometryCollection:return this.projectGeometryCollection(e,s);default:Ce("")}}projectPoint(e,s){const i=[e.getXY()];let r,n=null;(r=e.hasAttribute(1))&&(n=[e.getZ()]),this.transformInPlaceZ(i,n,1,i,n,null);const o=e.clone();return o.setXY(i[0]),r&&o.setZ(n[0]),o}projectMultiPoint(e,s){let i=new pi({copy:e});const r=this.m_projTransform.getInputSR(),n=this.m_projTransform.getOutputSR(),o=r.getCoordinateSystemType(),a=n.getCoordinateSystemType();if(o===3&&F(0),i=mN(i,r,this.m_inputPCSHorizonClipOption,s),i.isEmpty())return i;o===2&&rbe(r,0,i),obe(this.m_projTransform,i,!1);let l=0;a===3&&F(0);const u=a===2;return u?l=n.getCentralMeridian():Number.isNaN(this.m_centralMeridianOfOutputGCS)||(l=this.m_centralMeridianOfOutputGCS),u&&this.m_outputPCSHorizonClipOption!==0||(i=Yb(i,pN(n),l,!1,0,s)),u&&(i=SL(i,n,this.m_outputPCSHorizonClipOption,s),ibe(n,i,this.m_bNormalizeOutputGeometry),i.isEmpty()),i}projectMultiPath(e,s){const i=e.getGeometryType();return i===G.enumPolygon?this.projectPolygon(e,s):i===G.enumPolyline?this.projectPolyline(e,s):void Ce("project_multi_path_")}projectEnvelope(e,s){this.m_projTransform.getInputSR(),this.m_projTransform.getOutputSR();const i=this.m_projTransform.isVertical()&&e.hasAttribute(1);let r=de.constructEmpty();if(i&&(r=e.queryInterval(1,0)),r.width()>0){const n=e.clone();n.setInterval(1,0,r.vmin,r.vmin);const o=this.projectEnvelopeHelper(n,s);n.setInterval(1,0,r.vmax,r.vmax);const a=this.projectEnvelopeHelper(n,s);return o.merge(a),o}return this.projectEnvelopeHelper(e,s)}projectPolygon(e,s){F(e.getGeometryType()===G.enumPolygon),F(!this.m_projTransform.isIdentity()),F(!e.isEmpty());const i=this.m_projTransform.getInputSR(),r=this.m_projTransform.getOutputSR(),n=i.getCoordinateSystemType(),o=r.getCoordinateSystemType(),a=new wt({copy:e});n===3&&F(0),o===3&&F(0);const l=n===2,u=o===2,c=l?i.getGCS():i,h=u?r.getGCS():r,m=!u&&!this.m_bDontHackPolesInGeogToGeog;let f=!1,g=mN(a,i,this.m_inputPCSHorizonClipOption,s);if(g.isEmpty())return g;let v=this.m_densificationStepInput;const b=!Number.isNaN(v);let w;b&&(g=new i_().execute(g,v,0,0,s));let S=u?r.getPCSInfo():null,T=Number.NaN;l&&(T=i.getCentralMeridian());const P=r.getGCSSplitLines()!==null;if(this.m_bDontGeonormalizePolygon){const I=g;if(l&&(vM(i,T,I),b)){const A=i.getUnitsPerMillimeter();v*=i.getGCS().getUnitsPerMillimeter()/A}if(bM(this.m_projTransform,I,m),b){const A=i.getGCS().getUnitsPerMillimeter();v*=r.getGCS().getUnitsPerMillimeter()/A}w=I}else{let I=new qt({vd:g.getDescription()});if(I.addAndExplicitlyOpenAllPaths(g,!1),l){if(vM(i,T,I),b){const R=i.getUnitsPerMillimeter();v*=i.getGCS().getUnitsPerMillimeter()/R}if(this.m_bClipOutCurvedPoles){const R=i.getPCSInfo(),O=R.getSouthPoleGeometry()===Kr.PE_POLE_LINE_CURVED,z=R.getNorthPoleGeometry()===Kr.PE_POLE_LINE_CURVED;if(O||z){const q=X.constructEmpty();I.queryLooseEnvelope(q),q.inflateCoords(1,1);const U=89.9999*c.getOneDegreeGCSUnit();O&&(q.ymin=-U),z&&(q.ymax=U),I=hst(I,q,c,0,0,s)}}}if(bM(this.m_projTransform,I,m),b){const R=pN(i).getUnitsPerMillimeter();v*=pN(r).getUnitsPerMillimeter()/R}let A=Number.NaN;u?(S=r.getPCSInfo(),A=r.getCentralMeridian()):Number.isNaN(this.m_centralMeridianOfOutputGCS)||(A=this.m_centralMeridianOfOutputGCS);let D=_M(i)|_M(r),k=10*h.getTolerance(0);this.m_bDontHackPolesInGeogToGeog&&(D=3,k=10*h.getTolerance(0)),w=Got(g,i,I,h,A,s,D,k,this.m_bNormalizeOutputGeometry),D=0}if(P&&(F(!r.isPannable()),w=OG(w,r,s)),u){if(!f){const I=h.getPannableExtent().width();if(w.queryInterval(0,0).width()>=I-10*h.getTolerance(0)){const A=S.getNorthPoleLocation(),D=S.getSouthPoleLocation(),k=S.getNorthPoleGeometry(),R=S.getSouthPoleGeometry();let O=0;k===Kr.PE_POLE_POINT&&A!==Kr.PE_POLE_OUTSIDE_BOUNDARY&&(O=1),R===Kr.PE_POLE_POINT&&D!==Kr.PE_POLE_OUTSIDE_BOUNDARY&&(O|=2),f||(f=O!==0)}}w=SL(w,r,this.m_outputPCSHorizonClipOption,s),b&&(w=new i_().execute(w,v,0,0,s)),Cne(r,w,this.m_bNormalizeOutputGeometry)}return w.isEmpty()||f&&(w=new Xh().execute(w,r,!1,s)),w}projectPolyline(e,s){F(e.getGeometryType()===G.enumPolyline),F(!this.m_projTransform.isIdentity()),F(!e.isEmpty());const i=this.m_projTransform.getInputSR(),r=this.m_projTransform.getOutputSR(),n=i.getCoordinateSystemType(),o=r.getCoordinateSystemType(),a=new qt({copy:e});n===3&&F(0),o===3&&F(0);const l=n===2,u=o===2;l&&i.getGCS();const c=u?r.getGCS():r,h=!u&&!this.m_bDontHackPolesInGeogToGeog;let m=mN(a,i,this.m_inputPCSHorizonClipOption,s);if(m.isEmpty())return m;let f=Number.NaN;l&&(f=i.getCentralMeridian());const g=r.getGCSSplitLines()!==null;let v=this.m_densificationStepInput;const b=!Number.isNaN(v);let w;if(b&&(m=new i_().execute(m,v,0,0,s)),this.m_bDontGeonormalizePolygon){if(l&&(vM(i,f,m),b)){const S=i.getUnitsPerMillimeter();v*=i.getGCS().getUnitsPerMillimeter()/S}if(bM(this.m_projTransform,m,h),b){const S=i.getGCS().getUnitsPerMillimeter();v*=r.getGCS().getUnitsPerMillimeter()/S}w=m}else{const S=new qt({vd:m.getDescription()});if(S.addAndExplicitlyOpenAllPaths(m,!1),l&&(vM(i,f,S),b)){const A=i.getUnitsPerMillimeter();v*=i.getGCS().getUnitsPerMillimeter()/A}if(bM(this.m_projTransform,S,h),b){const A=i.getGCS().getUnitsPerMillimeter();v*=r.getGCS().getUnitsPerMillimeter()/A}let T=Number.NaN;u?T=r.getCentralMeridian():Number.isNaN(this.m_centralMeridianOfOutputGCS)||(T=this.m_centralMeridianOfOutputGCS);let P=_M(i)|_M(r),I=10*c.getTolerance(0);this.m_bDontHackPolesInGeogToGeog&&(P=3,I=0),w=zot(m,i,S,c,T,s,P,I,this.m_bNormalizeOutputGeometry),P=0}return g&&(F(!r.isPannable()),w=OG(w,r,s)),u&&(w=SL(w,r,this.m_outputPCSHorizonClipOption,s),b&&(w=new i_().execute(w,v,0,0,s)),Cne(r,w,this.m_bNormalizeOutputGeometry)),w.isEmpty(),w}projectGeometryCollection(e,s){return F(0),{}}projectEnvelopeHelper(e,s){const i=(e.height()+e.width())/400;if(i!==0){const r=new i_().execute(e,i,0,0,s),n=this.projectMultiPath(r,s),o=new Sn({vd:e.getDescription()});if(n.isEmpty()){const a=Math.min(e.height(),e.width()),l=ba(this.m_projTransform.getInputSR(),e,!0).total();if(a>100*l){const g=X.constructEmpty(),v=Ji(this.m_projTransform.getOutputSR(),g,!0).total(),b=this.m_projTransform.getInputSR().getOneMeter()/this.m_projTransform.getOutputSR().getOneMeter();if(a>100*Math.max(l,v*b))return o}const u=new qt;u.addAndExplicitlyOpenAllPaths(r,!1),this.projectMultiPath(u,s).queryEnvelope(o);const c=new pi({vd:e.getDescription()});c.reserve(4);const h=new nt;for(let g=0;g<4;g++)e.queryCornerByVal(g,h),c.add(h);const m=this.projectMultiPoint(c,s),f=new Sn;return m.queryEnvelope(f),o.merge(f),o}return n.queryEnvelope(o),o}{const r=e.getCenterXY(),n=new nt(r),o=this.projectPoint(n,s),a=new Sn({vd:e.getDescription()});if(o.isEmpty())a.setEmpty();else{e.copyTo(a);const l=o.getXY();a.setCoords(l.x,l.y,l.x,l.y)}return a}}transformInPlace(e,s,i,r){return F(0),0}transformInPlaceZ(e,s,i,r,n,o){if(this.m_projTransform.isIdentity())return e!==r&&j3(r,e,i),s!==n&&$s(n,s,0,0,i),i;const a=this.m_projTransform,l=a.getInputSR(),u=a.getOutputSR(),c=l.getCoordinateSystemType(),h=u.getCoordinateSystemType();if(c===0&&c===h)return pne(l,u).transformPoints2D(e,i,r),a.isVertical()&&F(0),i;c===3&&yt("image: transform_in_place_"),h===3&&yt("image: transform_in_place_"),Hot(e,i,r,l,this.m_inputPCSHorizonClipOption),n!==s&&$s(n,s,0,0,i),c===2&&TR(l,0,r,i),c0(this.m_projTransform,r,n,i,!1);let m=0;const f=h===2;if(f?m=u.getCentralMeridian():Number.isNaN(this.m_centralMeridianOfOutputGCS)||(m=this.m_centralMeridianOfOutputGCS),f&&this.m_outputPCSHorizonClipOption!==0||ebe(r,i,u.getGCS(),m),f){if(!VG(r,i,u,this.m_outputPCSHorizonClipOption))for(let v=0;v<i;++v)r[v].setNAN();CR(u,r,i,!1)}let g=i;for(let v=0;v<i;++v)r[v].isNAN()&&(n&&(n[v]=Number.NaN),g--);return g}}function _M(t){if(t.getCoordinateSystemType()!==2)return 0;let e=0;const s=t.getPCSInfo(),i=s.getNorthPoleLocation(),r=s.getSouthPoleLocation(),n=s.getNorthPoleGeometry(),o=s.getSouthPoleGeometry();return n===Kr.PE_POLE_POINT&&i!==Kr.PE_POLE_OUTSIDE_BOUNDARY&&(e=1),o===Kr.PE_POLE_POINT&&r!==Kr.PE_POLE_OUTSIDE_BOUNDARY&&(e|=2),e}function pne(t,e){const s=t.getHorzUnitFactor(),i=e.getHorzUnitFactor();let r=1,n=1;const o=20015077/180;t.getUnit().getUnitType()===1&&(r=o),e.getUnit().getUnitType()===1&&(n=o);const a=s/i*(r!==n?r/n:1),l=new Rt;return l.setScaleCoords(a,a),l}let eh=class{getOperatorType(){return 10300}supportsCurves(){return!0}accelerateGeometry(t,e,s){return!1}canAccelerateGeometry(t){return!1}executeMany(t,e,s){return!e||e.isIdentity()?t:new Gnt(t,e,s)}execute(t,e,s){return e.isIdentity()?t:zve(t,e,s)}transform(t,e,s,i,r=!0){return r?Fnt(t,e,s,i,null):sB(t,e,s,i,null)}transform3D(t,e,s,i,r=!0){return F(0),0}foldInto360Range(t,e){return mD(t,e,null)}foldInto360RangeGeodetic(t,e,s){return DG(t,e,s,null)}normalizeGeometryEx(t,e,s,i,r=0){return cot(t,e,s,i,r)}normalizeGeometry(t,e,s){return Ont(t,e,s)}clipToSpatialReference(t,e,s,i=0){return Vnt(t,e,s,i)}};class Gnt extends nm{constructor(e,s,i){super(),this.m_projTrans=s,this.m_progressTracker=i,this.m_index=-1,e||ee(""),this.m_inputGeoms=e}next(){const e=this.m_inputGeoms.next();return e!=null?(JE(e),Nd(e),this.m_index=this.m_inputGeoms.getGeometryID(),zve(e,this.m_projTrans,this.m_progressTracker)):null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}}function $G(t,e,s,i,r,n,o=!1){t||ee("Geometry.Geodetic_densify.densify");let a=t.getGeometryType();if(Nd(t),t.isEmpty()||Fb(a))return t;const l=new Unt;l.m_sr=e,l.m_gcs=e.getGCS(),l.m_transform=l.m_gcs!==e?e.getSRToGCSTransform():null,l.m_progressTracker=n;const u=P0();let c,h,m;if(l.m_gcs.querySpheroidData(u),l.m_a=u.majorSemiAxis,l.m_eSquared=u.e2,l.m_rpu=l.m_gcs.getUnit().getUnitToBaseFactor(),l.m_gcsTolerance=l.m_gcs.getTolerance(0),l.m_radTolerance=l.m_gcsTolerance*l.m_rpu,l.m_maxLength=i,l.m_maxDeviation=r,l.m_curveType=s,a===G.enumEnvelope){const f=new wt({vd:t.getDescription()});f.addEnvelope(t,!1),c=f,a=G.enumPolygon}else if(zi(a)){const f=new qt({vd:t.getDescription()});f.addSegment(t,!0),c=f,a=G.enumPolyline}else c=t;if(l.m_curveType!==4){if(F(xt(a)),h=l.replaceCurvesWithLinesAndProjectToGCSAsMultiPoint_(c),h.isEmpty())return h;h=Uve(l.m_rpu,h);let f=l.geodeticDensify(h);o||(f=new eh().foldInto360RangeGeodetic(f,l.m_gcs,l.m_curveType)),m=l.m_transform&&!l.m_transform.isIdentity()?new eh().execute(f,l.m_transform.getInverse(),n):f}else{let f;if(F(xt(a)),e.isPannable())f=Ix(c,e);else{const g=e.getPCSHorizon();f=new u0().execute(c,g,e,n),f===g&&(f=g.clone())}if(h=f,h.isEmpty())return h;m=l.shapePreservingDensify(h)}return m}function Uve(t,e){const s=new X;if(e.queryLooseEnvelope(s),s.width()*t<Math.PI)return e;let i=!1;const r=e.querySegmentIterator(),n=new M,o=new M;for(;r.nextPath();)for(;r.hasNextSegment();){const g=r.nextSegment();if(n.setCoordsPoint2D(g.getStartXY()),o.setCoordsPoint2D(g.getEndXY()),n.scale(t),o.scale(t),Math.abs(n.x-o.x)>Math.PI){if(!RG(n,o)){i=!0;break}if(Math.abs(n.x-o.x)>2*Math.PI){i=!0;break}}}if(!i)return e;const a=e.createInstance();a.reserve(e.getPointCount());const l=e.getDescription().getAttributeCount()>1,u=new M,c=new M,h=new M(0,0),m=new M(0,0),f=new nt;for(r.resetToFirstPath();r.nextPath();){let g=Number.NaN,v=0;for(;r.hasNextSegment();){const b=r.nextSegment();if(n.setCoordsPoint2D(b.getStartXY()),o.setCoordsPoint2D(b.getEndXY()),n.scale(t),o.scale(t),Number.isNaN(g)?(v=f_(n.x,Number.NaN,v),h.setCoordsPoint2D(n)):h.setCoordsPoint2D(m),g=h.x,RG(n,o)){if(o.x-n.x>2*Math.PI)for(;o.x-n.x>2*Math.PI;)o.x-=2*Math.PI;else if(o.x-n.x<2*-Math.PI)for(;o.x-n.x<2*-Math.PI;)o.x+=2*Math.PI;v=f_(o.x,Number.NaN,v),m.setCoordsPoint2D(o)}else u.setCoordsPoint2D(o),Wnt(u),v=f_(u.x,g,v),m.setCoords(v+u.x,u.y);if(Math.abs(m.x-o.x)<.5&&m.setCoordsPoint2D(o),l)b.queryCoord(0,f),c.setCoordsPoint2D(h),c.scale(1/t),f.setXY(c),r.isFirstSegmentInPath()?a.startPathPoint(f):a.lineToPoint(f),r.isLastSegmentInPath()&&!r.isPathClosed()&&(b.queryCoord(1,f),c.setCoordsPoint2D(m),c.scale(1/t),f.setXY(c),a.lineToPoint(f));else{r.isFirstSegmentInPath()&&a.insertPath2D(-1,null,0,0,!0);const w=a.getPathCount()-1;c.setCoordsPoint2D(h),c.scale(1/t),a.insertPoint2D(w,-1,c),r.isLastSegmentInPath()&&!r.isPathClosed()&&(c.setCoordsPoint2D(m),c.scale(1/t),a.insertPoint2D(w,-1,c))}}}return a}function znt(t,e,s,i,r,n,o,a,l,u,c,h){const m=new M,f=new M,g=i.compare(r)>0;Yve(g,i,r,m,f);const v=Hve(t,e,s,m,f,n,o,a,l,u,null,c,h);return g&&kG(l,u,null,c),v}function RG(t,e){return!(!hs(t.y,Nt)||!hs(e.y,Nt))||!(!hs(t.y,-Nt)||!hs(e.y,-Nt))}function Bve(t,e){return!(!hs(t.y,Nt)||hs(e.y,Nt))||!(!hs(t.y,-Nt)||hs(e.y,-Nt))}function jve(t,e){return!(!hs(e.y,Nt)||hs(t.y,Nt))||!(!hs(e.y,-Nt)||hs(t.y,-Nt))}class Unt{constructor(){this.m_sr=null,this.m_gcs=null,this.m_transform=null,this.m_progressTracker=null,this.m_a=0,this.m_eSquared=0,this.m_rpu=0,this.m_gcsTolerance=0,this.m_radTolerance=0,this.m_maxLength=0,this.m_maxDeviation=0,this.m_curveType=0}geodeticDensify(e){const s=e.createInstance(),i=e.querySegmentIterator(),r=[],n=[],o=new ut,a=e.getDescription().getAttributeCount()>1;for(;i.nextPath();){const l=[0];for(;i.hasNextSegment();){const u=i.nextSegment(),c=u.getStartXY(),h=u.getEndXY();c.scale(this.m_rpu),h.scale(this.m_rpu);const m=new M,f=new M,g=c.compare(h)>0;Yve(g,c,h,m,f),r.length=0,n.length=0,this.m_maxLength>0?Hve(this.m_a,this.m_eSquared,this.m_curveType,m,f,this.m_maxLength,this.m_maxDeviation,this.m_radTolerance,null,null,a?n:null,r,l):Bnt(),g&&kG(null,null,a?n:null,r),r[0].setCoordsPoint2D(u.getStartXY()),r.at(-1).setCoordsPoint2D(u.getEndXY());const v=1/this.m_rpu;for(let b=1,w=r.length-1;b<w;b++)r[b].scale(v);if(a){const b=_ne(g,u,o);gne(i.isFirstSegmentInPath(),i.isLastSegmentInPath()&&!i.isPathClosed(),u,b,n,r,s)}else fne(i.isFirstSegmentInPath(),i.isLastSegmentInPath()&&!i.isPathClosed(),r,s)}}return s}shapePreservingDensify(e){const s=e.createInstance(),i=e.querySegmentIterator(),r=[],n=[],o=new ut,a=e.getDescription().getAttributeCount()>1;for(;i.nextPath();)for(;i.hasNextSegment();){const l=i.nextSegment(),u=l.getStartXY(),c=l.getEndXY(),h=u.compare(c)>0,m=_ne(h,l,o);r.length=0,n.length=0,Ynt(this.m_a,this.m_eSquared,this.m_rpu,m,this.m_sr,this.m_maxLength,this.m_maxDeviation,a?n:null,r),h&&kG(null,null,a?n:null,r),a?gne(i.isFirstSegmentInPath(),i.isLastSegmentInPath()&&!i.isPathClosed(),l,m,n,r,s):fne(i.isFirstSegmentInPath(),i.isLastSegmentInPath()&&!i.isPathClosed(),r,s)}return s}replaceCurvesWithLinesAndProjectToGCSAsMultiPoint_(e){const s=e.hasNonLinearSegments();if((!this.m_transform||this.m_transform.isIdentity())&&(e=Ix(e,this.m_gcs),!s))return e;const i=e.createInstance();i.reserveParts(e.getPointCount(),e.getPathCount());for(let r=0,n=e.getPathCount();r<n;++r){let o=new pi;const a=e.getPathStart(r),l=e.getPathEnd(r);o.addPoints(e,a,l);const u=e.isClosedPath(r);let c=!1;if(u&&l-a==1&&e.hasNonLinearSegmentsPath(r)){const h=new nt;e.getPointByVal(a,h),o.add(h),c=!0}if(this.m_transform&&!this.m_transform.isIdentity()){if(u&&!c){const h=new nt;e.getPointByVal(a,h),o.add(h)}if(o=new eh().execute(o,this.m_transform,this.m_progressTracker),u&&o.getPointCount()>1){const h=o.getXY(0),m=o.getXY(o.getPointCount()-1);h.equals(m)&&o.removePoint(o.getPointCount()-1)}}o.getPointCount()>1&&(i.addPathMultiPoint(o,0,-1,!0),u&&i.closePathWithLine())}return i}}function fne(t,e,s,i){t&&i.insertPath2D(-1,null,0,0,!0);const r=i.getPathCount()-1;i.insertPointsFromPoints(r,-1,s,0,s.length-1,!0),e&&i.insertPoint2D(r,-1,s.at(-1))}function gne(t,e,s,i,r,n,o){o.reserve(o.getPointCount()+n.length-1);const a=new nt;if(s.queryStart(a),t?o.startPathPoint(a):o.lineToPoint(a),n.length>2){const l=i.calculateLength2D();for(let u=1;u<n.length-1;u++){const c=i.lengthToT(r[u]*l);i.queryCoord(c,a),a.setXY(n[u]),o.lineToPoint(a)}}e&&(s.queryEnd(a),o.lineToPoint(a))}function Hve(t,e,s,i,r,n,o,a,l,u,c,h,m){const f={stack:[],error:void 0,hasError:!1};try{const g=mo(f,new wn,!1),v=mo(f,new wn,!1),b=mo(f,new wn,!1);Sa.geodeticDistance(t,e,i.x,i.y,r.x,r.y,b,g,v,s);const w=b.val,S=g.val,T=v.val;let P=S,I=T;P<0&&(P+=2*Math.PI),I<0&&(I+=2*Math.PI),l&&(l[0]=P),u&&(u[0]=I);let A=Number.NaN,D=Number.NaN;if(c!==null){const Z=TC.q90(t,e),te=TC.q(t,e,i.y);A=(Z-te)/w,D=(Z+te)/w}const k=Bve(i,r),R=jve(i,r),O=k||R,z=Xnt(i,r,a),q=mo(f,new bJe(new wn,new wn),!1),U=new M,V=new M,B=new M;m[0]=f_(i.x,Number.NaN,m[0]);let H=m[0];if(w<=n)return h.push(i.clone()),m[0]=f_(r.x,Number.NaN,m[0]),c!=null&&c.push(0),O?(k&&vne(i,r,c,h),R&&bne(i,r,c,h)):z?xne(i,r,S,A,D,c,h):o>0&&(V.setCoords(i.x-H,i.y),U.setCoords(r.x-m[0],r.y),H=yne()),h.push(r.clone()),w;const W=1+Math.ceil(w/n),ie=w/(W-1),se=new M;h.push(i.clone()),se.setCoordsPoint2D(i),V.setCoords(i.x-m[0],i.y),c!==null&&c.push(0);for(let Z=1;Z<W;Z++){let te;if(Z<W-1){const ve=Z*ie;Sa.geodeticCoordinate(t,e,i.x,i.y,ve,S,q.at(0),q.at(1),s),U.setCoords(q.at(0).val,q.at(1).val),m[0]=f_(U.x,se.x,m[0]),B.setCoords(m[0]+U.x,U.y),te=Z/(W-1)}else m[0]=f_(r.x,Number.NaN,m[0]),U.setCoords(r.x-m[0],r.y),B.setCoordsPoint2D(r),te=1;O?(Z===1&&k&&vne(i,B,c,h),Z===W-1&&R&&bne(se,r,c,h)):z?Xve(se,B,a)&&(i.x<r.x?se.x>B.x&&(m[0]+=2*Math.PI,B.setCoords(m[0]+U.x,U.y)):se.x<B.x&&(m[0]-=2*Math.PI,B.setCoords(m[0]+U.x,U.y)),xne(se,B,S,A,D,c,h)):o>0&&yne(),h.push(B.clone()),c!=null&&c.push(te),se.setCoordsPoint2D(B),V.setCoordsPoint2D(U),H=m[0]}return w}catch(g){f.error=g,f.hasError=!0}finally{Od(f)}}function Bnt(t,e,s,i,r,n,o,a,l,u){F(0)}function yne(t,e,s,i,r,n,o,a,l,u,c,h,m,f,g){return F(0),0}function jnt(t,e,s,i){const r=or(t,e,s),n=or(t,e,i);return gt.distance(r,n)}function Hnt(t,e,s,i,r,n,o,a){const l=new Array,u=ne(Array,8);let c=2,h=r.getCoord2D(n);u[0][0]=h.x,u[0][1]=h.y,h=r.getCoord2D(o),u[1][0]=h.x,u[1][1]=h.y;const m=v=>{if(s!==null){const b=sn.projToGeog(s,v,u);F(b===v)}for(const b of u)b[0]*=i,b[1]*=i};m(2),l.push(or(t,e,new M(u[0][0],u[0][1]))),l.push(or(t,e,new M(u[1][0],u[1][1])));let f=gt.distance(l[0],l[1]);if(f>a)return f;let g=0;for(c=3;c<=17;){const v=1/(c-1);let b=0;for(let P=1;P<c;++P)if(1&P){const I=zt(n,o,P*v);r.queryCoord2D(I,h),u[b][0]=h.x,u[b][1]=h.y,b++}m(b);let w=1;for(let P=0;P<b;++P)l.splice(w,0,or(t,e,new M(u[P][0],u[P][1]))),w++;w=0;let S=l[w];w++;let T=0;for(;w!==l.length;++w){const P=l[w];T+=gt.distance(S,P),S=P}if(T>a)return T;if(g=T-f,F(g>=0||Math.abs(g)<1e-14*T),g<0&&(g=0),f=T,T+g<=a)return T+g;c=2*c-1}return f+g}function Ynt(t,e,s,i,r,n,o,a,l){const u=i.isCurve(),c=Dst(t,e)*Math.PI*179/180;let h=n;n>0&&!(n>c)||(h=c);const m=o,f=m>0;let g=Number.NaN;f&&(g=Ost(t,e,m));const v=r.getCoordinateSystemType()===1;let b=null;v||(b=r.getPECoordSys());const w=r.getTolerance(0),S=i.getStartXY(),T=i.getEndXY(),P=new M,I=new M;if(v)P.setCoordsPoint2D(S),P.scale(s),I.setCoordsPoint2D(T),I.scale(s);else{const H=[S.x,S.y,T.x,T.y];sn.projToGeog(b,2,H),P.setCoords(H[0],H[1]),P.scale(s),I.setCoords(H[2],H[3]),I.scale(s)}let A=0,D=0;const k=[],R=[],O=[];k.push(T.clone()),R.push(I.clone()),O.push(1),l.push(S.clone()),a!==null&&a.push(D);const z=r.isPannable(),q=S.clone(),U=[.5,.33333333333333337,.6666666666666666,.16666666666666669,.8333333333333333];let V=5;u||(f?(U[0]=.5,U[1]=.25,U[2]=.75,V=3):V=1),F(h>0);const B=H=>{if(H=H.clone(),b!==null){const W=[H.x,H.y];sn.projToGeog(b,1,W),H.setCoords(W[0],W[1])}return H.scale(s),H};for(;R.length>0;){const H=k.at(-1).clone();I.assign(R.at(-1));const W=O.at(-1);let ie=!1,se=Number.NaN;const Z=Hnt(t,e,b,s,i,D,W,h);let te=h>=Z&&Math.abs(P.y-I.y)<.9*Math.PI;v&&te&&(te=Math.abs(P.x-I.x)<.9*Math.PI);const ve=new M,ke=new M;let Fe=!1;if(!f&&te&&te&&(Fe=!0),i.calculateSubLength(D,W)<=w&&(Fe=!0),!Fe)for(let Pe=0;Pe<V;Pe++){const Ve=zt(D,W,U[Pe]),Ke=new M;i.queryCoord2D(Ve,Ke);const He=B(Ke);if(Pe===0&&(se=Ve,ve.setCoordsPoint2D(Ke),ke.setCoordsPoint2D(He),!te)){ie=!0;break}if(F(f),v&&Math.abs(P.x-He.x)>=Math.PI){ie=!0;break}let Rs=new M,Cr=new M;u?(Rs=M.lerp(q,H,U[Pe]),Cr=B(Rs)):(Rs=Ke.clone(),Cr=He.clone());const Js=Cst(t,e,P,I,U[Pe]),as=Js.clone();if(v?(as.x/=s,as.y/=s):(as.x/=s,as.y/=s,sB(r.getGCSToSRTransform(),[as],1,[as],null)),as.isNAN()){const er=or(t,e,He),fi=or(t,e,P),Ks=or(t,e,I),{first:dt,second:De}=FS(t,e,er,fi,Ks,2,null);if(De>g){ie=!0;break}}else{if(z){const dt=r.getPannableExtent().width(),De=zt(i.getStartX(),i.getEndX(),.5);for(;as.x<De-.5*dt;)as.x+=dt;for(;as.x>=De+.5*dt;)as.x-=dt}const er=i.getClosestCoordinateOnInterval(as,new de(D,W),-1);let fi=i.getCoord2D(er);fi=B(fi);let Ks=jnt(t,e,fi,Js);if(Ks>g){if(Ks<4*g){const dt=or(t,e,fi),De=or(t,e,P),ks=or(t,e,I),{first:Pr,second:Ui}=FS(t,e,dt,De,ks,2,null);Ks=Ui}if(Ks>g){ie=!0;break}}else if(u){let dt=or(t,e,He);const De=or(t,e,P),ks=or(t,e,I);let{second:Pr}=FS(t,e,dt,De,ks,3,null);if(Pr<=g){dt=or(t,e,Cr);const{first:Ui,second:tr}=FS(t,e,dt,De,ks,3,null);Pr=tr}if(Pr>g){ie=!0;break}}}}ie?(k.push(ve.clone()),R.push(ke.clone()),O.push(se)):(k.pop(),R.pop(),O.pop(),l.push(H.clone()),A+=Z,a!==null&&a.push(A),q.setCoordsPoint2D(H),P.setCoordsPoint2D(I),D=W)}if(a!==null){const H=1/A;for(let W=0;W<a.length;W++)a[W]*=H}}function kG(t,e,s,i){if(i.reverse(),s!==null&&s.reverse(),t){const r=t[0],n=e[0];t[0]=n,e[0]=r}}function Yve(t,e,s,i,r){t?(i.setCoordsPoint2D(s),r.setCoordsPoint2D(e)):(i.setCoordsPoint2D(e),r.setCoordsPoint2D(s))}function _ne(t,e,s){return t?(s.create(e.getGeometryType()),e.copyTo(s.get()),s.get().reverse(),s.get()):e}function f_(t,e,s){if(Number.isNaN(e)){for(;s-t>Math.PI;)s-=2*Math.PI;for(;t-s>Math.PI;)s+=2*Math.PI;return s}return s+t-e>Math.PI?s-=2*Math.PI:e-(s+t)>Math.PI&&(s+=2*Math.PI),s}function vne(t,e,s,i){if(t.y>0){const r=new M;r.setCoords(e.x,Nt),hs(t.x,r.x)||hs(e.y,r.y)||(i.push(r),s!==null&&s.push(0))}else{const r=new M;r.setCoords(e.x,-Nt),hs(t.x,r.x)||hs(e.y,r.y)||(i.push(r),s!==null&&s.push(0))}}function bne(t,e,s,i){if(e.y>0){const r=new M;r.setCoords(t.x,Nt),hs(e.x,r.x)||hs(t.y,r.y)||(i.push(r),s!==null&&s.push(1))}else{const r=new M;r.setCoords(t.x,-Nt),hs(e.x,r.x)||hs(t.y,r.y)||(i.push(r),s!==null&&s.push(1))}}function xne(t,e,s,i,r,n,o){if(jat(s)){if(Nt-t.y>0){const a=new M;a.setCoords(t.x,Nt),o.push(a),n!==null&&n.push(i)}if(Nt-e.y>0){const a=new M;a.setCoords(e.x,Nt),o.push(a),n!==null&&n.push(i)}}else{if(Nt+t.y>0){const a=new M;a.setCoords(t.x,-Nt),o.push(a),n!==null&&n.push(r)}if(Nt+e.y>0){const a=new M;a.setCoords(e.x,-Nt),o.push(a),n!==null&&n.push(r)}}}function Xnt(t,e,s){return!(!Xve(t,e,s)||hs(t.y,Nt)||hs(t.y,-Nt)||hs(e.y,Nt)||hs(e.y,-Nt))}function Xve(t,e,s){return Math.abs(Math.abs(t.x-e.x)-Math.PI)<=s}function Wnt(t){if(t.x<-Math.PI)for(;t.x<-Math.PI;)t.x+=2*Math.PI;else if(t.x>Math.PI)for(;t.x>Math.PI;)t.x-=2*Math.PI}function Znt(t,e,s,i){const r={stack:[],error:void 0,hasError:!1};try{const n=[s.x],o=[s.y-i],a=[s.x],l=[s.y+i];Tre(n,o),Tre(a,l);const u=mo(r,new wn,!1),c=mo(r,new wn,!1);return Sa.greatEllipticDistance(t,e,s.x,s.y,n[0],o[0],u,null,null),Sa.greatEllipticDistance(t,e,s.x,s.y,a[0],l[0],c,null,null),Math.min(u.val,c.val)}catch(n){r.error=n,r.hasError=!0}finally{Od(r)}}function Wve(t,e,s,i,r){const n=new X;s.queryEnvelope(n);const o=ba(null,s,!0).total();if(e.xmin-n.xmin<=o&&n.xmax-e.xmax<=o)return s;const a=e.width();let l=0;for(;e.xmin+l*a<n.xmin;)l++;for(;e.xmin+l*a>n.xmin;)l--;const u=l*a,c=new Rt;c.setShiftCoords(-u,0);const h=s;h.applyTransformation(c);const m=new X;h.queryEnvelope(m);let f=null;if(m.xmax>e.xmax){let g=0;const v=new X;v.setCoords({env2D:e}),v.ymin-=1,v.ymax+=1;let b=h;for(;v.xmin<m.xmax;){m.xmax>v.xmax&&(b=tbe(b,t,2,!0,v.xmax));const w=P9(b,v),S=Ji(null,w,!0).total(),T=ps(b,v,S,Number.NaN,r);f===null?f=T===b?T.clone():T:(c.setShiftCoords(-g*a,0),T.applyTransformation(c),f.add(T,!1)),g++,v.xmin=v.xmax,v.xmax=e.xmax+g*a}}else f=h;return f}class Zve{constructor(e,s){this.m_basisX=new gt,this.m_basisY=new gt,this.m_normal=new gt,F(e.getCoordinateSystemType()===1),this.m_gcs=e;const i=P0();e.querySpheroidData(i),this.m_a=i.majorSemiAxis,this.m_e2=i.e2,this.m_rpu=e.getUnit().getUnitToBaseFactor(),this.m_curvCenterRad=s.mul(this.m_rpu);const r=this.m_curvCenterRad.x,n=this.m_curvCenterRad.y,o=Math.cos(r),a=Math.sin(r),l=Math.cos(n),u=Math.sin(n);this.m_cartCenter3D=Est(this.m_a,this.m_e2,o,a,l,u),this.m_normal.setCoordsPoint3D(this.m_cartCenter3D),this.m_d=this.m_cartCenter3D.length(),this.m_normal.divThis(this.m_d),gt.selectRightHandedBasisFromNormal(this.m_normal,this.m_basisX,this.m_basisY),this.m_northPolePcs=this.projectPoint(M.construct(0,.5*Math.PI/this.m_rpu)),this.m_southPolePcs=this.projectPoint(M.construct(0,.5*-Math.PI/this.m_rpu))}project(e){const s=e.getGeometryType();if(zo(s)){JE(e);const i=e;return this.projectMultiVertex(i)}ee("Gnomonic.project")}unproject(e,s,i){const r=e.getGeometryType();if(zo(r)){JE(e);let n=e;const o=[];if(r===G.enumPolygon){const a=n.getPathCount();for(let l=0;l<a;l++){const u=n.calculateRingArea2D(l);o.push(u)}}return this.unprojectMultiVertex(s,n),xt(r)?(not(this.m_gcs,0,n),Qnt(o,this.m_gcs,0,n,i)):n=Yb(n,this.m_gcs,0,!0,0,i),n}ee("Gnomonic.unproject")}projectPoint(e){const s=e.mul(this.m_rpu),i=or(this.m_a,this.m_e2,s),r=this.m_normal.dotProduct(i);if(r<=0)return M.construct(Number.NaN,Number.NaN);const n=this.m_d/r,o=i.mul(n).sub(this.m_cartCenter3D),a=new M;return a.x=this.m_basisX.dotProduct(o),a.y=this.m_basisY.dotProduct(o),a}unprojectPoint(e){const s=this.m_cartCenter3D.add(this.m_basisX.mul(e.x).add(this.m_basisY.mul(e.y)));return Hb(this.m_a,this.m_e2,s).divide(this.m_rpu)}projectMultiVertex(e){const s=e.getImpl();let i=!0;const r=new M,n=new M;for(let o=0,a=s.getPointCount();o<a;o++)s.queryXY(o,r),r.y*this.m_rpu>.5*Math.PI?n.assign(this.m_northPolePcs):r.y*this.m_rpu<.5*-Math.PI?n.assign(this.m_southPolePcs):n.assign(this.projectPoint(r)),s.setXY(o,n),n.isNAN()&&(i=!1);return s.notifyModifiedFlags(2001),i}unprojectMultiVertex(e,s){const i=s.getImpl(),r=e*e,n=!this.m_northPolePcs.isNAN(),o=!this.m_southPolePcs.isNAN();for(let a=0,l=i.getPointCount();a<l;a++){const u=i.getXY(a);let c=new M;n&&M.sqrDistance(u,this.m_northPolePcs)<=r?(c.setCoords(this.m_curvCenterRad.x,.5*Math.PI),c.scale(1/this.m_rpu)):o&&M.sqrDistance(u,this.m_southPolePcs)<=r?(c.setCoords(this.m_curvCenterRad.x,.5*-Math.PI),c.scale(1/this.m_rpu)):c=this.unprojectPoint(u),i.setXY(a,c)}i.notifyModifiedFlags(2001)}}function Qnt(t,e,s,i,r){const n=i.getGeometryType(),o=e.getPannableExtent();let a=i,l=!1,u=!1;if(n===G.enumPolygon){const c=new X,h=M.construct(s,0);c.setCoords({env2D:o}),c.centerAt(h),l=Jnt(t,e,c,a,r);const m=rot(e,c,a,r);m!==a&&(u=!0),a=m}else a=new eh().foldInto360RangeGeodetic(a,e,2);n===G.enumPolygon&&(l||u)&&(a=new Xh().execute(a,e,!1,r)),a!==i&&(i.setEmpty(),i.add(a,!1))}function Jnt(t,e,s,i,r){const n=Knt(s,i),o=eot(t,e,s,i,r);return n||o}function Knt(t,e){const s=new X;e.queryEnvelope(s);const i=hs(t.ymax,s.ymax),r=hs(t.ymin,s.ymin),n=i||r;return!!n&&(tot(t,e),n)}function eot(t,e,s,i,r){const n=[],o=[],a=.5*s.width();for(let h=0;h<i.getPathCount();h++){const m=i.getXY(i.getPathStart(h)),f=i.getXY(i.getPathEnd(h)-1),g=t[h]<0;if(Math.abs(m.x-f.x)>a){const v=sot(g,e,s,h,i,r);n.push(v),o.push(h)}else if(!g&&i.calculateRingArea2D(h)<0){const v=iot(e,s,h,i,r);n.push(v),o.push(h)}}if(n.length===0)return!1;const l=new wt({vd:i.getDescription()});let u=0,c=o[u];for(let h=0;h<i.getPathCount();h++)h===c?(l.add(n[u],!1),u++,u<o.length&&(c=o[u])):l.addPath(i,h,!0);return i.setEmpty(),i.add(l,!1),!0}function tot(t,e){const s=new wt,i=new X;for(let r=0;r<e.getPathCount();r++){e.queryPathEnvelope(r,i);let n=hs(t.ymax,i.ymax),o=hs(t.ymin,i.ymin);if(!(n||o)){s.addPath(e,r,!0);continue}s.insertPath2D(-1,null,0,0,!0);const a=e.getPathStart(r),l=e.getPathEnd(r),u=l-a;let c=-1;for(c=a;c<l;c++){const g=e.getXY(c);if(n=hs(t.ymax,g.y),o=hs(t.ymin,g.y),!n&&!o)break}let h=c,m=!1,f=Number.NaN;do{const g=e.getXY(h);n=hs(t.ymax,g.y),o=hs(t.ymin,g.y);const v=a+(h+1-a)%u;if(n||o){let b=M.construct(f,g.y);s.insertPoint2D(r,-1,b);const w=e.getXY(v),S=hs(t.ymax,w.y),T=hs(t.ymin,w.y);S||T||(b=M.construct(w.x,g.y),m?s.setXY(s.getPointCount()-1,b):s.insertPoint2D(r,-1,b)),m=!0}else s.insertPoint2D(r,-1,g),f=g.x,m=!1;h=v}while(h!==c)}e.setEmpty(),e.add(s,!1)}function sot(t,e,s,i,r,n){const o=new wt,a=new wt,l=new Rt,u=r.getXY(r.getPathStart(i)),c=r.getXY(r.getPathEnd(i)-1),h=s.width(),m=.5*h,f=new X;r.queryEnvelope(f);const g=Math.ceil(f.width()/h)+1;let v,b;u.x>c.x?(v=-h,b=t?s.ymin:s.ymax):(v=h,b=t?s.ymax:s.ymin),l.setShiftCoords(v,0),o.addPath(r,i,!0),a.add(o,!1);const w=new nt;for(let V=0;V<g;V++)a.applyTransformation(l),a.getPointByVal(0,w),o.lineToPoint(w),o.addSegmentsFromPath(a,0,0,a.getSegmentCount()-1,!1);const S=o.getXY(0),T=o.getXY(o.getPointCount()-1);S.y=b,T.y=b,o.lineTo(T);const P=new M;for(P.setCoordsPoint2D(T),P.x-=.5*v;Math.abs(P.x-S.x)>m;)o.lineTo(P),P.x-=.5*v;o.lineTo(S);const I=s.getCenter().x,A=new X;o.queryEnvelope(A);let D=0;const k=A.getCenter().x;k-I>m?D=-Math.ceil((k-I-m)/h):I-k>m&&(D=Math.ceil((I-k-m)/h)),D!==0&&(l.setShiftCoords(D*h,0),o.applyTransformation(l));const R=new oi,O=R.addGeometry(o);Xb(R,O,e,0,2,!0,s.xmin),Xb(R,O,e,0,2,!0,s.xmax);const z=R.getGeometry(O),q=P9(z,s);q.inflateCoords(0,1);const U=Ji(null,q,!0);return ps(z,s,U.total(),Number.NaN,n)}function iot(t,e,s,i,r){const n=e.width(),o=.5*n,a=e.getCenter().x,l=new X;i.queryPathEnvelope(s,l);let u,c=0,h=l.getCenter().x;if(h-a>o?c=-Math.ceil((h-a-o)/n):a-h>o&&(c=Math.ceil((a-h-o)/n)),c!==0){const v=new Rt;v.setShiftCoords(c*n,0),i.getImpl().applyTransformationToPath(v,s),i.queryPathEnvelope(s,l),h=l.getCenter().x}const m=new X;e.containsExclusiveEnvelope(l)?(u=!1,m.setCoords({env2D:e})):(u=!0,m.setCoords({env2D:e}),m.xmin-=n,m.xmax+=n);let f=i.createInstance();f.addPathPoint2D(null,0,!0);const g=new M;if(g.setCoords(m.xmin,m.ymin),f.insertPoint2D(0,-1,g),g.setCoords(m.xmin,m.ymax),f.insertPoint2D(0,-1,g),g.setCoords(.5*(m.xmin+m.xmax),m.ymax),f.insertPoint2D(0,-1,g),g.setCoords(m.xmax,m.ymax),f.insertPoint2D(0,-1,g),g.setCoords(m.xmax,m.ymin),f.insertPoint2D(0,-1,g),g.setCoords(.5*(m.xmin+m.xmax),m.ymin),f.insertPoint2D(0,-1,g),u){f.addPath(i,s,!0);const v=new Rt;h<a?v.setShiftCoords(n,0):v.setShiftCoords(-n,0),i.getImpl().applyTransformationToPath(v,s),f.addPath(i,s,!0);const b=new oi,w=b.addGeometry(f);Xb(b,w,t,0,2,!0,e.xmin),Xb(b,w,t,0,2,!0,e.xmax),f=b.getGeometry(w);const S=P9(f,e);S.inflateCoords(0,1);const T=Ji(null,S,!0).total();f=ps(f,e,T,Number.NaN,r)}else f.addPath(i,s,!0);return f}function rot(t,e,s,i){const r=new X;s.queryEnvelope(r);const n=ba(null,s,!0).total();if(e.xmin-r.xmin<=n&&r.xmax-e.xmax<=n)return s;const o=s.createInstance();let a=s.createInstance();const l=new X,u=s.getPathCount();for(let c=0;c<u;c++)s.queryPathEnvelope(c,l),e.xmin-l.xmin<=n&&l.xmax-e.xmax<=n?o.addPath(s,c,!0):(a.setEmpty(),a.addPath(s,c,!0),a=Wve(t,e,a,!0,i),o.add(a,!0));return o}function not(t,e,s){const i=t.getPannableExtent(),r=M.construct(e,0);i.centerAt(r);const n=i.width(),o=.5*n,a=new M;a.setNAN();let l=Number.NaN;for(let u=0;u<s.getPathCount();u++)for(let c=s.getPathStart(u);c<s.getPathEnd(u);c++){const h=s.getXY(c),m=hs(h.y,i.ymax)||hs(i.ymin,h.y);c===s.getPathStart(u)?(a.setNAN(),l=0):a.isNAN()||m||(l=oot(h.x,a.x,o,n,l)),h.x+=l,s.setXY(c,h),m||a.setCoordsPoint2D(h)}s.getImpl().notifyModifiedFlags(2001)}function oot(t,e,s,i,r){return r+t-e>s?r-=i:e-(r+t)>s&&(r+=i),r}function wne(t,e,s,i,r,n){const o=e.getAttributeStreamRef(0),a=e.getPointCount();let l=!1;const u=new M;for(let P=0;P<a;++P){if(o.queryPoint2D(2*P,u),1&n&&u.y>=s){l=!0;break}if(2&n&&u.y<=-s){l=!0;break}}if(!l)return!1;let c=!1;t&&(c=e.getImpl().isClosedPathInXYPlane(0));const h=new oi,m=h.addGeometry(e),f=h.getFirstPath(m);let g=-1,v=!0;const b=new M,w=new nt;let S=L;const T=Qve*r/360;for(let P=h.getFirstVertex(f);P!==L;P=h.getNextVertex(P)){h.queryXY(P,u);let I=1&n&&u.y>=s?1:0;if(I|=2&n&&u.y<=-s?2:0,g>0&&g!==I){if(b.x!==u.x){const A=h.getPrevVertex(P);h.queryPoint(A,w);const D=h.insertVertex(f,P,w);b.x=u.x,h.setXY(D,b)}if(c){let A=S!==L?h.getNextVertex(S):h.getFirstVertex(f);const D=h.getPrevVertex(P);for(;A!==D;)A=h.removeVertex(A,!1);if(S!==L){const k=h.getXY(S),R=h.getXY(D);if(Math.abs(k.x-R.x)>T){h.queryPoint(S,w);const O=h.insertVertex(f,D,w);k.x=zt(k.x,R.x,.5),h.setXY(O,k)}}}S=L}if(I&&(u.y=$d(i,u.y),h.setXY(P,u),!v&&g!==I))if(u.x!==b.x){h.queryPoint(P,w);const A=h.insertVertex(f,P,w);h.setXYCoords(A,b.x,u.y),S=A}else S=P;g=I,b.assign(u),v=!1}if(c){if(S!==L){let k=h.getNextVertex(S);for(;k!==L;)k=h.removeVertex(k,!1)}const P=h.getFirstVertex(f);let I=h.getLastVertex(f);const A=h.getXY(P),D=h.getXY(I);if(!A.equals(D)&&(h.queryPoint(P,w),I=h.insertVertex(f,L,w),Math.abs(A.x-D.x)>T)){const k=h.insertVertex(f,I,w);A.x=zt(A.x,D.x,.5),h.setXY(k,A)}}return e.assignCopy(h.getGeometry(m)),!0}function aot(t,e){let s=new wt({vd:t});s.addEnvelope(e,!1);const i=e.width()/180;return s=new i_().execute(s,i,0,0,null),s}function lot(t,e){const s=t.getPannableExtent();return Number.isNaN(e)||s.centerAtCoords(e,0),s}function uot(t,e,s){const i=P0();e.querySpheroidData(i);const r=e.getGCS()!==e?e.getSRToGCSTransform():null,n=ne(M,100),o=new gt(0,0,0),a=t.getPointCount(),l=e.getGCS().getUnit().getUnitToBaseFactor();for(let m=0,f=a;m<f;){const g=Math.min(100,f-m);t.queryCoordinates(n,g,m,m+g),r&&new eh().transform(r,n,g,n,!1);for(let v=0;v<g;v++){if(n[v].isNAN())continue;n[v].scale(l);const b=or(i.majorSemiAxis,i.e2,n[v]);o.addThis(b)}m+=g}const u=Hb(i.majorSemiAxis,i.e2,o);u.scale(1/l);const c=t;if(!new Zve(e.getGCS(),u).project(c))return 0;s.length=t.getPathCount();const h=c.calculateArea2D()<0;for(let m=0,f=t.getPathCount();m<f;m++){const g=c.calculateRingArea2D(m),v=h?g<0:g>0;s[m]=v}return h?-1:1}function cot(t,e,s,i,r){if(!e.isPannable()||t.isEmpty())return t;const n=t.getGeometryType();n===G.enumGeometryCollection&&yt("not yet impl for geometry collection");const o=e.getPannableExtent();Number.isNaN(s)&&(s=o.getCenterX());const a=o.width(),l=.5*a,u=r>0,c=t.queryInterval(0,0);if(!u&&c.width()<l||!zo(t.getGeometryType())){const h=c.getCenter();if(Math.abs(h-s)<=l)return t;{const m=new Rt,f=J_((s-h)/a)*a;m.setShiftCoords(f,0);const g=t.clone();return g.applyTransformation(m),g}}if(n===G.enumPolygon){let h=new qt({vd:t.getDescription()});h.addAndExplicitlyOpenAllPaths(t,!1),u&&(h=$G(h,e,2,r,Number.NaN,null,!0));const m=[];if(!i){{let f=t;u&&(f=new wt,f.add(h,!1));const g=uot(t,e,m);if(g)g<0&&h.reverseAllPaths();else{const v=f.getPathCount();for(let b=0;b<v;b++)m.push(f.calculateRingArea2D(b)>0)}}i=m}return new dD(null,i,h,null,e,s,3,0,null).geoNormalizePolygonGeometry(!0)}if(n===G.enumPolyline){let h=new qt({vd:t.getDescription()});return h.addAndExplicitlyOpenAllPaths(t,!1),u&&(h=$G(h,e,2,r,Number.NaN,null,!0)),new dD(null,null,h,null,e,s,3,0,null).geoNormalizePolylineGeometry(!0)}if(n===G.enumMultiPoint){const h=t,m=h.getAttributeStreamRef(0);let f,g=null,v=s,b=0;const w=.1*a;for(let S=0,T=h.getPointCount();S<T;S++){const P=m.read(2*S);let I=P-v;if(Math.abs(I)>l&&(I=J_(I/a)*a,b-=I,Math.abs(b)<w&&(b=0)),b!==0){g||(f=t.clone(),g=f.getAttributeStreamRef(0));const A=P+b;g.write(2*S,A)}v=P}return g?(f.notifyModified(),f):t}Ce("")}const Qve=210;class dD{constructor(e,s,i,r,n,o,a,l,u){this.m_bAdjustedAtPoles=0,this.m_inputPoly=i,this.m_progressTracker=u,this.m_originalGeometry=e,this.m_originalSR=r,this.m_polygonRingFlags=s,this.m_pannableSR=n,this.m_poleSnappingTolerance=l,this.m_poleFlags=a,this.m_bAdjustedAtPoles=0,this.m_pannableExtent=lot(this.m_pannableSR,o),this.m_centralLongitude=Number.isNaN(o)?this.m_pannableExtent.getCenterX():o,this.m_width360=this.m_pannableExtent.width(),this.m_degree=this.m_width360/360,this.m_GCSLargeDelta=Qve*this.m_degree,F(this.m_originalGeometry===null&&this.m_originalSR===null||this.m_originalGeometry!==null&&this.m_originalSR!==null)}geonormalizeRing(e,s,i,r,n,o,a){let l=i;const u=new qt({vd:this.m_inputPoly.getDescription()});u.addPath(this.m_inputPoly,e,!0),this.m_poleFlags!==0&&(this.m_bAdjustedAtPoles|=wne(!0,u,this.m_pannableExtent.ymax-this.m_poleSnappingTolerance,this.m_pannableExtent.ymax,this.m_pannableExtent.width(),this.m_poleFlags)?1:0,this.m_bAdjustedAtPoles&&(l=!1));let c=-1;l&&(c=this.m_originalGeometry.getPathStart(e));const h=u.getAttributeStreamRef(0),m=u.getPointCount();let f=0,g=h.read(0),v=0;const b=3*this.m_pannableSR.getTolerance(0);let w=!1;const S=new M,T=new M;let P=!1;const I=u.hasNonLinearSegments(),A=new M;for(let R=1;R<m;++R){h.queryPoint2D(2*R,A);const O=A.x;let z=O+f;const q=z-g;if(A.x=z,Math.abs(q)>this.m_GCSLargeDelta){if(l){const U=c+R-1,V=c+(R+1<m?R:0),B=o.read(2*U),H=(o.read(2*V)-B)*r;Math.abs(q-H)>1*this.m_degree&&(l=!1)}l||(f-=$d(this.m_width360,z-g),z=O+f,++v,P=f!==0,A.x=z)}else w||sKe(S,T,A,b)&&(w=!0);P&&(I&&Ce("error in geonormalize_ring_ for curves"),h.write(2*R,z)),g=z,S.setCoordsPoint2D(T),T.setCoordsPoint2D(A)}v&&u.notifyModified();const D=u.getXY(0),k=u.getXY(m-1);if(M.distance(D,k)<b){const R=this.finalizeGeoNormalizeClosedRing(u,w,n);a.add(R,!1)}else{s<0&&(this.m_originalGeometry!==null?(F(this.m_originalGeometry!==null),s=this.m_originalGeometry.calculateRingArea2D(e)>0?1:0):s=1);const R=this.finalizeGeoNormalizeOpenedRing(s>0,u);a.add(R,!1)}}geoNormalizePolygonGeometry(e){F(this.m_originalSR&&this.m_originalGeometry||!this.m_originalGeometry&&!this.m_originalSR),F(this.m_pannableSR.isPannable());let s=null,i=Number.NaN;const r=!!this.m_originalSR&&this.m_originalSR.isPannable();r&&(s=this.m_originalGeometry.getAttributeStreamRef(0),i=this.m_width360/this.m_originalSR.getPannableExtent().width()),this.m_bAdjustedAtPoles=0;const n=new wt({vd:this.m_inputPoly.getDescription()});for(let g=0,v=this.m_inputPoly.getPathCount();g<v;++g){const b=this.m_polygonRingFlags?this.m_polygonRingFlags[g]?1:0:-1;this.geonormalizeRing(g,b,r,i,e,s,n)}const o=this.m_pannableSR.getTolerance(0),a=this.m_pannableExtent.width()/180;yD(n,this.m_pannableExtent,.1*o,!1);const l=X.constructEmpty();if(l.setCoords({env2D:this.m_pannableExtent}),e){let g=!0;for(let v=0;v<2;v++){g=!0;const b=X.constructEmpty();for(let w=0,S=n.getPathCount();w<S;w++)if(n.queryPathEnvelope(w,b),!(l.xmin<=b.xmin&&l.xmax>=b.xmax||b.xmin>=l.xmax||b.xmax<=l.xmin)){g=!1;break}if(g)break;l.move(.5*this.m_width360,0)}g||l.setCoords({env2D:this.m_pannableExtent})}let u=ps(n,l,o,a,this.m_progressTracker),c=n!==u;const h=this.m_originalGeometry?this.m_originalGeometry.calculateArea2D():1,m=u.calculateArea2D();let f=0;if(m>0&&h<0)f=1;else if(m<=0&&h>0)if(m===0){if(this.m_originalSR){let g=Number.NaN;this.m_originalSR.getCoordinateSystemType()===2?g=this.m_originalSR.getPCSHorizon().calculateArea2D():this.m_originalSR.getCoordinateSystemType()===1&&(g=this.m_originalSR.getPannableExtent().getArea()),h>.99*g&&(f=-1)}}else f=-1;if(f!==0){const g=aot(u.getDescription(),l);g.add(u,!1),c=!0,u=g}return c&&(u=new Xh().execute(u,this.m_pannableSR,!1,this.m_progressTracker)),u}geoNormalizePolylineGeometry(e){F(this.m_pannableSR.isPannable());let s=null;const i=this.m_originalSR&&this.m_originalSR.isPannable();let r=1;i&&(F(this.m_originalGeometry),r=this.m_width360/this.m_originalSR.getPannableExtent().width(),s=this.m_originalGeometry.getAttributeStreamRef(0));const n=this.m_pannableExtent.width(),o=n*Bs()*4;let a=e,l=Number.NaN;const u=de.constructEmpty();this.m_bAdjustedAtPoles=0;let c=new qt({vd:this.m_inputPoly.getDescription()});for(let f=0,g=this.m_inputPoly.getPathCount();f<g;++f){let v=i;const b=new qt({vd:this.m_inputPoly.getDescription()});b.addPath(this.m_inputPoly,f,!0);const w=this.m_inputPoly.isClosedPath(f);this.m_poleFlags!==0&&(this.m_bAdjustedAtPoles|=wne(w,b,this.m_pannableExtent.ymax-this.m_poleSnappingTolerance,this.m_pannableExtent.ymax,n,this.m_poleFlags)?1:0,this.m_bAdjustedAtPoles&&(v=!1));let S=-1;const T=b.getPointCount();let P=!1;v&&(S=this.m_originalGeometry.getPathStart(f),P=this.m_originalGeometry.isClosedPath(f));const I=b.getAttributeStreamRef(0);let A=0,D=I.read(0),k=0;const R=new M,O=new M;let z=!1;const q=b.hasNonLinearSegments(),U=new M;for(let V=1;V<T;++V){I.queryPoint2D(2*V,U);const B=U.x;let H=B+A;const W=H-D;if(U.x=H,Math.abs(W)>this.m_GCSLargeDelta){if(v){const ie=S+V-1;let se=S;(!P||V+1<T)&&(se+=V);const Z=s.read(2*ie),te=(s.read(2*se)-Z)*r;Math.abs(W-te)>1*this.m_degree&&(v=!1)}v||(A-=$d(this.m_width360,H-D),H=B+A,++k,z=A!==0,U.x=H)}z&&(q&&Ce("error in geonormalize_ring_ for curves"),I.write(2*V,H)),D=H,R.setCoordsPoint2D(O),O.setCoordsPoint2D(U)}if(k&&b.notifyModified(),a){let V=!1;if(!b.isEmpty()){const B=X.constructEmpty();if(b.queryEnvelope(B),B.width()>=n||B.ymin<=this.m_pannableExtent.ymin||B.ymax>=this.m_pannableExtent.ymax)V=!0;else{if(Number.isNaN(l)){const W=this.m_centralLongitude-.5*n;l=B.xmin,l+=Math.round((W-B.xmin)/n)*n,l>W&&(l-=n),F(l<=W),l<W&&(l+=n),F(l>=W)}let H=Math.round((l-B.xmin)/n)*n;if(B.xmin+H>l+o&&(H-=n),B.xmin+H<l-o&&(H+=n),u.mergeCoordinate(B.xmin+H),u.mergeCoordinate(B.xmax+H),V=u.width()>=n,!V){const W=new Rt;W.setShiftCoords(H,0),b.applyTransformation(W)}}}c.add(b,!1),V&&(c=(()=>{const B=new qt({vd:c.getDescription()});for(let H=0,W=c.getPathCount();H<W;++H){const ie=new qt({vd:c.getDescription()});ie.addPath(c,H,!0);const se=Yb(ie,this.m_pannableSR,this.m_centralLongitude,!0,0,this.m_progressTracker);B.add(se,!1)}return B})(),a=!1)}else{const V=Yb(b,this.m_pannableSR,this.m_centralLongitude,!0,0,this.m_progressTracker);c.add(V,!1)}}if(a)return c;const h=this.m_pannableSR.getTolerance(0),m=this.m_pannableExtent.width()/180;return yD(c,this.m_pannableExtent,.1*h,!1),ps(c,this.m_pannableExtent,h,m,this.m_progressTracker)}finalizeGeoNormalizeOpenedRing(e,s){const i=s.getPointCount(),r=s.getXY(0),n=s.getXY(i-1);{const R=Math.abs(n.x-r.x),O=Math.round(R/this.m_width360)*this.m_width360;F(Math.abs(R-O)<this.m_pannableSR.getTolerance(0))}const o=di(n.x-r.x),a=X.constructEmpty();s.queryLooseEnvelope(a);const l=this.m_pannableExtent.getCenterX();let u=0,c=l-this.m_width360,h=l+this.m_width360;if(o>=0){let R=Math.ceil((c-a.xmin)/this.m_width360);for(R*=this.m_width360;c>a.xmin+R;)R+=this.m_width360;for(;c<a.xmax+R;)R-=this.m_width360;for(u=R,a.width()>720&&(h=c+360*Math.ceil(a.width()/360));h<a.xmax;)h+=this.m_width360}else{let R=Math.ceil((h-a.xmax)/this.m_width360);for(R*=this.m_width360;h<a.xmax+R;)R-=this.m_width360;for(;h>a.xmin+R;)R+=this.m_width360;for(u=R,a.width()>720&&(c=h-360*Math.ceil(a.width()/360));c>a.xmin;)c-=this.m_width360}const m=Math.round(Math.abs(n.x-r.x)/this.m_width360)*this.m_width360,f=o*m,g=a.clone();g.move(u,0);const v=new M(0,0),b=new Rt;b.setShiftCoords(u,0),s.applyTransformation(b);const w=new qt({vd:s.getDescription()});w.add(s,!1),v.assign(s.getXY(i-1));let S=0,T=w.getXY(0).x;for(;o>0?g.xmax<h:g.xmin>c;)g.move(f,0),b.xd=f,s.applyTransformation(b),T+=f,this.m_pannableExtent.xmin<=T&&this.m_pannableExtent.xmax>=T&&(S=w.getPointCount()-1),s.setXY(0,v),v.assign(s.getXY(i-1)),w.addSegmentsFromPath(s,0,0,i-1,!1);const P=new wt({vd:w.getDescription()});P.add(w,!1);const I=w.getXY(0),A=w.getXY(w.getPointCount()-1),D=o<0?e:!e,k=P.getPointCount()-1;if(D){const R=new M(A.x,this.m_pannableExtent.ymax);P.lineTo(R);const O=new M(this.m_pannableExtent.getCenterX(),this.m_pannableExtent.ymax);P.lineTo(O);const z=new M(I.x,this.m_pannableExtent.ymax);P.lineTo(z)}else{const R=new M(A.x,this.m_pannableExtent.ymin);P.lineTo(R);const O=new M(this.m_pannableExtent.getCenterX(),this.m_pannableExtent.ymin);P.lineTo(O);const z=new M(I.x,this.m_pannableExtent.ymin);P.lineTo(z)}if(P.interpolateAttributesPath(0,k,0),P.getImpl().changeRingStartPoint(S),m>this.m_width360){const R=new wt({copy:P});b.setShiftCoords(this.m_width360,0),R.applyTransformation(b),P.add(R,!1)}return P}finalizeGeoNormalizeClosedRing(e,s,i){const r=new wt({vd:e.getDescription()});r.add(e,!1);const n=()=>{const c=r.getPointCount()-2;return r.getSegmentType(c)!==G.enumLine};if(r.hasNonLinearSegments()&&n()){const c=new ut,h=r.getPointCount()-2;r.getSegmentBuffer(h,c,!1),r.removePointFromPath(0,h+1),r.closeLastPathWithSegment(c.get())}else r.removePointFromPath(0,r.getPointCount()-1);const o=X.constructEmpty();r.queryLooseEnvelope(o);let a=Math.ceil((this.m_pannableExtent.xmin-o.xmin)/this.m_width360);for(a*=this.m_width360;this.m_pannableExtent.xmin>o.xmin+a;)a+=this.m_width360;for(;this.m_pannableExtent.xmin<o.xmax+a;)a-=this.m_width360;if(a+=this.m_width360,a!==0){o.move(a,0);const c=new Rt;c.setShiftCoords(a,0),r.applyTransformation(c)}if(this.m_pannableExtent.xmin<=o.xmin&&this.m_pannableExtent.xmax>=o.xmax){if(s){const h=r.calculateArea2D(),m=new Xh().execute(r,this.m_pannableSR,!0,this.m_progressTracker);if(m!==r){const f=m.calculateArea2D();di(h)!==di(f)&&m.reverseAllPaths(),r.assignMove(m)}}let c;if(c=new wt(i?{copy:r}:{move:r}),i)for(;o.xmin<this.m_pannableExtent.xmax;){o.move(this.m_width360,0);const h=new Rt;h.setShiftCoords(this.m_width360,0),r.applyTransformation(h),c.add(r,!1)}return c}let l=new wt({vd:e.getDescription()});l.add(r,!1);const u=s||o.width()>this.m_width360-10*this.m_pannableSR.getTolerance(0);for(;o.xmin<this.m_pannableExtent.xmax;){o.move(this.m_width360,0);const c=new Rt;c.setShiftCoords(this.m_width360,0),r.applyTransformation(c),l.add(r,!1)}if(u){const c=l.calculateArea2D();l.setFillRule(1),l=new Xh().execute(l,this.m_pannableSR,!0,this.m_progressTracker);const h=l.calculateArea2D();di(c)!==di(h)&&l.reverseAllPaths()}return l}geonormalize_ring_(e,s,i,r,n,o,a){F(0)}}function Sne(t){F(0);const e=Pat(t),s=new mot;return s.setVertProj_(e),s}function hot(t,e=!0){return F(0),{}}function FG(t){return Fat()}class mot{constructor(){this.m_hashCode=0,this.m_peVertSysVal=null,this.m_verticalUnit=new Fd,this.m_verticalShift=0,this.m_userVerticalWKID=0,this.m_bIsDepth=!1}getType(){return F(0),0}getID(){return F(0),0}getLatestID(){return this.m_peVertSysVal?this.m_peVertSysVal.getLatestID():0}getOldID(){return this.m_peVertSysVal?this.m_peVertSysVal.getOldID():0}getText(){return F(0),""}getTextExtended(e){return F(0),""}getText2(e){return F(0),""}getUnit(){return F(0),{}}equals(e){return F(0),!1}equalForProjection(e){return F(0),!1}getPeVertcsCopy(){return F(0),{}}getOneMeter(){return 1/this.m_verticalUnit.getUnitToBaseFactor()}getUnitToBaseFactor(){return F(0),0}isDepth(){return F(0),!1}getVerticalShift(){return F(0),0}isCustomWkid(){return!!this.m_peVertSysVal&&this.m_peVertSysVal.isCustomWkid()}getHashCode(){return this.m_hashCode}setVertProj_(e){this.m_peVertSysVal=e}getPEVerticalCoordSys(){return this.m_peVertSysVal?this.m_peVertSysVal.m_peVertcs:null}}function SR(t,e,s,i,r){if(t.equals(e))return!1;if(i){let a=1,l=0,u=1,c=1,h=0,m=1;Number.isNaN(t.m_heightMetersPerUnit)||(a=t.m_heightMetersPerUnit,l=t.m_heightZ0,u=t.m_heightSign,c=e.m_heightMetersPerUnit,h=e.m_heightZ0,m=e.m_heightSign);const f=u*m*a/c;for(let g=0;g<r;g++)i[g]=(i[g]-l)*f+h}let n=1,o=0;if(Number.isNaN(t.m_XYToRadians)||(n=t.m_XYToRadians/e.m_XYToRadians,o=t.m_PrimeMeridianDegrees-e.m_PrimeMeridianDegrees,o!==0&&(o=G1e(o),o/=e.m_XYToRadians)),Array.isArray(s)){const a=s;for(let l=0;l<r;l++)a[l][0]=a[l][0]*n+o,a[l][1]=a[l][1]*n}else{const a=s;for(let l=0;l<r;l++){const u=l<<1;a[u]=a[u]*n+o,a[u+1]=a[u+1]*n}}return!0}function th(){return{m_heightMetersPerUnit:0,m_heightSign:0,m_heightZ0:0,m_XYToRadians:0,m_PrimeMeridianDegrees:0,assign(t){this.m_heightMetersPerUnit=t.m_heightMetersPerUnit,this.m_heightSign=t.m_heightSign,this.m_heightZ0=t.m_heightZ0,this.m_XYToRadians=t.m_XYToRadians,this.m_PrimeMeridianDegrees=t.m_PrimeMeridianDegrees},equals(t){return uo(this.m_heightSign,t.m_heightSign)&&uo(this.m_heightMetersPerUnit,t.m_heightMetersPerUnit)&&uo(this.m_heightZ0,t.m_heightZ0)&&uo(this.m_XYToRadians,t.m_XYToRadians)&&uo(this.m_PrimeMeridianDegrees,t.m_PrimeMeridianDegrees)},initFromGcsAndVcsPe(t,e){this.m_heightSign=1,this.m_heightMetersPerUnit=Number.NaN,this.m_heightZ0=0,this.m_XYToRadians=Number.NaN,this.m_PrimeMeridianDegrees=Number.NaN,e&&F(0),t&&(this.m_XYToRadians=t.getUnit().getUnitFactor(),this.m_PrimeMeridianDegrees=t.getPrimem().getLongitude())},initFromGcsAndVcs(t,e){const s=t?t.getPECoordSys():null,i=e?e.getPEVerticalCoordSys():null;this.initFromGcsAndVcsPe(s,i)},processUnitParams(t){Number.isNaN(this.m_heightMetersPerUnit)&&(this.m_heightMetersPerUnit=t.m_heightMetersPerUnit,this.m_heightSign=t.m_heightSign,this.m_heightZ0=t.m_heightZ0),Number.isNaN(this.m_XYToRadians)&&(this.m_XYToRadians=t.m_XYToRadians,this.m_PrimeMeridianDegrees=t.m_PrimeMeridianDegrees)}}}class dot{constructor(e){this.m_constantsLoaded=-1,this.m_isUsable=-1,this.m_inputSR=null,this.m_outputSR=null,this.m_inputSRHorz=null,this.m_outputSRHorz=null,this.m_inputVCS=null,this.m_outputVCS=null,this.m_hashCode=0,this.m_areaOfUse=new Sn,this.m_inputUnitParams=th(),this.m_outputUnitParams=th(),F(e),this.m_geogTran=e,this.m_vertTran=null,this.m_latestID=Ki.getCode(this.m_geogTran),this.m_latestID<0&&(this.m_latestID=0);const s=this.m_geogTran.getGeogcs1();Ki.getCode(s);const i=this.m_geogTran.getGeogcs2();Ki.getCode(i),this.initUnitParams()}getLatestId(){return this.m_latestID}getText(){return this.m_geogTran?this.m_geogTran.toString():(F(0),"")}getGeogtran(){return this.m_geogTran}getVerttran(){return null}loadConstants(e){let s=this.m_constantsLoaded;if(s===-1){if(!e){this.m_geogTran||Ce("vcs not impl");const i=this.m_geogTran.getParameters();i[We.PE_PARM_ND]!==null&&(e=i[We.PE_PARM_ND].getValue()===0)}s=this.m_geogTran.loadConstants()?1:0,this.m_constantsLoaded=s}return s!==0}isUsable(){let e=this.m_isUsable;return e===-1&&(this.m_geogTran?this.m_isUsable=e=this.m_geogTran?1:0:this.m_isUsable=e=this.m_vertTran?1:0),e===1}getInputSr(e){return this.updateSrs(),e?this.m_inputSR:this.m_inputSRHorz}getOutputSr(e){return this.updateSrs(),e?this.m_outputSR:this.m_outputSRHorz}getHashCode(){let e=this.m_hashCode;return e===0&&(e=this.m_latestID>0?kc(this.m_latestID):q0e(this.getText()),e===0&&(e=345),this.m_hashCode=e),e}isGeogtran(){return this.m_geogTran!==null}prepareOrThrow(){}getName(){return this.isGeogtran()?this.getGeogtran().getName():(yt("vcs not impl"),"")}updateSrs(){if(this.m_inputSR||this.m_inputVCS)return;let e,s,i,r,n,o;if(this.m_geogTran){const a=this.m_geogTran.getGeogcs1(),l=_D(a),u=this.m_geogTran.getGeogcs2(),c=_D(u);let h=-1,m=-1;h=l.getVcsCode(),m=c.getVcsCode(),i=PC(a,null,null,1),r=PC(u,null,null,1),h>0&&m>0?(n=Sne(h),o=Sne(m),e=jG(),s=jG()):(e=i,s=r)}else F(0);this.m_inputSR||this.m_inputVCS||(this.m_inputSR=e,this.m_outputSR=s,this.m_inputSRHorz=i,this.m_outputSRHorz=r,this.m_inputVCS=n,this.m_outputVCS=o)}initUnitParams(){if(this.m_inputUnitParams.m_heightSign=1,this.m_inputUnitParams.m_heightMetersPerUnit=Number.NaN,this.m_inputUnitParams.m_heightZ0=0,this.m_outputUnitParams.m_heightSign=1,this.m_outputUnitParams.m_heightMetersPerUnit=Number.NaN,this.m_outputUnitParams.m_heightZ0=0,this.m_inputUnitParams.m_XYToRadians=Number.NaN,this.m_inputUnitParams.m_PrimeMeridianDegrees=Number.NaN,this.m_outputUnitParams.m_XYToRadians=Number.NaN,this.m_outputUnitParams.m_PrimeMeridianDegrees=Number.NaN,this.m_vertTran)F(0);else if(this.m_geogTran){const e=this.m_geogTran;let s=e.getGeogcs1();this.m_inputUnitParams.m_XYToRadians=s.getUnit().getUnitFactor(),this.m_inputUnitParams.m_PrimeMeridianDegrees=s.getPrimem().getLongitude(),s=e.getGeogcs2(),this.m_outputUnitParams.m_XYToRadians=s.getUnit().getUnitFactor(),this.m_outputUnitParams.m_PrimeMeridianDegrees=s.getPrimem().getLongitude()}}}function Jve(t,e,s,i,r,n,o){let a=null;e&&(a=e.getPEVerticalCoordSys());let l=null;t&&(l=t.getPECoordSys());let u=null;i&&(u=i.getPEVerticalCoordSys());let c=null;if(s&&(c=s.getPECoordSys()),!(l||a||c||u))return!1;const h=th();h.initFromGcsAndVcsPe(l,a);const m=th();return m.initFromGcsAndVcsPe(c,u),SR(h,m,r,n,o)}function pot(t,e,s,i,r,n,o,a){const l=e,u=t,c=th();c.initFromGcsAndVcsPe(u,l),a.assign(i?s.m_outputUnitParams:s.m_inputUnitParams),a.processUnitParams(c),c.processUnitParams(a),o>0&&SR(c,a,r,n,o)}function fot(t,e,s,i,r,n,o,a){const l=th();l.assign(s?e.m_inputUnitParams:e.m_outputUnitParams),l.processUnitParams(t);let u=null,c=null;i&&(c=i.getPECoordSys());const h=th();h.initFromGcsAndVcsPe(c,u),h.processUnitParams(l),l.processUnitParams(h),a>0&&SR(l,h,n,o,a)}function got(t,e,s,i,r,n,o,a,l){const u=th(),c=th();u.assign(s?e.m_inputUnitParams:e.m_outputUnitParams),c.assign(r?i.m_outputUnitParams:i.m_inputUnitParams),u.processUnitParams(t),c.processUnitParams(u),u.processUnitParams(c),a>0&&SR(u,c,n,o,a),l.assign(c)}function yot(t,e,s,i,r,n,o){const a=e.getVerttran(),l=e.getGeogtran();if(o.assign(s?e.m_inputUnitParams:e.m_outputUnitParams),o.processUnitParams(t),n>0){e.prepareOrThrow();const u=s?We.PE_TRANSFORM_2_TO_1:We.PE_TRANSFORM_1_TO_2;a?abe():lbe(l,n,i,r,u)}}function _ot(t,e,s,i,r){const n=t.getVerttran(),o=t.getGeogtran();if(r>0){t.prepareOrThrow();const a=e?We.PE_TRANSFORM_2_TO_1:We.PE_TRANSFORM_1_TO_2;n?abe():lbe(o,r,s,i,a)}}class iB{supportsCurves(){return!0}accelerateGeometry(e,s,i){return Kve(e,s,i)}canAccelerateGeometry(e){return rB(e)}}function Kve(t,e,s){if(!rB(t))return!1;iC(e,t,!1);let i=0;const r=t.getGeometryType();return xt(r)&&Z3(t)&&s!==0&&(i|=t.getImpl().buildQuadTreeAccelerator(s)?1:0),xt(r)&&i1e(t)&&s!==0&&(i|=t.getImpl().buildQuadTreeForPathsAccelerator(s)?1:0),i>0}function rB(t){return Z3(t)||i1e(t)}class nB extends iB{getOperatorType(){return 8}execute(e,s,i,r){return gd(e,s,i,1,r)}}function vot(t,e,s,i){if(t.isEmpty()||e.isEmpty())return t;const r=t.getDimension(),n=e.getDimension();if(r>n)return t;const o=t.getGeometryType(),a=e.getGeometryType(),l=new X,u=new X,c=new X;t.queryEnvelope(l),e.queryEnvelope(u),c.setCoords({env2D:l}),c.mergeEnvelope2D(u);const h=Ji(s,c,!0),m=il(h),f=new X;if(f.setCoords({env2D:l}),f.inflateCoords(m,m),!f.isIntersecting(u))return t;if(r===1&&n===2){const v=Mot(t,e,a,s,i);if(v)return v}if(o===G.enumPoint){let v;switch(zi(a)?(v=new qt({vd:e.getDescription()}),v.addSegment(e,!0)):v=e,a){case G.enumPolygon:return xot(t,v,h);case G.enumPolyline:return wot(t,v,h);case G.enumMultiPoint:return Sot(t,v,h);case G.enumEnvelope:return Eot(t,v,h);case G.enumPoint:return Cot(t,v,h);default:ee("invalid shape type")}}else if(o===G.enumMultiPoint)switch(a){case G.enumPolygon:return Pot(t,e,h);case G.enumEnvelope:return Tot(t,e,h);case G.enumPoint:return Iot(t,e,h)}const g=new X(l);return g.inflate(100*h.total()),dnt(t,ps(e,g,0,0,i),s,i)}class ER{getOperatorType(){return 10002}supportsCurves(){return!0}accelerateGeometry(e,s,i){return!1}canAccelerateGeometry(e){return!1}executeMany(e,s,i,r){return new bot(e,s,i,r)}execute(e,s,i,r){return this.executeMany(new kd([e]),new kd([s]),i,r).next()}}class bot extends nm{constructor(e,s,i,r){super(),this.m_progressTracker=r,this.m_index=-1,this.m_inputGeoms=e,this.m_spatialReference=i;const n=s.next();this.m_geomSubtractor=n||new wt}next(){const e=this.m_inputGeoms.next();return e?(Nd(e),YQe(e),this.m_index=this.m_inputGeoms.getGeometryID(),vot(e,this.m_geomSubtractor,this.m_spatialReference,this.m_progressTracker)):null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}}function xot(t,e,s,i){return kve(e,t,s.total())===0?t:t.createInstance()}function wot(t,e,s,i){const r=t.getXY(),n=e.querySegmentIterator(),o=il(s),a=o*o;for(;n.nextPath();)for(;n.hasNextSegment();){const l=n.nextSegment(),u=new X;if(l.queryEnvelope(u),u.inflateCoords(o,o),!u.contains(r))continue;if(l.isIntersectingPoint(r,s.total()))return t.createInstance();let c=l.getStartXY();if(M.sqrDistance(r,c)<=a||(c=l.getEndXY(),M.sqrDistance(r,c)<=a))return t.createInstance()}return t}function Sot(t,e,s,i){const r=e.getImpl().getAttributeStreamRef(0),n=e.getPointCount(),o=t.getXY(),a=il(s),l=a*a,u=new M;for(let c=0;c<n;c++)if(r.queryPoint2D(2*c,u),M.sqrDistance(u,o)<=l)return t.createInstance();return t}function Eot(t,e,s,i){const r=new X;e.queryEnvelope(r),r.inflate(s.total());const n=t.getXY();return r.contains(n)?t.createInstance():t}function Cot(t,e,s,i){const r=il(s),n=r*r,o=t.getXY(),a=e.getXY();return M.sqrDistance(o,a)<=n?t.createInstance():t}function Pot(t,e,s,i){const r=new X;e.queryEnvelope(r),r.inflate(s.total());const n=t.getPointCount();let o=!1;const a=Me(n,!1),l=new M;for(let c=0;c<n;c++)t.queryXY(c,l),r.contains(l)&&Bo(e,l,s.total())!==0&&(o=!0,a[c]=!0);if(!o)return t;const u=t.createInstance();for(let c=0;c<n;c++)a[c]||u.addPoints(t,c,c+1);return u}function Tot(t,e,s,i){const r=new X;e.queryEnvelope(r),r.inflate(s.total());const n=t.getPointCount();let o=!1;const a=Me(n,!1),l=new M;for(let c=0;c<n;c++)t.queryXY(c,l),r.contains(l)&&(o=!0,a[c]=!0);if(!o)return t;const u=t.createInstance();for(let c=0;c<n;c++)a[c]||u.addPoints(t,c,c+1);return u}function Iot(t,e,s,i){const r=t.getImpl().getAttributeStreamRef(0),n=t.getPointCount(),o=e.getXY();let a=!1;const l=Me(n,!1),u=il(s),c=u*u,h=new M;for(let f=0;f<n;f++)r.queryPoint2D(2*f,h),M.sqrDistance(h,o)<=c&&(a=!0,l[f]=!0);if(!a)return t;const m=t.createInstance();for(let f=0;f<n;f++)l[f]||m.addPoints(t,f,f+1);return m}function Mot(t,e,s,i,r){const n=new Sn;t.queryEnvelope(n);const o=new X;e.queryEnvelope(o),n.merge(o);const a=.1*n.width(),l=.1*n.height();n.inflateCoords(a,l);const u=new wt;u.addEnvelope(n,!1);const c=u.getImpl();if(s===G.enumPolygon){const h=e.getImpl();c.add(h,!0)}else c.addEnvelope(e,!0);return new A_(u,i,-1,r).tryFastImplementation(t)}class pD{getOperatorType(){return 10001}supportsCurves(){return!0}accelerateGeometry(e,s,i){return!1}canAccelerateGeometry(e){return!1}executeMany(e,s,i,r=0){return new fD(e,s,i,r)}execute(e,s,i,r){const n=new kd([e,s]),o=new fD(n,i,r,0).next();return o||Ce("null output"),o}}function Aot(){return{geom:null,vertexCount:-1,bUnioned:!1,location:new M}}function Not(t,e){return M.compareZorder(t.location,e.location)?-1:t.location.equals(e.location)?0:1}class Dot{constructor(){this.binVertexCount=0,this.geometries=[]}addPair(e){this.binVertexCount+=e.vertexCount,this.geometries.push(e)}sort(){this.geometries.sort((e,s)=>Not(e,s))}geomCount(){return this.geometries.length}geomPairs(){return this.geometries}clear(){this.binVertexCount=0,this.geometries.length=0}getBinVertexCount(){return this.binVertexCount}}class fD extends nm{constructor(e,s,i,r,n=!1){super(),this.m_index=-1,this.m_currentDim=-1,this.m_bDone=!1,this.m_unionBins=[],this.m_readyGeoms=fE(4),this.m_dimGeomCounts=Me(4,0),this.m_addedGeoms=0,this.m_maxDimension=-1,this.m_bHadGeometry=Me(4,!1),this.m_complexUnionGeoms=fE(4),this.m_totalNonEmptyGeomCounters=Me(4,0),this.m_progressTracker=i,this.m_bUnionAllDimensions=!!(4&r),this.m_bPreserveAllPathEnds=!!(8&r),this.m_inputGeoms=e,this.m_spatialReference=s,this.m_options=r,this.m_bIs3D=n}next(){if(this.m_bDone&&this.m_currentDim===this.m_maxDimension)return null;for(;!this.step_(););if(this.m_maxDimension===-1)return null;if(this.m_bUnionAllDimensions){if(this.m_currentDim===-1){for(let e=0;e<=this.m_maxDimension;e++)if(this.m_bHadGeometry[e]){this.m_complexUnionGeoms[e]=this.getResultGeometry(e);for(let s=e+1;s<=this.m_maxDimension;s++)this.m_complexUnionGeoms[s]=this.getResultGeometry(s),this.m_bHadGeometry[s]&&!this.m_complexUnionGeoms[s].isEmpty()&&(this.m_bIs3D?F(0):this.m_complexUnionGeoms[e]=new ER().execute(this.m_complexUnionGeoms[e],this.m_complexUnionGeoms[s],this.m_spatialReference,this.m_progressTracker))}}for(;this.m_currentDim++,(this.m_currentDim>this.m_maxDimension||this.m_currentDim<0)&&Ce(""),!this.m_bHadGeometry[this.m_currentDim];);if(this.m_index++,this.m_currentDim===0&&this.m_complexUnionGeoms[this.m_currentDim].getGeometryType()===G.enumPoint){const e=new pi({vd:this.m_complexUnionGeoms[this.m_currentDim].getDescription()});return this.m_complexUnionGeoms[this.m_currentDim].isEmpty()||e.add(this.m_complexUnionGeoms[this.m_currentDim]),e}return this.m_complexUnionGeoms[this.m_currentDim]}return this.m_index=0,this.m_currentDim=this.m_maxDimension,this.getResultGeometry(this.m_maxDimension)}getGeometryID(){return this.m_index}getRank(){return 1}tock(){return this.step_()}getResultGeometry(e){return this.m_readyGeoms[e]}finishDim(e,s,i){let r=s;if(!i)return 16&this.m_options&&(r=xL([r],1,this.m_spatialReference,this.m_progressTracker,this.m_options,this.m_bIs3D)),r;if(1&this.m_options)return r;if(e===1)if(!(8&this.m_options)&&(16&this.m_options||this.m_totalNonEmptyGeomCounters[e]>1)){r=xL([r],1,this.m_spatialReference,this.m_progressTracker,16|this.m_options,this.m_bIs3D);const n=[0],o=r.getImpl().getIsSimple(0,n);F(this.m_bIs3D||Hf(o))}else this.m_totalNonEmptyGeomCounters[e]===1&&(this.m_bIs3D?F(0):r=new Xh().execute(r,this.m_spatialReference,!1,this.m_progressTracker));else this.m_bIs3D?F(0):r=new Xh().execute(r,this.m_spatialReference,!1,this.m_progressTracker);if(e===0&&r.getGeometryType()===G.enumPoint){const n=new pi({vd:r.getDescription()});r.isEmpty()||n.add(r),r=n}return r}static getLevel(e){const i=QE(e);let r=i>0?(Math.log(i)-Math.log(32))/Math.log(4):0;return r<0&&(r=0),Math.floor(r)}step_(){if(this.m_bDone)return!0;let e;if(this.m_inputGeoms?(e=this.m_inputGeoms.next(),e===null?(this.m_bDone=!0,this.m_inputGeoms=null):(this.checkAndThrow(e),e.isEmpty()||this.m_totalNonEmptyGeomCounters[e.getDimension()]++)):e=null,e!==null){const s=e.getDimension();this.m_bHadGeometry[s]=!0,(s>=this.m_maxDimension||this.m_bUnionAllDimensions)&&(this.addGeom(s,!1,e),s>this.m_maxDimension&&!this.m_bUnionAllDimensions&&this.removeAllBinsWithLowerDimension(s))}if(this.m_addedGeoms>0)for(let s=0;s<=this.m_maxDimension;s++){for(;this.m_dimGeomCounts[s]>1;){const i=this.collectGeometriesToUnion(s);if(i===null)break;{let r;r=1&this.m_options?xL(i,i.length,this.m_spatialReference,this.m_progressTracker,this.m_options,this.m_bIs3D):_nt(i,i.length,this.m_spatialReference,this.m_progressTracker,8|this.m_options,this.m_bIs3D),this.addGeom(s,!0,r)}}if(this.m_bDone&&(F(this.m_dimGeomCounts[s]<=1),this.m_dimGeomCounts[s]!==0)){const i=this.m_unionBins[s].entries().next().value,r=i[1].geomPairs()[0].geom,n=i[1].geomPairs()[0].bUnioned;this.m_unionBins[s].clear(),this.m_readyGeoms[s]=this.finishDim(s,r,n)}}return this.m_bDone}addGeom(e,s,i){const r=Aot();r.geom=i;const n=QE(i);r.vertexCount=n;const o=X.constructEmpty();i.queryEnvelope(o),r.location=n>0?o.getCenter():new M(0,0);const a=fD.getLevel(i);if(e+1>this.m_unionBins.length)for(;this.m_unionBins.length<Math.max(2,e+1);)this.m_unionBins.push(new Map);let l=null;const u=this.m_unionBins[e].get(a);u&&(l=u),l===null&&(l=new Dot,this.m_unionBins[e].set(a,l)),r.bUnioned=s,l.addPair(r),this.m_dimGeomCounts[e]++,this.m_addedGeoms++,this.m_maxDimension=Math.max(this.m_maxDimension,e)}removeAllBinsWithLowerDimension(e){for(let s=0;s<e;s++)this.m_unionBins[s].clear(),this.m_addedGeoms-=this.m_dimGeomCounts[s],this.m_dimGeomCounts[s]=0}collectGeometriesToUnion(e){if(1&this.m_options&&!this.m_bDone)return null;let s=null;const i=[];for(const r of this.m_unionBins[e].keys())i.push(r);xx(i);for(let r=0;r<i.length;r++){if(i[r]===-1)continue;const n=this.m_unionBins[e].get(i[r]);{const l=n.getBinVertexCount()>5e3&&n.geomCount()>=4;if(this.m_bDone||l){for(let u=0;u<r;u++){if(i[u]===-1)continue;const c=this.m_unionBins[e].get(i[u]);c.sort(),this.m_dimGeomCounts[e]-=c.geomCount(),this.m_addedGeoms-=c.geomCount();for(const h of c.geomPairs())s||(s=new Array),s.push(h.geom);c.clear(),this.m_unionBins[e].delete(i[u]),i[u]=-1}n.sort(),this.m_dimGeomCounts[e]-=n.geomCount(),this.m_addedGeoms-=n.geomCount();for(const u of n.geomPairs())s||(s=new Array),s.push(u.geom);if(n.clear(),this.m_unionBins[e].delete(i[r]),i[r]=-1,!this.m_bDone)break}}}return s}checkAndThrow(e){this.m_bIs3D&&(e.getDimension()>1&&BQe(),e.hasAttribute(1)||ee("Geometry must have Zs")),Nd(e)}}class oB extends iB{getOperatorType(){return 3}execute(e,s,i,r=null){return gd(e,s,i,4,r)}}function OG(t,e,s){const i=e.getGCSSplitLines();if(i===null)return t;const r=e.getGCS(),n=r.getPannableExtent().width(),o=X.constructEmpty();t.queryLooseEnvelope(o);const a=de.constructEmpty();o.queryIntervalX(a);const l=i.querySegmentIterator();let u=null;const c=new Rt;for(;l.nextPath();)for(;l.hasNextSegment();){const h=l.nextSegment(),m=h.queryInterval(0,0),f=de.constructEmpty();f.setCoordsFromEnvelope(m);let g=0;for(;f.vmax>a.vmin;)f.move(-n),g--;for(;f.vmin<=a.vmax;){if(f.isIntersecting(a)){u===null&&(u=new qt);const v=new pt({start:h.getStartXY(),end:h.getEndXY()});g!==0&&(c.setShiftCoords(g*n,0),v.applyTransformation(c)),u.addSegment(v,!0)}f.move(n),++g}}if(u!==null){const h=ba(r,u,!0);return iit(t,u,il(h),s)}return t}function aB(t,e,s){let i=t.getName();return _be(i)||(s||e>0?(i=t.toString(We.PE_STR_NAME_CANON|We.PE_STR_AUTH_NONE),i=Fot(i)):i=t.toString(We.PE_STR_AUTH_TOP)),i}function $ot(t,e,s,i){return F(0),""}function Ene(t,e=-1){if((e>1||e<-1)&&ee("verbosity"),e===-1)return t.toString();{const s=e===0?We.PE_STR_AUTH_TOP:We.PE_STR_AUTH_ALL;return t.toString(s)}}function Rot(t,e){(e>1||e<-1)&&ee("verbosity");let s=We.PE_STR_FMT_WKT2;return e!==-1&&(s|=e===0?We.PE_STR_AUTH_TOP:We.PE_STR_AUTH_ALL),t.toString(s)}function kot(t){return F(0),""}function Fot(t){return t.toLocaleUpperCase("en-US")}function Oot(t,e,s){const i=t.getPCSHorizon();if(i.getGeometryType()!==G.enumPolygon)if(i.getGeometryType()!==G.enumEnvelope)ee("");else{const r=i;for(let n=0;n<s;n++)r.contains(e[n])||e[n].setNAN()}else{const r=t.getDefaultPrecisionSR().getTolerance(0),n=i;for(let o=0;o<s;o++)Bo(n,e[o],r)!==1&&e[o].setNAN()}}function Lot(t,e,s,i){for(let r=0;r<e;r++){if(t[r].y<s.ymin||t[r].y>s.ymax){t[r].setNAN();continue}const n=t[r].x;t[r].x=r_(n,s,i)}}function SL(t,e,s,i){if(t.isEmpty()||s===1)return t;const r=t.getGeometryType();if(r===G.enumPoint){const P=t,I=P.getXY();return VG([I],1,e,s)===0||I.isNAN()?P.setEmpty():P.setXY(I),t}if(r===G.enumMultiPoint){const P=t,I=t.createInstance(),A=P.getPointCount();I.reserve(A);const D=P.getAttributeStreamRef(0),k=P.getDescription().getAttributeCount()>1,R=new nt,O=Float64Array.from(D.getArray());if(VG(O,A,e,s)>0)for(let z=0,q=2*A;z<q;z+=2)Number.isNaN(O[z])||(k?(P.getPointByVal(z>>1,R),R.setXYCoords(O[z],O[z+1]),I.add(R)):I.addXY(O[z],O[z+1]));return I}let n=t;const o=e.getOneDegreeGCSUnit(),a=90*o,l=180*o,u=360*o,c=e.getCentralMeridian(),h=.5*o,m=X.constructEmpty();n.queryEnvelope(m);const f=e.getGCSHorizon(),g=e.getGCSHorisonIsInclusive(),v=f.getGeometryType()===G.enumEnvelope,b=X.constructEmpty();f.queryEnvelope(b);const w=e.getGCS();if(s!==2&&s!==4||(b.xmin=c-l,b.xmax=b.xmin+u),s===4){if(!(m.width()>u-o)){const P=X.constructEmpty();P.setCoords({xmin:m.xmin-o,ymin:b.ymin,xmax:m.xmax+o,ymax:b.ymax}),n=new jb().execute(n,P,w,i);let I=Math.floor((c-m.getCenterX())/u);for(m.move(I*u,0);m.xmin>b.xmax;)I-=1,m.move(-u,0);for(;m.xmin<b.xmin;)I+=1,m.move(u,0);if(I!==0){const A=new Rt;A.setShiftCoords(I*u,0),n.applyTransformation(A)}return n}s=2}if(s===2&&(b.xmin=c-l,b.xmax=b.xmin+u),m.ymin<-a||m.ymax>a){const P=X.constructEmpty();if(P.setCoords({xmin:m.xmin-o,ymin:-a,xmax:m.xmax+o,ymax:a}),n=new jb().execute(n,P,w,i),n.isEmpty())return n;n.queryEnvelope(m)}if(g&&(b.ymax<m.ymin||b.ymin>m.ymax))return n.createInstance();m.width()>u&&(n=EC(n,c-l,u,w,!0,0,!0,i),n.queryEnvelope(m));let S=Uot(m.xmin,m.xmax,b.xmin,b.xmax,u);if(S!==0&&m.move(S,0),m.xmax>b.xmax||m.xmin<b.xmin){if(m.xmax>b.xmax)for(;m.xmin>=b.xmax;)m.move(-u,0),S-=u;for(;m.xmin<b.xmax-u;)m.move(u,0),S+=u}const T=iC(w,f,!1);if(S!==0){const P=new Rt;P.setShiftCoords(S,0),n.applyTransformation(P),S=0}if(g){if(v&&b.containsEnvelope(m))return n;const P=new Array(2);for(let I=0;I<2;I++){let A;if(v?A=xt(r)?ps(n,b,T,h,i):ps(n,b,T,0,i):(A=new u0().execute(n,f,w,i),A===f&&(A=A.clone())),b.xmin<=m.xmin&&b.xmax>=m.xmax||b.xmin>=m.xmin&&b.xmax<=m.xmax)return A;if(P[I]=A,I===0){m.move(-u,0);const D=new Rt;D.setShiftCoords(-u,0),n.applyTransformation(D)}}return xt(r)?P[0].add(P[1],!1):Ce("intersect_with_GCS_horizon: unexpected geometry type"),P[0]}{if(b.ymax<m.ymin||b.ymin>m.ymax)return n;let P=0;for(;!n.isEmpty()&&m.xmax>b.xmin;){if(P!==0){const I=new Rt;I.setShiftCoords(P,0),n.applyTransformation(I)}if(new oB().execute(n,f,w,i)||(n=new ER().execute(n,f,w,i),f===n&&(n=n.clone())),P!==0){const I=new Rt;I.setShiftCoords(-P,0),n.applyTransformation(I)}P-=u,m.move(-u,0)}return n}}function Vot(t,e,s,i,r,n){const o={stack:[],error:void 0,hasError:!1};try{if(n===2)return Nst(t,e,s,i,r);if(Math.abs(s.x-i.x)>=Math.PI||!EL(s.x,i.x,r))return Number.NaN;s.x>i.x&&(i=be(s,s=i));const a=mo(o,new wn,!1),l=mo(o,new wn,!1),u=mo(o,new wn,!1),c=s.clone();Sa.geodeticDistance(t,e,s.x,s.y,i.x,i.y,l,a,null,n);const h=l.val;let m=0,f=1;for(;h*(f-m)>1e-12*t;){const g=.5*(m+f);if(Sa.geodeticCoordinate(t,e,s.x,s.y,h*g,a.val,l,u,n),c.x=l.val,c.y=u.val,c.x===r)return c.y;if(EL(s.x,c.x,r))f=g;else{if(!EL(i.x,c.x,r))return Number.NaN;m=g}}return c.y}catch(a){o.error=a,o.hasError=!0}finally{Od(o)}}function qot(t,e){let s;if(Array.isArray(t)){const i=t;s=new Float64Array(2*e);for(let r=0,n=0;r<e;r++,n+=2)s[n]=i[r].x,s[n+1]=i[r].y}else s=t;return s}function LG(t,e,s,i){for(let r=0,n=0;r<i;r++,n+=2)e[s+r].x=t[n],e[s+r].y=t[n+1]}function VG(t,e,s,i){if(e===0||i===1)return e;const r=qot(t,e);if(i===2){const v=s.getPannableExtentInGCS();let b=e;for(let w=0,S=2*e;w<S;w+=2)(r[w+1]>v.ymax||r[w+1]<v.ymin)&&(r[w]=Number.NaN,b--);return b?(hN(r,e,v.xmin,v.width(),!0),t!==r&&LG(r,t,0,e),b):0}const n=s.getOneDegreeGCSUnit(),o=90*n,a=180*n,l=360*n;let u=e;for(let v=0,b=2*e;v<b;v+=2)(r[v+1]>o||r[v+1]<-o)&&(r[v]=Number.NaN,u--);if(!u)return 0;const c=X.constructEmpty();c.setFromPoints(r,e);const h=s.getGCSHorizon(),m=s.getGCSHorisonIsInclusive(),f=h.getGeometryType()===G.enumEnvelope,g=X.constructEmpty();if(h.queryEnvelope(g),m&&(g.ymax<c.ymin||g.ymin>c.ymax))return 0;if(m)if(hN(r,e,g.getCenterX()-a,l,!0),u=e,f)for(let v=0,b=2*e;v<b;v+=2)g.containsCoords(r[v],r[v+1])||(r[v]=Number.NaN,u--);else{const v=iC(s.getGCS(),h,!1),b=new M;for(let w=0,S=2*e;w<S;w+=2)b.setCoords(r[w],r[w+1]),Bo(h,b,v)!==0||(r[w]=Number.NaN,u--)}else{hN(r,e,-a,l,!0),u=e;const v=iC(s.getGCS(),h,!1),b=new M;for(let w=0,S=2*e;w<S;w+=2){b.setCoords(r[w],r[w+1]),b.isNAN()&&u--;const T=sbe(b.x,g.xmin,g.xmax,l);b.x+=T,Bo(h,b,v)!==0&&(r[w]=Number.NaN,u--)}}return u>0&&Array.isArray(t)&&LG(r,t,0,e),u}function Yb(t,e,s,i,r,n){if(e.isPannable()||ee("fold_into_360_degree_range"),t.isEmpty())return t;let o,a;if(e.getCoordinateSystemType()===2){const l=e.getPannableExtent();a=l.xmin,o=l.width()}else{const l=e.getOneDegreeGCSUnit();o=360*l,a=s-180*l}return EC(t,a,o,e,i,r,!0,n)}function ebe(t,e,s,i){let r,n;if(s.getCoordinateSystemType()===2){const o=s.getPannableExtent();r=o.xmin,n=o.width()}else{const o=s.getOneDegreeGCSUnit();n=360*o,r=i-180*o}hN(t,e,r,n)}function cN(t,e){const s=e.width();let i=og(t-e.vmin,s);return i<0&&(i+=s),e.snapClip(i+e.vmin)}function r_(t,e,s){return t>e.xmax&&t-e.xmax<s?e.xmax:t<e.xmin&&e.xmin-t<s?e.xmin:t}function gD(t,e,s){if(t[0]<e.vmin||t[0]>e.vmax||s&&t[0]===e.vmax){const i=e.width();return t[0]+=Math.ceil((e.vmin-t[0])/i)*i,t[0]=e.snapClip(t[0]),!0}return!1}function Got(t,e,s,i,r,n,o,a,l){return new dD(t,null,s,e,i,r,o,a,n).geoNormalizePolygonGeometry(l)}function zot(t,e,s,i,r,n,o,a,l){return new dD(t,null,s,e,i,r,o,a,n).geoNormalizePolylineGeometry(l)}function tbe(t,e,s,i,r){const n=new oi,o=n.addGeometry(t);return Xb(n,o,e,iC(e,t,!1),s,i,r),n.getGeometry(o)}function Xb(t,e,s,i,r,n,o){const a={stack:[],error:void 0,hasError:!1};try{F(tu()),s.isPannable()||Us("insert_geodetic_points");const l=s.getPannableExtent(),u=s.getGCS(),c=P0();u.querySpheroidData(c);const h=u.getUnit().getUnitToBaseFactor(),m=c.majorSemiAxis,f=c.e2;let g=0;const v=new de;l.queryIntervalX(v);let b=null;const w=Me(4,Number.NaN);s.getCoordinateSystemType()===2?(b=s.getPECoordSys(),n?(w[0]=cN(o,v),w[1]=l.getCenterY(),sn.projToGeog(b,1,w),g=w[0]*h):(w[0]=l.getCenterX(),w[1]=o,sn.projToGeog(b,1,w),g=w[1]*h)):g=o*h,n||g===0||r===2||Us("insert_geodetic_points: 1");const S=mo(a,new wn,!1),T=new M,P=new M,I=new M,A=new M,D=new M,k=new M;for(let R=t.getFirstPath(e);R!==L;R=t.getNextPath(R)){const O=t.getFirstVertex(R);t.queryXY(O,I);let z=!1;const q=t.getNextVertex(O);for(let U=q;U!==L;U=t.getNextVertex(U)){if(U===q){if(z)break;z=!0}if(t.queryXY(U,A),n&&(i<o-I.x&&A.x-o>i||i<o-A.x&&I.x-o>i)||!n&&(o!==0||i<-I.y&&A.y>i||i<-A.y&&I.y>i))do{if(Math.abs(I.x-A.x)>=.5*v.width())break;s.getCoordinateSystemType()===2?(w[0]=cN(I.x,v),w[1]=I.y,w[2]=cN(A.x,v),w[3]=A.y,PR(b,2,w,0),D.x=w[0]*h,D.y=w[1]*h,k.y=w[3]*h):(D.x=I.x*h,D.y=I.y*h,k.y=A.y*h),k.x=(A.x-I.x)*Math.PI*2/v.width()+D.x;let V=0;const B=ne(M,2);if(n){if(P.x=g,P.y=Vot(m,f,D,k,g,r),Number.isNaN(P.y))break;B[0]=P,V=1}else if(r===2){const W=[0,0];if(V=ive(m,f,D,k,g,W),!V)break;B[0].x=W[0],B[0].y=g,V===2&&(B[1].x=W[1],B[1].y=g)}else{if(P.x=yat(m,f,D,k,r),Number.isNaN(P.x))break;P.y=0,B[0]=P,V=1}let H=-1;for(let W=0;W<V;W++){Sa.geodeticDistance(m,f,D.x,D.y,k.x,k.y,S,null,null,r);const ie=S.val;Sa.geodeticDistance(m,f,D.x,D.y,B[W].x,B[W].y,S,null,null,r);const se=S.val;s.getCoordinateSystemType()===2?(w[0]=B[W].x/h,w[1]=B[W].y/h,sn.geogToProj(b,1,w),n?(T.y=w[1],T.x=o):(T.x=Tne(w[0],I.x,A.x,v),T.y=o)):n?(T.x=o,T.y=B[W].y/h):(T.x=Tne(B[W].x/h,I.x,A.x,v),T.y=o);const Z=ie>0?ys(se/ie,0,1):.5;if(Z===0||Z===1||H>Z)continue;const te=t.getPrevVertex(U);t.splitSegment(te,[Z],1);const ve=t.getNextVertex(te);t.setXYCoords(ve,T.x,T.y),H=Z}}while(!1);I.setCoordsPoint2D(A)}}}catch(l){a.error=l,a.hasError=!0}finally{Od(a)}}function Ix(t,e){F(e.isPannable());const s=e.getPannableExtent();if(t.getGeometryType()===G.enumPoint){const a=t.getY();return s.ymin<=a&&a<=s.ymax?t:t.createInstance()}const i=X.constructEmpty();t.queryEnvelope(i);const r=X.constructEmpty();r.setCoords({env2D:s}),r.xmin=i.xmin,r.xmax=i.xmax,r.inflateCoords(.01*r.height(),0);const n=Eg(e,i,!1);let o;return o=r.containsEnvelope(i)?t:ps(t,r,n,0,null),o}function sbe(t,e,s,i){return J_((.5*(s+e)-t)/i)*i}function Uot(t,e,s,i,r){return t>=s&&e<=i?0:sbe(.5*(e+t),s,i,r)}function EC(t,e,s,i,r,n,o,a){const l=t.getGeometryType(),u=de.constructEmpty();u.setCoords(e,e+s);const c=[0];if(l===G.enumPoint){const D=t;if(c[0]=D.getX(),gD(c,u,o)){const k=r?t:t.clone();return k.setX(c[0]),k}return t}const h=X.constructEmpty();if(t.queryEnvelope(h),h.isEmpty())return t;if(l===G.enumMultiPoint){const D=r?t:t.clone(),k=D.getImpl(),R=k.getAttributeStreamRef(0),O=2*k.getPointCount();let z=!1;for(let q=0;q<O;q+=2)c[0]=R.read(q),gD(c,u,o)&&(R.write(q,c[0]),z=!0);return z&&k.notifyModifiedFlags(2001),D}const m=de.constructEmpty();if(h.queryIntervalX(m),u.contains(m))return u.vmax,m.vmax,t;const f=X.constructEmpty();if(f.setCoords({env2D:h}),m.width()===0){let D=m.vmin;D+=Math.ceil((u.vmin-D)/s)*s,D=u.snapClip(D);const k=r?t:t.clone();return k.setAttributeBasic(0,0,D),k}if(l===G.enumEnvelope){const D=r?t:t.clone();return h.intersect(f),D.setEnvelope(h),D}const g=.1*Math.max(h.height(),h.width())*1;f.inflateCoords(0,g);let v=t;const b=i.getTolerance(0),w=new Rt;for(;;){const D=Math.floor((m.vmin-e)/s),k=Math.ceil((m.vmax-e)/s);if(!(k-D>3))break;{const R=Math.floor(.5*(k+D));f.xmin=h.xmin-g,f.xmax=e+s*R;const O=ps(v,f,b,n,a);f.xmin=f.xmax,f.xmax=h.xmax+g;const z=ps(v,f,b,n,a);w.setShiftCoords((R-k)*s,0),z.applyTransformation(w),l===G.enumPolygon?v=new pD().execute(O,z,i,a):(v=O,v.add(z,!1)),v.queryEnvelope(h),h.queryIntervalX(m)}}f.xmin=e,f.xmax=e+s;const S=X.constructEmpty();S.setCoords({env2D:f}),S.inflateCoords(b,0);const T=Math.floor((h.xmin-f.xmin)/s)*s;let P;T?(f.move(T,0),w.setShiftCoords(-T,0)):w.setIdentity(),P=l===G.enumPolyline?new qt({vd:v.getDescription()}):new wt({vd:v.getDescription()});const I=X.constructEmpty(),A=X.constructEmpty();for(;h.xmax>f.xmin;){const D=ps(v,f,b,0,a);D.queryEnvelope(A);let k=!1;k=l===G.enumPolyline?!D.isEmpty()&&(A.width()>b||A.height()>b):!D.isEmpty()&&(l!==G.enumPolygon||A.width()>b),k&&(D.applyTransformation(w),D.queryEnvelope(A),P.queryEnvelope(I),I.inflateCoords(b,b),I.isIntersecting(A)&&l===G.enumPolygon?P=new pD().execute(P,D,i,a):P.add(D,!1)),f.move(s,0),w.shiftCoords(-s,0)}return P}function hN(t,e,s,i,r=!0){const n=new de;n.setCoords(s,s+i);const o=[0];if(Array.isArray(t)){const a=t;for(let l=0;l<e;l++)n.containsRightExclusive(a[l].x)||(o[0]=a[l].x,gD(o,n,r),a[l].x=o[0])}else{const a=t;for(let l=0;l<e;l++){const u=l<<1;n.containsRightExclusive(a[u])||(o[0]=a[u],gD(o,n,r),a[u]=o[0])}}}function yD(t,e,s,i=!0){if(t.isEmpty())return;const r=t.getGeometryType();if(!i||r!==G.enumPolygon)if(zo(r)){let n=!1;if(xt(r)&&t.hasNonLinearSegments()){const o=t.getImpl(),a=o.getAttributeStreamRef(0),l=o.getSegmentFlagsStreamRef();F(l!==null);for(let u=0,c=o.getPathCount();u<c;u++){let h=!0;const m=o.isClosedPath(u),f=o.getPathEnd(u);m&&o.getPathSize(u)>0&&(h=(31&l.read(f-1))===1);for(let g=o.getPathStart(u);g<f;g++)if((31&l.read(g))===1){if(h){const v=a.read(2*g),b=r_(v,e,s);b!==v&&(n=!0,a.write(2*g,b))}h=!0}else h=!1}}else{const o=t.getImpl(),a=o.getAttributeStreamRef(0);for(let l=0,u=o.getPointCount();l<u;l++){const c=a.read(2*l),h=r_(c,e,s);h!==c&&(n=!0,a.write(2*l,h))}}n&&t.getImpl().notifyModifiedFlags(2001)}else if(r===G.enumEnvelope){const n=t,o=X.constructEmpty();n.queryEnvelope(o),o.xmin=r_(o.xmin,e,s),o.xmax=r_(o.xmax,e,s),n.setEnvelope(o)}else if(r===G.enumPoint){const n=t;n.setX(r_(n.getX(),e,s))}else Ce("")}function Bot(t,e,s){const i=new M;return i.x=r_(t.x,e,s),i.y=t.y,i}function jot(t,e){if(e.isEmpty())return 0;const s=t.getPECoordSys();if(s.getProjection().getCode()===We.PE_PRJ_AZIMUTHAL_EQUIDISTANT){const i=P0();t.querySpheroidData(i);const r=s.getParameters();if(r[We.PE_PARM_LAM0]===null||r[We.PE_PARM_PHI0]===null)return 0;const n=[r[We.PE_PARM_LAM0].getValue(),r[We.PE_PARM_PHI0].getValue()];sn.geogToProj(s,1,n);const o=new M(n[0],n[1]),a=X.constructEmpty();e.queryEnvelope(a);const l=ne(M,4);a.queryCorners(l);let u=0;const c=t.getOneMeter();let h=Math.max(i.majorSemiAxis,i.minorSemiAxis)*Math.PI,m=Math.min(i.majorSemiAxis,i.minorSemiAxis)*Math.PI;m-=h/180,h*=c,m*=c;for(let f=0;f<4;f++){const g=M.distance(l[f],o);if(g>h)u++;else if(g>m)return-1}if(u===0)return 1;if(u===4){const f=X.constructEmpty();return f.setCoords({center:o,width:h,height:h}),a.isIntersectingNe(f)?-1:0}return-1}return-1}function mN(t,e,s,i){const r=t.getGeometryType();F(r===G.enumPolygon||r===G.enumPolyline||r===G.enumMultiPoint);const n=e.getCoordinateSystemType();if(n===2){let o=t;if(s===0){const a=jot(e,t);if(a===0)return t.createInstance();if(a===1)return t;const l=e.getPCSHorizon(),u=l.getGeometryType(),c=e.getDefaultPrecisionSR();if(u===G.enumEnvelope){const h=X.constructEmpty();l.queryEnvelope(h);const m=Eg(c,h,!1);o=ps(t,h,m,5e4*e.getOneMeterPCSUnit(),i)}else new nB().execute(l,t,c,i)||(o=new u0().execute(o,l,c,i),o===l&&(o=o.clone()))}else if(e.isPannable()){const a=X.constructEmpty();o.queryEnvelope(a);const l=e.getPannableExtent();l.containsEnvelope(a)||(yD(o,l,e.getTolerance(0)),s!==2&&s!==4||(o=Ix(o,e)),s!==4?o=Yb(o,e,0,!0,1e5*e.getOneMeterPCSUnit(),i):r===G.enumPolygon&&a.width()>2*l.width()&&(o=EC(o,-2*l.width(),2*l.width(),e,!0,0,!0,i)))}return o}if(F(n===1),r===G.enumMultiPoint)return yD(t,e.getPannableExtent(),e.getTolerance(0)),t;{const o=X.constructEmpty();t.queryEnvelope(o);let a=t;const l=e.getPannableExtent();if(o.ymin<l.ymin||o.ymax>l.ymax){const u=Math.max(1,o.calculateToleranceFromEnvelope()),c=new X(o.xmin-u,l.ymin,o.xmax+u,l.ymax);if(a=new jb().execute(a,c,e,i),a.isEmpty())return a}return r===G.enumPolygon&&o.width()>2*l.width()&&(a=EC(a,-2*l.width(),2*l.width(),e,!0,0,!0,i)),a}}function Hot(t,e,s,i,r,n){const o=i.getCoordinateSystemType();if(o===2){if(r===0)s!==t&&j3(s,t,e),Oot(i,s,e);else if(s!==t&&j3(s,t,e),i.isPannable()){const a=i.getTolerance(0);Lot(s,e,i.getPannableExtent(),a),ebe(s,e,i,0)}}else{F(o===1);const a=i.getTolerance(0),l=i.getPannableExtent();for(let u=0;u<e;u++)s[u].assign(Bot(t[u],l,a))}}function Yot(t,e){const s=e.getPointCount();if(!s)return;const i=e.getImpl(),r=i.getAttributeStreamRef(0),n=t;sn.geogToProj(n,s,r.getArray()),i.notifyModifiedFlags(2001)}function CR(t,e,s,i){if(!s)return;const r=t.getPECoordSys();if(s===1){const h=[e[0].x,e[0].y];if(sn.geogToProj(r,1,h),i){const{first:m,second:f}=t.m_peCoordSysVal.getGeogToProjFactors();h[0]=m*(e[0].x-t.getCentralMeridian())+f}return void e[0].setCoords(h[0],h[1])}const n=t.isPannable(),o=n?t.getPannableExtent().width():0,a=179*o/360;let l=0;n&&(l=t.getCentralMeridian());const u=256,c=new Float64Array(2*u);for(let h=0;h<s;){for(let f=h;f<s&&e[f].isNAN();++f)h++;let m=Math.min(u,s-h);if(m>0){for(let f=1,g=h+1;f<m;++f,++g)if(e[g].isNAN()){m=f;break}for(let f=0;f<m;++f){const g=f<<1;c[g]=e[h+f].x,c[g+1]=e[h+f].y}if(sn.geogToProj(r,m,c),i){const{first:f,second:g}=t.m_peCoordSysVal.getGeogToProjFactors();for(let v=0;v<m;++v)c[v<<1]=f*(e[h+v].x-l)+g}if(n)for(let f=0,g=h;f<m;f++,g++){const v=f<<1,b=c[v],w=di(b),S=e[g].x-l;w*di(S)<0&&Math.abs(b)>a&&(c[v]-=w*o)}LG(c,e,h,m),h+=m}}}function Xot(t,e,s,i){const r=t.getSRToGCSTransform();return new eh().transform(r,e,s,i,!1)}function Wot(t,e,s,i){const r=new pi({vd:e.getDescription()});let n;r.addPoints(e,0,-1),n=new eh().execute(r,t,i);const o=e.getPointCount();if(s.setEmpty(),t.getInputSR().isPannable()){if(o!==n.getPointCount())return!1;const a=new X;e.queryEnvelope(a);const l=new X;n.queryEnvelope(l);const u=a.width(),c=l.width();if(u!==0&&c!==0){const h=c/u,m=t.getOutputSR().getPannableExtent().width()/t.getInputSR().getPannableExtent().width();if(Math.abs(h/m-1)>1e-10)return!1}else if(u!==0||c!==0)return!1;s.add(e,!1);for(let h=0;h<o;h++){const m=n.getXY(h);s.setXY(h,m)}return!0}return!1}function ibe(t,e,s){F(!s||t.isPannable());const i=e.getPointCount();if(!i)return;const r=e.getImpl(),n=r.getAttributeStreamRef(0),o=t.getPECoordSys();let a=0;const l=n.readRange(0,2*i);let u=()=>{sn.geogToProj(o,i,l)};const c=t.isPannable()&&!s,h=c?t.getPannableExtent().width():0,m=179*h/360;if(t.isPannable()&&(a=t.getCentralMeridian(),s)){const f=t.m_peCoordSysVal.getGeogToProjFactors(),g=f.first,v=f.second;u=()=>{sn.geogToProj(o,i,l);for(let b=0;b<i;b++){const w=b<<1,S=n.read(w),T=g*(S-a)+v;l[w]=T}}}if(u(),c)for(let f=0;f<i;f++){const g=f<<1,v=l[g],b=di(v),w=n.read(g)-a;b*di(w)<0&&Math.abs(v)>m&&(l[g]+=-b*h)}n.writeRangeFromArray(0,2*i,l,!0,1),r.notifyModifiedFlags(2001)}function Zot(t,e,s){switch(e.getGeometryType()){case G.enumLine:return void hat(t,e,s);case G.enumBezier:return void pat(t,e,s);case G.enumEllipticArc:return void mat(t,e,s);case G.enumBezier2:return void fat();case G.enumRationalBezier2:return void gat();default:Ce("")}}function Cne(t,e,s){if(!e.hasNonLinearSegments())return void ibe(t,e,s);if(F(!s||t.isPannable()),e.isEmpty())return;const i=0,r=t.getPECoordSys(),n=t.isPannable(),o=n?t.getPannableExtent().width():0,a=179*o/360;let l=0;n&&(l=t.getCentralMeridian());const u=e.createInstance();u.reserveParts(e.getPointCount(),e.getPathCount());const c=e.getImpl(),h=new ut;for(let m=0,f=e.getPathCount();m<f;++m)if(c.hasNonLinearSegmentsPath(m)){let g=!0,v=-1;const b=c.getPathStart(m),w=b+c.getSegmentCountPath(m);c.isClosedPath(m)&&(v=w-1);const S=new M;for(let T=b;T<w;++T){if(c.getSegmentBuffer(T,h,!1),Zot(t,h.get(),s),!g&&(h.get().getStartXY().equals(S)||h.get().moveTo(S)),T!==v)u.addSegment(h.get(),g);else{if(g){const P=new nt;h.get().queryStart(P),u.startPathPoint(P)}u.closeLastPathWithSegment(h.get())}S.assign(h.get().getEndXY()),g=!1}}else{let v,b=c.getPathSize(m),w=Math.min(b,1024);u.insertPath(-1,e,m,!0);const S=c.getAttributeStreamRef(0),T=u.getAttributeStreamRef(0);for(let P=c.getPathStart(m),I=c.getPathEnd(m);P<I;){if(v=S.readRange(P,w),sn.geogToProj(r,w,v),n)for(let A=0;A<w;A++){const D=A<<1,k=v[D],R=di(k),O=S.read(2*(i+A))-l;R*di(O)<0&&Math.abs(k)>a&&(v[D]+=-R*o)}T.writeRangeFromArray(P,w,v,!0,1),P+=w,b-=w,w=Math.min(b,1024)}}e.assignMove(u)}function rbe(t,e,s){let r=s.getPointCount();if(!r)return;const n=s.getImpl(),o=n.getAttributeStreamRef(0);let a=Math.min(r,1e3),l=0;const u=t.getPECoordSys();Number.isNaN(e)&&(e=0);const c=t.isPannable(),h=t.getOneDegreeGCSUnit(),m=360*h,f=179*h;let g;for(;r;){if(g=o.readRange(2*l,2*a),PR(u,a,g,e),c)for(let v=0;v<a;v++){const b=v<<1,w=g[b]-e,S=di(w),T=o.read(2*(l+v));S*di(T)<0&&Math.abs(w)>f&&(g[b]+=-S*m)}o.writeRangeFromArray(2*l,2*a,g,!0,1),l+=a,r-=a,a=Math.min(r,1e3)}n.notifyModifiedFlags(2001)}function Qot(t,e,s){switch(s.getGeometryType()){case G.enumLine:return void Jot(t,e,s);case G.enumBezier:return void tat(t,e,s);case G.enumEllipticArc:return void Kot(t,e,s);case G.enumBezier2:return void sat();case G.enumRationalBezier2:return void iat();default:Ce("")}}function Jot(t,e,s){const i=[s.getStartXY(),s.getEndXY()];TR(t,e,i,2),s.setStartXY(i[0]),s.setEndXY(i[1]),s.normalizeAfterEndpointChange()}function Kot(t,e,s){if(s.projectionBehavior()===0)eat(t,e,s);else{const i=s.isClosed()&&s.isMajor(),r=[s.getStartXY(),i?s.getCenter():s.getEndXY()],n=[r[0].clone(),r[1].clone()];uB(t,e,n,2);const o=new Rt;o.initializeFromTwoPointsArray(r,n),s.applyTransformation(o);const a=i?0:1;s.setCoordsForIntersector(n[0],n[a],!1)}}function eat(t,e,s){ube(!1,t,e,s,!1)}function tat(t,e,s){const i=ne(M,4);s.queryControlPoints(i),uB(t,e,i,4),s.setControlPoints(i)}function sat(t,e,s){F(0)}function iat(t,e,s){F(0)}function PR(t,e,s,i){const r=sn.projToGeogCenter(t,e,s,i);for(let n=0;n<e;++n){const o=n<<1;F(Number.isFinite(s[o]+s[o+1]))}return r}function vM(t,e,s){if(!s.hasNonLinearSegments())return void rbe(t,e,s);if(s.isEmpty())return;const i=t.getPECoordSys();Number.isNaN(e)&&(e=0);const r=t.isPannable(),n=t.getOneDegreeGCSUnit(),o=360*n,a=179*n,l=s.createInstance();l.reserveParts(s.getPointCount(),s.getPathCount());const u=s.getImpl(),c=new ut;for(let h=0,m=s.getPathCount();h<m;++h)if(u.hasNonLinearSegmentsPath(h)){let f=!0,g=-1;const v=u.getPathStart(h),b=v+u.getSegmentCountPath(h);u.isClosedPath(h)&&(g=b-1);const w=new M;for(let S=v;S<b;++S){if(u.getSegmentBuffer(S,c,!1),Qot(t,e,c.get()),!f&&(c.get().getStartXY().equals(w)||c.get().moveTo(w)),S!==g)l.addSegment(c.get(),f);else{if(f){const T=new nt;c.get().queryStart(T),l.startPathPoint(T)}l.closeLastPathWithSegment(c.get())}w.assign(c.get().getEndXY()),f=!1}}else{let g,v=u.getPathSize(h),b=Math.min(v,1e3);l.insertPath(-1,s,h,!0);const w=u.getAttributeStreamRef(0),S=l.getAttributeStreamRef(0);for(let T=u.getPathStart(h),P=u.getPathEnd(h);T<P;){if(g=w.readRange(2*T,2*b),PR(i,b,g,e),r)for(let I=0;I<b;I++){const A=I<<1,D=g[A]-e,k=di(D),R=w.read(2*T);k*di(R)<0&&Math.abs(D)>a&&(g[A]+=-k*o)}S.writeRangeFromArray(2*T,2*b,g,!0,1),T+=b,v-=b,b=Math.min(v,1e3)}}s.assignMove(l)}function TR(t,e,s,i){const r=t.getPECoordSys();Number.isNaN(e)&&(e=0);const n=t.isPannable(),o=t.getOneDegreeGCSUnit(),a=360*o,l=179*o,u=256,c=new Float64Array(2*u);for(let h=0;h<i;){for(let f=h;f<i&&s[f].isNAN();++f)h++;let m=Math.min(u,i-h);if(m>0){for(let f=1,g=h+1;f<m;++f,++g)if(s[g].isNAN()){m=f;break}for(let f=0;f<m;f++){const g=f<<1;c[g]=s[h+f].x,c[g+1]=s[h+f].y}if(PR(r,m,c,e),n)for(let f=0,g=h;f<m;++f,++g){const v=f<<1,b=s[g].x,w=c[v]-e,S=di(w);S*di(b)<0&&Math.abs(w)>l&&(c[v]-=S*a)}for(let f=0;f<m;f++){const g=f<<1;s[h+f].x=c[g],s[h+f].y=c[g+1]}h+=m}}}function nbe(t,e,s,i){F(0)}function obe(t,e,s){let i=e.getPointCount();if(!i)return!1;const r=e.getImpl(),n=r.getAttributeStreamRef(0);let o=null;const a=t.getInputSR(),l=t.getOutputSR();a.getVCS(),l.getVCS();const u=a.getOneDegreeGCSUnit(),c=l.getOneDegreeGCSUnit(),h=t.isVertical();h&&e.hasAttribute(1)&&(o=r.getAttributeStreamRef(1));const m=t.getDatumTransformation(),f=!!m&&m.getType()===1;if(f||o===null||(nbe(o.getArray()),o=null),!m||m.count()===0){const O=a.getGcsUnitFactor()/l.getGcsUnitFactor(),z=(a.getPrimeMeridian()-l.getPrimeMeridian())*c,q=-90*u,U=90*u;let V=0;const B=n.getArray(),H=[0];for(let W=1,ie=2*i;W<ie;)H[0]=B[W],V|=q8(H,q,U)?1:0,B[W]=H[0],W+=2;if(z!==0||O!==1){V=1;const W=n.getArray();for(let ie=0,se=2*i;ie<se;){let Z=W[ie];Z*=O,Z+=z,W[ie]=Z,W[ie+1]*=O,ie+=2}}return V!==0&&r.notifyModifiedFlags(2001),!!V}const g=1e3;let v=Math.min(i,g);const b=Me(v,Number.NaN),w=Me(v,Number.NaN);let S=null;o!==null&&(S=new Float64Array(v));let T=0,P=Number.NaN,I=Number.NaN;const A=360*c,D=c/u;s&&(I=90*c,P=89.9*u,w.fill(0));let k=!0,R=0;for(;i;){let O=!1;const z=n.readRange(2*T,2*v);for(let U=0;U<v;U++)b[U]=z[U<<1];if(s)for(let U=0;U<v;U++){const V=1+(U<<1),B=Math.abs(z[V])-P;if(B>0){const H=z[V];z[V]=$d(P,H),w[U]=$d(B,H),O=!0}}const q=z[0];if(f){const U=m;S&&o.queryRange(T,v,S,!0,1),U.transform(!1,z,S,v),S&&o.writeRangeFromArray(T,v,S,!0,1)}else m.transform(!1,z,v);k&&(R=z[0]-D*q,k=!1);for(let U=0;U<v;U++){const V=U<<1,B=z[V]-b[U]*D-R;Math.abs(B)>200&&(z[V]+=B>0?-A:A)}if(O){for(let U=0;U<v;U++)if(w[U]){const V=1+(U<<1);z[V]+=D*w[U],z[V]>I?z[V]=I:z[V]<-I&&(z[V]=-I)}w.fill(0)}n.writeRangeFromArray(2*T,2*v,z,!0,1),h&&o&&o.writeRangeFromArray(T,v,S,!0,1),T+=v,i-=v,v=Math.min(i,g)}return r.notifyModifiedFlags(2001),!0}function rat(t,e,s){switch(e.getGeometryType()){case G.enumLine:return nat(t,e,s);case G.enumBezier:return lat(t,e,s);case G.enumEllipticArc:return oat(t,e,s);case G.enumBezier2:return uat();case G.enumRationalBezier2:return cat();default:Ce("")}}function bM(t,e,s){if(!e.hasNonLinearSegments())return obe(t,e,s);if(e.isEmpty())return!1;const i=e.createInstance();i.reserveParts(e.getPointCount(),e.getPathCount());const r=e.getImpl(),n=new ut;for(let o=0,a=e.getPathCount();o<a;++o){let l=!0,u=-1;const c=r.getPathStart(o),h=c+r.getSegmentCountPath(o);r.isClosedPath(o)&&(u=h-1);const m=new M;for(let f=c;f<h;++f){if(r.getSegmentBuffer(f,n,!1),rat(t,n.get(),s),!l&&(n.get().getStartXY().equals(m)||n.get().moveTo(m)),f!==u)i.addSegment(n.get(),l);else{if(l){const g=new nt;n.get().queryStart(g),i.startPathPoint(g)}i.closeLastPathWithSegment(n.get())}m.assign(n.get().getEndXY()),l=!1}}return e.assignMove(i),!0}function Pne(t,e,s,i,r,n){if(t.isIdentityGeogToGeog()){const q=90*t.getInputSR().getOneDegreeGCSUnit();let U=0;const V=[0];for(let B=0;B<i;B++)V[0]=e[B].y,U|=q8(V,-q,q)?1:0,e[B].y=V[0];return U}const o=t.getInputSR(),a=t.getOutputSR(),l=o.getVCS(),u=a.getVCS(),c=o.getOneDegreeGCSUnit(),h=90*c,m=a.getOneDegreeGCSUnit(),f=t.isVertical(),g=t.getDatumTransformation(),v=!!g&&g.getType()===1;if(f||(s=null),!g||g.count()===0){let q=0;const U=[0];for(let V=0;V<i;V++)U[0]=e[V].y,q|=q8(U,-h,h)?1:0,e[V].y=U[0];return q|=Jve(o.getGCS(),l,a.getGCS(),u,e,s,i)?1:0,q}v||s===null||nbe();const b=1024;let w=Math.min(i,b);const S=Me(w,Number.NaN),T=Me(w,Number.NaN);let P=0,I=Number.NaN,A=Number.NaN;const D=360*m,k=m/c;r&&(A=90*m,I=89.9*c);let R=!0,O=0,z=i;for(;z;){let q=!1;for(let V=0;V<w;V++)S[V]=e[V+P].x;if(r)for(let V=0;V<w;V++){const B=Math.abs(e[V+P].y)-I;if(B>0){const H=e[V+P].y;e[V+P].y=$d(I,H),T[V]=$d(B,H),q=!0}}const U=e[0].x;v?g.transform(!1,e,s,w):g.transform(!1,e,w),R&&(O=e[0].x-k*U,R=!1);for(let V=0;V<w;V++){const B=e[P+V].x-S[V]*k-O;Math.abs(B)>200&&(B>0?e[P+V].x-=D:e[P+V].x+=D)}if(q){for(let V=0;V<w;V++)T[V]&&(e[P+V].y+=k*T[V],e[P+V].y>A?e[P+V].y=A:e[P+V].y<-A&&(e[P+V].y=-A));T.fill(0,0,w)}P+=w,z-=w,w=Math.min(z,b)}return 1}function abe(t,e,s,i,r){return F(0),0}function lbe(t,e,s,i,r){F(i===null),F(e<2147483647);const n=Array.isArray(s);let o;o=n?jJe(s):s;const a=HG.geogToGeog(t,e,o,null,r);return n&&BJe(o,s),a}function c0(t,e,s,i,r,n){let o=0,a=!0,l=0;for(let u=0;u<i;++u)e[u].isNAN()?a||(o|=Pne(t,e.slice(l,u-l),s?s.slice(l,u-l):null,u-l,r),l=u,a=!0):a&&(l=u,a=!1);return a||(o|=Pne(t,l===0?e:e.slice(l),s?l===0?s:s.slice(l):null,i-l,r)),o!==0}function nat(t,e,s){const i=[e.getStartXY(),e.getEndXY()],r=[0,0];let n=null;e.hasAttribute(1)&&(n=r,n[0]=e.getAttributeAsDbl(0,1,0),n[1]=e.getAttributeAsDbl(1,1,0));const o=c0(t,i,n,2,s);return e.setStartXY(i[0]),e.setEndXY(i[1]),n&&(e.setStartAttribute(1,0,n[0]),e.setEndAttribute(1,0,n[1])),e.normalizeAfterEndpointChange(),o}function oat(t,e,s){if(e.projectionBehavior()===0)return aat(t,e,s);const i=e.getStartXY().equals(e.getEndXY()),r=ne(M,3),n=ne(M,3),o=[0,0,0];let a=null;r[0].assign(e.getStartXY()),r[1].assign(i?e.getCenter():e.getEndXY());let l=!1;e.hasAttribute(1)&&(a=o,a[0]=e.getAttributeAsDbl(0,1,0),a[1]=e.getAttributeAsDbl(1,1,0),a[2]=zt(a[0],a[1],.5),i&&(a[1]=a[2])),n[0].setCoordsPoint2D(r[0]),n[1].setCoordsPoint2D(r[1]);const u=new Rt;if(i||e.isDegenerateToLine())l=c0(t,n,a,2,s),u.initializeFromTwoPoints(r[0],r[1],n[0],n[1]);else{const c=new M;e.queryCoord2D(.5,c),r[2].setCoordsPoint2D(c),n[2].setCoordsPoint2D(c),l=c0(t,n,a,3,s),u.setFromTwoTriangles(r,n)}return u.isIdentity()||(e.applyTransformation(u),e.setStartXY(n[0]),e.setEndXY(i?n[0]:n[1]),e.normalizeAfterEndpointChange()),a&&(e.setStartAttribute(1,0,a[0]),e.setEndAttribute(1,0,i?a[0]:a[1])),l}function aat(t,e,s){const i=[e.getStartXY(),e.getEndXY(),e.getInteriorPoint(),e.getCenter()];let r=4;e.isDegenerateToLine()&&(r=2);const n=[0,0,0,0];let o=null;if(e.hasAttribute(1)){o=n,o[0]=e.getAttributeAsDbl(0,1,0),o[1]=e.getAttributeAsDbl(1,1,0);const u=zt(o[0],o[1],.5);o[2]=u,o[3]=u}const a=e.getStartXY().equals(e.getEndXY())&&!e.isDegenerateToLine(),l=c0(t,i,o,r,s);return a?e.constructCircleCenterAndPoint(i[3],i[0],!e.isClockwise()):e.isDegenerateToLine()?e.constructLineCircularArc(i[0],i[1]):e.constructCircularArcThreePoint(i[0],i[1],i[2]),o&&(e.setStartAttribute(1,0,o[0]),e.setEndAttribute(1,0,o[1])),l}function lat(t,e,s){const i=ne(M,4);e.queryControlPoints(i);const r=[0,0,0,0];let n=null;e.hasAttribute(1)&&(n=r,n[0]=e.getAttributeAsDbl(0,1,0),n[3]=e.getAttributeAsDbl(1,1,0),n[1]=zt(n[0],n[3],.5),n[2]=n[1]);const o=c0(t,i,n||null,i.length,s);return e.setControlPoints(i),n&&(e.setStartAttribute(1,0,n[0]),e.setEndAttribute(1,0,n[3])),e.normalizeAfterEndpointChange(),o}function uat(t,e,s){return F(0),!1}function cat(t,e,s){return F(0),!1}function hat(t,e,s){const i=[e.getStartXY(),e.getEndXY()];CR(t,i,2,s),e.setStartXY(i[0]),e.setEndXY(i[1]),e.normalizeAfterEndpointChange()}function lB(t,e,s,i){CR(t,e,s,i)}function mat(t,e,s){if(e.projectionBehavior()===0)dat(t,e,s);else{const i=e.isClosed()&&e.isMajor(),r=[e.getStartXY(),i?e.getCenter():e.getEndXY()],n=[r[0].clone(),r[1].clone()];lB(t,n,2,s);const o=new Rt;o.initializeFromTwoPointsArray(r,n),e.applyTransformation(o);const a=i?0:1;e.setCoordsForIntersector(n[0],n[a],!1)}}function uB(t,e,s,i){TR(t,e,s,i);const r=new X;r.setFromPoints(s,i);const n=t.getOneDegreeGCSUnit(),o=360*n,a=180*n;if(r.width()>a){for(let l=0;l<i;l++)for(;s[l].x<e;)s[l].x+=o;if(r.setFromPoints(s,i),r.xmax>a+e)for(let l=0;l<i;l++)s[l].x-=o}}function ube(t,e,s,i,r){const n=ne(M,3);let o=0,a=!1,l=!1;const u=i.isDegenerateToLine();u?(n[0].assign(i.getStartXY()),n[1].assign(i.getEndXY()),n[2].setCoords(0,0),o=2):i.isClosed()&&i.isMajor()?(a=!0,l=!i.isClockwise(),n[0].assign(i.getStartXY()),n[1].assign(i.getCenter()),n[2].setCoords(0,0),o=2):(n[0].assign(i.getStartXY()),n[1].assign(i.getEndXY()),n[2].assign(i.getInteriorPoint()),o=3),t?lB(e,n,o,r):uB(e,s,n,o),u?i.constructLineCircularArc(n[0],n[1]):a?i.constructCircleCenterAndPoint(n[1],n[0],l):i.constructCircularArcThreePoint(n[0],n[1],n[2])}function dat(t,e,s){ube(!0,t,0,e,s)}function pat(t,e,s){const i=ne(M,4);e.queryControlPoints(i),lB(t,i,4,s),e.setControlPoints(i)}function fat(t,e,s){F(0)}function gat(t,e,s){F(0)}function EL(t,e,s){const i=oN(t),r=oN(e),n=cre(i,r),o=cre(i,oN(s));return o===0||n>0&&o>0&&o<=n||n<0&&o<0&&o>=n}function yat(t,e,s,i,r){const n={stack:[],error:void 0,hasError:!1};try{const o=s.clone(),a=i.clone();if(r===2){const b=[0,0];return ive(t,e,o,a,0,b),b[0]}if(o.y>a.y){const b=new M;b.assign(o),o.assign(a),a.assign(b)}const l=mo(n,new wn,!1),u=mo(n,new wn,!1),c=mo(n,new wn,!1),h=new de;if(h.setCoords(o.y,a.y),!h.containsCoordinate(0)||Math.abs(o.x-a.x)>=Math.PI)return Number.NaN;if(o.x===a.x)return o.x;Sa.geodeticDistance(t,e,o.x,o.y,a.x,a.y,u,l,null,r);const m=u.val;let f=0,g=1;const v=o.clone();for(;m*(g-f)>1e-12*t;){const b=.5*(f+g);if(Sa.geodeticCoordinate(t,e,o.x,o.y,m*b,l.val,u,c,r),v.x=u.val,v.y=c.val,h.setCoords(o.y,v.y),v.y===0)return v.x;if(h.containsCoordinate(0))g=b;else{if(h.setCoords(a.y,v.y),!h.containsCoordinate(0))return F(!1),Number.NaN;f=b}}return v.x}catch(o){n.error=o,n.hasError=!0}finally{Od(n)}}function Tne(t,e,s,i){const r=new de;r.setCoords(e,s);const n=i.width();let o=Math.floor((t-e)/n)*n+t;const a=r.getCenter();for(;Math.abs(o-a)>Math.abs(o+n-a);)o+=n;return o}class cbe extends nm{constructor(){super(),this.m_geometryDeque=[],this.m_index=-1}next(){if(this.m_geometryDeque.length>0){this.m_index++;const e=this.m_geometryDeque[0];return this.m_geometryDeque.shift(),e}return null}getGeometryID(){return this.m_index}tick(e){this.m_geometryDeque.push(e)}tock(){return!0}getRank(){return 1}}function _at(t,e){return t===e||t!==null&&e!==null&&t.m_csType===e.m_csType&&(t.m_WKID===0&&e.m_WKID===0?t.m_hashCode===e.m_hashCode&&t.m_canonicalWkt===e.m_canonicalWkt:t.m_WKID===e.m_WKID)}function vat(t,e){return t===e||t!==null&&e!==null&&t.m_csType===e.m_csType&&(t.m_WKID===0&&e.m_WKID===0?t.m_csType===1?t.m_peCoordSys.isEqual(e.m_peCoordSys):t.m_peCoordSys===e.m_peCoordSys:t.m_WKID===e.m_WKID)}class cB{constructor(e,s=!0){this.m_PCSHorizon=null,this.m_GCSHorizon=null,this.m_GCSSplitLines=null,this.m_bGCSHorisonIsInclusive=!1,this.m_oneMeterPCS=0,this.m_oneDegreeGCS=0,this.m_gcsUnitFactor=0,this.m_northPole=M.getNAN(),this.m_southPole=M.getNAN(),this.m_polesUpdated=0,this.m_domain=X.constructEmpty(),this.m_primeMeridian=Number.NaN,this.m_geogToProjFactor=1,this.m_geogToProjOffset=0,this.m_geogToProjFactorsUpdated=0,this.m_oneMillimeter=0,this.m_centralMeridian=0,this.m_pPCSInfoNoDomain=null,this.m_oldWKID=-1973,this.m_vcsWKID=-1,this.m_bIsPannable=!1,this.m_bCached=!1,this.m_pannableExtent=X.constructEmpty(),this.m_pannableExtentGCS=X.constructEmpty(),this.m_areaOfUse=null,this.m_canonicalWkt="",this.m_peCoordSys=e,this.m_WKID=Ki.getCode(e),this.m_WKID<=0?(this.m_WKID=0,this.m_canonicalWkt=aB(e,0,!0),this.m_hashCode=q0e(this.m_canonicalWkt)):this.m_hashCode=ub(this.m_WKID);const i=this.m_peCoordSys.getType();this.m_csType=i===We.PE_TYPE_PROJCS?2:1,F(i===We.PE_TYPE_PROJCS||i===We.PE_TYPE_GEOGCS),i===We.PE_TYPE_PROJCS&&(e.loadConstants()||ee("PeProjcs.loadConstants failed"));const r=i===We.PE_TYPE_GEOGCS?this.m_peCoordSys:this.m_peCoordSys.getGeogcs();i!==We.PE_TYPE_GEOGCS&&Ki.getCode(r),this.m_unit=bst(e),this.m_primeMeridian=r.getPrimem().getLongitude();{const n=r.getUnit().getUnitFactor();this.m_gcsUnitFactor=n;let o=Math.PI/(180*n);Math.abs(o-1)<1e-10&&(o=1),this.m_oneDegreeGCS=o}if(i===We.PE_TYPE_PROJCS){const n=this.m_peCoordSys,o=n.getUnit().getUnitFactor();this.m_oneMeterPCS=1/o,this.m_oneMillimeter=.001/o,this.m_pPCSInfoNoDomain=Kr.generate(n,Kr.PE_PCSINFO_OPTION_NONE),this.m_pPCSInfoNoDomain||Ce("cannot create pcs info"),this.m_bIsPannable=this.m_pPCSInfoNoDomain.isPannableRectangle(),this.m_centralMeridian=this.m_pPCSInfoNoDomain.getCentralMeridian()}else{this.m_bIsPannable=!0,this.m_polesUpdated=1,this.m_oneMeterPCS=0;const n=1/r.getUnit().getUnitFactor(),o=r.getDatum().getSpheroid().getAxis();this.m_oneMillimeter=.001/o*n,this.m_centralMeridian=0}this.m_bIsPannable&&(this.updateGCSHorizon(),this.updatePCSHorizon(),this.updatePoles(),this.updateDomain(),this.updatePannableExtent(),this.updatePannableExtentGCS())}[Symbol.dispose](){}getHashCode(){return this.m_hashCode}getPCSHorizonPannable(){return this.m_PCSHorizon}getGCSHorizonPannable(){return this.m_GCSHorizon}getPCSInfo(){return F(this.m_pPCSInfoNoDomain),this.m_pPCSInfoNoDomain}getCentralMeridian(){return this.m_centralMeridian}updateGCSHorizon(){if(this.m_peCoordSys.getType()!==We.PE_TYPE_PROJCS)return;let e=!0;const s=this.m_peCoordSys,i=s.getGeogcs(),r=s.horizonGcsGenerate();if(!r)return;F(r.length>0);const n=r[0].getNump(),o=r[0].getKind();let a,l;e=r[0].getInclusive()>0;const u=this.getOneDegreeGCSUnit(),c=90*u,h=360*u,m=370*u,f=180*u*We.PE_HORIZON_DELTA/Math.PI,g=X.constructEmpty();let v=null;if(n>1){for(let b=1;b<n;b++)if(r[b].getKind()===We.PE_HORIZON_LINE){v||(v=new qt);const w=r[b].getCoord();v.startPathCoords(w[0][0],w[0][1]),v.lineToCoords(w[1][0],w[1][1])}}if(o===We.PE_HORIZON_RECT){const b=r[0].getCoord();if(g.setFromPoints([new M(b[0][0],b[0][1]),new M(b[1][0],b[1][1])],2),Math.abs(g.ymax-c)<1e-7*f&&(g.ymax=c),Math.abs(g.ymin+c)<1e-7*f&&(g.ymin=-c),g.width()>m){const S=-400*u,T=S+5*h;g.setCoords({xmin:S,ymin:g.ymin,xmax:T,ymax:g.ymax})}const w=new Sn({env2D:g});this.m_GCSHorizon||(this.m_GCSHorizon=w,this.m_bGCSHorisonIsInclusive=e)}else{let b=this.getPCSInfo().isGcsHorizonMultiOverlap();const w=PC(i,null,null,1),S=[],T=new de;for(let k=0;k<n;k++){if(r[k].getKind()!==We.PE_HORIZON_POLY)continue;a=r[k].getSize();const R=r[k].getCoord(),O=X.constructEmpty();O.setFromPoints(M1(R),a),S.push(new de(O.xmin,O.xmax)),O.width(),T.merge(S.at(-1))}let P=!1;const I=new de;T.width()>h&&S.length>1?(I.vmin=this.getCentralMeridian()-h,I.vmax=I.vmin+2*h,P=!0,b=!0):(I.vmin=T.vmin,I.vmax=I.vmin+h);const A=k=>{let R=0;for(;S[k].vmin+R<I.vmin;)R+=h;for(;S[k].vmax+R-h>I.vmin;)R-=h;return R};let D=new wt;if(b){const k=new cbe,R=new pD().executeMany(k,w,null);for(let O=0;O<n;O++){if(r[O].getKind()!==We.PE_HORIZON_POLY)continue;a=r[O].getSize();const z=r[O].getCoord();l=r[O].getInclusive()>0;const q=new wt;if(q.addPathPoint2D(M1(z),a-1,!0),P){const U=A(O),V=S[O].clone();V.move(U);let B=U;const H=new Rt;do{H.setShiftCoords(B,0);const W=q.clone();W.applyTransformation(H),k.tick(W),k.tock(),B+=h,V.move(h)}while(V.vmin<I.vmax)}else k.tick(q),R.tock()}D=R.next()}else{D=new wt;for(let k=0;k<n;k++){if(r[k].getKind()!==We.PE_HORIZON_POLY)continue;a=r[k].getSize();const R=r[k].getCoord();if(l=r[k].getInclusive()>0,F(l===e),P){const O=new wt;O.addPathPoint2D(M1(R),a-1,!0);const z=A(k),q=S[k].clone();q.move(z);let U=z;const V=new Rt;do{if(U!==0){V.setShiftCoords(U,0);const B=new wt({copy:O});B.applyTransformation(V),D.addPath(B,0,!0)}else D.addPath(O,0,!0);U+=h,q.move(h)}while(q.vmin<I.vmax)}else D.addPathPoint2D(M1(R),a-1,!0)}}P&&(D=new jb().execute(D,new X(I.vmin,-c-u,I.vmax,c+u),w,null)),e?new u0().accelerateGeometry(D,w,1):new ER().accelerateGeometry(D,w,1),new oB().accelerateGeometry(D,w,1),this.m_GCSHorizon===null&&(this.m_GCSHorizon=D,this.m_bGCSHorisonIsInclusive=e,this.m_GCSSplitLines=v)}}updateAreaOfUse(){return null}updatePCSHorizon(){if(this.m_peCoordSys.getType()!==We.PE_TYPE_PROJCS)return;const e=this.m_peCoordSys.horizonPcsGenerate();if(!e)return;let s;this.getPCSInfo();const i=e[0].getKind();e[0].getInclusive();const r=X.constructEmpty(),n=e[0].getNump();let o=!1;if(i===We.PE_HORIZON_RECT){const a=e[0].getCoord();r.setFromPoints(M1(a),2),s=new Sn({env2D:r})}else{let a=-1;for(let h=0;h<n;h++)e[h].getKind()===We.PE_HORIZON_POLY&&(a=h);F(a>=0);const l=e[a].getSize()-1,u=e[a].getCoord(),c=new wt;s=c,c.addPathPoint2D(M1(u),l,!0),o=!0}if(this.getPCSInfo().isDensificationNeeded()){F(i!==We.PE_HORIZON_RECT);const a=1e5*this.getOneMeterPCSUnit();s=new i_().execute(s,a,0,0,null)}if(o){{const a=new Sn;s.queryEnvelope(a),s.calculateArea2D(),s.calculateLength2D(),s.getExteriorRingCount()}new u0().accelerateGeometry(s,null,1)}this.m_PCSHorizon===null&&(this.m_PCSHorizon=s)}updatePannableExtent(){const e=this.m_peCoordSys.getType();if(e===We.PE_TYPE_PROJCS){const s=this.m_peCoordSys,i=this.getPCSInfo().getCentralMeridian(),r=s.getGeogcs();r||Ce("");const n=[i+1/r.getUnit().getUnitFactor()*Math.PI,0];sn.geogToProj(s,1,n);const o=n[0],a=s.getParameters()[We.PE_PARM_X0].getValue(),l=this.getPCSHorizon(),u=X.constructEmpty();l.queryEnvelope(u);const c=Math.abs(o-a),h=c+a,m=-1*c+a,f=u.ymax,g=u.ymin;this.m_pannableExtent.setCoords({xmin:m,ymin:g,xmax:h,ymax:f})}else if(e===We.PE_TYPE_GEOGCS){const s=1/this.m_peCoordSys.getUnit().getUnitFactor()*Math.PI;this.m_pannableExtent.setCoords({xmin:-s,ymin:-s/2,xmax:s,ymax:s/2})}else Ce("")}updatePannableExtentGCS(){const e=this.m_peCoordSys.getType();if(e===We.PE_TYPE_PROJCS){const s=this.m_peCoordSys,i=this.m_centralMeridian,r=s.getGeogcs();r||Ce("");const n=1/r.getUnit().getUnitFactor()*Math.PI,o=this.getGCSHorizon(),a=X.constructEmpty();o.queryEnvelope(a),this.m_pannableExtentGCS.setCoords({xmin:i-n,ymin:a.ymin,xmax:i+n,ymax:a.ymax})}else if(e===We.PE_TYPE_GEOGCS){const s=1/this.m_peCoordSys.getUnit().getUnitFactor()*Math.PI;this.m_pannableExtentGCS.setCoords({xmin:-s,ymin:-s/2,xmax:s,ymax:s/2})}else Ce("")}updateDomain(){if(this.m_csType===1){const e=400*this.getOneDegreeGCSUnit();this.m_domain=X.construct(-e,-e,e,e)}else{F(this.m_csType===2);const e=Kr.generate(this.m_peCoordSys,Kr.PE_PCSINFO_OPTION_DOMAIN);e||Ce("generate pcs info failed");const s=new X(e.getDomainMinx(),e.getDomainMiny(),e.getDomainMaxx(),e.getDomainMaxy());this.m_domain.isEmpty()&&this.m_domain.setCoords({env2D:s})}}updatePoles(){if(this.m_peCoordSys.getType()===We.PE_TYPE_PROJCS){const e=90*this.getOneDegreeGCSUnit(),s=[[0,e],[0,-e]];sn.geogToProj(this.m_peCoordSys,2,s);const i=this.getPCSInfo().getNorthPoleLocation()!==Kr.PE_POLE_OUTSIDE_BOUNDARY,r=this.getPCSInfo().getSouthPoleLocation()!==Kr.PE_POLE_OUTSIDE_BOUNDARY;this.m_polesUpdated||(i&&this.m_northPole.setCoords(s[0][0],s[0][1]),r&&this.m_southPole.setCoords(s[1][0],s[1][1]),this.m_polesUpdated=1)}else this.m_polesUpdated=1}updateGeogToProjFactors(){if(this.m_peCoordSys.getType()===We.PE_TYPE_PROJCS){const e=this.getOneDegreeGCSUnit(),s=this.m_pPCSInfoNoDomain.getCentralMeridian(),i=[0,0,0,0];i[0]=s,i[1]=0,i[2]=s+e,i[3]=0;const r=sn.geogToProj(this.m_peCoordSys,2,i);F(r===2);const n=(i[2]-i[0])/e,o=i[0];this.m_geogToProjFactorsUpdated===0&&(this.m_geogToProjFactor=n,this.m_geogToProjOffset=o,this.m_geogToProjFactorsUpdated=1)}else this.m_geogToProjFactorsUpdated=1}getOneMeterPCSUnit(){return this.m_oneMeterPCS}getOneDegreeGCSUnit(){return this.m_oneDegreeGCS}getGcsUnitFactor(){return this.m_gcsUnitFactor}getUnitsPerMillimeter(){return this.m_oneMillimeter}getGCSSplitLines(){return this.m_bIsPannable?null:(this.m_GCSHorizon||this.updateGCSHorizon(),this.m_GCSSplitLines)}getGCSHorizon(){return this.m_bIsPannable?this.getGCSHorizonPannable():(this.m_GCSHorizon!==null||this.updateGCSHorizon(),this.m_GCSHorizon)}getGCSHorisonIsInclusive(){return this.m_bIsPannable||this.getGCSHorizon(),this.m_bGCSHorisonIsInclusive}getPCSHorizon(){return this.m_bIsPannable?this.getPCSHorizonPannable():(this.m_PCSHorizon!==null||this.updatePCSHorizon(),this.m_PCSHorizon)}getPole(e){return this.m_bIsPannable||this.m_polesUpdated!==0||this.updatePoles(),e?this.m_southPole:this.m_northPole}getGeogToProjFactors(){return this.m_geogToProjFactorsUpdated===0&&this.updateGeogToProjFactors(),Zi(this.m_geogToProjFactor,this.m_geogToProjOffset)}getDomainXY(){if(this.m_bIsPannable)return this.m_domain.clone();let e=!1;return e=this.m_domain.isEmpty(),e&&this.updateDomain(),this.m_domain.clone()}getPrimeMeridian(){return this.m_primeMeridian}getLatestID(){return this.m_WKID}getOldID(){let e=this.m_oldWKID;if(e<0){if(e=0,this.m_WKID>0){const s=[0],i=[0];Xat(this.m_peCoordSys.getType(),this.m_WKID,s,i)||Ce("query_code_change"),e=s[0]}this.m_oldWKID=e}return e}isCustomWkid(){return!1}isPannable(){return this.m_bIsPannable}getPannableExtent(){return this.m_pannableExtent.clone()}getPannableExtentGCS(){return this.m_pannableExtentGCS.clone()}getAreaOfUse(){return this.m_areaOfUse!==null?this.m_areaOfUse:this.updateAreaOfUse()}getVcsCode(){return 0}saveMemory(){}getCSType(){return this.m_csType}getUnit(){return this.m_unit}setCached(){this.m_bCached=!0}getCached(){return this.m_bCached}static equal(e,s){return!1}static equal_for_projection(e,s){return!1}}class bat{constructor(e,s=!0){this.m_oneMeter=0,this.m_WKID=-1,this.m_oldWKID=-1,this.m_canonicalWkt="not yet implemented",this.m_model=0,this.m_unit=new Fd,this.m_cached=!1}setCached(e=!0){this.m_cached=e}getCached(){return this.m_cached}getOneMeterUnit(){return 0}getLatestID(){return this.m_WKID}getOldID(){let e=this.m_oldWKID;return e<0&&(e=0,this.m_WKID>0&&(e=this.m_WKID),this.m_oldWKID=e),e}getModel(){return 0}isCustomWkid(){return!1}getVerticalUnit(){return this.m_unit}static equal(e,s){return!1}static equal_for_projection(e,s){return!1}}function xat(t,e,s){return hbe(t,e,X.constructEmpty(),s)}function hbe(t,e,s,i){return wat(!0,t,e,s,i)}function N_(t,e,s,i){return hB(!0,t,e,s,i)}function wat(t,e,s,i,r){return tu()||iR("cannot create projection transformation"),e.hasVCS()&&s.hasVCS()?Sat():Eat(e,s,i,r)}function hB(t,e,s,i,r,n){return tu()||iR("cannot create projection transformation"),new pB(t?2:1,e,s,i,r,n)}function mbe(t,e,s,i,r,n=!1){if(e&&s||ee(""),tu()||iR("cannot obtain geotransformation list"),t===1&&e.hasVCS()&&s.hasVCS())return yt("hv xform not impl"),[];{const o=Ebe(e,s,i,r,n),a=[];for(const l of o)a.push(l);return a}}function mB(){return{centralMeridianOfOutputGCS:Number.NaN,densificationStep:Number.NaN,clipWithInputHorizon:!0,clipWithOutputHorizon:!0,legacyHorizonClipping:!1,normalizeResultGeometry:!1,equals(t){return uo(this.centralMeridianOfOutputGCS,t.centralMeridianOfOutputGCS)&&uo(this.densificationStep,t.densificationStep)&&this.clipWithInputHorizon===t.clipWithInputHorizon&&this.clipWithOutputHorizon===t.clipWithOutputHorizon&&this.legacyHorizonClipping===t.legacyHorizonClipping&&this.normalizeResultGeometry===t.normalizeResultGeometry}}}function Sat(t,e,s,i){return F(0),{}}function Eat(t,e,s,i){t&&e||ee("!inputSR || !outputSR");const r=t.getLatestID(),n=e.getLatestID();if(r===3857&&n===4326){if(t.m_bDefaultDescriptor&&e.m_bDefaultDescriptor)return pbe()}else if(r===4326&&n===3857&&t.m_bDefaultDescriptor&&e.m_bDefaultDescriptor)return Dat();const o=X.constructEmpty();o.setCoords({env2D:s});const a=t.getCoordinateSystemType(),l=e.getCoordinateSystemType();if(a===0||l===0)return xM(t,e);if(i){const f=i.find(0,t.getGCS(),e.getGCS());if(f)return xM(t,e,f)}const u=t.getGCS().getLatestID(),c=e.getGCS().getLatestID();if(u>0&&u===c)return xM(t,e);const h=new Mat(t,e,s);{const f=Aat(h);if(f)return f}const m=mbe(0,t,e,o,1,!0);return Nat(h,xM(t,e,m.length?m[0]:void 0))}function xM(t,e,s,i,r){return new pB(1,t,e,s,i,r)}function dB(){return{flagsMask:0,setFlag(t,e){e?this.flagsMask|=t:this.flagsMask&=~t},hasFlag(t){return!!(this.flagsMask&t)}}}function qG(){return{m_extendedParams:mB(),m_extendedParamsInternal:dB()}}function CL(){return qG()}let pB=class dbe{constructor(e,s,i,r,n,o){let a,l;this.m_datumTran=null,this.m_bIdentity=!0,this.m_bIdentityGeogToGeog=!0,this.m_bVertical=!1,this.m_bNormalize=!1,s&&i||ee("!inputSR || !outputSR"),r&&r.getType()===0&&(r.m_bReadOnly=!0),this.m_bNormalize=!1,e!==1&&(a=s.getVCS(),l=i.getVCS(),this.m_bVertical=a!=null&&l!=null),this.m_inputSR=s,this.m_outputSR=i,this.m_bIdentity=!1,this.m_bIdentityGeogToGeog=!1,F(!this.m_params),n&&(this.m_params=qG(),this.m_params.m_extendedParams=n),o&&(this.m_params||(this.m_params=qG()),this.m_params.m_extendedParamsInternal=o);let u=!1;const c=r!=null,h=s.getCoordinateSystemType(),m=i.getCoordinateSystemType();if(i.isPannable()&&h!==0&&n){const v=n.centralMeridianOfOutputGCS;if(!Number.isNaN(v)&&i.isPannable()){const b=i.getPannableExtent(),w=b.getCenterX();if(w!==v){const S=Math.ceil(b.width());v+S!==w+S&&(u=!0)}}}const f=n&&n.normalizeResultGeometry;if(s.equals(i))return this.m_bIdentity=!u,this.m_bIdentityGeogToGeog=!0,void this.updateProjector();const g=!c&&s.equalForProjection(i,this.m_bVertical);this.m_bIdentity=g&&!u,this.m_bIdentity?this.m_bIdentityGeogToGeog=!0:h!==0&&m!==0&&(f&&this.m_outputSR.isPannable()&&(this.m_bNormalize=f),this.m_datumTran=r||null,this.m_bIdentityGeogToGeog=(!this.m_datumTran||this.m_datumTran.count()===0)&&this.m_inputSR.getGCS().equalForProjection(this.m_outputSR.getGCS(),this.m_bVertical)),this.updateProjector()}getInputSR(){return this.m_inputSR}getOutputSR(){return this.m_outputSR}getDatumTransformation(){return this.m_datumTran}getInverse(){var s;const e=new dbe(1,this.m_outputSR,this.m_inputSR,(s=this.m_datumTran)==null?void 0:s.createInverse());return e.m_bIdentity=this.m_bIdentity,e.m_bVertical=this.m_bVertical,e.m_bIdentityGeogToGeog=this.m_bIdentityGeogToGeog,e.updateProjector(),e}isIdentity(){return this.m_bIdentity}getExtendedParams(){return this.m_params?this.m_params.m_extendedParams:CL().m_extendedParams}equals(e){return F(0),!1}isVertical(){return this.m_bVertical}isMatchingTransformation(e,s){return F(0),!1}getGeographicTransformations(){return this.m_datumTran}getExtendedParamsImpl(){return this.m_params?this.m_params.m_extendedParams:CL().m_extendedParams}getExtendedParamsInternal(){return this.m_params?this.m_params.m_extendedParamsInternal:CL().m_extendedParamsInternal}isIdentityGeogToGeog(){return this.m_bIdentityGeogToGeog}normalizeOutput(){return this.m_bNormalize}updateProjector(){this.m_projector=new qnt(this)}};const fB=new Map,CC=new Map,GG=new Map;function _D(t){let e=t.getCode();if(e>0)return gB(e)||UG(Ki.coordsys(e));const s=t.getName();if(CC.has(s)){const i=CC.get(s);if(i&&i.deref()){const r=i.deref();if(r.m_peCoordSys.isEqual(t))return r}}return e=Ki.getCode(t),UG(e>0?Ki.coordsys(e):t)}function Cat(t){t<=0&&k8(t);{const i=gB(t);if(i)return i}const e=Mx(Ki.coordsys(t));e.get()||k8(t);const s=UG(e.release());return s.getLatestID()!==t&&fB.set(t,new WeakRef(s)),s}function Pat(t){const e=new bat({},!0);return e.m_WKID=t,e}function Tat(t){const e=Mx(Ki.fromString(We.PE_TYPE_COORDSYS,t));return e.get()||M0e(t),_D(e.release())}function Iat(t){CC.delete(t.m_peCoordSys.getName()),GG.delete(aB(t.m_peCoordSys,0,!1))}class Mat{constructor(e,s,i){this.m_hashCode=-1,e&&(this.m_inputSR=e,this.m_outputSR=s,this.m_env=i.clone(),this.m_hashCode=this.m_inputSR.getHashCode(),this.m_hashCode=Wi(this.m_hashCode,this.m_outputSR.getHashCode()),this.m_env.isEmpty()||(this.m_hashCode=Wi(this.m_hashCode,tM(this.m_env.xmin)),this.m_hashCode=Wi(this.m_hashCode,tM(this.m_env.xmax)),this.m_hashCode=Wi(this.m_hashCode,tM(this.m_env.ymin)),this.m_hashCode=Wi(this.m_hashCode,tM(this.m_env.ymax))))}getHashCode(){return this.m_hashCode}equals(e){return!(this.m_inputSR&&!e.m_inputSR||!this.m_inputSR&&e.m_inputSR)&&this.m_env.equals(e.m_env)&&this.m_inputSR.equals(e.m_inputSR)&&this.m_outputSR.equals(e.m_outputSR)}clear(){this.m_inputSR=void 0,this.m_outputSR=void 0,this.m_hashCode=-1,this.m_env=void 0}}const zG=new Map;function Aat(t){if(zG.has(t.getHashCode()))return zG.get(t.getHashCode())}function Nat(t,e){return zG.set(t.getHashCode(),e),e}let PL,TL,IL;function pbe(){return PL||(PL=N_(AR(),NR())),PL}function Dat(){return TL||(TL=pbe().getInverse()),TL}function $at(){return IL||(IL=Ki.unit(9001)),IL}function Rat(t){return Mx(Ki.coordsys(t)).get()!==null}const ML=new Map;function kat(t){if(ML.has(t))return ML.get(t);{const e=Rat(t);return ML.set(t,e),e}}function Fat(t){return!1}function UG(t){const e=Mx(t),s=t.getCode();if(s>0){const a=gB(s);if(a)return a}const i=t.getName();let r=CC.get(i);if(r){const a=r.deref();if(a&&a.m_peCoordSys.isEqual(t))return a}const n=new cB(e.release());if(s>0)return n.setCached(),fB.set(s,new WeakRef(n)),CC.set(i,new WeakRef(n)),n;const o=aB(t,0,!1);if(r=GG.get(o),r){const a=r.deref();if(a)return a}return n.setCached(),GG.set(o,new WeakRef(n)),n}function gB(t){const e=fB.get(t);if(e)return e.deref()}class Fd extends tve{constructor(e){return e===void 0?(super(),this.m_wkid=9001,void(this.m_peUnit=null)):typeof e=="number"?(super(),this.m_factor=e,void(this.m_wkid=0)):(super(e),void(e||(this.m_factor=1,this.m_wkid=9001,this.m_peUnit=$at())))}getUnitType(){return 0}convertFromMeters(e){return e/this.getUnitToBaseFactor()}convertToMeters(e){return e*this.getUnitToBaseFactor()}}const Oat=["0","1","2","3","4","5","6","7","8","9","b","c","d","e","f","g","h","j","k","m","n","p","q","r","s","t","u","v","w","x","y","z"];function Lat(t,e,s){const i=Me(e,"R");let r=0,n=0;for(let o=0;o<e;o++){let a=t[r]>>n&31;if(n+=5,n>31){const u=37-n;a&=(1<<u)-1,n-=32,r++,a|=(t[r]&(1<<n)-1)<<u}const l=Oat[a];i[e-1-o]=l}return s>e?i.push(..."0".repeat(s-e)):s<e&&(i.length=s),i.join("")}function Ine(t,e,s,i,r){F(i>>5<r.length);let n=e,o=s;for(let a=i;a>=0;a-=2){const l=31&a,u=.5*(o+n);t>=u?(r[a>>5]|=1<<l,n=u):o=u}}let vD=new Set;const BG=2147483645n,dN=9007199254740990n,AL="operation is not supported for unknown coordinate systems";var Mne;function P0(){return{majorSemiAxis:0,e2:0,minorSemiAxis:0,flattening:0,isSphere(){return this.e2===0}}}function Vat(t,e,s){t.majorSemiAxis=e,t.minorSemiAxis=e*(1-s),t.e2=s*(2-s),t.flattening=s}function qat(t){if(Ki)return;Yat(t);const e=vD;vD=null,e.forEach(s=>{const i=s.deref();i&&i.attachToPe()})}function yB(t){Hat(t)}function tu(){return!!Ki}function _B(){return!!hg}function IR(){return!!Ki||!!hg}function h0(t,e,s){return F(IR()),$R(t,e===void 0?0:e,null,!1)}function Wb(t,e){F(IR());const s=new Bd;let i;return tu()?(i=Tat(t),s.setHorzProj_(i),s.m_vertcs=null,s.m_userWKID=i.getLatestID()):(i=RR(t),s.m_unit=i.isPCS?new Fd(i.metersOrRadiansPerUnit):new wC(i.metersOrRadiansPerUnit)),DR(s.m_precisionDescriptor,i,null,1),s.m_bDefaultDescriptor=!0,s.m_userWKT=t,s.calculateHashCode(),s.initDbgName(),s}function PC(t,e,s,i,r=!0){let n=null;return e&&(n=hot(e,r)),Gat(t,n,s,i,r)}function Gat(t,e,s,i,r){t||ee("!PE_coord_sys");const n=new Bd;let o;return o=r?_D(t):new cB(t,!1),DR(n.m_precisionDescriptor,o,e,i),n.m_bDefaultDescriptor=!0,n.setHorzProj_(o),n.m_vertcs=e,n.m_userWKID=o.getLatestID(),n.calculateHashCode(),n.initDbgName(),n}function MR(t,e,s=!1){t.getCoordinateSystemType()===3&&ee("image spatial reference cannot be altered");const i=new Bd,r=t;return i.m_peCoordSysVal=r.m_peCoordSysVal,i.m_vertcs=r.m_vertcs,i.m_unit=r.m_unit,i.m_precisionDescriptor.assign(e),i.m_localZToXYFactor=r.m_localZToXYFactor,(Number.isNaN(i.m_precisionDescriptor.m_falseX)||Number.isNaN(i.m_precisionDescriptor.m_falseY))&&(i.m_precisionDescriptor.m_falseX=r.m_precisionDescriptor.m_falseX,i.m_precisionDescriptor.m_falseY=r.m_precisionDescriptor.m_falseY),i.m_precisionDescriptor.snapPrecision(),i.m_precisionDescriptor.fixTolerance(),i.m_userWKID=r.m_userWKID,i.m_precisionDescriptor.equals(r.m_precisionDescriptor)?i.m_bDefaultDescriptor=r.m_bDefaultDescriptor:i.m_bDefaultDescriptor=!1,s&&(i.m_bDefaultDescriptor=!0),i.calculateHashCode(),i.initDbgName(),i}function jG(t,e,s){return{}}function vB(t,e,s){e===void 0&&(e=1),(e<=0||!Number.isFinite(e))&&ee(""),t||e===1||ee("null Unit has to have z_to_xy_factor equal to 1");const i=new Bd;i.m_unit=t;const r=t||new Fd(9001);return bbe(i.m_precisionDescriptor,r,null,1),i.m_bDefaultDescriptor=!0,Number.isNaN(i.m_precisionDescriptor.m_falseX)&&ee("NAN false X/Y are not allowed here"),i.m_localZToXYFactor=e,i.calculateHashCode(),i.initDbgName(),i}function fbe(t,e){return t.snapGeometry(e)}function pN(t){const e=t.getCoordinateSystemType();return e===1?t:(e===3&&F(0),t.getGCS())}function bD(t){return F(IR()),_B()?Wat(t):kat(t)}function xD(t){if(tu())return Mx(Ki.fromString(We.PE_TYPE_COORDSYS,t)).get()!==null;try{return RR(t),!0}catch{}return!1}let NL;function gbe(){return NL||(NL=(()=>{const t=Math.trunc(Math.random()*Qr()),e=Date.now();return`|abba_000|${t.toString(16)}|${e.toString(16)}|`})()),NL}(function(t){t[t.utmDefault=0]="utmDefault",t[t.utmNorthSouth=1]="utmNorthSouth"})(Mne||(Mne={}));let zat=0;function ybe(t=""){let e=`${gbe()}${zat++}`;return t!==""&&(e+=`|${t}`),e}function _be(t){return t.startsWith(gbe())}let wM,SM,EM,Bd=class OS{destroy(){Iat(this.m_peCoordSysVal),this.getCoordinateSystemType()===1||this.getCoordinateSystemType()===2?this.getPECoordSys().destroy():Ce("SpatialReference.destroy")}constructor(){this.m_vertcs=null,this.m_peCoordSysVal=null,this.m_userWKID=0,this.m_userWKT=null,this.m_geogSpatialReference=null,this.m_srToGcs=null,this.m_gcsToSr=null,this.m_defaultPrecisionSR=null,this.m_localZToXYFactor=-1,this.m_precisionDescriptor=new Vn,this.m_hashCode=0,this.m_bDefaultDescriptor=!1,xB(this.m_precisionDescriptor),vD&&vD.add(new WeakRef(this))}attachToPe(){(this.m_userWKID>0?h0(this.m_userWKID):Wb(this.m_userWKT)).copyTo(this,!1)}copyTo(e,s=!0){(s||e.m_bDefaultDescriptor)&&(e.m_bDefaultDescriptor=this.m_bDefaultDescriptor,e.m_precisionDescriptor.assign(this.m_precisionDescriptor)),e.m_defaultPrecisionSR=null,e.m_gcsToSr=this.m_gcsToSr,e.m_geogSpatialReference=this.m_geogSpatialReference,e.m_hashCode=this.m_hashCode,e.m_localZToXYFactor=this.m_localZToXYFactor,e.m_peCoordSysVal=this.m_peCoordSysVal,e.m_srToGcs=this.m_srToGcs,e.m_userWKID=this.m_userWKID,e.m_userWKT=this.m_userWKT,e.m_vertcs=this.m_vertcs,e.m_unit=this.m_unit}getHashCode(){return this.m_hashCode}getHashCodeHorizontal(){let e=0;return e=this.m_peCoordSysVal?this.m_peCoordSysVal.getHashCode():this.m_unit?this.m_unit.getHashCode():305419891,e}updateTransform(e){if(this.getCoordinateSystemType()===1)return N_(this,this,null);let s=e?this.m_srToGcs:this.m_gcsToSr;if(s)return s;const i=this.getGCS(),r=this;s=e?N_(r,i,null):N_(i,r,null);const n=s;return(e?this.m_srToGcs:this.m_gcsToSr)||(e?this.m_srToGcs=n:this.m_gcsToSr=n,s)}getHashCodeVertical(){return this.m_vertcs?this.m_vertcs.getHashCode():0}calculateHashCode(){let e=this.getHashCodeHorizontal();const s=this.getHashCodeVertical(),i=this.m_precisionDescriptor.getHashCode();e=Wi(e,s),this.m_hashCode=Wi(e,i)}initDbgName(){}setHorzProj_(e){this.m_peCoordSysVal=e,this.m_unit=this.m_peCoordSysVal.getUnit()}getTolerance(e=0){return this.m_precisionDescriptor.getTolerance(e)}getResolution(e=0){return this.m_precisionDescriptor.getResolution(e)}getPECoordSys(){return this.m_peCoordSysVal?this.m_peCoordSysVal.m_peCoordSys:null}getPCSInfo(){return this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getPCSInfo()}getCentralMeridian(){return this.throwIfNotGCSOrPCS(),this.getCoordinateSystemType()===1?0:this.getPCSInfo().getCentralMeridian()}getCoordinateSystemType(){const e=this.getPECoordSys();if(e)switch(e.getType()){case We.PE_TYPE_GEOGCS:return 1;case We.PE_TYPE_PROJCS:return 2;default:return 0}else{if((this.m_userWKID>0||this.m_userWKT)&&this.m_unit instanceof Fd)return 2;if(this.m_unit instanceof wC)return 1}return 0}getID(){return this.m_userWKID}getLatestID(){return this.m_peCoordSysVal?this.m_peCoordSysVal.getLatestID():this.m_userWKID}getOldID(){return this.m_peCoordSysVal?this.m_peCoordSysVal.getOldID():this.m_userWKID}getVerticalID(){return yt("vcs not implemented"),0}getLatestVerticalID(){return this.m_vertcs?this.m_vertcs.getLatestID():0}getOldVerticalID(){return yt("vcs not implemented"),0}getPEVerticalCoordSys(){return null}getPole(e){return this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getPole(e)}getText(){const e=this.getPECoordSys();return e?Ene(e):this.m_userWKT??""}getTextExtended(e){const s=this.getPECoordSys();return s?this.getPEVerticalCoordSys()?$ot(null,s,this.getPEVerticalCoordSys()):Ene(s,e):this.m_userWKT??""}getText2(e=-1){const s=this.getPECoordSys();return s?Rot(s,e):this.m_userWKT??""}getUnit(){return this.m_unit}getUnitsPerMillimeter(){return this.m_peCoordSysVal?this.m_peCoordSysVal.getUnitsPerMillimeter():this.m_unit instanceof Fd?.001/this.m_unit.getUnitToBaseFactor():this.m_unit instanceof wC?.001/(RR(this.m_userWKT??this.m_userWKID).semiMajor*this.m_unit.getUnitToBaseFactor()):(Us("sr object not in valid state"),0)}getAuthorityName(){return this.getPECoordSys()?kot():""}getVerticalUnit(){return yt("vcs not implemented"),{}}getVCS(){return this.m_vertcs}hasVCS(){return!1}getGCSHorisonIsInclusive(){return this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getGCSHorisonIsInclusive()}getGCSHorizon(){return this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getGCSHorizon()}getGCS(){const e=this.getCoordinateSystemType();if(e===0)Us(AL);else{if(e===1)return this;e===3&&Us("image cs not supported")}if(this.m_geogSpatialReference)return this.m_geogSpatialReference;let s;if(this===AR()||this===bB())s=NR();else{F(this.m_peCoordSysVal);const i=this.m_peCoordSysVal.m_peCoordSys.getGeogcs();i||Ce(""),s=PC(i,this.m_vertcs,null,this.m_precisionDescriptor.getPrecision(),this.m_peCoordSysVal.getCached())}return this.m_geogSpatialReference?s=this.m_geogSpatialReference:this.m_geogSpatialReference=s,s}getGCSSplitLines(){return this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getGCSSplitLines()}toGCS(e,s){if(e.length===0)return 0;e.length>s.length&&ee("coordsSrc.size() > coordsDst.size()");const i=this.getCoordinateSystemType();if(i===0&&Us(AL),i===1)return j3(s,e,e.length),e.length;F(this.m_peCoordSysVal);const r=this.getSRToGCSTransform();return new eh().transform(r,e,e.length,s)}toGeohash(e,s=8){const i=e.clone();i.scale(this.getGCS().getUnit().getID()===9102?1:this.getGCS().getUnit().getUnitToBaseFactor()/Math.PI*180),i.x<-180?(i.x=og(i.x,360),i.x<-180&&(i.x+=360)):i.x>180&&(i.x=og(i.x,360),i.x>180&&(i.x-=360)),i.y>90&&(i.y=90),i.y<-90&&(i.y=-90);const r=5*s,n=new Uint32Array(4);return Ine(i.x,-180,180,r-1,n),Ine(i.y,-90,90,r-2,n),Lat(n,s,s)}isPannable(){const e=this.getCoordinateSystemType();return e!==0&&e!==3&&(F(this.m_peCoordSysVal),this.m_peCoordSysVal.isPannable())}getPannableExtent(){return this.isPannable()||ee("!is_pannable"),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getPannableExtent()}getPannableExtentInGCS(){return this.isPannable()||ee("!is_pannable"),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getPannableExtentGCS()}throwIfNotGCSOrPCS(){const e=this.getCoordinateSystemType();e!==1&&e!==2&&ee("Not a GCS or PCS")}getDomainXY(){return this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getDomainXY()}getFullWorldExtent(){return this.throwIfNotGCSOrPCS(),this.isPannable()?this.getPannableExtent():this.getDomainXY()}queryPrecisionDescriptor(e){if(e.assign(this.m_precisionDescriptor),Number.isNaN(e.m_falseX))if(tu()||iR("cannot query precision descriptor"),F(this.m_peCoordSysVal!==null),this.m_precisionDescriptor.m_precision!==2){const s=this.m_peCoordSysVal.getDomainXY();e.m_falseX=s.xmin,e.m_falseY=s.ymin}else e.m_falseX=-Number.MAX_VALUE,e.m_falseY=-Number.MAX_VALUE}queryPrecisionDescriptorWithoutFalseXY(e){e.assign(this.m_precisionDescriptor),e.m_falseX=Number.NaN,e.m_falseY=Number.NaN}queryDefaultPrecisionDescriptorWithoutFalseXY(e){if(this.m_bDefaultDescriptor)e.assign(this.m_precisionDescriptor);else{const s=this.getCoordinateSystemType();s===0?bbe(e,this.m_unit,this.m_vertcs,this.m_precisionDescriptor.getPrecision()):s===3?yt("image cs"):DR(e,this.m_peCoordSysVal,this.m_vertcs,this.m_precisionDescriptor.getPrecision())}e.m_falseX=Number.NaN,e.m_falseY=Number.NaN}horizontalEqual(e){return _at(this.m_peCoordSysVal,e.m_peCoordSysVal)}verticalEqual(e){return this.m_vertcs!==null==(e.m_vertcs!==null)&&(!this.m_vertcs||this.m_vertcs.equals(e.m_vertcs))}equals(e){const s=e;if(this===s)return!0;if(!this.horizontalEqual(s)||!this.verticalEqual(s)||!s.m_peCoordSysVal&&(F(!this.m_peCoordSysVal),this.m_unit!==null!=(s.m_unit!==null)||this.m_unit&&!this.m_unit.equals(s.m_unit)||this.m_localZToXYFactor!==s.m_localZToXYFactor))return!1;if(!this.m_bDefaultDescriptor||!s.m_bDefaultDescriptor){if(this.m_peCoordSysVal){if(!this.m_precisionDescriptor.equalsWithoutFalseXY(s.m_precisionDescriptor))return!1;F(s.m_peCoordSysVal);let i=this.m_precisionDescriptor.m_falseX,r=this.m_precisionDescriptor.m_falseY;if(Number.isNaN(i)){const a=this.m_peCoordSysVal.getDomainXY();i=a.xmin,r=a.ymin}let n=s.m_precisionDescriptor.m_falseX,o=s.m_precisionDescriptor.m_falseY;if(Number.isNaN(n)){const a=s.m_peCoordSysVal.getDomainXY();n=a.xmin,o=a.ymin}return i===n&&r===o}return this.m_precisionDescriptor.equals(s.m_precisionDescriptor)}return!0}equalForProjection(e,s){if(this===e)return!0;const i=this.getCoordinateSystemType(),r=e.getCoordinateSystemType();if(i===0||r===0)return i===0&&r===0?(!s||this.getZToXYFactor()===e.getZToXYFactor())&&(!this.getUnit()||!e.getUnit()||this.getUnit().equals(e.getUnit())):i!==3&&r!==3&&(this.getUnit()===null||e.getUnit()===null||(!s||this.getZToXYFactor()===e.getZToXYFactor())&&this.getUnit().equals(e.getUnit()));if(i!==r)return!1;if(i===3)return this.equals(e);if(vat(this.m_peCoordSysVal,e.m_peCoordSysVal)){if(!s)return!0;if(this.m_vertcs!==null==(e.m_vertcs!==null))return!this.m_vertcs||this.m_vertcs.equalForProjection(e.m_vertcs)}return!1}equalHorizontal(e){return this.horizontalEqual(e)}equalVertical(e){return F(0),!1}equalVerticalVCS(e){return F(0),!1}convergenceAngle(e){return F(0),0}getPeCoordsysCopy(){if(this.m_peCoordSysVal){const e=this.m_peCoordSysVal.m_peCoordSys;return e||Ce("cannot clone coord sys"),e}return null}getPeVertcsCopy(){return F(0),0}throwIfLocal(){this.getCoordinateSystemType()===0&&ee(AL)}getPrimeMeridian(){return this.throwIfLocal(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getPrimeMeridian()}getSRToGCSTransform(){return this.updateTransform(!0)}getGCSToSRTransform(){return this.updateTransform(!1)}getOneMeter(){return 1e3*this.getUnitsPerMillimeter()}getOneMeterPCSUnit(){return this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getOneMeterPCSUnit()}getDefaultPrecisionSR(){if(this.m_bDefaultDescriptor)return this;if(this.m_defaultPrecisionSR===null){const e=new Vn;this.queryDefaultPrecisionDescriptorWithoutFalseXY(e),this.m_defaultPrecisionSR=MR(this,e,!0)}return this.m_defaultPrecisionSR}getPCSHorizon(){return this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getPCSHorizon()}getHorzUnitFactor(){return this.m_unit?this.m_unit.getUnitToBaseFactor():1}querySpheroidData(e){this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal);const s=this.getGCS().getPECoordSys().getDatum().getSpheroid(),i=s.getFlattening();Vat(e,s.getAxis(),i)}getAreaOfUse(){this.getCoordinateSystemType()===0&&Us(""),F(this.m_peCoordSysVal);const e=this.m_peCoordSysVal.getAreaOfUse();return e===null?new o0:new o0({geom:e.clone(),sr:h0(4326)})}getZToXYFactor(){return 1}isCustomWkid(){return!1}getOneDegreeGCSUnit(){return this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getOneDegreeGCSUnit()}getGcsUnitFactor(){return this.throwIfNotGCSOrPCS(),F(this.m_peCoordSysVal),this.m_peCoordSysVal.getGcsUnitFactor()}snapGeometry(e){if(e.isEmpty()||this.m_precisionDescriptor.getPrecision()===2)return!1;const s=e.getGeometryType();if(zo(s))return this.snapMultiVertex_(e);if(s===G.enumPoint)return this.snapPoint_(e);if(s===G.enumEnvelope)return this.snapEnvelope_(e);if(zi(s))return this.snapSegment_(e);if(s===G.enumGeometryCollection){const i=e;let r=!1;for(let n=0,o=i.getGeometryCount();n<o;++n)r=this.snapGeometry(i.getGeometry(n))||r;return r}Ce("what else?")}snapMultiVertex_(e){if(F(!e.isEmpty()),F(this.m_precisionDescriptor.getPrecision()!==2),xt(e.getGeometryType())){const n=e;if(n.hasNonLinearSegments())return this.snapGeometryWithCurves_(n)}const s=e.getImpl(),i=s.getDescription();let r=!1;for(let n=0,o=i.getAttributeCount();n<o;n++){const a=i.getSemantics(n),l=s.getAttributeStreamRef(a);r=this.snapAttributes(a,l,0,s.getPointCount())||r}return r&&s.notifyModifiedFlags(2001),r}snapPoint_(e){return!1}snapEnvelope_(e){return!1}snapSegment_(e){F(!e.isEmpty()),F(this.m_precisionDescriptor.getPrecision()!==2);const s=new Vn;this.queryPrecisionDescriptor(s);const i=e.getStartXY(),r=new M;r.x=$1(i.x,s.getFalseX(),s.getGridUnitsXY()),r.y=$1(i.y,s.getFalseY(),s.getGridUnitsXY());let n=!r.equals(i);const o=e.getEndXY(),a=new M;a.x=$1(o.x,s.getFalseX(),s.getGridUnitsXY()),a.y=$1(o.y,s.getFalseY(),s.getGridUnitsXY()),n||(n=!a.equals(o)),n&&e.changeEndPoints2D(r,a);const l=(c,h,m)=>{let f=!1;{const g=e.getStartAttributeAsDbl(c,0),v=$1(g,h,m),b=!uo(v,g);f||(f=b),b&&e.setStartAttribute(c,0,v)}{const g=e.getEndAttributeAsDbl(c,0),v=$1(g,h,m),b=!uo(v,g);f||(f=b),b&&e.setEndAttribute(c,0,v)}return f};let u=n?1:0;return e.hasAttribute(1)&&(u|=l(1,s.getFalseZ(),s.getGridUnitsZ())?1:0),e.hasAttribute(2)&&(u|=l(2,s.getFalseM(),s.getGridUnitsM())?1:0),!!u}snapGeometryWithCurves_(e){F(!e.isEmpty()),F(this.m_precisionDescriptor.getPrecision()!==2);const s=e.createInstance(),i=new ut;let r=0;for(let n=0,o=e.getPathCount();n<o;++n){const a=e.getSegmentCountPath(n);if(a===0){if(s.addPath(e,n,!0),s.getPathSize(n)===1){const u=new nt;s.getPointByVal(s.getPointCount()-1,u),r|=this.snapGeometry(u)?1:0,s.setPointByVal(s.getPointCount()-1,u)}continue}const l=e.isClosedPath(n);for(let u=0,c=l?a-1:a;u<c;++u)e.getSegmentFromPath(n,u,i,!1),r|=this.snapGeometry(i.get())?1:0,s.addSegment(i.get(),u===0);l&&(e.getSegmentFromPath(n,a-1,i,!1),r|=this.snapGeometry(i.get())?1:0,a===1?s.addPathFromClosedSegment(i.get(),!1):s.closeLastPathWithSegment(i.get()))}return r&&s.copyTo(e),!!r}snapAttributes(e,s,i,r){let n=!1;const o=new Vn;if(this.queryPrecisionDescriptor(o),e===0){const a=s;for(let l=i;l<r;l++){const u=a.read(2*l),c=OS.s_SnapValue(u,o.getFalseX(),o.getGridUnitsXY()),h=a.read(2*l+1),m=OS.s_SnapValue(h,o.getFalseY(),o.getGridUnitsXY());n=n||c!==u||m!==h,n&&(a.write(2*l,c),a.write(2*l+1,m))}}else if(e===1){const a=s;for(let l=i;l<r;l++){const u=a.read(l),c=OS.s_SnapValue(u,o.getFalseZ(),o.getGridUnitsZ());n=n||!uo(c,u),n&&a.write(l,c)}}else if(e===2){const a=s;for(let l=i;l<r;l++){const u=a.read(l),c=OS.s_SnapValue(u,o.getFalseM(),o.getGridUnitsM());n=n||!uo(c,u),n&&a.write(l,c)}}return n}static s_SnapValue(e,s,i){return J_((e-s)*i)/i+s}};class Vn{constructor(){const e=dN,s=1e-4,i=.001,r=s*Number(e)*.5;this.m_precision=1,this.m_falseX=-r,this.m_falseY=-r,this.m_unitsXY=Number(e)/(2*r),this.m_falseM=-1e5,this.m_unitsM=1/s,this.m_falseZ=-1e5,this.m_unitsZ=1/s,this.m_toleranceXY=i,this.m_toleranceM=i,this.m_toleranceZ=i}getHashCode(){let e=7777,s=7777;return s=Wi(s,this.m_falseM),s=Wi(s,this.m_unitsM),e=Wi(e,this.m_unitsXY),s=Wi(s,this.m_toleranceXY),e=Wi(e,this.m_falseZ),s=Wi(s,this.m_toleranceZ),e=Wi(e,this.m_unitsZ),s=Wi(s,this.m_toleranceM),e=Wi(e,this.m_precision),Wi(e,s)}clone(){const e=new Vn;return e.m_falseX=this.m_falseX,e.m_falseY=this.m_falseY,e.m_unitsXY=this.m_unitsXY,e.m_falseZ=this.m_falseZ,e.m_unitsZ=this.m_unitsZ,e.m_falseM=this.m_falseM,e.m_unitsM=this.m_unitsM,e.m_toleranceXY=this.m_toleranceXY,e.m_toleranceZ=this.m_toleranceZ,e.m_toleranceM=this.m_toleranceM,e.m_precision=this.m_precision,e}assign(e){return this.m_falseX=e.m_falseX,this.m_falseY=e.m_falseY,this.m_unitsXY=e.m_unitsXY,this.m_falseZ=e.m_falseZ,this.m_unitsZ=e.m_unitsZ,this.m_falseM=e.m_falseM,this.m_unitsM=e.m_unitsM,this.m_toleranceXY=e.m_toleranceXY,this.m_toleranceZ=e.m_toleranceZ,this.m_toleranceM=e.m_toleranceM,this.m_precision=e.m_precision,this}initialize2D(e,s){}getTolerance(e){switch(e){case 0:return this.m_toleranceXY;case 1:return this.m_toleranceZ;case 2:return this.m_toleranceM;default:return 0}}getResolution(e){if(this.m_precision===2)return 0;switch(e){case 0:return 1/this.m_unitsXY;case 1:return 1/this.m_unitsZ;case 2:return 1/this.m_unitsM;default:return 0}}getFalseX(){return this.m_falseX}getFalseY(){return this.m_falseY}getFalseZ(){return this.m_falseZ}getFalseM(){return this.m_falseM}getGridUnitsXY(){return this.m_unitsXY}getGridUnitsZ(){return this.m_unitsZ}getGridUnitsM(){return this.m_unitsM}getPrecision(){return this.m_precision}static getLimit32(){return 2147483645}static getLimit64(){return 9007199254740990n}static getLimitFloat(){return 0}getXYGridRange(){const e=new X;switch(this.m_precision){case 0:{const s=Vn.getLimit32()/this.getGridUnitsXY();e.setCoords({xmin:this.getFalseX(),ymin:this.getFalseY(),xmax:this.getFalseX()+s,ymax:this.getFalseY()+s})}break;case 1:{const s=Number(Vn.getLimit64())/this.getGridUnitsXY();e.setCoords({xmin:this.getFalseX(),ymin:this.getFalseY(),xmax:this.getFalseX()+s,ymax:this.getFalseY()+s})}break;case 2:e.setCoords({xmin:-Number.MAX_VALUE,ymin:-Number.MAX_VALUE,xmax:Number.MAX_VALUE,ymax:Number.MAX_VALUE});break;default:e.setEmpty(),Ce("")}return e}getZGridRange(){const e=new de;switch(this.m_precision){case 0:{const s=Vn.getLimit32()/this.getGridUnitsZ();e.setCoords(this.getFalseZ(),this.getFalseZ()+s)}break;case 1:{const s=Number(Vn.getLimit64())/this.getGridUnitsZ();e.setCoords(this.getFalseZ(),this.getFalseZ()+s)}break;case 2:e.setCoords(-Number.MAX_VALUE,Number.MAX_VALUE);break;default:e.setEmpty(),Ce("")}return e}getMGridRange(){const e=new de;switch(this.m_precision){case 0:{const s=Vn.getLimit32()/this.getGridUnitsM();e.setCoords(this.getFalseM(),this.getFalseM()+s)}break;case 1:{const s=Number(Vn.getLimit64())/this.getGridUnitsM();e.setCoords(this.getFalseM(),this.getFalseM()+s)}break;case 2:e.setCoords(-Number.MAX_VALUE,Number.MAX_VALUE);break;default:e.setEmpty(),Ce("")}return e}setTolerance(e,s){switch(s<0&&ee("tol < 0"),Number.isFinite(s)||ee("tol is not finite"),e){case 0:this.m_toleranceXY=s;break;case 1:this.m_toleranceZ=s;break;case 2:this.m_toleranceM=s;break;default:ee("cannot set tolerance for this attribute")}}setGridParams(e,s,i){Number.isFinite(e)&&Number.isFinite(s)&&Number.isFinite(i)||ee("grid params are not finite"),i<1&&ee("grid units cannot be smaller than 1.0"),this.m_falseX=e,this.m_falseY=s,this.m_unitsXY=i}setZParams(e,s){Number.isFinite(e)&&Number.isFinite(s)||ee("grid params are not finite"),s<1&&ee("grid units cannot be smaller than 1.0"),this.m_falseZ=e,this.m_unitsZ=s}setMParams(e,s){Number.isFinite(e)&&Number.isFinite(s)||ee("grid params are not finite"),s<1&&ee("grid units cannot be smaller than 1.0"),this.m_falseM=e,this.m_unitsM=s}setPrecision(e){}equals(e){return this===e||uo(this.m_falseX,e.m_falseX)&&uo(this.m_falseY,e.m_falseY)&&this.equalsWithoutFalseXY(e)}snapPrecision(){if(this.m_precision===2)return;const e=(i,r,n,o)=>{if(!Number.isFinite(r)||!Number.isFinite(n))return n;if(n<1)return 1;if(!o)return n;const a=Number(i)/n;return Math.trunc((r+a-r)*n)>i&&(n=i/(r+a-r)),Math.max(1,n)},s=Number(this.m_precision===0?BG:dN);this.m_unitsXY=e(s,this.m_falseX,this.m_unitsXY,!0),this.m_unitsXY=e(s,this.m_falseY,this.m_unitsXY,!0),this.m_unitsZ=e(s,this.m_falseZ,this.m_unitsZ,!1),this.m_unitsM=e(s,this.m_falseM,this.m_unitsM,!1)}verifyPrecision(){if(this.m_precision===2)return!0;const e=(i,r,n,o)=>{if(n<1||!Number.isFinite(r)||!Number.isFinite(n))return!1;if(!o)return!0;const a=Number(i)/n;return!(BigInt((r+a-r)*n)>i)},s=this.m_precision===0?BG:dN;return!!e(s,this.m_falseX,this.m_unitsXY,!0)&&!!e(s,this.m_falseY,this.m_unitsXY,!0)&&!!e(s,this.m_falseZ,this.m_unitsZ,!1)&&!!e(s,this.m_falseM,this.m_unitsM,!1)}fixTolerance(){this.m_precision!==2&&(this.m_toleranceXY=Math.max(2/this.m_unitsXY,this.m_toleranceXY),this.m_toleranceZ=Math.max(2/this.m_unitsZ,this.m_toleranceZ),this.m_toleranceM=Math.max(2/this.m_unitsM,this.m_toleranceM),(Number.isNaN(this.m_falseX)||Number.isNaN(this.m_falseY))&&(this.m_falseX=this.m_falseY=Number.NaN))}equalsWithoutFalseXY(e){return this===e||this.m_unitsXY===e.m_unitsXY&&this.m_falseZ===e.m_falseZ&&this.m_unitsZ===e.m_unitsZ&&this.m_falseM===e.m_falseM&&this.m_unitsM===e.m_unitsM&&this.m_toleranceXY===e.m_toleranceXY&&this.m_toleranceZ===e.m_toleranceZ&&this.m_toleranceM===e.m_toleranceM&&this.m_precision===e.m_precision}setBestXyDomainFromEnvelope(e,s){}setBestZDomainFromZRange(e,s,i){}setBestMDomainFromMRange(e,s,i){}}function AR(){return(!wM||tu()&&wM.getPECoordSys()===null)&&(wM=$R(3857,0,null,!0)),wM}function bB(){return(!SM||tu()&&SM.getPECoordSys()===null)&&(SM=$R(102100,0,null,!0)),SM}function NR(){return(!EM||tu()&&EM.getPECoordSys()===null)&&(EM=$R(4326,0,null,!0)),EM}function xB(t){t.m_falseX=0,t.m_falseY=0,t.m_unitsXY=1,t.m_falseZ=0,t.m_unitsZ=1,t.m_falseM=0,t.m_unitsM=1,t.m_toleranceXY=100*Bs(),t.m_toleranceZ=100*Bs(),t.m_toleranceM=100*Bs(),t.m_precision=2}function DR(t,e,s,i){const r=e instanceof cB;xB(t),t.m_precision=i,t.m_falseX=Number.NaN,t.m_falseY=Number.NaN;const n=1e-4,o=.001,a=r?e.m_csType:e.isPCS?2:1;if(a===1){const c=(i===0?5555555555555555e-22:1e-9)*(r?e.getOneDegreeGCSUnit():Math.PI/e.metersOrRadiansPerUnit/180);t.m_unitsXY=1/c}else if(a===2){const c=(i===0?o:n)*(r?e.getOneMeterPCSUnit():1/e.metersOrRadiansPerUnit);t.m_unitsXY=1/c}else ee("unrecognized cs type");t.m_falseM=-1e5,t.m_unitsM=1/(i===0?o:n),t.m_unitsM=Math.max(1,t.m_unitsM),t.m_unitsXY=Math.max(1,t.m_unitsXY);let l=0,u=0;i!==0&&i!==1||(l=2/t.m_unitsXY,u=2/t.m_unitsM),t.m_toleranceXY=Math.max(l,r?e.getUnitsPerMillimeter():a===2?.001/e.metersOrRadiansPerUnit:.001/(e.semiMajor*e.metersOrRadiansPerUnit)),t.m_toleranceM=Math.max(o,u),vbe(t,s)}function vbe(t,e){if(t.m_falseZ=-1e5,e){const n=(t.m_precision===0?.001:1e-4)*e.getOneMeter();t.m_unitsZ=1/n}else t.m_unitsZ=1/(t.m_precision===0?.001:1e-4);t.m_unitsZ=Math.max(1,t.m_unitsZ);let r=0;t.m_precision!==0&&t.m_precision!==1||(r=2/t.m_unitsZ),t.m_toleranceZ=Math.max(e?e.getOneMeter()*.001:.001,r)}function bbe(t,e,s,i){xB(t),t.m_precision=i;const r=i===0?BG:dN,n=1e-4,o=.001;let a=1,l=1,u=.001;e&&(l=e.getUnitToBaseFactor()),e&&e.getUnitType()===1?(a=400*Math.PI/180,u=8983152841195215e-24*Math.PI/180/l):(a=(i===0?o:n)*Number(r)*.5,u=o/l),a/=l,t.m_falseX=-a,t.m_falseY=-a,t.m_unitsXY=Number(r)/(2*a),t.m_falseM=-1e5,t.m_unitsM=1/(i===0?o:n),t.m_unitsM=Math.max(1,t.m_unitsM),t.snapPrecision();let c=0,h=0;t.m_precision!==0&&t.m_precision!==1||(h=2/t.m_unitsM,c=2/t.m_unitsXY),t.m_toleranceXY=Math.max(c,u),t.m_toleranceM=Math.max(o,h),vbe(t,s)}function $R(t,e,s,i){if(!i&&e<=0){if(t===3857)return AR();if(t===102100)return bB();if(t===4326)return NR()}const r=new Bd;let n,o=null;return tu()?(n=Cat(t),e>0?o=null:e=0,r.setHorzProj_(n),r.m_vertcs=o):(n=RR(t),r.m_unit=n.isPCS?new Fd(n.metersOrRadiansPerUnit):new wC(n.metersOrRadiansPerUnit)),DR(r.m_precisionDescriptor,n,o,1),r.m_bDefaultDescriptor=!0,r.m_userWKID=t,r.calculateHashCode(),r.initDbgName(),r}function $1(t,e,s){return J_((t-e)*s)/s+e}let Yf=null;const xbe=3552713678800501e-30;function Uat(t,e,s){return t===e||Math.abs(t-e)<=s*(1+(Math.abs(t)+Math.abs(e))/2)}function hs(t,e){return Uat(t,e,xbe)}function Bat(t,e){return t===0||Math.abs(t)<=e}function jat(t){return Bat(t,xbe)}let wn,Ki,We,sn,HG,Kr,hb,Ane,Sa,TC,YG;function Mx(t){return{_this:t,get(){return this._this},reset(e){this._this=e},release(){const e=this._this;return this._this=null,e}}}let hg=null;function RR(t){F(hg);const e=hg(t);return e.semiMajor=e.isPCS?Number.NaN:Jat(t),e}function Hat(t){hg=t,F(hg)}function Yat(t){const e=t;Ki=e.PeFactory,F(Ki),YG=e.PeGCSExtent,F(YG),Sa=e.PeLineType,F(Sa),TC=e.PeMath,F(TC),wn=e.PeDouble,F(wn),We=e.PeDefs,F(We),sn=e.PeCSTransformations,F(sn),HG=e.PeGTTransformations,F(HG),Kr=e.PePCSInfo,F(Kr),hb=e.PeGTlistExtended,F(hb),Ki.initialize(),Ane=e.PeGTlistExtendedEntry,F(Ane),We.PE_TYPE_ANGUNIT=512,We.PE_STR_AUTH_ALL=2,Kr.PE_POLE_LINE_STRAIGHT=2,Kr.PE_POLE_LINE_CURVED=3,We.PE_PARM_LAM0=2,We.PE_PARM_PHI0=6,We.PE_PRJ_AZIMUTHAL_EQUIDISTANT=43032,We.PE_PRJ_LAMBERT_AZIMUTHAL_EQAREA=43033,We.PE_PRJ_ALBERS=43007,We.PE_PRJ_CYLINDRICAL_EQAREA=43034,We.PE_TYPE_VERTCS=8,We.PE_LINETYPE_GEODESIC=0,We.PE_LINETYPE_LOXODROME=1,We.PE_LINETYPE_GREAT_ELLIPTIC=2,We.PE_LINETYPE_NORMAL_SECTION=3,hb.PE_GTLIST_OPTS_USABLE=1,hg=null}function Xat(t,e,s,i){return e<=0?(s[0]=0,i[0]=0,!1):(s[0]=e,i[0]=e,!0)}function Wat(t){return F(_B()),!!hg(t).isPCS||Zat(t)}function Zat(t){return Ki&&Us("pe has been loaded. no-pe methods should not be used at this point."),Yf||wbe(),Yf.has(t)}const Qat=/(?:ELLIPSOID|SPHEROID)\["(?:\w|[-()])+",(\d+\.\d+)/;function Jat(t){if(Ki&&Us("pe has been loaded. no-pe methods should not be used at this point."),typeof t=="string"){const e=t.match(Qat);e&&e.length===2||ee("bad gcs wkt");const s=Number.parseFloat(e[1]);return Number.isFinite(s)||ee("bad gcs wkt"),s}return Yf||wbe(),Yf.has(t)||Us("gcs wkid not found"),Yf.get(t)}function wbe(){Yf=new Map;for(const t in nD){const e=Number.parseFloat(t),s=nD[t];if(Array.isArray(s))for(const i of s)Yf.set(i,e);else Yf.set(s,e)}yst()}function Kat(t,e){const s=Ki.geogtran(t);return s||k8(t),new kR(s,e)}function elt(t,e){const s=Ki.fromString(We.PE_TYPE_GEOGTRAN,t);return s||M0e(t),new kR(s,e)}function Sbe(t,e){return new kR(t,e)}const Nne=kc(0),Dne=kc(1);let kR=class XG{constructor(e,s){if(e instanceof XG)return this.m_geogTranWrapper=e.m_geogTranWrapper,this.m_bInverted=s?!e.m_bInverted:e.m_bInverted,void(this.m_hashCode=Wi(this.m_geogTranWrapper.getHashCode(),this.m_bInverted?Dne:Nne));this.m_geogTranWrapper=new dot(e),this.m_bInverted=s,this.m_hashCode=Wi(this.m_geogTranWrapper.getHashCode(),this.m_bInverted?Dne:Nne)}getID(){return this.m_geogTranWrapper.getLatestId()}getLatestID(){return this.m_geogTranWrapper.getLatestId()}getText(){return this.m_geogTranWrapper.getText()}getTextExtended(e){if(!this.m_geogTranWrapper.getGeogtran())return"";if(e===-1)return this.m_geogTranWrapper.getGeogtran().toString();{const s=e===0?We.PE_STR_AUTH_TOP:We.PE_STR_AUTH_ALL;return this.m_geogTranWrapper.getGeogtran().toString(s)}}getText2(e=-1){let s=We.PE_STR_FMT_WKT2;return e!==-1&&(s|=e===0?We.PE_STR_AUTH_TOP:We.PE_STR_AUTH_ALL),this.m_geogTranWrapper.getGeogtran().toString(s)}getName(){return this.m_geogTranWrapper&&this.m_geogTranWrapper.getGeogtran()?this.m_geogTranWrapper.getGeogtran().getName():""}getInputSpatialReference(){return this.m_bInverted?this.m_geogTranWrapper.getOutputSr(!1):this.m_geogTranWrapper.getInputSr(!1)}getOutputSpatialReference(){return this.m_bInverted?this.m_geogTranWrapper.getInputSr(!1):this.m_geogTranWrapper.getOutputSr(!1)}getInverse(){return new XG(this,!0)}isInverted(){return this.m_bInverted}getHashCode(){return this.m_hashCode}GetPeGeogtran(){return this.m_geogTranWrapper.getGeogtran()}equals(e){const s=e;return s===this||this.m_bInverted===s.m_bInverted&&(this.GetPeGeogtran()===s.GetPeGeogtran()||this.getID()===s.getID()&&!(this.getID()===0&&!this.GetPeGeogtran().isEqual(s.GetPeGeogtran())))}referencesMissingData(){return!!this.m_geogTranWrapper&&!this.m_geogTranWrapper.isUsable()}getWrapper(){return this.m_geogTranWrapper}};function Ebe(t,e,s,i,r){const n=t.getGCS(),o=e.getGCS(),a=n.getPECoordSys(),l=o.getPECoordSys();let u=null;if(!s.isEmpty()){const f=s.clone();if(!f.isEmpty()&&t.getCoordinateSystemType()===2){let g=new Sn({env2D:f});const v=N_(t,n,null);g=new eh().execute(g,v,null),g.queryEnvelope(f)}if(!f.isEmpty()){const g=a.getPrimem().getLongitude(),v=a.getUnit().getUnitFactor();u=new YG(f.xmin,f.ymin,f.xmax,f.ymax,g,v)}}let c=i;c>=Qr()&&(c=0);const h=[];let m=hb.PE_GTLIST_OPTS_COMMON;r||(m&=~hb.PE_GTLIST_OPTS_USABLE);for(let f=0;f<2;f++){h.length=0;const g=c,v=hb.getGTlist(a,l,2,m,u,g);let b=!1;if(v&&v.length>0)for(let w=0,S=v.length;w<S;w++){const T=Cbe([v[w]]);if(F(T),r&&T.referencesMissingData())b=!0;else if(h.push(T),i>0&&h.length===i)break}if(!b)break;c===0||(c=0)}return u&&u.destroy(),h}function Cbe(t){F(t!==null);const e=new wB,s=t[0].getSteps();if(s){const i=t[0].getEntries();for(let r=0;r<s;r++){const n=i[r].getDirection()!==0,o=Sbe(i[r].getGeogtran(),n);e.add(o)}return e.create()}return null}let Pbe=class{constructor(t,e,s,i){this.m_bReadOnly=!0,this.m_name="",this.m_fastTrack=-1,this.m_bNameIsSet=!1,this.m_transforms=t,e&&(this.m_name=e,this.m_bNameIsSet=!0),this.m_inputSr=s,this.m_outputSr=i}getType(){return 0}getName(){if(this.m_bNameIsSet)return this.m_name;if(this.m_transforms.length===0)return"";let t="";for(const e of this.m_transforms)t.length>0&&(t+=" + "),e.isInverted()&&(t+="~"),t+=e.getName();return t}count(){return this.m_transforms.length}createInverse(){return this.getInverse()}getHashCode(){let t=1973;for(let e=0;e<this.m_transforms.length;e++)t=Wi(t,this.m_transforms[e].getHashCode());return t}equals(t){return F(0),!1}referencesMissingData(){if(this.m_transforms.length===0)return!1;for(const t of this.m_transforms)if(t.referencesMissingData())return!0;return!1}isMatchingTransformation(t,e){return F(0),!1}validateTransformation(t,e){return F(0),!1}nameIsSet(){return F(0),!1}getInputSpatialReference(){return this.m_inputSr}getOutputSpatialReference(){return this.m_outputSr}getStep(t){return(t<0||t>this.count())&&bt(""),this.m_transforms[t]}getInverse(){const t=new wB;return t.addSteps(this,!0),t.setInputSpatialReference(this.m_outputSr),t.setOutputSpatialReference(this.m_inputSr),t.create()}transform(t,e,s){if(this.count()===0)return;let i=this.m_inputSr,r=this.m_outputSr;if(t&&(r=be(i,i=r)),this.m_transforms.length===0)return void Jve(i,null,r,null,e,null,s);let n=this.m_fastTrack;if(n===1)return void gKe(t,this.m_transforms,h=>{_ot(h.getWrapper(),t!==h.isInverted(),e,null,s)});const o=th();n===-1&&o.initFromGcsAndVcs(i,null);const a=th();let l=t?this.m_transforms.length-1:0;const u=t?-1:1;for(let h=0,m=this.m_transforms.length;h<m;h++,l+=u){if(h===0){const g=this.m_transforms[l];pot(i.getPECoordSys(),null,g.getWrapper(),t!==g.isInverted(),e,null,s,a),n===-1&&(o.equals(a)||(n=0)),o.assign(a)}else{const g=this.m_transforms[l-u],v=this.m_transforms[l];got(o,g.getWrapper(),t!==g.isInverted(),v.getWrapper(),t!==v.isInverted(),e,null,s,a),n===-1&&(o.equals(a)||(n=0)),o.assign(a)}const f=this.m_transforms[l];yot(o,f.getWrapper(),t!==f.isInverted(),e,null,s,a),o.assign(a)}const c=this.m_transforms[l-u];fot(o,c.getWrapper(),t!==c.isInverted(),r,null,e,null,s),n===-1&&(a.initFromGcsAndVcs(r,null),o.equals(a)||(n=0)),this.m_fastTrack=n===0?0:1}};class wB{constructor(){this.m_transforms=[],this.m_inputGCS=null,this.m_outputGCS=null,this.m_name="",this.m_bNameIsSet=!1}getInputSpatialReference(){return this.m_inputGCS!==null?this.m_inputGCS:this.count()>0?this.m_transforms[0].getInputSpatialReference():null}setInputSpatialReference(e){this.m_inputGCS=e?e.getGCS():null}getOutputSpatialReference(){return this.m_outputGCS!==null?this.m_outputGCS:this.count()>0?this.m_transforms.at(-1).getOutputSpatialReference():null}setOutputSpatialReference(e){this.m_outputGCS=e?e.getGCS():null}getName(){if(this.m_bNameIsSet)return this.m_name;if(this.m_transforms.length===0)return"";let e="";for(const s of this.m_transforms)e.length>0&&(e+=" + "),s.isInverted()&&(e+="~"),e+=s.getName();return e}count(){return this.m_transforms.length}getStep(e){return(e<0||e>this.count())&&bt(""),this.m_transforms[e]}setStep(e,s){F(0)}add(e){this.m_transforms.push(e)}addSteps(e,s){if(s)for(let i=e.count()-1;i>=0;--i)this.add(e.getStep(i).getInverse());else for(let i=0;i<e.count();++i)this.add(e.getStep(i))}clear(){this.m_transforms=[],this.m_name="",this.m_bNameIsSet=!1,this.m_inputGCS=null,this.m_outputGCS=null}remove(e){F(0)}create(){const e=this.getInputSpatialReference(),s=this.getOutputSpatialReference(),i=new Pbe(this.m_transforms,this.m_bNameIsSet?this.m_name:null,e,s);return i.m_bReadOnly=!0,this.clear(),i}}const tlt=Object.freeze(Object.defineProperty({__proto__:null,SpatialReference:Bd,SpatialReferencePrecisionDescriptor:Vn,create:h0,createFromWKT:Wb,createImplFromPe:PC,createLocal:vB,createWithNewPrecision:MR,createWithNewVCS:jG,getGCS:pN,getTempName:ybe,hasNoPe:_B,hasPe:tu,injectNoPe:yB,injectPe:qat,isInitialized:IR,isTempName:_be,isValidWkid:bD,isValidWkt:xD,makeSpheroidData:P0,snapGeometry:fbe,webMercator:AR,webMercator102100:bB,wgs84:NR},Symbol.toStringTag,{value:"Module"})),slt=Object.freeze(Object.defineProperty({__proto__:null,OperatorProject:eh},Symbol.toStringTag,{value:"Module"})),ilt=Object.freeze(Object.defineProperty({__proto__:null,CompositeGeographicTransformation:Pbe,CompositeGeographicTransformationEditor:wB,createImpl:Cbe,queryGtListImpl:Ebe},Symbol.toStringTag,{value:"Module"})),rlt=Object.freeze(Object.defineProperty({__proto__:null,GeographicTransformation:kR,create:Kat,createFromPe:Sbe,createFromWKT:elt},Symbol.toStringTag,{value:"Module"})),nlt=Object.freeze(Object.defineProperty({__proto__:null,ProjectionTransformation:pB,create:xat,createEx:N_,createFromAoi:hbe,createImplEx:hB,makeExtendedParams:mB,makeExtendedParamsInternal:dB,queryTransformationList:mbe},Symbol.toStringTag,{value:"Module"})),yE=Object.freeze(Object.defineProperty({__proto__:null,$:Wot,A:_st,B:Wve,C:Ha,D:Xb,get E(){return wn},get F(){return Sa},G:P0,H:Zve,I:Znt,J:Bve,K:jve,L:cbe,M:znt,N:RG,O:nB,P:hs,Q:or,R:CR,S:TR,T:wa,U:W9,V:mN,W:EC,X:eB,Y:Hb,get Z(){return sn},_:cN,a:oB,a0:rve,a1:Pst,a2:FS,a3:Xot,get a4(){return We},a5:sB,a6:Fst,a7:MG,a8:hB,a9:OG,aA:xD,aB:bD,aC:FG,aD:MR,aE:Vn,aF:o0,aG:tlt,aH:slt,aI:ilt,aJ:rlt,aK:nlt,aa:dB,ab:mB,ac:c0,ad:Jl,ae:fve,af:Kve,ag:rB,ah:Zrt,ai:pnt,aj:Vve,ak:Gve,al:unt,am:tu,an:_d,ao:fbe,ap:snt,aq:Ac,ar:Vc,as:wnt,at:Fl,au:ds,av:CP,aw:ybe,get ax(){return Ki},ay:Yot,az:Rst,b:Wb,c:h0,d:iB,e:ER,f:u0,g:Xh,h:pD,i:Bo,j:yB,k:ja,l:Ol,m:lnt,n:Ove,o:uit,p:N_,q:Grt,r:gd,s:Oc,get t(){return TC},u:$G,v:eh,w:Ix,x:Uve,y:hD,z:vB},Symbol.toStringTag,{value:"Module"}));yB(t=>{let e,s;typeof t=="number"?e=t:s=t;const i={wkid:e,wkt:s};let r,n;if(s){r=UD(s);const o=Td(i);if(!r&&!o)throw new Error(`Unsupported WKT type: ${s}`)}else r=!Td(i);return n=e&&ble.has(e)?Math.PI/200:r?zz(i):Math.PI/180,{isPCS:r,metersOrRadiansPerUnit:n,semiMajor:0,wkidOrWkt:t}});function olt(){if(this.m_i===-1)return this.m_i=0,{value:{m_token:1,m_value:null},done:!1};if(this.m_i<this.m_keys.length){const t=this.m_bReturnKey,e=Math.trunc(this.m_i);return this.m_bReturnKey=!this.m_bReturnKey,this.m_i+=.5,t?{value:{m_token:5,m_value:this.m_keys[e]},done:!1}:{value:{m_token:6,m_value:this.m_o[this.m_keys[e]]},done:!1}}return{value:{m_token:3,m_value:null},done:!0}}function alt(){if(this.m_i===-1)return this.m_i=0,{value:{m_token:2,m_value:null},done:!1};if(this.m_i<this.m_a.length){const t={value:{m_token:6,m_value:this.m_a[this.m_i++]},done:!1};return this.m_strict||t.value.m_value===void 0&&(t.value.m_value=Number.NaN),t}return{value:{m_token:4,m_value:null},done:!0}}class llt{createJSONObjectIterator(e){return{m_iteratorType:"object",m_o:e,m_keys:this.m_options.strict?Object.keys(e):Object.keys(e).filter(s=>e[s]!==void 0),m_i:-1,m_bReturnKey:!0,next:olt}}createJSONArrayIterator(e){return{m_iteratorType:"array",m_strict:this.m_options.strict,m_i:-1,m_a:e,next:alt}}constructor(e,s){this.m_currentToken=0,this.m_options=s?{...s}:{strict:!0};const i=e;this.m_iteratorStack=[i instanceof Array?this.createJSONArrayIterator(i):this.createJSONObjectIterator(i)],this.m_nextFlatToken={m_value:null,m_token:0}}nextToken(){if(this.m_iteratorStack.length===0)return this.m_currentToken=0;switch(this.m_nextFlatToken=this.m_iteratorStack.at(-1).next().value,this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_currentToken=1;case 3:return this.m_iteratorStack.pop(),this.m_currentToken=3;case 2:return this.m_currentToken=2;case 4:return this.m_iteratorStack.pop(),this.m_currentToken=4;case 5:return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=5;case 6:if(this.m_nextFlatToken.m_value instanceof Array)return this.m_iteratorStack.push(this.createJSONArrayIterator(this.m_nextFlatToken.m_value)),this.nextToken();if(this.m_nextFlatToken.m_value instanceof Object)return this.m_iteratorStack.push(this.createJSONObjectIterator(this.m_nextFlatToken.m_value)),this.nextToken();if(typeof this.m_nextFlatToken.m_value=="number")return this.m_currentValue=this.m_nextFlatToken.m_value,Number.isSafeInteger(this.m_currentValue)&&this.m_currentValue>=TJe()&&this.m_currentValue<=Qr()?this.m_currentToken=8:this.m_currentToken=7;if(typeof this.m_nextFlatToken.m_value=="string")return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=6;if(typeof this.m_nextFlatToken.m_value=="boolean")return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=this.m_nextFlatToken.m_value?11:12;if(typeof this.m_nextFlatToken.m_value=="object")return this.m_currentValue=null,this.m_currentToken=10;Ce("unrecognized json element type")}return Ce("unrecognized json element type"),0}currentToken(){return this.m_currentToken}skipChildren(){if(this.m_iteratorStack.length!==0)switch(this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=3,void(this.m_currentToken=3);case 2:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=4,void(this.m_currentToken=4)}}currentString(){return this.m_currentToken!==6&&this.m_currentToken!==5&&ee("invalid token"),this.m_currentValue}currentDoubleValue(){return this.m_currentToken!==7&&this.m_currentToken!==8&&ee("invalid token"),this.m_currentValue}currentInt32Value(){return this.m_currentToken!==8&&ee("invalid token"),this.m_currentValue}currentInt64Value(){return F(0),0n}currentBoolValue(){return this.m_currentToken!==12&&this.m_currentToken!==11&&ee("invalid token"),this.m_currentValue}isError(){return 0}}class ult{constructor(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject=[]}reset(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject.length=0}startObject(){const e={};this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}startArray(){const e=[];this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}endObject(){this.m_acceptedObject=this.m_currentObject.at(-1),this.m_currentObject.pop()}endArray(){this.m_currentObject.pop()}addFieldName(e){this.m_pendingKey=e}addValue_(e){this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):this.m_currentObject.at(-1).push(e)}addString(e){this.addValue_(e)}addDouble(e,s){this.addValue_(e)}addInt64(e){F(0)}addInt32(e){this.addValue_(e)}addBool(e){this.addValue_(e)}addNull(){this.addValue_(null)}getObject(){return this.m_acceptedObject}}class m0{constructor(e){return this.m_buffer=null,this.m_view=null,this.m_sz=0,this.m_offset=0,this.m_bOwnsBuffer=!0,this.m_bLittleEndian=!0,this.m_element=new ArrayBuffer(8),this.m_elementBytes=new Uint8Array(this.m_element),this.m_elementView=new DataView(this.m_element),this.m_elementDouble=new Float64Array(this.m_element),this.m_elementFloat=new Float32Array(this.m_element),this.m_elementInt64=new BigInt64Array(this.m_element),this.m_elementInt32=new Int32Array(this.m_element),this.m_elementInt16=new Int16Array(this.m_element),e.sz!==void 0?(this.m_sz=e.sz,e.buffer?(this.m_sz<0&&bt("size out of range"),this.m_buffer=e.buffer,this.m_offset=e.offset!==void 0?e.offset:0,this.m_view=e.offset!==void 0?new DataView(e.buffer,e.offset,e.sz):new DataView(this.m_buffer),this.m_bOwnsBuffer=!1,void(this.m_bLittleEndian=!0)):(this.m_sz<0&&bt("size out of range"),void(this.m_sz>0&&(this.m_buffer=new ArrayBuffer(this.m_sz),this.m_view=new DataView(this.m_buffer))))):e.move?(this.m_sz=e.move.m_sz,this.m_buffer=e.move.m_buffer,this.m_view=e.move.m_view,this.m_bOwnsBuffer=e.move.m_bOwnsBuffer,this.m_bLittleEndian=e.move.m_bLittleEndian,e.move.m_buffer=null,e.move.m_view=null,e.move.m_sz=0,void(e.move.m_bOwnsBuffer=!0)):void Ce("unrecognized constructor options")}swapBytesDouble(){this.doSwap()&&(this.m_elementDouble[0]=this.m_elementBytes[0]<<56|this.m_elementBytes[1]<<48|this.m_elementBytes[2]<<40|this.m_elementBytes[3]<<32|this.m_elementBytes[4]<<24|this.m_elementBytes[5]<<16|this.m_elementBytes[6]<<8|this.m_elementBytes[7])}swapBytesInt32(){this.doSwap()&&(this.m_elementInt32[0]=this.m_elementBytes[0]<<24|this.m_elementBytes[1]<<16|this.m_elementBytes[2]<<8|this.m_elementBytes[3])}getOffset(){return this.m_offset}assignMove(e){return this===e||(this.clear(),this.m_sz=e.m_sz,this.m_buffer=e.m_buffer,this.m_view=e.m_view,this.m_bOwnsBuffer=e.m_bOwnsBuffer,this.m_bLittleEndian=e.m_bLittleEndian,e.m_buffer=null,e.m_sz=0,e.m_bOwnsBuffer=!0),this}doSwap(){return this.m_bLittleEndian!==(m0.getNativeByteOrder()===1)}setNativeByteOrder(){this.m_bLittleEndian=m0.getNativeByteOrder()===1}setOrder(e){this.m_bLittleEndian=e===1}getOrder(){return this.m_bLittleEndian?1:0}getView(){return this.m_view||Us("buffer not defined"),this.m_view}static getNativeByteOrder(){return 1}clear(){this.m_buffer=null,this.m_sz=0,this.m_bOwnsBuffer=!0}size(){return this.m_sz}readDouble(e){return this.doSwap()?(this.m_elementDouble[0]=this.m_view.getFloat64(e,this.m_bLittleEndian),this.swapBytesDouble(),this.m_elementDouble[0]):this.m_view.getFloat64(e,this.m_bLittleEndian)}writeDouble(e,s){this.m_elementDouble[0]=s,this.swapBytesDouble(),this.m_view.setFloat64(e,this.m_elementDouble[0],this.m_bLittleEndian)}readInt32(e){return this.doSwap()?(this.m_elementInt32[0]=this.m_view.getInt32(e,this.m_bLittleEndian),this.swapBytesInt32(),this.m_elementInt32[0]):this.m_view.getInt32(e,this.m_bLittleEndian)}writeInt32(e,s){this.m_elementInt32[0]=s,this.swapBytesInt32(),this.m_view.setInt32(e,this.m_elementInt32[0],this.m_bLittleEndian)}getPtr(){return this.m_buffer}setSizeNoRealloc(e){F(e>=0&&e<=this.m_sz),this.m_sz=e}}function clt(t,e,s,i,r,n){let o=!1,a=!1,l=!1,u=!1,c=!1,h=!1,m=!1,f=!1,g=!1,v=!1,b=!1,w=!1,S=!1,T=!1,P=!1,I=!1,A=!1,D=!1,k=!1,R=!1,O=!1,z=!1,q=!1,U=!1,V=Number.NaN,B=Number.NaN,H=Number.NaN,W=Number.NaN,ie=0,se=Number.NaN,Z=Number.NaN,te=Number.NaN,ve=Number.NaN,ke=Number.NaN,Fe=Number.NaN,Pe=Number.NaN,Ve=Number.NaN,Ke=0,He=0,Rs=!1,Cr=!1,Js=null,as=null,er=null,fi=null,Ks=null;for(;s.nextToken()!==3;){const dt=s.currentString();if(s.nextToken(),dt==="spatialReference"){if(r&&!o){o=!0,s.currentToken()===1?fi=mlt(s):s.currentToken()!==10&&ee("failed to parse spatial reference: object or null is expected");continue}}else if(i)if(dt==="hasZ"){if(!a){a=!0,Rs=s.currentToken()===11;continue}}else if(dt==="hasM"){if(!l){l=!0,Cr=s.currentToken()===11;continue}}else if(dt==="rings"){if(!(c||h||t!==G.enumUnknown&&t!==G.enumPolygon)){c=!0,{geometry:Ks,as:Js,bs:as}=CM(!0,!1,e,s);continue}}else if(dt==="curveRings"){if(!h&&(t===G.enumUnknown||t===G.enumPolygon)){h=!0,{geometry:Ks,as:Js,bs:as}=CM(!0,!0,e,s);continue}}else if(dt==="paths"){if(!(m||f||t!==G.enumUnknown&&t!==G.enumPolyline)){m=!0,{geometry:Ks,as:Js,bs:as}=CM(!1,!1,e,s);continue}}else if(dt==="curvePaths"){if(!f&&(t===G.enumUnknown||t===G.enumPolyline)){f=!0,{geometry:Ks,as:Js,bs:as}=CM(!1,!0,e,s);continue}}else if(dt==="points"){if(!g&&(t===G.enumUnknown||t===G.enumMultiPoint)){g=!0,{geometry:Ks,as:Js,bs:as}=dlt(e,s);continue}}else if(dt==="ids"){if(!u){u=!0,er=plt(e,s);continue}}else if(dt==="x"){if(!v&&(t===G.enumUnknown||t===G.enumPoint)){v=!0,V=Vs(s);continue}}else if(dt==="y"){if(!b&&(t===G.enumUnknown||t===G.enumPoint)){b=!0,B=Vs(s);continue}}else if(dt==="z"){if(!w&&(t===G.enumUnknown||t===G.enumPoint)){w=!0,H=Vs(s);continue}}else if(dt==="m"){if(!S&&(t===G.enumUnknown||t===G.enumPoint)){S=!0,W=Vs(s);continue}}else if(dt==="id"){if(!T&&(t===G.enumUnknown||t===G.enumPoint)){T=!0,ie=_E(s);continue}}else if(dt==="xmin"){if(!P&&(t===G.enumUnknown||t===G.enumEnvelope)){P=!0,se=Vs(s);continue}}else if(dt==="ymin"){if(!I&&(t===G.enumUnknown||t===G.enumEnvelope)){I=!0,Z=Vs(s);continue}}else if(dt==="mmin"){if(!O&&(t===G.enumUnknown||t===G.enumEnvelope)){O=!0,Pe=Vs(s);continue}}else if(dt==="zmin"){if(!k&&(t===G.enumUnknown||t===G.enumEnvelope)){k=!0,ke=Vs(s);continue}}else if(dt==="idmin"){if(!q&&(t===G.enumUnknown||t===G.enumEnvelope)){q=!0,Ke=_E(s);continue}}else if(dt==="xmax"){if(!A&&(t===G.enumUnknown||t===G.enumEnvelope)){A=!0,te=Vs(s);continue}}else if(dt==="ymax"){if(!D&&(t===G.enumUnknown||t===G.enumEnvelope)){D=!0,ve=Vs(s);continue}}else if(dt==="mmax"){if(!z&&(t===G.enumUnknown||t===G.enumEnvelope)){z=!0,Ve=Vs(s);continue}}else if(dt==="zmax"){if(!R&&(t===G.enumUnknown||t===G.enumEnvelope)){R=!0,Fe=Vs(s);continue}}else if(dt==="idmax"){if(!U&&(t===G.enumUnknown||t===G.enumEnvelope)){U=!0,He=_E(s);continue}}else dt==="materials"&&F(0);s.skipChildren()}if(c||h||m||f||g){let dt=null,De=null;const ks=Ks;Rs&&(Ks.addAttribute(1),dt=Js,dt||(dt=fa(ks.getPointCount(),Number.NaN))),Cr&&(Ks.addAttribute(2),De=Rs?as:Js),er!=null&&Ks.addAttribute(3),Rs&&dt!=null&&ks.setAttributeStreamRef(1,dt),Cr&&De!=null&&ks.setAttributeStreamRef(2,De),er!=null&&flt(ks,er)}else if(v||b||S||w||T){iKe(V,B)||ee("failed to parse point: x and y must be finite or nan"),(Number.isNaN(B)||Number.isNaN(V))&&(V=Number.NaN,B=Number.NaN);const dt=new nt({x:V,y:B});w&&dt.setZ(H),S&&dt.setM(W),T&&dt.setID(ie),Ks=dt}else if(P||I||A||D||k||R||O||z||q||U){(Number.isNaN(Z)||Number.isNaN(te)||Number.isNaN(ve))&&(se=Number.NaN);const dt=new Sn({xmin:se,ymin:Z,xmax:te,ymax:ve});k&&R&&dt.setInterval(1,0,ke,Fe),O&&z&&dt.setInterval(2,0,Pe,Ve),q&&U&&dt.setInterval(3,0,Ke,He),Ks=dt}return{...Ks?{geom:Ks}:{},...fi?{sr:fi}:{}}}function hlt(t){let e=!1;for(;t.nextToken()!==3;){const s=t.currentString();t.nextToken(),s==="uwkid"?e||(e=!0,t.currentToken()===8&&t.currentInt32Value()):t.skipChildren()}return null}function mlt(t){let e=!1,s=!1,i=!1,r=!1,n=!1,o=!1,a=!1,l=!1,u=!1,c=!1,h=!1,m=!1,f=!1,g=!1,v=!1,b=!1,w=!1,S=-1,T=-1,P=-1,I=-1,A=0,D=0,k=0,R=0,O=0,z=0,q=0,U=0,V=0,B=0,H="",W="",ie=null;for(;t.nextToken()!==3;){const te=t.currentString();t.nextToken(),te==="wkid"?e||(e=!0,t.currentToken()===8&&(S=t.currentInt32Value())):te==="latestWkid"?s||(s=!0,t.currentToken()===8&&(T=t.currentInt32Value())):te==="wkt"?n||(n=!0,t.currentToken()===6&&(H=t.currentString())):te==="wkt2"?n||t.currentToken()===6&&(W=t.currentString()):te==="vcsWkid"?i||(i=!0,t.currentToken()===8&&(P=t.currentInt32Value())):te==="latestVcsWkid"?r||(r=!0,t.currentToken()===8&&(I=t.currentInt32Value())):te==="xyTolerance"?a||(a=!0,o=!0,A=t.currentDoubleValue()):te==="zTolerance"?l||(l=!0,o=!0,D=t.currentDoubleValue()):te==="mTolerance"?u||(u=!0,o=!0,k=t.currentDoubleValue()):te==="falseX"?c||(c=!0,o=!0,q=t.currentDoubleValue()):te==="falseY"?h||(h=!0,o=!0,U=t.currentDoubleValue()):te==="falseZ"?m||(m=!0,o=!0,V=t.currentDoubleValue()):te==="falseM"?f||(f=!0,o=!0,B=t.currentDoubleValue()):te==="xyUnits"?g||(g=!0,o=!0,R=t.currentDoubleValue()):te==="zUnits"?v||(v=!0,o=!0,O=t.currentDoubleValue()):te==="mUnits"?b||(b=!0,o=!0,z=t.currentDoubleValue()):te==="unit"?w||(w=!0,ie=hlt(t)):t.skipChildren()}I<=0&&P>0&&(I=P),P<=0&&I>0&&(P=I);let se=null,Z=!0;if(H.length!==0&&(Z=!1,xD(H)&&(se=Wb(H))),se||W.length===0||(Z=!1,xD(W)&&(se=Wb(W))),!se&&T>0&&(Z=!1,bD(T)&&(I<=0||FG())&&(se=h0(T,I))),!se&&S>0&&(Z=!1,bD(S)&&(P<=0||FG())&&(se=h0(S,P))),Z&&(se=vB(ie)),o&&se){const te=new Vn;se.queryPrecisionDescriptorWithoutFalseXY(te),a&&te.setTolerance(0,A),l&&te.setTolerance(1,D),u&&te.setTolerance(2,k),g&&c&&h&&te.setGridParams(q,U,R),v&&m&&te.setZParams(V,O),b&&f&&te.setMParams(B,z),se=MR(se,te)}return se}function CM(t,e,s,i){i.currentToken()!==2&&ee("failed to parse multipath: array of array of vertices is expected");const r=t?new wt:new qt,n=r,o=yn(0),a=fa(2,0),l=Oh(0);let u=null,c=null,h=null,m=null,f=null,g=0,v=0,b=0;const w=new ut,S=M.getNAN();let T=0,P=0;const I=t?1:0;for(;i.nextToken()!==4;){i.currentToken()!==2&&ee("failed to parse multipath: ring/path array is expected");let A=2,D=0,k=!0;const R=4;let O=0,z=0;const q=M.getNAN(),U=Me(R,Number.NaN),V=Me(R,Number.NaN);let B=!1;for(i.nextToken();i.currentToken()!==4;){if(e&&i.currentToken()===1)k&&ee("failed to parse multipath: starting vertex array is expected"),h||(h=Oh(T-1,1),m=yn(T-1,-1),f=fa(0)),B=!0,A=1,{segFlag:b,toPointSz:O}=blt(w,U,S,i);else{for(B=!1,i.currentToken()!==2&&ee("failed to parse multipath: array is expected, rings/paths vertices consist of arrays of coordinates"),O=0;i.nextToken()!==4;)O===R&&ee("failed to parse multipath: each vertex array has to have at most 4 elements"),U[O++]=Vs(i);O<2&&ee("failed to parse multipath: each vertex array has to have at least 2 elements"),H0e(U[0],U[1])||ee("failed to parse multipath: x and y must be finite")}i.nextToken();do{if(a.size()===2*T&&a.resize(Tbe(T)),a.writePoint2D(2*T,q.setCoords(U[0],U[1])),u&&u.size()===T&&u.resize(D_(T)),O>2?(u||(u=fa(T+1,Number.NaN)),u.write(T,U[2])):u&&u.write(T,Number.NaN),c&&c.size()===T&&c.resize(D_(T)),O>3?(c||(c=fa(T+1,Number.NaN)),c.write(T,U[3])):c&&c.write(T,Number.NaN),k)P++,o.add(T),l.add(I),k=!1,z=O,$s(V,U,0,0,z);else if(h!==null)if(B){const H=Al(b),W=f.size();f.resize(W+H),h.add(b),m.add(g),w.get().writeInBufferStream(f,g),g+=H,n.incCurveType(b,1),v++}else h.add(1),m.add(-1);T++,D++,S.setCoords(U[0],U[1])}while(D<A&&i.currentToken()===4)}D!==0&&(t&&D>A&&O===z&&yJe(U,V,O)===0?(T--,D--):h!==null&&(h.add(1),m.add(-1)))}return T&&(o.resize(P),l.resize(P),T>0&&(o.add(T),l.add(0)),n.setAttributeStreamRef(0,a),n.setPathFlagsStreamRef(l),n.setPathStreamRef(o),h!==null&&(n.updateCurveCounter(v),n.setSegmentData(m,f,h,g)),n.notifyModifiedFlags(65535)),{geometry:r,as:u,bs:c}}function dlt(t,e){e.currentToken()!==2&&ee("failed to parse multipoint: array of vertices is expected");let s=0;const i=new pi,r=fa(2,0);let n=0;const o=4,a=Me(o,Number.NaN),l=new M;let u=null,c=null;for(;e.nextToken()!==4;){for(e.currentToken()!==2&&ee("failed to parse multipoint: array is expected, multipoint vertices consist of arrays of cooridinates"),n=0;e.nextToken()!==4;)n===o&&ee("failed to parse multipoint: each vertex array has to have at most 4 elements"),a[n++]=Vs(e);n<2&&ee("failed to parse multipoint: each vertex array has to have at least 2 elements"),H0e(a[0],a[1])||ee("failed to parse multipoint: x and y must be finite"),r.size()===2*s&&r.resize(Tbe(s)),r.writePoint2D(2*s,l.setCoords(a[0],a[1])),u&&u.size()===s&&u.resize(D_(s)),n>2?(u||(u=fa(s+1,Number.NaN)),u.write(s,a[2])):u&&u.write(s,Number.NaN),c&&c.size()===s&&c.resize(D_(s)),n>3?(c||(c=fa(s+1,Number.NaN)),c.write(s,a[3])):c&&c.write(s,Number.NaN),s++}if(s){const h=i.getImpl();h.setAttributeStreamRef(0,r),h.resizeNoInit(s),h.notifyModifiedFlags(65535)}return{geometry:i,as:u,bs:c}}function plt(t,e){e.currentToken()!==2&&ee("failed to parse array of IDs: array of array of integers is expected");const s=cR(2,0);let i=0,r=-1;for(;e.nextToken()!==4;){const n=i;s.size()===i&&s.resize(D_(i)),i++;let o=0;for(r===-1?r=e.currentToken()===2?1:0:r===1&&e.currentToken()!==2&&ee("failed to parse array of IDs: array of array of integers is expected"),r===0&&(s.size()===i&&s.resize(D_(i)),s.write(i,_E(e)),o++,i++);e.nextToken()!==4;)s.size()===i&&s.resize(D_(i)),s.write(i,_E(e)),o++,i++;if(s.write(n,o),r===0)break}return s.resize(i),s}function Vs(t){const e=t.currentToken();if(e===10||e===6&&t.currentString()==="NaN")return Number.NaN;{const s=t.currentDoubleValue();return Number.isNaN(s)?Number.NaN:s}}function _E(t){return t.currentInt32Value()}function flt(t,e){if(t.isEmpty())return;const s=cR(2,0),i=t.getGeometryType();let r=0;i===pi.type?r=1:i===qt.type||i===wt.type?r=t.getPathCount():Ce("not implemented"),s.resize(t.getPointCount(),0);let n=0;for(let o=0;o<r;++o){const a=e.read(n);n++;const l=n+a;let u=0,c=0;i===pi.type?u=t.getPointCount():i===qt.type||i===wt.type?(u=t.getPathSize(o),c=t.getPathStart(o)):Ce("not implemented");for(let h=0,m=Math.min(a,u);h<m;++h)s.write(c,e.read(n)),n++,c++;n=l}t.getImpl().setAttributeStreamRef(3,s)}function Tbe(t){let e=2*Math.trunc(3*(t+1)/2);return e<8?e=8:e<32&&(e=32),e}function D_(t){let e=Math.trunc(3*(t+1)/2);return e<4?e=4:e<16&&(e=16),e}function glt(t,e,s,i,r){r>=i.size()&&bt("Byte_buffer out of range access"),t.m_bits=0,t.m_rotation=0,t.m_cosr=1,t.m_sinr=0,t.setStartXY(e),t.setEndXY(s);const n=M.getNAN();n.x=i.readDouble(r),n.y=i.readDouble(r+8);const o=i.readInt32(r+16);if(1&o)return t.m_semiMajorAxis=0,t.m_minorMajorRatio=1,t.m_interior.assign(n),t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0,Ed(t),!1;let a=!!(64&o);const l=!!(128&o);let u=!!(32&o);const c=!!(8&o),h=!!(16&o),m=e.equals(s);return a&&!m&&(a=!1,u=!0),u&&m&&(a=!0,u=!1,n.setCoords(0,0)),a||(l?u?(t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.m_interior.assign(n),t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0):(t.constructCircularArcThreePoint(e,s,n),m&&c===t.isClockwise()&&t.reverse()):u?(t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0,Ed(t),t.queryCoord2D(.5,t.m_interior)):H1e(t,e,s,n,c,h)),a&&(t.m_center.assign(e),t.m_startAngle=n.x,t.m_sweepAngle=n.y,U9(t,Number.NaN,c,h),t.m_semiMajorAxis=0,t.m_minorMajorRatio=1,t.m_interior.setCoordsPoint2D(e)),t.setProjectionBehavior(0),Ed(t),!0}function ylt(t,e,s,i,r){t.m_bits=0,t.m_center.x=i.readDouble(r),t.m_center.y=i.readDouble(r+8),t.m_rotation=i.readDouble(r+16),t.m_semiMajorAxis=i.readDouble(r+24),t.m_minorMajorRatio=i.readDouble(r+32),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=s.x,t.m_YEnd=s.y;const n=i.readInt32(r+40);if(1&n)return!1;let o=!!(64&n),a=!!(128&n);const l=!!(2048&n),u=!!(4096&n);return!(512&n)&&!(1024&n)||a||(o=!0),a&&!e.equals(s)?(a=!1,o=!0):o&&e.equals(s)&&(a=!0,o=!1),a?(t.m_center.assign(e),t.m_startAngle=t.m_center.x,t.m_sweepAngle=t.m_center.y,U9(t,Number.NaN,l,u),t.m_semiMajorAxis=0,t.m_interior.setCoordsPoint2D(e)):o?(t.m_center.setNAN(),t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0,Ed(t),t.queryCoord2D(.5,t.m_interior)):t.constructEllipticArcEndPointsCenter(e,s,t.m_semiMajorAxis,t.m_minorMajorRatio,t.m_rotation,!u,l,t.m_center),t.setProjectionBehavior(1),Ed(t),!0}function _lt(t,e,s,i,r){return F(r+32<=i.size()),t.m_cp=ne(M,2),t.m_cp[0].x=i.readDouble(r),t.m_cp[0].y=i.readDouble(r+8),t.m_cp[1].x=i.readDouble(r+16),t.m_cp[1].y=i.readDouble(r+24),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=s.x,t.m_YEnd=s.y,!0}function vlt(t,e,s,i,r){return t.m_cp.x=i.readDouble(r),t.m_cp.y=i.readDouble(r+8),t.m_weights[0]=i.readDouble(r+16),t.m_weights[1]=i.readDouble(r+24),t.m_weights[2]=i.readDouble(r+32),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=s.x,t.m_YEnd=s.y,!0}function blt(t,e,s,i,r){const n={segFlag:0,toPointSz:0};let o=i.currentToken();o=i.nextToken();const a=i.currentString(),l=a[0];for((a.length!==1||l!=="a"&&l!=="b"&&l!=="c"&&l!=="n"&&l!=="q")&&ee('failed to parse curve: expecting "a", "b", "n", "q", or "c"'),o=i.nextToken(),o!==2&&ee("failed to parse curve: start array is expected for curve parameters"),o=i.nextToken(),o!==2&&ee("failed to parse curve: start array is expected for to point"),n.toPointSz=0;i.nextToken()!==4;)n.toPointSz===4&&ee("failed to parse curve: vertex array cannot have more than 4 elements"),e[n.toPointSz++]=Vs(i);n.toPointSz<2&&ee("failed to parse curve: vertex array must have at least 2 elements");const u=M.construct(e[0],e[1]),c=M.getNAN();let h=-1,m=-1,f=!1,g=Number.NaN,v=Number.NaN,b=Number.NaN;const w=[M.getNAN(),M.getNAN(),M.getNAN()],S=M.getNAN();if(l==="a"){o=i.nextToken(),o!==2&&ee("failed to parse curve: start array is expected for center point"),o=i.nextToken();const T=Vs(i);o=i.nextToken();const P=Vs(i);o=i.nextToken(),o!==4&&ee("failed to parse curve: end array is expected for center point"),c.setCoords(T,P),o=i.nextToken(),h=i.currentInt32Value(),o=i.nextToken(),m=i.currentInt32Value(),o=i.nextToken(),o!==4?(f=!1,g=Vs(i),o=i.nextToken(),v=Vs(i),o=i.nextToken(),b=Vs(i),o=i.nextToken(),o!==4&&ee("failed to parse curve: end array is expected for curve parameters")):f=!0,n.segFlag=4}else if(l==="b"){for(let T=0;T<2;T++){o=i.nextToken(),o!==2&&ee("failed to parse curve: start array is expected for control point"),o=i.nextToken();const P=Vs(i);o=i.nextToken();const I=Vs(i);o=i.nextToken(),o!==4&&ee("failed to parse curve: end array is expected for control point"),w[T].setCoords(P,I)}o=i.nextToken(),o!==4&&ee("failed to parse curve: end array is expected for curve parameters"),n.segFlag=2}else if(l==="n"){{o=i.nextToken(),o!==2&&ee("failed to parse curve: start array is expected for control point"),o=i.nextToken();const A=Vs(i);o=i.nextToken();const D=Vs(i);o=i.nextToken(),o!==4&&ee("failed to parse curve: end array is expected for control point"),w[0].setCoords(A,D)}o=i.nextToken();const T=Vs(i);o=i.nextToken();const P=Vs(i);o=i.nextToken();const I=Vs(i);w[1].setCoords(T,P),w[2].setCoords(I,I),o=i.nextToken(),o!==4&&ee("failed to parse curve: end array is expected for curve parameters"),n.segFlag=8}else if(l==="q"){for(let T=0;T<1;T++){o=i.nextToken(),o!==2&&ee("failed to parse curve: start array is expected for control point"),o=i.nextToken();const P=Vs(i);o=i.nextToken();const I=Vs(i);o=i.nextToken(),o!==4&&ee("failed to parse curve: end array is expected for control point"),w[T].setCoords(P,I)}o=i.nextToken(),o!==4&&ee("failed to parse curve: end array is expected for curve parameters"),n.segFlag=16}else{o=i.nextToken(),o!==2&&ee("failed to parse curve: start array is expected for interior point"),o=i.nextToken();const T=Vs(i);o=i.nextToken();const P=Vs(i);o=i.nextToken(),o!==4&&ee("failed to parse curve: end array is expected for interior point"),S.setCoords(T,P),o=i.nextToken(),o!==4&&ee("failed to parse curve: end array is expected for curve parameters"),n.segFlag=4}return o=i.nextToken(),o!==3&&ee("failed to parse curve: end object is expected for curve"),l==="a"?(t.createEllipticArc(),f?$ne(t.get(),s,u,c,!0,h,m):xlt(t.get(),s,u,c,h,m,g,v,b)):l==="b"?(t.createCubicBezier(),wlt(t.get(),s,u,w)):l==="n"?(t.createQuadraticRationalBezier(),Slt(t.get(),s,u,w[0],w[1].x,w[1].y,w[2].x)):l==="q"?(t.createQuadraticBezier(),t.get().construct(s,w[0],u)):(t.createEllipticArc(),$ne(t.get(),s,u,S,!1,-1,-1)),n}function $ne(t,e,s,i,r,n,o){t.dropAllAttributes();const a=20,l=new ArrayBuffer(a),u=new m0({sz:a,buffer:l});let c=0;u.writeDouble(c,i.x),c+=8,u.writeDouble(c,i.y),c+=8;let h=0;r?(o||(h|=8),n&&(h|=16)):h|=128,u.writeInt32(c,h),c+=4,glt(t,e,s,u,0)}function xlt(t,e,s,i,r,n,o,a,l){t.dropAllAttributes();const u=44,c=new ArrayBuffer(u),h=new m0({sz:u,buffer:c});let m=0;h.writeDouble(m,i.x),m+=8,h.writeDouble(m,i.y),m+=8,h.writeDouble(m,o),m+=8,h.writeDouble(m,a),m+=8,h.writeDouble(m,l),m+=8;let f=0;n||(f|=2048),r&&(f|=4096),h.writeInt32(m,f),m+=4,ylt(t,e,s,h,0)}function wlt(t,e,s,i){t.dropAllAttributes();const r=32,n=new ArrayBuffer(r),o=new m0({sz:r,buffer:n});let a=0;o.writeDouble(a,i[0].x),a+=8,o.writeDouble(a,i[0].y),a+=8,o.writeDouble(a,i[1].x),a+=8,o.writeDouble(a,i[1].y),a+=8,_lt(t,e,s,o,0)}function Slt(t,e,s,i,r,n,o){t.dropAllAttributes();const a=40,l=new ArrayBuffer(a),u=new m0({sz:a,buffer:l});let c=0;u.writeDouble(c,i.x),c+=8,u.writeDouble(c,i.y),c+=8,u.writeDouble(c,r),c+=8,u.writeDouble(c,n),c+=8,u.writeDouble(c,o),c+=8,vlt(t,e,s,u,0)}function Elt(t,e,s,i,r){const n=t.getGeometryType();if(n===G.enumEllipticArc)return Clt(t,e,s,i,r);if(n===G.enumBezier)return Rne(t,e,s,i,r);if(n===G.enumRationalBezier2)return Plt(t,e,s,i,r);if(n===G.enumBezier2){const o=new Hl;return o.constructFromQuadraticSegment(t),Rne(o,e,s,i,r)}yt("")}function Clt(t,e,s,i,r){F(!Y9(t));const n=t.getEndXY(),o=t.hasAttribute(1)&&!e,a=t.hasAttribute(2)&&!s;let l=Number.NaN,u=Number.NaN;if(o&&(l=t.getEndAttributeAsDbl(1,0)),a&&(u=t.getEndAttributeAsDbl(2,0)),t.isDegenerateToLine()||t.isDegenerate(0))return Gv(o,a,n.x,n.y,l,u,i,r),!0;const c=t.projectionBehavior()===0,h=!!c&&t.isClosed();if(c&&!h)r.startObject(),r.addFieldName("c"),r.startArray(),Gv(o,a,n.x,n.y,l,u,i,r),mb(t.m_interior.x,t.m_interior.y,17,r),r.endArray(),r.endObject();else if(c){r.startObject(),r.addFieldName("a"),r.startArray(),Gv(o,a,n.x,n.y,l,u,i,r),mb(t.m_center.x+0,t.m_center.y+0,17,r);const g=!t.isMajor();r.addInt32(g?1:0);const v=t.isClockwise();r.addInt32(v?1:0),r.endArray(),r.endObject()}else{r.startObject(),r.addFieldName("a"),r.startArray(),Gv(o,a,n.x,n.y,l,u,i,r);const m=t;mb(m.m_center.x,m.m_center.y,17,r);const f=!m.isMajor();r.addInt32(f?1:0);const g=m.isClockwise();r.addInt32(g?1:0),r.addDouble(m.m_rotation,17),r.addDouble(m.m_semiMajorAxis,17),r.addDouble(m.m_minorMajorRatio,17),r.endArray(),r.endObject()}return!1}function Rne(t,e,s,i,r){const n=t.getEndXY(),o=t.hasAttribute(1)&&!e,a=t.hasAttribute(2)&&!s;let l=Number.NaN,u=Number.NaN;return o&&(l=t.getEndAttributeAsDbl(1,0)),a&&(u=t.getEndAttributeAsDbl(2,0)),r.startObject(),r.addFieldName("b"),r.startArray(),Gv(o,a,n.x,n.y,l,u,i,r),mb(t.m_cp[0].x,t.m_cp[0].y,i,r),mb(t.m_cp[1].x,t.m_cp[1].y,i,r),r.endArray(),r.endObject(),!1}function Plt(t,e,s,i,r){const n=t.getEndXY(),o=t.hasAttribute(1)&&!e,a=t.hasAttribute(2)&&!s;let l=Number.NaN,u=Number.NaN;o&&(l=t.getEndAttributeAsDbl(1,0)),a&&(u=t.getEndAttributeAsDbl(2,0)),r.startObject(),r.addFieldName("n"),r.startArray(),Gv(o,a,n.x,n.y,l,u,i,r),mb(t.m_cp.x,t.m_cp.y,i,r);const c=i;return r.addDouble(t.m_weights[0],c),r.addDouble(t.m_weights[1],c),r.addDouble(t.m_weights[2],c),r.endArray(),r.endObject(),!1}function Gv(t,e,s,i,r,n,o,a){a.startArray(),a.addDouble(s,o),a.addDouble(i,o),t&&a.addDouble(r,o),e&&a.addDouble(n,o),a.endArray()}function mb(t,e,s,i){i.startArray(),i.addDouble(t,s),i.addDouble(e,s),i.endArray()}class Tlt{getOperatorType(){return 10405}accelerateGeometry(e,s,i){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,s,i,r,n,o){Ilt(e,s,i,r)}exportSpatialReference(e,s,i,r){F(0)}exportProjectionTransformation(e,s,i,r){F(0)}exportDatumTransformation(e,s,i,r){F(0)}static geometryTypeToString(e){return F(0),""}}function Ilt(t,e,s,i,r){if(e||s){if(i.startObject(),e!==null)switch(e.getGeometryType()){case G.enumPolygon:kne(!0,t,e,i);break;case G.enumPolyline:kne(!1,t,e,i);break;case G.enumMultiPoint:Mlt(t,e,i);break;case G.enumPoint:Alt(t,e,i);break;case G.enumEnvelope:Nlt(t,e,i);break;case G.enumMultipatch:F(0);break;default:Ce("exportToJSON")}s!==null&&(i.addFieldName("spatialReference"),$lt(t,s,i)),i.endObject()}}function kne(t,e,s,i){const r=s.getImpl(),n=!!(2&e),o=!!(4&e),a=!!(8&e),l=r.hasAttribute(1)&&!n,u=r.hasAttribute(2)&&!o,c=r.hasAttribute(3)&&!a,h=r.hasNonLinearSegments();l&&(i.addFieldName("hasZ"),i.addBool(!0)),u&&(i.addFieldName("hasM"),i.addBool(!0)),t?h?i.addFieldName("curveRings"):i.addFieldName("rings"):h?i.addFieldName("curvePaths"):i.addFieldName("paths");let m=null;const f=[];if(s.isEmpty())i.startArray(),i.endArray();else{const g=17-(31&e>>13);i.startArray();const v=s.getPathCount();let b=0;const w=r.getAttributeStreamRef(0);let S=null,T=null,P=null;const I=new ut;let A=null,D=null,k=null;h&&(A=r.getSegmentFlagsStreamRef(),D=r.getSegmentIndexStreamRef(),k=r.getSegmentDataStreamRef()),l&&(S=r.getAttributeStreamRef(1)),u&&(T=r.getAttributeStreamRef(2)),c&&(P=r.getAttributeStreamRef(3),m=C9(3,0));for(let R=0;R<v;R++){i.startArray(),c&&f.push(0);const O=s.getPathEnd(R);if(b===O){i.endArray();continue}const z=s.isClosedPath(R);let q=w.read(2*b),U=w.read(2*b+1),V=l?S.read(b):Number.NaN,B=u?T.read(b):Number.NaN,H=c?P.read(b):0;LS(l,u,q,U,V,B,g,i);let W=1;c&&(m.add(H),f[f.length-1]++);const ie=q,se=U,Z=V,te=B,ve=H;let ke=!1,Fe=0,Pe=Number.NaN,Ve=Number.NaN,Ke=0;for(let He=b+1,Rs=b,Cr=z?O+1:O;He<Cr;He++,Rs++){const Js=A!==null?31&A.read(Rs):1;let as,er;if(He<O?(as=w.read(2*He),er=w.read(2*He+1),l&&(Pe=S.read(He)),u&&(Ve=T.read(He)),c&&(Ke=P.read(He))):(as=ie,er=se,Pe=Z,Ve=te,Ke=ve),Js!==1){ke=!0,Js===4?I.createEllipticArc():Js===2?I.createCubicBezier():Js===16?I.createQuadraticBezier():Js===8?I.createQuadraticRationalBezier():yt("JSON export.unsupported curve");const fi=I.get(),Ks=D.read(Rs);fi.setStartXYCoords(q,U),fi.setEndXYCoords(as,er),l&&(fi.setStartAttribute(1,0,V),fi.setEndAttribute(1,0,Pe)),u&&(fi.setStartAttribute(2,0,B),fi.setEndAttribute(2,0,Ve)),fi.readFromBufferStream(k,Ks),Elt(I.get(),n,o,g,i)&&Fe++}else LS(l,u,as,er,Pe,Ve,g,i);c&&(m.add(Ke),f[f.length-1]++),W++,q=as,U=er,V=Pe,B=Ve,H=Ke}ke&&Fe===0||(W<2&&Fe<1&&(LS(l,u,q,U,V,B,g,i),W++,c&&(m.add(H),f[f.length-1]++)),z&&W<3&&Fe<2&&(LS(l,u,ie,se,Z,te,g,i),W++,q=ie,U=se,V=Z,B=te,H=ve,c&&(m.add(ve),f[f.length-1]++))),i.endArray(),b=O}i.endArray()}if(c){i.addFieldName("ids"),i.startArray();let g=0;for(let v=0,b=f.length;v<b;++v){const w=f[v];F(w===0||m!==null&&g+w<=m.size()),i.startArray();for(let S=0;S<w;++S)i.addInt32(m.read(g)),g++;i.endArray()}i.endArray()}}function Mlt(t,e,s){const i=e.getImpl(),r=i.hasAttribute(1)&&!(2&t),n=i.hasAttribute(2)&&!(4&t),o=i.hasAttribute(3)&&!(8&t);r&&(s.addFieldName("hasZ"),s.addBool(!0)),n&&(s.addFieldName("hasM"),s.addBool(!0)),s.addFieldName("points");const a=e.getPointCount();if(e.isEmpty())s.startArray(),s.endArray();else{const l=17-(31&t>>13);s.startArray();const u=i.getAttributeStreamRef(0);let c=null,h=null;r&&(c=i.getAttributeStreamRef(1)),n&&(h=i.getAttributeStreamRef(2));for(let m=0;m<a;m++){const f=u.read(2*m),g=u.read(2*m+1);let v=Number.NaN,b=Number.NaN;r&&(v=c.read(m)),n&&(b=h.read(m)),LS(r,n,f,g,v,b,l,s)}s.endArray()}if(o){let l=null;i.isEmpty()||(l=i.getAttributeStreamRef(3)),F(a===0||l!==null&&l.size()>=a),s.addFieldName("ids"),s.startArray();for(let u=0;u<a;u++)s.addInt32(l.read(u));s.endArray()}}function Alt(t,e,s){const i=e.hasAttribute(1)&&!(2&t),r=e.hasAttribute(2)&&!(4&t),n=e.hasAttribute(3)&&!(8&t);if(e.isEmpty())return s.addFieldName("x"),s.addNull(),s.addFieldName("y"),s.addNull(),i&&(s.addFieldName("z"),s.addNull()),r&&(s.addFieldName("m"),s.addNull()),void(n&&(s.addFieldName("id"),s.addInt32(0)));const o=17-(31&t>>13);s.addFieldName("x"),s.addDouble(e.getX(),o),s.addFieldName("y"),s.addDouble(e.getY(),o),i&&(s.addFieldName("z"),s.addDouble(e.getZ(),o)),r&&(s.addFieldName("m"),s.addDouble(e.getM(),o)),n&&(s.addFieldName("id"),s.addInt32(e.getID()))}function Nlt(t,e,s){const i=e.hasAttribute(1)&&!(2&t),r=e.hasAttribute(2)&&!(4&t),n=e.hasAttribute(3)&&!(8&t);if(e.isEmpty())return s.addFieldName("xmin"),s.addNull(),s.addFieldName("ymin"),s.addNull(),s.addFieldName("xmax"),s.addNull(),s.addFieldName("ymax"),s.addNull(),i&&(s.addFieldName("zmin"),s.addNull(),s.addFieldName("zmax"),s.addNull()),r&&(s.addFieldName("mmin"),s.addNull(),s.addFieldName("mmax"),s.addNull()),void(n&&(s.addFieldName("idmin"),s.addInt32(0),s.addFieldName("idmax"),s.addInt32(0)));const o=17-(31&t>>13);if(s.addFieldName("xmin"),s.addDouble(e.getXMin(),o),s.addFieldName("ymin"),s.addDouble(e.getYMin(),o),s.addFieldName("xmax"),s.addDouble(e.getXMax(),o),s.addFieldName("ymax"),s.addDouble(e.getYMax(),o),i){const a=e.queryInterval(1,0);s.addFieldName("zmin"),s.addDouble(a.vmin,o),s.addFieldName("zmax"),s.addDouble(a.vmax,o)}if(r){const a=e.queryInterval(2,0);s.addFieldName("mmin"),s.addDouble(a.vmin,o),s.addFieldName("mmax"),s.addDouble(a.vmax,o)}if(n){const a=e.queryInterval(3,0);s.addFieldName("idmin"),s.addInt32(a.vmin),s.addFieldName("idmax"),s.addInt32(a.vmax)}}function Dlt(t,e,s){s.startObject();const i=e.getID();i<=0&&ee("cannot export unit that has no valid WKID"),s.addFieldName("uwkid"),s.addInt32(i),s.endObject()}function $lt(t,e,s){s.startObject();let i=0;e.isCustomWkid()||(i=e.getOldID());let r=0;const n=e.getVCS();if(n!==null&&(n.isCustomWkid()||(r=n.getOldID()),r<=0&&(i=0)),i>0){s.addFieldName("wkid"),s.addInt32(i);const o=e.getLatestID();if(o>0&&o!==i&&(s.addFieldName("latestWkid"),s.addInt32(o)),r>0){s.addFieldName("vcsWkid"),s.addInt32(r);const a=e.getLatestVerticalID();a!==r&&(s.addFieldName("latestVcsWkid"),s.addInt32(a))}}if(e.getCoordinateSystemType()===0)s.addFieldName("wkid"),s.addNull(),e.getUnit()!==null&&(s.addFieldName("unit"),Dlt(t,e.getUnit(),s));else if(i<=0||1&t){let o="";64&t&&(o=e.getText2(),s.addFieldName("wkt2"),s.addString(o));const a=e.getText();a!==o&&(s.addFieldName("wkt"),s.addString(a))}if(16&t){const o=new Vn;e.queryPrecisionDescriptor(o),s.addFieldName("xyTolerance"),s.addDouble(o.getTolerance(0)),s.addFieldName("zTolerance"),s.addDouble(o.getTolerance(1)),s.addFieldName("mTolerance"),s.addDouble(o.getTolerance(2)),s.addFieldName("falseX"),s.addDouble(o.getFalseX()),s.addFieldName("falseY"),s.addDouble(o.getFalseY()),s.addFieldName("xyUnits"),s.addDouble(o.getGridUnitsXY()),s.addFieldName("falseZ"),s.addDouble(o.getFalseZ()),s.addFieldName("zUnits"),s.addDouble(o.getGridUnitsZ()),s.addFieldName("falseM"),s.addDouble(o.getFalseM()),s.addFieldName("mUnits"),s.addDouble(o.getGridUnitsM())}s.endObject()}function LS(t,e,s,i,r,n,o,a){a.startArray(),a.addDouble(s,o),a.addDouble(i,o),t&&a.addDouble(r,o),e&&a.addDouble(n,o),a.endArray()}const it={s_a:97,s_A:65,s_asterisk:42,s_b:98,s_backslash:92,s_beginArray:91,s_beginObject:123,s_colon:58,s_period:46,s_comma:44,s_doubleQuote:34,s_endArray:93,s_endObject:125,s_e:101,s_E:69,s_f:102,s_F:70,s_forwardslash:47,s_minus:45,s_plus:43,s_n:110,s_N:78,s_r:114,s_t:116,s_u:117,s_zero:48,s_nine:57};class Rlt{constructor(e){this.m_functionStack=[],this.m_pushPositions=[],this.m_utf8Decoder=new TextDecoder("utf-8",{fatal:!0}),e===void 0?(this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_endToken=0,this.m_currentTokenType=0,this.m_functionStack.push(()=>this.accept_()),this.m_jsonString=null,this.m_bHasEscapes=!1):e.jsonString?this.resetParserFromString(e.jsonString):e.jsonStream?yt("streaming json parsing not yet impl"):Ce("invalid constructor parameter")}prepSubstrString_(){}getCurrentSubstrString_(){return this.m_jsonString.slice(this.m_startToken,this.m_endToken)}stepOverCharString_(){this.m_endToken++}peekCharString_(){return this.m_jsonString.charCodeAt(this.m_endToken)}getString_(e){var i;const s=(i=this.m_jsonString)==null?void 0:i.slice(this.m_startToken,this.m_startToken+e-1);return this.m_endToken+=e-1,{s,bDone:this.m_endToken>=this.m_jsonString.length}}incrementString_(){this.m_endToken++}eofString_(){return this.m_endToken>=this.m_jsonString.length}setStringFunctions_(){this.m_prepSubstr=this.prepSubstrString_,this.m_getCurrentSubstr=this.getCurrentSubstrString_,this.m_stepOverChar=this.stepOverCharString_,this.m_peekChar=this.peekCharString_,this.m_get=this.getString_,this.m_increment=this.incrementString_,this.m_eof=this.eofString_}setStreamFunctions_(){yt("streaming json parsing not yet impl")}reset_(){this.m_jsonString=null,this.m_endToken=0,this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_currentTokenType=0,this.m_bHasEscapes=!1,this.m_functionStack.length=0,this.m_functionStack.push(()=>this.start_()),this.m_pushPositions.length=0}resetParserFromString(e){this.reset_(),this.setStringFunctions_(),this.m_jsonString=e}resetParserFromStream(e){yt("streaming json parsing not yet impl")}resetToPosition(e){return F(0),!1}nextToken(){return this.m_functionStack.at(-1)(),this.m_currentTokenType}currentToken(){return this.m_currentTokenType}currentTokenStartIndex(){return this.m_startToken}currentTokenEndIndex(){return this.m_endToken}currentText(){return F(0),""}childrenAsString(){return F(0),""}skipChildren(){this.skipChildren_()}skipChildren_(){if(this.m_currentTokenType!==1){if(this.m_currentTokenType===2){let e=1;do this.m_currentTokenType=this.nextToken(),this.m_currentTokenType===2?e++:this.m_currentTokenType===4&&e--;while(this.m_currentTokenType!==4||e!==0)}}else{let e=1;do this.m_currentTokenType=this.nextToken(),this.m_currentTokenType===1?e++:this.m_currentTokenType===3&&e--;while(this.m_currentTokenType!==3||e!==0)}}currentTerminalAsString_(){switch(this.m_currentTokenType){case 7:case 8:case 9:return this.m_getCurrentSubstr().slice(0,this.m_endToken-this.m_startToken);case 10:return"null";case 11:return"true";case 12:return"false"}ee("invalid token")}toUTF8_(e,s){let i=0,r=e;for(;s.charCodeAt(r)===it.s_backslash&&s.charCodeAt(r+1)===it.s_u;)i++,r+=6;r=e;const n=new Uint8Array(i);let o=0;for(;s.charCodeAt(r)===it.s_backslash&&s.charCodeAt(r+1)===it.s_u;)n[o++]=Number.parseInt(s.slice(r+2,r+6),16),r+=6;return{u8s:this.m_utf8Decoder.decode(n),end:r}}unquoteCurrentString_(){let e="",s=1;const i=this.m_endToken-this.m_startToken-1;let r=0;const n=this.m_getCurrentSubstr();for(let o=s;o<i;o++)if(n.charCodeAt(o)!==it.s_backslash)r++;else{switch(r>0&&(e+=n.slice(s,s+r)),n.charCodeAt(++o)){case it.s_doubleQuote:e+='"';break;case it.s_u:{const{u8s:a,end:l}=this.toUTF8_(o-1,n);o=l-1,e+=a;break}case it.s_backslash:e+="\\";break;case it.s_forwardslash:e+="/";break;case it.s_b:e+="\b";break;case it.s_f:e+="\f";break;case it.s_n:e+=`
`;break;case it.s_r:e+="\r";break;case it.s_t:e+="	"}s=o+1,r=0}return r>0&&(e+=n.slice(s,s+r)),e}currentString(){return this.m_currentTokenType!==5&&this.m_currentTokenType!==6?this.currentTerminalAsString_():this.m_bHasEscapes?this.unquoteCurrentString_():this.m_getCurrentSubstr().slice(1,this.m_endToken-this.m_startToken-2+1)}currentDoubleValue(){if(this.m_currentTokenType!==7&&this.m_currentTokenType!==8&&this.m_currentTokenType!==9&&this.m_currentTokenType!==6&&this.m_currentTokenType!==10&&ee("invalid token"),this.m_currentTokenType===10)return Number.NaN;let e=this.m_getCurrentSubstr(),s=this.m_endToken-this.m_startToken;if(this.m_currentTokenType===6){if(this.currentString()==="NaN")return Number.NaN;e=e.slice(1),s-=2,s===0&&ee("invalid token")}const i=Number.parseFloat(e);if(this.m_currentTokenType===6)Number.isNaN(i)&&ee("invalid token");else if(Number.isNaN(i))return Number.NaN;return i}currentInt32Value(){this.m_currentTokenType!==8&&this.m_currentTokenType!==6&&ee("invalid token");let e=this.m_getCurrentSubstr(),s=this.m_endToken-this.m_startToken;this.m_currentTokenType===6&&(e=e.slice(1),s-=2,s===0&&ee("invalid token"));const i=parseInt(e);return Number.isNaN(i)&&ee("invalid token"),i}currentInt64Value(){return F(0),0n}currentBoolValue(){return F(0),!1}isError(){return 0}JSONString(){return F(0),""}pushPosition(){return F(0),!1}popPosition(){return F(0),!1}skipCStyleComments_(){F(0)}skipCppStyleComments_(){F(0)}skipComments_(){this.m_prepSubstr();let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&ee("invalid token"),e=this.m_peekChar(),e===it.s_asterisk?this.skipCStyleComments_():e===it.s_forwardslash?this.skipCppStyleComments_():ee("invalid token")}skipWhiteSpace_(){let e;do{this.m_eof()&&ee("invalid token");let s=this.m_peekChar();for(;s>=9&&s<=13||s===32;)this.m_increment(),this.m_eof()&&ee("invalid token"),s=this.m_peekChar();s===it.s_forwardslash?(this.m_startToken=this.m_endToken,e=!0,this.skipComments_()):e=!1}while(e)}rightBracket_(){return this.m_peekChar()===it.s_endArray&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=4,!0)}rightBrace_(){return this.m_peekChar()===it.s_endObject&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=3,!0)}string_(){this.m_prepSubstr(),this.m_bHasEscapes=!1,this.m_stepOverChar(),this.m_eof()&&ee("invalid token");let e=this.m_peekChar();for(;e!==it.s_doubleQuote;){const s=e===it.s_backslash;if(this.m_stepOverChar(),this.m_eof()&&ee("invalid token"),e=this.m_peekChar(),s)if(this.m_bHasEscapes=!0,e===it.s_doubleQuote||e===it.s_backslash||e===it.s_forwardslash||e===it.s_b||e===it.s_f||e===it.s_n||e===it.s_r||e===it.s_t)this.m_stepOverChar(),this.m_eof()&&ee("invalid token"),e=this.m_peekChar();else if(e===it.s_u)for(let i=0;i<4;i++)this.m_stepOverChar(),this.m_eof()&&ee("invalid token"),e=this.m_peekChar(),e>=it.s_zero&&e<=it.s_nine||e>=it.s_a&&e<=it.s_f||e>=it.s_A&&e<=it.s_F||ee("invalid token");else ee("invalid token")}this.m_stepOverChar()}comma_(){return this.m_peekChar()===it.s_comma&&(this.m_increment(),!0)}colon_(){return this.m_peekChar()===it.s_colon&&(this.m_increment(),!0)}fieldNameEnd_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.colon_()?(this.skipWhiteSpace_(),this.value_()):ee("invalid token")}fieldNameStart_(){this.m_startToken=this.m_endToken,this.m_peekChar()!==it.s_doubleQuote&&ee("invalid token"),this.string_(),this.m_currentTokenType=5,this.m_functionStack.push(()=>this.fieldNameEnd_())}pairEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.fieldNameStart_()):this.rightBrace_()?this.m_functionStack.pop():ee("invalid token")}arrayStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBracket_()||(this.m_functionStack.push(()=>this.elementEnd_()),this.value_())}elementEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.value_()):this.rightBracket_()?this.m_functionStack.pop():ee("invalid token")}objectStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBrace_()||(this.m_functionStack.push(()=>this.pairEnd_()),this.fieldNameStart_())}valueStartObject_(){this.m_increment(),this.m_currentTokenType=1,this.m_functionStack.push(()=>this.objectStart_())}valueStartArray_(){this.m_increment(),this.m_currentTokenType=2,this.m_functionStack.push(()=>this.arrayStart_())}valueString_(){this.string_(),this.m_currentTokenType=6}int_(){this.m_peekChar()!==it.s_zero?this.digits_():this.m_stepOverChar()}digits_(){let e=this.m_peekChar();do this.m_stepOverChar(),this.m_eof()&&ee("invalid token"),e=this.m_peekChar();while(e>=it.s_zero&&e<=it.s_nine)}frac_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&ee("invalid token"),e=this.m_peekChar(),e>=it.s_zero&&e<=it.s_nine||ee("invalid token"),this.digits_()}exp_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&ee("invalid token"),e=this.m_peekChar(),e!==it.s_plus&&e!==it.s_minus||(this.m_stepOverChar(),this.m_eof()&&ee("invalid token"),e=this.m_peekChar()),e>=it.s_zero&&e<=it.s_nine||ee("invalid token"),this.digits_()}valueNumber_(){this.m_prepSubstr();let e=!1,s=this.m_peekChar();if(s===it.s_minus?(this.m_stepOverChar(),this.m_eof()&&ee("invalid token"),s=this.m_peekChar(),e=!0,s>=it.s_zero&&s<=it.s_nine||ee("invalid token"),this.int_()):this.int_(),s=this.m_peekChar(),s===it.s_period)this.m_currentTokenType=7,this.frac_(),s=this.m_peekChar(),s!==it.s_e&&s!==it.s_E||this.exp_();else if(s===it.s_e||s===it.s_E)this.m_currentTokenType=7,this.exp_();else{let i=0;e&&i++;const r=this.m_endToken-this.m_startToken-i;if(r<10)this.m_currentTokenType=8;else if(r===10){const n=this.m_getCurrentSubstr();e?n.slice(i)<="2147483648"?this.m_currentTokenType=8:this.m_currentTokenType=9:n.slice(i)<="2147483647"?this.m_currentTokenType=8:this.m_currentTokenType=9}else if(r<19)this.m_currentTokenType=9;else if(r===19){const n=this.m_getCurrentSubstr();e?n.slice(i)<="9223372036854775808"?this.m_currentTokenType=9:this.m_currentTokenType=7:n.slice(i)<="9223372036854775807"?this.m_currentTokenType=9:this.m_currentTokenType=7}else this.m_currentTokenType=7}}valueNull_(){const{s:e,bDone:s}=this.m_get(5);s&&ee("invalid token"),e!=="null"&&ee("invalid token"),this.m_currentTokenType=10}valueTrue_(){const{s:e,bDone:s}=this.m_get(5);s&&ee("invalid token"),e!=="true"&&ee("invalid token"),this.m_currentTokenType=11}valueFalse_(){const{s:e,bDone:s}=this.m_get(6);s&&ee("invalid token"),e!=="false"&&ee("invalid token"),this.m_currentTokenType=12}valueNan_(){const{s:e,bDone:s}=this.m_get(4);s&&ee("invalid token"),e!=="NaN"&&ee("invalid token"),this.m_currentTokenType=7}value_(){this.m_startToken=this.m_endToken;const e=this.m_peekChar();e===it.s_beginObject?this.valueStartObject_():e===it.s_beginArray?this.valueStartArray_():e===it.s_doubleQuote?this.valueString_():e===it.s_minus||e>=it.s_zero&&e<=it.s_zero+9?this.valueNumber_():e===it.s_n?this.valueNull_():e===it.s_t?this.valueTrue_():e===it.s_f?this.valueFalse_():e===it.s_N?this.valueNan_():ee("invalid token")}start_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.m_functionStack.push(()=>this.accept_());const e=this.m_peekChar();e!==it.s_beginObject&&e!==it.s_beginArray&&ee("invalid token"),this.value_()}accept_(){this.m_startToken=this.m_endToken,this.m_currentTokenType=0}}class klt{getOperatorType(){return 10404}accelerateGeometry(e,s,i){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,s,i,r,n,o,a){let l;typeof i=="string"?(l=new Rlt({jsonString:i}),l.nextToken()):l=i,l.currentToken()!==1&&ee("failed to import map geometry: start of object is expected");const u=clt(s,e,l,r,n);return new o0(u)}importProjectionTransformation(e,s){return F(0),{}}importDatumTransformation(e,s){return F(0),{}}static stringToGeometryType(e){return(e=e.toLowerCase()).startsWith("esrigeometry")||ee("string_to_geometry_type"),e.endsWith("point")?G.enumPoint:e.endsWith("envelope")?G.enumEnvelope:e.endsWith("multipoint")?G.enumMultiPoint:e.endsWith("polyline")?G.enumPolyline:e.endsWith("polygon")?G.enumPolygon:void ee("string_to_geometry_type")}}const DL=new ult,Flt=new Tlt,Olt=new klt;function Llt(t){return Array.isArray(t)?t[0].spatialReference:t.spatialReference}function Ibe(t,e){const s=new llt(t,{strict:!1});return s.nextToken(),Olt.execute(0,G.enumUnknown,s,!0,e)}function Vlt(t){let e=null;return[t.map(s=>{if(e==null){const i=Mbe(s);return e=i.getSpatialReference(),i.getGeometry()}return FR(s)}),e]}function Mbe(t){return Ibe(t,!0)}function FR(t){return Ibe(t,!1).getGeometry()}function SB(t,e){return t instanceof o0&&(e=t.getSpatialReference(),t=t.getGeometry()),t!=null&&t.isEmpty()?null:(DL.reset(),Flt.execute(0,t,e,DL),DL.getObject())}const Kbt=Object.freeze(Object.defineProperty({__proto__:null,fromGeometries:Vlt,fromGeometry:Mbe,fromGeometryToGXGeometry:FR,getSpatialReference:Llt,toGeometry:SB},Symbol.toStringTag,{value:"Module"})),rn="_gxVersion",Abe=2,Nbe=1;function Dbe(t){return Array.isArray(t)?t[0].spatialReference:t.spatialReference}function wD(t){switch(t.type){case"point":return kbe(t);case"multipoint":return Rbe(t);case"polyline":return Obe(t);case"polygon":return Fbe(t);case"extent":return $be(t);default:throw new Error(`Unsupported geometry type: ${t.type}`)}}function $be(t){if(!t.getCacheValue(rn)){const e=new Sn;e.setCoords(t.xmin,t.ymin,t.xmax,t.ymax),t.hasM&&e.setInterval(Abe,0,t.mmin,t.mmax),t.hasZ&&e.setInterval(Nbe,0,t.zmin,t.zmax),t.setCacheValue(rn,e)}return t.getCacheValue(rn)}function Rbe(t){if(!t.getCacheValue(rn)){const e=new pi,s=new nt,i=t.points,r=t.hasM,n=t.hasZ,o=n?3:2;for(let a=0,l=i.length;a<l;a++){const u=i[a];s.setXYCoords(u[0],u[1]),n&&s.setZ(u[2]??0),r&&s.setM(u[o]??NaN),e.add(s)}t.setCacheValue(rn,e)}return t.getCacheValue(rn)}function kbe(t){if(!t.getCacheValue(rn)){const e=new nt;e.setXYCoords(t.x,t.y),t.hasM&&e.setM(t.m),t.hasZ&&e.setZ(t.z),t.setCacheValue(rn,e)}return t.getCacheValue(rn)}function Fbe(t){if(!t.getCacheValue(rn)){const{curveRings:e,hasM:s,hasZ:i,rings:r}=t,n=FR({curveRings:e,hasM:s,hasZ:i,rings:r});t.setCacheValue(rn,n)}return t.getCacheValue(rn)}function Obe(t){if(!t.getCacheValue(rn)){const{curvePaths:e,hasM:s,hasZ:i,paths:r}=t,n=FR({curvePaths:e,hasM:s,hasZ:i,paths:r});t.setCacheValue(rn,n)}return t.getCacheValue(rn)}function EB(t){if(t.wkid)return h0(t.wkid);const e=t.wkt2||t.wkt;return e?Wb(e):null}function qlt(t,e){if(t)switch(t.getGeometryType()){case G.enumPoint:return qbe(t,e);case G.enumEnvelope:return Lbe(t,e);case G.enumMultiPoint:return Vbe(t,e);case G.enumPolyline:return zbe(t,e);case G.enumPolygon:return Gbe(t,e)}return null}function Lbe(t,e){if(t.isEmpty())return null;const s=new Hs({xmin:t.getXMin(),ymin:t.getYMin(),xmax:t.getXMax(),ymax:t.getYMax(),spatialReference:e}),i=t.getDescription();if(i.hasM()){const r=t.queryInterval(Abe,0);s.mmin=r.vmin,s.mmax=r.vmax}if(i.hasZ()){const r=t.queryInterval(Nbe,0);s.zmin=r.vmin,s.zmax=r.vmax}return s.setCacheValue(rn,t),s}function Vbe(t,e){if(t.isEmpty())return null;const s=t.getDescription(),i=s.hasM(),r=s.hasZ(),n=[],o=new nt;for(let l=0,u=t.getPointCount();l<u;l++){t.getPointByVal(l,o);const c=[o.getX(),o.getY()];r&&c.push(o.getZ()),i&&c.push(o.getM()),n.push(c)}const a=new qC({hasM:i,hasZ:r,points:n,spatialReference:e});return a.setCacheValue(rn,t),a}function qbe(t,e){if(t instanceof M)return new Et({x:t.x,y:t.y,spatialReference:e});if(t.isEmpty())return null;const s=new Et({x:t.getX(),y:t.getY(),spatialReference:e}),i=t.getDescription();return i.hasM()&&(s.m=t.getM()),i.hasZ()&&(s.z=t.getZ()),s.setCacheValue(rn,t),s}function Gbe(t,e){if(t.isEmpty())return null;const s=po.fromJSON({spatialReference:e,...SB(t,null)});return s.setCacheValue(rn,t),s}function zbe(t,e){if(t.isEmpty())return null;const s=Vl.fromJSON({spatialReference:e,...SB(t,null)});return s.setCacheValue(rn,t),s}const Glt=Object.freeze(Object.defineProperty({__proto__:null,fromExtent:$be,fromGeometry:wD,fromMultipoint:Rbe,fromPoint:kbe,fromPolygon:Fbe,fromPolyline:Obe,fromSpatialReference:EB,getSpatialReference:Dbe,toExtent:Lbe,toGeometry:qlt,toMultipoint:Vbe,toPoint:qbe,toPolygon:Gbe,toPolyline:zbe},Symbol.toStringTag,{value:"Module"})),CB=new nB;function zlt(t){const e=Dbe(t);return CB.accelerateGeometry(wD(t),EB(e),1)}function Ube(t,e){return CB.execute(wD(t),wD(e),EB(t.spatialReference),null)}const Ult=CB.supportsCurves(),ext=Object.freeze(Object.defineProperty({__proto__:null,accelerateGeometry:zlt,execute:Ube,supportsCurves:Ult},Symbol.toStringTag,{value:"Module"}));let OR;function Bbe(){return!!OR&&qD()}async function Blt(){if(!Bbe()){const[t,e]=await Promise.all([me(()=>Promise.resolve().then(()=>yE),void 0).then(s=>s.aH),me(()=>Promise.resolve().then(()=>yE),void 0).then(s=>s.aG).then(({injectPe:s})=>s),Oz()]);OR=new t.OperatorProject,e(ule)}}function jlt(t,e){return OR.execute(t,e,null)}function Hlt(){return OR.supportsCurves()}let jbe,PB,WG,Hbe,Ybe,Xbe,Wbe,Zbe,Qbe,Jbe,Kbe;function Ylt(){return!!PB&&Bbe()}async function Xlt(){if(!Ylt()){const[t,e,s,i]=await Promise.all([me(()=>Promise.resolve().then(()=>Glt),void 0),me(()=>Promise.resolve().then(()=>yE),void 0).then(r=>r.aI).then(({CompositeGeographicTransformation:r})=>r),me(()=>Promise.resolve().then(()=>yE),void 0).then(r=>r.aJ).then(({create:r,createFromWKT:n})=>({create:r,createFromWKT:n})),me(()=>Promise.resolve().then(()=>yE),void 0).then(r=>r.aK).then(({create:r,createEx:n,createFromAoi:o})=>({create:r,createEx:n,createFromAoi:o})),Blt()]);jbe=t.fromExtent,PB=t.fromGeometry,WG=t.fromSpatialReference,Hbe=t.getSpatialReference,Ybe=t.toGeometry,Xbe=e,Wbe=s.create,Zbe=s.createFromWKT,Qbe=i.createEx,Jbe=i.createFromAoi,Kbe=i.create,Hlt()}}function Wlt(t,e,s={}){const i=Zlt(Hbe(t),e,s);return Ybe(jlt(PB(t),i),e)}function Zlt(t,e,s={}){let i;const r=WG(t),n=WG(e);if(s!=null&&s.geographicTransformation){const o=s.geographicTransformation.steps.map(a=>a.wkid?Wbe(a.wkid,a.isInverse):Zbe(a.wkt,a.isInverse));i=new Xbe(o,null,r,n)}else if(s!=null&&s.areaOfInterestExtent)return Jbe(r,n,jbe(s.areaOfInterestExtent).asEnvelope2D());return i?Qbe(r,n,i):Kbe(r,n)}const Qlt=({closeDialog:t})=>tt.jsxs("div",{slot:"content",style:{display:"flex",background:"white",padding:"5px 0px 5px 20px",height:"100px",justifyContent:"space-between"},children:[tt.jsxs("p",{style:{fontWeight:500,fontSize:"18px"},children:["Modified point must be within the circle.",tt.jsx("p",{style:{fontSize:"14px",fontWeight:"normal",color:"rgb(83, 83, 83)"},children:"The circle is of radius 50 meters."})]}),tt.jsx("div",{style:{cursor:"pointer",height:"100%",width:"80px",display:"flex",alignItems:"center",justifyContent:"center"},onClick:t,children:tt.jsx(GSe,{icon:"x"})})]}),Jlt=(t,e,s,i)=>{const r=m=>m*(Math.PI/180),n=m=>m*(180/Math.PI),o=r(t),a=r(s),l=r(i-e),u=Math.sin(l)*Math.cos(a),c=Math.cos(o)*Math.sin(a)-Math.sin(o)*Math.cos(a)*Math.cos(l);let h=Math.atan2(u,c);return h=n(h),(h+360)%360},exe=({imageUrl:t,view:e,layer:s,id:i,setFpFeatures:r,title:n,comment:o,feature:a,fpFeatures:l})=>{const u=mi.useRef(null),[c,h]=mi.useState({title:n||`Image_${i}`,comment:o||`This is Image_${i}`}),[m,f]=mi.useState(!1),[g,v]=mi.useState(!1),[b,w]=mi.useState(!1),[S,T]=mi.useState(!1),[P,I]=mi.useState(!1);mi.useEffect(()=>{Xlt()},[e]);const A=q=>{const{name:U,value:V}=q.target;U==="title"&&v(V.trim()===""),h(B=>({...B,[U]:V}))},D=()=>{if(k.current.scrollTo({top:k.current.scrollHeight,behavior:"smooth"}),l.some(V=>V.title!==a.attributes.title&&V.title===c.title)){console.log("failed to save."),I(!0);return}r(V=>{const B=V.findIndex(H=>H.id===i);if(B!==-1){const H=[...V];return H[B]={...H[B],title:c.title},H}else return[...V,{id:i,title:c.title}]});const U=new tn({attributes:{comment:c.comment,title:c.title,[s.objectIdField]:i}});s.applyEdits({updateFeatures:[U]}).then(V=>{console.log("Updated feature with ID:",i,V),e.popup.close()}).catch(V=>{console.error("Error updating feature:",V)})},k=mi.useRef(null),R=q=>{s.applyEdits({updateFeatures:[q]}).then(U=>{console.log("geometry updated successfully.",U),e.graphics.removeAll()}).catch(U=>{console.error("Error updating feature:",U)})},O=()=>{if(e.goTo({target:a.geometry,zoom:18}),S){u.current&&(u.current.remove(),u.current=null),e.graphics.removeAll(),e.container.style.cursor="auto",T(!1);return}e.container.style.cursor="crosshair",T(!0),u.current=e.on("click",q=>{console.log("click event triggered");const U=a.geometry,V=q.mapPoint;console.log(V);const B=U.x,H=U.y,W=V.longitude,ie=V.latitude;console.log("Ref:",H,B),console.log("Click:",ie,W);const se=Jlt(H,B,ie,W);console.log("Angle:",se);const Z=new tn({attributes:{direction:se,[s.objectIdField]:i}});s.applyEdits({updateFeatures:[Z]}).then(te=>console.log("Updated direction:",te)).catch(te=>console.log("Failed to update direction",te)),u.current&&(u.current.remove(),u.current=null),e.container.style.cursor="auto",T(!1),D()})},z=()=>{if(b){u.current&&(u.current.remove(),u.current=null),e.graphics.removeAll(),e.container.style.cursor="auto",w(!1);return}e.container.style.cursor="crosshair",e.goTo({target:a.geometry,zoom:18});const q=new kQe({center:a.geometry,radius:50,radiusUnit:"meters",geodesic:!0}),U=new tn({geometry:q,symbol:{type:"simple-fill",color:[0,122,194,.1],outline:{color:[0,122,194],width:2}}});e.graphics.add(U),w(!0),u.current=e.on("click",V=>{const B=new tn({geometry:V.mapPoint,symbol:{type:"simple-marker",color:[255,0,0],size:6,outline:{color:[255,0,0],width:2}},attributes:{[s.objectIdField]:i}}),H=Wlt(q,V.mapPoint.spatialReference);if(Ube(H,V.mapPoint))R(B);else{let W=document.createElement("calcite-dialog");W.open=!0,W.modal=!0,W.kind="danger",document.body.appendChild(W);const ie=()=>{W&&W.remove()};SD.createRoot(W).render(tt.jsx(Qlt,{closeDialog:ie})),e.graphics.removeAll()}D(),u.current&&(u.current.remove(),u.current=null),e.container.style.cursor="auto",w(!1)})};return tt.jsxs("div",{ref:k,style:{display:"flex",flexDirection:"column",width:"100%",gap:"10px",justifyContent:"space-between"},children:[tt.jsxs("div",{style:{display:"flex",gap:"10px"},children:[tt.jsx(Lh,{style:{width:"50%"},onClick:z,appearance:b?"outline-fill":"solid",kind:b?"danger":"brand",scale:"m",iconStart:"pin",children:b?"Cancel":"Modify Location"}),tt.jsx(Lh,{onClick:O,scale:"m",appearance:S?"outline-fill":"solid",iconStart:"compass",kind:S?"danger":"brand",style:{"--calcite-button-background-color":!S&&"rgb(87, 90, 88)",width:"50%"},children:S?"Cancel":"Set Direction"})]}),tt.jsxs("div",{style:{opacity:m||P?.4:1,display:"flex",flexDirection:"column",width:"100%",gap:"10px",justifyContent:"space-between"},children:[tt.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[tt.jsx("span",{style:{fontSize:"16px",fontWeight:"bold"},children:"Title"}),tt.jsx(MX,{disabled:m||P,placeholder:"Enter the title",name:"title",value:c.title,onCalciteInputInput:A})]}),tt.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[tt.jsx("span",{style:{fontSize:"16px",fontWeight:"bold"},children:"Comment"}),tt.jsx(MX,{disabled:m||P,name:"comment",placeholder:"Enter the comment",value:c.comment,onCalciteInputInput:A})]}),tt.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[tt.jsx("span",{style:{fontSize:"16px",fontWeight:"bold"},children:"Captured Image"}),tt.jsx("img",{src:t,alt:"image"})]})]}),m?tt.jsxs($X,{kind:"danger",open:!0,style:{position:"sticky",bottom:"12px"},children:[tt.jsx(AX,{slot:"title",style:{fontWeight:"normal"},scale:"m",children:"Are you sure you want to delete this item? This action is permanent and cannot be undone."}),tt.jsxs("div",{slot:"message",style:{display:"flex",gap:"10px"},children:[tt.jsx(Lh,{slot:"secondary",width:"full",appearance:"outline",onClick:()=>{f(!1)},children:"Cancel"}),tt.jsx(Lh,{slot:"primary",width:"full",kind:"danger",onClick:()=>{s.applyEdits({deleteFeatures:[{objectId:i}]}).then(q=>{r(U=>U.filter(V=>V.id!==i)),console.log("Deleted feature with ID:",i,q),e.popup.close()}).catch(q=>{console.error("Error deleting feature:",q)})},children:"Delete"})]})]}):tt.jsxs(tt.Fragment,{children:[P&&tt.jsx($X,{kind:"danger",open:!0,style:{position:"sticky",bottom:"12px",width:"100%"},closable:!0,onCalciteNoticeBeforeClose:()=>I(!1),children:tt.jsx(AX,{slot:"title",style:{fontWeight:"normal"},scale:"m",children:"This title is already in use. Please choose a different one."})}),tt.jsxs("div",{style:{display:"flex",gap:"5px"},children:[tt.jsx(Lh,{style:{marginTop:"15px",width:"100%"},onClick:D,disabled:g||P,children:n?"Update":"Save"}),tt.jsx(Lh,{style:{marginTop:"15px",width:"100%"},slot:"secondary",width:"full",kind:"danger",appearance:"outline",onClick:()=>{f(!0),k.current.scrollTo({top:k.current.scrollHeight,behavior:"smooth"})},children:"Delete"})]})]})]})},Klt="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='Menu%20/%20Close_MD'%3e%3cpath%20id='Vector'%20d='M18%2018L12%2012M12%2012L6%206M12%2012L18%206M12%2012L6%2018'%20stroke='%23000000'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3c/svg%3e",eut=({setCameraActive:t,view:e,layer:s,setFpFeatures:i,setPhotosActive:r,fpFeatures:n})=>{const o=mi.useRef(null),a=mi.useRef(null),l=mi.useRef(null),[u,c]=mi.useState(0),[h,m]=mi.useState(!1),[f,g]=mi.useState(null);mi.useEffect(()=>{const S=T=>{let P=null;T.absolute&&typeof T.alpha=="number"?P=360-T.alpha:typeof T.webkitCompassHeading=="number"&&(P=T.webkitCompassHeading),P!==null&&g(P.toFixed(2))};return window.addEventListener("deviceorientationabsolute",S,!0),window.addEventListener("deviceorientation",S,!0),()=>{window.removeEventListener("deviceorientationabsolute",S),window.removeEventListener("deviceorientation",S)}},[u]),mi.useEffect(()=>{const S=a.current;return(async()=>{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert("Camera not supported on this device/browser.");return}try{l.current=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}),S.srcObject=l.current}catch(P){alert("Could not access the camera. Permission denied or device issue."),console.error(P)}})(),()=>{l.current&&l.current.getTracks().forEach(P=>P.stop())}},[u]);const v=async()=>{if(typeof DeviceOrientationEvent<"u"&&typeof DeviceOrientationEvent.requestPermission=="function")try{if(await DeviceOrientationEvent.requestPermission()!=="granted"){alert("Permission for device orientation was denied.");return}}catch(P){console.error("Error requesting orientation permission:",P);return}const T=o.current.getContext("2d");l.current&&(o.current.width=a.current.videoWidth,o.current.height=a.current.videoHeight,T.drawImage(a.current,0,0,o.current.width,o.current.height),l.current&&(l.current.getTracks().forEach(P=>P.stop()),a.current.srcObject=null,l.current=null),m(!0))},b=S=>{console.log(S.geometry);const T=new tn({attributes:S.attributes,geometry:S.geometry});return s.applyEdits({addFeatures:[T]}).then(P=>P.addFeatureResults[0].objectId).catch(P=>console.error(P))},w=async()=>{if(!o.current){console.warn("Canvas not ready");return}const S=o.current.toDataURL("image/jpeg",1);navigator.geolocation.getCurrentPosition(async T=>{const P={attributes:{title:"",comment:"",image:S,direction:f,photoId:""},geometry:new Et({longitude:T.coords.longitude,latitude:T.coords.latitude})};await e.goTo(P.geometry);const I=await b(P),A=document.createElement("div");SD.createRoot(A).render(tt.jsx(exe,{imageUrl:S,view:e,layer:s,id:I,setFpFeatures:i,title:null,comment:null,feature:P,fpFeatures:n}));const D=new y9({title:"Captured Image",location:P.geometry,content:A,dockEnabled:!0,visibleElements:{closeButton:!1},dockOptions:{buttonEnabled:!0,breakpoint:!1,position:"top-right"}});e.popup=D,e.openPopup()},T=>console.error(T),{enableHighAccuracy:!0,maximumAge:0,timeout:5e3}),t(!1),r(!1)};return tt.jsxs("div",{style:{position:"relative",width:"100vw",height:"100dvh",overflow:"hidden",backgroundColor:"black"},children:[tt.jsx("canvas",{id:"canvas",ref:o,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:h?"block":"none",objectFit:"cover"}}),tt.jsx("video",{id:"video",ref:a,autoPlay:!0,playsInline:!0,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:h?"none":"block",objectFit:"cover"}}),tt.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",padding:"12px",fontSize:"16px",borderRadius:"100%",backdropFilter:"blur(10px)",cursor:"pointer",background:"rgba(255, 255, 255, 0.4)",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{t(!1),a.current.srcObject=null,l.current=null},children:tt.jsx("img",{src:Klt,alt:"close",width:20,height:20})}),tt.jsxs("div",{style:{position:"absolute",bottom:0,width:"100%",display:"flex",justifyContent:"center",gap:"40px",padding:"16px",background:"rgba(0, 0, 0, 0.4)",backdropFilter:"blur(4px)"},children:[h?tt.jsx(Lh,{scale:"l",onClick:()=>{c(S=>S+1),m(!1)},iconStart:"refresh",style:{"--calcite-button-corner-radius":"100%"}}):tt.jsx("div",{style:{padding:"25px",borderRadius:"100%",background:"white",cursor:"pointer",outline:"3px solid white",border:"4px solid transparent",boxShadow:"0 0 2px black",outlineOffset:"3px",transition:"transform 0.1s ease-in-out"},title:"Click to Capture",onClick:v,onMouseDown:S=>S.currentTarget.style.transform="scale(0.95)",onMouseUp:S=>S.currentTarget.style.transform="scale(1)",onMouseLeave:S=>S.currentTarget.style.transform="scale(1)"}),h&&tt.jsx(Lh,{scale:"l",style:{"--calcite-button-background-color":"#4CAF50","--calcite-button-corner-radius":"100%"},iconStart:"save",onClick:w})]})]})};let cf=class extends Ye{constructor(t){super(t),this._viewpointHandle=null,this.group=null}initialize(){this.addHandles(Vo(()=>{var t;return(t=this.view)==null?void 0:t.ui},"expand",t=>{const{target:e}=t;e&&e!==this&&e.expanded&&e.group&&e.group===this.group&&this._collapse()}))}destroy(){this._viewpointHandle=null,this.view=null}set autoCollapse(t){this._set("autoCollapse",t),this._watchViewpoint()}set expanded(t){var i;const e=!!t;this._set("expanded",e);const s=(i=this.view)==null?void 0:i.ui;s&&s.emit("expand",{target:this}),this._viewpointHandleChange(e)}get state(){var t;return(t=this.view)!=null&&t.ready?"ready":"disabled"}set view(t){this._get("view")!==t&&(this._set("view",t),t&&Or(()=>t.ready,()=>{this.view===t&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(t){this._viewpointHandle&&(t?Or(()=>{var e;return(e=this.view)==null?void 0:e.stationary},()=>{var e;return(e=this._viewpointHandle)==null?void 0:e.resume()},{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const t="viewpoint";this.removeHandles(t),this._viewpointHandle=null;const{autoCollapse:e,view:s}=this;if(!s||!e)return;const i=nMe(()=>s.type==="3d"?s.camera:s.viewpoint,()=>this._collapse());this.addHandles(i,t),this._viewpointHandle=i}_collapse(){this.expanded=!1}};p([_({value:!1})],cf.prototype,"autoCollapse",null),p([_({value:!1})],cf.prototype,"expanded",null),p([_()],cf.prototype,"group",void 0),p([_({readOnly:!0})],cf.prototype,"state",null),p([_({value:null})],cf.prototype,"view",null),cf=p([Q("esri.widgets.Expand.ExpandViewModel")],cf);const txe=cf,Np="esri-expand",_l={base:Np,toggle:`${Np}__toggle`,popoverContent:`${Np}__popover-content`,panel:`${Np}__panel`,panelContent:`${Np}__panel-content`,sheet:`${Np}__sheet`,contentContainer:`${Np}__content-container`,icon:"esri-collapse__icon",iconFlip:"esri-collapse__icon-flip",iconNumber:`${Np}__icon-number`},Fne="chevrons-left",One="chevrons-right";let ki=class extends Er{constructor(t,e){super(t,e),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.focusTrapDisabled=!1,this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.placement=null,this.viewModel=new txe,this.toggle=()=>{this.viewModel.expanded=!this.viewModel.expanded},this._handlePopoverClose=s=>{s.target===this._popoverEl&&(this.viewModel.expanded=s.currentTarget.open)},this._handleSheetClose=s=>{this.viewModel.expanded=s.currentTarget.open},this._handlePanelClose=s=>{this.viewModel.expanded=!s.currentTarget.closed},this._handleKeyDown=s=>{this.viewModel.expanded&&s.key==="Escape"&&!this._willCloseOnEsc(s)&&s.preventDefault()},this._storeToggleActionEl=s=>{this._toggleActionEl=s},this._storePopoverEl=s=>{this._popoverEl=s}}initialize(){this.addHandles(Ee(()=>{var t,e;return(e=(t=this.viewModel)==null?void 0:t.view)==null?void 0:e.size},()=>{var t;return(t=this._popoverEl)==null?void 0:t.reposition()},ht))}loadDependencies(){return sl({action:()=>me(()=>import("./index-9hW8Ud6V.js"),__vite__mapDeps([253,240,241,242,243,244,245,254,246,249,251])),icon:()=>me(()=>import("./index-BhFhNIYS.js").then(t=>t.i),__vite__mapDeps([243,244,241,245])),panel:()=>me(()=>import("./index-32bfBVfE.js").then(t=>t.i),__vite__mapDeps([282,240,241,242,243,244,245,253,254,246,249,251,255,256,257,258,247,259,260,261,262,263,273])),popover:()=>me(()=>import("./index-BVUVt3d7.js").then(t=>t.i),__vite__mapDeps([255,240,241,242,243,244,245,253,254,246,249,251,256,257,258,247,259,260,261])),sheet:()=>me(()=>import("./index-BJarPfPF.js"),__vite__mapDeps([316,240,241,242,273,246,245,244,243,254,317,251,258,266,260]))})}get expandTitle(){const{expanded:t,messagesCommon:e,collapseTooltip:s,expandTooltip:i}=this;return(t?s||(e==null?void 0:e.collapse):i||(e==null?void 0:e.expand))??""}get _displaySheet(){var t;switch(this.mode){case"drawer":return!0;case"auto":return((t=this.viewModel.view)==null?void 0:t.widthBreakpoint)==="xsmall";default:return!1}}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(t){this.viewModel.autoCollapse=t}get collapseIcon(){return One}set collapseIcon(t){this._overrideIfSome("collapseIcon",t)}get expanded(){return this.viewModel.expanded}set expanded(t){this.viewModel.expanded=t}get expandIcon(){return P_(this.content)?this.content.icon:Fne}set expandIcon(t){this._overrideIfSome("expandIcon",t)}get group(){return this.viewModel.group}set group(t){this.viewModel.group=t}get icon(){return null}get label(){var t;return(P_(this.content)?this.content.label:null)??((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}render(){const{_displaySheet:t,_toggleActionEl:e,viewModel:{expanded:s},label:i,placement:r}=this;return K("div",{class:this.classes(_l.base,vt.widget)},this._renderToggle(),t?K("calcite-sheet",{class:_l.sheet,heightScale:"l",label:i,onkeydown:this._handleKeyDown,open:s,position:"block-end",onCalciteSheetClose:this._handleSheetClose},K("calcite-panel",{class:_l.panel,closable:!0,closed:!s,heading:i,onkeydown:this._handleKeyDown,onCalcitePanelClose:this._handlePanelClose},K("div",{class:_l.panelContent},this._renderContent()))):e?K("calcite-popover",{afterCreate:this._storePopoverEl,afterUpdate:this._storePopoverEl,focusTrapDisabled:this.focusTrapDisabled,label:i,onkeydown:this._handleKeyDown,open:s,overlayPositioning:"fixed",placement:r??this._getPlacement(),referenceElement:e,onCalcitePopoverClose:this._handlePopoverClose},K("div",{class:_l.popoverContent},this._renderContent())):null)}_getPlacement(){const{container:t,view:e}=this,s=t&&e?e.ui.getPosition(t):null;if(!s||s==="manual")return"auto";const[i,r]=s.split("-");return`${r==="right"?"left":"right"}-${i==="bottom"?"end":"start"}`}_willCloseOnEsc(t){const{closeOnEsc:e}=this;return typeof e=="function"?e(t):e}_renderBadgeNumber(){const{expanded:t,iconNumber:e}=this;return e&&!t?K("span",{class:_l.iconNumber,key:"expand__icon-number"},e):null}_renderToggleButton(){const{expanded:t,expandTitle:e,expandIcon:s,collapseIcon:i}=this,r=t?i:s,n=r===Fne||r===One;return K("calcite-action",{afterCreate:this._storeToggleActionEl,afterUpdate:this._storeToggleActionEl,class:vt.widgetButton,onclick:this.toggle,scale:"s",text:e,title:e},r?K("calcite-icon",{class:this.classes(_l.icon,n&&_l.iconFlip),icon:r,scale:"s"}):null)}_renderToggle(){return K("div",{class:_l.toggle},this._renderToggleButton(),this._renderBadgeNumber())}_renderContent(){const{content:t}=this;return typeof t=="string"?K("div",{class:_l.contentContainer,innerHTML:t,key:"content__string"}):P_(t)?K("div",{class:_l.contentContainer,key:"content__widget"},t.render()):t instanceof HTMLElement?K("div",{afterCreate:this._attachToNode,bind:t,class:_l.contentContainer,key:"content__html-element"}):Ofe(t)?K("div",{afterCreate:this._attachToNode,bind:t.domNode,class:_l.contentContainer,key:"content__node"}):null}_attachToNode(t){const e=this;t.appendChild(e)}};p([_({readOnly:!0})],ki.prototype,"expandTitle",null),p([_()],ki.prototype,"_toggleActionEl",void 0),p([_()],ki.prototype,"_displaySheet",null),p([_()],ki.prototype,"autoCollapse",null),p([_()],ki.prototype,"closeOnEsc",void 0),p([_()],ki.prototype,"collapseIcon",null),p([_()],ki.prototype,"collapseTooltip",void 0),p([_()],ki.prototype,"content",void 0),p([_()],ki.prototype,"expanded",null),p([_()],ki.prototype,"expandIcon",null),p([_()],ki.prototype,"expandTooltip",void 0),p([_()],ki.prototype,"focusTrapDisabled",void 0),p([_()],ki.prototype,"group",null),p([_()],ki.prototype,"icon",null),p([_()],ki.prototype,"iconNumber",void 0),p([_()],ki.prototype,"label",null),p([_(),ur("esri/widgets/Expand/t9n/Expand")],ki.prototype,"messages",void 0),p([_(),ur("esri/t9n/common")],ki.prototype,"messagesCommon",void 0),p([_()],ki.prototype,"mode",void 0),p([_()],ki.prototype,"placement",void 0),p([_()],ki.prototype,"view",null),p([_({type:txe})],ki.prototype,"viewModel",void 0),ki=p([Q("esri.widgets.Expand")],ki);const tut=ki;function sut(){const t=mi.useRef(null),e=mi.useRef(null),s=mi.useRef(null),i=mi.useRef(null),[r,n]=mi.useState(!1),[o,a]=mi.useState(!1),[l,u]=mi.useState([]),[c,h]=mi.useState([]);mi.useEffect(()=>{const f=new URLSearchParams(window.location.search),g=new sb({id:f.get("id")});e.current||(t.current=new Xhe({basemap:"streets-vector"}),e.current=new eze({container:"map-view",map:t.current,center:[80.5929,16.4937],zoom:11}),g.load().then(v=>{const b=new Yh({symbol:{type:"picture-marker",width:"40px",height:"40px",url:bje},visualVariables:[{type:"rotation",field:"direction",rotationType:"geographic",valueUnit:"degrees"}]}),w=new e8({portalItem:v,renderer:b,popupTemplate:{title:"{title}",content:[{type:"fields",fieldInfos:[{fieldName:"comment",label:"Comment"},{fieldName:"direction",label:"Direction"},{fieldName:"startdate",label:"Start Date"},{fieldName:"enddate",label:"End Date"}]}]}}),S={type:"FeatureCollection",features:[]},T=new Blob([JSON.stringify(S)],{type:"application/json"}),P=URL.createObjectURL(T);if(i.current=new e8({url:P,editingEnabled:!0,title:"FP Layer",geometryType:"point",fields:[{name:"comment",type:"string",alias:"Comment"},{name:"title",type:"string",alias:"Title"},{name:"image",type:"string",alias:"Image URL"},{name:"direction",type:"double",alias:"Direction"},{name:"photoId",type:"string",alias:"Photo ID"}],renderer:{type:"unique-value",valueExpression:`
  IIF(
    IsEmpty($feature.direction) || $feature.direction == null,
    'no-dir',
    'has-dir'
  )
`,uniqueValueInfos:[{value:"has-dir",symbol:{type:"picture-marker",width:"40px",height:"40px",url:xje}},{value:"no-dir",symbol:{type:"simple-marker",style:"circle",color:[0,122,194],size:6,outline:{color:[0,122,194],width:1}}}],visualVariables:[{type:"rotation",field:"direction",rotationType:"geographic",valueUnit:"degrees"}]},popupTemplate:{title:"Captured Image",content:[{type:"fields",fieldInfos:[{fieldName:"comment",label:"Comment"},{fieldName:"direction",label:"Direction"}]},{type:"media",mediaInfos:[{title:"{title}",type:"image",value:{sourceURL:"{image}"}}]}]}}),s.current=w,w&&e.current){const I=new Tze({view:e.current}),A=new tut({content:I,view:e.current});e.current.ui.add(A,"top-right")}w.queryFeatures().then(I=>{const A=I.features.map(D=>({...D.attributes,geometry:D.geometry}));u(A)}),t.current.add(w),t.current.add(i.current)})),!o&&e.current&&(e.current.container="map-view")},[o]);const m=async(f,g)=>{n(!1);const v=await f.queryFeatures({where:`title = '${g.replace(/'/g,"''")}'`,returnGeometry:!0,outFields:["*"]});if(v.features.length){const b=v.features[0];if(console.log(b.attributes.title,b.attributes.comment,b.attributes[f.objectIdField]),await e.current.goTo(b.geometry),f.title==="FP Layer"){const w=document.createElement("div");SD.createRoot(w).render(tt.jsx(exe,{imageUrl:b.attributes.image,view:e.current,layer:f,id:b.attributes[f.objectIdField],setFpFeatures:h,title:b.attributes.title,comment:b.attributes.comment,feature:b,fpFeatures:c}));const S=new y9({title:"Captured Image",location:b.geometry,content:w,dockEnabled:!0,dockOptions:{buttonEnabled:!0,breakpoint:!1,position:"top-right"}});e.current.popup.visibleElements={...e.current.popup.visibleElements,closeButton:!1},e.current.popup=S,e.current.openPopup()}else e.current.popup.visibleElements={...e.current.popup.visibleElements,closeButton:!0},e.current.openPopup({features:[b],location:b.geometry})}};return tt.jsx(USe,{style:{height:"100svh",display:"flex",flexDirection:"column"},children:o?tt.jsx(eut,{setCameraActive:a,view:e.current,layer:i.current,setFpFeatures:h,setPhotosActive:n,fpFeatures:c}):tt.jsxs(tt.Fragment,{children:[tt.jsxs("div",{slot:"header",style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 16px",backgroundColor:"#f5f5f5",borderBottom:"1px solid #ccc"},children:[tt.jsx("h2",{children:"Agriculture Land"}),tt.jsx(qSe,{fullName:"Ravi Kishan",scale:"l"})]}),tt.jsxs("div",{style:{flex:1,display:"flex"},children:[tt.jsx(s4,{slot:"panel-start",width:!0,children:tt.jsxs(RX,{children:[tt.jsx(t4,{icon:"home"}),tt.jsx(t4,{icon:"home"})]})}),tt.jsxs("div",{style:{flex:1,display:"flex"},children:[tt.jsx("div",{id:"map-view",style:{flex:1}}),r&&tt.jsx(s4,{width:"m",children:tt.jsxs(RX,{heading:"Photos",children:[tt.jsxs(zSe,{children:[tt.jsx(DX,{heading:"List Required",children:l.length>0&&l.map(f=>tt.jsx(NX,{onCalciteListItemSelect:()=>m(s.current,f.title),label:f.title},f.title))}),tt.jsx(DX,{heading:"List Taken",children:c.length>0&&c.map(f=>tt.jsx(NX,{label:f.title,onCalciteListItemSelect:()=>m(i.current,f.title)},f.id))})]}),tt.jsxs("div",{slot:"footer",style:{display:"flex",gap:"10px"},children:[tt.jsx(Lh,{slot:"footer",onClick:()=>a(!0),children:"New"}),tt.jsx(Lh,{slot:"footer",style:{"--calcite-button-background-color":"#4CAF50"},disabled:c.length===0,children:"Save to Portal"})]})]})})]}),tt.jsx(s4,{slot:"panel-end",width:!0,children:tt.jsx(t4,{icon:"images",onClick:()=>n(f=>!f),active:r})})]})]})})}SD.createRoot(document.getElementById("root")).render(tt.jsx(mi.StrictMode,{children:tt.jsx(sut,{})}));export{Ds as $,Ge as A,tn as B,qo as C,vyt as D,bn as E,H$e as F,Ne as G,_yt as H,Sr as I,yb as J,mvt as K,FSe as L,Edt as M,Td as N,whe as O,js as P,on as Q,Gde as R,Syt as S,Eyt as T,G_ as U,L_ as V,Yc as W,zJ as X,S3 as Y,uyt as Z,me as _,xut as a,Lr as a$,eue as a0,Igt as a1,Yqe as a2,Ye as a3,ge as a4,Xfe as a5,pke as a6,fke as a7,p as a8,_ as a9,myt as aA,Dh as aB,IJ as aC,SJ as aD,koe as aE,Db as aF,ipe as aG,ya as aH,Te as aI,bI as aJ,Yht as aK,Lde as aL,pa as aM,m_ as aN,_Ie as aO,see as aP,tee as aQ,xs as aR,qq as aS,pct as aT,sb as aU,Nc as aV,Mt as aW,qe as aX,St as aY,W3e as aZ,uW as a_,Q as aa,TJ as ab,PJ as ac,CJ as ad,EJ as ae,sue as af,lb as ag,v_ as ah,Zz as ai,tue as aj,wQ as ak,mpt as al,Dht as am,_Ye as an,bYe as ao,$C as ap,E_ as aq,Ib as ar,XN as as,qi as at,Ou as au,yz as av,xi as aw,OC as ax,sm as ay,Ka as az,Eut as b,Wht as b$,Cce as b0,woe as b1,ni as b2,Et as b3,Y_ as b4,Hs as b5,qC as b6,Vl as b7,po as b8,S_ as b9,Yh as bA,Or as bB,ii as bC,Qa as bD,Vd as bE,pg as bF,eg as bG,Qh as bH,Uu as bI,p5 as bJ,Oi as bK,UN as bL,d5 as bM,g5 as bN,qce as bO,Gpe as bP,at as bQ,GE as bR,gn as bS,x3 as bT,HV as bU,yLe as bV,Mi as bW,$J as bX,a4 as bY,KC as bZ,V6 as b_,Dqe as ba,Wft as bb,Bt as bc,Qft as bd,cyt as be,gde as bf,sg as bg,Vo as bh,bdt as bi,h$ as bj,Xt as bk,Wt as bl,MNe as bm,Jt as bn,mt as bo,GC as bp,lde as bq,Q4e as br,Ad as bs,nn as bt,Ii as bu,Ee as bv,ht as bw,N$ as bx,v0 as by,f0t as bz,but as c,HC as c$,Xdt as c0,ppt as c1,Md as c2,ghe as c3,Nke as c4,Kyt as c5,ME as c6,Ga as c7,Xn as c8,y_ as c9,dg as cA,gpt as cB,$7 as cC,qye as cD,Zc as cE,PTe as cF,m0t as cG,i6 as cH,h0t as cI,SE as cJ,hXe as cK,cXe as cL,u_ as cM,U_e as cN,kC as cO,Wl as cP,hpt as cQ,jht as cR,Tct as cS,Ioe as cT,Toe as cU,MTe as cV,GD as cW,zD as cX,Vz as cY,qz as cZ,ITe as c_,LL as ca,Mut as cb,Fqe as cc,voe as cd,E1 as ce,yUe as cf,Wge as cg,Lo as ch,qut as ci,KZe as cj,ko as ck,En as cl,h1t as cm,KU as cn,Be as co,EZe as cp,mE as cq,d_e as cr,Ovt as cs,J$ as ct,CHe as cu,_pt as cv,e0t as cw,Zl as cx,Tut as cy,tpt as cz,sx as d,RPe as d$,RE as d0,s$ as d1,z6e as d2,zmt as d3,ple as d4,Zge as d5,H4e as d6,yFe as d7,Sdt as d8,Wyt as d9,I6e as dA,lx as dB,Z6e as dC,GV as dD,hye as dE,Z9e as dF,mye as dG,cye as dH,aBe as dI,tBe as dJ,G9e as dK,B9e as dL,u$ as dM,p7 as dN,p6e as dO,fpe as dP,xpe as dQ,g6e as dR,_pe as dS,bpe as dT,lz as dU,uz as dV,mQ as dW,qu as dX,oP as dY,KEe as dZ,Kut as d_,Zh as da,Xyt as db,Yyt as dc,Id as dd,YD as de,iFe as df,N7 as dg,AFe as dh,Pdt as di,Ll as dj,Cdt as dk,hme as dl,D7 as dm,$ct as dn,Oz as dp,qD as dq,ule as dr,kd as ds,$u as dt,BD as du,_a as dv,U9e as dw,oBe as dx,wpe as dy,eBe as dz,ae as e,go as e$,gb as e0,Nz as e1,sht as e2,Qz as e3,ppe as e4,Mhe as e5,gg as e6,R6e as e7,NRe as e8,f6e as e9,Vde as eA,tft as eB,OLe as eC,Qb as eD,os as eE,Mbe as eF,FR as eG,iB as eH,gd as eI,nB as eJ,oB as eK,dht as eL,a_t as eM,A$ as eN,mct as eO,Pd as eP,sh as eQ,wU as eR,Dye as eS,Pye as eT,Aye as eU,zU as eV,yU as eW,XC as eX,dge as eY,cge as eZ,tl as e_,vpe as ea,B6e as eb,Nct as ec,YN as ed,ID as ee,MD as ef,_0t as eg,y0t as eh,KBe as ei,eje as ej,TD as ek,kX as el,Gmt as em,JBe as en,KXe as eo,Z$ as ep,a3e as eq,qRe as er,eke as es,Pae as et,FD as eu,VRe as ev,c3e as ew,h3e as ex,m3e as ey,q6e as ez,Mye as f,bd as f$,rm as f0,nP as f1,bg as f2,uge as f3,zXe as f4,Zfe as f5,GXe as f6,x6e as f7,w6e as f8,j6e as f9,hx as fA,kht as fB,Lce as fC,AIe as fD,Hht as fE,Hn as fF,I0t as fG,$W as fH,df as fI,CE as fJ,ON as fK,Ht as fL,xb as fM,x_ as fN,jh as fO,fEe as fP,Gf as fQ,Wut as fR,Fke as fS,ZC as fT,ndt as fU,Ld as fV,odt as fW,I1t as fX,q1t as fY,o_ as fZ,adt as f_,hge as fa,Xoe as fb,tht as fc,DD as fd,LC as fe,PE as ff,Tf as fg,Bl as fh,YPe as fi,LD as fj,Rz as fk,XPe as fl,Eye as fm,Yct as fn,Xc as fo,TN as fp,Zf as fq,Zb as fr,Ue as fs,kye as ft,Qyt as fu,BN as fv,vhe as fw,TWe as fx,$E as fy,fs as fz,Vmt as g,cbe as g$,Rt as g0,M as g1,G as g2,Fr as g3,Ce as g4,JE as g5,Nd as g6,zi as g7,Hbt as g8,Ybt as g9,be as gA,hvt as gB,SB as gC,Vlt as gD,Llt as gE,aht as gF,lht as gG,$G as gH,__e as gI,jct as gJ,eht as gK,$je as gL,l8 as gM,zo as gN,T0e as gO,N_ as gP,P0 as gQ,TC as gR,il as gS,Ji as gT,eh as gU,Ix as gV,Uve as gW,I0e as gX,hD as gY,vB as gZ,_st as g_,nm as ga,ee as gb,nt as gc,qt as gd,X as ge,wt as gf,EKe as gg,jbt as gh,Q1e as gi,u0 as gj,ba as gk,yt as gl,Nt as gm,MS as gn,Ftt as go,gbt as gp,di as gq,Xh as gr,pD as gs,Fb as gt,xt as gu,i_ as gv,pt as gw,mo as gx,k0e as gy,Od as gz,QPe as h,F_t as h$,Me as h0,ne as h1,ER as h2,P9 as h3,ps as h4,Wve as h5,oi as h6,Xb as h7,hs as h8,bJe as h9,gt as hA,or as hB,Bc as hC,de as hD,cN as hE,Wot as hF,_z as hG,_Ce as hH,YSe as hI,d1t as hJ,byt as hK,UV as hL,w3 as hM,b1 as hN,Soe as hO,Coe as hP,Poe as hQ,Dut as hR,lYe as hS,tct as hT,Jgt as hU,s0t as hV,n0t as hW,r0t as hX,J_t as hY,mdt as hZ,cZe as h_,wn as ha,Sa as hb,Znt as hc,Bve as hd,jve as he,znt as hf,RG as hg,rKe as hh,vbt as hi,Zve as hj,VE as hk,ar as hl,Ade as hm,yg as hn,qee as ho,Fee as hp,wht as hq,Eb as hr,$0t as hs,Oce as ht,K7 as hu,Jyt as hv,V6e as hw,sn as hx,jb as hy,cie as hz,aut as i,Jh as i$,O_t as i0,qU as i1,sR as i2,jLe as i3,nbt as i4,Sht as i5,bgt as i6,zq as i7,Ict as i8,Dgt as i9,CW as iA,mle as iB,dle as iC,lr as iD,Dct as iE,ERe as iF,Ihe as iG,P6e as iH,Ahe as iI,hht as iJ,ETe as iK,y3e as iL,fe as iM,MRe as iN,g3e as iO,c$ as iP,kce as iQ,Iut as iR,DM as iS,OYe as iT,Fut as iU,F6e as iV,C6e as iW,qLe as iX,z3e as iY,ZM as iZ,Jct as i_,FM as ia,V5 as ib,Tv as ic,jD as id,Zht as ie,p0 as ig,i9 as ih,s9 as ii,oYe as ij,upt as ik,Qdt as il,Fht as im,F4 as io,AC as ip,zl as iq,x7e as ir,Kb as is,RC as it,Bn as iu,k6e as iv,_ht as iw,M5e as ix,Rct as iy,f5e as iz,nut as j,_9 as j$,QUe as j0,OXe as j1,svt as j2,BXe as j3,tvt as j4,UXe as j5,FC as j6,fvt as j7,xn as j8,FO as j9,M7 as jA,Oye as jB,GA as jC,gx as jD,dP as jE,mP as jF,bye as jG,yx as jH,lge as jI,z_e as jJ,jv as jK,VPe as jL,Wh as jM,Gc as jN,jc as jO,HE as jP,FU as jQ,ige as jR,A7e as jS,M7e as jT,I7e as jU,M1t as jV,Dbe as jW,qlt as jX,wD as jY,Uo as jZ,U1e as j_,E1t as ja,S1t as jb,X3e as jc,WC as jd,JPe as je,Fz as jf,eTe as jg,tTe as jh,Vze as ji,V_ as jj,Ike as jk,Pke as jl,bke as jm,Rv as jn,nQ as jo,Ja as jp,zC as jq,F_ as jr,kW as js,tge as jt,Cye as ju,sge as jv,Iye as jw,Fye as jx,c3 as jy,Lye as jz,foe as k,x5e as k$,pbt as k0,UQe as k1,Qr as k2,Sn as k3,F as k4,L as k5,Vve as k6,Gve as k7,Pt as k8,Bo as k9,W9 as kA,hJe as kB,Vb as kC,uJe as kD,fbt as kE,Zi as kF,Wb as kG,sct as kH,yut as kI,poe as kJ,iut as kK,xyt as kL,e8e as kM,jV as kN,NJ as kO,Zgt as kP,AJ as kQ,Ru as kR,qpe as kS,rd as kT,ix as kU,lt as kV,xA as kW,sft as kX,epe as kY,rU as kZ,$V as k_,Eg as ka,bb as kb,Bdt as kc,Udt as kd,i4e as ke,Ole as kf,Rb as kg,y_t as kh,Wmt as ki,p3 as kj,Bmt as kk,Sje as kl,P0e as km,C0e as kn,B$e as ko,yQe as kp,Lmt as kq,tmt as kr,TR as ks,Hb as kt,Ki as ku,Yot as kv,$d as kw,Rst as kx,ybe as ky,We as kz,goe as l,Ic as l$,tpe as l0,YJ as l1,wJ as l2,F3 as l3,TCe as l4,Yl as l5,Hut as l6,Do as l7,Pz as l8,jPe as l9,A6e as lA,mg as lB,kn as lC,Tye as lD,sEe as lE,M3 as lF,fge as lG,FXe as lH,bWe as lI,YXe as lJ,RUe as lK,zge as lL,BUe as lM,Lae as lN,Bae as lO,H3e as lP,Efe as lQ,g0t as lR,G_e as lS,mz as lT,xg as lU,Y1 as lV,Nq as lW,E0t as lX,ZXe as lY,XBe as lZ,QXe as l_,$ht as la,On as lb,y5e as lc,v5e as ld,Kde as le,Put as lf,nE as lg,BV as lh,Xde as li,I7 as lj,u3e as lk,o3e as ll,v6e as lm,W6e as ln,Q6e as lo,T5e as lp,G$ as lq,iBe as lr,$ce as ls,CTe as lt,gle as lu,d3 as lv,b6e as lw,gpe as lx,e3 as ly,w0 as lz,yGe as m,Cze as m$,Jb as m0,Xge as m1,RU as m2,Gd as m3,T1 as m4,Hvt as m5,c1t as m6,kO as m7,PWe as m8,jUe as m9,Je as mA,en as mB,iht as mC,lPe as mD,Lut as mE,Vut as mF,Out as mG,DPe as mH,d0 as mI,XD as mJ,N0t as mK,gQe as mL,nHe as mM,wh as mN,nMe as mO,Pht as mP,Fle as mQ,gU as mR,T3 as mS,Er as mT,sze as mU,Pc as mV,cze as mW,sl as mX,K as mY,vt as mZ,tb as m_,WUe as ma,U$ as mb,Mge as mc,MU as md,A3 as me,T7e as mf,Gi as mg,e9e as mh,DUe as mi,$Ue as mj,FUe as mk,OUe as ml,XUe as mm,LUe as mn,VUe as mo,qUe as mp,GUe as mq,zUe as mr,UUe as ms,Rye as mt,gvt as mu,eCe as mv,Aae as mw,ma as mx,Vce as my,gK as mz,Sut as n,nGe as n$,bze as n0,ur as n1,fU as n2,hze as n3,NIe as n4,DIe as n5,xJ as n6,dgt as n7,mgt as n8,hgt as n9,fct as nA,pvt as nB,dvt as nC,O_e as nD,k_e as nE,MJ as nF,Qgt as nG,nIe as nH,mIe as nI,VC as nJ,bht as nK,W_ as nL,w5e as nM,ZL as nN,agt as nO,IM as nP,h9 as nQ,Nu as nR,Un as nS,Y_e as nT,qGe as nU,Pte as nV,iMe as nW,zht as nX,xz as nY,xct as nZ,bct as n_,cgt as na,fgt as nb,pgt as nc,ugt as nd,lgt as ne,Bz as nf,lIe as ng,Y as nh,ble as ni,IN as nj,WCe as nk,C1t as nl,w1t as nm,UYe as nn,tWe as no,KPe as np,q7 as nq,Zdt as nr,Ydt as ns,Xf as nt,H5e as nu,Y5e as nv,jse as nw,ype as nx,_Le as ny,bCe as nz,cut as o,nYe as o$,b1t as o0,qYe as o1,DCe as o2,NCe as o3,Lht as o4,yBe as o5,nz as o6,ms as o7,oht as o8,IC as o9,Mde as oA,Tde as oB,XOe as oC,ZOe as oD,P_ as oE,Xa as oF,dze as oG,Rfe as oH,f$ as oI,_0 as oJ,JC as oK,ize as oL,mK as oM,Jqe as oN,zf as oO,v8e as oP,Zvt as oQ,x8e as oR,w8e as oS,dK as oT,YC as oU,Qvt as oV,T_t as oW,bJ as oX,SIe as oY,b5e as oZ,qc as o_,hyt as oa,Q8e as ob,WSe as oc,Hct as od,yPe as oe,OD as of,Kct as og,IFe as oh,MFe as oi,Jle as oj,wIe as ok,Mht as ol,Aze as om,Dme as on,upe as oo,rht as op,HWe as oq,QEe as or,dXe as os,A1t as ot,rdt as ou,S$ as ov,Lct as ow,Oct as ox,Cje as oy,B$ as oz,wut as p,g0 as p$,jz as p0,Hz as p1,b3 as p2,qle as p3,Sgt as p4,xgt as p5,wgt as p6,Hqe as p7,v_t as p8,b_t as p9,Nb as pA,Vh as pB,Z7 as pC,NV as pD,Ede as pE,lP as pF,hdt as pG,Eoe as pH,Hae as pI,Dz as pJ,Bct as pK,fle as pL,yW as pM,Qae as pN,U8e as pO,rse as pP,$1t as pQ,D1t as pR,F1t as pS,R1t as pT,k1t as pU,L1t as pV,nse as pW,N1t as pX,V1t as pY,Nf as pZ,cdt as p_,__t as pa,Sme as pb,YE as pc,YUe as pd,ddt as pe,s9e as pf,cvt as pg,uvt as ph,yte as pi,Uf as pj,kE as pk,aje as pl,DRe as pm,SRe as pn,CRe as po,y2 as pp,yd as pq,zme as pr,j7 as ps,cx as pt,P4e as pu,K5e as pv,$gt as pw,Uut as px,kde as py,g3 as pz,Wct as q,a8 as q$,Dc as q0,Wke as q1,kct as q2,Dce as q3,U3e as q4,Cht as q5,Eht as q6,eP as q7,tP as q8,sP as q9,Zhe as qA,Bge as qB,Jf as qC,u7e as qD,v7e as qE,b7e as qF,c7e as qG,S7e as qH,kBe as qI,ZBe as qJ,P1 as qK,O1t as qL,z1t as qM,G1t as qN,mXe as qO,DJ as qP,z8e as qQ,Wgt as qR,Kqe as qS,OJ as qT,FJ as qU,S5e as qV,Lvt as qW,S0 as qX,wZe as qY,Yw as qZ,da as q_,fBe as qa,bBe as qb,IRe as qc,PRe as qd,TRe as qe,_5e as qf,uP as qg,tLe as qh,Mct as qi,Xct as qj,mae as qk,Hdt as ql,jdt as qm,Mz as qn,GRe as qo,LRe as qp,T6e as qq,ORe as qr,a4e as qs,h$e as qt,Vvt as qu,vLe as qv,DU as qw,z7e as qx,amt as qy,nht as qz,rvt as r,sLe as r$,ib as r0,Nut as r1,HSe as r2,Aut as r3,ept as r4,Kdt as r5,Kgt as r6,u_t as r7,D$e as r8,Pme as r9,m7 as rA,dct as rB,W0t as rC,X0t as rD,ade as rE,Rut as rF,Yde as rG,Tpt as rH,Ipt as rI,Mpt as rJ,vgt as rK,UJ as rL,rgt as rM,zGe as rN,Lu as rO,T$ as rP,Hde as rQ,Wde as rR,QLe as rS,ift as rT,o5e as rU,rft as rV,_Re as rW,Qmt as rX,Pje as rY,wz as rZ,abt as r_,c_t as ra,EB as rb,Gbe as rc,ext as rd,fx as re,PU as rf,L7e as rg,O7e as rh,L$ as ri,bge as rj,zHe as rk,iUe as rl,UHe as rm,Pge as rn,R3 as ro,yge as rp,aE as rq,qE as rr,G5e as rs,wUe as rt,xUe as ru,Q0t as rv,J0t as rw,h_ as rx,b$ as ry,Z0t as rz,Cut as s,YHe as s$,bLe as s0,iN as s1,mO as s2,Jmt as s3,f3 as s4,U6e as s5,rLe as s6,za as s7,Q$ as s8,rP as s9,zZe as sA,UZe as sB,BZe as sC,g_e as sD,l0e as sE,Ns as sF,MHe as sG,u1t as sH,y1t as sI,m1t as sJ,f1t as sK,HHe as sL,ofe as sM,a_e as sN,yHe as sO,BHe as sP,jHe as sQ,Wvt as sR,KHe as sS,_1t as sT,KV as sU,Yvt as sV,Xvt as sW,Tdt as sX,t_t as sY,tYe as sZ,v1t as s_,b0 as sa,qmt as sb,Yut as sc,v_e as sd,hYe as se,x_e as sf,PYe as sg,NYe as sh,GYe as si,Vht as sj,fpt as sk,fg as sl,ldt as sm,ql as sn,L1 as so,u9e as sp,Gu as sq,X_ as sr,vYe as ss,zgt as st,Lpe as su,zh as sv,lhe as sw,a0e as sx,LZe as sy,o0e as sz,IWe as t,O0t as t$,p1t as t0,pQe as t1,j7e as t2,g1t as t3,QHe as t4,xce as t5,mue as t6,HZe as t7,Y5 as t8,JU as t9,bIe as tA,kQe as tB,Tht as tC,mht as tD,F0t as tE,LE as tF,vae as tG,QQ as tH,KWe as tI,jOe as tJ,HOe as tK,wLe as tL,Zy as tM,XJ as tN,Hpe as tO,Lgt as tP,Vgt as tQ,qgt as tR,Ggt as tS,Cgt as tT,Tgt as tU,Pgt as tV,b8e as tW,v5 as tX,lmt as tY,fht as tZ,_x as t_,s1t as ta,xht as tb,k3 as tc,t0t as td,Bgt as te,Ugt as tf,sgt as tg,igt as th,iee as ti,E$ as tj,cP as tk,A0t as tl,M0t as tm,R0t as tn,k0t as to,Eje as tp,Nle as tq,pht as tr,rbt as ts,fLe as tt,nLe as tu,oLe as tv,Iht as tw,xd as tx,$Le as ty,Q7 as tz,rut as u,i0t as u$,G0t as u0,Y0t as u1,j$ as u2,q0t as u3,B0t as u4,V0t as u5,U0t as u6,L0t as u7,z0t as u8,j0t as u9,va as uA,dme as uB,Dke as uC,idt as uD,ayt as uE,A_t as uF,LX as uG,pdt as uH,Eee as uI,vee as uJ,fIe as uK,bee as uL,Oee as uM,xee as uN,Xht as uO,Tee as uP,jee as uQ,Hee as uR,Yee as uS,RIe as uT,Aht as uU,yIe as uV,E5 as uW,Xee as uX,Nht as uY,p5e as uZ,V_t as u_,H0t as ua,Vye as ub,cht as uc,uht as ud,LTe as ue,X7 as uf,bz as ug,ICe as uh,J8e as ui,Umt as uj,jN as uk,lyt as ul,_n as um,$$ as un,c0t as uo,tgt as up,nee as uq,w7e as ur,M_t as us,wdt as ut,fdt as uu,_dt as uv,gdt as uw,vdt as ux,ydt as uy,xdt as uz,ivt as v,HTe as v$,q_t as v0,K_t as v1,Rht as v2,a0t as v3,qht as v4,Egt as v5,W_t as v6,X_t as v7,Z_t as v8,Q_t as v9,z_t as vA,Ngt as vB,D9e as vC,C$ as vD,k9e as vE,Agt as vF,L_t as vG,a8e as vH,Mgt as vI,jJ as vJ,ngt as vK,ogt as vL,kgt as vM,Fgt as vN,jgt as vO,Hgt as vP,ggt as vQ,Ygt as vR,Xgt as vS,jqe as vT,Wqe as vU,rfe as vV,fb as vW,Ogt as vX,Zct as vY,E5e as vZ,YTe as v_,lte as va,ute as vb,cte as vc,Y_t as vd,H_t as ve,ste as vf,gee as vg,rte as vh,tte as vi,Iee as vj,uee as vk,lee as vl,aee as vm,fee as vn,g$ as vo,Rgt as vp,B_t as vq,j_t as vr,o0t as vs,Gq as vt,G_t as vu,k_t as vv,Jge as vw,q$ as vx,U_t as vy,$9e as vz,Xl as w,qbe as w$,ght as w0,oEe as w1,Bht as w2,Bpt as w3,vBe as w4,YRe as w5,Ide as w6,Ice as w7,gae as w8,HRe as w9,apt as wA,lpt as wB,ike as wC,ske as wD,X6e as wE,wyt as wF,Fh as wG,Jl as wH,fve as wI,Kve as wJ,rB as wK,pnt as wL,pi as wM,$be as wN,sM as wO,Oc as wP,ja as wQ,Ol as wR,wa as wS,lnt as wT,Ha as wU,Obe as wV,ys as wW,ut as wX,QE as wY,co as wZ,yKe as w_,b3e as wa,cLe as wb,pW as wc,rmt as wd,Gqe as we,yle as wf,Uht as wg,s_t as wh,yMe as wi,S_t as wj,w_t as wk,vJ as wl,nyt as wm,ryt as wn,iyt as wo,y8e as wp,jpe as wq,_gt as wr,ygt as ws,p8e as wt,oyt as wu,egt as wv,kke as ww,Tce as wx,I5e as wy,rTe as wz,uut as x,Hmt as x$,Zrt as x0,zt as x1,PJe as x2,kbe as x3,URe as x4,tke as x5,uye as x6,jmt as x7,gBe as x8,o_t as x9,ipt as xA,bRe as xB,Wdt as xC,AHe as xD,R_t as xE,l_e as xF,Mv as xG,d4e as xH,n4e as xI,Rge as xJ,f0e as xK,g0e as xL,TUe as xM,dLe as xN,Act as xO,JOe as xP,r4e as xQ,gct as xR,Gvt as xS,I8 as xT,zz as xU,Xmt as xV,zvt as xW,Uvt as xX,npt as xY,Ymt as xZ,RQ as x_,kOe as xa,Qpt as xb,sUe as xc,_4e as xd,dpt as xe,rpt as xf,spt as xg,Gut as xh,Spt as xi,wpt as xj,kut as xk,KIe as xl,Jdt as xm,Oht as xn,cpt as xo,b$e as xp,J5e as xq,lpe as xr,zut as xs,LI as xt,LZ as xu,y$ as xv,x_t as xw,tg as xx,Vq as xy,S6e as xz,he as y,Ght as y0,$Q as y1,g7 as y2,Goe as y3,Xut as y4,opt as y5,RRe as y6,ARe as y7,Bvt as y8,qvt as y9,D0t as ya,DQ as yb,jvt as yc,zRe as yd,mmt as ye,pmt as yf,dyt as yg,O$ as yh,I_t as yi,P0t as yj,wvt as yk,ZWe as yl,yE as ym,Kbt as yn,Glt as yo,Qct as z};
